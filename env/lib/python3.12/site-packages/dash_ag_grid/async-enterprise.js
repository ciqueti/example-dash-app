"use strict";var QAe=Object.defineProperty,JAe=Object.defineProperties;var eIe=Object.getOwnPropertyDescriptors;var WC=Object.getOwnPropertySymbols;var yj=Object.prototype.hasOwnProperty,vj=Object.prototype.propertyIsEnumerable;var RT=(At,gt)=>(gt=Symbol[At])?gt:Symbol.for("Symbol."+At),tIe=At=>{throw TypeError(At)};var mj=(At,gt,jt)=>gt in At?QAe(At,gt,{enumerable:!0,configurable:!0,writable:!0,value:jt}):At[gt]=jt,b=(At,gt)=>{for(var jt in gt||(gt={}))yj.call(gt,jt)&&mj(At,jt,gt[jt]);if(WC)for(var jt of WC(gt))vj.call(gt,jt)&&mj(At,jt,gt[jt]);return At},E=(At,gt)=>JAe(At,eIe(gt));var We=(At,gt)=>{var jt={};for(var xs in At)yj.call(At,xs)&&gt.indexOf(xs)<0&&(jt[xs]=At[xs]);if(At!=null&&WC)for(var xs of WC(At))gt.indexOf(xs)<0&&vj.call(At,xs)&&(jt[xs]=At[xs]);return jt};var iIe=function(At,gt){this[0]=At,this[1]=gt};var UC=At=>{var gt=At[RT("asyncIterator")],jt=!1,xs,fl={};return gt==null?(gt=At[RT("iterator")](),xs=m=>fl[m]=Vc=>gt[m](Vc)):(gt=gt.call(At),xs=m=>fl[m]=Vc=>{if(jt){if(jt=!1,m==="throw")throw Vc;return Vc}return jt=!0,{done:!1,value:new iIe(new Promise(Pd=>{var Np=gt[m](Vc);Np instanceof Object||tIe("Object expected"),Pd(Np)}),1)}}),fl[RT("iterator")]=()=>fl,xs("next"),"throw"in gt?xs("throw"):fl.throw=m=>{throw m},"return"in gt&&xs("return"),fl};(self.webpackChunkdash_ag_grid=self.webpackChunkdash_ag_grid||[]).push([[511],{5931:(At,gt,jt)=>{jt.r(gt),jt.d(gt,{default:()=>fj});var xs=jt(1609),fl=jt.n(xs),m=jt(346),Vc=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(e,t){let i=e[0],s=e[1],n=e[2],a=e[3];i=this.ff(i,s,n,a,t[0],7,-680876936),a=this.ff(a,i,s,n,t[1],12,-389564586),n=this.ff(n,a,i,s,t[2],17,606105819),s=this.ff(s,n,a,i,t[3],22,-1044525330),i=this.ff(i,s,n,a,t[4],7,-176418897),a=this.ff(a,i,s,n,t[5],12,1200080426),n=this.ff(n,a,i,s,t[6],17,-1473231341),s=this.ff(s,n,a,i,t[7],22,-45705983),i=this.ff(i,s,n,a,t[8],7,1770035416),a=this.ff(a,i,s,n,t[9],12,-1958414417),n=this.ff(n,a,i,s,t[10],17,-42063),s=this.ff(s,n,a,i,t[11],22,-1990404162),i=this.ff(i,s,n,a,t[12],7,1804603682),a=this.ff(a,i,s,n,t[13],12,-40341101),n=this.ff(n,a,i,s,t[14],17,-1502002290),s=this.ff(s,n,a,i,t[15],22,1236535329),i=this.gg(i,s,n,a,t[1],5,-165796510),a=this.gg(a,i,s,n,t[6],9,-1069501632),n=this.gg(n,a,i,s,t[11],14,643717713),s=this.gg(s,n,a,i,t[0],20,-373897302),i=this.gg(i,s,n,a,t[5],5,-701558691),a=this.gg(a,i,s,n,t[10],9,38016083),n=this.gg(n,a,i,s,t[15],14,-660478335),s=this.gg(s,n,a,i,t[4],20,-405537848),i=this.gg(i,s,n,a,t[9],5,568446438),a=this.gg(a,i,s,n,t[14],9,-1019803690),n=this.gg(n,a,i,s,t[3],14,-187363961),s=this.gg(s,n,a,i,t[8],20,1163531501),i=this.gg(i,s,n,a,t[13],5,-1444681467),a=this.gg(a,i,s,n,t[2],9,-51403784),n=this.gg(n,a,i,s,t[7],14,1735328473),s=this.gg(s,n,a,i,t[12],20,-1926607734),i=this.hh(i,s,n,a,t[5],4,-378558),a=this.hh(a,i,s,n,t[8],11,-2022574463),n=this.hh(n,a,i,s,t[11],16,1839030562),s=this.hh(s,n,a,i,t[14],23,-35309556),i=this.hh(i,s,n,a,t[1],4,-1530992060),a=this.hh(a,i,s,n,t[4],11,1272893353),n=this.hh(n,a,i,s,t[7],16,-155497632),s=this.hh(s,n,a,i,t[10],23,-1094730640),i=this.hh(i,s,n,a,t[13],4,681279174),a=this.hh(a,i,s,n,t[0],11,-358537222),n=this.hh(n,a,i,s,t[3],16,-722521979),s=this.hh(s,n,a,i,t[6],23,76029189),i=this.hh(i,s,n,a,t[9],4,-640364487),a=this.hh(a,i,s,n,t[12],11,-421815835),n=this.hh(n,a,i,s,t[15],16,530742520),s=this.hh(s,n,a,i,t[2],23,-995338651),i=this.ii(i,s,n,a,t[0],6,-198630844),a=this.ii(a,i,s,n,t[7],10,1126891415),n=this.ii(n,a,i,s,t[14],15,-1416354905),s=this.ii(s,n,a,i,t[5],21,-57434055),i=this.ii(i,s,n,a,t[12],6,1700485571),a=this.ii(a,i,s,n,t[3],10,-1894986606),n=this.ii(n,a,i,s,t[10],15,-1051523),s=this.ii(s,n,a,i,t[1],21,-2054922799),i=this.ii(i,s,n,a,t[8],6,1873313359),a=this.ii(a,i,s,n,t[15],10,-30611744),n=this.ii(n,a,i,s,t[6],15,-1560198380),s=this.ii(s,n,a,i,t[13],21,1309151649),i=this.ii(i,s,n,a,t[4],6,-145523070),a=this.ii(a,i,s,n,t[11],10,-1120210379),n=this.ii(n,a,i,s,t[2],15,718787259),s=this.ii(s,n,a,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(s,e[1]),e[2]=this.add32(n,e[2]),e[3]=this.add32(a,e[3])}cmn(e,t,i,s,n,a){return t=this.add32(this.add32(t,e),this.add32(s,a)),this.add32(t<<n|t>>>32-n,i)}ff(e,t,i,s,n,a,r){return this.cmn(t&i|~t&s,e,t,n,a,r)}gg(e,t,i,s,n,a,r){return this.cmn(t&s|i&~s,e,t,n,a,r)}hh(e,t,i,s,n,a,r){return this.cmn(t^i^s,e,t,n,a,r)}ii(e,t,i,s,n,a,r){return this.cmn(i^(t|~s),e,t,n,a,r)}md51(e){const t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=e.length;s+=64)this.md5cycle(i,this.md5blk(e.substring(s-64,s)));e=e.substring(s-64);const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<e.length;s++)n[s>>2]|=e.charCodeAt(s)<<(s%4<<3);if(n[s>>2]|=128<<(s%4<<3),s>55)for(this.md5cycle(i,n),s=0;s<16;s++)n[s]=0;return n[14]=t*8,this.md5cycle(i,n),i}md5blk(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let i="",s=0;for(;s<4;s++)i+=t[e>>s*8+4&15]+t[e>>s*8&15];return i}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const i=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(i>>16)<<16|i&65535}},Pd={"01":"GRID","02":"CHARTS","0102":"BOTH"},Np="https://www.ag-grid.com/licensing/",WT=class jn{constructor(t){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=t,this.md5=new Vc,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(jn.licenseKey),i=`AG Grid ${t.currentLicenseType==="BOTH"?"and AG Charts ":""}Enterprise`,s=t.suppliedLicenseType===void 0?"":`AG ${t.suppliedLicenseType==="BOTH"?"Grid and AG Charts":t.suppliedLicenseType==="GRID"?"Grid":"Charts"} Enterprise`;if(t.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(t.expired){const n=jn.getGridReleaseDate(),a=jn.formatDate(n);this.outputExpiredKey(t.expiry,a,i,s)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,i,s):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,i,s)}static extractExpiry(t){const i=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(jn.decode(i),10))}static extractLicenseComponents(t){let i=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const s=i.length-32,n=i.substring(s),a=i.substring(0,s),[r,o,l]=jn.extractBracketedInformation(i);return{md5:n,license:a,version:r,isTrial:o,type:l}}getLicenseDetails(t){const i=jn.chartsLicenseManager?"BOTH":"GRID";if(!(t!=null&&t.length))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:i};const s=jn.getGridReleaseDate(),{md5:n,license:a,version:r,isTrial:o,type:l}=jn.extractLicenseComponents(t);let c=n===this.md5.md5(a)&&t.indexOf("For_Trialing_ag-Grid_Only")===-1,h,d,u=null,p=!1,g;function f(){h=u<new Date,d=void 0}if(c&&(u=jn.extractExpiry(a),c=!isNaN(u.getTime()),c))switch(d=s>u,r){case"legacy":case"2":{o&&f();break}case"3":l!=null&&l.length?(g=l,l!==Pd["01"]&&l!==Pd["0102"]||i==="BOTH"&&g!=="BOTH"?(c=!1,p=!0):o&&f()):c=!1}return c?{licenseKey:t,valid:c,expiry:jn.formatDate(u),expired:d,version:r,isTrial:o,trialExpired:h,incorrectLicenseType:p,currentLicenseType:i,suppliedLicenseType:g}:{licenseKey:t,valid:c,incorrectLicenseType:p,currentLicenseType:i,suppliedLicenseType:g}}isDisplayWatermark(){var t;return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!!((t=this.watermarkMessage)!=null&&t.length)}getWatermarkMessage(){return this.watermarkMessage||""}getHostname(){const i=(this.document.defaultView||window).location,{hostname:s=""}=i;return s}isForceWatermark(){const i=(this.document.defaultView||window).location,{pathname:s}=i;return s?s.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){return this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)!==null}isLocalhost(){return this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)!==null}static formatDate(t){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=t.getDate(),n=t.getMonth(),a=t.getFullYear();return s+" "+i[n]+" "+a}static getGridReleaseDate(){return new Date(parseInt(jn.decode(jn.RELEASE_INFORMATION),10))}static decode(t){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s="",n,a,r,o,l,c,h,d=0;const u=t.replace(/[^A-Za-z0-9+/=]/g,"");for(;d<u.length;)o=i.indexOf(u.charAt(d++)),l=i.indexOf(u.charAt(d++)),c=i.indexOf(u.charAt(d++)),h=i.indexOf(u.charAt(d++)),n=o<<2|l>>4,a=(l&15)<<4|c>>2,r=(c&3)<<6|h,s=s+String.fromCharCode(n),c!=64&&(s=s+String.fromCharCode(a)),h!=64&&(s=s+String.fromCharCode(r));return s=jn.utf8_decode(s),s}static utf8_decode(t){t=t.replace(/rn/g,"n");let i="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);n<128?i+=String.fromCharCode(n):n>127&&n<2048?(i+=String.fromCharCode(n>>6|192),i+=String.fromCharCode(n&63|128)):(i+=String.fromCharCode(n>>12|224),i+=String.fromCharCode(n>>6&63|128),i+=String.fromCharCode(n&63|128))}return i}static setChartsLicenseManager(t){var i;this.chartsLicenseManager=t,(i=this.chartsLicenseManager)==null||i.setLicenseKey(this.licenseKey,!0)}static setLicenseKey(t){var i;this.licenseKey=t,(i=this.chartsLicenseManager)==null||i.setLicenseKey(t,!0)}static extractBracketedInformation(t){if(!t.includes("["))return["legacy",!1,void 0];const i=t.match(/\[(.*?)\]/g).map(o=>o.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const s=i.filter(o=>o==="TRIAL").length===1,n=i.filter(o=>o.indexOf("v")===0)[0],a=n?n.replace("v",""):"legacy",r=Pd[i.filter(o=>Pd[o])[0]];return[a,s,r]}centerPadAndOutput(t){const i=this.totalMessageLength-t.length;console.error(t.padStart(i/2+t.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(t,i="*",s=""){console.error(t.padEnd(this.totalMessageLength-s.length,i)+s)}outputInvalidLicenseKey(t,i,s){t?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${s} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Np}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Np}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(t,i,s){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${s} expired on ${t}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(t){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${t} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(t,i,s,n){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${s} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${n} released before ${t}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="License Expired"}};WT.RELEASE_INFORMATION="MTc0ODQ1MzQ2MTA5Mg==";var Op=WT,Uj='.ag-watermark{bottom:20px;color:#9b9b9b;opacity:.7;position:absolute;transition:opacity 1s ease-out 3s;&:before{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDkiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyMDkgMzYiPjxwYXRoIGZpbGw9IiM5QjlCOUIiIGQ9Ik0xOTIuOTkzIDIzLjY1OHYtNy45NDZoLTEzLjU0MWwtNy45NDcgNy45NDZ6TTIwOC4yNSAzLjk1aC0xNi45NzRsLTguMDEgNy45NDdoMjQuOTg0ek0xNjMuNjIyIDMxLjYwNWw0LjA2OS00LjA2OWgxMy43MzJ2Ny45NDdoLTE3LjgwMXoiLz48cGF0aCBmaWxsPSIjOUI5QjlCIiBkPSJNMTY2LjYxIDE5Ljc4aDguNzczbDguMDEtNy45NDZIMTY2LjYxek0xNTcuMDExIDMxLjYwNWg2LjYxMWw3Ljg4My03Ljk0N2gtMTQuNDk0ek0xOTEuMjc2IDMuOTVsLTQuMDY4IDQuMDdIMTYxLjI3Vi4wNzJoMzAuMDA2ek0yMC44NCAzMC4yMDZIOC4zNzhsLTIuMTYyIDUuMzRILjc1TDEyLjI1NyA4LjU5Mmg0Ljc2OEwyOC41MyAzNS41NDZoLTUuNTN6bS0xLjcxNy00LjI2TDE0LjYwOSAxNC45NWwtNC41MTQgMTAuOTk4ek0xMDQuNDM3IDE4LjUwOWMxLjU4OS0yLjM1MiA1LjU5NC0yLjYwNyA3LjI0Ny0yLjYwN3Y0LjU3OGMtMi4wMzQgMC00LjA2OS4wNjMtNS4yNzcuOTUzLTEuMjA3Ljg5LTEuODQzIDIuMDk4LTEuODQzIDMuNTZ2MTAuNTUzaC00Ljk1OVYxNS45MDJoNC43Njh6TTExOS4zNzYgMTUuOTAyaC00Ljk1OHYxOS42NDRoNC45NTh6TTExOS4zNzYgNy4xM2gtNC45NTh2NS44NDhoNC45NTh6TTE0My45NzkgNy4xM3YyOC40MTZoLTQuNzY4bC0uMTI3LTIuOTg4YTguMyA4LjMgMCAwIDEtMi42NyAyLjQ4Yy0xLjA4MS41NzItMi40MTYuODktMy45NDIuODktMS4zMzUgMC0yLjYwNi0uMjU1LTMuNjg3LS43LTEuMTQ0LS41MDgtMi4xNjItMS4xNDQtMi45ODgtMi4wMzRhOS42IDkuNiAwIDAgMS0xLjk3MS0zLjE3OWMtLjUwOC0xLjIwNy0uNjk5LTIuNjA2LS42OTktNC4xMzJzLjI1NC0yLjkyNC42OTktNC4xOTZjLjUwOS0xLjI3MSAxLjE0NS0yLjM1MiAxLjk3MS0zLjI0MnMxLjg0NC0xLjU4OSAyLjk4OC0yLjA5OCAyLjM1Mi0uNzYzIDMuNjg3LS43NjNjMS41MjYgMCAyLjc5Ny4yNTUgMy44NzguODI3czEuOTcxIDEuMzM1IDIuNjcgMi40MTZWNy4xOTNoNC45NTl6bS0xMC40MjYgMjQuNTM4YzEuNjUzIDAgMi45MjQtLjU3MiAzLjk0MS0xLjY1M3MxLjUyNi0yLjU0MyAxLjUyNi00LjMyMy0uNTA5LTMuMTc4LTEuNTI2LTQuMzIyYy0xLjAxNy0xLjA4MS0yLjI4OC0xLjY1My0zLjk0MS0xLjY1My0xLjU5IDAtMi45MjUuNTcyLTMuODc4IDEuNjUzLTEuMDE3IDEuMDgtMS41MjYgMi41NDMtMS41MjYgNC4zMjIgMCAxLjc4LjUwOSAzLjE4IDEuNTI2IDQuMjYgMS4wMTcgMS4xNDQgMi4yODggMS43MTYgMy44NzggMS43MTZNNTcuMjAyIDIwLjM1M0g0NC45MzN2NC4yNTloNi45OTNjLS4xOSAyLjE2MS0xLjAxNyAzLjgxNC0yLjQxNiA1LjE1LTEuMzk4IDEuMjctMy4xNzggMS45MDYtNS40NjcgMS45MDYtMS4yNzEgMC0yLjQ4LS4yNTQtMy40OTYtLjY5OWE3IDcgMCAwIDEtMi43MzQtMS45N2MtLjc2My0uODI3LTEuMzM1LTEuODQ0LTEuNzgtMy4wNTJzLS42MzYtMi40OC0uNjM2LTMuOTQyLjE5LTIuNzMzLjYzNi0zLjk0MWMuMzgxLTEuMjA4IDEuMDE3LTIuMTYyIDEuNzgtMy4wNTIuNzYzLS44MjYgMS42NTMtMS40NjIgMi43MzMtMS45N2E5LjEgOS4xIDAgMCAxIDMuNTYtLjdxNC4wMDUgMCA2LjEwMyAxLjkwN2wzLjMwNi0zLjMwNWMtMi40OC0xLjkwNy01LjY1OC0yLjkyNS05LjQwOS0yLjkyNS0yLjA5NyAwLTQuMDA0LjMxOC01LjcyMSAxLjAxOC0xLjcxNi42OTktMy4xNzkgMS41ODktNC4zODYgMi43OTdBMTIuMSAxMi4xIDAgMCAwIDMxLjIgMTYuMjJjLS42MzUgMS43MTctLjk1MyAzLjYyNC0uOTUzIDUuNjU4cy4zMTggMy45NDIgMS4wMTcgNS42NThjLjcgMS43MTcgMS41OSAzLjE3OSAyLjc5NyA0LjM4N2ExMi4xIDEyLjEgMCAwIDAgNC4zODcgMi43OTdjMS43MTYuNyAzLjYyMyAxLjAxNyA1LjY1NyAxLjAxNyAyLjAzNSAwIDMuODc4LS4zMTggNS41MzEtMS4wMTcgMS42NTMtLjcgMy4wNTItMS41OSA0LjE5Ni0yLjc5N3ExLjcxNi0xLjgxMiAyLjY3LTQuMzg3Yy42MzYtMS43MTYuOTU0LTMuNjIzLjk1NC01LjY1OHYtLjgyNmMtLjE5MS0uMTI3LS4yNTUtLjQ0NS0uMjU1LS43TTk1Ljk4MiAyMC4zNTNoLTEyLjI3djQuMjU5aDYuOTkzYy0uMTkgMi4xNjEtMS4wMTcgMy44MTQtMi40MTYgNS4xNS0xLjM5OCAxLjI3LTMuMTc4IDEuOTA2LTUuNDY3IDEuOTA2LTEuMjcxIDAtMi40OC0uMjU0LTMuNDk2LS42OTlhNyA3IDAgMCAxLTIuNzM0LTEuOTdjLS43NjMtLjgyNy0xLjMzNS0xLjg0NC0xLjc4LTMuMDUycy0uNjM2LTIuNDgtLjYzNi0zLjk0Mi4xOS0yLjczMy42MzYtMy45NDFjLjM4MS0xLjIwOCAxLjAxNy0yLjE2MiAxLjc4LTMuMDUyLjc2My0uODI2IDEuNjUzLTEuNDYyIDIuNzM0LTEuOTdhOS4xIDkuMSAwIDAgMSAzLjU2LS43cTQuMDA1IDAgNi4xMDMgMS45MDdsMy4zMDUtMy4zMDVjLTIuNDc5LTEuOTA3LTUuNjU4LTIuOTI1LTkuNDA4LTIuOTI1LTIuMDk4IDAtNC4wMDUuMzE4LTUuNzIyIDEuMDE4LTEuNzE2LjY5OS0zLjE3OCAxLjU4OS00LjM4NiAyLjc5N2ExMi4xIDEyLjEgMCAwIDAtMi43OTcgNC4zODZjLS42MzYgMS43MTctLjk1NCAzLjYyNC0uOTU0IDUuNjU4cy4zMTggMy45NDIgMS4wMTcgNS42NThjLjcgMS43MTcgMS41OSAzLjE3OSAyLjc5NyA0LjM4N2ExMi4xIDEyLjEgMCAwIDAgNC4zODcgMi43OTdjMS43MTYuNyAzLjYyMyAxLjAxNyA1LjY1OCAxLjAxNyAyLjAzNCAwIDMuODc4LS4zMTggNS41My0xLjAxNyAxLjY1My0uNyAzLjA1Mi0xLjU5IDQuMTk2LTIuNzk3cTEuNzE4LTEuODEyIDIuNjctNC4zODdjLjYzNi0xLjcxNi45NTQtMy42MjMuOTU0LTUuNjU4di0uODI2Yy0uMTktLjEyNy0uMjU1LS40NDUtLjI1NS0uNyIvPjwvc3ZnPg==");background-repeat:no-repeat;background-size:170px 40px;content:"";display:block;height:40px;width:170px}}:where(.ag-ltr) .ag-watermark{right:25px}:where(.ag-rtl) .ag-watermark{left:25px}.ag-watermark-text{font-family:Impact,sans-serif;font-size:19px;font-weight:700;opacity:.5}:where(.ag-ltr) .ag-watermark-text{padding-left:.7rem}:where(.ag-rtl) .ag-watermark-text{padding-right:.7rem}',Kj={tag:"div",cls:"ag-watermark",children:[{tag:"div",ref:"eLicenseTextRef",cls:"ag-watermark-text"}]},$j=class extends m.Component{constructor(){super(Kj),this.eLicenseTextRef=m.RefPlaceholder,this.registerCSS(Uj)}wireBeans(e){this.licenseManager=e.licenseManager}postConstruct(){const e=this.shouldDisplayWatermark();this.setDisplayed(e),e&&(this.eLicenseTextRef.textContent=this.licenseManager.getWatermarkMessage(),window.setTimeout(()=>this.addCss("ag-opacity-zero"),0),window.setTimeout(()=>this.setDisplayed(!1),5e3))}shouldDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}},Yj={selector:"AG-WATERMARK",component:$j},UT=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="licenseManager"}postConstruct(){this.validateLicense()}validateLicense(){this.licenseManager=new Op((0,m._getDocument)(this.beans)),this.licenseManager.validateLicense()}static getLicenseDetails(e){return new Op(null).getLicenseDetails(e)}getWatermarkSelector(){return Yj}isDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}getWatermarkMessage(){return this.licenseManager.getWatermarkMessage()}static setLicenseKey(e){Op.setLicenseKey(e)}static setChartsLicenseManager(e){Op.setChartsLicenseManager(e)}},Xj=9525,KT={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},Em=`\r
`;function $T(e,t,i){if(!t&&t!==""&&t!==0)return"";let s=t;return typeof t=="boolean"&&i&&(s=i(t)),` ${e}="${s}"`}function Zj(e={}){const s=["version"];return e.version||(e.version="1.0"),e.encoding&&s.push("encoding"),e.standalone&&s.push("standalone"),`<?xml ${s.map(a=>`${a}="${e[a]}"`).join(" ")} ?>`}function YT(e,t){let i="";e.properties&&(e.properties.prefixedAttributes&&e.properties.prefixedAttributes.forEach(n=>{Object.keys(n.map).forEach(a=>{i+=$T(n.prefix+a,n.map[a],t)})}),e.properties.rawMap&&Object.keys(e.properties.rawMap).forEach(n=>{i+=$T(n,e.properties.rawMap[n],t)}));let s="<"+e.name+i;return!e.children&&e.textNode==null?s+"/>"+Em:e.textNode!=null?s+">"+e.textNode+"</"+e.name+">"+Em:(s+=">"+Em,e.children&&e.children.forEach(n=>{s+=YT(n,t)}),s+"</"+e.name+">"+Em)}var qj=e=>Math.round(e*96/72),Ed=e=>Math.ceil(e*Xj),Qj=e=>{if(e===void 0)return;const i=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(i,0)},Rm=(e,t)=>{if(!t)return;let i;return typeof t=="number"?i=t:i=t({rowIndex:e}),i},Jj=(e,t)=>{const{colSpan:i,column:s}=e.position;if(e.width)if(i){const n=t.slice(s-1,s+i-1);let a=0;for(let r=0;r<n.length;r++){const o=n[r].getActualWidth();if(e.width<a+o){e.position.colSpan=r+1,e.totalWidth=e.width,e.width=e.totalWidth-a;break}a+=o}}else e.totalWidth=e.width},eH=(e,t)=>{const{rowSpan:i,row:s}=e.position;if(e.height)if(i){let n=0,a=0;for(let r=s;r<s+i;r++){const o=qj(Rm(r,t)||20);if(e.height<n+o){e.position.rowSpan=a+1,e.totalHeight=e.height,e.height=e.totalHeight-n;break}n+=o,a++}}else e.totalHeight=e.height},on=(e,t)=>{const i=Zj({encoding:"UTF-8",standalone:"yes"}),s=YT(e);return t?s:`${i}${s}`},jc=e=>{const s=String.fromCharCode,n=Math.floor(e/26),a=e%26;return!n||e===26?s(65+e-1):a?n<26?s(65+n-1)+s(65+a-1):jc(n)+s(65+a-1):jc(n-1)+"Z"},tH=e=>e.replaceAll(`
`,"_x000a_"),ZC=e=>{if(e==null)return null;let t="";for(let i=0;i<e.length;i++){const s=e.charCodeAt(i);if(s>=0&&s<=31&&s!==10){const r=`_x${s.toString(16).toUpperCase().padStart(4,"0")}_`;t+=r}else t+=e[i]}return t},iH=e=>{const t=[];for(const i of e.keys()){const s=i.toString(),n={name:"t",textNode:(0,m._escapeString)(ZC(s))};s.trim().length!==s.length&&(n.properties={rawMap:{"xml:space":"preserve"}}),t.push({name:"si",children:[n]})}return t},sH={getTemplate(e){const{name:t,ContentType:i,Extension:s,PartName:n}=e;return{name:t,properties:{rawMap:{Extension:s,PartName:n,ContentType:i}}}}},nH=sH,Nm=e=>e==="jpg"?"jpeg":e,aH={getTemplate(e){const t=new Array(e).fill(void 0).map((c,h)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:`/xl/worksheets/sheet${h+1}.xml`})),i=Uc.size,s=yl.size,n={};Nd.forEach(c=>{n[Nm(c.type)]=!0});const a=new Array(i).fill(void 0).map((c,h)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:`/xl/drawings/drawing${h+1}.xml`})),r=[];ho.forEach(({name:c})=>{r.push({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",PartName:`/xl/tables/${c}.xml`})});const o=Object.keys(n).map(c=>({name:"Default",ContentType:`image/${c}`,Extension:c}));s&&o.push({name:"Default",Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"});const l=[...o,{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"},...t,{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"},...a,...r,{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}].map(c=>nH.getTemplate(c));return{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:l}}},rH=aH,oH={getTemplate(e){const i=new Date().toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:i},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:i}]}}},lH=oH,XT=(e,t)=>({name:`xdr:${e}`,children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}),cH=e=>{const t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},hH=(e,t)=>({name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:e.altText!=null?e.altText:void 0}},children:[cH(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}),ZT=e=>{if(!e.saturation&&!e.tint)return;const t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:e.saturation*1e3}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:e.tint*1e3}}}),t},dH=(e,t)=>({name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:e.color}},children:ZT(e)},{name:"a:srgbClr",properties:{rawMap:{val:t.color}},children:ZT(t)}]}),uH=(e,t)=>{let i;if(e.transparency){const s=Math.min(Math.max(e.transparency,0),100);i=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(s*1e3)}}}]}if(e.recolor)switch(i||(i=[]),e.recolor.toLocaleLowerCase()){case"grayscale":i.push({name:"a:grayscl"});break;case"sepia":i.push(dH({color:"black"},{color:"D9C3A5",tint:50,saturation:180}));break;case"washout":i.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}});break;default:}return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":`rId${t}`,"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:i},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},pH=(e,t)=>{const i={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};if(e.rotation){const a=e.rotation;i.properties={rawMap:{rot:Math.min(Math.max(a,0),360)*6e4}}}return{name:"xdr:spPr",children:[i,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},gH=e=>{e.fitCell=!!e.fitCell||!e.width||!e.height;const{position:t={},fitCell:i,width:s=0,height:n=0,totalHeight:a,totalWidth:r}=e,{offsetX:o=0,offsetY:l=0,row:c=1,rowSpan:h=1,column:d=1,colSpan:u=1}=t;return{from:{row:c-1,col:d-1,offsetX:Ed(o),offsetY:Ed(l)},to:{row:c-1+(i?1:h-1),col:d-1+(i?1:u-1),offsetX:Ed(s+o),offsetY:Ed(n+l)},height:Ed(a||n),width:Ed(r||s)}},fH=(e,t,i,s)=>({name:"xdr:pic",children:[hH(e,t+1),uH(e,i+1),pH(e,s)]}),mH={getTemplate(e){const{sheetIndex:t}=e,i=Uc.get(t),s=Vp.get(t),n=i.map((a,r)=>{const o=gH(a);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[XT("from",o.from),XT("to",o.to),fH(a,r,s.get(a.id).index,o),{name:"xdr:clientData"}]}});return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:n}}},yH=mH,vH={getTemplate(e){const{Id:t,Type:i,Target:s}=e;return{name:"Relationship",properties:{rawMap:{Id:t,Type:i,Target:s}}}}},bH=vH,xH={getTemplate(e){const t=e.map(i=>bH.getTemplate(i));return{name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:t}}},Fp=xH,CH={getTemplate(e){return{name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.size,uniqueCount:e.size}},children:iH(e)}}},SH=CH,MH=e=>{switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}},DH={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot",Continuous:"Continuous"},wH=["Dashed","DashDot","DashDotDot"],AH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},IH={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},TH={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},kH=e=>e?AH[e]||e:"none",ml=e=>e==null?e:(e.charAt(0)==="#"&&(e=e.substring(1)),e.length===6?"FF"+e:e),Om=(e,t)=>{if(!e)return"thin";const i=MH(t);if(e==="Continuous")return i;const s=DH[e];return i==="medium"&&wH.some(n=>n===s)?`medium${s}`:`${s.charAt(0).toLowerCase()}${s.substring(1)}`},LH=e=>IH[e]||"general",PH=e=>TH[e]||void 0,Bp=e=>({name:"color",properties:{rawMap:{rgb:ml(e||"#000000")}}}),EH={getTemplate(e){const{left:t,right:i,top:s,bottom:n,diagonal:a}=e,r=t?[Bp(t.color)]:void 0,o=i?[Bp(i.color)]:void 0,l=s?[Bp(s.color)]:void 0,c=n?[Bp(n.color)]:void 0,h=a?[Bp(a.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:r},{name:"right",properties:{rawMap:{style:i&&i.style}},children:o},{name:"top",properties:{rawMap:{style:s&&s.style}},children:l},{name:"bottom",properties:{rawMap:{style:n&&n.style}},children:c},{name:"diagonal",properties:{rawMap:{style:a&&a.style}},children:h}]}}},RH=EH,NH={getTemplate(e){return{name:"borders",properties:{rawMap:{count:e.length}},children:e.map(t=>RH.getTemplate(t))}}},OH=NH,FH=e=>{const i=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(i,0)},BH={getTemplate(e){const{horizontal:t,indent:i,readingOrder:s,rotate:n,shrinkToFit:a,vertical:r,wrapText:o}=e;return{name:"alignment",properties:{rawMap:{horizontal:t&&LH(t),indent:i,readingOrder:s&&FH(s),textRotation:n,shrinkToFit:a,vertical:r&&PH(r),wrapText:o}}}}},_H=BH,GH={getTemplate(e){const t=e.protected===!1?0:1;return{name:"protection",properties:{rawMap:{hidden:e.hideFormula===!0?1:0,locked:t}}}}},zH=GH,VH={getTemplate(e){const{alignment:t,borderId:i,fillId:s,fontId:n,numFmtId:a,protection:r,quotePrefix:o,xfId:l}=e,c=[];return t&&c.push(_H.getTemplate(t)),r&&c.push(zH.getTemplate(r)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:r?1:void 0,applyBorder:i?1:void 0,applyFill:s?1:void 0,borderId:i,fillId:s,applyFont:n?1:void 0,fontId:n,applyNumberFormat:a?1:void 0,numFmtId:a,quotePrefix:o?1:void 0,xfId:l}},children:c.length?c:void 0}}},qT=VH,jH={getTemplate(e){return{name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map(t=>qT.getTemplate(t))}}},HH=jH,WH={getTemplate(e){const{builtinId:t,name:i,xfId:s}=e;return{name:"cellStyle",properties:{rawMap:{builtinId:t,name:i,xfId:s}}}}},UH=WH,KH={getTemplate(e){return{name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map(t=>UH.getTemplate(t))}}},$H=KH,YH={getTemplate(e){return{name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map(t=>qT.getTemplate(t))}}},XH=YH,ZH={getTemplate(e){const{patternType:t,fgTheme:i,fgTint:s,fgRgb:n,bgRgb:a,bgIndexed:r}=e,o={name:"patternFill",properties:{rawMap:{patternType:t}}};return(i||s||n)&&(o.children=[{name:"fgColor",properties:{rawMap:{theme:i,tint:s,rgb:n}}}]),(r||a)&&(o.children||(o.children=[]),o.children.push({name:"bgColor",properties:{rawMap:{indexed:r,rgb:a}}})),{name:"fill",children:[o]}}},qH=ZH,QH={getTemplate(e){return{name:"fills",properties:{rawMap:{count:e.length}},children:e.map(t=>qH.getTemplate(t))}}},JH=QH,eW={getTemplate(e){const{size:t,colorTheme:i,color:s="FF000000",fontName:n="Calibri",family:a,scheme:r,italic:o,bold:l,strikeThrough:c,outline:h,shadow:d,underline:u,verticalAlign:p}=e,g=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:i,rgb:s}}},{name:"name",properties:{rawMap:{val:n}}}];return a&&g.push({name:"family",properties:{rawMap:{val:a}}}),r&&g.push({name:"scheme",properties:{rawMap:{val:r}}}),o&&g.push({name:"i"}),l&&g.push({name:"b"}),c&&g.push({name:"strike"}),h&&g.push({name:"outline"}),d&&g.push({name:"shadow"}),u&&g.push({name:"u",properties:{rawMap:{val:u}}}),p&&g.push({name:"vertAlign",properties:{rawMap:{val:p}}}),{name:"font",children:g}}},tW=eW,iW={getTemplate(e){return{name:"fonts",properties:{rawMap:{count:e.length}},children:e.map(t=>tW.getTemplate(t))}}},sW=iW;function nW(e){const t=e.split(/(\[[^\]]*\])/);for(let i=0;i<t.length;i++){let s=t[i];s.length&&(s.startsWith("[")||(s=s.replace(/\$/g,'"$"')),t[i]=(0,m._escapeString)(s))}return t.join("")}var aW={getTemplate(e){let{formatCode:t,numFmtId:i}=e;return t.length&&(t=nW(t)),{name:"numFmt",properties:{rawMap:{formatCode:t,numFmtId:i}}}}},rW=aW,oW={getTemplate(e){return{name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map(t=>rW.getTemplate(t))}}},lW=oW,Fm,Rd,_p,Gp,zp,QT,Bm,JT,qC,ek=(e,t)=>(e.indexOf("mixedStyle")!==-1&&t>1&&(e+=`_${t}`),e),tk=()=>{Fm={base:0},Rd=[],_p=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],Gp=[{patternType:"none"},{patternType:"gray125"}],zp=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],QT=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],Bm=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],JT=[{builtinId:0,name:"Normal",xfId:0}]},cW=e=>{const t=kH(e.pattern),i=ml(e.color),s=ml(e.patternColor);let n=Gp.findIndex(a=>{const{patternType:r,fgRgb:o,bgRgb:l}=a;return!(r!=t||o!=i||l!=s)});return n===-1&&(n=Gp.length,Gp.push({patternType:t,fgRgb:i,bgRgb:s})),n},hW=e=>{if(KT[e])return KT[e];let t=Rd.findIndex(i=>i.formatCode===e);return t===-1?(t=Rd.length+164,Rd.push({formatCode:e,numFmtId:t})):t=Rd[t].numFmtId,t},dW=e=>{const{borderBottom:t,borderTop:i,borderLeft:s,borderRight:n}=e;let a,r,o,l,c,h,d,u;s&&(o=Om(s.lineStyle,s.weight),d=ml(s.color)),n&&(l=Om(n.lineStyle,n.weight),u=ml(n.color)),t&&(a=Om(t.lineStyle,t.weight),c=ml(t.color)),i&&(r=Om(i.lineStyle,i.weight),h=ml(i.color));let p=zp.findIndex(g=>{const{left:f,right:y,top:v,bottom:x}=g;if(!f&&(o||d)||!y&&(l||u)||!v&&(r||h)||!x&&(a||c))return!1;const{style:S,color:M}=f||{},{style:D,color:A}=y||{},{style:w,color:T}=v||{},{style:k,color:N}=x||{};return!(S!=o||M!=d||D!=l||A!=u||w!=r||T!=h||k!=a||N!=c)});return p===-1&&(p=zp.length,zp.push({left:{style:o,color:d},right:{style:l,color:u},top:{style:r,color:h},bottom:{style:a,color:c},diagonal:{style:void 0,color:void 0}})),p},uW=e=>{const{fontName:t="Calibri",color:i,size:s,bold:n,italic:a,outline:r,shadow:o,strikeThrough:l,underline:c,family:h,verticalAlign:d}=e,u=ml(i),p=Qj(h),g=c?c.toLocaleLowerCase():void 0,f=d?d.toLocaleLowerCase():void 0;let y=_p.findIndex(v=>!(v.fontName!=t||v.color!=u||v.size!=s||v.bold!=n||v.italic!=a||v.outline!=r||v.shadow!=o||v.strikeThrough!=l||v.underline!=g||v.verticalAlign!=f||v.family!=p));return y===-1&&(y=_p.length,_p.push({fontName:t,color:u,size:s,bold:n,italic:a,outline:r,shadow:o,strikeThrough:l,underline:g,verticalAlign:f,family:p!=null?p.toString():void 0})),y},pW=e=>{const{alignment:t,borders:i,font:s,interior:n,numberFormat:a,protection:r,quotePrefix:o}=e;let{id:l}=e,c=0,h=0,d=0,u=0;l&&(l=ek(l,qC),Fm[l]==null&&(n&&(c=cW(n)),i&&(h=dW(i)),s&&(d=uW(s)),a&&(u=hW(a.format)),Fm[l]=Bm.length,Bm.push({alignment:t,borderId:h||0,fillId:c||0,fontId:d||0,numFmtId:u||0,protection:r,quotePrefix:o,xfId:0})))},gW={getTemplate(e){const t=lW.getTemplate(Rd),i=sW.getTemplate(_p.map(l=>E(b({},l),{size:l.size!=null?l.size:e}))),s=JH.getTemplate(Gp),n=OH.getTemplate(zp),a=HH.getTemplate(QT),r=XH.getTemplate(Bm),o=$H.getTemplate(JT);return tk(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,i,s,n,a,r,o,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}}},fW=(e,t)=>Fm[ek(e,t)]||0,mW=(e,t)=>{qC=t,qC===1&&tk(),e.forEach(pW)},yW=gW,vW={getTemplate(e,t){const{name:i,columns:s,rowRange:n,displayName:a,showRowStripes:r,showColumnStripes:o,showFilterButtons:l,highlightFirstColumn:c,highlightLastColumn:h}=e||{},d=!n||n[0]-n[1]===0;if(!e||!i||!Array.isArray(s)||!s.length||d)return{name:"table"};const u=s.map((x,S)=>({name:"filterColumn",properties:{rawMap:{colId:S.toString(),hiddenButton:l[S]?0:1}}})),p=`A${n[0]}`,g=`${jc(s.length)}${n[1]}`,f=`${p}:${g}`,y=`${t+1}`,v=t?`${a}_${y}`:a;return{name:"table",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",name:i,displayName:v,ref:f,totalsRowShown:0,id:y}},children:[{name:"autoFilter",properties:{rawMap:{ref:f}},children:u},{name:"tableColumns",properties:{rawMap:{count:s.length}},children:s.map((x,S)=>({name:"tableColumn",properties:{rawMap:{id:(S+1).toString(),name:tH(x),dataCellStyle:"Normal"}}}))},{name:"tableStyleInfo",properties:{rawMap:{name:"TableStyleLight1",showFirstColumn:c?1:0,showLastColumn:h?1:0,showRowStripes:r?1:0,showColumnStripes:o?1:0}}}]}}},bW=vW,pa=e=>{const[t,i,s,n]=e;return{name:`a:${t}`,children:[{name:`a:${i}`,properties:{rawMap:{val:s,lastClr:n}}}]}},xW={getTemplate(){return{name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[pa(["dk1","sysClr","windowText","000000"]),pa(["lt1","sysClr","window","FFFFFF"]),pa(["dk2","srgbClr","44546A"]),pa(["lt2","srgbClr","E7E6E6"]),pa(["accent1","srgbClr","4472C4"]),pa(["accent2","srgbClr","ED7D31"]),pa(["accent3","srgbClr","A5A5A5"]),pa(["accent4","srgbClr","FFC000"]),pa(["accent5","srgbClr","5B9BD5"]),pa(["accent6","srgbClr","70AD47"]),pa(["hlink","srgbClr","0563C1"]),pa(["folHlink","srgbClr","954F72"])]}}},CW=xW,pe=e=>{const[t,i,s,n]=e;return{name:`a:${t}`,properties:{rawMap:{script:s,typeface:i,panose:n}}}},SW={getTemplate(){return{name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[pe(["latin","Calibri Light",void 0,"020F0302020204030204"]),pe(["ea",""]),pe(["cs",""]),pe(["font","\u6E38\u30B4\u30B7\u30C3\u30AF Light","Jpan"]),pe(["font","\uB9D1\uC740 \uACE0\uB515","Hang"]),pe(["font","\u7B49\u7EBF Light","Hans"]),pe(["font","\u65B0\u7D30\u660E\u9AD4","Hant"]),pe(["font","Times New Roman","Arab"]),pe(["font","Times New Roman","Hebr"]),pe(["font","Tahoma","Thai"]),pe(["font","Nyala","Ethi"]),pe(["font","Vrinda","Beng"]),pe(["font","Shruti","Gujr"]),pe(["font","MoolBoran","Khmr"]),pe(["font","Tunga","Knda"]),pe(["font","Raavi","Guru"]),pe(["font","Euphemia","Cans"]),pe(["font","Plantagenet Cherokee","Cher"]),pe(["font","Microsoft Yi Baiti","Yiii"]),pe(["font","Microsoft Himalaya","Tibt"]),pe(["font","MV Boli","Thaa"]),pe(["font","Mangal","Deva"]),pe(["font","Gautami","Telu"]),pe(["font","Latha","Taml"]),pe(["font","Estrangelo Edessa","Syrc"]),pe(["font","Kalinga","Orya"]),pe(["font","Kartika","Mlym"]),pe(["font","DokChampa","Laoo"]),pe(["font","Iskoola Pota","Sinh"]),pe(["font","Mongolian Baiti","Mong"]),pe(["font","Times New Roman","Viet"]),pe(["font","Microsoft Uighur","Uigh"]),pe(["font","Sylfaen","Geor"]),pe(["font","Arial","Armn"]),pe(["font","Leelawadee UI","Bugi"]),pe(["font","Microsoft JhengHei","Bopo"]),pe(["font","Javanese Text","Java"]),pe(["font","Segoe UI","Lisu"]),pe(["font","Myanmar Text","Mymr"]),pe(["font","Ebrima","Nkoo"]),pe(["font","Nirmala UI","Olck"]),pe(["font","Ebrima","Osma"]),pe(["font","Phagspa","Phag"]),pe(["font","Estrangelo Edessa","Syrn"]),pe(["font","Estrangelo Edessa","Syrj"]),pe(["font","Estrangelo Edessa","Syre"]),pe(["font","Nirmala UI","Sora"]),pe(["font","Microsoft Tai Le","Tale"]),pe(["font","Microsoft New Tai Lue","Talu"]),pe(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[pe(["latin","Calibri",void 0,"020F0502020204030204"]),pe(["ea",""]),pe(["cs",""]),pe(["font","\u6E38\u30B4\u30B7\u30C3\u30AF","Jpan"]),pe(["font","\uB9D1\uC740 \uACE0\uB515","Hang"]),pe(["font","\u7B49\u7EBF","Hans"]),pe(["font","\u65B0\u7D30\u660E\u9AD4","Hant"]),pe(["font","Arial","Arab"]),pe(["font","Arial","Hebr"]),pe(["font","Tahoma","Thai"]),pe(["font","Nyala","Ethi"]),pe(["font","Vrinda","Beng"]),pe(["font","Shruti","Gujr"]),pe(["font","DaunPenh","Khmr"]),pe(["font","Tunga","Knda"]),pe(["font","Raavi","Guru"]),pe(["font","Euphemia","Cans"]),pe(["font","Plantagenet Cherokee","Cher"]),pe(["font","Microsoft Yi Baiti","Yiii"]),pe(["font","Microsoft Himalaya","Tibt"]),pe(["font","MV Boli","Thaa"]),pe(["font","Mangal","Deva"]),pe(["font","Gautami","Telu"]),pe(["font","Latha","Taml"]),pe(["font","Estrangelo Edessa","Syrc"]),pe(["font","Kalinga","Orya"]),pe(["font","Kartika","Mlym"]),pe(["font","DokChampa","Laoo"]),pe(["font","Iskoola Pota","Sinh"]),pe(["font","Mongolian Baiti","Mong"]),pe(["font","Arial","Viet"]),pe(["font","Microsoft Uighur","Uigh"]),pe(["font","Sylfaen","Geor"]),pe(["font","Arial","Armn"]),pe(["font","Leelawadee UI","Bugi"]),pe(["font","Microsoft JhengHei","Bopo"]),pe(["font","Javanese Text","Java"]),pe(["font","Segoe UI","Lisu"]),pe(["font","Myanmar Text","Mymr"]),pe(["font","Ebrima","Nkoo"]),pe(["font","Nirmala UI","Olck"]),pe(["font","Ebrima","Osma"]),pe(["font","Phagspa","Phag"]),pe(["font","Estrangelo Edessa","Syrn"]),pe(["font","Estrangelo Edessa","Syrj"]),pe(["font","Estrangelo Edessa","Syre"]),pe(["font","Nirmala UI","Sora"]),pe(["font","Microsoft Tai Le","Tale"]),pe(["font","Microsoft New Tai Lue","Talu"]),pe(["font","Ebrima","Tfng"])]}]}}},MW=SW,vr=(e,t,i)=>({name:`a:${e}`,properties:{rawMap:{val:t}},children:i}),QC=e=>{const[t,i,s,n,a,r]=e,o=[];return o.push(vr("satMod",s)),n&&o.push(vr("lumMod",n)),a&&o.push(vr("tint",a)),r&&o.push(vr("shade",r)),{name:"a:gs",properties:{rawMap:{pos:t}},children:[{name:"a:schemeClr",properties:{rawMap:{val:i}},children:o}]}},_m=(e,t)=>({name:"a:solidFill",children:[vr("schemeClr",e,t)]}),JC=e=>{const[t,i,s,n,a]=e,[r,o]=a;return{name:"a:gradFill",properties:{rawMap:{rotWithShape:t}},children:[{name:"a:gsLst",children:[QC(i),QC(s),QC(n)]},{name:"a:lin",properties:{rawMap:{ang:r,scaled:o}}}]}},eS=e=>{const[t,i,s,n]=e;return{name:"a:ln",properties:{rawMap:{w:t,cap:i,cmpd:s,algn:n}},children:[_m("phClr"),vr("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},tS=e=>{const t=[];if(e){const[i,s,n,a,r]=e;t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:i,dist:s,dir:n,algn:a,rotWithShape:r}},children:[vr("srgbClr","000000",[vr("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},DW=()=>({name:"a:fillStyleLst",children:[_m("phClr"),JC(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),JC(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]}),wW=()=>({name:"a:lnStyleLst",children:[eS(["6350","flat","sng","ctr"]),eS(["12700","flat","sng","ctr"]),eS(["19050","flat","sng","ctr"])]}),AW=()=>({name:"a:effectStyleLst",children:[tS(),tS(),tS(["57150","19050","5400000","ctr","0"])]}),IW=()=>({name:"a:bgFillStyleLst",children:[_m("phClr"),_m("phClr",[vr("tint","95000"),vr("satMod","170000")]),JC(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}),TW={getTemplate(){return{name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[DW(),wW(),AW(),IW()]}}},kW=TW,LW={getTemplate(){return{name:"a:themeElements",children:[CW.getTemplate(),MW.getTemplate(),kW.getTemplate()]}}},PW=LW,EW={getTemplate(){return{name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[PW.getTemplate(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]}}},RW=EW,NW=()=>({name:"o:shapelayout",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}]},children:[{name:"o:idmap",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}],rawMap:{data:"1"}}}]}),OW=()=>({name:"v:stroke",properties:{rawMap:{joinstyle:"miter"}}}),FW=e=>({name:"v:formulas",children:e.map(t=>({name:"v:f",properties:{rawMap:{eqn:t}}}))}),BW=()=>({name:"v:path",properties:{prefixedAttributes:[{prefix:"o:",map:{connecttype:"rect",extrusionok:"f"}}],rawMap:{gradientshapeok:"t"}}}),ik=e=>{const{aspectratio:t,rotation:i}=e||{},s={};return t&&(s.aspectratio="t"),i&&(s.rotation="t"),{name:"o:lock",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}],rawMap:s}}};function _W(e,t,i,s,n){return(e-t)/(i-t)*(n-s)+s}var GW=(e,t)=>{let i;const{recolor:s,brightness:n,contrast:a,id:r}=e;if(s&&(i={},(s==="Washout"||s==="Grayscale")&&(i.gain="19661f",i.blacklevel="22938f"),(s==="Black & White"||s==="Grayscale")&&(i.grayscale="t",s==="Black & White"&&(i.bilevel="t"))),!s||s==="Grayscale"){if(i||(i={}),a!=null&&a!==50){let o="1";a>=0&&(a<50?o=String(a/50):a<100?o=String(50/(100-a)):a===100&&(o="2147483647f")),i.gain=o}n!=null&&n!==50&&(i.blacklevel=_W(n,0,100,-.5,.5).toString())}return{name:"v:imagedata",properties:{prefixedAttributes:[{prefix:"o:",map:{relid:`rId${t}`,title:r}}],rawMap:i}}},zW=()=>{const e=["if lineDrawn pixelLineWidth 0","sum @0 1 0","sum 0 0 @1","prod @2 1 2","prod @3 21600 pixelWidth","prod @3 21600 pixelHeight","sum @0 0 1","prod @6 1 2","prod @7 21600 pixelWidth","sum @8 21600 0","prod @7 21600 pixelHeight","sum @10 21600 0"];return{name:"v:shapetype",properties:{prefixedAttributes:[{prefix:"o:",map:{spt:"75",preferrelative:"t"}}],rawMap:{coordsize:"21600,21600",filled:"f",id:"_x0000_t75",path:"m@4@5l@4@11@9@11@9@5xe",stroked:"f"}},children:[OW(),FW(e),BW(),ik({aspectratio:!0})]}},sk=e=>Math.floor((e!=null?e:0)*.74999943307122),VW=(e,t)=>{const{width:i=0,height:s=0,altText:n}=e,a=sk(i),r=sk(s);return{name:"v:shape",properties:{rawMap:{id:e.headerFooterPosition,"o:spid":"_x0000_s1025",style:`position: absolute; margin-left: 0; margin-top: 10in; margin-bottom: 0; margin-right: 0; width: ${a}pt; height: ${r}pt; z-index: ${t+1}`,type:"#_x0000_t75",alt:n}},children:[GW(e,t+1),ik({rotation:!0})]}},jW={getTemplate(e){const t=yl.get(e.sheetIndex)||[],i=[NW(),zW(),...t.map((s,n)=>VW(s,n))];return{name:"xml",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{v:"urn:schemas-microsoft-com:vml",o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel"}}]},children:i}}},HW=jW,WW={getTemplate(e,t){const i=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:i,"r:id":`rId${i}`}}}}},UW=WW,KW={getTemplate(e){return{name:"sheets",children:e.map((t,i)=>UW.getTemplate(t,i))}}},$W=KW,YW={getTemplate(e,t){return{name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[{name:"bookViews",children:[{name:"workbookView",properties:{rawMap:{activeTab:t}}}]},$W.getTemplate(e)]}}},XW=YW,ZW=e=>Math.ceil((e-12)/7+1),qW={getTemplate(e){const{min:t,max:i,outlineLevel:s,s:n,width:a,hidden:r,bestFit:o}=e;let l=1,c="0";return a>1&&(l=ZW(a),c="1"),{name:"col",properties:{rawMap:{min:t,max:i,outlineLevel:s!=null?s:void 0,width:l,style:n,hidden:r?"1":"0",bestFit:o?"1":"0",customWidth:c}}}}},QW=qW,JW={getTemplate(e){return{name:"mergeCell",properties:{rawMap:{ref:e}}}}},e3=JW,t3=e=>{const t=e.charAt(0).toLowerCase();return t==="s"?"inlineStr":t},i3={getTemplate(e,t,i){const{ref:s,data:n,styleId:a}=e,{type:r,value:o}=n||{type:"empty",value:null};let l=r;r==="f"?l="str":r.charAt(0)===r.charAt(0).toUpperCase()&&(l=t3(r));const c={name:"c",properties:{rawMap:{r:s,t:l==="empty"?void 0:l,s:a?fW(a,i):void 0}}};if(l==="empty")return c;let h;return l==="str"&&r==="f"?h=[{name:"f",textNode:(0,m._escapeString)(ZC(o))}]:l==="inlineStr"?h=[{name:"is",children:[{name:"t",textNode:(0,m._escapeString)(ZC(o))}]}]:h=[{name:"v",textNode:o}],Object.assign({},c,{children:h})}},s3=i3,n3=(e,t)=>{const i=[];let s=0;for(let n=0;n<e.length;n++){const a=e[n];a.mergeAcross&&(i.push({pos:n,excelPos:s}),s+=a.mergeAcross),s++}if(i.length)for(let n=i.length-1;n>=0;n--){const a=[],r=e[i[n].pos];for(let o=1;o<=r.mergeAcross;o++)a.push({ref:`${jc(i[n].excelPos+1+o)}${t+1}`,styleId:r.styleId,data:{type:"empty",value:null}});a.length&&e.splice(i[n].pos+1,0,...a)}},a3=e=>{var t;return((t=e.data)==null?void 0:t.value)!==""||e.styleId!==void 0},r3={getTemplate(e,t,i){const{collapsed:s,hidden:n,height:a,outlineLevel:r,cells:o=[]}=e;n3(o,t);const l=o.filter(a3).map((c,h)=>s3.getTemplate(c,h,i));return{name:"row",properties:{rawMap:{r:t+1,collapsed:s?"1":"0",hidden:n?"1":"0",ht:a,customHeight:a!=null?"1":"0",spans:"1:1",outlineLevel:r||void 0}},children:l}}},o3=r3,l3=(e,t,i)=>{const s=[],n=[];e.forEach((o,l)=>{const c=o.cells;let h=0,d;c.forEach((u,p)=>{const g=p+h+1,f=jc(g),y=l+1;if(u.mergeAcross){h+=u.mergeAcross;const x=jc(p+h+1);s.push(`${f}${y}:${x}${y}`)}t[g-1]||(t[g-1]={});const{collapsibleRanges:v}=u;v&&v.forEach(x=>{n.push([g+x[0],g+x[1]])}),d=t[g-1],d.min=g,d.max=g,u.ref=`${f}${y}`})}),n.sort((o,l)=>o[0]!==l[0]?o[0]-l[0]:l[1]-o[1]);const a=new Map,r=new Map;return n.filter(o=>{const l=o.toString();return a.get(l)?!1:(a.set(l,!0),!0)}).forEach(o=>{const l=t.find(h=>h.min==o[0]&&h.max==o[1]),c=r.get(o[0]);t.push({min:o[0],max:o[1],outlineLevel:i?void 0:c||1,width:(l||{width:100}).width}),r.set(o[0],(c||0)+1)}),s},c3=e=>!e||e!=="Portrait"&&e!=="Landscape"?"portrait":e.toLocaleLowerCase(),h3=e=>{if(e==null)return 1;const i=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return i===-1?1:i+1},d3=e=>{const t={"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F","&[Picture]":"&G"};for(const i of Object.keys(t))e=e.replace(i,t[i]);return e},u3=e=>e==="Center"?"C":e==="Right"?"R":"L",p3=(e,t)=>(t&&(e+="&amp;&quot;",e+=t.fontName||"Calibri",t.bold!==t.italic?e+=t.bold?",Bold":",Italic":t.bold?e+=",Bold Italic":e+=",Regular",e+="&quot;",t.size&&(e+=`&amp;${t.size}`),t.strikeThrough&&(e+="&amp;S"),t.underline&&(e+=`&amp;${t.underline==="Double"?"E":"U"}`),t.color&&(e+=`&amp;K${t.color.replace("#","").toUpperCase()}`)),e),g3=(e,t,i)=>e.reduce((s,n,a)=>{const r=u3(n.position),o=p3(`${s}&amp;${r}`,n.font),l=["Left","Center","Right"];n.position||(n.position=l[a]);const{image:c}=n;if(n.value==="&[Picture]"&&c){const h=`${r}${t}${i}`;G3(c,h)}return`${o}${(0,m._escapeString)(d3(n.value))}`},""),f3=e=>{const t=["all","first","even"],i=[];return t.forEach(s=>{const n=e[s],a=s==="all"?"odd":s;if(n)for(const r of Object.keys(n)){const o=n[r],l=`${r.charAt(0).toUpperCase()}${r.slice(1)}`,c=r[0].toUpperCase();if(o){const h=s==="all"?"":s.toUpperCase();i.push({name:`${a}${l}`,properties:{rawMap:{"xml:space":"preserve"}},textNode:g3(o,c,h)})}}}),i},m3=e=>t=>(e.length&&t.children.push({name:"cols",children:e.map(i=>QW.getTemplate(i))}),t),y3=(e,t)=>i=>(e.length&&i.children.push({name:"sheetData",children:e.map((s,n)=>o3.getTemplate(s,n,t))}),i),v3=e=>t=>(e.length&&t.children.push({name:"mergeCells",properties:{rawMap:{count:e.length}},children:e.map(i=>e3.getTemplate(i))}),t),b3=e=>t=>{const{top:i=.75,right:s=.7,bottom:n=.75,left:a=.7,header:r=.3,footer:o=.3}=e;return t.children.push({name:"pageMargins",properties:{rawMap:{bottom:n,footer:o,header:r,left:a,right:s,top:i}}}),t},x3=e=>t=>(e&&t.children.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:c3(e.orientation),paperSize:h3(e.pageSize)}}}),t),C3=e=>t=>{if(!e)return t;const i=e.first!=null?1:0,s=e.even!=null?1:0;return t.children.push({name:"headerFooter",properties:{rawMap:{differentFirst:i,differentOddEven:s}},children:f3(e)}),t},S3=e=>t=>(e&&t.children.push({name:"tableParts",properties:{rawMap:{count:"1"}},children:[{name:"tablePart",properties:{rawMap:{"r:id":`rId${++t.rIdCounter}`}}}]}),t),M3=e=>t=>{const i=Uc.get(e);return i!=null&&i.length&&t.children.push({name:"drawing",properties:{rawMap:{"r:id":`rId${++t.rIdCounter}`}}}),t},D3=e=>t=>(yl.get(e)&&t.children.push({name:"legacyDrawingHF",properties:{rawMap:{"r:id":`rId${++t.rIdCounter}`}}}),t),w3=(e=0,t=0)=>{const i=e>0||t>0;return i?[{name:"pane",properties:{rawMap:{state:i?"frozen":void 0,topLeftCell:i?`${jc(e+1)}${t+1}`:void 0,xSplit:e===0?void 0:e,ySplit:t===0?void 0:t}}}]:void 0},A3=(e=!1,t,i)=>s=>(s.children.push({name:"sheetViews",children:[{name:"sheetView",properties:{rawMap:{rightToLeft:e===!0?"1":"0",workbookViewId:"0"}},children:w3(t,i)}]}),s),I3=()=>e=>(e.children.push({name:"sheetPr",children:[{name:"outlinePr",properties:{rawMap:{summaryBelow:0}}}]}),e),T3=e=>t=>{const i=e.reduce((s,n)=>n.outlineLevel&&n.outlineLevel>s?n.outlineLevel:s,0);return t.children.push({name:"sheetFormatPr",properties:{rawMap:{baseColWidth:10,defaultRowHeight:16,outlineLevelRow:i||void 0}}}),t},k3={getTemplate(e){const{worksheet:t,currentSheet:i,config:s}=e,{margins:n={},pageSetup:a,headerFooterConfig:r,suppressColumnOutline:o,rightToLeft:l,frozenRowCount:c,frozenColumnCount:h}=s,{table:d}=t,{rows:u,columns:p}=d,g=p&&p.length?l3(u,p,!!o):[],f=ho.get(i),{children:y}=[I3(),A3(l,h,c),T3(u),m3(p),y3(u,i+1),v3(g),b3(n),x3(a),C3(r),M3(i),D3(i),S3(f)].reduce((v,x)=>x(v),{children:[],rIdCounter:0});return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:y}}},L3=k3,Hc=new Map,co=[],Wc=new Map,Uc=new Map,yl=new Map,Nd=new Map,Vp=new Map,ho=new Map,P3="AG-GRID-TABLE",iS="SINGLE_SHEET";function E3(){return iS}function R3(e){iS=e}function N3(e,t,i){V3(t),mW(e,co.length);const s=Object.assign({},i);return i.exportAsExcelTable&&i.colModel.isPivotActive()&&(O3("pivot mode"),s.exportAsExcelTable=!1),_3(t,s),i5(t,s)}function O3(e){(0,m._warn)(163,{featureName:e})}function F3(e){return e.replace(/^[^a-zA-Z_]+/,"_").replace(/\s/g,"_").replace(/[^a-zA-Z0-9_]/g,"_")}function B3(e,t){if(ho.has(e)){(0,m._warn)(164);return}ho.set(e,t)}function _3(e,t){var k;const{exportAsExcelTable:i,prependContent:s,appendContent:n,colModel:a}=t;if(!i)return;const r=typeof i=="boolean"?{}:i,{name:o,showColumnStripes:l,showRowStripes:c,showFilterButton:h,highlightFirstColumn:d,highlightLastColumn:u}=r,p=F3(o||P3),g=co.length-1,{table:f}=e,{rows:y,columns:v}=f,x=(0,m._getHeaderRowCount)(a),S=s?s.length:0,M=n?n.length:0,D=y.length,A=v.length,w=[],T=[];for(let N=0;N<A;N++){const O=v[N];w.push(O.displayName||""),T.push(h==="match"||h===void 0?(k=O.filterAllowed)!=null?k:!1:h)}if(!w||!w.length||!D||!p){(0,m._warn)(165);return}B3(g,{name:`table${ho.size+1}`,displayName:p,columns:w,showFilterButtons:T,rowRange:[x+S,x+(D-x)-M],showRowStripes:c!=null?c:!0,showColumnStripes:l!=null?l:!1,highlightFirstColumn:d!=null?d:!1,highlightLastColumn:u!=null?u:!1})}function G3(e,t){const i=co.length-1,s=e;s.headerFooterPosition=t,nk({imageToAdd:s,idx:i});let n=yl.get(i);n||(n=[],yl.set(i,n)),n.find(a=>a.id===e.id)||n.push(e)}function z3(e,t,i,s,n){const a=co.length,{row:r,column:o}=e.position||{},l=e;s&&(t!=null&&i!=null&&(!r||!o)&&(e.position||(e.position={}),e.position=Object.assign({},e.position,{row:t,column:s.indexOf(i)+1})),Jj(l,s),eH(l,n)),nk({imageToAdd:l,idx:a});let c=Vp.get(a);c||(c=new Map,Vp.set(a,c));const h=Uc.get(a);h?h.push(l):Uc.set(a,[l]),c.get(e.id)||c.set(e.id,{index:c.size,type:e.imageType})}function nk(e){const{imageToAdd:t,idx:i}=e,s=Wc.get(t.id);if(s){const n=s.find(a=>a.sheetId===i);n?n.image.push(t):s.push({sheetId:i,image:[t]})}else Wc.set(t.id,[{sheetId:i,image:[t]}]),Nd.set(t.id,{type:t.imageType,index:Nd.size})}function V3(e){const t=(0,m._escapeString)(e.name)||"";let i="";for(;co.indexOf(`${t}${i}`)!==-1;)i===""?i="_1":i=`_${parseInt(i.slice(1),10)+1}`;e.name=`${t}${i}`,co.push(e.name)}function ak(e){return Hc.has(e)?Hc.get(e):(Hc.set(e,Hc.size),Hc.size-1)}function rk(){Hc.clear(),Wc.clear(),Uc.clear(),yl.clear(),Nd.clear(),Vp.clear(),ho.clear(),co=[],iS="SINGLE_SHEET"}function j3(e){return on(XW.getTemplate(co,e))}function H3(e){return on(yW.getTemplate(e))}function W3(){return on(SH.getTemplate(Hc))}function U3(e){return on(lH.getTemplate(e))}function K3(e){return on(rH.getTemplate(e))}function $3(){const e=Fp.getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return on(e)}function Y3(){return on(RW.getTemplate())}function X3(e,t){return on(bW.getTemplate(e,t))}function Z3(e){const t=new Array(e).fill(void 0).map((s,n)=>({Id:`rId${n+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:`worksheets/sheet${n+1}.xml`})),i=Fp.getTemplate([...t,{Id:`rId${e+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:`rId${e+2}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:`rId${e+3}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}]);return on(i)}function q3(e){return on(yH.getTemplate({sheetIndex:e}))}function Q3(e){const t=Vp.get(e)||[],i=[];for(const[s,n]of t){const{index:a,type:r}=n;i.push({Id:`rId${a+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${Nd.get(s).index+1}.${Nm(r)}`})}return on(Fp.getTemplate(i))}function J3(e){return on(HW.getTemplate({sheetIndex:e}),!0)}function e5(e){const t=yl.get(e)||[],i=[];for(let s=0;s<t.length;s++){const n=t[s],a=Nd.get(n.id);if(!a)continue;const{index:r,type:o}=a;i.push({Id:`rId${s+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${r+1}.${Nm(o)}`})}return on(Fp.getTemplate(i))}function t5({drawingIndex:e,vmlDrawingIndex:t,tableName:i}={}){if(e===void 0&&t===void 0&&i===void 0)return"";const s=[];e!=null&&s.push({Id:`rId${s.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/drawing${e+1}.xml`}),t!=null&&s.push({Id:`rId${s.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Target:`../drawings/vmlDrawing${t+1}.vml`}),i!=null&&s.push({Id:`rId${s.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",Target:`../tables/${i}.xml`});const n=Fp.getTemplate(s);return on(n)}function i5(e,t){return on(L3.getTemplate({worksheet:e,currentSheet:co.length-1,config:t}))}var s5=class extends m.BaseGridSerializingSession{constructor(e){super(e),this.mixedStyles={},this.mixedStyleCounter=0,this.rows=[],this.frozenRowCount=0,this.skipFrozenRows=!1,this.frozenColumnCount=0,this.skipFrozenColumns=!1,this.config=Object.assign({},e),this.stylesByIds={},this.config.baseExcelStyles.forEach(t=>{this.stylesByIds[t.id]=t}),this.excelStyles=[...this.config.baseExcelStyles,{id:"_quotePrefix",quotePrefix:1}]}addCustomContent(e){e.forEach(t=>{const i=this.rows.length+1;let s;!this.config.suppressRowOutline&&t.outlineLevel!=null&&(s=t.outlineLevel);const n={height:Rm(i,t.height||this.config.rowHeight),cells:(t.cells||[]).map((a,r)=>{var u,p,g;const o=this.addImage(i,this.columnsToExport[r],(u=a.data)==null?void 0:u.value);let l=null;a.styleId&&(l=typeof a.styleId=="string"?[a.styleId]:a.styleId);const c=this.getStyleId(l);if(o)return this.createCell(c,this.getDataTypeForValue(o.value),o.value==null?"":o.value);const h=(g=(p=a.data)==null?void 0:p.value)!=null?g:"",d=this.getDataTypeForValue(h);return a.mergeAcross?this.createMergedCell(c,d,h,a.mergeAcross):this.createCell(c,d,h)}),outlineLevel:s};t.collapsed!=null&&(n.collapsed=t.collapsed),t.hidden!=null&&(n.hidden=t.hidden),this.rows.push(n)})}onNewHeaderGroupingRow(){const e=[],{freezeRows:t,headerRowHeight:i}=this.config;return this.rows.push({cells:e,height:Rm(this.rows.length+1,i)}),t&&this.frozenRowCount++,{onColumn:(s,n,a,r,o)=>{const l=this.config.styleLinker({rowType:"HEADER_GROUPING",rowIndex:1,value:`grouping-${n}`,columnGroup:s});e.push(E(b({},this.createMergedCell(this.getStyleId(l),this.getDataTypeForValue("string"),n,r)),{collapsibleRanges:o}))}}}onNewHeaderRow(){const{freezeRows:e,headerRowHeight:t}=this.config;return e&&this.frozenRowCount++,this.onNewRow(this.onNewHeaderColumn,t)}onNewBodyRow(e){const{freezeRows:t,rowHeight:i}=this.config;this.skipFrozenRows||(t==="headersAndPinnedRows"&&(e==null?void 0:e.rowPinned)==="top"?this.frozenRowCount++:typeof t=="function"?t((0,m._addGridCommonParams)(this.gos,{node:e}))?this.frozenRowCount++:this.skipFrozenRows=!0:this.skipFrozenRows=!0);const s=this.onNewRow(this.onNewBodyColumn,i);return e&&this.addRowOutlineIfNecessary(e),s}prepare(e){super.prepare(e),this.columnsToExport=[...e],this.cols=e.map((t,i)=>this.convertColumnToExcel(t,i))}parse(){const e=this.rows.reduce((n,a)=>Math.max(n,a.cells.length),0);for(;this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));const{config:t}=this;let i;if(t.sheetName!=null){const{sheetName:n}=t,a=typeof n=="function"?n((0,m._addGridCommonParams)(this.gos,{})):n;i=String(a).substring(0,31)}else i="ag-grid";const s={name:i,table:{columns:this.cols,rows:this.rows}};return this.createExcel(s)}addRowOutlineIfNecessary(e){const{gos:t,suppressRowOutline:i,rowGroupExpandState:s="expanded"}=this.config;if(t.get("groupHideOpenParents")||i||e.level==null)return;const a=e.footer?1:0,r=(0,m._last)(this.rows),o=Math.min(e.level+a,7);if(r.outlineLevel=o,s==="expanded")return;const l=s==="collapsed";if(e.isExpandable()){const c=!l&&e.expanded;r.collapsed=!c}r.hidden=!!e.parent&&e.parent.level!==-1&&(l||this.isAnyParentCollapsed(e.parent))}isAnyParentCollapsed(e){for(;e&&e.level!==-1;){if(!e.expanded)return!0;e=e.parent}return!1}convertColumnToExcel(e,t){const i=this.config.columnWidth,s=e?this.extractHeaderValue(e):void 0,n=s!=null?s:"",a=e?e.isFilterAllowed():!1;return i?typeof i=="number"?{width:i,displayName:n,filterAllowed:a}:{width:i({column:e,index:t}),displayName:n,filterAllowed:a}:e?{width:Math.max(e.getActualWidth(),75),displayName:n,filterAllowed:a}:{displayName:n,filterAllowed:a}}onNewHeaderColumn(e,t){return i=>{const s=this.extractHeaderValue(i),n=this.config.styleLinker({rowType:"HEADER",rowIndex:e,value:s,column:i});t.push(this.createCell(this.getStyleId(n),this.getDataTypeForValue("string"),s))}}onNewBodyColumn(e,t){let i=0;const{freezeColumns:s,rightToLeft:n}=this.config;return(a,r,o)=>{if(i>0){i-=1;return}if(!this.skipFrozenColumns){const g=a.getPinned();s==="pinned"&&g&&(g===!0||g==="left")!==n?this.frozenColumnCount++:typeof s=="function"&&s((0,m._addGridCommonParams)(this.gos,{column:a}))?this.frozenColumnCount++:this.skipFrozenColumns=!0}const{value:l,valueFormatted:c}=this.extractRowCellValue(a,r,e,"excel",o),h=this.config.styleLinker({rowType:"BODY",rowIndex:e,value:l,column:a,node:o}),d=this.getStyleId(h),u=a.getColSpan(o),p=this.addImage(e,a,l);p?t.push(this.createCell(d,this.getDataTypeForValue(p.value),p.value==null?"":p.value)):u>1?(i=u-1,t.push(this.createMergedCell(d,this.getDataTypeForValue(l),l,u-1))):t.push(this.createCell(d,this.getDataTypeForValue(l),l,c))}}onNewRow(e,t){const i=[];return this.rows.push({cells:i,height:Rm(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,i)()}}createExcel(e){const{excelStyles:t,config:i}=this;return this.frozenColumnCount&&(i.frozenColumnCount=this.frozenColumnCount),this.frozenRowCount&&(i.frozenRowCount=this.frozenRowCount),N3(t,e,i)}getDataTypeForValue(e){return e===void 0?"empty":this.isNumerical(e)?"n":"s"}getTypeFromStyle(e,t){if(this.isFormula(t))return"f";if(e&&e.dataType)switch(e.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:(0,m._warn)(162,{id:e.id,dataType:e.dataType})}return null}addImage(e,t,i){if(!this.config.addImageToCell)return;const s=this.config.addImageToCell(e,t,i);if(s)return z3(s.image,e,t,this.columnsToExport,this.config.rowHeight),s}createCell(e,t,i,s){const n=this.getStyleById(e);!(n!=null&&n.dataType)&&t==="s"&&s!=null&&(i=s);const a=this.getTypeFromStyle(n,i)||t,{value:r,escaped:o}=this.getCellValue(a,i),l=[];return n&&l.push(e),o&&l.push("_quotePrefix"),e=this.getStyleId(l)||void 0,{styleId:e,data:{type:a,value:r}}}createMergedCell(e,t,i,s){const n=i==null?"":i;return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:t==="s"?ak(n).toString():i},mergeAcross:s}}getCellValue(e,t){let i=!1;if(t==null||e==="s"&&t==="")return{value:"",escaped:!1};if(e==="s")t&&t[0]==="'"&&(i=!0,t=t.slice(1)),t=ak(t).toString();else if(e==="f")t=t.slice(1);else if(e==="n"){const s=Number(t);isNaN(s)?t="":t!==""&&(t=s.toString())}return{value:t,escaped:i}}getStyleId(e){if(!e||!e.length)return null;if(e.length===1)return e[0];const t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID}deepCloneObject(e){return JSON.parse(JSON.stringify(e))}addNewMixedStyle(e){this.mixedStyleCounter+=1;const t=`mixedStyle${this.mixedStyleCounter}`,i={};for(const n of e)for(const a of this.excelStyles)a.id===n&&(0,m._mergeDeep)(i,this.deepCloneObject(a));i.id=t;const s=e.join("-");this.mixedStyles[s]={excelID:t,key:s,result:i},this.excelStyles.push(i),this.stylesByIds[t]=i}isFormula(e){return e==null?!1:this.config.autoConvertFormulas&&e.toString().startsWith("=")}isNumerical(e){return typeof e=="bigint"?!0:isFinite(e)&&e!==""&&!isNaN(parseFloat(e))}getStyleById(e){return e==null?null:this.stylesByIds[e]||null}},n5=async e=>{let t=0;const i=[],s=new WritableStream({write:r=>{i.push(r),t+=r.length}}),n=new ReadableStream({start:r=>{const o=new FileReader;o.onload=l=>{var c;(c=l.target)!=null&&c.result&&r.enqueue(l.target.result),r.close()},o.readAsArrayBuffer(e)}}),a=new window.CompressionStream("deflate-raw");return await n.pipeThrough(a).pipeTo(s),{size:t,content:new Blob(i)}},a5=async e=>{const t=new Blob([e]),{size:i,content:s}=await n5(t),n=new Uint8Array(await s.arrayBuffer());return{size:i,content:n}},r5=e=>{let t=e.getHours();return t<<=6,t=t|e.getMinutes(),t<<=5,t=t|e.getSeconds()/2,t},o5=e=>{let t=e.getFullYear()-1980;return t<<=4,t=t|e.getMonth()+1,t<<=5,t=t|e.getDate(),t};function _s(e,t){let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(e&255),e>>>=8;return i}var ok=e=>{if(!e.length)return 0;let t=-1,i=0,s=0,n=0;for(let a=0;a<e.length;a++)i=e[a],s=(t^i)&255,n=l5[s],t=t>>>8^n;return t^-1},lk=e=>e.length?ok(typeof e=="string"?new TextEncoder().encode(e):e):0,l5=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function c5(e){const t=String.fromCharCode;function i(d){const u=[];if(!d)return[];const p=d.length;let g=0,f,y;for(;g<p;)f=d.charCodeAt(g++),f>=55296&&f<=56319&&g<p?(y=d.charCodeAt(g++),(y&64512)==56320?u.push(((f&1023)<<10)+(y&1023)+65536):(u.push(f),g--)):u.push(f);return u}function s(d){if(d>=55296&&d<=57343)throw Error((0,m._errMsg)(255,{point:d}))}function n(d,u){return t(d>>u&63|128)}function a(d){if((d&4294967168)==0)return t(d);let u="";return(d&4294965248)==0?u=t(d>>6&31|192):(d&4294901760)==0?(s(d),u=t(d>>12&15|224),u+=n(d,6)):(d&4292870144)==0&&(u=t(d>>18&7|240),u+=n(d,12),u+=n(d,6)),u+=t(d&63|128),u}const r=i(e),o=r.length;let l=-1,c,h="";for(;++l<o;)c=r[l],h+=a(c);return h}var ck=(e,t,i,s,n,a)=>{const{content:r,path:o,created:l}=e,c=r5(l),h=o5(l),d=lk(n),u=a!==void 0?a:s,p=c5(o),g=p!==o;let f="";if(g){const S=_s(1,1)+_s(lk(p),4)+p;f="up"+_s(S.length,2)+S}const y="\0"+(g?"\0\b":"\0\0")+_s(t?8:0,2)+_s(c,2)+_s(h,2)+_s(u?d:0,4)+_s(a!=null?a:s,4)+_s(s,4)+_s(p.length,2)+_s(f.length,2),v="PK"+y+p+f,x="PK\0"+y+"\0\0\0\0\0\0"+(r?"\0\0\0\0":"\0\0\0")+_s(i,4)+p+f;return{localFileHeader:Uint8Array.from(v,S=>S.charCodeAt(0)),centralDirectoryHeader:Uint8Array.from(x,S=>S.charCodeAt(0))}},hk=e=>{let t;if(typeof e=="string"){const i=atob(e.split(";base64,")[1]);t=Uint8Array.from(i,s=>s.charCodeAt(0))}else t=e;return{size:t.length,content:t}},h5=async(e,t)=>{const{content:i}=e,{size:s,content:n}=i?hk(i):{size:0,content:Uint8Array.from([])};let a,r,o=!1;if(e.type==="file"&&n&&s>0){const h=await a5(n);a=h.content,r=h.size,o=!0}const c=ck(e,o,t,s,n,r);return E(b({},c),{content:a||n,isCompressed:o})},d5=(e,t)=>{const{content:i}=e,{content:s}=i?hk(i):{content:Uint8Array.from([])},n=ck(e,!1,t,s.length,s,void 0);return E(b({},n),{content:s,isCompressed:!1})},u5=(e,t,i)=>{const s="PK\0\0\0\0"+_s(e,2)+_s(e,2)+_s(t,4)+_s(i,4)+"\0\0";return Uint8Array.from(s,n=>n.charCodeAt(0))},dk=class{constructor(){this.folders=[],this.files=[]}addFolders(e){e.forEach(this.addFolder.bind(this))}addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1,type:"folder"})}addFile(e,t,i=!1){this.files.push({path:e,created:new Date,content:i?t:new TextEncoder().encode(t),isBase64:i,type:"file"})}async getZipFile(e="application/zip"){const t=await this.buildCompressedFileStream();return this.clearStream(),new Blob([t],{type:e})}getUncompressedZipFile(e="application/zip"){const t=this.buildFileStream();return this.clearStream(),new Blob([t],{type:e})}clearStream(){this.folders=[],this.files=[]}packageFiles(e){let t=0,i=0;for(const c of e){const{localFileHeader:h,centralDirectoryHeader:d,content:u}=c;t+=h.length+u.length,i+=d.length}const s=new Uint8Array(t),n=new Uint8Array(i);let a=0,r=0;for(const c of e){const{localFileHeader:h,centralDirectoryHeader:d,content:u}=c;s.set(h,a),a+=h.length,s.set(u,a),a+=u.length,n.set(d,r),r+=d.length}const o=u5(e.length,i,t),l=new Uint8Array(s.length+n.length+o.length);return l.set(s),l.set(n,s.length),l.set(o,s.length+n.length),l}async buildCompressedFileStream(){const e=[...this.folders,...this.files],t=[];let i=0;for(const s of e){const n=await h5(s,i),{localFileHeader:a,content:r}=n;t.push(n),i+=a.length+r.length}return this.packageFiles(t)}buildFileStream(){const e=[...this.folders,...this.files],t=[];let i=0;for(const s of e){const n=d5(s,i),{localFileHeader:a,content:r}=n;t.push(n),i+=a.length+r.length}return this.packageFiles(t)}},p5=e=>{if(e.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]),!Wc.size)return;e.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);let t=0;Wc.forEach(i=>{const s=i[0].image[0],{base64:n,imageType:a}=s;e.addFile(`xl/media/image${++t}.${Nm(a)}`,n,!0)})},g5=(e,t)=>{let i=0,s=0;for(let n=0;n<t.length;n++){const a=t[n];e.addFile(`xl/worksheets/sheet${n+1}.xml`,a,!1);const r=Wc.size>0&&Uc.has(n),o=ho.size>0&&ho.get(n),l=Wc.size&&yl.has(n);if(!r&&!o&&!l)continue;let c,h,d;r&&(f5(e,n,i),h=i,i++),l&&(m5(e,n,s),d=s,s++),o&&(c=o.name);const u=`xl/worksheets/_rels/sheet${n+1}.xml.rels`;e.addFile(u,t5({tableName:c,drawingIndex:h,vmlDrawingIndex:d}))}},f5=(e,t,i)=>{const s="xl/drawings",n=`${s}/drawing${i+1}.xml`,a=`${s}/_rels/drawing${i+1}.xml.rels`;e.addFile(a,Q3(t)),e.addFile(n,q3(t))},m5=(e,t,i)=>{const s="xl/drawings",n=`${s}/vmlDrawing${i+1}.vml`,a=`${s}/_rels/vmlDrawing${i+1}.vml.rels`;e.addFile(n,J3(t)),e.addFile(a,e5(t))},y5=e=>{const t=ho,i=Array.from(t.keys());for(let s=0;s<i.length;s++){const n=i[s],a=t.get(n);a&&e.addFile(`xl/tables/${a.name}.xml`,X3(a,s))}},v5=(e,t,i,s,n)=>{e.addFile("xl/workbook.xml",j3(n)),e.addFile("xl/styles.xml",H3(t)),e.addFile("xl/sharedStrings.xml",W3()),e.addFile("xl/theme/theme1.xml",Y3()),e.addFile("xl/_rels/workbook.xml.rels",Z3(s)),e.addFile("docProps/core.xml",U3(i)),e.addFile("[Content_Types].xml",K3(s)),e.addFile("_rels/.rels",$3())},uk=(e,t,i={})=>{if(!t||t.length===0)return(0,m._warn)(159),rk(),!1;const{fontSize:s=11,author:n="AG Grid",activeTab:a=0}=i,r=t.length,o=Math.max(Math.min(a,r-1),0);return p5(e),y5(e),g5(e,t),v5(e,s,n,r,o),rk(),!0},pk=e=>{const{data:t,fontSize:i,author:s,activeSheetIndex:n}=e,a=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",r=new dk;return uk(r,t,{author:s,fontSize:i,activeTab:n})?r.getZipFile(a):Promise.resolve(void 0)},gk=e=>{const{data:t,fontSize:i,author:s,activeSheetIndex:n}=e,a=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",r=new dk;if(uk(r,t,{author:s,fontSize:i,activeTab:n}))return r.getUncompressedZipFile(a)},b5=e=>{const{fileName:t="export.xlsx"}=e;pk(e).then(i=>{if(i){const s=typeof t=="function"?t():t;(0,m._downloadFile)(s,i)}})},x5=class extends m.BaseCreator{constructor(){super(...arguments),this.beanName="excelCreator"}getMergedParams(e){const t=this.gos.get("defaultExcelExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){(0,m._warn)(160);return}const t=this.getMergedParams(e),s={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};this.packageCompressedFile(s).then(n=>{if(n){const{fileName:a}=t,r=typeof a=="function"?a((0,m._addGridCommonParams)(this.gos,{})):a;(0,m._downloadFile)(this.getFileName(r),n)}})}exportDataAsExcel(e){this.export(e)}getDataAsExcel(e){const t=this.getMergedParams(e),s={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(s)}setFactoryMode(e){R3(e)}getFactoryMode(){return E3()}getSheetDataForExcel(e){const t=this.getMergedParams(e);return this.getData(t)}getMultipleSheetsAsExcel(e){return gk(e)}exportMultipleSheetsAsExcel(e){b5(e)}getDefaultFileExtension(){return"xlsx"}createSerializingSession(e){var o;const{colModel:t,colNames:i,rowGroupColsSvc:s,valueSvc:n,gos:a}=this.beans,r=E(b({},e),{colModel:t,colNames:i,rowGroupColsSvc:s,valueSvc:n,gos:a,suppressRowOutline:e.suppressRowOutline||e.skipRowGroups,headerRowHeight:e.headerRowHeight||e.rowHeight,baseExcelStyles:a.get("excelStyles")||[],rightToLeft:(o=e.rightToLeft)!=null?o:a.get("enableRtl"),styleLinker:this.styleLinker.bind(this)});return new s5(r)}styleLinker(e){const{rowType:t,rowIndex:i,value:s,column:n,columnGroup:a,node:r}=e,o=t==="HEADER",l=t==="HEADER_GROUPING",c=o?n:a;let h=[];const{gos:d,cellStyles:u}=this.beans;if(o||l)return h.push("header"),l&&h.push("headerGroup"),c&&(h=h.concat((0,m._getHeaderClassesFromColDef)(c.getDefinition(),d,n||null,a||null))),h;const p=d.get("excelStyles"),g=["cell"];if(!p||!p.length)return g;const f=p.map(v=>v.id),y=n.getDefinition();return u==null||u.processAllCellClasses(y,(0,m._addGridCommonParams)(d,{value:s,data:r.data,node:r,colDef:y,column:n,rowIndex:i}),v=>{f.indexOf(v)>-1&&g.push(v)}),g.sort((v,x)=>f.indexOf(v)<f.indexOf(x)?-1:1)}isExportSuppressed(){return this.gos.get("suppressExcelExport")}packageCompressedFile(e){return pk(e)}packageFile(e){return gk(e)}},Re="33.3.2",St={moduleName:"EnterpriseCore",version:Re,beans:[UT],icons:{accordionOpen:"tree-open",accordionClosed:"tree-closed",accordionIndeterminate:"tree-indeterminate",close:"cross",cancel:"cancel",maximize:"maximize",minimize:"minimize",columnDrag:"grip"},dependsOn:[]},C5='.ag-advanced-filter-header{align-items:center;background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);display:flex;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);position:relative}.ag-advanced-filter{align-items:center;display:flex;width:100%}.ag-advanced-filter-apply-button,.ag-advanced-filter-builder-button{line-height:normal;white-space:nowrap}:where(.ag-ltr) .ag-advanced-filter-apply-button,:where(.ag-ltr) .ag-advanced-filter-builder-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-advanced-filter-apply-button,:where(.ag-rtl) .ag-advanced-filter-builder-button{margin-right:calc(var(--ag-spacing)*2)}.ag-advanced-filter-builder-button{align-items:center;background-color:unset;border:0;display:flex;font-size:var(--ag-font-size);font-weight:600;padding:var(--ag-spacing);&:where(:not(:disabled)){cursor:pointer;&:hover{background-color:var(--ag-row-hover-color)}}}:where(.ag-ltr) .ag-advanced-filter-builder-button-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) .ag-advanced-filter-builder-button-label{margin-right:var(--ag-spacing)}.ag-advanced-filter-builder{display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%}.ag-advanced-filter-builder-list{flex:1;overflow:auto}.ag-advanced-filter-builder-button-panel{border-top:var(--ag-advanced-filter-builder-button-bar-border);display:flex;justify-content:flex-end;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-advanced-filter-builder-apply-button,:where(.ag-ltr) .ag-advanced-filter-builder-cancel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-advanced-filter-builder-apply-button,:where(.ag-rtl) .ag-advanced-filter-builder-cancel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-advanced-filter-builder-item-wrapper{align-items:center;display:flex;flex:1 1 auto;justify-content:space-between;overflow:hidden}:where(.ag-ltr) .ag-advanced-filter-builder-item-wrapper{padding-left:calc(var(--ag-icon-size)/2);padding-right:var(--ag-icon-size)}:where(.ag-rtl) .ag-advanced-filter-builder-item-wrapper{padding-left:var(--ag-icon-size);padding-right:calc(var(--ag-icon-size)/2)}:where(.ag-virtual-list-viewport .ag-advanced-filter-builder-item-wrapper) .ag-tab-guard{position:absolute}.ag-advanced-filter-builder-item-tree-lines>*{width:var(--ag-advanced-filter-builder-indent-size)}.ag-advanced-filter-builder-item-tree-line-root{width:var(--ag-icon-size);&:before{height:50%;top:50%}}.ag-advanced-filter-builder-item-tree-line-horizontal,.ag-advanced-filter-builder-item-tree-line-vertical,.ag-advanced-filter-builder-item-tree-line-vertical-bottom,.ag-advanced-filter-builder-item-tree-line-vertical-top{align-items:center;display:flex;height:100%;position:relative;&:after,&:before{content:"";height:100%;position:absolute}}.ag-advanced-filter-builder-item-tree-line-horizontal:after{border-bottom:1px solid var(--ag-border-color);height:50%;top:0;width:calc(var(--ag-advanced-filter-builder-indent-size) - var(--ag-icon-size))}:where(.ag-ltr) .ag-advanced-filter-builder-item-tree-line-horizontal:after{left:calc(var(--ag-icon-size)/2)}:where(.ag-rtl) .ag-advanced-filter-builder-item-tree-line-horizontal:after{right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-tree-line-vertical:before{top:0;width:calc(var(--ag-advanced-filter-builder-indent-size) - var(--ag-icon-size)/2)}:where(.ag-ltr) .ag-advanced-filter-builder-item-tree-line-vertical:before{border-left:1px solid var(--ag-border-color);left:calc(var(--ag-icon-size)/2)}:where(.ag-rtl) .ag-advanced-filter-builder-item-tree-line-vertical:before{border-right:1px solid var(--ag-border-color);right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-tree-line-vertical-top:before{height:50%;top:0;width:calc(var(--ag-advanced-filter-builder-indent-size) - var(--ag-icon-size)/2)}:where(.ag-ltr) .ag-advanced-filter-builder-item-tree-line-vertical-top:before{border-left:1px solid var(--ag-border-color);left:calc(var(--ag-icon-size)/2)}:where(.ag-rtl) .ag-advanced-filter-builder-item-tree-line-vertical-top:before{border-right:1px solid var(--ag-border-color);right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-tree-line-vertical-bottom:before{height:calc(50% - var(--ag-icon-size)*1.5/2);top:calc(50% + var(--ag-icon-size)*1.5/2);width:calc(var(--ag-icon-size)/2)}:where(.ag-ltr) .ag-advanced-filter-builder-item-tree-line-vertical-bottom:before{border-left:1px solid var(--ag-border-color);left:calc(var(--ag-icon-size)/2)}:where(.ag-rtl) .ag-advanced-filter-builder-item-tree-line-vertical-bottom:before{border-right:1px solid var(--ag-border-color);right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-condition{padding-bottom:var(--ag-spacing);padding-top:var(--ag-spacing)}.ag-advanced-filter-builder-item,.ag-advanced-filter-builder-item-buttons,.ag-advanced-filter-builder-item-condition,.ag-advanced-filter-builder-item-tree-lines,.ag-advanced-filter-builder-pill,.ag-advanced-filter-builder-pill-wrapper{align-items:center;display:flex;height:100%}.ag-advanced-filter-builder-pill-wrapper{margin:0 var(--ag-spacing)}.ag-advanced-filter-builder-pill{border-radius:var(--ag-border-radius);min-height:calc(100% - var(--ag-spacing)*3);min-width:calc(var(--ag-spacing)*2);padding:var(--ag-spacing) calc(var(--ag-spacing)*2);position:relative}:where(.ag-advanced-filter-builder-pill){.ag-advanced-filter-builder-value-number{font-family:monospace;font-weight:700}.ag-advanced-filter-builder-value-empty{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-advanced-filter-builder-pill){.ag-picker-field-display{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-advanced-filter-builder-pill){.ag-picker-field-display{margin-left:var(--ag-spacing)}}.ag-advanced-filter-builder-pill-display{font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-advanced-filter-builder-join-pill{background-color:var(--ag-advanced-filter-builder-join-pill-color);cursor:pointer}.ag-advanced-filter-builder-column-pill{background-color:var(--ag-advanced-filter-builder-column-pill-color);cursor:pointer}.ag-advanced-filter-builder-option-pill{background-color:var(--ag-advanced-filter-builder-option-pill-color);cursor:pointer}.ag-advanced-filter-builder-value-pill{background-color:var(--ag-advanced-filter-builder-value-pill-color);cursor:text;max-width:140px;:where(.ag-advanced-filter-builder-pill-display){display:block}}.ag-advanced-filter-builder-item-buttons>*{margin:0 calc(var(--ag-spacing)*.5)}.ag-advanced-filter-builder-item-button{color:var(--ag-subtle-text-color);cursor:pointer;position:relative}.ag-advanced-filter-builder-item-button,.ag-advanced-filter-builder-pill{&:focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-advanced-filter-builder-item-button-disabled{cursor:default;opacity:.5}.ag-advanced-filter-builder-virtual-list-container{top:var(--ag-spacing)}.ag-advanced-filter-builder-virtual-list-item{cursor:default;display:flex;height:var(--ag-list-item-height);&:hover{background-color:var(--ag-row-hover-color);:where(.ag-advanced-filter-builder-item-button){opacity:1}}}.ag-advanced-filter-builder-invalid{color:var(--ag-invalid-color);cursor:default;margin:0 var(--ag-spacing)}:where(.ag-advanced-filter-builder-validation) .ag-advanced-filter-builder-invalid,:where(.ag-advanced-filter-builder-virtual-list-item-highlight) .ag-advanced-filter-builder-item-button:focus-visible{opacity:1}';function S5(e){var t,i;return(i=(t=e.filterManager)==null?void 0:t.getAdvFilterModel())!=null?i:null}function M5(e,t){var i;(i=e.filterManager)==null||i.setAdvFilterModel(t)}function D5(e){var t;(t=e.filterManager)==null||t.toggleAdvFilterBuilder(!0,"api")}function w5(e){var t;(t=e.filterManager)==null||t.toggleAdvFilterBuilder(!1,"api")}var A5={ariaAdvancedFilterBuilderItem:e=>`${e[0]}. Level ${e[1]}. Press ENTER to edit`,ariaAdvancedFilterBuilderItemValidation:e=>`${e[0]}. Level ${e[1]}. ${e[2]} Press ENTER to edit`,ariaAdvancedFilterBuilderList:"Advanced Filter Builder List",ariaAdvancedFilterBuilderFilterItem:"Filter Condition",ariaAdvancedFilterBuilderGroupItem:"Filter Group",ariaAdvancedFilterBuilderColumn:"Column",ariaAdvancedFilterBuilderOption:"Option",ariaAdvancedFilterBuilderValue:"Value",ariaAdvancedFilterBuilderJoinOperator:"Join Operator",ariaAdvancedFilterInput:"Advanced Filter Input",ariaLabelAdvancedFilterAutocomplete:"Advanced Filter Autocomplete",advancedFilterContains:"contains",advancedFilterNotContains:"does not contain",advancedFilterTextEquals:"equals",advancedFilterTextNotEqual:"does not equal",advancedFilterStartsWith:"begins with",advancedFilterEndsWith:"ends with",advancedFilterBlank:"is blank",advancedFilterNotBlank:"is not blank",advancedFilterEquals:"=",advancedFilterNotEqual:"!=",advancedFilterGreaterThan:">",advancedFilterGreaterThanOrEqual:">=",advancedFilterLessThan:"<",advancedFilterLessThanOrEqual:"<=",advancedFilterTrue:"is true",advancedFilterFalse:"is false",advancedFilterAnd:"AND",advancedFilterOr:"OR",advancedFilterApply:"Apply",advancedFilterBuilder:"Builder",advancedFilterValidationMissingColumn:"Column is missing",advancedFilterValidationMissingOption:"Option is missing",advancedFilterValidationMissingValue:"Value is missing",advancedFilterValidationInvalidColumn:"Column not found",advancedFilterValidationInvalidOption:"Option not found",advancedFilterValidationMissingQuote:"Value is missing an end quote",advancedFilterValidationNotANumber:"Value is not a number",advancedFilterValidationInvalidDate:"Value is not a valid date",advancedFilterValidationMissingCondition:"Condition is missing",advancedFilterValidationJoinOperatorMismatch:"Join operators within a condition must be the same",advancedFilterValidationInvalidJoinOperator:"Join operator not found",advancedFilterValidationMissingEndBracket:"Missing end bracket",advancedFilterValidationExtraEndBracket:"Too many end brackets",advancedFilterValidationMessage:e=>`Expression has an error. ${e[0]} - ${e[1]}.`,advancedFilterValidationMessageAtEnd:e=>`Expression has an error. ${e[0]} at end of expression.`,advancedFilterBuilderTitle:"Advanced Filter",advancedFilterBuilderApply:"Apply",advancedFilterBuilderCancel:"Cancel",advancedFilterBuilderAddButtonTooltip:"Add Filter or Group",advancedFilterBuilderRemoveButtonTooltip:"Remove",advancedFilterBuilderMoveUpButtonTooltip:"Move Up",advancedFilterBuilderMoveDownButtonTooltip:"Move Down",advancedFilterBuilderAddJoin:"Add Group",advancedFilterBuilderAddCondition:"Add Filter",advancedFilterBuilderSelectColumn:"Select a column",advancedFilterBuilderSelectOption:"Select an option",advancedFilterBuilderEnterValue:"Enter a value...",advancedFilterBuilderValidationAlreadyApplied:"Current filter already applied.",advancedFilterBuilderValidationIncomplete:"Not all conditions are complete.",advancedFilterBuilderValidationSelectColumn:"Must select a column.",advancedFilterBuilderValidationSelectOption:"Must select an option.",advancedFilterBuilderValidationEnterValue:"Must enter a value."};function sS(e,t,i){if(!e)return"";const s=i-t;return s?e.slice(0,e.length-s):e}function vl(e,t,i,s,n,a,r){const o=i+(!e.length||r?0:1);let l=0;return n&&(e[o]===" "?l=1:(s+=" ",a&&(s+='"'))),{updatedValue:e.slice(0,t)+s+e.slice(o),updatedPosition:t+s.length+l}}function I5(e,t,i){let s=t;for(;s<i&&e[s]===" ";)s++;return s}function nS(e,t,i,s){let n=t,a=!1;for(;n<e.length;){const r=e[n];if(r==="("){s&&e[n-1]===" "?a=!0:n=n-1;break}else if(r===" "||i&&r===")"){n=n-1;break}n++}return{endPosition:n,isEmpty:a}}function aS(e,t,i,s){i!==t&&(e.expression=vl(e.expression,s-t.length+1,s,i).updatedValue)}function T5(e){return e.replace(/(['"])/,"\\$1")}var k5=class{constructor(e,t){this.params=e,this.startPosition=t,this.type="column",this.valid=!0,this.hasStartChar=!1,this.hasEndChar=!1,this.colName=""}parse(e,t){if(e===rS&&!this.colName)this.hasStartChar=!0;else if(e===oS&&this.hasStartChar){if(this.parseColumn(!1,t))return this.hasEndChar=!0,!1;this.colName+=e}else this.colName+=e}getDisplayValue(){return(this.hasStartChar?rS:"")+this.colName+(this.hasEndChar?oS:"")}getColId(){return this.colId}complete(e){this.parseColumn(!0,e)}getValidationError(){var e;return this.valid?null:{message:this.params.advFilterExpSvc.translate("advancedFilterValidationInvalidColumn"),startPosition:this.startPosition,endPosition:(e=this.endPosition)!=null?e:this.params.expression.length-1}}parseColumn(e,t){var s,n;this.endPosition=t;const i=this.params.advFilterExpSvc.getColId(this.colName);return i&&this.hasStartChar&&(this.colId=i.colId,aS(this.params,this.colName,i.columnName,t-1),this.colName=i.columnName,this.column=this.params.colModel.getColDefCol(this.colId),this.column)?(this.baseCellDataType=(n=(s=this.params.dataTypeSvc)==null?void 0:s.getBaseDataType(this.column))!=null?n:"text",!0):(e&&(this.valid=!1),this.baseCellDataType="text",!1)}},L5=class{constructor(e,t,i){this.params=e,this.startPosition=t,this.baseCellDataType=i,this.type="operator",this.valid=!0,this.expectedNumOperands=0,this.operator=""}parse(e,t){if(e===" "||e===")"){if(this.parseOperator(!1,t-1))return!0;this.operator+=e}else this.operator+=e}complete(e){this.parseOperator(!0,e)}getValidationError(){var e;return this.valid?null:{message:this.params.advFilterExpSvc.translate("advancedFilterValidationInvalidOption"),startPosition:this.startPosition,endPosition:(e=this.endPosition)!=null?e:this.params.expression.length-1}}getDisplayValue(){return this.operator}getOperatorKey(){return this.parsedOperator}parseOperator(e,t){const i=this.params.advFilterExpSvc.getDataTypeExpressionOperator(this.baseCellDataType),s=i.findOperator(this.operator);if(this.endPosition=t,s){this.parsedOperator=s;const a=i.operators[s];this.expectedNumOperands=a.numOperands;const r=a.displayValue;return aS(this.params,this.operator,r,t),this.operator=r,!0}return(e||!(s===null))&&(this.valid=!1),!1}},P5=class{constructor(e,t,i,s){this.params=e,this.startPosition=t,this.baseCellDataType=i,this.column=s,this.type="operand",this.valid=!0,this.operand="",this.validationMessage=null}parse(e,t){if(e===" ")if(this.quotes)this.operand+=e;else return this.parseOperand(!1,t),!0;else if(e===")"){if(this.baseCellDataType==="number"||!this.quotes)return this.parseOperand(!1,t-1),!0;this.operand+=e}else if(!this.operand&&!this.quotes&&(e==="'"||e==='"'))this.quotes=e;else{if(this.quotes&&e===this.quotes)return this.parseOperand(!1,t),!1;this.operand+=e}}complete(e){this.parseOperand(!0,e)}getValidationError(){var e;return this.validationMessage?{message:this.validationMessage,startPosition:this.startPosition,endPosition:(e=this.endPosition)!=null?e:this.params.expression.length-1}:null}getRawValue(){return this.operand}getModelValue(){return this.modelValue}parseOperand(e,t){const{advFilterExpSvc:i}=this.params;if(this.endPosition=t,this.modelValue=this.operand,e&&this.quotes)this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationMissingQuote");else if(this.modelValue==="")this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationMissingValue");else{const s=i.getOperandModelValue(this.operand,this.baseCellDataType,this.column);switch(s!=null&&(this.modelValue=s),this.baseCellDataType){case"number":(this.quotes||isNaN(this.modelValue))&&(this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationNotANumber"));break;case"date":case"dateString":s==null&&(this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationInvalidDate"));break}}}},rS="[",oS="]",E5=class{constructor(e,t){this.params=e,this.startPosition=t,this.isAwaiting=!0}parseExpression(){var i,s;let e=this.startPosition;const{expression:t}=this.params;for(;e<t.length;){const n=t[e];if(!(n===" "&&this.isAwaiting)){if(this.isAwaiting=!1,!this.parser){let r;this.columnParser?this.operatorParser?(this.operandParser=new P5(this.params,e,this.columnParser.baseCellDataType,this.columnParser.column),r=this.operandParser):(this.operatorParser=new L5(this.params,e,this.columnParser.baseCellDataType),r=this.operatorParser):(this.columnParser=new k5(this.params,e),r=this.columnParser),this.parser=r}const a=this.parser.parse(n,e);if(a!=null){if(this.isComplete())return this.returnEndPosition(a?e-1:e,!0);this.parser=void 0,this.isAwaiting=!0}}e++}return(s=(i=this.parser)==null?void 0:i.complete)==null||s.call(i,e-1),this.returnEndPosition(e)}isValid(){return this.isComplete()&&this.columnParser.valid&&this.operatorParser.valid&&(!this.operandParser||this.operandParser.valid)}getValidationError(){var s,n,a,r,o;const e=(o=(a=(s=this.columnParser)==null?void 0:s.getValidationError())!=null?a:(n=this.operatorParser)==null?void 0:n.getValidationError())!=null?o:(r=this.operandParser)==null?void 0:r.getValidationError();if(e)return e;const t=this.params.expression.length;let i;return this.columnParser?this.operatorParser?this.operatorParser.expectedNumOperands&&!this.operandParser&&(i="advancedFilterValidationMissingValue"):i="advancedFilterValidationMissingOption":i="advancedFilterValidationMissingColumn",i?{message:this.params.advFilterExpSvc.translate(i),startPosition:t,endPosition:t}:null}getFunctionString(e){return this.getFunctionCommon(e,(t,i,s,n)=>{const a=T5(s),r=t==null?"":`, params.operands[${t}]`;return`params.operators[${i}].evaluator(expressionProxy.getValue('${a}', node), node, params.evaluatorParams[${n}]${r})`})}getFunctionParsed(e){return this.getFunctionCommon(e,(t,i,s,n)=>(a,r,o)=>o.operators[i].evaluator(a.getValue(s,r),r,o.evaluatorParams[n],t==null?void 0:o.operands[t]))}getAutocompleteListParams(e){if(this.isColumnPosition(e))return this.getColumnAutocompleteListParams(e);if(this.isOperatorPosition(e))return this.getOperatorAutocompleteListParams(e);if(!this.isBeyondEndPosition(e))return{enabled:!1}}updateExpression(e,t,i){var n,a,r,o,l;const{expression:s}=this.params;if(this.isColumnPosition(e))return vl(this.params.expression,this.startPosition,(n=this.columnParser)!=null&&n.getColId()?this.columnParser.endPosition:nS(s,e).endPosition,this.params.advFilterExpSvc.getColumnValue(t),!0);if(this.isOperatorPosition(e)){const c=this.getBaseCellDataTypeFromOperatorAutocompleteType(i),h=this.hasOperand(c,t.key),d=h&&this.doesOperandNeedQuotes(c);let u;if(((a=this.operatorParser)==null?void 0:a.startPosition)!=null&&e<this.operatorParser.startPosition)u=vl(s,e,e,(r=t.displayValue)!=null?r:t.key,h,d);else{let p,g=!1;if((o=this.operatorParser)!=null&&o.getOperatorKey())p=this.operatorParser.endPosition;else{const{endPosition:f,isEmpty:y}=nS(s,e,!0,!0);p=f,g=y}u=vl(s,I5(s,this.columnParser.endPosition+1,p),p,(l=t.displayValue)!=null?l:t.key,h,d,g)}return E(b({},u),{hideAutocomplete:!h})}return null}getModel(){const e=this.columnParser.getColId(),t={filterType:this.columnParser.baseCellDataType,colId:e,type:this.operatorParser.getOperatorKey()};return this.operatorParser.expectedNumOperands&&(t.filter=this.operandParser.getModelValue()),t}getFunctionCommon(e,t){var u,p;const i=this.columnParser.getColId(),s=(u=this.operatorParser)==null?void 0:u.getOperatorKey(),{operators:n,evaluatorParams:a,operands:r}=e,o=this.params.advFilterExpSvc.getExpressionOperator(this.columnParser.baseCellDataType,s),l=this.addToListAndGetIndex(n,o),c=this.params.advFilterExpSvc.getExpressionEvaluatorParams(i),h=this.addToListAndGetIndex(a,c),d=((p=this.operatorParser)==null?void 0:p.expectedNumOperands)===0?void 0:this.addToListAndGetIndex(r,this.getOperandValue());return t(d,l,i,h)}getOperandValue(){let e=this.operandParser.getRawValue();const{baseCellDataType:t,column:i}=this.columnParser;switch(t){case"number":e=Number(e);break;case"date":case"dateString":e=this.params.valueSvc.parseValue(i,null,e,void 0);break}if(t==="dateString"){const{dataTypeSvc:s}=this.params;return s?s.getDateParserFunction(i)(e):e}return e}isComplete(){return!!(this.operatorParser&&(!this.operatorParser.expectedNumOperands||this.operatorParser.expectedNumOperands&&this.operandParser))}isColumnPosition(e){return!this.columnParser||this.columnParser.endPosition==null||e<=this.columnParser.endPosition+1}isOperatorPosition(e){return!this.operatorParser||this.operatorParser.endPosition==null||e<=this.operatorParser.endPosition+1}isBeyondEndPosition(e){return this.isComplete()&&this.endPosition!=null&&e>this.endPosition+1&&this.endPosition+1<this.params.expression.length}returnEndPosition(e,t){return this.endPosition=t?e:e-1,e}getColumnAutocompleteListParams(e){return this.params.advFilterExpSvc.generateAutocompleteListParams(this.params.advFilterExpSvc.getColumnAutocompleteEntries(),"column",this.getColumnSearchString(e))}getColumnSearchString(e){var a,r,o,l,c;const t=(r=(a=this.columnParser)==null?void 0:a.getDisplayValue())!=null?r:"",i=sS(t,e,((o=this.columnParser)==null?void 0:o.endPosition)==null?this.params.expression.length:this.columnParser.endPosition+1),s=((l=this.columnParser)==null?void 0:l.hasStartChar)&&i.length>0,n=((c=this.columnParser)==null?void 0:c.hasEndChar)&&i.length===t.length+2;return s?i.slice(1,n?-1:void 0):i}getOperatorAutocompleteListParams(e){var n,a,r,o,l;const t=(n=this.columnParser)==null?void 0:n.column;if(!t)return{enabled:!1};const i=this.columnParser.baseCellDataType,s=((a=this.operatorParser)==null?void 0:a.startPosition)!=null&&e<this.operatorParser.startPosition?"":sS((o=(r=this.operatorParser)==null?void 0:r.getDisplayValue())!=null?o:"",e,((l=this.operatorParser)==null?void 0:l.endPosition)==null?this.params.expression.length:this.operatorParser.endPosition+1);return this.params.advFilterExpSvc.generateAutocompleteListParams(this.params.advFilterExpSvc.getOperatorAutocompleteEntries(t,i),`operator-${i}`,s)}getBaseCellDataTypeFromOperatorAutocompleteType(e){return e==null?void 0:e.replace("operator-","")}hasOperand(e,t){var i,s;return!e||!t||((s=(i=this.params.advFilterExpSvc.getExpressionOperator(e,t))==null?void 0:i.numOperands)!=null?s:0)>0}doesOperandNeedQuotes(e){return e!=="number"}addToListAndGetIndex(e,t){const i=e.length;return e.push(t),i}};function Gm(e,t,i){let s=!1;const n=e.toLocaleLowerCase(),a=n+" ",r=Object.keys(t).find(o=>{const l=t[o],c=i(l).toLocaleLowerCase();return c.startsWith(a)&&(s=!0),c===n});return r||(s?null:void 0)}function lS(e,t){return(t!=null?t:Object.keys(e)).map(s=>({key:s,displayValue:e[s].displayValue}))}var fk=class{constructor(e){this.params=e,this.initOperators()}getEntries(e){return lS(this.operators,e)}findOperator(e){return Gm(e,this.operators,({displayValue:t})=>t)}initOperators(){const{translate:e}=this.params;this.operators={contains:{displayValue:e("advancedFilterContains"),evaluator:(t,i,s,n)=>this.evaluateExpression(t,i,s,n,!1,(a,r)=>a.includes(r)),numOperands:1},notContains:{displayValue:e("advancedFilterNotContains"),evaluator:(t,i,s,n)=>this.evaluateExpression(t,i,s,n,!0,(a,r)=>!a.includes(r)),numOperands:1},equals:{displayValue:e("advancedFilterTextEquals"),evaluator:(t,i,s,n)=>this.evaluateExpression(t,i,s,n,!1,(a,r)=>a===r),numOperands:1},notEqual:{displayValue:e("advancedFilterTextNotEqual"),evaluator:(t,i,s,n)=>this.evaluateExpression(t,i,s,n,!0,(a,r)=>a!=r),numOperands:1},startsWith:{displayValue:e("advancedFilterStartsWith"),evaluator:(t,i,s,n)=>this.evaluateExpression(t,i,s,n,!1,(a,r)=>a.startsWith(r)),numOperands:1},endsWith:{displayValue:e("advancedFilterEndsWith"),evaluator:(t,i,s,n)=>this.evaluateExpression(t,i,s,n,!1,(a,r)=>a.endsWith(r)),numOperands:1},blank:{displayValue:e("advancedFilterBlank"),evaluator:t=>t==null||typeof t=="string"&&t.trim().length===0,numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:t=>t!=null&&(typeof t!="string"||t.trim().length>0),numOperands:0}}}evaluateExpression(e,t,i,s,n,a){return e==null?n:i.caseSensitive?a(i.valueConverter(e,t),s):a(i.valueConverter(e,t).toLocaleLowerCase(),s.toLocaleLowerCase())}},cS=class{constructor(e){this.params=e,this.initOperators()}getEntries(e){return lS(this.operators,e)}findOperator(e){return Gm(e,this.operators,({displayValue:t})=>t)}initOperators(){const{translate:e,equals:t}=this.params;this.operators={equals:{displayValue:e("advancedFilterEquals"),evaluator:(i,s,n,a)=>this.evaluateSingleOperandExpression(i,s,n,a,!!n.includeBlanksInEquals,t),numOperands:1},notEqual:{displayValue:e("advancedFilterNotEqual"),evaluator:(i,s,n,a)=>this.evaluateSingleOperandExpression(i,s,n,a,!!n.includeBlanksInEquals,(r,o)=>!t(r,o)),numOperands:1},greaterThan:{displayValue:e("advancedFilterGreaterThan"),evaluator:(i,s,n,a)=>this.evaluateSingleOperandExpression(i,s,n,a,!!n.includeBlanksInGreaterThan,(r,o)=>r>o),numOperands:1},greaterThanOrEqual:{displayValue:e("advancedFilterGreaterThanOrEqual"),evaluator:(i,s,n,a)=>this.evaluateSingleOperandExpression(i,s,n,a,!!n.includeBlanksInGreaterThan,(r,o)=>r>=o),numOperands:1},lessThan:{displayValue:e("advancedFilterLessThan"),evaluator:(i,s,n,a)=>this.evaluateSingleOperandExpression(i,s,n,a,!!n.includeBlanksInLessThan,(r,o)=>r<o),numOperands:1},lessThanOrEqual:{displayValue:e("advancedFilterLessThanOrEqual"),evaluator:(i,s,n,a)=>this.evaluateSingleOperandExpression(i,s,n,a,!!n.includeBlanksInLessThan,(r,o)=>r<=o),numOperands:1},blank:{displayValue:e("advancedFilterBlank"),evaluator:i=>i==null,numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:i=>i!=null,numOperands:0}}}evaluateSingleOperandExpression(e,t,i,s,n,a){return e==null?n:a(i.valueConverter(e,t),s)}},R5=class{constructor(e){this.params=e,this.initOperators()}getEntries(e){return lS(this.operators,e)}findOperator(e){return Gm(e,this.operators,({displayValue:t})=>t)}initOperators(){const{translate:e}=this.params;this.operators={true:{displayValue:e("advancedFilterTrue"),evaluator:t=>!!t,numOperands:0},false:{displayValue:e("advancedFilterFalse"),evaluator:t=>t===!1,numOperands:0},blank:{displayValue:e("advancedFilterBlank"),evaluator:t=>t==null,numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:t=>t!=null,numOperands:0}}}},N5=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="advFilterExpSvc",this.columnNameToIdMap={},this.columnAutocompleteEntries=null,this.expressionEvaluatorParams={}}wireBeans(e){this.valueSvc=e.valueSvc,this.colModel=e.colModel,this.colNames=e.colNames,this.dataTypeSvc=e.dataTypeSvc}postConstruct(){this.expressionJoinOperators=this.generateExpressionJoinOperators(),this.expressionOperators=this.generateExpressionOperators()}parseJoinOperator(e){var i;const{type:t}=e;return(i=this.expressionJoinOperators[t])!=null?i:t}getColumnDisplayValue(e){const{colId:t}=e,s=this.getColumnAutocompleteEntries().find(({key:a})=>a===t);let n;return s?(n=s.displayValue,this.columnNameToIdMap[n.toLocaleUpperCase()]={colId:t,columnName:n}):n=t,n}getOperatorDisplayValue(e){var t,i;return(i=(t=this.getExpressionOperator(e.filterType,e.type))==null?void 0:t.displayValue)!=null?i:e.type}getOperandModelValue(e,t,i){var s;switch(t){case"number":return(0,m._exists)(e)?Number(e):null;case"date":return(0,m._serialiseDate)(this.valueSvc.parseValue(i,null,e,void 0),!1);case"dateString":{const n=this.valueSvc.parseValue(i,null,e,void 0);return this.dataTypeSvc?(0,m._serialiseDate)((s=this.dataTypeSvc.getDateParserFunction(i)(n))!=null?s:null,!1):n}}return e}getOperandDisplayValue(e,t){var r,o,l;const{colId:i,filter:s}=e,n=this.colModel.getColDefCol(i);let a="";if(s!=null){let c;switch(e.filterType){case"number":c=(r=(0,m._toStringOrNull)(s))!=null?r:"";break;case"date":{const h=(0,m._parseDateTimeFromString)(s);c=n?this.valueSvc.formatValue(n,null,h):null;break}case"dateString":{let h;if(this.dataTypeSvc){const d=(0,m._parseDateTimeFromString)(s);h=n?(o=this.dataTypeSvc)==null?void 0:o.getDateFormatterFunction(n)(d!=null?d:void 0):null}else h=s;c=n?this.valueSvc.formatValue(n,null,h):null;break}}e.filterType!=="number"&&(c=(l=c!=null?c:(0,m._toStringOrNull)(s))!=null?l:"",t||(c=`"${c}"`)),a=t?c:` ${c}`}return a}parseColumnFilterModel(e){var n,a;const t=(n=this.getColumnDisplayValue(e))!=null?n:"",i=(a=this.getOperatorDisplayValue(e))!=null?a:"",s=this.getOperandDisplayValue(e);return`[${t}] ${i}${s}`}updateAutocompleteCache(e,t){if(t==="column"){const{key:i,displayValue:s}=e;this.columnNameToIdMap[e.displayValue.toLocaleUpperCase()]={colId:i,columnName:s}}}translate(e,t){let i=A5[e];return typeof i=="function"&&(i=i(t)),this.getLocaleTextFunc()(e,i,t)}generateAutocompleteListParams(e,t,i){return{enabled:!0,type:t,searchString:i,entries:e}}getColumnAutocompleteEntries(){var s;if(this.columnAutocompleteEntries)return this.columnAutocompleteEntries;const e=(s=this.colModel.getColDefCols())!=null?s:[],t=[],i=this.gos.get("includeHiddenColumnsInAdvancedFilter");return e.forEach(n=>{n.getColDef().filter&&(i||n.isVisible()||n.isRowGroupActive())&&t.push({key:n.getColId(),displayValue:this.colNames.getDisplayNameForColumn(n,"advancedFilter")})}),t.sort((n,a)=>{var l,c;const r=(l=n.displayValue)!=null?l:"",o=(c=a.displayValue)!=null?c:"";return r<o?-1:o>r?1:0}),t}getOperatorAutocompleteEntries(e,t){const i=this.getActiveOperators(e);return this.getDataTypeExpressionOperator(t).getEntries(i)}getJoinOperatorAutocompleteEntries(){return Object.entries(this.expressionJoinOperators).map(([e,t])=>({key:e,displayValue:t}))}getDefaultAutocompleteListParams(e){return this.generateAutocompleteListParams(this.getColumnAutocompleteEntries(),"column",e)}getDataTypeExpressionOperator(e){return this.expressionOperators[e]}getExpressionOperator(e,t){var i,s;return(s=(i=this.getDataTypeExpressionOperator(e))==null?void 0:i.operators)==null?void 0:s[t]}getExpressionJoinOperators(){return this.expressionJoinOperators}getColId(e){const t=e.toLocaleUpperCase(),i=this.columnNameToIdMap[t];if(i)return i;const n=this.getColumnAutocompleteEntries().find(({displayValue:a})=>a.toLocaleUpperCase()===t);if(n){const{key:a,displayValue:r}=n,o={colId:a,columnName:r};return this.columnNameToIdMap[t]=o,o}return null}getExpressionEvaluatorParams(e){var a,r,o;let t=this.expressionEvaluatorParams[e];if(t)return t;const i=this.colModel.getColDefCol(e);if(!i)return{valueConverter:l=>l};switch((a=this.dataTypeSvc)==null?void 0:a.getBaseDataType(i)){case"dateString":t={valueConverter:(o=(r=this.dataTypeSvc)==null?void 0:r.getDateParserFunction(i))!=null?o:l=>l};break;case"object":i.getColDef().filterValueGetter?t={valueConverter:l=>l}:t={valueConverter:(l,c)=>{var h;return(h=this.valueSvc.formatValue(i,c,l))!=null?h:typeof l.toString=="function"?l.toString():""}};break;case"text":case void 0:t={valueConverter:l=>(0,m._toStringOrNull)(l)};break;default:t={valueConverter:l=>l};break}const{filterParams:n}=i.getColDef();return n&&["caseSensitive","includeBlanksInEquals","includeBlanksInLessThan","includeBlanksInGreaterThan"].forEach(l=>{const c=n[l];c&&(t[l]=c)}),this.expressionEvaluatorParams[e]=t,t}getColumnDetails(e){var s,n,a;const t=(s=this.colModel.getColDefCol(e))!=null?s:void 0,i=(a=t?(n=this.dataTypeSvc)==null?void 0:n.getBaseDataType(t):void 0)!=null?a:"text";return{column:t,baseCellDataType:i}}generateExpressionOperators(){const e=(t,i)=>this.translate(t,i);return{text:new fk({translate:e}),boolean:new R5({translate:e}),object:new fk({translate:e}),number:new cS({translate:e,equals:(t,i)=>t===i}),date:new cS({translate:e,equals:(t,i)=>t.getTime()===i.getTime()}),dateString:new cS({translate:e,equals:(t,i)=>t.getTime()===i.getTime()})}}getColumnValue({displayValue:e}){return`${rS}${e}${oS}`}generateExpressionJoinOperators(){return{AND:this.translate("advancedFilterAnd"),OR:this.translate("advancedFilterOr")}}getActiveOperators(e){var s;const t=(s=e.getColDef().filterParams)==null?void 0:s.filterOptions;return t&&t.every(n=>typeof n=="string")?t:void 0}resetColumnCaches(){this.columnAutocompleteEntries=null,this.columnNameToIdMap={},this.expressionEvaluatorParams={}}},O5=".ag-panel{background-color:var(--ag-panel-background-color);display:flex;flex-direction:column;overflow:hidden;position:relative}.ag-dialog{border:var(--ag-dialog-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dialog-shadow);position:absolute}.ag-panel-title-bar{align-items:center;background-color:var(--ag-panel-title-bar-background-color);border-bottom:var(--ag-panel-title-bar-border);color:var(--ag-panel-title-bar-text-color);cursor:default;display:flex;flex:none;font-weight:var(--ag-panel-title-bar-font-weight);height:var(--ag-header-height);padding:var(--ag-spacing) var(--ag-cell-horizontal-padding)}.ag-panel-title-bar-button{color:var(--ag-panel-title-bar-icon-color);cursor:pointer}:where(.ag-ltr) .ag-panel-title-bar-button{margin-left:calc(var(--ag-spacing)*2);margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-panel-title-bar-button{margin-left:var(--ag-spacing);margin-right:calc(var(--ag-spacing)*2)}.ag-panel-title-bar-title{flex:1 1 auto}.ag-panel-title-bar-buttons{display:flex}.ag-panel-content-wrapper{display:flex;flex:1 1 auto;overflow:hidden;position:relative}:where(.ag-dragging-fill-handle) .ag-dialog,:where(.ag-dragging-range-handle) .ag-dialog{opacity:.7;pointer-events:none}";function F5(e){const t=e.cssIdentifier||"default";return{tag:"div",cls:`ag-panel ag-${t}-panel`,attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eTitleBar",cls:`ag-panel-title-bar ag-${t}-panel-title-bar ag-unselectable`,children:[{tag:"span",ref:"eTitle",cls:`ag-panel-title-bar-title ag-${t}-panel-title-bar-title`},{tag:"div",ref:"eTitleBarButtons",cls:`ag-panel-title-bar-buttons ag-${t}-panel-title-bar-buttons`}]},{tag:"div",ref:"eContentWrapper",cls:`ag-panel-content-wrapper ag-${t}-panel-content-wrapper`}]}}var mk=class extends m.Component{constructor(e){super(F5(e)),this.config=e,this.closable=!0,this.eContentWrapper=m.RefPlaceholder,this.eTitleBar=m.RefPlaceholder,this.eTitleBarButtons=m.RefPlaceholder,this.eTitle=m.RefPlaceholder,this.registerCSS(O5)}postConstruct(){const{component:e,closable:t,hideTitleBar:i,title:s,minWidth:n=250,width:a,minHeight:r=250,height:o,centered:l,popup:c,x:h,y:d}=this.config;this.positionableFeature=new m.PositionableFeature(this.getGui(),{minWidth:n,width:a,minHeight:r,height:o,centered:l,x:h,y:d,popup:c,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const u=this.getGui();e&&this.setBodyComponent(e),i?(0,m._setDisplayed)(this.eTitleBar,!1):(s&&this.setTitle(s),this.setClosable(t!=null?t:this.closable)),this.addManagedElementListeners(this.eTitleBar,{mousedown:p=>{if(u.contains(p.relatedTarget)||u.contains((0,m._getActiveDomElement)(this.beans))||this.eTitleBarButtons.contains(p.target)){p.preventDefault();return}const g=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");g&&g.focus()}}),!(c&&this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const e=this.getGui();e.focus(),this.close=()=>{e.parentElement.removeChild(e),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(e){this.positionableFeature.setHeight(e)}getWidth(){return this.positionableFeature.getWidth()}setWidth(e){this.positionableFeature.setWidth(e)}setClosable(e){if(e!==this.closable&&(this.closable=e),e){const t=this.closeButtonComp=new m.Component({tag:"div",cls:"ag-button"});this.createBean(t);const i=t.getGui(),s=(0,m._createIconNoSpan)("close",this.beans);s.classList.add("ag-panel-title-bar-button-icon"),i.appendChild(s),this.addTitleBarButton(t),t.addManagedElementListeners(i,{click:this.onBtClose.bind(this)})}else if(this.closeButtonComp){const t=this.closeButtonComp.getGui();t.parentElement.removeChild(t),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())}addTitleBarButton(e,t){const i=this.eTitleBarButtons,s=i.children,n=s.length;t==null&&(t=n),t=Math.max(0,Math.min(t,n)),e.addCss("ag-panel-title-bar-button");const a=e.getGui();t===0?i.insertAdjacentElement("afterbegin",a):t===n?i.insertAdjacentElement("beforeend",a):s[t-1].insertAdjacentElement("afterend",a),e.setParentComponent(this)}getBodyHeight(){return(0,m._getInnerHeight)(this.eContentWrapper)}getBodyWidth(){return(0,m._getInnerWidth)(this.eContentWrapper)}setTitle(e){this.eTitle.innerText=e}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const e=this.getGui();e&&(0,m._isVisible)(e)&&this.close(),super.destroy()}},jp=class extends mk{constructor(e){super(E(b({},e),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){var r;const e=this.getGui(),{movable:t,resizable:i,maximizable:s,modal:n,postProcessPopupParams:a}=this.config;if(this.addCss("ag-dialog"),super.postConstruct(),a){const{type:o,eventSource:l,column:c,mouseEvent:h,rowNode:d}=a;(r=this.popupSvc)==null||r.callPostProcessPopup(o,e,l,h,c,d)}if(this.tabGuardFeature=this.createManagedBean(new m.TabGuardFeature(this)),this.tabGuardFeature.initialiseTabGuard({isFocusableContainer:!0,onFocusIn:()=>{var o;(o=this.popupSvc)==null||o.bringPopupToFront(e)},onTabKeyDown:o=>{if(n)return;const l=o.shiftKey,c=(0,m._findNextFocusableElement)(this.beans,e,!1,l);(!c||this.tabGuardFeature.getTabGuardCtrl().isTabGuard(c))&&(0,m._focusNextGridCoreContainer)(this.beans,l)&&o.preventDefault()}}),t&&this.setMovable(t),s&&this.setMaximizable(s),i&&this.setResizable(i),!this.config.modal){const o=this.beans.ctrlsSvc.get("gridCtrl");o.addFocusableContainer(this),this.addDestroyFunc(()=>o.removeFocusableContainer(this))}}setAllowFocus(e){this.tabGuardFeature.getTabGuardCtrl().setAllowFocus(e)}renderComponent(){var o;const e=this.getGui(),{alwaysOnTop:t,modal:i,title:s,afterGuiAttached:n}=this.config,a=this.getLocaleTextFunc(),r=(o=this.popupSvc)==null?void 0:o.addPopup({modal:i,eChild:e,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop:t,ariaLabel:s||a("ariaLabelDialog","Dialog"),afterGuiAttached:n});r&&(this.close=r.hideFunc)}onClosed(e){var t,i;this.destroy(),(i=(t=this.config).closedCallback)==null||i.call(t,e)}toggleMaximize(){const e=this.positionableFeature.getPosition();if(this.isMaximized){const{x:t,y:i,width:s,height:n}=this.lastPosition;this.setWidth(s),this.setHeight(n),this.positionableFeature.offsetElement(t,i)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){(0,m._setDisplayed)(this.maximizeIcon,!this.isMaximized),(0,m._setDisplayed)(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(e=>e()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(e){this.positionableFeature.setResizable(e)}setMovable(e){this.positionableFeature.setMovable(e,this.eTitleBar)}setMaximizable(e){if(!e){this.clearMaximizebleListeners(),this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0);return}const t=this.eTitleBar;if(!t||e===this.isMaximizable)return;const i=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),i.addManagedElementListeners(i.getGui(),{click:this.toggleMaximize.bind(this)}),this.addTitleBarButton(i,0),this.maximizeListeners.push(...this.addManagedElementListeners(t,{dblclick:this.toggleMaximize.bind(this)})),[this.resizeListenerDestroy]=this.addManagedListeners(this.positionableFeature,{resize:()=>{this.isMaximized=!1,this.refreshMaximizeIcon()}})}buildMaximizeAndMinimizeElements(){const e=this.maximizeButtonComp=this.createBean(new m.Component({tag:"div",cls:"ag-dialog-button"})),t=e.getGui();return this.maximizeIcon=(0,m._createIconNoSpan)("maximize",this.beans),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=(0,m._createIconNoSpan)("minimize",this.beans),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}},B5=".ag-autocomplete{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}}.ag-autocomplete-list-popup{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-autocomplete-list{height:calc(var(--ag-row-height)*6.5);min-width:200px;position:relative;width:100%}.ag-autocomplete-virtual-list-item{cursor:default;display:flex;height:var(--ag-list-item-height);&:focus-visible:after{content:none}&:hover{background-color:var(--ag-row-hover-color)}}.ag-autocomplete-row{align-items:center;display:flex;flex:1 1 auto;overflow:hidden}.ag-autocomplete-row-label{margin:0 var(--ag-widget-container-horizontal-padding);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-autocomplete-row-selected{background-color:var(--ag-selected-row-background-color)}";function _5(e){return{tag:"div",cls:`ag-virtual-list-viewport ag-${e}-virtual-list-viewport`,role:"presentation",children:[{tag:"div",ref:"eContainer",cls:`ag-virtual-list-container ag-${e}-virtual-list-container`}]}}var Od=class extends m.TabGuardComp{constructor(e){super(_5((e==null?void 0:e.cssIdentifier)||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0,this.eContainer=m.RefPlaceholder,this.awaitStableCallbacks=[];const{cssIdentifier:t="default",ariaRole:i="listbox",listName:s,moveItemCallback:n}=e||{};this.cssIdentifier=t,this.ariaRole=i,this.listName=s,this.moveItemCallback=n}wireBeans(e){this.environment=e.environment}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:e=>this.focusInnerElement(e),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.refreshAriaProperties(),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanged.bind(this)})}onGridStylesChanged(e){e.listItemHeightChanged&&(this.rowHeight=this.getItemHeight(),this.refresh())}refreshAriaProperties(){var s;const t=this.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),i=this.eContainer;(0,m._setAriaRole)(i,((s=this.model)==null?void 0:s.getRowCount())>0?this.ariaRole:"presentation"),(0,m._setAriaLabel)(i,t)}addResizeObserver(){const e=()=>(0,m._requestAnimationFrame)(this.beans,()=>this.drawVirtualRows()),t=(0,m._observeResize)(this.beans,this.getGui(),e);this.addDestroyFunc(t)}focusInnerElement(e){return this.focusRow(e?this.model.getRowCount()-1:0),!0}onFocusIn(e){const t=e.target;t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=(0,m._getAriaPosInSet)(t)-1)}onFocusOut(e){this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(e){const{key:t,shiftKey:i}=e;switch(t){case m.KeyCode.UP:case m.KeyCode.DOWN:{const s=t===m.KeyCode.UP;e.preventDefault(),i?this.moveItem(s):this.navigate(s)}break;case m.KeyCode.PAGE_HOME:case m.KeyCode.PAGE_END:case m.KeyCode.PAGE_UP:case m.KeyCode.PAGE_DOWN:this.navigateToPage(t)!==null&&e.preventDefault();break}}onTabKeyDown(e){(0,m._stopPropagationForAgGrid)(e),this.forceFocusOutOfContainer(e.shiftKey)}getNextRow(e){if(this.lastFocusedRowIndex==null)return;const t=this.lastFocusedRowIndex+(e?-1:1);if(!(t<0||t>=this.model.getRowCount()))return t}moveItem(e){if(!this.moveItemCallback)return;const t=this.getComponentAt(this.lastFocusedRowIndex);t&&this.moveItemCallback(t,e)}navigate(e){const t=this.getNextRow(e);t!==void 0&&this.focusRow(t)}navigateToPage(e,t="focused"){let i=!1;t==="focused"&&(t=this.getLastFocusedRow(),i=!0);const s=this.model.getRowCount()-1;let n=-1;return e===m.KeyCode.PAGE_HOME?n=0:e===m.KeyCode.PAGE_END?n=s:e===m.KeyCode.PAGE_DOWN?n=Math.min(t+this.pageSize,s):e===m.KeyCode.PAGE_UP&&(n=Math.max(t-this.pageSize,0)),n===-1?null:(i?this.focusRow(n):this.ensureIndexVisible(n),n)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(e){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(e),(0,m._requestAnimationFrame)(this.beans,()=>{if(this.isScrolling=!1,!this.isAlive())return;const t=this.renderedRows.get(e);t&&t.eDiv.focus()}))}getComponentAt(e){const t=this.renderedRows.get(e);return t&&t.rowComponent}forEachRenderedRow(e){this.renderedRows.forEach((t,i)=>e(t.rowComponent,i))}getItemHeight(){return this.isHeightFromTheme?this.environment.getDefaultListItemHeight():this.rowHeight}ensureIndexVisible(e,t=!0){const i=this.model.getRowCount();if(typeof e!="number"||e<0||e>=i)return(0,m._warn)(229,{index:e}),!1;const s=e*this.rowHeight,n=s+this.rowHeight,a=this.getGui(),r=a.scrollTop,o=a.offsetHeight,l=r+o,c=t?0:this.rowHeight,h=r>s+c,d=l<n-c;if(h)return a.scrollTop=s,!0;if(d){const u=n-o;return a.scrollTop=u,!0}return!1}setComponentCreator(e){this.componentCreator=e}setComponentUpdater(e){this.componentUpdater=e}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(e){this.isHeightFromTheme=!1,this.rowHeight=e,this.refresh()}refresh(e){if(this.model==null||!this.isAlive())return;const t=this.model.getRowCount();this.eContainer.style.height=`${t*this.rowHeight}px`,this.refreshAriaProperties(),this.awaitStable(()=>{this.isAlive()&&(this.canSoftRefresh(e)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}awaitStable(e){if(this.awaitStableCallbacks.push(e),this.awaitStableCallbacks.length>1)return;const t=this.model.getRowCount();(0,m._waitUntil)(()=>this.eContainer.clientHeight>=t*this.rowHeight,()=>{if(!this.isAlive())return;const i=this.awaitStableCallbacks;this.awaitStableCallbacks=[],i.forEach(s=>s())})}canSoftRefresh(e){return!!(e&&this.renderedRows.size&&typeof this.model.areRowsEqual=="function"&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((e,t)=>this.removeRow(t))}drawVirtualRows(e){if(!this.isAlive()||!this.model)return;const t=this.getGui(),i=t.scrollTop,s=i+t.offsetHeight;if(i===s)this.clearVirtualRows();else{const n=Math.floor(i/this.rowHeight),a=Math.floor(s/this.rowHeight);this.pageSize=Math.floor((s-i)/this.rowHeight),this.ensureRowsRendered(n,a,e)}}ensureRowsRendered(e,t,i){this.renderedRows.forEach((s,n)=>{(n<e||n>t)&&n!==this.lastFocusedRowIndex&&this.removeRow(n)}),i&&this.refreshRows();for(let s=e;s<=t;s++)this.renderedRows.has(s)||s<this.model.getRowCount()&&this.insertRow(s)}insertRow(e){const t=this.model.getRow(e),i=this.ariaRole==="tree"?"treeitem":"option",s=(0,m._createElement)({tag:"div",cls:`ag-virtual-list-item ag-${this.cssIdentifier}-virtual-list-item`,role:i,attrs:{tabindex:"-1"}});(0,m._setAriaSetSize)(s,this.model.getRowCount()),(0,m._setAriaPosInSet)(s,e+1),s.style.height=`${this.rowHeight}px`,s.style.top=`${this.rowHeight*e}px`;const n=this.componentCreator(t,s);n.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=e),s.appendChild(n.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",s):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",s):this.eContainer.appendChild(s),this.renderedRows.set(e,{rowComponent:n,eDiv:s,value:t})}removeRow(e){const t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)}refreshRows(){const e=this.model.getRowCount();this.renderedRows.forEach((t,i)=>{var s,n;if(i>=e)this.removeRow(i);else{const a=this.model.getRow(i);(n=(s=this.model).areRowsEqual)!=null&&n.call(s,t.value,a)?this.componentUpdater(a,t.rowComponent):this.removeRow(i)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(e){this.model=e}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),this.awaitStableCallbacks.length=0,super.destroy())}},G5={tag:"div",cls:"ag-autocomplete-row",role:"presentation",children:[{tag:"div",cls:"ag-autocomplete-row-label"}]},z5=class extends m.Component{constructor(){super(G5),this.hasHighlighting=!1}setState(e,t){this.value=e,this.render(),this.updateSelected(t)}updateSelected(e){this.toggleCss("ag-autocomplete-row-selected",e)}setSearchString(e){let t=!1;const{value:i}=this;if(i&&(0,m._exists)(e)){const s=i.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(s>=0){t=!0,this.hasHighlighting=!0;const n=s+e.length,a=this.getGui().lastElementChild;(0,m._clearElement)(a),a.append(i.slice(0,s),(0,m._createElement)({tag:"b",children:i.slice(s,n)}),i.slice(n))}}!t&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())}render(){var e;this.getGui().lastElementChild.textContent=(e=this.value)!=null?e:"\xA0"}},V5={tag:"div",cls:"ag-autocomplete-list-popup",children:[{tag:"div",ref:"eList",cls:"ag-autocomplete-list"}]},j5=class extends m.PopupComponent{constructor(e){super(V5),this.params=e,this.eList=m.RefPlaceholder,this.searchString=""}postConstruct(){this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new Od({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.autocompleteEntries.length,getRow:t=>this.autocompleteEntries[t]});const e=this.virtualList.getGui();this.addManagedListeners(e,{click:()=>this.params.onConfirmed(),mousemove:this.onMouseMove.bind(this),mousedown:t=>t.preventDefault()}),this.setSelectedValue(0)}onNavigationKeyDown(e,t){e.preventDefault();const i=this.autocompleteEntries.indexOf(this.selectedValue),s=t===m.KeyCode.UP?i-1:i+1;this.checkSetSelectedValue(s)}setSearch(e){this.searchString=e,(0,m._exists)(e)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()}runContainsSearch(e,t){let i,s=!1;const n=e.toLocaleLowerCase(),a=t.filter(r=>{const l=r.toLocaleLowerCase().indexOf(n),c=l===0,h=l>=0;return h&&(!i||!s&&c||s===c&&r.length<i.length)&&(i=r,s=c),h});return!i&&a.length&&(i=a[0]),{topMatch:i,allMatches:a}}runSearch(){const{autocompleteEntries:e,useFuzzySearch:t,forceLastSelection:i}=this.params,s=e.map(l=>{var c;return(c=l.displayValue)!=null?c:l.key});let n,a;if(t)n=(0,m._fuzzySuggestions)({inputValue:this.searchString,allSuggestions:s,hideIrrelevant:!0}).values,a=n.length?n[0]:void 0;else{const l=this.runContainsSearch(this.searchString,s);n=l.allMatches,a=l.topMatch}let r=e.filter(({key:l,displayValue:c})=>n.includes(c!=null?c:l));if(!r.length&&this.selectedValue&&(i!=null&&i(this.selectedValue,this.searchString))&&(r=[this.selectedValue]),this.autocompleteEntries=r,this.virtualList.refresh(),!a)return;const o=n.indexOf(a);this.checkSetSelectedValue(o)}updateSearchInList(){this.virtualList.forEachRenderedRow(e=>e.setSearchString(this.searchString))}checkSetSelectedValue(e){e>=0&&e<this.autocompleteEntries.length&&this.setSelectedValue(e)}setSelectedValue(e){const t=this.autocompleteEntries[e];this.selectedValue!==t&&(this.selectedValue=t,this.virtualList.ensureIndexVisible(e),this.virtualList.forEachRenderedRow((i,s)=>{i.updateSelected(e===s)}))}createRowComponent(e){var i;const t=new z5;return this.createBean(t),t.setState((i=e.displayValue)!=null?i:e.key,e===this.selectedValue),t}onMouseMove(e){const t=this.virtualList,i=t.getGui().getBoundingClientRect(),s=t.getScrollTop(),n=e.clientY-i.top+s,a=Math.floor(n/t.getRowHeight());this.checkSetSelectedValue(a)}afterGuiAttached(){this.virtualList.refresh()}getSelectedValue(){var e;return this.autocompleteEntries.length&&(e=this.selectedValue)!=null?e:null}},H5={tag:"div",cls:"ag-autocomplete",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eAutocompleteInput"}]},W5=class extends m.Component{constructor(){super(H5,[m.AgInputTextFieldSelector]),this.eAutocompleteInput=m.RefPlaceholder,this.isListOpen=!1,this.lastPosition=0,this.valid=!0,this.registerCSS(B5)}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.eAutocompleteInput.onValueChange(e=>this.onValueChanged(e)),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc(()=>{this.destroyBean(this.autocompleteList)}),this.addGuiEventListener("focusout",()=>this.onFocusOut())}onValueChanged(e){const t=(0,m._makeNull)(e);this.updateValue(t),this.updateAutocompleteList(t)}updateValue(e){this.updateLastPosition(),this.dispatchLocalEvent({type:"eventValueChanged",value:e}),this.validate(e)}updateAutocompleteList(e){var s,n,a;const t=(n=(s=this.listGenerator)==null?void 0:s.call(this,e,this.lastPosition))!=null?n:{enabled:!1};(!t.type||t.type!==((a=this.autocompleteListParams)==null?void 0:a.type))&&this.isListOpen&&this.closeList();const i=this.isListOpen;if(this.autocompleteListParams=t,t!=null&&t.enabled){i||this.openList();const{searchString:r}=t;this.autocompleteList.setSearch(r!=null?r:"")}else i&&this.closeList()}onKeyDown(e){const t=e.key;switch(this.updateLastPosition(),t){case m.KeyCode.ENTER:this.onEnterKeyDown(e);break;case m.KeyCode.TAB:this.onTabKeyDown(e);break;case m.KeyCode.DOWN:case m.KeyCode.UP:this.onUpDownKeyDown(e,t);break;case m.KeyCode.LEFT:case m.KeyCode.RIGHT:case m.KeyCode.PAGE_HOME:case m.KeyCode.PAGE_END:setTimeout(()=>{this.updatePositionAndList()});break;case m.KeyCode.ESCAPE:this.onEscapeKeyDown(e);break;case m.KeyCode.SPACE:e.ctrlKey&&!this.isListOpen&&(e.preventDefault(),this.forceOpenList());break}}confirmSelection(){var t;const e=(t=this.autocompleteList)==null?void 0:t.getSelectedValue();e&&(this.closeList(),this.dispatchLocalEvent({type:"eventOptionSelected",value:this.getValue(),position:this.lastPosition,updateEntry:e,autocompleteType:this.autocompleteListParams.type}))}onTabKeyDown(e){this.isListOpen&&(e.preventDefault(),e.stopPropagation(),this.confirmSelection())}onEnterKeyDown(e){e.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()}onUpDownKeyDown(e,t){var i;e.preventDefault(),this.isListOpen?(i=this.autocompleteList)==null||i.onNavigationKeyDown(e,t):this.forceOpenList()}onEscapeKeyDown(e){this.isListOpen&&(e.preventDefault(),e.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))}onFocusOut(){this.isListOpen&&this.closeList()}updatePositionAndList(){var e;this.updateLastPosition(),this.updateAutocompleteList((e=this.eAutocompleteInput.getValue())!=null?e:null)}setCaret(e,t){t&&(0,m._isNothingFocused)(this.beans)&&this.eAutocompleteInput.getFocusableElement().focus();const i=this.eAutocompleteInput.getInputElement();i.setSelectionRange(e,e),e===i.value.length&&(i.scrollLeft=i.scrollWidth)}forceOpenList(){this.onValueChanged(this.eAutocompleteInput.getValue())}updateLastPosition(){var e;this.lastPosition=(e=this.eAutocompleteInput.getInputElement().selectionStart)!=null?e:0}validate(e){if(!this.validator)return;const t=this.validationMessage=this.validator(e);this.eAutocompleteInput.getInputElement().setCustomValidity(t!=null?t:""),this.valid=!t,this.dispatchLocalEvent({type:"eventValidChanged",isValid:this.valid,validationMessage:t})}openList(){this.isListOpen=!0,this.autocompleteList=this.createBean(new j5({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:()=>this.confirmSelection(),forceLastSelection:this.forceLastSelection}));const e=this.autocompleteList.getGui(),t={ePopup:e,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gos.get("enableRtl")?"right":"left",keepWithinBounds:!0},i=this.popupSvc.addPopup({eChild:e,anchorToElement:this.getGui(),positionCallback:()=>this.popupSvc.positionPopupByComponent(t),ariaLabel:this.listAriaLabel});this.hidePopup=i.hideFunc,this.autocompleteList.afterGuiAttached()}closeList(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null}onCompleted(){this.isListOpen&&this.closeList(),this.dispatchLocalEvent({type:"eventValueConfirmed",value:this.getValue(),isValid:this.isValid()})}getValue(){return(0,m._makeNull)(this.eAutocompleteInput.getValue())}setInputPlaceholder(e){return this.eAutocompleteInput.setInputPlaceholder(e),this}setInputAriaLabel(e){return this.eAutocompleteInput.setInputAriaLabel(e),this}setListAriaLabel(e){return this.listAriaLabel=e,this}setListGenerator(e){return this.listGenerator=e,this}setValidator(e){return this.validator=e,this}isValid(){return this.valid}setValue(e){const{value:t,position:i,silent:s,updateListOnlyIfOpen:n,restoreFocus:a}=e;this.eAutocompleteInput.setValue(t,!0),this.setCaret(i!=null?i:this.lastPosition,a),s||this.updateValue(t),(!n||this.isListOpen)&&this.updateAutocompleteList(t)}setForceLastSelection(e){return this.forceLastSelection=e,this}setInputDisabled(e){return this.eAutocompleteInput.setDisabled(e),this}},U5={selector:"AG-AUTOCOMPLETE",component:W5},K5={tag:"div",cls:"ag-advanced-filter",role:"presentation",attrs:{tabindex:"-1"},children:[{tag:"ag-autocomplete",ref:"eAutocomplete"},{tag:"button",ref:"eApplyFilterButton",cls:"ag-button ag-standard-button ag-advanced-filter-apply-button"},{tag:"button",ref:"eBuilderFilterButton",cls:"ag-button ag-advanced-filter-builder-button",children:[{tag:"span",ref:"eBuilderFilterButtonIcon",attrs:{"aria-hidden":"true"}},{tag:"span",ref:"eBuilderFilterButtonLabel",cls:"ag-advanced-filter-builder-button-label"}]}]},yk=class extends m.Component{constructor(){super(K5,[U5]),this.eAutocomplete=m.RefPlaceholder,this.eApplyFilterButton=m.RefPlaceholder,this.eBuilderFilterButton=m.RefPlaceholder,this.eBuilderFilterButtonIcon=m.RefPlaceholder,this.eBuilderFilterButtonLabel=m.RefPlaceholder,this.expressionParser=null,this.isApplyDisabled=!0,this.builderOpen=!1}wireBeans(e){this.advFilterExpSvc=e.advFilterExpSvc,this.advancedFilter=e.advancedFilter,this.filterManager=e.filterManager,this.registry=e.registry}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),getTooltipShowDelayOverride:()=>1e3,getLocation:()=>"advancedFilter"})),this.eAutocomplete.setListGenerator((e,t)=>this.generateAutocompleteListParams(t)).setValidator(()=>this.validateValue()).setForceLastSelection((e,t)=>this.forceLastSelection(e,t)).setInputAriaLabel(this.advFilterExpSvc.translate("ariaAdvancedFilterInput")).setListAriaLabel(this.advFilterExpSvc.translate("ariaLabelAdvancedFilterAutocomplete")),this.refresh(),this.addManagedListeners(this.eAutocomplete,{eventValueChanged:({value:e})=>this.onValueChanged(e),eventValueConfirmed:({isValid:e})=>this.onValueConfirmed(e),eventOptionSelected:({position:e,updateEntry:t,autocompleteType:i})=>this.onOptionSelected(e,t,i),eventValidChanged:({isValid:e,validationMessage:t})=>this.onValidChanged(e,t)}),this.setupApplyButton(),this.setupBuilderButton()}refresh(){const e=this.advancedFilter.getExpressionDisplayValue();this.eAutocomplete.setValue({value:e!=null?e:"",position:e==null?void 0:e.length,updateListOnlyIfOpen:!0})}setInputDisabled(e){this.eAutocomplete.setInputDisabled(e),(0,m._setDisabled)(this.eApplyFilterButton,e||this.isApplyDisabled)}setupApplyButton(){this.eApplyFilterButton.textContent=this.advFilterExpSvc.translate("advancedFilterApply"),this.activateTabIndex([this.eApplyFilterButton]),this.addManagedElementListeners(this.eApplyFilterButton,{click:()=>this.onValueConfirmed(this.eAutocomplete.isValid())}),(0,m._setDisabled)(this.eApplyFilterButton,this.isApplyDisabled)}setupBuilderButton(){this.eBuilderFilterButtonIcon.appendChild((0,m._createIconNoSpan)("advancedFilterBuilder",this.beans)),this.eBuilderFilterButtonLabel.textContent=this.advFilterExpSvc.translate("advancedFilterBuilder"),this.activateTabIndex([this.eBuilderFilterButton]),this.addManagedElementListeners(this.eBuilderFilterButton,{click:()=>this.openBuilder()}),this.addManagedListeners(this.advancedFilter.getCtrl(),{advancedFilterBuilderClosed:()=>this.closeBuilder()})}onValueChanged(e){var i;e=(0,m._makeNull)(e),this.advancedFilter.setExpressionDisplayValue(e),this.expressionParser=this.advancedFilter.createExpressionParser(e);const t=(i=this.expressionParser)==null?void 0:i.parseExpression();t&&t!==e&&this.eAutocomplete.setValue({value:t,silent:!0,restoreFocus:!0})}onValueConfirmed(e){var t;!e||this.isApplyDisabled||((0,m._setDisabled)(this.eApplyFilterButton,!0),this.advancedFilter.applyExpression(),(t=this.filterManager)==null||t.onFilterChanged({source:"advancedFilter"}))}onOptionSelected(e,t,i){const{updatedValue:s,updatedPosition:n,hideAutocomplete:a}=this.updateExpression(e,t,i);this.eAutocomplete.setValue({value:s,position:n,updateListOnlyIfOpen:a,restoreFocus:!0})}validateValue(){var e,t,i;return(e=this.expressionParser)!=null&&e.isValid()?null:(i=(t=this.expressionParser)==null?void 0:t.getValidationMessage())!=null?i:null}onValidChanged(e,t){var i;this.isApplyDisabled=!e||this.advancedFilter.isCurrentExpressionApplied(),(0,m._setDisabled)(this.eApplyFilterButton,this.isApplyDisabled),(i=this.tooltipFeature)==null||i.setTooltipAndRefresh(t)}generateAutocompleteListParams(e){return this.expressionParser?this.expressionParser.getAutocompleteListParams(e):this.advFilterExpSvc.getDefaultAutocompleteListParams("")}updateExpression(e,t,i){var s,n;return this.advFilterExpSvc.updateAutocompleteCache(t,i),(n=(s=this.expressionParser)==null?void 0:s.updateExpression(e,t,i))!=null?n:this.advancedFilter.getDefaultExpression(t)}forceLastSelection({key:e,displayValue:t},i){return!!i.toLocaleLowerCase().match(`^${(t!=null?t:e).toLocaleLowerCase()}\\s*$`)}openBuilder(){this.builderOpen||(this.builderOpen=!0,(0,m._setDisabled)(this.eBuilderFilterButton,!0),this.advancedFilter.getCtrl().toggleFilterBuilder({source:"ui",eventSource:this.eBuilderFilterButton}))}closeBuilder(){this.builderOpen&&(this.builderOpen=!1,(0,m._setDisabled)(this.eBuilderFilterButton,!1),this.eBuilderFilterButton.focus())}},$5={tag:"div",cls:"ag-advanced-filter-header",role:"row"},Y5=class extends m.Component{constructor(e){super($5),this.enabled=e}wireBeans(e){this.colModel=e.colModel,this.focusSvc=e.focusSvc,this.ctrlsSvc=e.ctrlsSvc}postConstruct(){this.setupAdvancedFilter(this.enabled),this.addDestroyFunc(()=>this.destroyBean(this.eAdvancedFilter));const e=()=>{this.enabled&&this.setEnabledHeight()};this.addManagedEventListeners({gridColumnsChanged:()=>this.onGridColumnsChanged(),columnHeaderHeightChanged:e,gridStylesChanged:e}),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addGuiEventListener("keydown",t=>this.onKeyDown(t)),this.addGuiEventListener("focusout",t=>{this.getFocusableElement().contains(t.relatedTarget)||this.focusSvc.clearAdvancedFilterColumn()})}getFocusableElement(){var e,t;return(t=(e=this.eAdvancedFilter)==null?void 0:e.getGui())!=null?t:this.getGui()}setEnabled(e){e!==this.enabled&&this.setupAdvancedFilter(e)}refresh(){var e;(e=this.eAdvancedFilter)==null||e.refresh()}getHeight(){return this.height}setInputDisabled(e){var t;(t=this.eAdvancedFilter)==null||t.setInputDisabled(e)}setupAdvancedFilter(e){const t=this.getGui();if(e){this.eAdvancedFilter=this.createBean(new yk);const i=this.eAdvancedFilter.getGui();this.eAdvancedFilter.addCss("ag-advanced-filter-header-cell"),this.setEnabledHeight(),this.setAriaRowIndex(),(0,m._setAriaRole)(i,"gridcell"),(0,m._setAriaColIndex)(i,1),this.setAriaColumnCount(i),t.appendChild(i)}else(0,m._clearElement)(t),this.destroyBean(this.eAdvancedFilter),this.height=0;(0,m._setDisplayed)(t,e),this.enabled=e}setEnabledHeight(){const e=this.getGui();this.height=(0,m._getFloatingFiltersHeight)(this.beans);const t=`${this.height}px`;e.style.height=t,e.style.minHeight=t}setAriaColumnCount(e){(0,m._setAriaColSpan)(e,this.colModel.getCols().length)}setAriaRowIndex(){var e,t;(0,m._setAriaRowIndex)(this.getGui(),(t=(e=this.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:e.getRowCount())!=null?t:0)}onGridColumnsChanged(){this.eAdvancedFilter&&(this.setAriaColumnCount(this.eAdvancedFilter.getGui()),this.setAriaRowIndex())}onKeyDown(e){switch(e.key){case m.KeyCode.ENTER:{this.hasFocus()&&(0,m._focusInto)(this.getFocusableElement())&&e.preventDefault();break}case m.KeyCode.ESCAPE:this.hasFocus()||this.getFocusableElement().focus();break;case m.KeyCode.UP:this.navigateUpDown(!0,e);break;case m.KeyCode.DOWN:this.navigateUpDown(!1,e);break;case m.KeyCode.TAB:if(this.hasFocus())this.navigateLeftRight(e);else{const t=(0,m._findNextFocusableElement)(this.beans,this.getFocusableElement(),null,e.shiftKey);t?(e.preventDefault(),t.focus()):this.navigateLeftRight(e)}break}}navigateUpDown(e,t){this.hasFocus()&&this.focusSvc.focusNextFromAdvancedFilter(e)&&t.preventDefault()}navigateLeftRight(e){(e.shiftKey?this.focusSvc.focusLastHeader():this.focusSvc.focusNextFromAdvancedFilter(!1,!0))&&e.preventDefault()}hasFocus(){return(0,m._getActiveDomElement)(this.beans)===this.getFocusableElement()}},hS="ag-list-item-hovered",vk=class extends m.BeanStub{constructor(e,t,i){super(),this.comp=e,this.virtualList=t,this.params=i,this.currentDragValue=null,this.lastHoveredListItem=null}wireBeans(e){this.dragAndDrop=e.dragAndDrop}postConstruct(){this.addManagedListeners(this.params.eventSource,{[this.params.listItemDragStartEvent]:this.listItemDragStart.bind(this),[this.params.listItemDragEndEvent]:this.listItemDragEnd.bind(this)}),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(e){this.currentDragValue=this.params.getCurrentDragValue(e),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){var t;const e={isInterestedIn:i=>i===this.params.dragSourceType,getIconName:()=>this.moveBlocked?"pinned":"move",getContainer:()=>this.comp.getGui(),onDragging:i=>this.onDragging(i),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave(),onDragCancel:()=>this.onDragCancel()};(t=this.dragAndDrop)==null||t.addDropTarget(e)}createAutoScrollService(){const e=this.virtualList.getGui();this.autoScrollService=new m.AutoScrollService({scrollContainer:e,scrollAxis:"y",getVerticalPosition:()=>e.scrollTop,setVerticalPosition:t=>e.scrollTop=t})}onDragging(e){if(!this.currentDragValue||this.moveBlocked)return;const t=this.getListDragItem(e),i=this.virtualList.getComponentAt(t.rowIndex);if(!i)return;const s=i.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===t.rowIndex&&this.lastHoveredListItem.position===t.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredListItem=t,(0,m._radioCssClass)(s,hS),(0,m._radioCssClass)(s,`ag-item-highlight-${t.position}`))}getListDragItem(e){const t=this.virtualList.getGui(),i=parseFloat(window.getComputedStyle(t).paddingTop),s=this.virtualList.getRowHeight(),n=this.virtualList.getScrollTop(),a=Math.max(0,(e.y-i+n)/s),r=this.params.getNumRows(this.comp)-1,o=Math.min(r,a)|0;return{rowIndex:o,position:Math.round(a)>a||a>r?"bottom":"top",component:this.virtualList.getComponentAt(o)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearDragProperties())}onDragCancel(){this.clearDragProperties()}onDragLeave(){this.clearDragProperties()}clearDragProperties(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${hS}`).forEach(t=>{[hS,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(i=>{t.classList.remove(i)})}),this.lastHoveredListItem=null}},X5=class extends m.BeanStub{constructor(e,t){super(),this.comp=e,this.virtualList=t}postConstruct(){this.createManagedBean(new vk(this.comp,this.virtualList,{dragSourceType:m.DragSourceType.AdvancedFilterBuilder,listItemDragStartEvent:"advancedFilterBuilderDragStarted",listItemDragEndEvent:"advancedFilterBuilderDragEnded",eventSource:this,getCurrentDragValue:e=>this.getCurrentDragValue(e),isMoveBlocked:()=>!1,getNumRows:e=>e.getNumItems(),moveItem:(e,t)=>this.moveItem(e,t)}))}getCurrentDragValue(e){return e.item}moveItem(e,t){this.comp.moveItem(e,t)}},Z5={tag:"div",cls:"ag-pill",role:"option",children:[{tag:"span",ref:"eText",cls:"ag-pill-text"},{tag:"span",ref:"eButton",cls:"ag-button ag-pill-button",role:"presentation"}]},q5=class extends m.Component{constructor(e){super(Z5),this.config=e,this.eText=m.RefPlaceholder,this.eButton=m.RefPlaceholder}postConstruct(){const{config:e,eButton:t}=this,{onKeyDown:i,onButtonClick:s}=e;this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),this.addGuiEventListener("focus",()=>{this.eButton.focus()}),i&&this.addGuiEventListener("keydown",i),s&&this.addManagedElementListeners(t,{click:s})}toggleCloseButtonClass(e,t){this.eButton.classList.toggle(e,t)}setText(e){this.eText.textContent=e}getText(){return this.eText.textContent}},Q5={tag:"div",cls:"ag-pill-container"},J5=class extends m.Component{constructor(){super(Q5),this.pills=[]}init(e){this.params=e,this.refresh()}refresh(){var a,r;this.clearPills();const{params:e,onPillKeyDown:t}=this;let i=e.getValue();if(!Array.isArray(i)){if(i==null)return;i=[i]}const s=(a=e.valueFormatter)!=null?a:o=>String(o),n=i.length;(0,m._setAriaRole)(this.getGui(),n===0?"presentation":"listbox");for(let o=0;o<n;o++){const l=i[o],c=this.createBean(new q5({onButtonClick:()=>this.onPillButtonClick(c),onKeyDown:t.bind(this)})),h=c.getGui();(0,m._setAriaPosInSet)(h,o+1),(0,m._setAriaSetSize)(h,n),e.onPillMouseDown&&c.addGuiEventListener("mousedown",e.onPillMouseDown),e.announceItemFocus&&c.addGuiEventListener("focus",e.announceItemFocus),c.setText((r=s(l))!=null?r:""),c.toggleCloseButtonClass("ag-icon-cancel",!0),this.appendChild(h),this.pills.push(c)}}onNavigationKeyDown(e){const{key:t}=e;if(!this.pills.length||t!==m.KeyCode.LEFT&&t!==m.KeyCode.RIGHT)return;e.preventDefault();const{params:i,beans:s}=this,n=(0,m._getActiveDomElement)(s),a=this.getGui();if(a.contains(n)){const r=(0,m._findNextFocusableElement)(s,a,!1,t===m.KeyCode.LEFT);r?r.focus():i.eWrapper&&i.eWrapper.focus()}else{const r=(0,m._findFocusableElements)(a);r.length>0&&r[t===m.KeyCode.RIGHT?0:r.length-1].focus()}}clearPills(){const e=this.getGui();e.contains((0,m._getActiveDomElement)(this.beans))&&this.params.eWrapper&&this.params.eWrapper.focus(),(0,m._clearElement)(e),this.destroyBeans(this.pills),this.pills=[]}onPillButtonClick(e){this.deletePill(e)}onPillKeyDown(e){const t=e.key;if(t!==m.KeyCode.DELETE&&t!==m.KeyCode.BACKSPACE)return;e.preventDefault();const i=(0,m._getDocument)(this.beans),s=this.pills.findIndex(a=>a.getGui().contains(i.activeElement));if(s===-1)return;const n=this.pills[s];n&&this.deletePill(n,s)}deletePill(e,t){const i=e.getText(),s=(this.params.getValue()||[]).filter(n=>n!==i);if(this.params.setValue(s),!s.length&&this.params.eWrapper)this.params.eWrapper.focus();else if(t!=null){const n=this.pills[Math.min(t,this.pills.length-1)];n&&n.getFocusableElement().focus()}}destroy(){this.clearPills(),super.destroy()}},eU=".ag-rich-select{cursor:default;height:100%}.ag-rich-select-value{align-items:center;background-color:var(--ag-picker-button-background-color);display:flex;height:100%;padding:var(--ag-spacing);:where(.ag-picker-field-display){overflow:hidden;text-overflow:ellipsis;&:where(.ag-display-as-placeholder){opacity:.5}}}.ag-rich-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-input-border-radius);box-shadow:var(--ag-dropdown-shadow);height:auto;position:relative;width:100%;:where(.ag-loading-text){padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}}.ag-rich-select-row{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;padding:0 var(--ag-spacing);white-space:nowrap}.ag-rich-select-row-selected{background-color:var(--ag-selected-row-background-color)}.ag-rich-select-row-highlighted,.ag-rich-select-row:hover{background-image:linear-gradient(var(--ag-row-hover-color),var(--ag-row-hover-color))}.ag-rich-select-row-text-highlight{font-weight:700}.ag-rich-select-field-input{flex:1 1 auto;:where(.ag-input-field-input){border:none!important;box-shadow:none!important;padding:0!important;text-overflow:ellipsis;&::-moz-placeholder{opacity:.8}&::placeholder{opacity:.8}}}:where(.ag-ltr) .ag-rich-select-field-input{left:var(--ag-spacing)}:where(.ag-rtl) .ag-rich-select-field-input{right:var(--ag-spacing)}:where(.ag-popup-editor) .ag-rich-select-value{height:var(--ag-row-height);min-width:200px}.ag-rich-select-virtual-list-item{cursor:default;height:var(--ag-list-item-height)}.ag-pill-container{display:flex;flex-wrap:nowrap;gap:.25rem}.ag-pill{align-items:center;background:var(--ag-select-cell-background-color);border:var(--ag-select-cell-border);border-radius:var(--ag-border-radius);display:flex;padding:0 .25rem;white-space:nowrap}.ag-pill-button{border:none;padding:0;&:hover{color:var(--ag-accent-color);cursor:pointer}}:where(.ag-ltr) .ag-pill-button{margin-left:var(--ag-spacing)}:where(.ag-rtl) .ag-pill-button{margin-right:var(--ag-spacing)}",tU={tag:"div",cls:"ag-rich-select-row",role:"presentation"},iU=class extends m.Component{constructor(e){super(tU),this.params=e}wireBeans(e){this.userCompFactory=e.userCompFactory,this.registry=e.registry}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),shouldDisplayTooltip:()=>{var e,t;return(t=(e=this.shouldDisplayTooltip)==null?void 0:e.call(this))!=null?t:!0}}))}setState(e){var n,a;const{params:t}=this,i=(a=(n=t.valueFormatter)==null?void 0:n.call(t,e))!=null?a:"";this.populateWithRenderer(e,i)||this.populateWithoutRenderer(e,i),this.value=e}highlightString(e){const{parsedValue:t,params:i}=this;if(i.cellRenderer||!(0,m._exists)(t))return;let s=(0,m._exists)(e);if(s){const n=t==null?void 0:t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(n>=0){const a=n+e.length,r=this.getGui().querySelector("span");r&&((0,m._clearElement)(r),r.append(t.slice(0,n),(0,m._createElement)({tag:"span",cls:"ag-rich-select-row-text-highlight",children:t.slice(n,a)}),t.slice(a)))}else s=!1}s||this.renderValueWithoutRenderer(t)}updateSelected(e){const t=this.getGui();(0,m._setAriaSelected)(t.parentElement,e),this.toggleCss("ag-rich-select-row-selected",e)}getValue(){return this.value}toggleHighlighted(e){this.toggleCss("ag-rich-select-row-highlighted",e)}populateWithoutRenderer(e,t){var a;const i=this.getGui(),s=(0,m._createElement)({tag:"span"});s.style.overflow="hidden",s.style.textOverflow="ellipsis";const n=(0,m._toString)((0,m._exists)(t)?t:e);this.parsedValue=(0,m._exists)(n)?n:null,i.appendChild(s),this.renderValueWithoutRenderer(n),this.shouldDisplayTooltip=(0,m._shouldDisplayTooltip)(()=>s),(a=this.tooltipFeature)==null||a.setTooltipAndRefresh(this.parsedValue)}renderValueWithoutRenderer(e){const t=this.getGui().querySelector("span");t&&(t.textContent=(0,m._exists)(e)?e:"\xA0")}populateWithRenderer(e,t){var n;let i,s;if(this.params.cellRenderer){const a=(n=this.getParentComponent())==null?void 0:n.getParentComponent();s=(0,m._getEditorRendererDetails)(this.userCompFactory,this.params,(0,m._addGridCommonParams)(this.gos,{value:e,valueFormatted:t,getValue:()=>a==null?void 0:a.getValue(),setValue:r=>{a==null||a.setValue(r,!0)},setTooltip:(r,o)=>{var l;this.gos.assertModuleRegistered("Tooltip",3),this.shouldDisplayTooltip=o,(l=this.tooltipFeature)==null||l.setTooltipAndRefresh(r)}}))}return s&&(i=s.newAgStackInstance()),i&&Ck(i,this.getGui()),i?(i.then(a=>{this.addDestroyFunc(()=>{this.destroyBean(a)})}),!0):!1}},bk="ag-rich-select-list",xk="ag-rich-select-row",sU=class extends Od{constructor(e,t,i){super({cssIdentifier:"rich-select"}),this.params=e,this.richSelectWrapper=t,this.getSearchString=i,this.lastRowHovered=-1,this.selectedItems=new Set,this.params=e,this.setComponentCreator(this.createRowComponent.bind(this)),this.setComponentUpdater(()=>{})}postConstruct(){super.postConstruct(),this.eLoading=(0,m._createElement)({tag:"div",cls:"ag-loading-text",children:this.getLocaleTextFunc()("loadingOoo","Loading...")});const{cellRowHeight:e,pickerAriaLabelKey:t,pickerAriaLabelValue:i}=this.params;e&&this.setRowHeight(e);const s=this.getGui(),n=this.getAriaElement();this.addManagedListeners(s,{mousemove:this.onMouseMove.bind(this),mouseout:this.onMouseOut.bind(this),mousedown:this.onMouseDown.bind(this),click:this.onClick.bind(this)}),s.classList.add(bk);const a=`${bk}-${this.getCompId()}`;n.setAttribute("id",a);const o=this.getLocaleTextFunc()(t,i);(0,m._setAriaLabel)(n,o),(0,m._setAriaControls)(this.richSelectWrapper,n)}navigateToPage(e){const t=super.navigateToPage(e,this.lastRowHovered);return t!=null&&(0,m._requestAnimationFrame)(this.beans,()=>{if(!this.isAlive())return null;this.highlightIndex(t)}),t}drawVirtualRows(e){super.drawVirtualRows(e),this.refreshSelectedItems()}highlightFilterMatch(e){this.forEachRenderedRow(t=>{t.highlightString(e)})}onNavigationKeyDown(e,t){(0,m._requestAnimationFrame)(this.beans,()=>{if(!this.currentList||!this.isAlive())return;const i=this.currentList.length,s=this.lastRowHovered,n=e===m.KeyCode.DOWN?1:-1,a=Math.min(Math.max(s===-1?0:s+n,0),i-1);this.highlightIndex(a),t()})}selectValue(e){var s,n;if(!this.currentList)return this.eLoading&&this.appendChild(this.eLoading),!1;if((s=this.eLoading)!=null&&s.offsetParent&&((n=this.eLoading.parentElement)==null||n.removeChild(this.eLoading)),e==null)return!1;const t=this.getIndicesForValues(e),i=t.length>0;return i&&(this.refresh(),this.ensureIndexVisible(t[0]),this.refresh(!0)),this.selectListItems(Array.isArray(e)?e:[e]),i}selectListItems(e,t=!1){t||this.selectedItems.clear();for(let i=0;i<e.length;i++){const s=e[i];this.findItemInSelected(s)===void 0&&this.selectedItems.add(s)}this.refreshSelectedItems()}getCurrentList(){return this.currentList}setCurrentList(e){this.currentList=e,this.setModel({getRowCount:()=>e.length,getRow:t=>e[t],areRowsEqual:(t,i)=>t===i})}getSelectedItems(){return this.selectedItems}getLastItemHovered(){return this.currentList[this.lastRowHovered]}highlightIndex(e,t){this.currentList&&(e<0||e>=this.currentList.length?this.lastRowHovered=-1:(this.lastRowHovered=e,this.ensureIndexVisible(e,!t)&&!t&&this.refresh(!0)),this.forEachRenderedRow((i,s)=>{const n=e===s;if(i.toggleHighlighted(n),n){const a=`${xk}-${i.getCompId()}`;(0,m._setAriaActiveDescendant)(this.richSelectWrapper,a),this.richSelectWrapper.setAttribute("data-active-option",a)}}))}getIndicesForValues(e){const{currentList:t}=this;if(!t||t.length===0||e==null)return[];if(Array.isArray(e)||(e=[e]),e.length===0)return[];const{valueFormatter:i}=this.params,s=[],n=typeof e[0]=="object",a=t.map(i);for(const r of e){let o=-1;n?o=a.indexOf(i(r)):o=t.indexOf(r),o>=0&&s.push(o)}return s}toggleListItemSelection(e){const t=this.findItemInSelected(e);t!==void 0?this.selectedItems.delete(t):this.selectedItems.add(e),this.refreshSelectedItems(),this.dispatchValueSelected()}refreshSelectedItems(){this.forEachRenderedRow(e=>{const t=this.findItemInSelected(e.getValue())!==void 0;e.updateSelected(t)})}findItemInSelected(e){if(typeof e=="object"){const t=this.params.valueFormatter,i=t(e);for(const s of this.selectedItems)if(t(s)===i)return s}else return this.selectedItems.has(e)?e:void 0}createRowComponent(e,t){const i=new iU(this.params);t.setAttribute("id",`${xk}-${i.getCompId()}`),i.setParentComponent(this),this.createBean(i),i.setState(e);const{highlightMatch:s,searchType:n="fuzzy"}=this.params;return s&&n!=="fuzzy"&&i.highlightString(this.getSearchString()),i}getRowForMouseEvent(e){const i=this.getGui().getBoundingClientRect(),s=this.getScrollTop(),n=e.clientY-i.top+s;return Math.min(Math.floor(n/this.getRowHeight()),this.model.getRowCount()-1)}onMouseMove(e){const t=this.getRowForMouseEvent(e);t!==-1&&t!=this.lastRowHovered&&(this.lastRowHovered=t,this.highlightIndex(t,!0))}onMouseDown(e){e.preventDefault()}onMouseOut(e){this.getGui().contains(e.relatedTarget)||this.highlightIndex(-1)}onClick(e){const{multiSelect:t}=this.params;if(!this.currentList)return;const i=this.getRowForMouseEvent(e),s=this.currentList[i];t?this.toggleListItemSelection(s):(this.selectListItems([s]),this.dispatchValueSelected())}dispatchValueSelected(){this.dispatchLocalEvent({type:"richSelectListRowSelected",fromEnterKey:!1,value:this.selectedItems})}destroy(){super.destroy(),this.eLoading=void 0}},nU={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed",children:[{tag:"span",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"ag-input-text-field",ref:"eInput",cls:"ag-rich-select-field-input"},{tag:"span",ref:"eDeselect",cls:"ag-rich-select-deselect-button ag-picker-field-icon",role:"presentation"},{tag:"span",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},dS=class extends m.AgPickerField{constructor(e){var n,a;super(E(b({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"richSelectOpen",ariaRole:"combobox",template:(n=e==null?void 0:e.template)!=null?n:nU,agComponents:[m.AgInputTextFieldSelector],modalPicker:!1},e),{maxPickerHeight:(a=e==null?void 0:e.maxPickerHeight)!=null?a:"calc(var(--ag-row-height) * 6.5)"})),this.searchString="",this.searchStringCreator=null,this.eInput=m.RefPlaceholder,this.eDeselect=m.RefPlaceholder,this.skipWrapperAnnouncement=!1;const{value:t,valueList:i,searchStringCreator:s}=e||{};t!==void 0&&(this.value=t),s&&(this.searchStringCreator=s),i!=null&&this.setValues(i),this.registerCSS(eU)}wireBeans(e){this.userCompFactory=e.userCompFactory,this.ariaAnnounce=e.ariaAnnounce,this.registry=e.registry}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),shouldDisplayTooltip:()=>{var n,a;return(a=(n=this.shouldDisplayTooltip)==null?void 0:n.call(this))!=null?a:!0}})),super.postConstruct(),this.createListComponent(),this.eDeselect.appendChild((0,m._createIconNoSpan)("richSelectRemove",this.beans));const{allowTyping:e,placeholder:t,suppressDeselectAll:i}=this.config;this.eDeselect.classList.add("ag-hidden"),e?(this.eInput.setAutoComplete(!1).setInputPlaceholder(t),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.setupAriaProperties();const{searchDebounceDelay:s=300}=this.config;this.clearSearchString=(0,m._debounce)(this,this.clearSearchString.bind(this),s),this.renderSelectedValue(),e&&this.eInput.onValueChange(n=>this.searchTextFromString(n)),this.addManagedElementListeners(this.eWrapper,{focus:this.onWrapperFocus.bind(this)}),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)}),i||this.addManagedElementListeners(this.eDeselect,{mousedown:this.onDeselectAllMouseDown.bind(this),click:this.onDeselectAllClick.bind(this)})}setupAriaProperties(){const{eWrapper:e,gos:t}=this;e.tabIndex=t.get("tabIndex");const i=this.getLocaleTextFunc();this.ariaDeleteSelection=i("ariaLabelRichSelectDeleteSelection","Press DELETE to deselect item"),this.ariaDeselectAllItems=i("ariaLabelRichSelectDeselectAllItems","Press DELETE to deselect all items"),this.ariaToggleSelection=i("ariaLabelRichSelectToggleSelection","Press SPACE to toggle selection")}createListComponent(){this.listComponent=this.createBean(new sU(this.config,this.eWrapper,()=>this.searchString)),this.listComponent.setParentComponent(this),this.addManagedListeners(this.listComponent,{richSelectListRowSelected:e=>{this.onListValueSelected(e.value,e.fromEnterKey)}})}renderSelectedValue(){var p,g,f;const{value:e,eDisplayField:t,config:i,gos:s}=this,{allowTyping:n,cellRenderer:a,initialInputValue:r,multiSelect:o,suppressDeselectAll:l,suppressMultiSelectPillRenderer:c}=i,h=(g=(p=i.valueFormatter)==null?void 0:p.call(i,e))!=null?g:String(e);if(n){this.eInput.setValue(r!=null?r:h);return}if(o&&!l){const y=e==null||Array.isArray(e)&&e.length===0;this.eDeselect.classList.toggle("ag-hidden",y)}let d;if(o&&!c){this.createOrUpdatePillContainer(t);return}a&&(d=(0,m._getEditorRendererDetails)(this.userCompFactory,i,(0,m._addGridCommonParams)(this.gos,{value:e,valueFormatted:h,getValue:()=>this.getValue(),setValue:y=>{this.setValue(y,!0)},setTooltip:(y,v)=>{var x;s.assertModuleRegistered("Tooltip",3),this.shouldDisplayTooltip=v,(x=this.tooltipFeature)==null||x.setTooltipAndRefresh(y)}})));let u;if(d&&(u=d.newAgStackInstance()),u)(0,m._clearElement)(t),Ck(u,t),u.then(y=>{this.addDestroyFunc(()=>this.destroyBean(y))});else{if((0,m._exists)(this.value))t.innerText=h,t.classList.remove("ag-display-as-placeholder");else{const{placeholder:y}=i;(0,m._exists)(y)?(t.textContent=y,t.classList.add("ag-display-as-placeholder")):(0,m._clearElement)(t)}this.shouldDisplayTooltip=(0,m._shouldDisplayTooltip)(()=>this.eDisplayField),(f=this.tooltipFeature)==null||f.setTooltipAndRefresh(h!=null?h:null)}}createPickerComponent(){const{values:e}=this;return e&&this.setValueList({valueList:e}),this.listComponent}setSearchStringCreator(e){this.searchStringCreator=e}setValueList(e){const{valueList:t,refresh:i}=e;!this.listComponent||this.listComponent.getCurrentList()===t||(this.listComponent.setCurrentList(t),i&&(this.values?this.listComponent.refresh(!0):(this.setValues(t),this.isPickerDisplayed&&(this.listComponent.selectValue(this.value)||this.listComponent.refresh())),this.alignPickerToComponent()))}setValues(e){this.values=e,this.searchStrings=this.getSearchStringsFromValues(e)}showPicker(){super.showPicker();const{listComponent:e,value:t}=this;if(!e)return;let i=null;e.selectValue(this.value),this.value!=null&&(i=e.getIndicesForValues(Array.isArray(t)?t:[t])[0]),i!=null?e.highlightIndex(i):e.refresh(),this.displayOrHidePicker()}beforeHidePicker(){super.beforeHidePicker()}createOrUpdatePillContainer(e){if(!this.pillContainer){const t=this.pillContainer=this.createBean(new J5);this.addDestroyFunc(()=>{this.destroyBean(this.pillContainer),this.pillContainer=null}),(0,m._clearElement)(e),e.appendChild(t.getGui());const{config:i,eWrapper:s,ariaDeleteSelection:n}=this,{valueFormatter:a}=i;t.init({eWrapper:s,valueFormatter:a,onPillMouseDown:r=>{r.stopImmediatePropagation()},announceItemFocus:()=>{this.announceAriaValue(n)},getValue:()=>this.getValue(),setValue:r=>this.setValue(r,!0)})}this.doWhileBlockingAnnouncement(()=>{var t;return(t=this.pillContainer)==null?void 0:t.refresh()})}doWhileBlockingAnnouncement(e){this.skipWrapperAnnouncement=!0,e(),this.skipWrapperAnnouncement=!1}onWrapperFocus(){const{eInput:e,config:t}=this,{allowTyping:i,multiSelect:s,suppressDeselectAll:n}=t;if(i){const a=e.getFocusableElement();a.focus(),a.select()}else s&&!n&&!this.skipWrapperAnnouncement&&this.announceAriaValue(this.ariaDeselectAllItems)}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}onDeselectAllMouseDown(e){e.stopImmediatePropagation()}onDeselectAllClick(){this.setValue([],!0)}buildSearchStringFromKeyboardEvent(e){let{key:t}=e;if(t===m.KeyCode.BACKSPACE)this.searchString=this.searchString.slice(0,-1),t="";else if(!(0,m._isEventFromPrintableCharacter)(e))return;e.preventDefault(),this.searchTextFromCharacter(t)}searchTextFromCharacter(e){this.searchString+=e,this.runSearch(),this.clearSearchString()}searchTextFromString(e){e==null&&(e=""),this.searchString=e,this.runSearch()}getSearchStringsFromValues(e){const{config:t}=this,{valueFormatter:i=s=>String(s)}=t;return typeof e[0]=="object"&&this.searchStringCreator?this.searchStringCreator(e):e.map(s=>i(s))}filterListModel(e){const{filterList:t}=this.config;t&&this.setValueList({valueList:e,refresh:!0})}runSearch(){var l;if(!this.listComponent)return;const{values:e}=this,t=this.searchStrings;if(!t){this.listComponent.highlightIndex(-1);return}const{suggestions:i,filteredValues:s}=this.getSuggestionsAndFilteredValues(this.searchString,t),{filterList:n,highlightMatch:a,searchType:r="fuzzy"}=this.config,o=!!(n&&this.searchString!=="");this.filterListModel(o?s:e),this.highlightEmptyValue()||this.highlightListValue(i,s,o),a&&r!=="fuzzy"&&((l=this.listComponent)==null||l.highlightFilterMatch(this.searchString)),this.displayOrHidePicker()}highlightEmptyValue(){var e,t;if(this.searchString===""){const i=(e=this.searchStrings)==null?void 0:e.indexOf("");if(i!==void 0&&i!==-1)return(t=this.listComponent)==null||t.highlightIndex(i),!0}return!1}highlightListValue(e,t,i){var s,n,a,r,o;if(e.length){const l=i?0:(s=this.searchStrings)==null?void 0:s.indexOf(e[0]);l!==void 0&&((n=this.listComponent)==null||n.highlightIndex(l))}else if((a=this.listComponent)==null||a.highlightIndex(-1),!i||t.length)(r=this.listComponent)==null||r.ensureIndexVisible(0);else if(i){this.getAriaElement().removeAttribute("data-active-option");const l=(o=this.listComponent)==null?void 0:o.getAriaElement();l&&(0,m._setAriaActiveDescendant)(l,null)}}getSuggestionsAndFilteredValues(e,t){let i=[];const s=[];if(!e.length)return{suggestions:i,filteredValues:s};const{searchType:n="fuzzy",filterList:a}=this.config;if(n==="fuzzy"){const r=(0,m._fuzzySuggestions)({inputValue:e,allSuggestions:t,hideIrrelevant:!0});i=r.values;const o=r.indices;if(a&&o.length)for(let l=0;l<o.length;l++)s.push(this.values[o[l]])}else i=t.filter((r,o)=>{const l=r.toLocaleLowerCase(),c=this.searchString.toLocaleLowerCase(),h=n==="match"?l.startsWith(c):l.indexOf(c)!==-1;return a&&h&&s.push(this.values[o]),h});return{suggestions:i,filteredValues:s}}displayOrHidePicker(){if(!this.listComponent)return;const e=this.listComponent.getGui(),t=this.listComponent.getCurrentList(),i=t?t.length===0:!1;e.classList.toggle("ag-hidden",i)}clearSearchString(){this.searchString=""}setValue(e,t,i,s){var a,r;if(this.value===e)return this;const n=Array.isArray(e);if(e!=null){if(!n){const o=(a=this.listComponent)==null?void 0:a.getCurrentList();if((o?o.indexOf(e):-1)===-1)return this}i||(r=this.listComponent)==null||r.selectValue(e)}return super.setValue(e,t),s||this.renderSelectedValue(),this}onNavigationKeyDown(e,t,i){var n;e.preventDefault();const s=t===m.KeyCode.DOWN;if(!this.isPickerDisplayed&&s){this.showPicker();return}(n=this.listComponent)==null||n.onNavigationKeyDown(t,i)}onEnterKeyDown(e){var t;if(this.isPickerDisplayed&&(e.preventDefault(),(t=this.listComponent)!=null&&t.getCurrentList())){const i=this.listComponent.getLastItemHovered();this.config.multiSelect||i==null?this.dispatchPickerEventAndHidePicker(this.value,!0):this.onListValueSelected(new Set([i]),!0)}}onDeleteKeyDown(e){const{eWrapper:t,beans:i}=this;(0,m._getActiveDomElement)(i)===t&&(e.preventDefault(),this.setValue([],!0))}onTabKeyDown(){const{config:e,isPickerDisplayed:t,listComponent:i}=this,{multiSelect:s}=e;if(!(!t||!i)){if(s){const n=this.getValueFromSet(i.getSelectedItems());n&&this.setValue(n,!1,!0,!0)}else{const n=i.getLastItemHovered();n&&this.setValue(n,!1,!0)}this.hidePicker()}}getValueFromSet(e){const{multiSelect:t}=this.config;let i=null;for(const s of e){if(e.size===1&&!t){i=s;break}i||(i=[]),i.push(s)}return Array.isArray(i)&&i.sort(),i}onListValueSelected(e,t){const i=this.getValueFromSet(e);this.setValue(i,!1,!0),this.config.multiSelect||this.dispatchPickerEventAndHidePicker(i,t)}dispatchPickerEventAndHidePicker(e,t){const i={type:"fieldPickerValueSelected",fromEnterKey:t,value:e};this.dispatchLocalEvent(i),this.hidePicker()}getFocusableElement(){const{allowTyping:e}=this.config;return e?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(e){var c;const{key:t}=e,{isPickerDisplayed:i,config:s,listComponent:n,pickerComponent:a}=this,{allowTyping:r,multiSelect:o,suppressDeselectAll:l}=s;switch(t){case m.KeyCode.LEFT:case m.KeyCode.RIGHT:(!r||this.pillContainer)&&(e.preventDefault(),this.pillContainer&&((c=this.listComponent)==null||c.highlightIndex(-1),this.pillContainer.onNavigationKeyDown(e)));break;case m.KeyCode.PAGE_HOME:case m.KeyCode.PAGE_END:if(r){e.preventDefault();const h=this.eInput.getInputElement(),d=t===m.KeyCode.PAGE_HOME?0:h.value.length;h.setSelectionRange(d,d);break}case m.KeyCode.PAGE_UP:case m.KeyCode.PAGE_DOWN:e.preventDefault(),a&&(n==null||n.navigateToPage(t));break;case m.KeyCode.DOWN:case m.KeyCode.UP:this.onNavigationKeyDown(e,t,()=>{o&&(this.doWhileBlockingAnnouncement(()=>this.eWrapper.focus()),this.announceAriaValue(this.ariaToggleSelection))});break;case m.KeyCode.ESCAPE:i&&((0,m._isVisible)(this.listComponent.getGui())&&(e.preventDefault(),(0,m._stopPropagationForAgGrid)(e)),this.hidePicker());break;case m.KeyCode.ENTER:this.onEnterKeyDown(e);break;case m.KeyCode.SPACE:if(e.preventDefault(),i&&o&&n){const h=n.getLastItemHovered();h&&n.toggleListItemSelection(h)}break;case m.KeyCode.TAB:this.onTabKeyDown();break;case m.KeyCode.DELETE:o&&!l&&this.onDeleteKeyDown(e);break;default:r||this.buildSearchStringFromKeyboardEvent(e)}}announceAriaValue(e){var t;(t=this.ariaAnnounce)==null||t.announceValue(e,"richSelect")}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),this.searchStrings=void 0,super.destroy()}};function Ck(e,t){e.then(i=>{const s=i.getGui();s!=null&&t.appendChild(s)})}var aU={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"ag-input-text-field",ref:"eInput",cls:"ag-rich-select-field-input"},{tag:"span",ref:"eDeselect",cls:"ag-rich-select-deselect-button ag-picker-field-icon",role:"presentation"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},Sk=class extends dS{constructor(e){super(E(b({},e),{template:aU,agComponents:[m.AgInputTextFieldSelector]})),this.params=e}showPicker(){setTimeout(()=>super.showPicker())}hidePicker(){setTimeout(()=>super.hidePicker())}postConstruct(){super.postConstruct();const{wrapperClassName:e,ariaLabel:t}=this.params;(0,m._setDisplayed)(this.eDisplayField,!1),e&&this.eWrapper.classList.add(e),(0,m._setAriaLabelledBy)(this.eWrapper,""),(0,m._setAriaLabel)(this.eWrapper,t)}onEnterKeyDown(e){(0,m._stopPropagationForAgGrid)(e),this.isPickerDisplayed?super.onEnterKeyDown(e):(e.preventDefault(),this.showPicker())}},Mk=class extends m.BeanStub{constructor(e,t,i){super(),this.eGui=e,this.focusWrapper=t,this.eFocusableComp=i}postConstruct(){this.addManagedElementListeners(this.eGui,{keydown:t=>{switch(t.key){case m.KeyCode.TAB:t.defaultPrevented||(0,m._stopPropagationForAgGrid)(t);break;case m.KeyCode.UP:case m.KeyCode.DOWN:(0,m._stopPropagationForAgGrid)(t);break;case m.KeyCode.ESCAPE:if((0,m._isStopPropagationForAgGrid)(t))return;this.eGui.contains((0,m._getActiveDomElement)(this.beans))&&(t.preventDefault(),(0,m._stopPropagationForAgGrid)(t),this.focusWrapper.focus());break}}});const e="ag-advanced-filter-builder-virtual-list-item-highlight";this.addManagedListeners(this.focusWrapper,{keydown:t=>{switch(t.key){case m.KeyCode.ENTER:if((0,m._isStopPropagationForAgGrid)(t))return;(0,m._getActiveDomElement)(this.beans)===this.focusWrapper&&(t.preventDefault(),(0,m._stopPropagationForAgGrid)(t),this.eFocusableComp.getFocusableElement().focus());break}},focusin:()=>{this.focusWrapper.classList.add(e)},focusout:t=>{this.focusWrapper.contains(t.relatedTarget)||this.focusWrapper.classList.remove(e)}})}};function Dk(e,t){return{pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderAddField",pickerAriaLabelValue:"Advanced Filter Builder Add Field",pickerType:"ag-list",valueList:[{key:"condition",displayValue:e("advancedFilterBuilderAddCondition")},{key:"join",displayValue:e("advancedFilterBuilderAddJoin")}],valueFormatter:i=>{var s;return i==null?"":(s=i.displayValue)!=null?s:i.key},pickerIcon:"advancedFilterBuilderAdd",maxPickerWidth:`${t!=null?t:120}px`,wrapperClassName:"ag-advanced-filter-builder-item-button",ariaLabel:e("advancedFilterBuilderAddButtonTooltip")}}var rU={tag:"div",cls:"ag-advanced-filter-builder-item-wrapper",role:"presentation",children:[{tag:"div",ref:"eItem",cls:"ag-advanced-filter-builder-item",role:"presentation",children:[{tag:"div",cls:"ag-advanced-filter-builder-item-tree-lines",attrs:{"aria-hidden":"true"},children:[{tag:"div",cls:"ag-advanced-filter-builder-item-tree-line-vertical-top ag-advanced-filter-builder-item-tree-line-horizontal"}]}]}]},oU=class extends m.Component{constructor(e,t){super(rU),this.item=e,this.focusWrapper=t,this.eItem=m.RefPlaceholder}wireBeans(e){this.advFilterExpSvc=e.advFilterExpSvc,this.registry=e.registry}postConstruct(){var i;(0,m._setAriaLevel)(this.focusWrapper,2);const e=Dk(s=>this.advFilterExpSvc.translate(s),(i=this.gos.get("advancedFilterBuilderParams"))==null?void 0:i.addSelectWidth),t=this.createManagedBean(new Sk(e));this.addManagedListeners(t,{fieldPickerValueSelected:({value:s})=>{this.dispatchLocalEvent({type:"advancedFilterBuilderAdded",item:this.item,isJoin:s.key==="join"})}}),this.eItem.appendChild(t.getGui()),this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>t.getGui(),getLocation:()=>"advancedFilter",getTooltipValue:()=>this.advFilterExpSvc.translate("advancedFilterBuilderAddButtonTooltip")})),this.createManagedBean(new Mk(this.getGui(),this.focusWrapper,t)),(0,m._setAriaLabel)(this.focusWrapper,this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderItem",[this.advFilterExpSvc.translate("advancedFilterBuilderAddButtonTooltip"),`${this.item.level+1}`]))}afterAdd(){}},lU=class extends m.Component{constructor(){super({tag:"div",cls:"ag-advanced-filter-builder-item-condition",role:"presentation"}),this.validationMessage=null}wireBeans(e){this.advFilterExpSvc=e.advFilterExpSvc}init(e){const{item:t,createPill:i}=e;this.item=t,this.createPill=i,this.filterModel=t.filterModel,this.setupColumnCondition(this.filterModel),this.validate(),this.addDestroyFunc(()=>this.destroyBeans([this.eColumnPill,this.eOperatorPill,this.eOperandPill]))}getDragName(){return this.filterModel.colId?this.advFilterExpSvc.parseColumnFilterModel(this.filterModel):this.getDefaultColumnDisplayValue()}getAriaLabel(){return`${this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderFilterItem")} ${this.getDragName()}`}getValidationMessage(){return this.validationMessage}getFocusableElement(){return this.eColumnPill.getFocusableElement()}setupColumnCondition(e){var i;const t=this.advFilterExpSvc.getColumnDetails(e.colId);this.baseCellDataType=t.baseCellDataType,this.column=t.column,this.numOperands=this.getNumOperands(this.getOperatorKey()),this.eColumnPill=this.createPill({key:this.getColumnKey(),displayValue:(i=this.getColumnDisplayValue())!=null?i:this.getDefaultColumnDisplayValue(),cssClass:"ag-advanced-filter-builder-column-pill",isSelect:!0,getEditorParams:()=>({values:this.advFilterExpSvc.getColumnAutocompleteEntries()}),update:s=>this.setColumnKey(s),pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderColumnSelectField",pickerAriaLabelValue:"Advanced Filter Builder Column Select Field",ariaLabel:this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderColumn")}),this.getGui().appendChild(this.eColumnPill.getGui()),(0,m._exists)(this.getColumnKey())&&(this.createOperatorPill(),this.hasOperand()&&this.createOperandPill())}createOperatorPill(){var e;this.eOperatorPill=this.createPill({key:this.getOperatorKey(),displayValue:(e=this.getOperatorDisplayValue())!=null?e:this.getDefaultOptionSelectValue(),cssClass:"ag-advanced-filter-builder-option-pill",isSelect:!0,getEditorParams:()=>({values:this.getOperatorAutocompleteEntries()}),update:t=>this.setOperatorKey(t),pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderOptionSelectField",pickerAriaLabelValue:"Advanced Filter Builder Option Select Field",ariaLabel:this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderOption")}),this.eColumnPill.getGui().insertAdjacentElement("afterend",this.eOperatorPill.getGui())}createOperandPill(){var i;const{filter:e}=this.filterModel,t=(i=typeof e=="number"?(0,m._toStringOrNull)(e):e)!=null?i:"";this.eOperandPill=this.createPill({key:t,valueFormatter:s=>this.advFilterExpSvc.getOperandDisplayValue(E(b({},this.filterModel),{filter:s}),!0),baseCellDataType:this.baseCellDataType,cssClass:"ag-advanced-filter-builder-value-pill",isSelect:!1,update:s=>this.setOperand(s),ariaLabel:this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderValue")}),this.getGui().appendChild(this.eOperandPill.getGui())}getColumnKey(){return this.filterModel.colId}getColumnDisplayValue(){return this.advFilterExpSvc.getColumnDisplayValue(this.filterModel)}getOperatorKey(){return this.filterModel.type}getOperatorDisplayValue(){return this.advFilterExpSvc.getOperatorDisplayValue(this.filterModel)}getOperandDisplayValue(){return this.advFilterExpSvc.getOperandDisplayValue(this.filterModel,!0)}hasOperand(){return this.numOperands>0}getOperatorAutocompleteEntries(){return this.column?this.advFilterExpSvc.getOperatorAutocompleteEntries(this.column,this.baseCellDataType):[]}setColumnKey(e){this.eOperatorPill||this.createOperatorPill();const t=this.advFilterExpSvc.getColumnDetails(e);this.column=t.column;const i=t.baseCellDataType;this.baseCellDataType!==i&&(this.baseCellDataType=i,this.setOperatorKey(void 0),this.eOperatorPill&&((0,m._removeFromParent)(this.eOperatorPill.getGui()),this.destroyBean(this.eOperatorPill),this.createOperatorPill()),this.validate()),this.filterModel.colId=e,this.filterModel.filterType=this.baseCellDataType}setOperatorKey(e){const t=this.getNumOperands(e);t!==this.numOperands&&(this.numOperands=t,t===0?this.destroyOperandPill():(this.createOperandPill(),this.baseCellDataType!=="number"&&this.setOperand(""))),this.filterModel.type=e,this.validate()}setOperand(e){let t=e;this.baseCellDataType==="number"&&(t=(0,m._exists)(e)?Number(e):""),this.filterModel.filter=t,this.validate()}getNumOperands(e){var t,i;return(i=(t=this.advFilterExpSvc.getExpressionOperator(this.baseCellDataType,e))==null?void 0:t.numOperands)!=null?i:0}destroyOperandPill(){delete this.filterModel.filter,this.getGui().removeChild(this.eOperandPill.getGui()),this.destroyBean(this.eOperandPill),this.eOperandPill=void 0}validate(){let e=null;(0,m._exists)(this.getColumnKey())?(0,m._exists)(this.getOperatorKey())?this.numOperands>0&&!(0,m._exists)(this.getOperandDisplayValue())&&(e=this.advFilterExpSvc.translate("advancedFilterBuilderValidationEnterValue")):e=this.advFilterExpSvc.translate("advancedFilterBuilderValidationSelectOption"):e=this.advFilterExpSvc.translate("advancedFilterBuilderValidationSelectColumn"),this.item.valid=!e,e!==this.validationMessage&&(this.validationMessage=e,this.dispatchLocalEvent({type:"advancedFilterBuilderValidChanged"}))}getDefaultColumnDisplayValue(){return this.advFilterExpSvc.translate("advancedFilterBuilderSelectColumn")}getDefaultOptionSelectValue(){return this.advFilterExpSvc.translate("advancedFilterBuilderSelectOption")}},cU={tag:"div",cls:"ag-advanced-filter-builder-pill-wrapper",role:"presentation",children:[{tag:"div",ref:"ePill",cls:"ag-advanced-filter-builder-pill",role:"button",children:[{tag:"span",ref:"eLabel",cls:"ag-advanced-filter-builder-pill-display"}]}]},hU=class extends m.Component{constructor(e){super(cU),this.params=e,this.ePill=m.RefPlaceholder,this.eLabel=m.RefPlaceholder;const{value:t,valueFormatter:i}=e;this.value=t,this.displayValue=i(t)}wireBeans(e){this.advFilterExpSvc=e.advFilterExpSvc}postConstruct(){const{cssClass:e,ariaLabel:t}=this.params;this.ePill.classList.add(e),this.activateTabIndex([this.ePill]),this.eLabel.id=`${this.getCompId()}`,(0,m._setAriaDescribedBy)(this.ePill,this.eLabel.id),(0,m._setAriaLabel)(this.ePill,t),this.renderValue(),this.addManagedListeners(this.ePill,{click:i=>{i.preventDefault(),this.showEditor()},keydown:i=>{switch(i.key){case m.KeyCode.ENTER:i.preventDefault(),(0,m._stopPropagationForAgGrid)(i),this.showEditor();break}}}),this.addDestroyFunc(()=>this.destroyBean(this.eEditor))}getFocusableElement(){return this.ePill}showEditor(){if(this.eEditor)return;(0,m._setDisplayed)(this.ePill,!1),this.eEditor=this.createEditorComp(this.params.type),this.eEditor.setValue(this.value);const e=this.eEditor.getGui();this.eEditor.addManagedElementListeners(e,{keydown:t=>{switch(t.key){case m.KeyCode.ENTER:t.preventDefault(),(0,m._stopPropagationForAgGrid)(t),this.updateValue(!0);break;case m.KeyCode.ESCAPE:t.preventDefault(),(0,m._stopPropagationForAgGrid)(t),this.hideEditor(!0);break}},focusout:()=>this.updateValue(!1)}),this.getGui().appendChild(e),this.eEditor.getFocusableElement().focus()}createEditorComp(e){let t;switch(e){case"text":t=new m.AgInputTextField;break;case"number":t=new m.AgInputNumberField;break;case"date":t=new m.AgInputDateField;break}return this.createBean(t)}hideEditor(e){const{eEditor:t}=this;t&&(this.eEditor=void 0,this.getGui().removeChild(t.getGui()),this.destroyBean(t),(0,m._setDisplayed)(this.ePill,!0),e&&this.ePill.focus())}renderValue(){let e;const{displayValue:t,eLabel:i}=this,{classList:s}=i;s.remove("ag-advanced-filter-builder-value-empty","ag-advanced-filter-builder-value-number","ag-advanced-filter-builder-value-text"),(0,m._exists)(t)?this.params.type==="number"?(e=t,s.add("ag-advanced-filter-builder-value-number")):(e=`"${t}"`,s.add("ag-advanced-filter-builder-value-text")):(e=this.advFilterExpSvc.translate("advancedFilterBuilderEnterValue"),s.add("ag-advanced-filter-builder-value-empty")),i.textContent=e}updateValue(e){var i;if(!this.eEditor)return;const t=(i=this.eEditor.getValue())!=null?i:"";this.dispatchLocalEvent({type:"fieldValueChanged",value:t}),this.value=t,this.displayValue=this.params.valueFormatter(t),this.renderValue(),this.hideEditor(e)}},dU=class extends m.Component{wireBeans(e){this.advFilterExpSvc=e.advFilterExpSvc}constructor(){super({tag:"div",cls:"ag-advanced-filter-builder-item-condition",role:"presentation"})}init(e){const{item:t,createPill:i}=e,s=t.filterModel;this.filterModel=s,this.ePill=i({key:s.type,displayValue:this.advFilterExpSvc.parseJoinOperator(s),cssClass:"ag-advanced-filter-builder-join-pill",isSelect:!0,getEditorParams:()=>({values:this.advFilterExpSvc.getJoinOperatorAutocompleteEntries()}),update:n=>s.type=n,pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderJoinSelectField",pickerAriaLabelValue:"Advanced Filter Builder Join Operator Select Field",ariaLabel:this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderJoinOperator")}),this.getGui().appendChild(this.ePill.getGui()),this.addDestroyFunc(()=>this.destroyBean(this.ePill))}getDragName(){return this.advFilterExpSvc.parseJoinOperator(this.filterModel)}getAriaLabel(){return`${this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderGroupItem")} ${this.getDragName()}`}getValidationMessage(){return null}getFocusableElement(){return this.ePill.getFocusableElement()}},uU={tag:"div",cls:"ag-picker-field ag-advanced-filter-builder-pill-wrapper",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-advanced-filter-builder-pill ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display ag-advanced-filter-builder-pill-display"},{tag:"ag-input-text-field",ref:"eInput",cls:"ag-rich-select-field-input"},{tag:"span",ref:"eDeselect",cls:"ag-rich-select-deselect-button ag-picker-field-icon",role:"presentation"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},pU=class extends dS{constructor(e){super(E(b({},e),{template:uU,agComponents:[m.AgInputTextFieldSelector]})),this.params=e}getFocusableElement(){return this.eWrapper}showPicker(){setTimeout(()=>super.showPicker())}hidePicker(){setTimeout(()=>super.hidePicker())}postConstruct(){super.postConstruct();const{wrapperClassName:e,ariaLabel:t}=this.params;this.eWrapper.classList.add(e),(0,m._setAriaLabelledBy)(this.eWrapper,""),(0,m._setAriaLabel)(this.eWrapper,t)}createPickerComponent(){var e;if(!this.values){const{values:t}=this.params.getEditorParams();this.values=t;const i=this.value.key,s=(e=t.find(n=>n.key===i))!=null?e:{key:i,displayValue:this.value.displayValue};this.value=s}return super.createPickerComponent()}onEnterKeyDown(e){(0,m._stopPropagationForAgGrid)(e),this.isPickerDisplayed?super.onEnterKeyDown(e):(e.preventDefault(),this.showPicker())}},gU={tag:"div",cls:"ag-advanced-filter-builder-item-wrapper",role:"presentation",children:[{tag:"div",cls:"ag-advanced-filter-builder-item",role:"presentation",children:[{tag:"div",ref:"eTreeLines",cls:"ag-advanced-filter-builder-item-tree-lines",attrs:{"aria-hidden":"true"}},{tag:"span",ref:"eDragHandle",cls:"ag-drag-handle",attrs:{"aria-hidden":"true"}},{tag:"span",ref:"eValidation",cls:"ag-advanced-filter-builder-item-button ag-advanced-filter-builder-invalid",attrs:{"aria-hidden":"true"}}]},{tag:"div",ref:"eButtons",cls:"ag-advanced-filter-builder-item-buttons",children:[{tag:"span",ref:"eMoveUpButton",cls:"ag-advanced-filter-builder-item-button",role:"button"},{tag:"span",ref:"eMoveDownButton",cls:"ag-advanced-filter-builder-item-button",role:"button"},{tag:"div",ref:"eAddButton",role:"presentation"},{tag:"span",ref:"eRemoveButton",cls:"ag-advanced-filter-builder-item-button",role:"button"}]}]},uS=class extends m.TabGuardComp{constructor(e,t,i){super(gU),this.item=e,this.dragFeature=t,this.focusWrapper=i,this.eTreeLines=m.RefPlaceholder,this.eDragHandle=m.RefPlaceholder,this.eButtons=m.RefPlaceholder,this.eValidation=m.RefPlaceholder,this.eMoveUpButton=m.RefPlaceholder,this.eMoveDownButton=m.RefPlaceholder,this.eAddButton=m.RefPlaceholder,this.eRemoveButton=m.RefPlaceholder,this.moveUpDisabled=!1,this.moveDownDisabled=!1}wireBeans(e){this.dragAndDrop=e.dragAndDrop,this.advFilterExpSvc=e.advFilterExpSvc,this.registry=e.registry}postConstruct(){const{filterModel:e,level:t,showMove:i}=this.item,s=e.filterType==="join";if(this.ePillWrapper=this.createManagedBean(s?new dU:new lU),this.ePillWrapper.init({item:this.item,createPill:n=>this.createPill(n)}),this.eDragHandle.insertAdjacentElement("afterend",this.ePillWrapper.getGui()),t===0){const n=(0,m._createElement)({tag:"div",cls:"ag-advanced-filter-builder-item-tree-line-vertical-bottom ag-advanced-filter-builder-item-tree-line-root"});this.eTreeLines.appendChild(n),(0,m._setDisplayed)(this.eDragHandle,!1),(0,m._setDisplayed)(this.eButtons,!1),(0,m._setAriaExpanded)(this.focusWrapper,!0)}else this.setupTreeLines(t),this.eDragHandle.appendChild((0,m._createIconNoSpan)("advancedFilterBuilderDrag",this.beans)),this.setupValidation(),this.setupMoveButtons(i),this.setupAddButton(),this.setupRemoveButton(),this.setupDragging(),this.updateAriaExpanded();(0,m._setAriaLevel)(this.focusWrapper,t+1),this.initialiseTabGuard({}),this.createManagedBean(new Mk(this.getGui(),this.focusWrapper,this.ePillWrapper)),this.updateAriaLabel(),this.addManagedListeners(this.ePillWrapper,{advancedFilterBuilderValueChanged:()=>this.dispatchLocalEvent({type:"advancedFilterBuilderValueChanged"}),advancedFilterBuilderValidChanged:()=>this.updateValidity()})}setState(e){var o,l;const{level:t}=this.item;if(t===0)return;const{showMove:i}=this.item,{disableMoveUp:s,disableMoveDown:n,treeLines:a,showStartTreeLine:r}=e;this.updateTreeLines(a,r),this.updateAriaExpanded(),i&&(this.moveUpDisabled=!!s,this.moveDownDisabled=!!n,this.eMoveUpButton.classList.toggle("ag-advanced-filter-builder-item-button-disabled",s),this.eMoveDownButton.classList.toggle("ag-advanced-filter-builder-item-button-disabled",n),(0,m._setAriaDisabled)(this.eMoveUpButton,!!s),(0,m._setAriaDisabled)(this.eMoveDownButton,!!n),(o=this.moveUpTooltipFeature)==null||o.refreshTooltip(),(l=this.moveDownTooltipFeature)==null||l.refreshTooltip())}focusMoveButton(e){(e?this.eMoveUpButton:this.eMoveDownButton).focus()}afterAdd(){this.ePillWrapper.getFocusableElement().focus()}setupTreeLines(e){for(let t=0;t<e;t++)this.eTreeLines.appendChild((0,m._createElement)({tag:"div"}))}updateTreeLines(e,t){const i=e.length-1,{children:s}=this.eTreeLines;for(let a=0;a<i;a++){const r=s.item(a);r&&r.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical",!e[a])}const n=s.item(i);if(n){n.classList.add("ag-advanced-filter-builder-item-tree-line-horizontal");const a=e[i];n.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical-top",a),n.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical",!a)}this.eDragHandle.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical-bottom",t)}setupValidation(){this.eValidation.appendChild((0,m._createIconNoSpan)("advancedFilterBuilderInvalid",this.beans)),this.validationTooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eValidation,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.ePillWrapper.getValidationMessage(),getTooltipShowDelayOverride:()=>1e3})),this.updateValidity()}setupAddButton(){var i;const e=Dk(s=>this.advFilterExpSvc.translate(s),(i=this.gos.get("advancedFilterBuilderParams"))==null?void 0:i.addSelectWidth),t=this.createManagedBean(new Sk(e));this.addManagedListeners(t,{fieldPickerValueSelected:({value:s})=>this.dispatchLocalEvent({type:"advancedFilterBuilderAdded",item:this.item,isJoin:s.key==="join"})}),this.eAddButton.appendChild(t.getGui()),this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eAddButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.advFilterExpSvc.translate("advancedFilterBuilderAddButtonTooltip")}))}setupRemoveButton(){this.eRemoveButton.appendChild((0,m._createIconNoSpan)("advancedFilterBuilderRemove",this.beans)),this.addManagedListeners(this.eRemoveButton,{click:()=>this.removeItem(),keydown:e=>{switch(e.key){case m.KeyCode.ENTER:e.preventDefault(),(0,m._stopPropagationForAgGrid)(e),this.removeItem();break}}}),this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eRemoveButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.advFilterExpSvc.translate("advancedFilterBuilderRemoveButtonTooltip")})),(0,m._setAriaLabel)(this.eRemoveButton,this.advFilterExpSvc.translate("advancedFilterBuilderRemoveButtonTooltip")),this.activateTabIndex([this.eRemoveButton])}setupMoveButtons(e){e?(this.eMoveUpButton.appendChild((0,m._createIconNoSpan)("advancedFilterBuilderMoveUp",this.beans)),this.addManagedListeners(this.eMoveUpButton,{click:()=>this.moveItem(!0),keydown:t=>{switch(t.key){case m.KeyCode.ENTER:t.preventDefault(),(0,m._stopPropagationForAgGrid)(t),this.moveItem(!0);break}}}),this.moveUpTooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eMoveUpButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.moveUpDisabled?null:this.advFilterExpSvc.translate("advancedFilterBuilderMoveUpButtonTooltip")})),(0,m._setAriaLabel)(this.eMoveUpButton,this.advFilterExpSvc.translate("advancedFilterBuilderMoveUpButtonTooltip")),this.eMoveDownButton.appendChild((0,m._createIconNoSpan)("advancedFilterBuilderMoveDown",this.beans)),this.addManagedListeners(this.eMoveDownButton,{click:()=>this.moveItem(!1),keydown:t=>{switch(t.key){case m.KeyCode.ENTER:t.preventDefault(),(0,m._stopPropagationForAgGrid)(t),this.moveItem(!1);break}}}),this.moveDownTooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eMoveDownButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.moveDownDisabled?null:this.advFilterExpSvc.translate("advancedFilterBuilderMoveDownButtonTooltip")})),(0,m._setAriaLabel)(this.eMoveDownButton,this.advFilterExpSvc.translate("advancedFilterBuilderMoveDownButtonTooltip")),this.activateTabIndex([this.eMoveUpButton,this.eMoveDownButton])):((0,m._setDisplayed)(this.eMoveUpButton,!1),(0,m._setDisplayed)(this.eMoveDownButton,!1))}updateValidity(){var e;(0,m._setVisible)(this.eValidation,!this.item.valid),(e=this.validationTooltipFeature)==null||e.refreshTooltip(),this.updateAriaLabel()}createPill(e){var r,o;const{key:t,cssClass:i,update:s,ariaLabel:n}=e,a=l=>{l!=null&&(s(l),this.dispatchLocalEvent({type:"advancedFilterBuilderValueChanged"}))};if(e.isSelect){const{getEditorParams:l,pickerAriaLabelKey:c,pickerAriaLabelValue:h,displayValue:d}=e,u=this.gos.get("advancedFilterBuilderParams"),p=`${(r=u==null?void 0:u.pillSelectMinWidth)!=null?r:140}px`,g=`${(o=u==null?void 0:u.pillSelectMaxWidth)!=null?o:200}px`,f=this.createBean(new pU({pickerAriaLabelKey:c,pickerAriaLabelValue:h,pickerType:"ag-list",value:{key:t,displayValue:d},valueFormatter:y=>{var v;return y==null?"":(v=y.displayValue)!=null?v:y.key},variableWidth:!0,minPickerWidth:p,maxPickerWidth:g,getEditorParams:l,wrapperClassName:i,ariaLabel:n,pickerIcon:"advancedFilterBuilderSelectOpen"}));return this.addManagedListeners(f,{fieldPickerValueSelected:({value:y})=>a(y==null?void 0:y.key)}),f}else{const{baseCellDataType:l,valueFormatter:c}=e,h=this.createBean(new hU({value:t,valueFormatter:c,cssClass:i,type:this.getInputType(l),ariaLabel:n}));return this.addManagedListeners(h,{fieldValueChanged:({value:d})=>a(d)}),h}}getInputType(e){switch(e){case"text":case"object":case"boolean":return"text";case"number":return"number";case"date":case"dateString":return"date"}}setupDragging(){const e={type:m.DragSourceType.AdvancedFilterBuilder,eElement:this.eDragHandle,dragItemName:()=>this.ePillWrapper.getDragName(),getDefaultIconName:()=>"notAllowed",getDragItem:()=>({}),onDragStarted:()=>this.dragFeature.dispatchLocalEvent({type:"advancedFilterBuilderDragStarted",item:this.item}),onDragStopped:()=>this.dragFeature.dispatchLocalEvent({type:"advancedFilterBuilderDragEnded"})};this.dragAndDrop.addDragSource(e,!0),this.addDestroyFunc(()=>this.dragAndDrop.removeDragSource(e))}updateAriaLabel(){const e=this.ePillWrapper.getAriaLabel(),t=`${this.item.level+1}`,i=this.ePillWrapper.getValidationMessage();let s;i?s=this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderItemValidation",[e,t,i]):s=this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderItem",[e,t]),(0,m._setAriaLabel)(this.focusWrapper,s)}updateAriaExpanded(){(0,m._removeAriaExpanded)(this.focusWrapper);const{filterModel:e}=this.item;(e==null?void 0:e.filterType)==="join"&&e.conditions.length&&(0,m._setAriaExpanded)(this.focusWrapper,!0)}removeItem(){this.dispatchLocalEvent({type:"advancedFilterBuilderRemoved",item:this.item})}moveItem(e){this.dispatchLocalEvent({type:"advancedFilterBuilderMoved",item:this.item,backwards:e})}},fU={tag:"div",cls:"ag-advanced-filter-builder",role:"presentation",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eList",cls:"ag-advanced-filter-builder-list",role:"presentation"},{tag:"div",cls:"ag-advanced-filter-builder-button-panel",role:"presentation",children:[{tag:"button",ref:"eApplyFilterButton",cls:"ag-button ag-standard-button ag-advanced-filter-builder-apply-button"},{tag:"button",ref:"eCancelFilterButton",cls:"ag-button ag-standard-button ag-advanced-filter-builder-cancel-button"}]}]},mU=class extends m.Component{constructor(){super(fU),this.eList=m.RefPlaceholder,this.eApplyFilterButton=m.RefPlaceholder,this.eCancelFilterButton=m.RefPlaceholder,this.validationMessage=null}wireBeans(e){this.filterManager=e.filterManager,this.advancedFilter=e.advancedFilter,this.advFilterExpSvc=e.advFilterExpSvc,this.registry=e.registry}postConstruct(){var t;const{showMoveButtons:e}=(t=this.gos.get("advancedFilterBuilderParams"))!=null?t:{};this.showMove=!!e,this.addManagedPropertyListener("advancedFilterBuilderParams",({currentValue:i})=>{this.showMove=!!(i!=null&&i.showMoveButtons),this.refreshList(!1)}),this.filterModel=this.setupFilterModel(),this.setupVirtualList(),this.dragFeature=this.createManagedBean(new X5(this,this.virtualList)),this.setupButtons()}refresh(){const e=this.virtualList;let t=e.getLastFocusedRow();this.setupFilterModel(),this.validateItems(),this.refreshList(!1),t!=null&&(e.getComponentAt(t)||(t=0),e.focusRow(t))}getNumItems(){return this.items.length}moveItem(e,t){!t||!e||this.moveItemToIndex(e,t.rowIndex,t.position)}afterGuiAttached(){this.virtualList.awaitStable(()=>this.virtualList.focusRow(0))}setupVirtualList(){const e=this.virtualList=this.createManagedBean(new Od({cssIdentifier:"advanced-filter-builder",ariaRole:"tree",listName:this.advFilterExpSvc.translate("ariaAdvancedFilterBuilderList"),moveItemCallback:this.virtualListMoveItemCallback.bind(this)}));e.setComponentCreator(this.createItemComponent.bind(this)),e.setComponentUpdater(this.updateItemComponent.bind(this)),e.setRowHeight(40),this.eList.appendChild(e.getGui()),e.setModel({getRowCount:()=>{var t;return((t=this.items)==null?void 0:t.length)||0},getRow:t=>this.items[t],areRowsEqual:(t,i)=>t===i}),this.buildList(),e.refresh()}setupButtons(){this.eApplyFilterButton.textContent=this.advFilterExpSvc.translate("advancedFilterBuilderApply"),this.activateTabIndex([this.eApplyFilterButton]),this.addManagedElementListeners(this.eApplyFilterButton,{click:()=>{var t;this.advancedFilter.setModel(this.filterModel),(t=this.filterManager)==null||t.onFilterChanged({source:"advancedFilter"}),this.close()}}),this.validationTooltipFeature=this.createOptionalManagedBean(this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApplyFilterButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.validationMessage,getTooltipShowDelayOverride:()=>1e3})),this.validate();const e=t=>this.toggleCss("ag-advanced-filter-builder-validation",t);this.addManagedListeners(this.eApplyFilterButton,{mouseenter:()=>e(!0),mouseleave:()=>e(!1)}),this.eCancelFilterButton.textContent=this.advFilterExpSvc.translate("advancedFilterBuilderCancel"),this.activateTabIndex([this.eCancelFilterButton]),this.addManagedElementListeners(this.eCancelFilterButton,{click:()=>this.close()})}removeItemFromParent(e){const t=e.parent.conditions.indexOf(e.filterModel);return e.parent.conditions.splice(t,1),t}moveItemToIndex(e,t,i){var o;const s=this.items[t],n=((o=s.filterModel)==null?void 0:o.filterType)==="join"&&i==="bottom",a=n?s.filterModel:s.parent;if(!a||this.isChildOrSelf(a,e.filterModel)||s===e)return;this.removeItemFromParent(e);let r;n?r=0:(r=a.conditions.indexOf(s.filterModel),r===-1?r=a.conditions.length:i==="bottom"&&(r+=1)),a.conditions.splice(r,0,e.filterModel),this.refreshList(!1)}isChildOrSelf(e,t){return e===t||t.filterType==="join"&&t.conditions.some(i=>this.isChildOrSelf(e,i))}setupFilterModel(){const e=this.formatFilterModel(this.advancedFilter.getModel());return this.stringifiedModel=JSON.stringify(e),e}formatFilterModel(e){return e=e!=null?e:{filterType:"join",type:"AND",conditions:[]},e.filterType!=="join"&&(e={filterType:"join",type:"AND",conditions:[e]}),e}buildList(){const e=(t,i,s,n)=>{i.push({filterModel:t,level:s,parent:n,valid:!0,showMove:this.showMove}),t.filterType==="join"&&(t.conditions.forEach(a=>e(a,i,s+1,t)),s===0&&i.push({filterModel:null,level:s+1,parent:t,valid:!0}))};this.items=[],e(this.filterModel,this.items,0)}refreshList(e){if(!e){const t=[];this.items.forEach(i=>{i.valid||t.push(i.filterModel)}),this.buildList(),t.length&&this.items.forEach(i=>{i.filterModel&&t.includes(i.filterModel)&&(i.valid=!1)})}this.virtualList.refresh(e),this.validate()}updateItemComponent(e,t){const i=this.items.indexOf(e),s=(o,l)=>{const c=this.items.find(d=>d.filterModel===o),h=c==null?void 0:c.parent;if(h){const{conditions:d}=h;s(h,l),l.push(d[d.length-1]===o)}},n=[],{filterModel:a}=e;a&&(s(a,n),n[0]=!1);const r=(a==null?void 0:a.filterType)==="join"&&!!a.conditions.length;t.setState({disableMoveUp:i===1,disableMoveDown:!this.canMoveDown(e,i),treeLines:n,showStartTreeLine:r})}createItemComponent(e,t){const i=this.createBean(e.filterModel?new uS(e,this.dragFeature,t):new oU(e,t));return i.addManagedListeners(i,{advancedFilterBuilderRemoved:({item:s})=>this.removeItem(s),advancedFilterBuilderValueChanged:()=>this.validate(),advancedFilterBuilderAdded:({item:s,isJoin:n})=>this.addItem(s,n),advancedFilterBuilderMoved:({item:s,backwards:n})=>this.moveItemUpDown(s,n)}),i instanceof uS&&this.updateItemComponent(e,i),i}addItem(e,t){var d;const{parent:i,level:s,filterModel:n}=e,a=(n==null?void 0:n.filterType)==="join",r=t?{filterType:"join",type:"AND",conditions:[]}:{},o=a?n:i;let l=a?0:o.conditions.indexOf(n);l>=0?(a||(l+=1),o.conditions.splice(l,0,r)):o.conditions.push(r);let c=this.items.indexOf(e);const h=c>=0;if(h){e.filterModel&&c++;const u=[{filterModel:r,level:a?s+1:s,parent:o,valid:t,showMove:this.showMove}];this.items.splice(c,0,...u)}this.refreshList(h),h&&((d=this.virtualList.getComponentAt(c))==null||d.afterAdd())}removeItem(e){var o;const t=e.parent,{filterModel:i}=e,s=t.conditions.indexOf(i);t.conditions.splice(s,1);const n=((o=e.filterModel)==null?void 0:o.filterType)==="join",a=this.items.indexOf(e),r=!n&&a>=0;r&&this.items.splice(a,1),this.refreshList(r),a>=0&&this.virtualList.focusRow(a)}moveItemUpDown(e,t,i){const s=this.items.indexOf(e),n=t?s-1:s+1;if(n===0||!t&&!this.canMoveDown(e,s))return;const a=this.items[n],r=this.removeItemFromParent(e),{level:o,filterModel:l,parent:c}=e,{level:h,filterModel:d,parent:u}=a;if(t)if(h===o&&d.filterType==="join")d.conditions.push(l);else if(h<=o){const f=u.conditions.indexOf(d);u.conditions.splice(f,0,l)}else c.conditions[r-1].conditions.push(l);else if(h===o)if(d.filterType==="join")d.conditions.splice(0,0,l);else{const f=u.conditions.indexOf(d);u.conditions.splice(f+1,0,l)}else if(r<c.conditions.length)c.conditions.splice(r+1,0,l);else{const f=this.items.find(v=>v.filterModel===c),y=f.parent.conditions.indexOf(f.filterModel)+1;f.parent.conditions.splice(y,0,l)}this.refreshList(!1);const p=this.items.findIndex(({filterModel:f})=>f===l);if(p<0)return;const g=this.virtualList.getComponentAt(p);g instanceof uS&&(i||g.focusMoveButton(t))}virtualListMoveItemCallback(e,t){const i=e.item,s=this.items.indexOf(i);s<=0||s===this.items.length-1||t&&s===1||!t&&!this.canMoveDown(i,s)||(this.moveItemUpDown(i,t,!0),this.virtualList.focusRow(s+(t?-1:1)))}canMoveDown(e,t){return!(e.level===1&&t===this.items.length-2||e.level===1&&e.parent.conditions[e.parent.conditions.length-1]===e.filterModel)}close(){this.advancedFilter.getCtrl().toggleFilterBuilder({source:"ui"})}validate(){var t;let e=!this.items.every(({valid:i})=>i);e?this.validationMessage=this.advFilterExpSvc.translate("advancedFilterBuilderValidationIncomplete"):(e=JSON.stringify(this.filterModel)===this.stringifiedModel,e?this.validationMessage=this.advFilterExpSvc.translate("advancedFilterBuilderValidationAlreadyApplied"):this.validationMessage=null),(0,m._setDisabled)(this.eApplyFilterButton,e),(t=this.validationTooltipFeature)==null||t.refreshTooltip()}validateItems(){const e=i=>{i.type=void 0},t=i=>{delete i.filter};this.items.forEach(i=>{if(!i.valid||!i.filterModel||i.filterModel.filterType==="join")return;const{filterModel:s}=i,{colId:n}=s,a=this.advFilterExpSvc.getColumnAutocompleteEntries().find(({key:c})=>c===n),r=this.advFilterExpSvc.getColumnDetails(s.colId);if(!a||!r.column){i.valid=!1,s.colId=void 0,e(s),t(s);return}const l=this.advFilterExpSvc.getDataTypeExpressionOperator(r.baseCellDataType).operators[s.type];if(!l){i.valid=!1,e(s),t(s);return}if(l.numOperands>0&&!(0,m._exists)(s.filter)){i.valid=!1;return}})}},yU=class extends m.BeanStub{constructor(e){super(),this.enabled=e}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.popupSvc=e.popupSvc,this.advFilterExpSvc=e.advFilterExpSvc,this.environment=e.environment}postConstruct(){this.hasAdvancedFilterParent=!!this.gos.get("advancedFilterParent"),this.ctrlsSvc.whenReady(this,()=>this.setAdvancedFilterComp()),this.addManagedEventListeners({advancedFilterEnabledChanged:({enabled:e})=>this.onEnabledChanged(e)}),this.addManagedPropertyListener("advancedFilterParent",()=>this.updateComps()),this.addDestroyFunc(()=>{this.destroyAdvancedFilterComp(),this.destroyBean(this.eBuilderComp),this.eBuilderDialog&&this.eBuilderDialog.isAlive()&&this.destroyBean(this.eBuilderDialog)})}setupHeaderComp(e){var t;this.eHeaderComp&&((t=this.eHeaderComp)==null||t.getGui().remove(),this.destroyBean(this.eHeaderComp)),this.eHeaderComp=this.createManagedBean(new Y5(this.enabled&&!this.hasAdvancedFilterParent)),e.insertAdjacentElement("beforebegin",this.eHeaderComp.getGui())}focusHeaderComp(){return this.eHeaderComp?(this.eHeaderComp.getFocusableElement().focus(),!0):!1}refreshComp(){var e,t;(e=this.eFilterComp)==null||e.refresh(),(t=this.eHeaderComp)==null||t.refresh()}refreshBuilderComp(){var e;(e=this.eBuilderComp)==null||e.refresh()}getHeaderHeight(){var e,t;return(t=(e=this.eHeaderComp)==null?void 0:e.getHeight())!=null?t:0}setInputDisabled(e){var t,i;(t=this.eFilterComp)==null||t.setInputDisabled(e),(i=this.eHeaderComp)==null||i.setInputDisabled(e)}toggleFilterBuilder(e){const{source:t,force:i,eventSource:s}=e;if(i&&this.eBuilderDialog||i===!1&&!this.eBuilderDialog)return;if(this.eBuilderDialog){this.builderDestroySource=t,this.destroyBean(this.eBuilderDialog);return}this.setInputDisabled(!0);const{width:n,height:a,minWidth:r}=this.getBuilderDialogSize();this.eBuilderComp=this.createBean(new mU),this.eBuilderDialog=this.createBean(new jp({title:this.advFilterExpSvc.translate("advancedFilterBuilderTitle"),component:this.eBuilderComp,width:n,height:a,resizable:!0,movable:!0,maximizable:!0,centered:!0,closable:!0,minWidth:r,afterGuiAttached:()=>{var o;return(o=this.eBuilderComp)==null?void 0:o.afterGuiAttached()},postProcessPopupParams:{type:"advancedFilterBuilder",eventSource:s}})),this.dispatchFilterBuilderVisibleChangedEvent(t,!0),this.eBuilderDialog.addEventListener("destroyed",()=>{var o;this.destroyBean(this.eBuilderComp),this.eBuilderComp=void 0,this.eBuilderDialog=void 0,this.setInputDisabled(!1),this.dispatchLocalEvent({type:"advancedFilterBuilderClosed"}),this.dispatchFilterBuilderVisibleChangedEvent((o=this.builderDestroySource)!=null?o:"ui",!1),this.builderDestroySource=void 0})}dispatchFilterBuilderVisibleChangedEvent(e,t){this.eventSvc.dispatchEvent({type:"advancedFilterBuilderVisibleChanged",source:e,visible:t})}getBuilderDialogSize(){var r,o;const e=(o=(r=this.gos.get("advancedFilterBuilderParams"))==null?void 0:r.minWidth)!=null?o:500,t=this.popupSvc.getPopupParent(),i=Math.round((0,m._getAbsoluteWidth)(t))-2,s=Math.round((0,m._getAbsoluteHeight)(t)*.75)-2,n=Math.min(Math.max(600,e),i),a=Math.min(600,s);return{width:n,height:a,minWidth:e}}onEnabledChanged(e){this.enabled=e,this.updateComps()}updateComps(){this.setAdvancedFilterComp(),this.setHeaderCompEnabled(),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}setAdvancedFilterComp(){if(this.destroyAdvancedFilterComp(),!this.enabled)return;const e=this.gos.get("advancedFilterParent");if(this.hasAdvancedFilterParent=!!e,e){const t=this.createBean(new yk),i=t.getGui();this.environment.applyThemeClasses(i),i.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr"),e.appendChild(i),this.eFilterComp=t}}setHeaderCompEnabled(){var e;(e=this.eHeaderComp)==null||e.setEnabled(this.enabled&&!this.hasAdvancedFilterParent)}destroyAdvancedFilterComp(){this.eFilterComp&&((0,m._removeFromParent)(this.eFilterComp.getGui()),this.destroyBean(this.eFilterComp))}},vU=class{constructor(e){this.params=e,this.operators=[],this.operatorStartPositions=[],this.operatorEndPositions=[],this.activeOperator=0,this.validationError=null}parseExpression(e){this.operators.push(""),this.operatorStartPositions.push(e),this.operatorEndPositions.push(void 0);const{expression:t}=this.params;for(;e<t.length;){const i=t[e];if(i===" "){if(this.parseOperator(e-1))return this.activeOperator++,e-1;this.operators[this.activeOperator]+=i}else this.operators[this.activeOperator]+=i;e++}return this.parseOperator(e-1),e}isValid(){return!this.validationError&&(!this.operators.length||!!this.parsedOperator)}getValidationError(){return this.validationError}getFunction(){return this.parsedOperator==="OR"?"||":"&&"}getModel(){return this.parsedOperator==="OR"?"OR":"AND"}getAutocompleteListParams(e,t){let i;if(t==null)i="";else{const n=this.operators[t],a=this.operatorEndPositions[t];i=sS(n,e,a==null?this.params.expression.length:a+1)}let s=this.params.advFilterExpSvc.getJoinOperatorAutocompleteEntries();return(t||t==null&&this.activeOperator)&&(s=s.filter(({key:n})=>n===this.parsedOperator)),this.params.advFilterExpSvc.generateAutocompleteListParams(s,"join",i)}updateExpression(e,t,i){var o,l;let{expression:s}=this.params;const n=(o=t.displayValue)!=null?o:t.key;if(i===0)for(let c=this.operatorEndPositions.length-1;c>0;c--){const h=this.operatorEndPositions[c];h!=null&&(s=vl(s,this.operatorStartPositions[c],h,n).updatedValue)}const a=this.operatorStartPositions.length>i?this.operatorStartPositions[i]:e,r=(l=this.operatorEndPositions.length>i?this.operatorEndPositions[i]:void 0)!=null?l:nS(s,e,!0).endPosition;return vl(s,a,r,n,!0)}getNumOperators(){return this.operators.length}getLastOperatorEndPosition(){return this.operatorEndPositions[this.operatorEndPositions.length-1]}parseOperator(e){const t=this.operators.length>this.activeOperator?this.operators[this.activeOperator]:"",i=this.params.advFilterExpSvc.getExpressionJoinOperators(),s=Gm(t,i,n=>n);if(s){this.operatorEndPositions[this.activeOperator]=e;const n=i[s];if(this.activeOperator){if(s!==this.parsedOperator)return this.validationError||(this.validationError={message:this.params.advFilterExpSvc.translate("advancedFilterValidationJoinOperatorMismatch"),startPosition:e-t.length+1,endPosition:e}),!1}else this.parsedOperator=s;return t!==n&&(aS(this.params,t,n,e),this.operators[this.activeOperator]=n),!0}else return s===null?!1:(this.validationError||(this.validationError={message:this.params.advFilterExpSvc.translate("advancedFilterValidationInvalidJoinOperator"),startPosition:e-t.length+1,endPosition:e}),!0)}},bU=class bj{constructor(t,i){this.params=t,this.startPosition=i,this.expectingExpression=!0,this.expectingOperator=!1,this.expressionParsers=[],this.operatorParser=new vU(this.params),this.missingEndBracket=!1,this.extraEndBracket=!1}parseExpression(){let t=this.startPosition;const{expression:i}=this.params;for(;t<i.length;){const s=i[t];if(s==="("&&!this.expectingOperator){const n=new bj(this.params,t+1);t=n.parseExpression(),this.expressionParsers.push(n),this.expectingExpression=!1,this.expectingOperator=!0}else{if(s===")")return this.endPosition=t-1,this.startPosition===0&&(this.extraEndBracket=!0),t;if(s!==" ")if(this.expectingExpression){const n=new E5(this.params,t);t=n.parseExpression(),this.expressionParsers.push(n),this.expectingExpression=!1,this.expectingOperator=!0}else this.expectingOperator&&(t=this.operatorParser.parseExpression(t),this.expectingOperator=!1,this.expectingExpression=!0)}t++}return this.startPosition>0&&(this.missingEndBracket=!0),t}isValid(){return!this.missingEndBracket&&!this.extraEndBracket&&this.expressionParsers.length===this.operatorParser.getNumOperators()+1&&this.operatorParser.isValid()&&this.expressionParsers.every(t=>t.isValid())}getValidationError(){const t=this.operatorParser.getValidationError();for(let s=0;s<this.expressionParsers.length;s++){const n=this.expressionParsers[s].getValidationError();if(n)return t&&t.startPosition<n.startPosition?t:n}if(t)return t;if(this.extraEndBracket)return{message:this.params.advFilterExpSvc.translate("advancedFilterValidationExtraEndBracket"),startPosition:this.endPosition+1,endPosition:this.endPosition+1};let i;return this.expressionParsers.length===this.operatorParser.getNumOperators()?i="advancedFilterValidationMissingCondition":this.missingEndBracket&&(i="advancedFilterValidationMissingEndBracket"),i?{message:this.params.advFilterExpSvc.translate(i),startPosition:this.params.expression.length,endPosition:this.params.expression.length}:null}getFunctionString(t){const i=this.expressionParsers.length>1,s=this.expressionParsers.map(n=>n.getFunctionString(t)).join(` ${this.operatorParser.getFunction()} `);return i?`(${s})`:s}getFunctionParsed(t){const i=this.operatorParser.getFunction(),s=this.expressionParsers.map(a=>a.getFunctionParsed(t)),n=i==="&&"?"every":"some";return(a,r,o)=>s[n](l=>l(a,r,o))}getAutocompleteListParams(t){if(this.endPosition!=null&&t>this.endPosition+1)return;if(!this.expressionParsers.length)return this.getColumnAutocompleteListParams();const i=this.getExpressionParserIndex(t);if(i==null)return this.params.expression[t]==="("?{enabled:!1}:this.getColumnAutocompleteListParams();const n=this.expressionParsers[i].getAutocompleteListParams(t);if(!n){if(i<this.expressionParsers.length-1)return this.operatorParser.getAutocompleteListParams(t,i);if(this.expressionParsers.length===this.operatorParser.getNumOperators()){const a=this.operatorParser.getLastOperatorEndPosition();return a==null||t<=a+1?this.operatorParser.getAutocompleteListParams(t,this.operatorParser.getNumOperators()-1):this.getColumnAutocompleteListParams()}return this.params.expression[t-1]===")"?{enabled:!1}:this.operatorParser.getAutocompleteListParams(t)}return n}updateExpression(t,i,s){var l;const n=this.params.expression,a=this.getExpressionParserIndex(t);if(a==null){const c=s==="column"?this.params.advFilterExpSvc.getColumnValue(i):(l=i.displayValue)!=null?l:i.key;return vl(n,this.startPosition,this.startPosition,c,!0)}const o=this.expressionParsers[a].updateExpression(t,i,s);return o==null?s==="column"?vl(n,t,n.length-1,this.params.advFilterExpSvc.getColumnValue(i),!0):this.endPosition!=null&&t>this.endPosition+1?null:this.operatorParser.updateExpression(t,i,a):o}getModel(){return this.expressionParsers.length>1?{filterType:"join",type:this.operatorParser.getModel(),conditions:this.expressionParsers.map(t=>t.getModel())}:this.expressionParsers[0].getModel()}getColumnAutocompleteListParams(){return this.params.advFilterExpSvc.generateAutocompleteListParams(this.params.advFilterExpSvc.getColumnAutocompleteEntries(),"column","")}getExpressionParserIndex(t){let i;for(let s=0;s<this.expressionParsers.length&&!(this.expressionParsers[s].startPosition>t);s++)i=s;return i}},xU=class{constructor(e){this.params=e,this.valid=!1}parseExpression(){this.joinExpressionParser=new bU(this.params,0);const e=this.joinExpressionParser.parseExpression();return this.valid=e>=this.params.expression.length-1&&this.joinExpressionParser.isValid(),this.params.expression}isValid(){return this.valid}getValidationMessage(){const e=this.joinExpressionParser.getValidationError();if(!e)return null;const{message:t,startPosition:i,endPosition:s}=e;return i<this.params.expression.length?this.params.advFilterExpSvc.translate("advancedFilterValidationMessage",[t,this.params.expression.slice(i,s+1).trim()]):this.params.advFilterExpSvc.translate("advancedFilterValidationMessageAtEnd",[t])}getFunctionString(){const e=this.createFunctionParams();return{functionString:`return ${this.joinExpressionParser.getFunctionString(e)};`,params:e}}getFunctionParsed(){const e=this.createFunctionParams();return{expressionFunction:this.joinExpressionParser.getFunctionParsed(e),params:e}}getAutocompleteListParams(e){var t;return(t=this.joinExpressionParser.getAutocompleteListParams(e))!=null?t:{enabled:!1}}updateExpression(e,t,i){return this.joinExpressionParser.updateExpression(e,t,i)}getModel(){return this.isValid()?this.joinExpressionParser.getModel():null}createFunctionParams(){return{operands:[],operators:[],evaluatorParams:[]}}},CU=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="advancedFilter",this.appliedExpression=null,this.expression=null,this.isValid=!0}wireBeans(e){this.valueSvc=e.valueSvc,this.colModel=e.colModel,this.dataTypeSvc=e.dataTypeSvc,this.advFilterExpSvc=e.advFilterExpSvc,this.filterValueSvc=e.filterValueSvc}postConstruct(){this.setEnabled(this.gos.get("enableAdvancedFilter"),!0),this.ctrl=this.createManagedBean(new yU(this.enabled)),this.expressionProxy={getValue:(e,t)=>{const i=this.colModel.getColDefCol(e);return i?this.filterValueSvc.getValue(i,t):void 0}},this.addManagedPropertyListener("enableAdvancedFilter",e=>this.setEnabled(!!e.currentValue)),this.addManagedEventListeners({newColumnsLoaded:e=>this.onNewColumnsLoaded(e)}),this.addManagedPropertyListener("includeHiddenColumnsInAdvancedFilter",()=>this.updateValidity())}isEnabled(){return this.enabled}isFilterPresent(){return!!this.expressionFunction}doesFilterPass(e){return this.expressionFunction(this.expressionProxy,e,this.expressionParams)}getModel(){var t;const e=this.createExpressionParser(this.appliedExpression);return e==null||e.parseExpression(),(t=e==null?void 0:e.getModel())!=null?t:null}setModel(e){const t=(s,n)=>{if(s.filterType==="join"){const a=this.advFilterExpSvc.parseJoinOperator(s),r=s.conditions.map(o=>t(o)).filter(o=>(0,m._exists)(o)).join(` ${a} `);return n||s.conditions.length<=1?r:`(${r})`}else return this.advFilterExpSvc.parseColumnFilterModel(s)},i=e?t(e,!0):null;this.setExpressionDisplayValue(i),this.applyExpression(),this.ctrl.refreshComp(),this.ctrl.refreshBuilderComp()}getExpressionDisplayValue(){return this.expression}setExpressionDisplayValue(e){this.expression=e}isCurrentExpressionApplied(){return this.appliedExpression===this.expression}createExpressionParser(e){return e?new xU({expression:e,colModel:this.colModel,dataTypeSvc:this.dataTypeSvc,valueSvc:this.valueSvc,advFilterExpSvc:this.advFilterExpSvc}):null}getDefaultExpression(e){const t=this.advFilterExpSvc.getColumnValue(e)+" ";return{updatedValue:t,updatedPosition:t.length}}isHeaderActive(){return!this.gos.get("advancedFilterParent")}getCtrl(){return this.ctrl}setEnabled(e,t){const i=this.enabled,s=(0,m._isClientSideRowModel)(this.gos)||(0,m._isServerSideRowModel)(this.gos);e&&!s&&(0,m._warn)(123),this.enabled=e&&s,!t&&this.enabled!==i&&this.eventSvc.dispatchEvent({type:"advancedFilterEnabledChanged",enabled:this.enabled})}applyExpression(){const e=this.createExpressionParser(this.expression);e==null||e.parseExpression(),this.applyExpressionFromParser(e)}applyExpressionFromParser(e){if(this.isValid=!e||e.isValid(),!e||!this.isValid){this.expressionFunction=null,this.expressionParams=null,this.appliedExpression=null;return}const{expressionFunction:t,params:i}=this.getFunction(e);this.expressionFunction=t,this.expressionParams=i,this.appliedExpression=this.expression}getFunction(e){if(this.gos.get("suppressAdvancedFilterEval"))return e.getFunctionParsed();{const{functionString:t,params:i}=e.getFunctionString();return{expressionFunction:new Function("expressionProxy","node","params",t),params:i}}}updateValidity(){this.advFilterExpSvc.resetColumnCaches();const e=this.createExpressionParser(this.expression);e==null||e.parseExpression();const i=(!e||e.isValid())!==this.isValid;return this.applyExpressionFromParser(e),this.ctrl.refreshComp(),this.ctrl.refreshBuilderComp(),i}onNewColumnsLoaded(e){var i;if(e.source!=="gridInitializing"||!((i=this.dataTypeSvc)!=null&&i.isPendingInference))return;this.ctrl.setInputDisabled(!0);const[t]=this.addManagedEventListeners({dataTypesInferred:()=>{t==null||t(),this.ctrl.setInputDisabled(!1)}})}},SU={moduleName:"AdvancedFilter",version:Re,beans:[CU,N5],icons:{advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",advancedFilterBuilderSelectOpen:"small-down",richSelectRemove:"cancel"},apiFunctions:{getAdvancedFilterModel:S5,setAdvancedFilterModel:M5,showAdvancedFilterBuilder:D5,hideAdvancedFilterBuilder:w5},dependsOn:[St,m._FilterCoreModule,m._SharedDragAndDropModule,m._PopupModule,m._FilterValueModule],css:[C5]};function MU(e){var t,i;return(i=(t=e.sideBar)==null?void 0:t.comp.isDisplayed())!=null?i:!1}function DU(e,t){var i;(i=e.sideBar)==null||i.comp.setDisplayed(t)}function wU(e,t){var i;(i=e.sideBar)==null||i.comp.setSideBarPosition(t)}function AU(e,t){var i;(i=e.sideBar)==null||i.comp.openToolPanel(t,"api")}function IU(e){var t;(t=e.sideBar)==null||t.comp.close("api")}function TU(e){var t,i;return(i=(t=e.sideBar)==null?void 0:t.comp.openedItem())!=null?i:null}function kU(e){var t;(t=e.sideBar)==null||t.comp.refresh()}function LU(e){var t,i;return(i=(t=e.sideBar)==null?void 0:t.comp.isToolPanelShowing())!=null?i:!1}function PU(e,t){var s;const i=(s=e.sideBar)==null?void 0:s.comp.getToolPanelInstance(t);return(0,m._unwrapUserComp)(i)}function EU(e){var t;return(t=e.sideBar)==null?void 0:t.comp.getDef()}function pS(e,t){if(!t)return null;const i=(0,m._findFocusableElements)(e),s=i.indexOf(t);if(s===-1)return null;let n=-1;for(let a=s-1;a>=0;a--)if(i[a].classList.contains(m.TabGuardClassNames.TAB_GUARD_TOP)){n=a;break}return n<=0?null:i[n-1]}function wk(e,t){if(!t)return!1;const i=e.querySelectorAll(`.${m._FOCUS_MANAGED_CLASS}`);if(!i.length)return!1;for(let s=0;s<i.length;s++)if(i[s].contains(t))return!0;return!1}var RU='.ag-tool-panel-wrapper{display:flex;overflow:hidden auto;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-side-bar-panel-width)}.ag-select-agg-func-item{align-items:center;display:flex;flex:1 1 auto;flex-flow:row nowrap;height:100%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:nowrap;>*{flex:none}}.ag-tool-panel-horizontal-resize{cursor:ew-resize;height:100%;position:absolute;top:0;width:5px;z-index:1}.ag-side-bar{background-color:var(--ag-side-bar-background-color);display:flex;flex-direction:row-reverse;position:relative}:where(.ag-ltr) :where(.ag-side-bar-left) .ag-tool-panel-horizontal-resize{right:-3px}:where(.ag-rtl) :where(.ag-side-bar-left) .ag-tool-panel-horizontal-resize{left:-3px}:where(.ag-ltr) :where(.ag-side-bar-right) .ag-tool-panel-horizontal-resize{left:-3px}:where(.ag-rtl) :where(.ag-side-bar-right) .ag-tool-panel-horizontal-resize{right:-3px}.ag-side-bar-left{flex-direction:row;order:-1}.ag-side-buttons{background-color:var(--ag-side-button-bar-background-color);padding-top:var(--ag-side-button-bar-top-padding);position:relative}.ag-side-button{background-color:var(--ag-side-button-background-color);border-bottom:var(--ag-side-button-border);border-top:var(--ag-side-button-border);color:var(--ag-side-button-text-color);margin-top:-1px;position:relative;&:before{background-color:transparent;bottom:0;content:"";display:block;position:absolute;top:0;transition:background-color var(--ag-side-button-selected-underline-transition-duration);width:var(--ag-side-button-selected-underline-width)}&:hover{background-color:var(--ag-side-button-hover-background-color);color:var(--ag-side-button-hover-text-color)}&.ag-selected{background-color:var(--ag-side-button-selected-background-color);border-bottom:var(--ag-side-button-selected-border);border-top:var(--ag-side-button-selected-border);color:var(--ag-side-button-selected-text-color);&:before{background-color:var(--ag-side-button-selected-underline-color)}}}:where(.ag-ltr) .ag-side-button{&:before{left:0}}:where(.ag-rtl) .ag-side-button{&:before{right:0}}.ag-side-button-button{align-items:center;display:flex;flex-direction:column;gap:var(--ag-spacing);position:relative;white-space:nowrap;width:100%;&:focus{box-shadow:none}}:where(.ag-ltr) .ag-side-button-button{padding:var(--ag-side-button-vertical-padding) var(--ag-side-button-right-padding) var(--ag-side-button-vertical-padding) var(--ag-side-button-left-padding)}:where(.ag-rtl) .ag-side-button-button{padding:var(--ag-side-button-vertical-padding) var(--ag-side-button-left-padding) var(--ag-side-button-vertical-padding) var(--ag-side-button-right-padding)}.ag-side-button-button:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-side-button-label{writing-mode:vertical-lr}@media (resolution <= 1.5x){.ag-side-button-label{font-family:"Segoe UI",var(--ag-font-family)}:where(.ag-ltr) .ag-side-button-label{transform:rotate(.05deg)}:where(.ag-rtl) .ag-side-button-label{transform:rotate(-.05deg)}}:where(.ag-ltr) .ag-side-bar-left,:where(.ag-rtl) .ag-side-bar-right{border-right:var(--ag-side-panel-border);:where(.ag-tool-panel-wrapper){border-left:var(--ag-side-panel-border)}}:where(.ag-ltr) .ag-side-bar-right,:where(.ag-rtl) .ag-side-bar-left{border-left:var(--ag-side-panel-border);:where(.ag-tool-panel-wrapper){border-right:var(--ag-side-panel-border)}}',NU={tag:"div",cls:"ag-side-button",role:"presentation",children:[{tag:"button",ref:"eToggleButton",cls:"ag-button ag-side-button-button",role:"tab",attrs:{type:"button",tabindex:"-1","aria-expanded":"false"},children:[{tag:"div",ref:"eIconWrapper",cls:"ag-side-button-icon-wrapper",attrs:{"aria-hidden":"true"}},{tag:"span",ref:"eLabel",cls:"ag-side-button-label"}]}]},OU=class extends m.Component{constructor(e){super(),this.toolPanelDef=e,this.eToggleButton=m.RefPlaceholder,this.eIconWrapper=m.RefPlaceholder,this.eLabel=m.RefPlaceholder}getToolPanelId(){return this.toolPanelDef.id}postConstruct(){this.setTemplate(NU,[]),this.setLabel(),this.setIcon(),this.addManagedElementListeners(this.eToggleButton,{click:this.onButtonPressed.bind(this)}),this.eToggleButton.setAttribute("id",`ag-${this.getCompId()}-button`)}setLabel(){const e=this.toolPanelDef,t=this.getLocaleTextFunc()(e.labelKey,e.labelDefault);this.eLabel.textContent=t}setIcon(){this.eIconWrapper.insertAdjacentElement("afterbegin",(0,m._createIconNoSpan)(this.toolPanelDef.iconKey,this.beans))}onButtonPressed(){this.dispatchLocalEvent({type:"toggleButtonClicked"})}setSelected(e){this.toggleCss("ag-selected",e),(0,m._setAriaExpanded)(this.eToggleButton,e)}},FU={tag:"div",cls:"ag-side-buttons",role:"tablist"},BU=class extends m.Component{constructor(){super(FU),this.buttonComps=[]}postConstruct(){this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){if(!(e.key!==m.KeyCode.TAB||!e.shiftKey)){if((0,m._focusNextGridCoreContainer)(this.beans,!0)){e.preventDefault();return}(0,m._stopPropagationForAgGrid)(e)}}setActiveButton(e){this.buttonComps.forEach(t=>{t.setSelected(e===t.getToolPanelId())})}addButtonComp(e){const t=this.createBean(new OU(e));return this.buttonComps.push(t),this.appendChild(t),t.addEventListener("toggleButtonClicked",()=>{this.dispatchLocalEvent({type:"sideBarButtonClicked",toolPanelId:e.id})}),t}clearButtons(){this.buttonComps=this.destroyBeans(this.buttonComps),(0,m._clearElement)(this.getGui()),super.destroy()}destroy(){this.clearButtons(),super.destroy()}},_U={selector:"AG-SIDE-BAR-BUTTONS",component:BU},Ak={id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columnsToolPanel",toolPanel:"agColumnsToolPanel"},Ik={id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filtersToolPanel",toolPanel:"agFiltersToolPanel"},zm={columns:Ak,filters:Ik};function gS(e){if(!e)return;if(e===!0)return{toolPanels:[Ak,Ik],defaultToolPanel:"columns"};if(typeof e=="string")return gS([e]);if(Array.isArray(e)){const i=[];return e.forEach(s=>{const n=zm[s];if(!n){(0,m._warn)(215,{key:s,defaultByKey:zm});return}i.push(n)}),i.length===0?void 0:{toolPanels:i,defaultToolPanel:i[0].id}}return{toolPanels:GU(e.toolPanels),defaultToolPanel:e.defaultToolPanel,hiddenByDefault:e.hiddenByDefault,position:e.position}}function GU(e){const t=[];return e&&e.forEach(i=>{let s=null;if(typeof i=="string"){const n=zm[i];if(!n){(0,m._warn)(215,{key:i,defaultByKey:zm});return}s=n}else s=i;t.push(s)}),t}var zU=class extends m.Component{constructor(){super({tag:"div",cls:"ag-tool-panel-horizontal-resize"}),this.minWidth=100,this.maxWidth=null}postConstruct(){const e=this.beans.horizontalResizeSvc.addResizeBar({eResizeBar:this.getGui(),dragStartPixels:1,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this),onResizeEnd:this.onResizeEnd.bind(this)});this.addDestroyFunc(e),this.inverted=this.gos.get("enableRtl")}dispatchResizeEvent(e,t,i){this.eventSvc.dispatchEvent({type:"toolPanelSizeChanged",width:i,started:e,ended:t})}onResizeStart(){this.startingWidth=this.elementToResize.offsetWidth,this.dispatchResizeEvent(!0,!1,this.startingWidth)}onResizeEnd(e){return this.onResizing(e,!0)}onResizing(e,t=!1){const i=this.inverted?-1:1;let s=Math.max(this.minWidth,Math.floor(this.startingWidth-e*i));this.maxWidth!=null&&(s=Math.min(this.maxWidth,s)),this.elementToResize.style.width=`${s}px`,this.dispatchResizeEvent(!1,t,s)}};function VU(e,t,i){return e.getCompDetails(t,jU,void 0,i,!0)}var jU={name:"toolPanel",optionalMethods:["refresh","getState"]},HU={tag:"div",cls:"ag-tool-panel-wrapper",role:"tabpanel"},WU=class extends m.Component{constructor(){super(HU)}postConstruct(){const e=this.getGui(),t=this.resizeBar=this.createManagedBean(new zU);e.setAttribute("id",`ag-${this.getCompId()}`),t.elementToResize=e,this.appendChild(t)}getToolPanelId(){return this.toolPanelId}setToolPanelDef(e,t){const{id:i,minWidth:s,maxWidth:n,width:a}=e;this.toolPanelId=i,this.width=a;const r=VU(this.beans.userCompFactory,e,t);if(r==null)return!1;const o=r.newAgStackInstance();this.params=r.params,o.then(this.setToolPanelComponent.bind(this));const l=this.resizeBar;return s!=null&&(l.minWidth=s),n!=null&&(l.maxWidth=n),!0}setToolPanelComponent(e){this.toolPanelCompInstance=e,this.appendChild(e.getGui()),this.addDestroyFunc(()=>{this.destroyBean(e)});const t=this.width;t&&(this.getGui().style.width=`${t}px`)}getToolPanelInstance(){return this.toolPanelCompInstance}setResizerSizerSide(e){const t=this.gos.get("enableRtl"),i=e==="left",s=t?i:!i;this.resizeBar.inverted=s}refresh(){var e;(e=this.toolPanelCompInstance)==null||e.refresh(this.params)}},UU={tag:"div",cls:"ag-side-bar ag-unselectable",children:[{tag:"ag-side-bar-buttons",ref:"sideBarButtons"}]},KU=class extends m.Component{constructor(){super(UU,[_U]),this.sideBarButtons=m.RefPlaceholder,this.toolPanelWrappers=[],this.registerCSS(RU)}postConstruct(){var n;this.sideBarButtons.addEventListener("sideBarButtonClicked",this.onToolPanelButtonClicked.bind(this));const{beans:e,gos:t}=this,{sideBar:i}=(n=t.get("initialState"))!=null?n:{};this.setSideBarDef({sideBarDef:gS(t.get("sideBar")),sideBarState:i}),this.addManagedPropertyListener("sideBar",this.onSideBarUpdated.bind(this)),e.sideBar.comp=this;const s=this.getFocusableElement();this.createManagedBean(new m.ManagedFocusFeature(s,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),(0,m._addFocusableContainerListener)(e,this,s)}onTabKeyDown(e){if(e.defaultPrevented)return;const{beans:t,sideBarButtons:i}=this,s=this.getGui(),n=i.getGui(),a=(0,m._getActiveDomElement)(t),r=s.querySelector(".ag-tool-panel-wrapper:not(.ag-hidden)"),o=e.target,l=e.shiftKey;if(!r)return(0,m._focusNextGridCoreContainer)(t,l)?(e.preventDefault(),!0):(0,m._focusNextGridCoreContainer)(t,l,!0);if(n.contains(a)){(0,m._focusInto)(r,l)&&e.preventDefault();return}if(!l)return;let c=null;r.contains(a)?c=(0,m._findNextFocusableElement)(t,r,void 0,!0):wk(r,o)&&l&&(c=pS(r,o)),c||(c=n.querySelector(".ag-selected button")),c&&c!==e.target&&(e.preventDefault(),c.focus())}handleKeyDown(e){const t=(0,m._getActiveDomElement)(this.beans),i=this.sideBarButtons;if(!i.getGui().contains(t))return;const s=i.getGui(),n=Array.prototype.slice.call(s.querySelectorAll(".ag-side-button")),a=n.findIndex(l=>l.contains(t));let r=null;switch(e.key){case m.KeyCode.LEFT:case m.KeyCode.UP:r=Math.max(0,a-1);break;case m.KeyCode.RIGHT:case m.KeyCode.DOWN:r=Math.min(a+1,n.length-1);break}if(r===null)return;const o=n[r].querySelector("button");o&&(o.focus(),e.preventDefault())}onToolPanelButtonClicked(e){const t=e.toolPanelId;this.openedItem()===t?this.openToolPanel(void 0,"sideBarButtonClicked"):this.openToolPanel(t,"sideBarButtonClicked")}clearDownUi(){this.sideBarButtons.clearButtons(),this.destroyToolPanelWrappers()}setSideBarDef({sideBarDef:e,sideBarState:t,existingToolPanelWrappers:i}){if(this.setDisplayed(!1),this.sideBar=e,e&&e.toolPanels){const s=e.toolPanels;if(this.createToolPanelsAndSideButtons(s,t,i),!this.toolPanelWrappers.length)return;const n=t?t.visible:!e.hiddenByDefault;if(this.setDisplayed(n),this.setSideBarPosition(t?t.position:e.position),n)if(t){const{openToolPanel:a}=t;a&&this.openToolPanel(a,"sideBarInitializing")}else this.openToolPanel(e.defaultToolPanel,"sideBarInitializing")}}getDef(){return this.sideBar}setSideBarPosition(e){e||(e="right"),this.position=e;const t=e==="left",i=t?"right":"left";return this.toggleCss("ag-side-bar-left",t),this.toggleCss("ag-side-bar-right",!t),this.toolPanelWrappers.forEach(s=>{s.setResizerSizerSide(i)}),this.dispatchSideBarUpdated(),this}setDisplayed(e,t){super.setDisplayed(e,t),this.dispatchSideBarUpdated()}getState(){const e={};return this.toolPanelWrappers.forEach(t=>{var i,s;e[t.getToolPanelId()]=(s=(i=t.getToolPanelInstance())==null?void 0:i.getState)==null?void 0:s.call(i)}),{visible:this.isDisplayed(),position:this.position,openToolPanel:this.openedItem(),toolPanels:e}}createToolPanelsAndSideButtons(e,t,i){var s;for(const n of e)this.createToolPanelAndSideButton(n,(s=t==null?void 0:t.toolPanels)==null?void 0:s[n.id],i==null?void 0:i[n.id])}validateDef(e){var t;return e.id==null?((0,m._warn)(212),!1):e.toolPanel==="agFiltersToolPanel"&&(t=this.beans.filterManager)!=null&&t.isAdvFilterEnabled()?((0,m._warn)(213),!1):!0}createToolPanelAndSideButton(e,t,i){if(!this.validateDef(e))return;let s;if(i)s=i;else if(s=this.createBean(new WU),!s.setToolPanelDef(e,(0,m._addGridCommonParams)(this.gos,{initialState:t,onStateUpdated:()=>this.dispatchSideBarUpdated()})))return;s.setDisplayed(!1);const n=s.getGui();this.appendChild(n),this.toolPanelWrappers.push(s);const a=this.sideBarButtons.addButtonComp(e);(0,m._setAriaControls)(a.eToggleButton,n)}refresh(){this.toolPanelWrappers.forEach(e=>e.refresh())}openToolPanel(e,t="api"){const i=this.openedItem();if(i===e)return;this.toolPanelWrappers.forEach(a=>{const r=e===a.getToolPanelId();a.setDisplayed(r)});const s=this.openedItem();i!==s&&(this.sideBarButtons.setActiveButton(e),this.raiseToolPanelVisibleEvent(e,i!=null?i:void 0,t))}getToolPanelInstance(e){const t=this.toolPanelWrappers.filter(i=>i.getToolPanelId()===e)[0];if(!t){(0,m._warn)(214,{key:e});return}return t.getToolPanelInstance()}raiseToolPanelVisibleEvent(e,t,i){const s=!!e&&!!t,n=this.eventSvc;t&&n.dispatchEvent({type:"toolPanelVisibleChanged",source:i,key:t,visible:!1,switchingToolPanel:s}),e&&n.dispatchEvent({type:"toolPanelVisibleChanged",source:i,key:e,visible:!0,switchingToolPanel:s})}close(e="api"){this.openToolPanel(void 0,e)}isToolPanelShowing(){return!!this.openedItem()}openedItem(){let e=null;return this.toolPanelWrappers.forEach(t=>{t.isDisplayed()&&(e=t.getToolPanelId())}),e}onSideBarUpdated(){var i;const e=gS(this.gos.get("sideBar")),t={};e&&this.sideBar&&((i=e.toolPanels)==null||i.forEach(s=>{var c,h,d;const{id:n}=s;if(!n)return;const a=(c=this.sideBar.toolPanels)==null?void 0:c.find(u=>u.id===n);if(!a||s.toolPanel!==a.toolPanel)return;const r=this.toolPanelWrappers.find(u=>u.getToolPanelId()===n);if(!r)return;const o=(0,m._addGridCommonParams)(this.gos,E(b({},(h=s.toolPanelParams)!=null?h:{}),{onStateUpdated:()=>this.dispatchSideBarUpdated()}));((d=r.getToolPanelInstance())==null?void 0:d.refresh(o))===!0&&(this.toolPanelWrappers=this.toolPanelWrappers.filter(u=>u!==r),(0,m._removeFromParent)(r.getGui()),t[n]=r)})),this.clearDownUi(),this.setSideBarDef({sideBarDef:e,existingToolPanelWrappers:t})}dispatchSideBarUpdated(){this.eventSvc.dispatchEvent({type:"sideBarUpdated"})}destroyToolPanelWrappers(){this.toolPanelWrappers.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)}),this.toolPanelWrappers.length=0}destroy(){this.destroyToolPanelWrappers(),super.destroy()}},$U={selector:"AG-SIDE-BAR",component:KU},YU=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="sideBar"}getSelector(){return $U}},fS={moduleName:"SideBar",version:Re,beans:[YU],apiFunctions:{isSideBarVisible:MU,setSideBarVisible:DU,setSideBarPosition:wU,openToolPanel:AU,closeToolPanel:IU,getOpenedToolPanel:TU,refreshToolPanel:kU,isToolPanelShowing:LU,getToolPanelInstance:PU,getSideBar:EU},dependsOn:[St,m._HorizontalResizeModule]},XU={tag:"div"},Tk=class extends m.Component{constructor(){super(XU)}init(e){var t;this.params=e,this.cssClassPrefix=(t=this.params.cssClassPrefix)!=null?t:"ag-menu-option",this.addAriaAttributes(),this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addAriaAttributes(){const{checked:e,subMenu:t}=this.params,i=this.getGui();e&&(0,m._setAriaChecked)(i,e),t&&(0,m._setAriaExpanded)(i,!1)}addIcon(){if(this.params.isCompact)return;const e=(0,m._createElement)({tag:"span",ref:"eIcon",cls:`${this.getClassName("part")} ${this.getClassName("icon")}`,role:"presentation"}),{checked:t,icon:i}=this.params;t?e.appendChild((0,m._createIconNoSpan)("check",this.beans)):i&&((0,m._isNodeOrElement)(i)?e.appendChild(i):typeof i=="string"?e.innerHTML=i:(0,m._warn)(227)),this.getGui().appendChild(e)}addName(){const e=(0,m._createElement)({tag:"span",ref:"eName",cls:`${this.getClassName("part")} ${this.getClassName("text")}`,children:this.params.name||""});this.getGui().appendChild(e)}addShortcut(){if(this.params.isCompact)return;const e=(0,m._createElement)({tag:"span",ref:"eShortcut",cls:`${this.getClassName("part")} ${this.getClassName("shortcut")}`,children:this.params.shortcut||""});this.getGui().appendChild(e)}addSubMenu(){const e=(0,m._createElement)({tag:"span",ref:"ePopupPointer",cls:`${this.getClassName("part")} ${this.getClassName("popup-pointer")}`}),t=this.getGui();if(this.params.subMenu){const i=this.gos.get("enableRtl")?"subMenuOpenRtl":"subMenuOpen";e.appendChild((0,m._createIconNoSpan)(i,this.beans))}t.appendChild(e)}getClassName(e){return`${this.cssClassPrefix}-${e}`}},ZU='.ag-menu-list{cursor:default;display:table;padding:var(--ag-spacing) 0;width:100%}.ag-menu-option,.ag-menu-separator{display:table-row}.ag-menu-option-part,.ag-menu-separator-part{display:table-cell;vertical-align:middle}.ag-menu-option{cursor:pointer;font-weight:500}:where(.ag-ltr) :where(.ag-menu-option-popup-pointer) .ag-icon{text-align:right}:where(.ag-rtl) :where(.ag-menu-option-popup-pointer) .ag-icon{text-align:left}.ag-menu-option-text{white-space:nowrap}.ag-menu-option-custom{display:contents}.ag-compact-menu-option{display:flex;flex-wrap:nowrap;width:100%}.ag-compact-menu-option-text{flex:1 1 auto;white-space:nowrap}.ag-menu-separator{height:calc(var(--ag-spacing)*2 + 1px)}.ag-menu-separator-part:after{border-top:1px solid var(--ag-menu-separator-color);content:"";display:block}.ag-compact-menu-option-active,.ag-menu-option-active{background-color:var(--ag-row-hover-color)}.ag-compact-menu-option-part,.ag-menu-option-part{line-height:var(--ag-icon-size);padding:calc(var(--ag-spacing) + 2px) 0}.ag-compact-menu-option-disabled,.ag-menu-option-disabled{cursor:not-allowed;opacity:.5}.ag-compact-menu-option-icon,.ag-menu-option-icon{width:var(--ag-icon-size)}:where(.ag-ltr) .ag-compact-menu-option-icon,:where(.ag-ltr) .ag-menu-option-icon{padding-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-compact-menu-option-icon,:where(.ag-rtl) .ag-menu-option-icon{padding-right:calc(var(--ag-spacing)*2)}.ag-compact-menu-option-text,.ag-menu-option-text{padding-left:calc(var(--ag-spacing)*2);padding-right:calc(var(--ag-spacing)*2)}:where(.ag-ltr) .ag-compact-menu-option-shortcut,:where(.ag-ltr) .ag-menu-option-shortcut{padding-right:var(--ag-spacing)}:where(.ag-rtl) .ag-compact-menu-option-shortcut,:where(.ag-rtl) .ag-menu-option-shortcut{padding-left:var(--ag-spacing)}:where(.ag-ltr) .ag-compact-menu-option-popup-pointer,:where(.ag-ltr) .ag-menu-option-popup-pointer{padding-right:var(--ag-spacing)}:where(.ag-rtl) .ag-compact-menu-option-popup-pointer,:where(.ag-rtl) .ag-menu-option-popup-pointer{padding-left:var(--ag-spacing)}.ag-menu-column-select-wrapper{height:265px;overflow:auto;:where(.ag-column-select){height:100%}}.ag-menu:where(.ag-tabs){min-width:290px}.ag-context-menu-loading-icon{pointer-events:none;position:absolute}',Vm={moduleName:"MenuItem",version:Re,userComponents:{agMenuItem:Tk},icons:{check:"tick",subMenuOpen:"small-right",subMenuOpenRtl:"small-left"},css:[ZU]},qU=".ag-column-select{display:flex;flex:3 1 0px;flex-direction:column;overflow:hidden;position:relative}.ag-column-select-header{align-items:center;display:flex;flex:none;gap:var(--ag-widget-horizontal-spacing);height:var(--ag-header-height);padding-left:var(--ag-widget-container-horizontal-padding);padding-right:var(--ag-widget-container-horizontal-padding);position:relative}.ag-column-select-column,.ag-column-select-column-group{align-items:center;display:flex;gap:var(--ag-widget-horizontal-spacing);height:100%;position:relative;&:where(:not(:last-child)){margin-bottom:var(--ag-widget-vertical-spacing)}}:where(.ag-ltr) .ag-column-select-column,:where(.ag-ltr) .ag-column-select-column-group{padding-left:calc(var(--ag-indentation-level)*var(--ag-column-select-indent-size))}:where(.ag-rtl) .ag-column-select-column,:where(.ag-rtl) .ag-column-select-column-group{padding-right:calc(var(--ag-indentation-level)*var(--ag-column-select-indent-size))}.ag-column-select-header-icon{border-radius:var(--ag-border-radius);cursor:pointer;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);&:focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-column-select-header-filter-wrapper{flex:1 1 auto}.ag-column-select-header-filter{width:100%}.ag-column-select-list{flex:1 1 0px;overflow:hidden}:where(.ag-ltr) .ag-column-select-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-spacing)*1.5)}:where(.ag-rtl) .ag-column-select-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-spacing)*1.5)}.ag-column-select-column-group-readonly,.ag-column-select-column-readonly{opacity:.5;pointer-events:none}.ag-column-select-virtual-list-viewport{padding:calc(var(--ag-widget-container-vertical-padding)*.5) 0}.ag-column-select-virtual-list-item{padding:0 var(--ag-widget-container-horizontal-padding)}.ag-column-select-column-label{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-column-select-checkbox{display:flex}",QU=300,JU={tag:"div",cls:"ag-column-select-header",role:"presentation",children:[{tag:"div",ref:"eExpand",cls:"ag-column-select-header-icon"},{tag:"ag-checkbox",ref:"eSelect",cls:"ag-column-select-header-checkbox"},{tag:"ag-input-text-field",ref:"eFilterTextField",cls:"ag-column-select-header-filter-wrapper"}]},eK=class extends m.Component{constructor(){super(JU,[m.AgCheckboxSelector,m.AgInputTextFieldSelector]),this.eExpand=m.RefPlaceholder,this.eSelect=m.RefPlaceholder,this.eFilterTextField=m.RefPlaceholder}postConstruct(){this.createExpandIcons(),this.addManagedListeners(this.eExpand,{click:this.onExpandClicked.bind(this),keydown:t=>{t.key===m.KeyCode.SPACE&&(t.preventDefault(),this.onExpandClicked())}}),this.addManagedElementListeners(this.eSelect.getInputElement(),{click:this.onSelectClicked.bind(this)}),this.addManagedPropertyListener("functionsReadOnly",()=>this.onFunctionsReadOnlyPropChanged()),this.eFilterTextField.setAutoComplete(!1).onValueChange(()=>this.onFilterTextChanged()),this.addManagedEventListeners({newColumnsLoaded:this.showOrHideOptions.bind(this)});const e=this.getLocaleTextFunc();this.eSelect.setInputAriaLabel(e("ariaColumnSelectAll","Toggle All Columns Visibility")),this.eFilterTextField.setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input")),this.activateTabIndex([this.eExpand])}onFunctionsReadOnlyPropChanged(){const e=this.gos.get("functionsReadOnly");this.eSelect.setReadOnly(e),this.eSelect.toggleCss("ag-column-select-column-readonly",e)}init(e){this.params=e;const t=this.gos.get("functionsReadOnly");this.eSelect.setReadOnly(t),this.eSelect.toggleCss("ag-column-select-column-readonly",t),this.beans.colModel.ready&&this.showOrHideOptions()}createExpandIcons(){const e=this.beans;this.eExpand.appendChild(this.eExpandChecked=(0,m._createIconNoSpan)("columnSelectOpen",e)),this.eExpand.appendChild(this.eExpandUnchecked=(0,m._createIconNoSpan)("columnSelectClosed",e)),this.eExpand.appendChild(this.eExpandIndeterminate=(0,m._createIconNoSpan)("columnSelectIndeterminate",e)),this.setExpandState(0)}showOrHideOptions(){var r;const e=this.params,t=!e.suppressColumnFilter,i=!e.suppressColumnSelectAll,s=!e.suppressColumnExpandAll,n=!!((r=this.beans.colModel.colDefCols)!=null&&r.treeDepth),a=this.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(a("searchOoo","Search...")),(0,m._setDisplayed)(this.eFilterTextField.getGui(),t),(0,m._setDisplayed)(this.eSelect.getGui(),i),(0,m._setDisplayed)(this.eExpand,s&&n)}onFilterTextChanged(){this.onFilterTextChangedDebounced||(this.onFilterTextChangedDebounced=(0,m._debounce)(this,()=>{const e=this.eFilterTextField.getValue();this.dispatchLocalEvent({type:"filterChanged",filterText:e})},QU)),this.onFilterTextChangedDebounced()}onSelectClicked(){this.dispatchLocalEvent({type:this.selectState?"unselectAll":"selectAll"})}onExpandClicked(){this.dispatchLocalEvent({type:this.expandState===0?"collapseAll":"expandAll"})}setExpandState(e){this.expandState=e,(0,m._setDisplayed)(this.eExpandChecked,e===0),(0,m._setDisplayed)(this.eExpandUnchecked,e===1),(0,m._setDisplayed)(this.eExpandIndeterminate,e===2)}setSelectionState(e){this.selectState=e,this.eSelect.setValue(this.selectState)}},tK={selector:"AG-PRIMARY-COLS-HEADER",component:eK};function Fd(e){return!!e&&typeof e.children!="undefined"}function bl(e){return Fd(e)?e.groupId:e.colId}function kk(e,t,i){const s=(r,o)=>{const c=r.children.map(bl).includes(bl(o)),h=(0,m._last)(r.children),d=h&&bl(h)!==bl(o);return c&&d};if(!Fd(e))return!0;const n=e,a=i;if(s(n,a)||n.groupId===t&&!n.children.map(bl).includes(bl(a)))return n.children.push(a),!0;for(let r=n.children.length-1;r>=0&&!kk(n.children[r],t,i);r--);return!1}function iK(e){const t=(n,a)=>Fd(n)&&Fd(a)&&bl(n)===bl(a),i=(n,a)=>{if(!Fd(a))return n;const r=n,o=a;return o.children&&o.groupId&&kk(r,o.groupId,o.children[0])||o.children.forEach(l=>i(r,l)),r},s=[];for(let n=1;n<=e.length;n++){const a=e[n-1],r=e[n];t(a,r)?e[n]=i(a,r):s.push(a)}return s}function Lk(e,t){const i=[],s=(a,r)=>{if(Fd(a)){const o=a,l=typeof o.groupId!="undefined"?o.groupId:o.headerName,c=new m.AgProvidedColumnGroup(o,l,!1,r),h=[];return o.children.forEach(d=>{const u=s(d,r+1);u&&h.push(u)}),c.setChildren(h),c}else{const o=a,l=o.colId?o.colId:o.field,c=e.getColDefCol(l);return c||i.push(o),c}},n=[];return t.forEach(a=>{const r=s(a,0);r&&n.push(r)}),i.length>0&&(0,m._warn)(217,{invalidColIds:i}),n}function Pk(e,t){const i=sK(e),s=iK(i);t(s)}function sK(e){const t=(n,a)=>{let r;if((0,m.isProvidedColumnGroup)(n))if(n.isPadding())r=a;else{const l=Object.assign({},n.getColGroupDef());l.groupId=n.getGroupId(),l.children=[a],r=l}else{const l=Object.assign({},n.getColDef());l.colId=n.getColId(),r=l}const o=n.getOriginalParent();return o?t(o,r):r};return e.getCols().filter(n=>{const a=n.getColDef();return n.isPrimary()&&!a.showRowGroup}).map(n=>t(n,n.getColDef()))}var Ek=class{constructor(e,t,i,s=!1,n){this.displayName=e,this.depth=i,this.group=s,this.localEventService=new m.LocalEventService,s?(this.columnGroup=t,this._expanded=n,this.children=[]):this.column=t}get expanded(){return!!this._expanded}set expanded(e){e!==this._expanded&&(this._expanded=e,this.localEventService.dispatchEvent({type:"expandedChanged"}))}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}};function Rk(e,t,i,s){const n=nK(t);Nk(e,n,i,s)}function Nk(e,t,i,s){e.colModel.isPivotMode()?rK(e,t,i,s):aK(e,t,i,s)}function nK(e){const t=[],i=s=>{s.forEach(n=>{n.passesFilter&&(n.group?i(n.children):t.push(n.column))})};return i(e),t}function aK(e,t,i,s){const n=[];t.forEach(a=>{a.getColDef().lockVisible||a.isVisible()!=i&&n.push({colId:a.getId(),hide:!i})}),n.length>0&&(0,m._applyColumnState)(e,{state:n},s)}function rK(e,t,i,s){oK(e,t,i,s)}function oK(e,t,i,s){const n=[],o=i?l=>{var c;if(!l.isAnyFunctionActive())if(l.isAllowValue()){const h=typeof l.getAggFunc()=="string"?l.getAggFunc():(c=e.aggFuncSvc)==null?void 0:c.getDefaultAggFunc(l);n.push({colId:l.getId(),aggFunc:h})}else l.isAllowRowGroup()?n.push({colId:l.getId(),rowGroup:!0}):l.isAllowPivot()&&n.push({colId:l.getId(),pivot:!0})}:l=>{(l.isPivotActive()||l.isRowGroupActive()||l.isValueActive())&&n.push({colId:l.getId(),pivot:!1,rowGroup:!1,aggFunc:null})};t.forEach(o),n.length>0&&(0,m._applyColumnState)(e,{state:n},s)}function Ok(e,t){const{columns:i,visibleState:s,pivotState:n,eventType:a}=t,r=i.map(o=>{const l=o.getColId();if(e.colModel.isPivotMode()){const c=n==null?void 0:n[l];return{colId:l,pivot:c==null?void 0:c.pivot,rowGroup:c==null?void 0:c.rowGroup,aggFunc:c==null?void 0:c.aggFunc}}else return{colId:l,hide:!(s!=null&&s[l])}});(0,m._applyColumnState)(e,{state:r},a)}function Fk(e){return{pivot:e.isPivotActive(),rowGroup:e.isRowGroupActive(),aggFunc:e.isValueActive()?e.getAggFunc():void 0}}function Bk(e,t,i,s){const n=t.getCol(i);e.groupData||(e.groupData={});const a=n.getColId(),r=e.groupData[a];r!==s&&(e.groupData[a]=s,e.dispatchCellChangedEvent(n,s,r))}function mS(e,t,i){var s;e.group!==i&&(e.group&&!i&&(e.expanded=!1),e.group=i,e.updateHasChildren(),(s=t.selectionSvc)==null||s.updateRowSelectable(e),e.dispatchRowEvent("groupChanged"))}function Hp(e,t){const{gos:i,rowGroupColsSvc:s}=t;if(!s||!e)return!1;const n=i.get("groupLockGroupColumns");if(!e.isRowGroupActive()||n===0)return!1;if(n===-1)return!0;const a=s.columns.findIndex(r=>r.getColId()===e.getColId());return n>a}var lK=class extends m.TabGuardComp{constructor(e){super(),this.setTemplateFromElement(e.getGui(),void 0,void 0,!0)}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===m.KeyCode.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const e=this.parentComponent;e.closeSubMenu(),setTimeout(()=>e.getGui().focus(),0)}};function cK(e,t,i){return e.getCompDetails(t,hK,"agMenuItem",i,!0)}var hK={name:"menuItem",optionalMethods:["setActive","select","setExpanded","configureDefaults"]},dK={tag:"div",cls:"ag-menu",role:"presentation"},yS=class extends m.BeanStub{constructor(){super(...arguments),this.ACTIVATION_DELAY=80,this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}wireBeans(e){this.popupSvc=e.popupSvc,this.userCompFactory=e.userCompFactory,this.registry=e.registry}init(e){var o,l,c;const{menuItemDef:t,isAnotherSubMenuOpen:i,level:s,childComponent:n,contextParams:a}=e;this.params=e.menuItemDef,this.level=s,this.isAnotherSubMenuOpen=i,this.childComponent=n,this.contextParams=a,this.cssClassPrefix=(l=(o=this.params.menuItemParams)==null?void 0:o.cssClassPrefix)!=null?l:"ag-menu-option";const r=cK(this.userCompFactory,this.params,(0,m._addGridCommonParams)(this.gos,E(b({},t),{level:s,isAnotherSubMenuOpen:i,openSubMenu:h=>this.openSubMenu(h),closeSubMenu:()=>this.closeSubMenu(),closeMenu:h=>this.closeMenu(h),updateTooltip:(h,d)=>this.refreshTooltip(h,d),onItemActivated:()=>this.onItemActivated()})));return(c=r==null?void 0:r.newAgStackInstance().then(h=>{var u;this.menuItemComp=h;const d=(u=h.configureDefaults)==null?void 0:u.call(h);d&&this.configureDefaults(d===!0?void 0:d)}))!=null?c:m.AgPromise.resolve()}addListeners(e,t){t!=null&&t.suppressClick||this.addManagedElementListeners(e,{click:i=>this.onItemSelected(i)}),t!=null&&t.suppressKeyboardSelect||this.addManagedElementListeners(e,{keydown:i=>{(i.key===m.KeyCode.ENTER||i.key===m.KeyCode.SPACE)&&(i.preventDefault(),this.onItemSelected(i))}}),t!=null&&t.suppressMouseDown||this.addManagedElementListeners(e,{mousedown:i=>{i.stopPropagation(),i.preventDefault()}}),t!=null&&t.suppressMouseOver||this.addManagedElementListeners(e,{mouseenter:()=>this.onMouseEnter(),mouseleave:()=>this.onMouseLeave()})}isDisabled(){return!!this.params.disabled}openSubMenu(e=!1,t){var c,h;if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const i=(0,m._createElement)(dK);this.eSubMenuGui=i;let s,n=()=>{this.subMenuIsOpening=!1};if(this.childComponent){const d=this.createBean(new lK(this.childComponent));d.setParentComponent(this);const u=d.getGui(),p="mouseenter",g=()=>this.cancelDeactivate();u.addEventListener(p,g),s=()=>{u.removeEventListener(p,g),this.destroyBean(d)},i.appendChild(u),this.childComponent.afterGuiAttached&&(n=()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1})}else if(this.params.subMenu){const d=this.createBean(new Wp(this.level+1,this.contextParams));d.setParentComponent(this),d.addMenuItems(this.params.subMenu),i.appendChild(d.getGui()),this.addManagedListeners(d,{closeMenu:u=>this.dispatchLocalEvent(u)}),d.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),s=()=>this.destroyBean(d),e&&(n=()=>{d.activateFirstItem(),this.subMenuIsOpening=!1})}const{popupSvc:a}=this,r=()=>{const d=this.eGui,{column:u,node:p}=this.contextParams;a==null||a.positionPopupForMenu({eventSource:d,ePopup:i,event:t instanceof MouseEvent?t:void 0,column:u,node:p})},o=this.getLocaleTextFunc(),l=a==null?void 0:a.addPopup({modal:!0,eChild:i,positionCallback:r,anchorToElement:this.eGui,ariaLabel:o("ariaLabelSubMenu","SubMenu"),afterGuiAttached:n});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{var d,u;l&&l.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),s(),(u=(d=this.menuItemComp).setExpanded)==null||u.call(d,!1),this.eSubMenuGui=void 0},(h=(c=this.menuItemComp).setExpanded)==null||h.call(c,!0)}setAriaExpanded(e){this.suppressAria||(0,m._setAriaExpanded)(this.eGui,e)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(e,t){var i,s;this.cancelActivate(),!(this.params.disabled&&!t)&&(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),(s=(i=this.menuItemComp).setActive)==null||s.call(i,!0),this.suppressFocus||(0,m._preserveRangesWhile)(this.beans,()=>this.eGui.focus({preventScroll:!t})),e&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){var e,t;this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),(t=(e=this.menuItemComp).setActive)==null||t.call(e,!1),this.isActive=!1,this.subMenuIsOpen&&this.closeSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(e){this.parentComponent=e}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(e){var t,i;(i=(t=this.menuItemComp).select)==null||i.call(t),this.params.action?this.beans.frameworkOverrides.wrapOutgoing(()=>this.params.action((0,m._addGridCommonParams)(this.gos,b({},this.contextParams)))):this.openSubMenu(e&&e.type==="keydown",e),!(this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect)&&this.closeMenu(e)}closeMenu(e){const t={type:"closeMenu"};e&&(e instanceof MouseEvent?t.mouseEvent=e:t.keyboardEvent=e),this.dispatchLocalEvent(t)}onItemActivated(){const e={type:"menuItemActivated",menuItem:this};this.dispatchLocalEvent(e)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),this.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),this.ACTIVATION_DELAY):this.deactivate()}configureDefaults(e){var l,c,h,d;if(!this.menuItemComp){setTimeout(()=>this.configureDefaults(e));return}let t=this.menuItemComp.getGui();const{suppressRootStyles:i,suppressTooltip:s,suppressAria:n,suppressTabIndex:a,suppressFocus:r}=e||{},o=(c=(l=this.menuItemComp).getRootElement)==null?void 0:c.call(l);o&&(i||t.classList.add("ag-menu-option-custom"),t=o),this.eGui=t,this.suppressRootStyles=!!i,this.suppressRootStyles||(t.classList.add(this.cssClassPrefix),(h=this.params.cssClasses)==null||h.forEach(u=>t.classList.add(u)),this.params.disabled&&t.classList.add(`${this.cssClassPrefix}-disabled`)),s||this.refreshTooltip(this.params.tooltip),this.suppressAria=!!n,this.suppressAria||((0,m._setAriaRole)(t,"menuitem"),this.params.subMenu&&(0,m._setAriaHasPopup)(t,(d=this.params.subMenuRole)!=null?d:"menu"),this.params.disabled&&(0,m._setAriaDisabled)(t,!0)),a||t.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(t,e),this.suppressFocus=!!r}refreshTooltip(e,t){if(this.tooltip=e,this.tooltipFeature=this.destroyBean(this.tooltipFeature),!e||!this.menuItemComp)return;const i=this.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip:t});i&&(this.tooltipFeature=this.createBean(i))}destroy(){var e,t;this.tooltipFeature=this.destroyBean(this.tooltipFeature),(t=(e=this.menuItemComp)==null?void 0:e.destroy)==null||t.call(e),super.destroy()}},Wp=class extends m.TabGuardComp{constructor(e=0,t){super({tag:"div",cls:"ag-menu-list",role:"menu"}),this.level=e,this.menuItems=[],this.params=t!=null?t:{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>(0,m._preserveRangesWhile)(this.beans,()=>this.handleKeyDown(e)),onFocusIn:e=>this.handleFocusIn(e),onFocusOut:e=>this.handleFocusOut(e)})}onTabKeyDown(e){var s;const t=this.getParentComponent();((s=t==null?void 0:t.getGui())==null?void 0:s.classList.contains("ag-focus-managed"))||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(e){switch(e.key){case m.KeyCode.UP:case m.KeyCode.RIGHT:case m.KeyCode.DOWN:case m.KeyCode.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case m.KeyCode.ESCAPE:this.closeIfIsChild()&&(0,m._stopPropagationForAgGrid)(e);break}}handleFocusIn(e){var i,s;const t=e.relatedTarget;!this.tabGuardFeature.getTabGuardCtrl().isTabGuard(t)&&(this.getGui().contains(t)||(s=(i=this.activeMenuItem)==null?void 0:i.getSubMenuGui())!=null&&s.contains(t))||(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(e){var i;const t=e.relatedTarget;!this.activeMenuItem||this.getGui().contains(t)||(i=this.activeMenuItem.getSubMenuGui())!=null&&i.contains(t)||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(e){e!=null&&m.AgPromise.all(e.map(t=>t==="separator"?m.AgPromise.resolve({eGui:this.createSeparator()}):typeof t=="string"?((0,m._warn)(228,{menuItemOrString:t}),m.AgPromise.resolve({eGui:null})):this.addItem(t))).then(t=>{(t!=null?t:[]).forEach(i=>{i!=null&&i.eGui&&(this.appendChild(i.eGui),i.comp&&this.menuItems.push(i.comp))})})}addItem(e){const t=this.createManagedBean(new yS);return t.init({menuItemDef:e,isAnotherSubMenuOpen:()=>this.menuItems.some(i=>i.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(t.setParentComponent(this),this.addManagedListeners(t,{closeMenu:i=>{this.dispatchLocalEvent(i)},menuItemActivated:i=>{this.activeMenuItem&&this.activeMenuItem!==i.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=i.menuItem}}),{comp:t,eGui:t.getGui()}))}activateFirstItem(){const e=this.menuItems.filter(t=>!t.isDisabled())[0];e&&e.activate()}createSeparator(){const e={tag:"div",cls:"ag-menu-separator-part"};return(0,m._createElement)({tag:"div",cls:"ag-menu-separator",attrs:{"aria-hidden":"true"},children:[e,e,e,e]})}handleNavKey(e){switch(e){case m.KeyCode.UP:case m.KeyCode.DOWN:{const i=this.findNextItem(e===m.KeyCode.UP);i&&i!==this.activeMenuItem&&i.activate(!1,!0);return}}const t=this.gos.get("enableRtl")?m.KeyCode.RIGHT:m.KeyCode.LEFT;e===t?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const t=this.getParentComponent();return t&&t instanceof yS?(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus(),!0):!1}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(e){const t=[...this.menuItems];if(!t.length)return;if(!this.activeMenuItem)return e?(0,m._last)(t):t[0];e&&t.reverse();let i,s=!1;for(const n of t){if(!s){n===this.activeMenuItem&&(s=!0);continue}i=n;break}return s&&!i?t[0]:i||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}},_k=class extends m.Component{constructor(e,t,i){super({tag:"div",cls:"ag-menu"}),this.column=e,this.mouseEvent=t,this.parentEl=i,this.displayName=null}postConstruct(){const{column:e,beans:{colNames:t}}=this;this.initializeProperties(e);let i;if((0,m.isColumn)(e)?i=t.getDisplayNameForColumn(e,"columnToolPanel"):i=t.getDisplayNameForProvidedColumnGroup(null,e,"columnToolPanel"),this.displayName=i,this.buildMenuItemMap(),this.isActive()){this.mouseEvent.preventDefault();const s=this.getMappedMenuItems();if(s.length===0)return;this.displayContextMenu(s)}}initializeProperties(e){let t;(0,m.isProvidedColumnGroup)(e)?t=e.getLeafColumns():t=[e],this.columns=t;const i=this.beans.colModel.isPivotMode();this.allowScrollIntoView=!i&&t.some(this.isColumnValidForScrollIntoView),this.allowGrouping=t.some(s=>s.isPrimary()&&s.isAllowRowGroup()),this.allowValues=t.some(s=>s.isPrimary()&&s.isAllowValue()),this.allowPivoting=i&&t.some(s=>s.isPrimary()&&s.isAllowPivot())}buildMenuItemMap(){const e=this.getLocaleTextFunc(),{beans:t,displayName:i}=this,{rowGroupColsSvc:s,valueColsSvc:n,pivotColsSvc:a,colModel:r}=t,o=new Map;this.menuItemMap=o;const l=r.isPivotMode();o.set("scrollIntoView",{allowedFunction:c=>!c.isPinned()&&!l&&this.isColumnValidForScrollIntoView(c),activeFunction:()=>!1,activateLabel:()=>e("scrollColumnIntoView",`Scroll ${i} into View`,[i]),activateFunction:()=>{const c=this.columns.find(this.isColumnValidForScrollIntoView);c&&this.beans.ctrlsSvc.getScrollFeature().ensureColumnVisible(c)},deActivateFunction:()=>{},addIcon:"ensureColumnVisible"}),o.set("rowGroup",{allowedFunction:c=>c.isPrimary()&&c.isAllowRowGroup()&&!Hp(c,t),activeFunction:c=>c.isRowGroupActive(),activateLabel:()=>`${e("groupBy","Group by")} ${i}`,deactivateLabel:()=>`${e("ungroupBy","Un-Group by")} ${i}`,activateFunction:()=>s==null?void 0:s.setColumns(this.addColumnsToList(s.columns),"toolPanelUi"),deActivateFunction:()=>s==null?void 0:s.setColumns(this.removeColumnsFromList(s.columns),"toolPanelUi"),addIcon:"menuAddRowGroup",removeIcon:"menuRemoveRowGroup"}),o.set("value",{allowedFunction:c=>c.isPrimary()&&c.isAllowValue(),activeFunction:c=>c.isValueActive(),activateLabel:()=>e("addToValues",`Add ${i} to values`,[i]),deactivateLabel:()=>e("removeFromValues",`Remove ${i} from values`,[i]),activateFunction:()=>n==null?void 0:n.setColumns(this.addColumnsToList(n.columns),"toolPanelUi"),deActivateFunction:()=>n==null?void 0:n.setColumns(this.removeColumnsFromList(n.columns),"toolPanelUi"),addIcon:"valuePanel",removeIcon:"valuePanel"}),o.set("pivot",{allowedFunction:c=>l&&c.isPrimary()&&c.isAllowPivot(),activeFunction:c=>c.isPivotActive(),activateLabel:()=>e("addToLabels",`Add ${i} to labels`,[i]),deactivateLabel:()=>e("removeFromLabels",`Remove ${i} from labels`,[i]),activateFunction:()=>a==null?void 0:a.setColumns(this.addColumnsToList(a.columns),"toolPanelUi"),deActivateFunction:()=>a==null?void 0:a.setColumns(this.removeColumnsFromList(a.columns),"toolPanelUi"),addIcon:"pivotPanel",removeIcon:"pivotPanel"})}isColumnValidForScrollIntoView(e){var s;if(!e.isVisible())return!1;const i=e.getParent();return i?((s=i.getDisplayedChildren())==null?void 0:s.indexOf(e))!==-1:!0}addColumnsToList(e){return[...e].concat(this.columns.filter(t=>e.indexOf(t)===-1))}removeColumnsFromList(e){return e.filter(t=>this.columns.indexOf(t)===-1)}displayContextMenu(e){const t=this.getGui(),i=this.createBean(new Wp),s=this.getLocaleTextFunc();let n=()=>{};t.appendChild(i.getGui()),i.addMenuItems(e),i.addManagedListeners(i,{closeMenu:()=>{this.parentEl.focus(),n()}});const a=this.beans.popupSvc,r=a.addPopup({modal:!0,eChild:t,closeOnEsc:!0,afterGuiAttached:()=>(0,m._focusInto)(i.getGui()),ariaLabel:s("ariaLabelContextMenu","Context Menu"),closedCallback:o=>{o instanceof KeyboardEvent&&this.parentEl.focus(),this.destroyBean(i)}});r&&(n=r.hideFunc),a.positionPopupUnderMouseEvent({type:"columnContextMenu",mouseEvent:this.mouseEvent,ePopup:t})}isActive(){return this.allowScrollIntoView||this.allowGrouping||this.allowValues||this.allowPivoting}getMappedMenuItems(){const e=[],{menuItemMap:t,columns:i,displayName:s,beans:n}=this;for(const a of t.values()){const r=i.some(l=>a.allowedFunction(l)&&!a.activeFunction(l)),o=i.some(l=>a.allowedFunction(l)&&a.activeFunction(l));r&&e.push({name:a.activateLabel(s),icon:(0,m._createIconNoSpan)(a.addIcon,n,null),action:()=>a.activateFunction()}),o&&a.removeIcon&&a.deactivateLabel&&e.push({name:a.deactivateLabel(s),icon:(0,m._createIconNoSpan)(a.removeIcon,n,null),action:()=>{var l;return(l=a.deActivateFunction)==null?void 0:l.call(a)}})}return e}},uK={tag:"div",cls:"ag-column-select-column-group",children:[{tag:"span",ref:"eColumnGroupIcons",cls:"ag-column-group-icons",children:[{tag:"span",ref:"eGroupClosedIcon",cls:"ag-column-group-closed-icon"},{tag:"span",ref:"eGroupOpenedIcon",cls:"ag-column-group-opened-icon"}]},{tag:"ag-checkbox",ref:"cbSelect",cls:"ag-column-select-checkbox"},{tag:"span",ref:"eLabel",cls:"ag-column-select-column-label"}]},Gk=class extends m.Component{constructor(e,t,i,s){super(),this.modelItem=e,this.allowDragging=t,this.eventType=i,this.focusWrapper=s,this.cbSelect=m.RefPlaceholder,this.eLabel=m.RefPlaceholder,this.eGroupOpenedIcon=m.RefPlaceholder,this.eGroupClosedIcon=m.RefPlaceholder,this.eColumnGroupIcons=m.RefPlaceholder,this.processingColumnStateChange=!1;const{columnGroup:n,depth:a,displayName:r}=e;this.columnGroup=n,this.columnDepth=a,this.displayName=r}postConstruct(){this.setTemplate(uK,[m.AgCheckboxSelector]);const{beans:e,cbSelect:t,eLabel:i,displayName:s,columnDepth:n,modelItem:a,focusWrapper:r,columnGroup:o}=this,{registry:l,gos:c}=e,h=(0,m._createIconNoSpan)("columnDrag",e);this.eDragHandle=h,h.classList.add("ag-drag-handle","ag-column-select-column-group-drag-handle");const d=t.getGui(),u=t.getInputElement();d.insertAdjacentElement("afterend",h),u.setAttribute("tabindex","-1"),i.textContent=s!=null?s:"",this.setupExpandContract(),this.addCss("ag-column-select-indent-"+n),this.getGui().style.setProperty("--ag-indentation-level",String(n)),this.tooltipFeature=this.createOptionalManagedBean(l.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),getLocation:()=>"columnToolPanelColumnGroup",shouldDisplayTooltip:(0,m._getShouldDisplayTooltip)(c,()=>i)})),this.addManagedEventListeners({columnPivotModeChanged:this.onColumnStateChanged.bind(this)}),this.addManagedElementListeners(i,{click:this.onLabelClicked.bind(this)}),this.addManagedListeners(t,{fieldValueChanged:this.onCheckboxChanged.bind(this)}),this.addManagedListeners(a,{expandedChanged:this.onExpandChanged.bind(this)}),this.addManagedListeners(r,{keydown:this.handleKeyDown.bind(this),contextmenu:this.onContextMenu.bind(this)}),this.setOpenClosedIcons(),this.setupDragging(),this.onColumnStateChanged(),this.addVisibilityListenersToAllChildren(),this.refreshAriaExpanded(),this.refreshAriaLabel(),this.setupTooltip(),(0,m._getToolPanelClassesFromColDef)(o.getColGroupDef(),c,null,o).forEach(g=>this.toggleCss(g,!0))}getColumns(){return this.columnGroup.getLeafColumns()}setupTooltip(){const e=this.columnGroup.getColGroupDef();if(!e)return;const t=()=>{var i;return(i=this.tooltipFeature)==null?void 0:i.setTooltipAndRefresh(e.headerTooltip)};t(),this.addManagedEventListeners({newColumnsLoaded:t})}handleKeyDown(e){switch(e.key){case m.KeyCode.LEFT:e.preventDefault(),this.modelItem.expanded=!1;break;case m.KeyCode.RIGHT:e.preventDefault(),this.modelItem.expanded=!0;break;case m.KeyCode.SPACE:e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected());break}}onContextMenu(e){const{columnGroup:t,gos:i}=this;if(i.get("functionsReadOnly"))return;const s=this.createBean(new _k(t,e,this.focusWrapper));this.addDestroyFunc(()=>{s.isAlive()&&this.destroyBean(s)})}addVisibilityListenersToAllChildren(){const e=this.onColumnStateChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{this.addManagedListeners(t,{visibleChanged:e,columnValueChanged:e,columnPivotChanged:e,columnRowGroupChanged:e})})}setupDragging(){if(!this.allowDragging){(0,m._setDisplayed)(this.eDragHandle,!1);return}const e=this.beans,{gos:t,eventSvc:i,dragAndDrop:s}=e;let n=!t.get("suppressDragLeaveHidesColumns");const a={type:m.DragSourceType.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDefaultIconName:()=>n?"hide":"notAllowed",getDragItem:()=>this.createDragItem(),onDragStarted:()=>{n=!t.get("suppressDragLeaveHidesColumns"),i.dispatchEvent({type:"columnPanelItemDragStart",column:this.columnGroup})},onDragStopped:()=>{i.dispatchEvent({type:"columnPanelItemDragEnd"})},onGridEnter:r=>{n&&Ok(e,{columns:this.columnGroup.getLeafColumns(),visibleState:r==null?void 0:r.visibleState,pivotState:r==null?void 0:r.pivotState,eventType:this.eventType})},onGridExit:()=>{n&&this.onChangeCommon(!1)}};s.addDragSource(a,!0),this.addDestroyFunc(()=>s.removeDragSource(a))}createDragItem(){const e=this.columnGroup.getLeafColumns(),t={},i={};return e.forEach(s=>{const n=s.getId();t[n]=s.isVisible(),i[n]=Fk(s)}),{columns:e,visibleState:t,pivotState:i}}setupExpandContract(){const{beans:e,eGroupClosedIcon:t,eGroupOpenedIcon:i,eColumnGroupIcons:s}=this;t.appendChild((0,m._createIcon)("columnSelectClosed",e,null)),i.appendChild((0,m._createIcon)("columnSelectOpen",e,null));const n=this.onExpandOrContractClicked.bind(this);this.addManagedElementListeners(t,{click:n}),this.addManagedElementListeners(i,{click:n});const a=new m.TouchListener(s,!0);this.addManagedListeners(a,{tap:n}),this.addDestroyFunc(a.destroy.bind(a))}onLabelClicked(){const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}getVisibleLeafColumns(){const e=[],t=i=>{i.forEach(s=>{s.passesFilter&&(s.group?t(s.children):e.push(s.column))})};return t(this.modelItem.children),e}onChangeCommon(e){this.refreshAriaLabel(),!this.processingColumnStateChange&&Rk(this.beans,this.modelItem.children,e,this.eventType)}refreshAriaLabel(){const{cbSelect:e,focusWrapper:t,displayName:i}=this,s=this.getLocaleTextFunc(),n=s("ariaColumnGroup","Column Group"),a=e.getValue(),r=a===void 0?s("ariaIndeterminate","indeterminate"):a?s("ariaVisible","visible"):s("ariaHidden","hidden"),o=s("ariaToggleVisibility","Press SPACE to toggle visibility");(0,m._setAriaLabel)(t,`${i} ${n}`),e.setInputAriaLabel(`${o} (${r})`),(0,m._setAriaDescribedBy)(t,e.getInputElement().id)}onColumnStateChanged(){const e=this.workOutSelectedValue(),t=this.workOutReadOnlyValue();this.processingColumnStateChange=!0;const i=this.cbSelect;i.setValue(e),i.setReadOnly(t),this.toggleCss("ag-column-select-column-group-readonly",t),this.processingColumnStateChange=!1}workOutSelectedValue(){const e=this.beans.colModel.isPivotMode(),t=this.getVisibleLeafColumns();let i=0,s=0;if(t.forEach(n=>{!e&&n.getColDef().lockVisible||(this.isColumnChecked(n,e)?i++:s++)}),!(i>0&&s>0))return i>0}workOutReadOnlyValue(){const e=this.beans.colModel.isPivotMode();let t=0;return this.columnGroup.getLeafColumns().forEach(i=>{e?i.isAnyFunctionAllowed()&&t++:i.getColDef().lockVisible||t++}),t===0}isColumnChecked(e,t){if(t){const i=e.isPivotActive(),s=e.isRowGroupActive(),n=e.isValueActive();return i||s||n}return e.isVisible()}onExpandOrContractClicked(){const e=this.modelItem,t=e.expanded;e.expanded=!t}onExpandChanged(){this.setOpenClosedIcons(),this.refreshAriaExpanded()}setOpenClosedIcons(){const e=this.modelItem.expanded;(0,m._setDisplayed)(this.eGroupClosedIcon,!e),(0,m._setDisplayed)(this.eGroupOpenedIcon,e)}refreshAriaExpanded(){(0,m._setAriaExpanded)(this.focusWrapper,this.modelItem.expanded)}getDisplayName(){return this.displayName}onSelectAllChanged(e){const t=this.cbSelect,i=t.getValue();!t.isReadOnly()&&(e&&!i||!e&&i)&&t.toggle()}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}setSelected(e){this.cbSelect.setValue(e,!0)}},vS=e=>(0,m.isProvidedColumnGroup)(e)?e.getLeafColumns():e?[e]:[],pK=(e,t,i,s)=>{if(!i||!t)return null;const n=e.colModel.getCols(),a=n.indexOf(i),r=s?a:a+1,o=gK(n,t,r);return r-o},gK=(e,t,i)=>{if(!t)return 0;const s=t[0],n=t.length;return e.indexOf(s)<i?n:0},zk=(e,t,i)=>e.get("suppressMovableColumns")||t.colModel.isPivotMode()?!0:!!i.find(({colDef:a})=>!!a.suppressMovable||!!a.lockPosition),Vk=(e,t,i)=>{var o;if(!i)return;const{component:s}=i;let n=null,a=i.position==="top";if(s instanceof Gk?(n=s.getColumns()[0],a=!0):s&&(n=s.column),!n)return;const r=pK(e,t,n,a);r!=null&&((o=e.colMoves)==null||o.moveColumns(t,r,"toolPanelUi"))},fK=e=>e.column,mK={tag:"div",cls:"ag-column-select-column",children:[{tag:"ag-checkbox",ref:"cbSelect",cls:"ag-column-select-checkbox"},{tag:"span",ref:"eLabel",cls:"ag-column-select-column-label"}]},yK=class extends m.Component{constructor(e,t,i,s){super(),this.modelItem=e,this.allowDragging=t,this.groupsExist=i,this.focusWrapper=s,this.eLabel=m.RefPlaceholder,this.cbSelect=m.RefPlaceholder,this.processingColumnStateChange=!1;const{column:n,depth:a,displayName:r}=e;this.column=n,this.columnDepth=a,this.displayName=r}postConstruct(){this.setTemplate(mK,[m.AgCheckboxSelector]);const{beans:e,cbSelect:t,displayName:i,eLabel:s,columnDepth:n,groupsExist:a,column:r,gos:o,focusWrapper:l}=this,c=(0,m._createIconNoSpan)("columnDrag",e);this.eDragHandle=c,c.classList.add("ag-drag-handle","ag-column-select-column-drag-handle");const h=t.getGui(),d=t.getInputElement();h.insertAdjacentElement("afterend",c),d.setAttribute("tabindex","-1"),s.textContent=i,a&&this.addCss("ag-column-select-add-group-indent"),this.addCss(`ag-column-select-indent-${n}`),this.getGui().style.setProperty("--ag-indentation-level",String(n)),this.tooltipFeature=this.createOptionalManagedBean(e.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),getLocation:()=>"columnToolPanelColumn",getColDef:()=>r.getColDef(),shouldDisplayTooltip:(0,m._getShouldDisplayTooltip)(o,()=>s)})),this.setupDragging();const u=this.onColumnStateChanged.bind(this);this.addManagedEventListeners({columnPivotModeChanged:u}),this.addManagedListeners(r,{columnValueChanged:u,columnPivotChanged:u,columnRowGroupChanged:u,visibleChanged:u}),this.addManagedListeners(l,{keydown:this.handleKeyDown.bind(this),contextmenu:this.onContextMenu.bind(this)}),this.addManagedPropertyListener("functionsReadOnly",this.onColumnStateChanged.bind(this)),this.addManagedListeners(t,{fieldValueChanged:this.onCheckboxChanged.bind(this)}),this.addManagedElementListeners(s,{click:this.onLabelClicked.bind(this)}),this.onColumnStateChanged(),this.refreshAriaLabel(),this.setupTooltip(),(0,m._getToolPanelClassesFromColDef)(r.getColDef(),o,r,null).forEach(g=>this.toggleCss(g,!0))}getColumn(){return this.column}setupTooltip(){const e=()=>{var t;return(t=this.tooltipFeature)==null?void 0:t.setTooltipAndRefresh(this.column.getColDef().headerTooltip)};e(),this.addManagedEventListeners({newColumnsLoaded:e})}onContextMenu(e){const{column:t,gos:i}=this;if(i.get("functionsReadOnly"))return;const s=this.createBean(new _k(t,e,this.focusWrapper));this.addDestroyFunc(()=>{s.isAlive()&&this.destroyBean(s)})}handleKeyDown(e){e.key===m.KeyCode.SPACE&&(e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected()))}onLabelClicked(){if(this.gos.get("functionsReadOnly"))return;const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}onChangeCommon(e){this.cbSelect.isReadOnly()||(this.refreshAriaLabel(),!this.processingColumnStateChange&&Nk(this.beans,[this.column],e,"toolPanelUi"))}refreshAriaLabel(){const{cbSelect:e,focusWrapper:t,displayName:i}=this,s=this.getLocaleTextFunc(),n=s("ariaColumn","Column"),a=e.getValue()?s("ariaVisible","visible"):s("ariaHidden","hidden"),r=s("ariaToggleVisibility","Press SPACE to toggle visibility");(0,m._setAriaLabel)(t,`${i} ${n}`),this.cbSelect.setInputAriaLabel(`${r} (${a})`),(0,m._setAriaDescribedBy)(t,e.getInputElement().id)}setupDragging(){const e=this.eDragHandle;if(!this.allowDragging){(0,m._setDisplayed)(e,!1);return}const t=this.beans,{gos:i,eventSvc:s,dragAndDrop:n}=t;let a=!i.get("suppressDragLeaveHidesColumns");const r={type:m.DragSourceType.ToolPanel,eElement:e,dragItemName:this.displayName,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:()=>this.createDragItem(),onDragStarted:()=>{a=!i.get("suppressDragLeaveHidesColumns"),s.dispatchEvent({type:"columnPanelItemDragStart",column:this.column})},onDragStopped:()=>{s.dispatchEvent({type:"columnPanelItemDragEnd"})},onGridEnter:o=>{a&&Ok(t,{columns:[this.column],visibleState:o==null?void 0:o.visibleState,pivotState:o==null?void 0:o.pivotState,eventType:"toolPanelUi"})},onGridExit:()=>{a&&this.onChangeCommon(!1)}};n.addDragSource(r,!0),this.addDestroyFunc(()=>n.removeDragSource(r))}createDragItem(){const e=this.column.getColId(),t={[e]:this.column.isVisible()},i={[e]:Fk(this.column)};return{columns:[this.column],visibleState:t,pivotState:i}}onColumnStateChanged(){this.processingColumnStateChange=!0;const e=this.beans.colModel.isPivotMode();if(e){const s=this.column.isAnyFunctionActive();this.cbSelect.setValue(s)}else this.cbSelect.setValue(this.column.isVisible());let t=!0,i=!0;if(e){const s=this.gos.get("functionsReadOnly"),n=!this.column.isAnyFunctionAllowed();t=!s&&!n,i=t}else{const{enableRowGroup:s,enableValue:n,lockPosition:a,suppressMovable:r,lockVisible:o}=this.column.getColDef(),l=!!s||!!n,c=!!a||!!r;t=!o,i=l||!c}this.cbSelect.setReadOnly(!t),this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!i),this.toggleCss("ag-column-select-column-readonly",!i&&!t),this.cbSelect.setPassive(!1),this.processingColumnStateChange=!1}getDisplayName(){return this.displayName}onSelectAllChanged(e){const t=this.cbSelect;e!==t.getValue()&&(t.isReadOnly()||t.toggle())}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}isExpandable(){return!1}setExpanded(e){(0,m._warn)(158)}},vK=class{constructor(e){this.items=e}getRowCount(){return this.items.length}getRow(e){return this.items[e]}},bK="ag-column-select-list",xK=class extends m.Component{constructor(){super({tag:"div",cls:bK,role:"presentation"}),this.destroyColumnItemFuncs=[],this.hasLoadedInitialState=!1,this.isInitialState=!1,this.skipRefocus=!1}wireBeans(e){this.colModel=e.colModel}destroy(){this.destroyColumnTree(),super.destroy()}destroyColumnTree(){this.allColsTree=[],this.destroyColumnItemFuncs.forEach(e=>e()),this.destroyColumnItemFuncs=[]}init(e,t,i){this.params=e;const{suppressSyncLayoutWithGrid:s,contractColumnSelection:n,suppressColumnMove:a}=e;this.allowDragging=t,this.eventType=i,s||this.addManagedEventListeners({columnMoved:this.onColumnsChanged.bind(this)}),this.addManagedEventListeners({newColumnsLoaded:this.onColumnsChanged.bind(this)});const r=this.fireSelectionChangedEvent.bind(this);this.addManagedEventListeners({columnPivotChanged:r,columnPivotModeChanged:r,columnRowGroupChanged:r,columnValueChanged:r,columnVisible:r,newColumnsLoaded:r}),this.expandGroupsByDefault=!n;const o=a||s,l=this.createManagedBean(new Od({cssIdentifier:"column-select",ariaRole:"tree",moveItemCallback:(c,h)=>{o||this.moveItems(c,h)}}));this.virtualList=l,this.appendChild(l.getGui()),l.setComponentCreator((c,h)=>((0,m._setAriaLevel)(h,c.depth+1),this.createComponentFromItem(c,h))),this.colModel.ready&&this.onColumnsChanged(),!o&&this.createItemDragFeature()}createItemDragFeature(){const{gos:e,beans:t,eventSvc:i,virtualList:s}=this;this.createManagedBean(new vk(this,s,{dragSourceType:m.DragSourceType.ToolPanel,listItemDragStartEvent:"columnPanelItemDragStart",listItemDragEndEvent:"columnPanelItemDragEnd",eventSource:i,getCurrentDragValue:n=>fK(n),isMoveBlocked:n=>zk(e,t,vS(n)),getNumRows:n=>n.getDisplayedColsList().length,moveItem:(n,a)=>Vk(t,vS(n),a)}))}moveItems(e,t){var g;const{gos:i,beans:s}=this,{modelItem:n}=e,{group:a,columnGroup:r,column:o,expanded:l}=n,c=vS(a?r:o);if(zk(i,s,c))return;const h=this.displayedColsList.indexOf(n),d=t?-1:1;let u=0;if(t){const f=e.columnDepth>0&&((g=o.getParent())==null?void 0:g.getChildren());f&&f.length&&o===f[0]&&(u=-1)}else a&&(u=l?n.children.length:0);const p=Math.min(Math.max(h+u+d,0),this.displayedColsList.length-1);this.skipRefocus=!0,Vk(s,c,{rowIndex:p,position:t?"top":"bottom",component:this.virtualList.getComponentAt(p)}),this.focusRowIfAlive(p-u).then(()=>{this.skipRefocus=!1})}createComponentFromItem(e,t){const i=this.allowDragging;if(e.group){const n=new Gk(e,i,this.eventType,t);return this.createBean(n),n}const s=new yK(e,i,this.groupsExist,t);return this.createBean(s),s}onColumnsChanged(){const e=this.params;this.hasLoadedInitialState||(this.hasLoadedInitialState=!0,this.isInitialState=!!e.initialState);const t=this.getExpandedStates(),i=this.colModel.isPivotMode();!e.suppressSyncLayoutWithGrid&&!i?this.buildTreeFromWhatGridIsDisplaying():this.buildTreeFromProvidedColumnDefs(),this.setExpandedStates(t),this.markFilteredColumns(),this.flattenAndFilterModel(),this.isInitialState=!1}getDisplayedColsList(){return this.displayedColsList}getExpandedStates(){const e={};if(this.isInitialState){const{expandedGroupIds:t}=this.params.initialState;return t.forEach(i=>{e[i]=!0}),e}return this.allColsTree?(this.forEachItem(t=>{if(!t.group)return;const i=t.columnGroup;i&&(e[i.getId()]=t.expanded)}),e):{}}setExpandedStates(e){if(!this.allColsTree)return;const{isInitialState:t}=this;this.forEachItem(i=>{if(!i.group)return;const s=i.columnGroup;if(s){const n=e[s.getId()];(n!=null||t)&&(i.expanded=!!n)}})}buildTreeFromWhatGridIsDisplaying(){Pk(this.colModel,this.setColumnLayout.bind(this))}setColumnLayout(e){const t=Lk(this.colModel,e);this.buildListModel(t),this.groupsExist=e.some(i=>i&&typeof i.children!="undefined"),this.markFilteredColumns(),this.flattenAndFilterModel()}buildTreeFromProvidedColumnDefs(){var t;const e=this.colModel;this.buildListModel(e.getColDefColTree()),this.groupsExist=!!((t=e.colDefCols)!=null&&t.treeDepth)}buildListModel(e){const t=this.onColumnExpanded.bind(this),i=o=>{o.addEventListener("expandedChanged",t);const l=o.removeEventListener.bind(o,"expandedChanged",t);this.destroyColumnItemFuncs.push(l)},s=this.beans.colNames,n=(o,l,c)=>{o.forEach(h=>{(0,m.isProvidedColumnGroup)(h)?a(h,l,c):r(h,l,c)})},a=(o,l,c)=>{const h=o.getColGroupDef();if(h&&h.suppressColumnsToolPanel)return;if(o.isPadding()){n(o.getChildren(),l,c);return}const u=s.getDisplayNameForProvidedColumnGroup(null,o,"columnToolPanel"),p=new Ek(u,o,l,!0,this.expandGroupsByDefault);c.push(p),i(p),n(o.getChildren(),l+1,p.children)},r=(o,l,c)=>{if(o.getColDef()&&o.getColDef().suppressColumnsToolPanel)return;const d=s.getDisplayNameForColumn(o,"columnToolPanel");c.push(new Ek(d,o,l))};this.destroyColumnTree(),n(e,0,this.allColsTree)}onColumnExpanded(){this.flattenAndFilterModel()}flattenAndFilterModel(){this.displayedColsList=[];const e=s=>{s.passesFilter&&(this.displayedColsList.push(s),s.group&&s.expanded&&s.children.forEach(e))},t=this.virtualList;this.allColsTree.forEach(e),t.setModel(new vK(this.displayedColsList));let i=null;this.skipRefocus||(i=t.getLastFocusedRow()),t.refresh(),i!=null&&this.focusRowIfAlive(i),this.notifyListeners(),this.refreshAriaLabel()}refreshAriaLabel(){const e=this.getLocaleTextFunc(),t=e("ariaColumnPanelList","Column List"),i=e("columns","Columns"),s=this.displayedColsList.length;(0,m._setAriaLabel)(this.virtualList.getAriaElement(),`${t} ${s} ${i}`)}focusRowIfAlive(e){return e===-1?Promise.resolve():new Promise(t=>{window.setTimeout(()=>{this.isAlive()&&this.virtualList.focusRow(e),t()},0)})}forEachItem(e){const t=s=>{s.forEach(n=>{e(n),n.group&&t(n.children)})},i=this.allColsTree;i&&t(i)}doSetExpandedAll(e){this.forEachItem(t=>{t.group&&(t.expanded=e)})}setGroupsExpanded(e,t){if(!t){this.doSetExpandedAll(e);return}const i=[];this.forEachItem(n=>{if(!n.group)return;const a=n.columnGroup.getId();t.indexOf(a)>=0&&(n.expanded=e,i.push(a))});const s=t.filter(n=>!i.includes(n));s.length>0&&(0,m._warn)(157,{unrecognisedGroupIds:s})}getExpandState(){let e=0,t=0;return this.forEachItem(i=>{i.group&&(i.expanded?e++:t++)}),e>0&&t>0?2:t>0?1:0}doSetSelectedAll(e){Rk(this.beans,this.allColsTree,e,this.eventType)}getSelectionState(){let e=0,t=0;const i=this.colModel.isPivotMode();if(this.forEachItem(s=>{if(s.group||!s.passesFilter)return;const n=s.column,a=n.getColDef();let r;if(i){if(!n.isAllowPivot()&&!n.isAllowRowGroup()&&!n.isAllowValue())return;r=n.isValueActive()||n.isPivotActive()||n.isRowGroupActive()}else{if(a.lockVisible)return;r=n.isVisible()}r?e++:t++}),!(e>0&&t>0))return!(e===0||t>0)}setFilterText(e){this.filterText=(0,m._exists)(e)?e.toLowerCase():null,this.markFilteredColumns(),this.flattenAndFilterModel()}markFilteredColumns(){const e=i=>{if(!(0,m._exists)(this.filterText))return!0;const s=i.displayName;return s==null||s.toLowerCase().indexOf(this.filterText)!==-1},t=(i,s)=>{let n=!1;if(i.group){const r=e(i);i.children.forEach(o=>{const l=t(o,r||s);l&&(n=l)})}const a=s||n?!0:e(i);return i.passesFilter=a,a};this.allColsTree.forEach(i=>t(i,!1))}notifyListeners(){this.fireGroupExpandedEvent(),this.fireSelectionChangedEvent()}fireGroupExpandedEvent(){const e=this.getExpandState();this.dispatchLocalEvent({type:"groupExpanded",state:e})}fireSelectionChangedEvent(){if(!this.allColsTree)return;const e=this.getSelectionState();this.dispatchLocalEvent({type:"selectionChanged",state:e})}getExpandedGroups(){const e=[];return this.allColsTree&&this.forEachItem(t=>{t.group&&t.expanded&&e.push(t.columnGroup.getId())}),e}},CK={selector:"AG-PRIMARY-COLS-LIST",component:xK},SK={tag:"div",cls:"ag-column-select",children:[{tag:"ag-primary-cols-header",ref:"primaryColsHeaderPanel"},{tag:"ag-primary-cols-list",ref:"primaryColsListPanel"}]},jk=class extends m.Component{constructor(){super(SK,[tK,CK]),this.primaryColsHeaderPanel=m.RefPlaceholder,this.primaryColsListPanel=m.RefPlaceholder,this.registerCSS(qU)}init(e,t,i){const{primaryColsHeaderPanel:s,primaryColsListPanel:n}=this;s.init(t);const a=t.suppressColumnFilter,r=t.suppressColumnSelectAll;t.suppressColumnExpandAll&&a&&r&&s.setDisplayed(!1),this.addManagedListeners(n,{groupExpanded:l=>{s.setExpandState(l.state),t.onStateUpdated()},selectionChanged:l=>s.setSelectionState(l.state)}),n.init(t,e,i),this.addManagedListeners(s,{expandAll:n.doSetExpandedAll.bind(n,!0),collapseAll:n.doSetExpandedAll.bind(n,!1),selectAll:n.doSetSelectedAll.bind(n,!0),unselectAll:n.doSetSelectedAll.bind(n,!1),filterChanged:l=>n.setFilterText(l.filterText)}),this.positionableFeature=this.createManagedBean(new m.PositionableFeature(this.getGui(),{minHeight:100}))}toggleResizable(e){this.positionableFeature.setResizable(e?{bottom:!0}:!1)}expandGroups(e){this.primaryColsListPanel.setGroupsExpanded(!0,e)}collapseGroups(e){this.primaryColsListPanel.setGroupsExpanded(!1,e)}setColumnLayout(e){this.primaryColsListPanel.setColumnLayout(e)}syncLayoutWithGrid(){this.primaryColsListPanel.onColumnsChanged()}getExpandedGroups(){return this.primaryColsListPanel.getExpandedGroups()}},MK=".ag-column-panel{display:flex;flex:1 1 auto;flex-direction:column;overflow:hidden}.ag-pivot-mode-panel{display:flex;height:var(--ag-header-height)}.ag-pivot-mode-select{align-items:center;display:flex}:where(.ag-ltr) .ag-pivot-mode-select{margin-left:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-pivot-mode-select{margin-right:var(--ag-widget-container-horizontal-padding)}.ag-column-panel-column-select{border-bottom:var(--ag-tool-panel-separator-border)}.ag-column-panel-column-select:where(:nth-child(n+2 of :not(.ag-hidden))){border-top:var(--ag-tool-panel-separator-border)}:where(.ag-column-panel) .ag-column-drop-vertical{flex:1 1 0px;min-height:50px;&:where(:not(.ag-last-column-drop)){border-bottom:var(--ag-tool-panel-separator-border)}}",DK=class extends m.Component{constructor(){super({tag:"div",cls:"ag-column-panel"}),this.initialised=!1,this.childDestroyFuncs=[],this.registerCSS(MK)}wireBeans(e){this.colToolPanelFactory=e.colToolPanelFactory}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}init(e){const t=(0,m._addGridCommonParams)(this.gos,{suppressColumnMove:!1,suppressColumnSelectAll:!1,suppressColumnFilter:!1,suppressColumnExpandAll:!1,contractColumnSelection:!1,suppressPivotMode:!1,suppressRowGroups:!1,suppressValues:!1,suppressPivots:!1,suppressSyncLayoutWithGrid:!1}),i=b(b({},t),e);this.params=i;const{childDestroyFuncs:s,colToolPanelFactory:n,gos:a}=this,r=a.isModuleRegistered("SharedPivot"),o=r||a.isModuleRegistered("SharedRowGrouping");!i.suppressPivotMode&&n&&r&&(this.pivotModePanel=n.createPivotModePanel(this,s));const l=this.createBean(new jk);if(this.primaryColsPanel=l,s.push(()=>this.destroyBean(this.primaryColsPanel)),l.init(!0,i,"toolPanelUi"),l.addCss("ag-column-panel-column-select"),this.appendChild(l),n){!i.suppressRowGroups&&o&&(this.rowGroupDropZonePanel=n.createRowGroupPanel(this,s)),!i.suppressValues&&o&&(this.valuesDropZonePanel=n.createValuesPanel(this,s)),!i.suppressPivots&&r&&(this.pivotDropZonePanel=n.createPivotPanel(this,s)),this.setLastVisible();const[c]=this.addManagedEventListeners({columnPivotModeChanged:()=>{this.resetChildrenHeight(),this.setLastVisible()}});s.push(()=>c())}this.initialised=!0}setPivotModeSectionVisible(e){const t=this.colToolPanelFactory;t&&(this.pivotModePanel=t.setPanelVisible(this.pivotModePanel,e,t.createPivotModePanel.bind(t,this,this.childDestroyFuncs,!0)),this.setLastVisible())}setRowGroupsSectionVisible(e){const t=this.colToolPanelFactory;t&&(this.rowGroupDropZonePanel=t.setPanelVisible(this.rowGroupDropZonePanel,e,t.createRowGroupPanel.bind(t,this,this.childDestroyFuncs)),this.setLastVisible())}setValuesSectionVisible(e){const t=this.colToolPanelFactory;t&&(this.valuesDropZonePanel=t.setPanelVisible(this.valuesDropZonePanel,e,t.createValuesPanel.bind(t,this,this.childDestroyFuncs)),this.setLastVisible())}setPivotSectionVisible(e){var i;const t=this.colToolPanelFactory;t&&(this.pivotDropZonePanel=t.setPanelVisible(this.pivotDropZonePanel,e,t.createPivotPanel.bind(t,this,this.childDestroyFuncs)),(i=this.pivotDropZonePanel)==null||i.setDisplayed(e),this.setLastVisible())}setResizers(){[this.primaryColsPanel,this.rowGroupDropZonePanel,this.valuesDropZonePanel,this.pivotDropZonePanel].forEach(e=>{if(!e)return;const t=e.getGui();e.toggleResizable(!t.classList.contains("ag-last-column-drop")&&!t.classList.contains("ag-hidden"))})}setLastVisible(){const e=this.getGui();Array.prototype.slice.call(e.querySelectorAll(".ag-column-drop")).forEach(n=>n.classList.remove("ag-last-column-drop"));const i=e.querySelectorAll(".ag-column-drop:not(.ag-hidden)"),s=(0,m._last)(i);s&&s.classList.add("ag-last-column-drop"),this.setResizers()}resetChildrenHeight(){const t=this.getGui().children;for(let i=0;i<t.length;i++){const{style:s}=t[i];s.removeProperty("height"),s.removeProperty("flex")}}expandColumnGroups(e){this.primaryColsPanel.expandGroups(e)}collapseColumnGroups(e){this.primaryColsPanel.collapseGroups(e)}setColumnLayout(e){this.primaryColsPanel.setColumnLayout(e)}syncLayoutWithGrid(){this.primaryColsPanel.syncLayoutWithGrid()}destroyChildren(){const e=this.childDestroyFuncs;e.forEach(t=>t()),e.length=0,(0,m._clearElement)(this.getGui())}refresh(e){return this.destroyChildren(),this.init(e),!0}getState(){return{expandedGroupIds:this.primaryColsPanel.getExpandedGroups()}}destroy(){this.destroyChildren(),super.destroy()}},wK=".ag-column-drop{align-items:center;display:inline-flex;overflow:auto;position:relative;width:100%}.ag-column-drop-list{align-items:center;display:flex}.ag-column-drop-cell{align-items:center;background-color:var(--ag-column-drop-cell-background-color);border:var(--ag-column-drop-cell-border);border-radius:500px;color:var(--ag-column-drop-cell-text-color);display:flex;padding:calc(var(--ag-spacing)*.25);position:relative;&:focus-visible{box-shadow:var(--ag-focus-shadow)}:where(.ag-drag-handle){color:var(--ag-column-drop-cell-drag-handle-color)}}:where(.ag-ltr) .ag-column-drop-cell{padding-left:calc(var(--ag-spacing)*.75)}:where(.ag-rtl) .ag-column-drop-cell{padding-right:calc(var(--ag-spacing)*.75)}.ag-column-drop-cell-text{flex:1 1 auto;margin:0 var(--ag-spacing);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-column-drop-vertical{align-items:stretch;display:flex;flex-direction:column;min-height:75px;overflow:hidden}.ag-column-drop-vertical-title-bar{align-items:center;display:flex;flex:none;padding:var(--ag-widget-container-vertical-padding) calc(var(--ag-spacing)*2) 0}.ag-column-drop-vertical-list{align-items:stretch;flex-direction:column;flex-grow:1;overflow-x:auto;padding-bottom:var(--ag-spacing);padding-left:var(--ag-spacing);padding-right:var(--ag-spacing);position:relative;>*{flex:none}}:where(.ag-column-drop-empty) .ag-column-drop-vertical-list{overflow:hidden}.ag-column-drop-cell-button{cursor:pointer;min-width:0;opacity:.75;&:hover{opacity:1}}.ag-column-drop-wrapper{display:flex}.ag-column-drop-horizontal-half-width{width:50%!important}.ag-column-drop-cell-ghost{opacity:.5}.ag-column-drop-horizontal{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;white-space:nowrap}:where(.ag-ltr) .ag-column-drop-horizontal{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-column-drop-horizontal{padding-right:var(--ag-cell-horizontal-padding)}.ag-column-drop-horizontal-list{gap:var(--ag-cell-widget-spacing)}.ag-column-drop-vertical-cell{margin-top:var(--ag-spacing)}:where(.ag-ltr) .ag-column-drop-vertical-icon{margin-right:var(--ag-widget-horizontal-spacing)}:where(.ag-rtl) .ag-column-drop-vertical-icon{margin-left:var(--ag-widget-horizontal-spacing)}.ag-select-agg-func-popup{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);height:calc(var(--ag-spacing)*5*3.5);padding:0;position:absolute}.ag-select-agg-func-virtual-list-item{cursor:default;&:hover{background-color:var(--ag-selected-row-background-color)}}:where(.ag-ltr) .ag-select-agg-func-virtual-list-item{padding-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-select-agg-func-virtual-list-item{padding-right:calc(var(--ag-spacing)*2)}:where(.ag-ltr) .ag-column-drop-horizontal-half-width:where(:not(:last-child)){border-right:1px solid var(--ag-border-color)}:where(.ag-rtl) .ag-column-drop-horizontal-half-width:where(:not(:last-child)){border-left:1px solid var(--ag-border-color)}";function Hk(e,t,i){e==null||t==null||e.splice(i,0,...t)}var AK={tag:"div",cls:"ag-unselectable",role:"presentation"},Wk=class extends m.Component{constructor(e){super(AK),this.horizontal=e,this.state="notDragging",this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=(0,m._createElement)({tag:"div"}),this.addElementClasses(this.ePillDropList,"list"),this.registerCSS(wK)}toggleResizable(e){this.positionableFeature.setResizable(e?{bottom:!0}:!1),this.resizeEnabled=e}isSourceEventFromTarget(e){const{dropZoneTarget:t,dragSource:i}=e;return t.contains(i.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(e=>e()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,(0,m._clearElement)(this.getGui()),(0,m._clearElement)(this.ePillDropList)}init(e){this.params=e!=null?e:{},this.createManagedBean(new m.ManagedFocusFeature(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.onKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new m.PositionableFeature(this.getGui()),this.createManagedBean(this.positionableFeature),this.refreshGui(),(0,m._setAriaLabel)(this.ePillDropList,this.getAriaLabel())}onTabKeyDown(e){const t=(0,m._findFocusableElements)(this.getFocusableElement(),null,!0),i=t.length;if(i===0)return;const{shiftKey:s}=e,n=(0,m._getActiveDomElement)(this.beans),a=n===t[0],r=n===(0,m._last)(t);i===1||a&&s||r&&!s||t[s?0:i-1].focus()}onKeyDown(e){const{key:t}=e,i=!this.horizontal;let s=t===m.KeyCode.DOWN,n=t===m.KeyCode.UP;if(!i){const a=this.gos.get("enableRtl");s=!a&&t===m.KeyCode.RIGHT||a&&t===m.KeyCode.LEFT,n=!a&&t===m.KeyCode.LEFT||a&&t===m.KeyCode.RIGHT}if(!(!s&&!n))if(e.preventDefault(),e.shiftKey)this.moveFocusedItem(n);else{const a=(0,m._findNextFocusableElement)(this.beans,this.getFocusableElement(),!1,n);a&&a.focus()}}moveFocusedItem(e){const t=this.getFocusedItem();if(t===-1)return;const i=e?-1:1;if(!this.normalizeAndUpdateInsertIndex(t,t+i))return;const n=this.childPillComponents[t];if(!n.isMovable())return;const a=n.getItem();this.focusItemAtIndex(this.insertIndex),this.rearrangeItems([a],!0)}addElementClasses(e,t){t=t?`-${t}`:"";const i=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop${t}`,`ag-column-drop-${i}${t}`)}setupDropTarget(){var e;this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),onDragCancel:this.onDragCancel.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},(e=this.beans.dragAndDrop)==null||e.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(e){const t=this.getNewInsertIndex(e);return t<0?!1:this.normalizeAndUpdateInsertIndex(this.insertIndex,t)}normalizeAndUpdateInsertIndex(e,t){const i=this.minimumAllowedNewInsertIndex(),s=Math.max(i,t),n=s!==e;return n&&(this.insertIndex=s),n}getNewInsertIndex(e){const t=e.event,i=this.horizontal?t.clientX:t.clientY,s=this.childPillComponents.map(a=>a.getGui().getBoundingClientRect()),n=s.findIndex(a=>this.horizontal?a.right>i&&a.left<i:a.top<i&&a.bottom>i);if(n===-1){const a=this.gos.get("enableRtl");return s.every(l=>i>(this.horizontal?l.right:l.bottom))?a&&this.horizontal?0:this.childPillComponents.length:s.every(l=>i<(this.horizontal?l.left:l.top))?a&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=n?n+1:n}checkDragStartedBySelf(e){this.state==="notDragging"&&(this.state="rearrangeItems",this.potentialDndItems=this.getItems(e.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(e),this.refreshGui())}onDragging(e){this.checkDragStartedBySelf(e),this.checkInsertIndex(e)&&this.refreshGui()}handleDragEnterEnd(e){}onDragEnter(e){const t=this.getItems(e.dragSource.getDragItem());this.state="newItemsIn";const i=t.filter(n=>this.isItemDroppable(n,e)),s=i.every(n=>this.childPillComponents.map(a=>a.getItem()).indexOf(n)!==-1);if(i.length!==0){if(this.potentialDndItems=i,s){this.state="notDragging";return}this.handleDragEnterEnd(e),this.checkInsertIndex(e),this.refreshGui()}}isPotentialDndItems(){var e;return!!((e=this.potentialDndItems)!=null&&e.length)}handleDragLeaveEnd(e){}onDragLeave(e){if(this.state==="rearrangeItems"){const t=this.getItems(e.dragSource.getDragItem());this.removeItems(t)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(e),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}onDragCancel(e){this.isPotentialDndItems()&&(this.state==="newItemsIn"&&this.handleDragLeaveEnd(e),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}onDragStop(){this.isPotentialDndItems()&&(this.state==="newItemsIn"?this.addItems(this.potentialDndItems):this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}removeItems(e){const t=this.getExistingItems().filter(i=>!e.includes(i));this.updateItems(t)}addItems(e){if(!e)return;const t=this.getExistingItems().slice(),i=e.filter(s=>t.indexOf(s)<0);Hk(t,i,this.insertIndex),this.updateItems(t)}addItem(e){this.insertIndex=this.getExistingItems().length,this.addItems([e]),this.refreshGui()}rearrangeItems(e,t){let i;return t?i=this.getExistingItems().filter(s=>e.indexOf(s)===-1):i=this.getNonGhostItems().slice(),Hk(i,e,this.insertIndex),(0,m._areEqual)(i,this.getExistingItems())?!1:(this.updateItems(i),!0)}refreshGui(){var r;let e=0;this.horizontal||(e=this.ePillDropList.scrollTop);const t=this.resizeEnabled,i=this.getFocusedItem(),{eGridDiv:s}=this.beans,n=(0,m._isKeyboardMode)();let a=null;n&&(a=(r=(0,m._findNextFocusableElement)(this.beans,s))!=null?r:(0,m._findNextFocusableElement)(this.beans,s,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),e!==0&&(this.ePillDropList.scrollTop=e),t&&this.toggleResizable(t),n&&this.restoreFocus(i,a)}getFocusedItem(){const e=this.getGui(),t=(0,m._getActiveDomElement)(this.beans);return e.contains(t)?Array.from(e.querySelectorAll(".ag-column-drop-cell")).indexOf(t):-1}focusItemAtIndex(e){const t=this.getGui(),s=Array.from(t.querySelectorAll(".ag-column-drop-cell"))[e];s&&s.focus({preventScroll:!0})}restoreFocus(e,t){const i=this.getGui(),s=Array.from(i.querySelectorAll(".ag-column-drop-cell"));if(e===-1)return;s.length===0&&t.focus();const n=Math.min(s.length-1,e),a=s[n];a&&a.focus()}focusList(e){const t=e?this.childPillComponents.length-1:0;this.restoreFocus(t,this.getFocusableElement())}getNonGhostItems(){const e=this.getExistingItems();return this.isPotentialDndItems()?e.filter(t=>!this.potentialDndItems.includes(t)):e}addItemsToGui(){const t=this.getNonGhostItems().map(i=>this.createItemComponent(i,!1));if(this.isPotentialDndItems()){const i=this.potentialDndItems.map(s=>this.createItemComponent(s,!0));this.insertIndex>=t.length?t.push(...i):t.splice(this.insertIndex,0,...i)}this.appendChild(this.ePillDropList),t.forEach((i,s)=>{s>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(i.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){const{childPillComponents:e,ePillDropList:t}=this,i=e.length;(0,m._setAriaRole)(t,i===0?"presentation":"listbox");for(let s=0;s<i;s++){const a=e[s].getGui();(0,m._setAriaPosInSet)(a,s+1),(0,m._setAriaSetSize)(a,i)}}createItemComponent(e,t){const i=this.createPillComponent(e,this.dropTarget,t,this.horizontal);return i.addEventListener("columnRemove",this.removeItems.bind(this,[e])),this.createBean(i),this.guiDestroyFunctions.push(()=>this.destroyBean(i)),t||this.childPillComponents.push(i),i}addIconAndTitleToGui(){const{title:e,icon:t}=this.params;if(!e||!t)return;const i=(0,m._createElement)({tag:"div"});if((0,m._setAriaHidden)(i,!0),this.addElementClasses(i,"title-bar"),this.addElementClasses(t,"icon"),this.toggleCss("ag-column-drop-empty",this.isExistingItemsEmpty()),i.appendChild(t),!this.horizontal){const s=(0,m._createElement)({tag:"span"});this.addElementClasses(s,"title"),s.textContent=e,i.appendChild(s)}this.appendChild(i)}isExistingItemsEmpty(){return this.getExistingItems().length===0}addEmptyMessageToGui(){const{emptyMessage:e}=this.params;if(!e||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const t=(0,m._createElement)({tag:"span"});t.textContent=e,this.addElementClasses(t,"empty-message"),this.ePillDropList.appendChild(t)}addArrow(e){if(this.horizontal){const t=this.gos.get("enableRtl"),i=(0,m._createIconNoSpan)(t?"panelDelimiterRtl":"panelDelimiter",this.beans);this.addElementClasses(i,"cell-separator"),e.appendChild(i)}}},IK={tag:"span",role:"option",children:[{tag:"span",ref:"eDragHandle",cls:"ag-drag-handle ag-column-drop-cell-drag-handle",role:"presentation"},{tag:"span",ref:"eText",cls:"ag-column-drop-cell-text",attrs:{"aria-hidden":"true"}},{tag:"span",ref:"eButton",cls:"ag-column-drop-cell-button",role:"presentation"}]},Uk=class extends m.Component{constructor(e,t,i,s,n){super(),this.dragSourceDropTarget=e,this.ghost=t,this.horizontal=i,this.template=s,this.agComponents=n,this.eText=m.RefPlaceholder,this.eDragHandle=m.RefPlaceholder,this.eButton=m.RefPlaceholder}postConstruct(){var a;this.setTemplate((a=this.template)!=null?a:IK,this.agComponents);const e=this.getGui(),{beans:t,eDragHandle:i,eText:s,eButton:n}=this;this.addElementClasses(e),this.addElementClasses(i,"drag-handle"),this.addElementClasses(s,"text"),this.addElementClasses(n,"button"),i.appendChild((0,m._createIconNoSpan)("columnDrag",t)),n.appendChild((0,m._createIconNoSpan)("cancel",t)),this.tooltipFeature=this.createOptionalManagedBean(t.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui()})),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const e=this.getLocaleTextFunc(),t=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(t,e),(0,m._setAriaLabel)(this.getGui(),t.join(". "))}addAdditionalAriaInstructions(e,t){if(this.isRemovable()){const i=t("ariaDropZoneColumnComponentDescription","Press DELETE to remove");e.push(i)}}setupTooltip(){const e=()=>{var t;return(t=this.tooltipFeature)==null?void 0:t.setTooltipAndRefresh(this.getTooltip())};e(),this.addManagedEventListeners({newColumnsLoaded:e})}getDragSourceId(){}getDefaultIconName(){return"notAllowed"}addDragSource(){const{beans:{dragAndDrop:e},eDragHandle:t}=this,i=this.createGetDragItem(),s=this.getDefaultIconName(),n={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:t,getDefaultIconName:()=>s,getDragItem:i,dragItemName:this.getDisplayName()};e==null||e.addDragSource(n,!0),this.addDestroyFunc(()=>e==null?void 0:e.removeDragSource(n))}setupComponents(){this.eText.textContent=this.getDisplayValue(),this.setupRemove(),this.ghost&&this.addCss("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){(0,m._setDisplayed)(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const e={type:"columnRemove"};this.addGuiEventListener("keydown",i=>this.onKeyDown(i)),this.addManagedElementListeners(this.eButton,{click:i=>{this.dispatchLocalEvent(e),i.stopPropagation()}});const t=new m.TouchListener(this.eButton);this.addManagedListeners(t,{tap:()=>this.dispatchLocalEvent(e)}),this.addDestroyFunc(t.destroy.bind(t))}onKeyDown(e){e.key===m.KeyCode.DELETE&&this.isRemovable()&&(e.preventDefault(),this.dispatchLocalEvent({type:"columnRemove"}))}getDisplayValue(){return this.getDisplayName()}addElementClasses(e,t){t=t?`-${t}`:"";const i=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop-cell${t}`,`ag-column-drop-${i}-cell${t}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}},TK=class extends Uk{constructor(e,t,i,s,n){super(t,i,n),this.column=e,this.dropZonePurpose=s,this.eSortIndicator=m.RefPlaceholder,this.popupShowing=!1}postConstruct(){const{sortSvc:e,colNames:t}=this.beans;this.template={tag:"span",role:"option",children:[{tag:"span",ref:"eDragHandle",cls:"ag-drag-handle ag-column-drop-cell-drag-handle",role:"presentation"},{tag:"span",ref:"eText",cls:"ag-column-drop-cell-text",attrs:{"aria-hidden":"true"}},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:void 0,{tag:"span",ref:"eButton",cls:"ag-column-drop-cell-button",role:"presentation"}]},e&&(this.agComponents=[e.getSortIndicatorSelector()]),this.displayName=t.getDisplayNameForColumn(this.column,"columnDrop"),super.postConstruct(),e&&(this.setupSort(),this.addManagedEventListeners({sortChanged:()=>{this.setupAria()}})),this.isGroupingZone()&&this.addManagedPropertyListener("groupLockGroupColumns",()=>{this.refreshRemove(),this.refreshDraggable(),this.setupAria()})}getItem(){return this.column}getDisplayName(){return this.displayName}getTooltip(){return this.column.getColDef().headerTooltip}addAdditionalAriaInstructions(e,t){const i=this.gos.get("rowGroupPanelSuppressSort"),s=this.gos.get("functionsReadOnly");if(this.isAggregationZone()&&!s){const n=t("ariaDropZoneColumnValueItemDescription","Press ENTER to change the aggregation type");e.push(n)}if(this.isGroupingZone()&&this.column.isSortable()&&!i){const n=t("ariaDropZoneColumnGroupItemDescription","Press ENTER to sort");e.push(n)}super.addAdditionalAriaInstructions(e,t)}isMovable(){return this.isDraggable()}isDraggable(){return this.isReadOnly()}isRemovable(){return this.isReadOnly()}isReadOnly(){return!this.isGroupingAndLocked()&&!this.gos.get("functionsReadOnly")}getAriaDisplayName(){const e=this.getLocaleTextFunc(),{name:t,aggFuncName:i}=this.getColumnAndAggFuncName(),s=e("ariaDropZoneColumnComponentAggFuncSeparator"," of "),n={asc:e("ariaDropZoneColumnComponentSortAscending","ascending"),desc:e("ariaDropZoneColumnComponentSortDescending","descending")},a=this.column.getSort(),r=this.gos.get("rowGroupPanelSuppressSort");return[i&&`${i}${s}`,t,this.isGroupingZone()&&!r&&a&&`, ${n[a]}`].filter(o=>!!o).join("")}getColumnAndAggFuncName(){const e=this.displayName;let t="";if(this.isAggregationZone()){const i=this.column.getAggFunc(),s=typeof i=="string"?i:"agg";t=this.getLocaleTextFunc()(s,s)}return{name:e,aggFuncName:t}}setupSort(){if(!(!this.column.isSortable()||!this.isGroupingZone())&&!this.gos.get("rowGroupPanelSuppressSort")){this.eSortIndicator.setupSort(this.column,!0);const e=t=>{t.preventDefault(),this.beans.sortSvc.progressSortFromEvent(this.column,t)};this.addGuiEventListener("click",e),this.addGuiEventListener("keydown",t=>{t.key===m.KeyCode.ENTER&&this.isGroupingZone()&&e(t)})}}getDefaultIconName(){return"hide"}createGetDragItem(){const{column:e}=this;return()=>{const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}}setupComponents(){super.setupComponents(),this.isAggregationZone()&&!this.gos.get("functionsReadOnly")&&this.addGuiEventListener("click",this.onShowAggFuncSelection.bind(this))}onKeyDown(e){super.onKeyDown(e),e.key===m.KeyCode.ENTER&&this.isAggregationZone()&&!this.gos.get("functionsReadOnly")&&(e.preventDefault(),this.onShowAggFuncSelection())}getDisplayValue(){const{name:e,aggFuncName:t}=this.getColumnAndAggFuncName();return this.isAggregationZone()?`${t}(${e})`:e}onShowAggFuncSelection(){if(this.popupShowing)return;this.popupShowing=!0;const{aggFuncSvc:e,popupSvc:t}=this.beans,i=new Od({cssIdentifier:"select-agg-func"}),s=e.getFuncNames(this.column),n=this.getGui(),a=i.getGui();i.setModel({getRow:function(u){return s[u]},getRowCount:function(){return s.length}}),this.createBean(i);const r=(0,m._createElement)({tag:"div",cls:"ag-select-agg-func-popup"});r.style.top="0px",r.style.left="0px",r.appendChild(a),r.style.width=`${n.clientWidth}px`;const[o]=this.addManagedElementListeners(r,{focusout:u=>{!r.contains(u.relatedTarget)&&h&&h.hideFunc()}}),l=u=>{this.destroyBean(i),this.popupShowing=!1,(u==null?void 0:u.key)==="Escape"&&n.focus(),o&&o()},c=this.getLocaleTextFunc(),h=t.addPopup({modal:!0,eChild:r,closeOnEsc:!0,closedCallback:l,ariaLabel:c("ariaLabelAggregationFunction","Aggregation Function")});h&&i.setComponentCreator(this.createAggSelect.bind(this,h.hideFunc)),i.addGuiEventListener("keydown",u=>{if(u.key===m.KeyCode.ENTER||u.key===m.KeyCode.SPACE){const p=i.getLastFocusedRow();if(p==null)return;const g=i.getComponentAt(p);g&&g.selectItem()}}),t.positionPopupByComponent({type:"aggFuncSelect",eventSource:n,ePopup:r,keepWithinBounds:!0,column:this.column,position:"under"}),i.refresh();let d=s.findIndex(u=>u===this.column.getAggFunc());d===-1&&(d=0),i.focusRow(d)}createAggSelect(e,t){const i=()=>{var o,l;e(),this.getGui().focus(),(l=(o=this.beans.valueColsSvc)==null?void 0:o.setColumnAggFunc)==null||l.call(o,this.column,t,"toolPanelDragAndDrop")},s=this.getLocaleTextFunc(),n=t.toString(),a=s(n,n);return new kK(i,a)}isGroupingAndLocked(){return this.isGroupingZone()&&Hp(this.column,this.beans)}isAggregationZone(){return this.dropZonePurpose==="aggregation"}isGroupingZone(){return this.dropZonePurpose==="rowGroup"}getDragSourceType(){return m.DragSourceType.ToolPanel}destroy(){super.destroy(),this.column=null}},kK=class extends m.Component{constructor(e,t){super({tag:"div",cls:"ag-select-agg-func-item",children:t}),this.selectItem=e,this.addGuiEventListener("click",this.selectItem)}},bS=class extends Wk{constructor(e,t){super(e),this.dropZonePurpose=t,this.addElementClasses(this.getGui(),this.dropZonePurpose.toLowerCase())}init(e){super.init(e),this.addManagedEventListeners({newColumnsLoaded:this.refreshGui.bind(this)}),this.addManagedPropertyListeners(["functionsReadOnly","rowGroupPanelSuppressSort","groupLockGroupColumns"],this.refreshGui.bind(this))}getItems(e){var t;return(t=e.columns)!=null?t:[]}isInterestedIn(e){return e===m.DragSourceType.HeaderCell||e===m.DragSourceType.ToolPanel}minimumAllowedNewInsertIndex(){var n;const{gos:e,rowGroupColsSvc:t}=this.beans,i=e.get("groupLockGroupColumns"),s=(n=t==null?void 0:t.columns.length)!=null?n:0;return i===-1?s:Math.min(i,s)}showOrHideColumnOnExit(e){return this.isRowGroupPanel()&&(0,m._shouldUpdateColVisibilityAfterGroup)(this.gos,!0)&&!e.fromNudge}handleDragEnterEnd(e){if(this.showOrHideColumnOnExit(e)){const s=e.dragSource.getDragItem().columns;this.setColumnsVisible(s,!1,"uiColumnDragged")}}handleDragLeaveEnd(e){if(this.showOrHideColumnOnExit(e)){const i=e.dragSource.getDragItem();this.setColumnsVisible(i.columns,!0,"uiColumnDragged")}}setColumnsVisible(e,t,i){if(e){const s=e.filter(n=>!n.getColDef().lockVisible);this.beans.colModel.setColsVisible(s,t,i)}}isRowGroupPanel(){return this.dropZonePurpose==="rowGroup"}createPillComponent(e,t,i,s){return new TK(e,t,i,this.dropZonePurpose,s)}},Kk=class extends bS{constructor(e){super(e,"pivot")}postConstruct(){const e=this.getLocaleTextFunc(),t=e("pivotColumnsEmptyMessage","Drag here to set column labels"),i=e("pivots","Column Labels");super.init({icon:(0,m._createIconNoSpan)("pivotPanel",this.beans,null),emptyMessage:t,title:i}),this.addManagedEventListeners({newColumnsLoaded:this.refresh.bind(this),columnPivotChanged:this.refresh.bind(this),columnPivotModeChanged:this.checkVisibility.bind(this)}),this.refresh()}getAriaLabel(){return this.getLocaleTextFunc()("ariaPivotDropZonePanelLabel","Column Labels")}refresh(){this.checkVisibility(),this.refreshGui()}checkVisibility(){const e=this.beans.colModel,t=e.isPivotMode();if(this.horizontal)switch(this.gos.get("pivotPanelShow")){case"always":this.setDisplayed(t);break;case"onlyWhenPivoting":{const i=e.isPivotActive();this.setDisplayed(t&&i);break}default:this.setDisplayed(!1);break}else this.setDisplayed(t)}isItemDroppable(e,t){return this.gos.get("functionsReadOnly")||!e.isPrimary()?!1:e.isAllowPivot()&&(!e.isPivotActive()||this.isSourceEventFromTarget(t))}updateItems(e){var t;(t=this.beans.pivotColsSvc)==null||t.setColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?"pivot":"notAllowed"}getExistingItems(){var e,t;return(t=(e=this.beans.pivotColsSvc)==null?void 0:e.columns)!=null?t:[]}},$k=class extends bS{constructor(e){super(e,"rowGroup")}postConstruct(){const e=this.getLocaleTextFunc(),t=e("rowGroupColumnsEmptyMessage","Drag here to set row groups"),i=e("groups","Row Groups");super.init({icon:(0,m._createIconNoSpan)("rowGroupPanel",this.beans,null),emptyMessage:t,title:i}),this.addManagedEventListeners({columnRowGroupChanged:this.refreshGui.bind(this)})}getAriaLabel(){return this.getLocaleTextFunc()("ariaRowGroupDropZonePanelLabel","Row Groups")}isItemDroppable(e,t){return this.gos.get("functionsReadOnly")||!e.isPrimary()||e.colDef.showRowGroup?!1:e.isAllowRowGroup()&&(!e.isRowGroupActive()||this.isSourceEventFromTarget(t))}updateItems(e){var t;(t=this.beans.rowGroupColsSvc)==null||t.setColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?"group":"notAllowed"}getExistingItems(){var e,t;return(t=(e=this.beans.rowGroupColsSvc)==null?void 0:e.columns)!=null?t:[]}},LK=class extends bS{constructor(e){super(e,"aggregation")}postConstruct(){const e=this.getLocaleTextFunc(),t=e("valueColumnsEmptyMessage","Drag here to aggregate"),i=e("values","Values");super.init({icon:(0,m._createIconNoSpan)("valuePanel",this.beans,null),emptyMessage:t,title:i}),this.addManagedEventListeners({columnValueChanged:this.refreshGui.bind(this)})}getAriaLabel(){return this.getLocaleTextFunc()("ariaValuesDropZonePanelLabel","Values")}getIconName(){return this.isPotentialDndItems()?"aggregate":"notAllowed"}isItemDroppable(e,t){return this.gos.get("functionsReadOnly")||!e.isPrimary()?!1:e.isAllowValue()&&(!e.isValueActive()||this.isSourceEventFromTarget(t))}updateItems(e){var t;(t=this.beans.valueColsSvc)==null||t.setColumns(e,"toolPanelUi")}getExistingItems(){var e,t;return(t=(e=this.beans.valueColsSvc)==null?void 0:e.columns)!=null?t:[]}},PK={tag:"div",cls:"ag-pivot-mode-panel",children:[{tag:"ag-toggle-button",ref:"cbPivotMode",cls:"ag-pivot-mode-select"}]},EK=class extends m.Component{constructor(){super(...arguments),this.cbPivotMode=m.RefPlaceholder}postConstruct(){this.setTemplate(PK,[m.AgToggleButtonSelector]);const e=this.cbPivotMode,{colModel:t,ctrlsSvc:i,gos:s}=this.beans;e.setValue(t.isPivotMode());const n=this.getLocaleTextFunc();e.setLabel(n("pivotMode","Pivot Mode"));const a=()=>{const o=!!e.getValue();o!==t.isPivotMode()&&(s.updateGridOptions({options:{pivotMode:o},source:"toolPanelUi"}),i.getHeaderRowContainerCtrls().forEach(l=>l.refresh()))},r=()=>{const o=t.isPivotMode();e.setValue(o)};this.addManagedListeners(e,{fieldValueChanged:a}),this.addManagedEventListeners({newColumnsLoaded:r,columnPivotModeChanged:r})}},RK=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="colToolPanelFactory"}setPanelVisible(e,t,i){return e?e.setDisplayed(t):t&&(e=i()),e}createRowGroupPanel(e,t){return this.createPanel(e,t,new $k(!1))}createValuesPanel(e,t){return this.createPanel(e,t,new LK(!1))}createPivotPanel(e,t){return this.createPanel(e,t,new Kk(!1))}createPivotModePanel(e,t,i){return this.createPanel(e,t,new EK,i)}createPanel(e,t,i,s){return i=e.createBean(i),t.push(()=>e.destroyBean(i)),s?e.prependChild(i):e.appendChild(i),i}},NK={moduleName:"ColumnsToolPanel",version:Re,beans:[RK],userComponents:{agColumnsToolPanel:DK},icons:{ensureColumnVisible:"column-arrow",columnsToolPanel:"columns",menuAddRowGroup:"group",menuRemoveRowGroup:"group",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate"},dependsOn:[St,fS,m._ColumnMoveModule,m._SharedDragAndDropModule,m._PopupModule,Vm]},OK=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartMenuItemMapper"}getChartItems(e){var c,h;const t=this.beans,i=t.chartSvc,s=e==="pivotChart";if(!i)return null;const n=this.getLocaleTextFunc.bind(this),a=s?new FK(t,i,n):new BK(t,i,n),r=i.isEnterprise();let o=a.getMenuItem();if(o&&o.subMenu&&!r){const d=u=>{var p;return E(b({},u),{subMenu:(p=u.subMenu)==null?void 0:p.filter(g=>!g._enterprise).map(g=>d(g))})};o=d(o)}const l=(h=(c=this.gos.get("chartToolPanelsDef"))==null?void 0:c.settingsPanel)==null?void 0:h.chartGroupsDef;return l&&(o=this.filterAndOrderChartMenu(o,l,a.getConfigLookup())),this.cleanInternals(o)}cleanInternals(e){if(!e)return e;const t=i=>{var s;return i==null||delete i._key,i==null||delete i._enterprise,(s=i==null?void 0:i.subMenu)==null||s.forEach(n=>t(n)),i};return t(e)}buildLookup(e){const t={},i=s=>{t[s._key]=s,s.subMenu&&s.subMenu.forEach(n=>i(n))};return i(e),t}filterAndOrderChartMenu(e,t,i){var a,r,o;const s=this.buildLookup(e),n=E(b({},e),{subMenu:[]});for(const l of Object.keys(t)){const c=t[l],h=i[l];if(h===null)continue;if(h==null){(0,m._warn)(173,{group:l});continue}const d=s[h._key];if(d)if(d.subMenu){const u=c.map(p=>{const g=h[p];if(g==null){(0,m._warn)(174,{group:l,chartType:p});return}return s[g]}).filter(p=>p!==void 0);u.length>0&&(d.subMenu=u,(a=n.subMenu)==null||a.push(d))}else(r=n.subMenu)==null||r.push(d)}return((o=n.subMenu)==null?void 0:o.length)==0?null:n}},FK=class{constructor(e,t,i){this.beans=e,this.chartSvc=t,this.getLocaleTextFunc=i}getMenuItem(){const e=this.getLocaleTextFunc(),t=(i,s,n,a,r=!1)=>({name:e(i,s+"\u200E"),action:()=>this.chartSvc.createPivotChart({chartType:n}),_key:a,_enterprise:r});return{name:e("pivotChart","Pivot Chart"),_key:"pivotChart",subMenu:[{_key:"pivotColumnChart",name:e("columnChart","Column"),subMenu:[t("groupedColumn","Grouped","groupedColumn","pivotGroupedColumn"),t("stackedColumn","Stacked","stackedColumn","pivotStackedColumn"),t("normalizedColumn","100% Stacked","normalizedColumn","pivotNormalizedColumn")]},{_key:"pivotBarChart",name:e("barChart","Bar"),subMenu:[t("groupedBar","Grouped","groupedBar","pivotGroupedBar"),t("stackedBar","Stacked","stackedBar","pivotStackedBar"),t("normalizedBar","100% Stacked","normalizedBar","pivotNormalizedBar")]},{_key:"pivotPieChart",name:e("pieChart","Pie"),subMenu:[t("pie","Pie","pie","pivotPie"),t("donut","Donut","donut","pivotDonut")]},{_key:"pivotLineChart",name:e("lineChart","Line"),subMenu:[t("lineChart","Line","line","pivotLineChart"),t("stackedLine","Stacked","stackedLine","pivotStackedLine"),t("normalizedLine","100% Stacked","normalizedLine","pivotNormalizedLine")]},{_key:"pivotAreaChart",name:e("areaChart","Area"),subMenu:[t("areaChart","Area","area","pivotArea"),t("stackedArea","Stacked","stackedArea","pivotStackedArea"),t("normalizedArea","100% Stacked","normalizedArea","pivotNormalizedArea")]},{_key:"pivotXYChart",name:e("xyChart","X Y (Scatter)"),subMenu:[t("scatter","Scatter","scatter","pivotScatter"),t("bubble","Bubble","bubble","pivotBubble")]},{_key:"pivotStatisticalChart",_enterprise:!1,name:e("statisticalChart","Statistical"),subMenu:[t("histogramChart","Histogram","histogram","pivotHistogram",!1)]},{_key:"pivotHierarchicalChart",_enterprise:!0,name:e("hierarchicalChart","Hierarchical"),subMenu:[t("treemapChart","Treemap","treemap","pivotTreemap",!0),t("sunburstChart","Sunburst","sunburst","pivotSunburst",!0)]},{_key:"pivotFunnel",name:e("funnel","Funnel"),subMenu:[t("funnel","Funnel","funnel","pivotFunnel"),t("coneFunnel","Cone Funnel","coneFunnel","pivotConeFunnel"),t("pyramid","Pyramid","pyramid","pivotPyramid")]},{_key:"pivotCombinationChart",name:e("combinationChart","Combination"),subMenu:[t("columnLineCombo","Column & Line","columnLineCombo","pivotColumnLineCombo"),t("AreaColumnCombo","Area & Column","areaColumnCombo","pivotAreaColumnCombo")]}],icon:(0,m._createIconNoSpan)("chart",this.beans,void 0)}}getConfigLookup(){return{columnGroup:{_key:"pivotColumnChart",column:"pivotGroupedColumn",stackedColumn:"pivotStackedColumn",normalizedColumn:"pivotNormalizedColumn"},barGroup:{_key:"pivotBarChart",bar:"pivotGroupedBar",stackedBar:"pivotStackedBar",normalizedBar:"pivotNormalizedBar"},pieGroup:{_key:"pivotPieChart",pie:"pivotPie",donut:"pivotDonut",doughnut:"pivotDonut"},lineGroup:{_key:"pivotLineChart",line:"pivotLineChart",stackedLine:"pivotStackedLine",normalizedLine:"pivotNormalizedLine"},areaGroup:{_key:"pivotAreaChart",area:"pivotArea",stackedArea:"pivotStackedArea",normalizedArea:"pivotNormalizedArea"},scatterGroup:{_key:"pivotXYChart",bubble:"pivotBubble",scatter:"pivotScatter"},combinationGroup:{_key:"pivotCombinationChart",columnLineCombo:"pivotColumnLineCombo",areaColumnCombo:"pivotAreaColumnCombo",customCombo:null},hierarchicalGroup:{_key:"pivotHierarchicalChart",treemap:"pivotTreemap",sunburst:"pivotSunburst"},statisticalGroup:{_key:"pivotStatisticalChart",histogram:"pivotHistogram",rangeBar:null,rangeArea:null,boxPlot:null},funnelGroup:{_key:"pivotFunnel",funnel:"pivotFunnel",coneFunnel:"pivotConeFunnel",pyramid:"pivotPyramid"},polarGroup:null,specializedGroup:null}}},BK=class{constructor(e,t,i){this.beans=e,this.chartSvc=t,this.getLocaleTextFunc=i}getMenuItem(){const e=this.getLocaleTextFunc(),t=(i,s,n,a,r=!1)=>({name:e(i,s),action:()=>this.chartSvc.createChartFromCurrentRange(n),_key:a,_enterprise:r});return{name:e("chartRange","Chart Range"),_key:"chartRange",subMenu:[{name:e("columnChart","Column"),subMenu:[t("groupedColumn","Grouped","groupedColumn","rangeGroupedColumn"),t("stackedColumn","Stacked","stackedColumn","rangeStackedColumn"),t("normalizedColumn","100% Stacked","normalizedColumn","rangeNormalizedColumn")],_key:"rangeColumnChart"},{name:e("barChart","Bar"),subMenu:[t("groupedBar","Grouped","groupedBar","rangeGroupedBar"),t("stackedBar","Stacked","stackedBar","rangeStackedBar"),t("normalizedBar","100% Stacked","normalizedBar","rangeNormalizedBar")],_key:"rangeBarChart"},{name:e("pieChart","Pie"),subMenu:[t("pie","Pie","pie","rangePie"),t("donut","Donut","donut","rangeDonut")],_key:"rangePieChart"},{name:e("lineChart","Line"),subMenu:[t("lineChart","Line","line","rangeLineChart"),t("stackedLine","Stacked","stackedLine","rangeStackedLine"),t("normalizedLine","100% Stacked","normalizedLine","rangeNormalizedLine")],_key:"rangeLineChart"},{name:e("areaChart","Area"),subMenu:[t("areaChart","Area","area","rangeArea"),t("stackedArea","Stacked","stackedArea","rangeStackedArea"),t("normalizedArea","100% Stacked","normalizedArea","rangeNormalizedArea")],_key:"rangeAreaChart"},{name:e("xyChart","X Y (Scatter)"),subMenu:[t("scatter","Scatter","scatter","rangeScatter"),t("bubble","Bubble","bubble","rangeBubble")],_key:"rangeXYChart"},{name:e("polarChart","Polar"),subMenu:[t("radarLine","Radar Line","radarLine","rangeRadarLine"),t("radarArea","Radar Area","radarArea","rangeRadarArea"),t("nightingale","Nightingale","nightingale","rangeNightingale"),t("radialColumn","Radial Column","radialColumn","rangeRadialColumn"),t("radialBar","Radial Bar","radialBar","rangeRadialBar")],_key:"rangePolarChart",_enterprise:!0},{name:e("statisticalChart","Statistical"),subMenu:[t("boxPlot","Box Plot","boxPlot","rangeBoxPlot",!0),t("histogramChart","Histogram","histogram","rangeHistogram",!1),t("rangeBar","Range Bar","rangeBar","rangeRangeBar",!0),t("rangeArea","Range Area","rangeArea","rangeRangeArea",!0)],_key:"rangeStatisticalChart",_enterprise:!1},{name:e("hierarchicalChart","Hierarchical"),subMenu:[t("treemap","Treemap","treemap","rangeTreemap"),t("sunburst","Sunburst","sunburst","rangeSunburst")],_key:"rangeHierarchicalChart",_enterprise:!0},{name:e("specializedChart","Specialized"),subMenu:[t("heatmap","Heatmap","heatmap","rangeHeatmap"),t("waterfall","Waterfall","waterfall","rangeWaterfall")],_key:"rangeSpecializedChart",_enterprise:!0},{name:e("funnel","Funnel"),subMenu:[t("funnel","Funnel","funnel","rangeFunnel"),t("coneFunnel","Cone Funnel","coneFunnel","rangeConeFunnel"),t("pyramid","Pyramid","pyramid","rangePyramid")],_key:"rangeFunnel",_enterprise:!0},{name:e("combinationChart","Combination"),subMenu:[t("columnLineCombo","Column & Line","columnLineCombo","rangeColumnLineCombo"),t("AreaColumnCombo","Area & Column","areaColumnCombo","rangeAreaColumnCombo")],_key:"rangeCombinationChart"}],icon:(0,m._createIconNoSpan)("chart",this.beans,void 0)}}getConfigLookup(){return{columnGroup:{_key:"rangeColumnChart",column:"rangeGroupedColumn",stackedColumn:"rangeStackedColumn",normalizedColumn:"rangeNormalizedColumn"},barGroup:{_key:"rangeBarChart",bar:"rangeGroupedBar",stackedBar:"rangeStackedBar",normalizedBar:"rangeNormalizedBar"},pieGroup:{_key:"rangePieChart",pie:"rangePie",donut:"rangeDonut",doughnut:"rangeDonut"},lineGroup:{_key:"rangeLineChart",line:"rangeLineChart",stackedLine:"rangeStackedLine",normalizedLine:"rangeNormalizedLine"},areaGroup:{_key:"rangeAreaChart",area:"rangeArea",stackedArea:"rangeStackedArea",normalizedArea:"rangeNormalizedArea"},scatterGroup:{_key:"rangeXYChart",bubble:"rangeBubble",scatter:"rangeScatter"},polarGroup:{_key:"rangePolarChart",radarLine:"rangeRadarLine",radarArea:"rangeRadarArea",nightingale:"rangeNightingale",radialColumn:"rangeRadialColumn",radialBar:"rangeRadialBar"},statisticalGroup:{_key:"rangeStatisticalChart",boxPlot:"rangeBoxPlot",histogram:"rangeHistogram",rangeBar:"rangeRangeBar",rangeArea:"rangeRangeArea"},hierarchicalGroup:{_key:"rangeHierarchicalChart",treemap:"rangeTreemap",sunburst:"rangeSunburst"},specializedGroup:{_key:"rangeSpecializedChart",heatmap:"rangeHeatmap",waterfall:"rangeWaterfall"},funnelGroup:{_key:"rangeFunnel",funnel:"rangeFunnel",coneFunnel:"rangeConeFunnel",pyramid:"rangePyramid"},combinationGroup:{_key:"rangeCombinationChart",columnLineCombo:"rangeColumnLineCombo",areaColumnCombo:"rangeAreaColumnCombo",customCombo:null}}}},_K=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="colChooserFactory"}createColumnSelectPanel(e,t,i,s){var u;const n=e.createManagedBean(new jk),a=(u=s!=null?s:t==null?void 0:t.getColDef().columnChooserParams)!=null?u:{},{contractColumnSelection:r,suppressColumnExpandAll:o,suppressColumnFilter:l,suppressColumnSelectAll:c,suppressSyncLayoutWithGrid:h,columnLayout:d}=a;return n.init(!!i,(0,m._addGridCommonParams)(this.gos,{suppressColumnMove:!1,suppressValues:!1,suppressPivots:!1,suppressRowGroups:!1,suppressPivotMode:!1,contractColumnSelection:!!r,suppressColumnExpandAll:!!o,suppressColumnFilter:!!l,suppressColumnSelectAll:!!c,suppressSyncLayoutWithGrid:!!d||!!h,onStateUpdated:()=>{}}),"columnMenu"),d&&n.setColumnLayout(d),n}showColumnChooser({column:e,chooserParams:t,eventSource:i,headerPosition:s}){var u,p;this.hideActiveColumnChooser();const n=this.createColumnSelectPanel(this,e,!0,t),a=this.getLocaleTextFunc(),r=this.beans,{visibleCols:o,focusSvc:l,menuUtils:c}=r,h=o.allCols.indexOf(e),d=e&&(p=(u=l.focusedHeader)!=null?u:s)!=null?p:null;this.activeColumnChooserDialog=this.createBean(new jp({title:a("chooseColumns","Choose Columns"),component:n,width:300,height:300,resizable:!0,movable:!0,centered:!0,closable:!0,afterGuiAttached:()=>{var g;(g=(0,m._findNextFocusableElement)(r,n.getGui()))==null||g.focus({preventScroll:!0}),this.dispatchVisibleChangedEvent(!0,e)},closedCallback:g=>{const f=this.activeColumnChooser.getGui();this.destroyBean(this.activeColumnChooser),this.activeColumnChooser=void 0,this.activeColumnChooserDialog=void 0,this.dispatchVisibleChangedEvent(!1,e),e&&c.restoreFocusOnClose({column:e,headerPosition:d,columnIndex:h,eventSource:i},f,g,!0)},postProcessPopupParams:{type:"columnChooser",column:e,eventSource:i}})),this.activeColumnChooser=n}hideActiveColumnChooser(){this.destroyBean(this.activeColumnChooserDialog)}dispatchVisibleChangedEvent(e,t){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:"columnChooser",column:t!=null?t:null})}},GK={pinSubMenu:"PinnedColumn",pinLeft:"PinnedColumn",pinRight:"PinnedColumn",clearPinned:"PinnedColumn",pinRowSubMenu:"PinnedRow",pinBottom:"PinnedRow",pinTop:"PinnedRow",unpinRow:"PinnedRow",valueAggSubMenu:"SharedAggregation",autoSizeThis:"ColumnAutoSize",autoSizeAll:"ColumnAutoSize",rowGroup:"SharedRowGrouping",rowUnGroup:"SharedRowGrouping",resetColumns:"CommunityCore",expandAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],contractAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],copy:"Clipboard",copyWithHeaders:"Clipboard",copyWithGroupHeaders:"Clipboard",cut:"Clipboard",paste:"Clipboard",export:["CsvExport","ExcelExport"],csvExport:"CsvExport",excelExport:"ExcelExport",separator:"CommunityCore",pivotChart:"IntegratedCharts",chartRange:"IntegratedCharts",columnFilter:"ColumnFilter",columnChooser:"ColumnMenu",sortAscending:"Sort",sortDescending:"Sort",sortUnSort:"Sort"};function zK(e,t){const i=GK[t];i&&e.assertModuleRegistered(i,`menu item '${t}'`)}var Kc="separator";function Yk(e,t){if(e)for(let i=e.length-2;i>=0;i--){const s=e[i]===t,n=e[i+1]===t;s&&n&&e.splice(i+1,1)}}var VK=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="menuItemMapper"}mapWithStockItems(e,t,i,s,n){if(!e)return[];const a=[],r=this.getLocaleTextFunc(),{beans:o,gos:l}=this,{pinnedCols:c,colAutosize:h,aggFuncSvc:d,rowGroupColsSvc:u,colNames:p,colModel:g,clipboardSvc:f,expansionSvc:y,focusSvc:v,csvCreator:x,excelCreator:S,menuSvc:M,colChooserFactory:D,sortSvc:A,chartMenuItemMapper:w,valueColsSvc:T,pinnedRowModel:k}=o,N=(O,L,F,B)=>{var _,G,V;switch(zK(l,O),O){case"pinSubMenu":return c&&L?{name:r("pinColumn","Pin Column"),icon:(0,m._createIconNoSpan)("menuPin",o,null),subMenu:["clearPinned","pinLeft","pinRight"]}:null;case"pinLeft":return c&&L?{name:r("pinLeft","Pin Left"),action:()=>c.setColsPinned([L],"left",B),checked:!!L&&L.isPinnedLeft()}:null;case"pinRight":return c&&L?{name:r("pinRight","Pin Right"),action:()=>c.setColsPinned([L],"right",B),checked:!!L&&L.isPinnedRight()}:null;case"clearPinned":return c&&L?{name:r("noPin","No Pin"),action:()=>c.setColsPinned([L],null,B),checked:!!L&&!L.isPinned()}:null;case"pinRowSubMenu":{const j=l.get("enableRowPinning"),H=[],U=(G=i==null?void 0:i.rowPinned)!=null?G:(_=i==null?void 0:i.pinnedSibling)==null?void 0:_.rowPinned;return U&&H.push("unpinRow"),j&&j!=="bottom"&&U!="top"&&H.push("pinTop"),j&&j!=="top"&&U!="bottom"&&H.push("pinBottom"),k!=null&&k.isManual()?{name:r("pinRow","Pin Row"),icon:(0,m._createIconNoSpan)("rowPin",o,L),subMenu:H}:null}case"pinTop":return k!=null&&k.isManual()?{name:r("pinTop","Pin to Top"),icon:(0,m._createIconNoSpan)("rowPinTop",o,L),action:({node:j,column:H})=>j&&k.pinRow(j,"top",H)}:null;case"pinBottom":return k!=null&&k.isManual()?{name:r("pinBottom","Pin to Bottom"),icon:(0,m._createIconNoSpan)("rowPinBottom",o,L),action:({node:j,column:H})=>j&&k.pinRow(j,"bottom",H)}:null;case"unpinRow":return k!=null&&k.isManual()?{name:r("unpinRow","Unpin Row"),icon:(0,m._createIconNoSpan)("rowUnpin",o,L),action:({node:j,column:H})=>j&&k.pinRow(j,null,H)}:null;case"valueAggSubMenu":return d&&T&&(L!=null&&L.isPrimary()||L!=null&&L.getColDef().pivotValueColumn)?{name:r("valueAggregation","Value Aggregation"),icon:(0,m._createIconNoSpan)("menuValue",o,null),subMenu:jK(L,d,T,r),disabled:l.get("functionsReadOnly")}:null;case"autoSizeThis":return h?{name:r("autosizeThisColumn","Autosize This Column"),action:()=>h.autoSizeColumn(L,B,l.get("skipHeaderOnAutoSize"))}:null;case"autoSizeAll":return h?{name:r("autosizeAllColumns","Autosize All Columns"),action:()=>h.autoSizeAllColumns(B,l.get("skipHeaderOnAutoSize"))}:null;case"rowGroup":return u?{name:r("groupBy","Group by")+" "+p.getDisplayNameForColumn(L,"header"),disabled:l.get("functionsReadOnly")||(L==null?void 0:L.isRowGroupActive())||!(L!=null&&L.getColDef().enableRowGroup),action:()=>u.addColumns([L],B),icon:(0,m._createIconNoSpan)("menuAddRowGroup",o,null)}:null;case"rowUnGroup":if(u&&l.isModuleRegistered("SharedRowGrouping")){const j=L==null?void 0:L.getColDef().showRowGroup,H=l.get("groupLockGroupColumns");let U,$,W;if(j===!0)U=r("ungroupAll","Un-Group All"),$=l.get("functionsReadOnly")||H===-1||H>=((V=u.columns.length)!=null?V:0),W=()=>u.setColumns(u.columns.slice(0,H),B);else if(typeof j=="string"){const Y=g.getColDefCol(j),K=Y!=null?p.getDisplayNameForColumn(Y,"header"):j;U=r("ungroupBy","Un-Group by")+" "+K,$=l.get("functionsReadOnly")||Hp(Y,o),W=()=>{u.removeColumns([j],B)}}else U=r("ungroupBy","Un-Group by")+" "+p.getDisplayNameForColumn(L,"header"),$=l.get("functionsReadOnly")||!(L!=null&&L.isRowGroupActive())||!(L!=null&&L.getColDef().enableRowGroup)||Hp(L,o),W=()=>u.removeColumns([L],B);return{name:U,disabled:$,action:W,icon:(0,m._createIconNoSpan)("menuRemoveRowGroup",o,null)}}else return null;case"resetColumns":return{name:r("resetColumns","Reset Columns"),action:()=>(0,m._resetColumnState)(o,B)};case"expandAll":return y?{name:r("expandAll","Expand All Row Groups"),action:()=>y.expandAll(!0)}:null;case"contractAll":return y?{name:r("collapseAll","Collapse All Row Groups"),action:()=>y.expandAll(!1)}:null;case"copy":return f?{name:r("copy","Copy"),shortcut:r("ctrlC","Ctrl+C"),icon:(0,m._createIconNoSpan)("clipboardCopy",o,null),action:()=>f.copyToClipboard()}:null;case"copyWithHeaders":return f?{name:r("copyWithHeaders","Copy with Headers"),icon:(0,m._createIconNoSpan)("clipboardCopy",o,null),action:()=>f.copyToClipboard({includeHeaders:!0})}:null;case"copyWithGroupHeaders":return f?{name:r("copyWithGroupHeaders","Copy with Group Headers"),icon:(0,m._createIconNoSpan)("clipboardCopy",o,null),action:()=>f.copyToClipboard({includeHeaders:!0,includeGroupHeaders:!0})}:null;case"cut":if(f){const j=v.getFocusedCell(),H=j?(0,m._getRowNode)(o,j):null,U=H?j==null?void 0:j.column.isCellEditable(H):!1;return{name:r("cut","Cut"),shortcut:r("ctrlX","Ctrl+X"),icon:(0,m._createIconNoSpan)("clipboardCut",o,null),disabled:!U||l.get("suppressCutToClipboard"),action:()=>f.cutToClipboard(void 0,"contextMenu")}}else return null;case"paste":return f?{name:r("paste","Paste"),shortcut:r("ctrlV","Ctrl+V"),disabled:!0,icon:(0,m._createIconNoSpan)("clipboardPaste",o,null),action:()=>f.pasteFromClipboard()}:null;case"export":{const j=[];return!l.get("suppressCsvExport")&&x&&j.push("csvExport"),!l.get("suppressExcelExport")&&S&&j.push("excelExport"),j.length?{name:r("export","Export"),subMenu:j,icon:(0,m._createIconNoSpan)("save",o,null)}:null}case"csvExport":return x?{name:r("csvExport","CSV Export"),icon:(0,m._createIconNoSpan)("csvExport",o,null),action:()=>x.exportDataAsCsv()}:null;case"excelExport":return S?{name:r("excelExport","Excel Export"),icon:(0,m._createIconNoSpan)("excelExport",o,null),action:()=>S.exportDataAsExcel()}:null;case"separator":return O;case"pivotChart":case"chartRange":return w.getChartItems(O);case"columnFilter":return M&&L?{name:r("columnFilter","Column Filter"),icon:(0,m._createIconNoSpan)("filter",o,null),action:()=>M.showFilterMenu({column:L,buttonElement:F(),containerType:"columnFilter",positionBy:"button"})}:null;case"columnChooser":{const j=v.focusedHeader;return D?{name:r("columnChooser","Choose Columns"),icon:(0,m._createIconNoSpan)("columns",o,null),action:()=>D.showColumnChooser({column:L,eventSource:F(),headerPosition:j})}:null}case"sortAscending":return A?{name:r("sortAscending","Sort Ascending"),icon:(0,m._createIconNoSpan)("sortAscending",o,null),action:()=>A.setSortForColumn(L,"asc",!1,B)}:null;case"sortDescending":return A?{name:r("sortDescending","Sort Descending"),icon:(0,m._createIconNoSpan)("sortDescending",o,null),action:()=>A.setSortForColumn(L,"desc",!1,B)}:null;case"sortUnSort":return A?{name:r("sortUnSort","Clear Sort"),icon:(0,m._createIconNoSpan)("sortUnSort",o,null),action:()=>A.setSortForColumn(L,null,!1,B)}:null;default:return(0,m._warn)(176,{key:O}),null}};return e.forEach(O=>{let L;if(typeof O=="string"?L=N(O,t,s,n):L=b({},O),!L)return;const F=L,{subMenu:B}=F;B&&B instanceof Array&&(F.subMenu=this.mapWithStockItems(B,t,i,s,n)),L!=null&&a.push(L)}),Yk(a,Kc),a}};function jK(e,t,i,s){let n;if(e.isPrimary())n=e;else{const r=e.getColDef().pivotValueColumn;n=(0,m._exists)(r)?r:void 0}const a=[];if(n){const r=n.isValueActive(),o=t.getFuncNames(n);a.push({name:s("noAggregation","None"),action:()=>{i.removeColumns([n],"contextMenu"),i.setColumnAggFunc(n,void 0,"contextMenu")},checked:!r}),o.forEach(l=>{a.push({name:s(l,t.getDefaultFuncLabel(l)),action:()=>{i.setColumnAggFunc(n,l,"contextMenu"),i.addColumns([n],"contextMenu")},checked:r&&n.getAggFunc()===l})})}return a}var HK=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="colMenuFactory"}createMenu(e,t,i,s){const n=e.createManagedBean(new Wp(0,{column:i!=null?i:null,node:null,value:null})),a=this.beans.menuItemMapper.mapWithStockItems(t,i!=null?i:null,null,s,"columnMenu");return n.addMenuItems(a),n}getMenuItems(e=null,t=null){var a,r;const i=this.getDefaultMenuOptions(e);let s;const n=(r=(a=e==null?void 0:e.getColDef())!=null?a:t==null?void 0:t.getColGroupDef())==null?void 0:r.mainMenuItems;if(Array.isArray(n))s=n;else if(typeof n=="function")s=n((0,m._addGridCommonParams)(this.gos,{column:e,columnGroup:t,defaultItems:i}));else{const o=this.gos.getCallback("getMainMenuItems");o?s=o({column:e,columnGroup:t,defaultItems:i}):s=i}return Yk(s,Kc),s}getDefaultMenuOptions(e){var D;const t=[],{beans:i,gos:s}=this,{colChooserFactory:n,rowGroupColsSvc:a,colModel:r,expansionSvc:o,sortSvc:l,menuSvc:c,pinnedCols:h,aggFuncSvc:d,colAutosize:u}=i,p=(0,m._isLegacyMenuEnabled)(s),g=()=>{!p&&n&&t.push("columnChooser"),t.push("resetColumns")};if(!e)return g(),t;const{colDef:f}=e,y=h&&!f.lockPinned,v=(D=a==null?void 0:a.columns.length)!=null?D:0,x=v>0,S=e.isPrimary(),M=d&&S&&x&&e.isAllowValue()||!S;if(l&&!p&&e.isSortable()){const A=e.getSort();A!=="asc"&&t.push("sortAscending"),A!=="desc"&&t.push("sortDescending"),A&&t.push("sortUnSort"),t.push(Kc)}if(c!=null&&c.isFilterMenuItemEnabled(e)&&(t.push("columnFilter"),t.push(Kc)),y&&t.push("pinSubMenu"),M&&t.push("valueAggSubMenu"),(y||M)&&t.push(Kc),u&&(t.push("autoSizeThis"),t.push("autoSizeAll"),t.push(Kc)),a&&s.isModuleRegistered("SharedRowGrouping")){const A=t.length;f.showRowGroup?t.push("rowUnGroup"):e.isAllowRowGroup()&&S&&(e.isRowGroupActive()?Hp(e,i)||t.push("rowUnGroup"):t.push("rowGroup")),t.length>A&&t.push(Kc)}return g(),o&&(0,m._isClientSideRowModel)(s)&&(s.get("treeData")||v>(r.isPivotMode()?1:0))&&(t.push("expandAll"),t.push("contractAll")),t}},WK="ag-menu",Xk="ag-context-menu-open",UK="ag-context-menu-loading-icon",KK=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="contextMenuSvc",this.destroyLoadingSpinner=null,this.lastPromise=0}hideActiveMenu(){this.destroyBean(this.activeMenu)}getMenuItems(e,t,i,s){var f,y;const n=[],{clipboardSvc:a,chartSvc:r,csvCreator:o,excelCreator:l,colModel:c,rangeSvc:h,gos:d}=this.beans;if((0,m._exists)(e)&&a&&t&&(d.get("suppressCutToClipboard")||n.push("cut"),n.push("copy","copyWithHeaders","copyWithGroupHeaders","paste","separator")),d.get("enableCharts")&&r&&(c.isPivotMode()&&n.push("pivotChart"),h&&!h.isEmpty()&&n.push("chartRange")),(0,m._exists)(e)){const v=d.get("enableRowPinning"),x=d.get("isRowPinnable"),S=d.get("grandTotalRow");if(v){const T=e.level>-1&&e.footer,k=e.level===-1&&e.footer;(k&&!(S==="pinnedBottom"||S==="pinnedTop")||!k&&!T)&&((f=x==null?void 0:x(e))==null||f)&&n.push("pinRowSubMenu")}const M=d.get("suppressExcelExport")||!l,D=d.get("suppressCsvExport")||!o;!(0,m._isIOSUserAgent)()&&(!M||!D)&&n.push("export")}const u=n.length?n:void 0,p=t==null?void 0:t.getColDef().contextMenuItems;if(Array.isArray(p))return p;if(typeof p=="function")return p((0,m._addGridCommonParams)(d,{column:t,node:e,value:i,defaultItems:u,event:s}));const g=d.getCallback("getContextMenuItems");return(y=g==null?void 0:g({column:t,node:e,value:i,defaultItems:u,event:s}))!=null?y:n}getContextMenuPosition(e,t){var a;const i=this.getRowCtrl(e),s=this.getCellGui(i,t);if(!s)return{x:0,y:(a=i==null?void 0:i.getRowYPosition())!=null?a:0};const n=s.getBoundingClientRect();return{x:n.x+n.width/2,y:n.y+n.height/2}}showContextMenu(e){var r,o,l,c;const t=(r=e.rowNode)!=null?r:null,i=(o=e.column)!=null?o:null;let{anchorToElement:s,value:n,source:a}=e;t&&i&&n==null&&(n=this.beans.valueSvc.getValueForDisplay(i,t).value),s==null&&(s=this.getContextMenuAnchorElement(t,i)),this.beans.menuUtils.onContextMenu({mouseEvent:(l=e.mouseEvent)!=null?l:null,touchEvent:(c=e.touchEvent)!=null?c:null,showMenuCallback:h=>this.showMenu(t,i,n,h,s),source:a})}handleContextMenuMouseEvent(e,t,i,s){var d,u,p,g,f;const n=(u=(d=s==null?void 0:s.rowNode)!=null?d:i==null?void 0:i.rowNode)!=null?u:null,a=(f=(g=s==null?void 0:s.column)!=null?g:(p=i==null?void 0:i.findFullWidthInfoForEvent(e||t))==null?void 0:p.column)!=null?f:null,{valueSvc:r,ctrlsSvc:o}=this.beans,l=a?r.getValue(a,n):null,c=o.getGridBodyCtrl(),h=s?s.eGui:c.eGridBody;this.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:n,column:a,value:l,anchorToElement:h,source:"ui"})}showMenu(e,t,i,s,n){const a=this.getMenuItems(e,t,i,s);if((0,m._isPromise)(a)){const r=this.lastPromise+1;return this.lastPromise=r,this.destroyLoadingSpinner||this.createLoadingIcon(s),a.then(o=>{var d,u;if(this.lastPromise!==r)return;const{target:l}=s,c=!l;o&&o.length&&(c||(0,m._isVisible)(l))&&!((d=this.beans.overlays)!=null&&d.isExclusive())&&this.createContextMenu({menuItems:o,node:e,column:t,value:i,mouseEvent:s,anchorToElement:n}),(u=this.destroyLoadingSpinner)==null||u.call(this)}),!0}return a===void 0||!(a!=null&&a.length)?!1:(this.createContextMenu({menuItems:a,node:e,column:t,value:i,mouseEvent:s,anchorToElement:n}),!0)}createLoadingIcon(e){var l;const{beans:t}=this,i=this.getLocaleTextFunc(),s=(0,m._createIconNoSpan)("loadingMenuItems",t),n=(0,m._createElement)({tag:"div",cls:UK});n.appendChild(s);const a=(0,m._getRootNode)(t),r=(0,m._getPageBody)(t);if(!r){(0,m._warn)(54);return}r.appendChild(n),(l=t.ariaAnnounce)==null||l.announceValue(i("ariaLabelLoadingContextMenu","Loading Context Menu"),"contextmenu"),t.environment.applyThemeClasses(n),(0,m._anchorElementToMouseMoveEvent)(n,e,t);const o=c=>{(0,m._anchorElementToMouseMoveEvent)(n,c,t)};a.addEventListener("mousemove",o),this.destroyLoadingSpinner=()=>{a.removeEventListener("mousemove",o),r.removeChild(n),this.destroyLoadingSpinner=null}}createContextMenu(e){const{menuItems:t,node:i,column:s,value:n,mouseEvent:a,anchorToElement:r}=e,{ctrlsSvc:o,focusSvc:l,popupSvc:c}=this.beans,h=o.getGridBodyCtrl().eGridBody,d=new $K(t,s,i,n);this.createBean(d);const u=d.getGui();s||l.clearFocusedCell();const p={column:s,rowNode:i,type:"contextMenu",mouseEvent:a,ePopup:u,nudgeY:1},g=this.getLocaleTextFunc(),f=c==null?void 0:c.addPopup({modal:!0,eChild:u,closeOnEsc:!0,closedCallback:v=>{(0,m._preserveRangesWhile)(this.beans,()=>{h.classList.remove(Xk),this.destroyBean(d),this.dispatchVisibleChangedEvent(!1,v===void 0?"api":"ui")})},click:a,positionCallback:()=>{const v=this.gos.get("enableRtl");c==null||c.positionPopupUnderMouseEvent(E(b({},p),{nudgeX:v?(u.offsetWidth+1)*-1:1}))},anchorToElement:r,ariaLabel:g("ariaLabelContextMenu","Context Menu")});f&&(h.classList.add(Xk),d.afterGuiAttached({container:"contextMenu",hidePopup:f.hideFunc})),this.activeMenu&&this.hideActiveMenu(),this.activeMenu=d,d.addEventListener("destroyed",()=>{this.activeMenu===d&&(this.activeMenu=null)}),f&&d.addEventListener("closeMenu",v=>{var x,S;return f.hideFunc({mouseEvent:(x=v.mouseEvent)!=null?x:void 0,keyboardEvent:(S=v.keyboardEvent)!=null?S:void 0,forceHide:!0})});const y=a&&a instanceof MouseEvent&&a.type==="mousedown";this.dispatchVisibleChangedEvent(!0,y?"api":"ui")}dispatchVisibleChangedEvent(e,t="ui"){this.eventSvc.dispatchEvent({type:"contextMenuVisibleChanged",visible:e,source:t})}getRowCtrl(e){const{rowIndex:t,rowPinned:i}=e||{};if(t!=null)return this.beans.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i})||void 0}getCellGui(e,t){if(!e||!t)return;const i=e.getCellCtrl(t);return(i==null?void 0:i.eGui)||void 0}getContextMenuAnchorElement(e,t){const i=this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody,s=this.getRowCtrl(e);if(!s)return i;const n=this.getCellGui(s,t);return n||(s.isFullWidth()?s.getFullWidthElement():i)}destroy(){var e;(e=this.destroyLoadingSpinner)==null||e.call(this),super.destroy()}},$K=class extends m.Component{constructor(e,t,i,s){super({tag:"div",cls:WK,role:"presentation"}),this.menuItems=e,this.column=t,this.node=i,this.value=s,this.menuList=null,this.focusedCell=null}postConstruct(){const e=this.createManagedBean(new Wp(0,{column:this.column,node:this.node,value:this.value})),t=this.beans.menuItemMapper.mapWithStockItems(this.menuItems,this.column,this.node,()=>this.getGui(),"contextMenu");e.addMenuItems(t),this.appendChild(e),this.menuList=e,e.addEventListener("closeMenu",i=>this.dispatchLocalEvent(i))}afterGuiAttached({hidePopup:e}){e&&this.addDestroyFunc(e),this.focusedCell=this.beans.focusSvc.getFocusedCell();const t=this.menuList;t&&(0,m._preserveRangesWhile)(this.beans,()=>(0,m._focusInto)(t.getGui()))}restoreFocusedCell(){const{beans:e,focusedCell:t}=this,i=e.focusSvc,s=i.getFocusedCell();if(s&&t&&(0,m._areCellsEqual)(s,t)){const{rowIndex:n,rowPinned:a,column:r}=t;(0,m._isNothingFocused)(e)&&i.setFocusedCell({rowIndex:n,column:r,rowPinned:a,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!(0,m._isKeyboardMode)()})}}destroy(){super.destroy(),this.restoreFocusedCell()}};function YK(e){return{tag:"div",cls:`ag-tabs ${e}`,children:[{tag:"div",ref:"eHeader"},{tag:"div",ref:"eBody",role:"presentation",cls:`ag-tabs-body ${e?`${e}-body`:""}`}]}}var Zk=class extends m.TabGuardComp{constructor(e){super(YK(e.cssClass)),this.eHeader=m.RefPlaceholder,this.eBody=m.RefPlaceholder,this.items=[],this.tabbedItemScrollMap=new Map,this.params=e}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(e=>this.addItem(e)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>{var e,t,i;return(i=(t=(e=this.activeItem)==null?void 0:e.tabbedItem)==null?void 0:t.afterDetachedCallback)==null?void 0:i.call(t)})}setupHeader(){const{enableCloseButton:e,cssClass:t}=this.params,i=(s,n)=>{s.classList.add(`ag-tabs-${n}`),t&&s.classList.add(`${t}-${n}`)};e?(this.setupCloseButton(i),this.eTabHeader=(0,m._createElement)({tag:"div",role:"presentation"}),i(this.eHeader,"header-wrapper"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,(0,m._setAriaRole)(this.eTabHeader,"tablist"),i(this.eTabHeader,"header")}setupCloseButton(e){const t=(0,m._createElement)({tag:"button"});e(t,"close-button");const i=(0,m._createIconNoSpan)("close",this.beans);(0,m._setAriaLabel)(t,this.params.closeButtonAriaLabel),t.appendChild(i),this.addManagedElementListeners(t,{click:()=>{var n,a;return(a=(n=this.params).onCloseClicked)==null?void 0:a.call(n)}});const s=(0,m._createElement)({tag:"div",role:"presentation"});e(s,"close-button-wrapper"),s.appendChild(t),this.eHeader.appendChild(s),this.eCloseButton=t}handleKeyDown(e){switch(e.key){case m.KeyCode.RIGHT:case m.KeyCode.LEFT:{if(!this.eTabHeader.contains((0,m._getActiveDomElement)(this.beans)))return;const t=e.key===m.KeyCode.RIGHT,i=this.gos.get("enableRtl"),s=this.items.indexOf(this.activeItem),n=t!==i?Math.min(s+1,this.items.length-1):Math.max(s-1,0);if(s===n)return;e.preventDefault();const a=this.items[n];this.showItemWrapper(a),a.eHeaderButton.focus();break}case m.KeyCode.UP:case m.KeyCode.DOWN:e.stopPropagation();break}}onTabKeyDown(e){var u,p,g,f;if(e.defaultPrevented)return;const{beans:t,eHeader:i,eBody:s,activeItem:n,params:a}=this,{suppressTrapFocus:r,enableCloseButton:o}=a,l=(0,m._getActiveDomElement)(t),c=e.target,h=e.shiftKey;if(i.contains(l)){e.preventDefault(),o&&h&&!((u=this.eCloseButton)!=null&&u.contains(l))?(p=this.eCloseButton)==null||p.focus():r&&h?(g=pS((0,m._getDocument)(t).body,c))==null||g.focus():this.focusBody(e.shiftKey);return}let d=null;if(wk(s,c)&&(h&&(d=pS(s,c)),!d&&!r&&(d=n.eHeaderButton)),!d&&s.contains(l)&&(d=(0,m._findNextFocusableElement)(t,s,!1,h),!d)){r&&!h?this.forceFocusOutOfContainer(h):o&&!h?(e.preventDefault(),(f=this.eCloseButton)==null||f.focus()):(e.preventDefault(),this.focusHeader());return}d&&(e.preventDefault(),d.focus())}focusInnerElement(e){return e?this.focusBody(!0):(this.focusHeader(),!0)}focusHeader(e){this.activeItem.eHeaderButton.focus({preventScroll:e})}focusBody(e){return(0,m._focusInto)(this.eBody,e)}setAfterAttachedParams(e){this.afterAttachedParams=e}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(e){const t=(0,m._createElement)({tag:"span",cls:"ag-tab",role:"tab",attrs:{tabindex:"-1"}});t.appendChild(e.title),this.eTabHeader.appendChild(t),(0,m._setAriaLabel)(t,e.titleLabel);const i={tabbedItem:e,eHeaderButton:t};this.items.push(i),t.addEventListener("click",this.showItemWrapper.bind(this,i))}showItem(e){const t=this.items.find(i=>i.tabbedItem===e);t&&this.showItemWrapper(t)}showItemWrapper(e){var s,n,a,r,o,l;const{tabbedItem:t,eHeaderButton:i}=e;if((n=(s=this.params).onItemClicked)==null||n.call(s,{item:t}),this.activeItem===e){(r=(a=this.params).onActiveItemClicked)==null||r.call(a);return}this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),(0,m._clearElement)(this.eBody),t.bodyPromise.then(c=>{this.eBody.appendChild(c);const h=!(0,m._isKeyboardMode)();if(this.params.suppressFocusBodyOnOpen||(0,m._focusInto)(this.eBody,!1,h),t.afterAttachedCallback&&t.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const d=t.getScrollableContainer&&t.getScrollableContainer()||c;[this.lastScrollListener]=this.addManagedElementListeners(d,{scroll:()=>{this.tabbedItemScrollMap.set(t.name,d.scrollTop)}});const u=this.tabbedItemScrollMap.get(t.name);u!==void 0&&setTimeout(()=>{d.scrollTop=u},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),(l=(o=this.activeItem.tabbedItem).afterDetachedCallback)==null||l.call(o)),i.classList.add("ag-tab-selected"),this.activeItem=e}},xl="filterMenuTab",Cl="generalMenuTab",$c="columnsMenuTab",jm=[Cl,xl,$c],XK=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="enterpriseMenuFactory"}hideActiveMenu(){this.destroyBean(this.activeMenu)}showMenuAfterMouseEvent(e,t,i,s,n){const{column:a,columnGroup:r}=this.splitColumnOrGroup(e),o=n?"filterMenuTab":void 0;this.showMenu(a,r,l=>{var h;const c=l.getGui();this.beans.popupSvc.positionPopupUnderMouseEvent({type:i,column:a,mouseEvent:t,ePopup:c}),o&&((h=l.showTab)==null||h.call(l,o)),this.dispatchVisibleChangedEvent(!0,!1,a,r,o)},i,o,void 0,t.target,s)}splitColumnOrGroup(e){const t=e&&(0,m.isColumn)(e);return{column:t?e:void 0,columnGroup:t?void 0:e}}showMenuAfterButtonClick(e,t,i,s,n){let a=-1,r="left";this.gos.get("enableRtl")&&(a=1,r="right");const o=n?"filterMenuTab":void 0,l=o?[o]:void 0,c=(0,m._isLegacyMenuEnabled)(this.gos),h=(c?9:4)*a,d=c?-23:4,{column:u,columnGroup:p}=this.splitColumnOrGroup(e);this.showMenu(u,p,g=>{var y;const f=g.getGui();this.beans.popupSvc.positionPopupByComponent({type:i,column:u,eventSource:t,ePopup:f,alignSide:r,nudgeX:h,nudgeY:d,position:"under",keepWithinBounds:!0}),o&&((y=g.showTab)==null||y.call(g,o)),this.dispatchVisibleChangedEvent(!0,!1,u,p,o)},i,o,l,t,s)}showMenu(e,t,i,s,n,a,r,o){var v;const l=this.getMenuParams(e,t,a,r);if(!l)return;const{menu:c,eMenuGui:h,anchorToElement:d,restoreFocusParams:u}=l,p=[],{menuUtils:g,popupSvc:f}=this.beans;p.push(x=>{const S=c.getGui();this.destroyBean(c),e&&((0,m._setColMenuVisible)(e,!1,"contextMenu"),g.restoreFocusOnClose(u,S,x)),o==null||o()});const y=this.getLocaleTextFunc();if(f.addPopup({modal:!0,eChild:h,closeOnEsc:!0,closedCallback:x=>{p.forEach(S=>S(x)),this.dispatchVisibleChangedEvent(!1,!1,e,t,n)},afterGuiAttached:x=>c.afterGuiAttached(Object.assign({},{container:s},x)),positionCallback:n?()=>i(c):void 0,ariaLabel:y("ariaLabelColumnMenu","Column Menu")}),n||((v=c.showTabBasedOnPreviousSelection)==null||v.call(c),i(c)),(0,m._isColumnMenuAnchoringEnabled)(this.gos)){const x=f.setPopupPositionRelatedToElement(h,d);x&&e&&this.addStopAnchoring(x,e,p)}c.addEventListener("tabSelected",x=>{this.dispatchVisibleChangedEvent(!1,!0,e),this.lastSelectedTab=x.key,this.dispatchVisibleChangedEvent(!0,!0,e)}),e&&(0,m._setColMenuVisible)(e,!0,"contextMenu"),this.activeMenu=c,c.addEventListener("destroyed",()=>{this.activeMenu===c&&(this.activeMenu=null)})}addStopAnchoring(e,t,i){e.then(s=>{t.__addEventListener("leftChanged",s),t.__addEventListener("visibleChanged",s),i.push(()=>{t.__removeEventListener("leftChanged",s),t.__removeEventListener("visibleChanged",s)})})}getMenuParams(e,t,i,s){const{focusSvc:n,visibleCols:a,ctrlsSvc:r}=this.beans,o={column:e,headerPosition:n.focusedHeader,columnIndex:a.allCols.indexOf(e),eventSource:s},l=this.createMenu(e,t,o,i,s);return l?{menu:l,eMenuGui:l.getGui(),anchorToElement:s||r.getGridBodyCtrl().eGridBody,restoreFocusParams:o}:void 0}createMenu(e,t,i,s,n){if((0,m._isLegacyMenuEnabled)(this.gos))return this.createBean(new ZK(e,i,this.lastSelectedTab,s,n));{const a=this.beans.colMenuFactory.getMenuItems(e,t);return a.length?this.createBean(new qK(a,e,i,n)):void 0}}dispatchVisibleChangedEvent(e,t,i,s,n){var a,r;this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:t,key:(r=(a=this.lastSelectedTab)!=null?a:n)!=null?r:(0,m._isLegacyMenuEnabled)(this.gos)?Cl:"columnMenu",column:i!=null?i:null,columnGroup:s!=null?s:null})}isMenuEnabled(e){var n,a;if(!(0,m._isLegacyMenuEnabled)(this.gos))return!0;const t=!((n=this.beans.filterManager)!=null&&n.isFilterAllowed(e)),i=(a=e.getColDef().menuTabs)!=null?a:jm;return(t&&i.includes(xl)?i.length-1:i.length)>0}showMenuAfterContextMenuEvent(e,t,i){this.beans.menuUtils.onContextMenu({mouseEvent:t,touchEvent:i,source:"ui",showMenuCallback:s=>(this.showMenuAfterMouseEvent(e,s,"columnMenu"),!0)})}},ZK=class extends m.BeanStub{constructor(e,t,i,s,n){super(),this.column=e,this.restoreFocusParams=t,this.initialSelection=i,this.restrictTo=s,this.sourceElement=n,this.tabFactories={},this.includeChecks={};const{tabFactories:a,includeChecks:r}=this;a[Cl]=this.createMainPanel.bind(this),a[xl]=this.createFilterPanel.bind(this),a[$c]=this.createColumnsPanel.bind(this),r[Cl]=()=>!0,r[xl]=()=>{var o;return e?!!((o=this.beans.filterManager)!=null&&o.isFilterAllowed(e)):!1},r[$c]=()=>!0}postConstruct(){var i;const e=this.getTabsToCreate().map(s=>this.createTab(s)),t=new Zk({items:e,cssClass:"ag-menu",onActiveItemClicked:this.onHidePopup.bind(this),onItemClicked:this.onTabItemClicked.bind(this)});this.tabbedLayout=this.createBean(t),(i=this.mainMenuList)==null||i.setParentComponent(t),this.addDestroyFunc(()=>this.destroyBean(t))}getTabsToCreate(){var e,t;return this.restrictTo?this.restrictTo:((t=(e=this.column)==null?void 0:e.getColDef().menuTabs)!=null?t:jm).filter(i=>this.isValidMenuTabItem(i)&&this.isNotSuppressed(i))}isValidMenuTabItem(e){let t=!0,i=jm;return this.restrictTo!=null&&(t=this.restrictTo.indexOf(e)>-1,i=this.restrictTo),t=t&&jm.indexOf(e)>-1,t||(0,m._warn)(175,{menuTabName:e,itemsToConsider:i}),t}isNotSuppressed(e){return this.includeChecks[e]()}createTab(e){return this.tabFactories[e]()}showTabBasedOnPreviousSelection(){this.showTab(this.initialSelection)}showTab(e){const{tabItemColumns:t,tabbedLayout:i,tabItemFilter:s,tabItemGeneral:n}=this;t&&e===$c?i.showItem(t):s&&e===xl?i.showItem(s):n&&e===Cl?i.showItem(n):i.showFirstItem()}onTabItemClicked(e){let t=null;switch(e.item){case this.tabItemColumns:t=$c;break;case this.tabItemFilter:t=xl;break;case this.tabItemGeneral:t=Cl;break}t&&this.activateTab(t)}activateTab(e){const t={type:"tabSelected",key:e};this.dispatchLocalEvent(t)}createMainPanel(){const{beans:e,column:t}=this,i=e.colMenuFactory,s=i.createMenu(this,i.getMenuItems(t),this.column,()=>{var a;return(a=this.sourceElement)!=null?a:this.getGui()});this.mainMenuList=s,s.addEventListener("closeMenu",this.onHidePopup.bind(this));const n={title:(0,m._createIconNoSpan)("legacyMenu",e,t),titleLabel:Cl.replace("MenuTab",""),bodyPromise:m.AgPromise.resolve(s.getGui()),name:Cl};return this.tabItemGeneral=n,n}onHidePopup(e){this.beans.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}createFilterPanel(){const e=this.column?this.createBean(new m.FilterWrapperComp(this.column,"COLUMN_MENU")):null;this.filterComp=e,e!=null&&e.hasFilter()||(0,m._error)(119);const t=s=>e==null?void 0:e.afterGuiAttached(s),i=()=>e==null?void 0:e.afterGuiDetached();return this.tabItemFilter={title:(0,m._createIconNoSpan)("filterTab",this.beans,this.column),titleLabel:xl.replace("MenuTab",""),bodyPromise:m.AgPromise.resolve(e==null?void 0:e.getGui()),afterAttachedCallback:t,afterDetachedCallback:i,name:xl},this.tabItemFilter}createColumnsPanel(){const e=(0,m._createElement)({tag:"div",cls:"ag-menu-column-select-wrapper"}),{beans:t,column:i}=this,n=t.colChooserFactory.createColumnSelectPanel(this,i).getGui();n.classList.add("ag-menu-column-select"),e.appendChild(n);const a={title:(0,m._createIconNoSpan)("columns",t,i),titleLabel:$c.replace("MenuTab",""),bodyPromise:m.AgPromise.resolve(e),name:$c};return this.tabItemColumns=a,a}afterGuiAttached(e){const{container:t,hidePopup:i}=e;this.tabbedLayout.setAfterAttachedParams({container:t,hidePopup:i}),i&&(this.hidePopupFunc=i,this.addDestroyFunc(i))}getGui(){return this.tabbedLayout.getGui()}destroy(){super.destroy(),this.destroyBean(this.filterComp)}},qK=class extends m.Component{constructor(e,t,i,s){super({tag:"div",ref:"eColumnMenu",cls:"ag-menu ag-column-menu",role:"presentation"}),this.menuItems=e,this.column=t,this.restoreFocusParams=i,this.sourceElement=s,this.eColumnMenu=m.RefPlaceholder}postConstruct(){const e=this.beans.colMenuFactory.createMenu(this,this.menuItems,this.column,()=>{var t;return(t=this.sourceElement)!=null?t:this.getGui()});this.mainMenuList=e,e.addEventListener("closeMenu",this.onHidePopup.bind(this)),this.eColumnMenu.appendChild(e.getGui())}onHidePopup(e){this.beans.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}afterGuiAttached({hidePopup:e}){e&&(this.hidePopupFunc=e,this.addDestroyFunc(e)),(0,m._focusInto)(this.mainMenuList.getGui())}};function QK(e,t){const{contextMenuSvc:i}=e;if(!i)return;const{rowNode:s,column:n,value:a,x:r,y:o}=t||{};let{x:l,y:c}=i.getContextMenuPosition(s,n);r!=null&&(l=r),o!=null&&(c=o),i.showContextMenu({mouseEvent:new MouseEvent("mousedown",{clientX:l,clientY:c}),rowNode:s,column:n,value:a,source:"api"})}function JK(e,t){var i;(i=e.colChooserFactory)==null||i.showColumnChooser({chooserParams:t})}function e$(e){var t;(t=e.colChooserFactory)==null||t.hideActiveColumnChooser()}var t$=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="menuUtils"}restoreFocusOnClose(e,t,i,s){const{eventSource:n}=e,a=i instanceof KeyboardEvent;if(!s&&!a||!n)return;const r=(0,m._getActiveDomElement)(this.beans);!t.contains(r)&&!(0,m._isNothingFocused)(this.beans)||this.focusHeaderCell(e)}closePopupAndRestoreFocusOnSelect(e,t,i){let s;i&&i.keyboardEvent&&(s=i.keyboardEvent),e(s&&{keyboardEvent:s});const n=this.beans,a=n.focusSvc,r=a.getFocusedCell();if((0,m._isNothingFocused)(n))if(r){const{rowIndex:o,rowPinned:l,column:c}=r;a.setFocusedCell({rowIndex:o,column:c,rowPinned:l,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}else this.focusHeaderCell(t)}onContextMenu(e){const{mouseEvent:t,touchEvent:i,showMenuCallback:s,source:n}=e;if(!this.gos.get("allowContextMenuWithControlKey")&&t&&(t.ctrlKey||t.metaKey)||(t&&this.blockMiddleClickScrollsIfNeeded(t),n==="ui"&&this.gos.get("suppressContextMenu")))return;const a=t!=null?t:i.touches[0];if(s(a)){const r=t!=null?t:i;r&&r.cancelable&&r.preventDefault()}}async focusHeaderCell(e){const{column:t,columnIndex:i,headerPosition:s,eventSource:n}=e,{visibleCols:a,headerNavigation:r,focusSvc:o}=this.beans,l=await a.allCols.some(c=>c===t);if(this.isAlive()){if(t!=null&&t.isAlive()&&l&&n&&(0,m._isVisible)(n)){const c=(0,m._findTabbableParent)(n);c&&(r==null||r.scrollToColumn(t),c.focus())}else if(s&&i!==-1){const c=a.allCols,h=c[i]||(0,m._last)(c);h&&o.focusHeaderPosition({headerPosition:{headerRowIndex:s.headerRowIndex,column:h}})}}}blockMiddleClickScrollsIfNeeded(e){this.gos.get("suppressMiddleClickScrolls")&&e.which===2&&e.preventDefault()}},qk={moduleName:"MenuCore",version:Re,beans:[VK,OK,t$],icons:{chart:"chart",columns:"columns",loadingMenuItems:"loading",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",save:"save",csvExport:"csv",excelExport:"excel",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"},dependsOn:[St,m._PopupModule,m._SharedMenuModule,Vm]},Qk={moduleName:"ColumnMenu",version:Re,beans:[XK,HK,_K],icons:{ensureColumnVisible:"column-arrow",legacyMenu:"menu",filterTab:"filter",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate"},apiFunctions:{showColumnChooser:JK,hideColumnChooser:e$},dependsOn:[qk,m._SharedDragAndDropModule,m._ColumnMoveModule]},Jk={moduleName:"ContextMenu",version:Re,beans:[KK],apiFunctions:{showContextMenu:QK},dependsOn:[qk]},sIe={moduleName:"Menu",version:Re,dependsOn:[Qk,Jk]},eL=class extends m.PopupComponent{constructor(){super({tag:"div",cls:"ag-cell-edit-wrapper"}),this.isAsync=!1}init(e){this.params=e;const{cellStartedEdit:t,values:i,eventKey:s}=e;(0,m._missing)(i)&&(0,m._warn)(180);const{params:n,valuesPromise:a}=this.buildRichSelectParams(),r=this.createManagedBean(new dS(n));this.richSelect=r,r.addCss("ag-cell-editor"),this.appendChild(r),a&&(this.isAsync=!0,a.then(o=>{r.setValueList({valueList:o,refresh:!0});const l=this.getSearchStringCallback(o);l&&r.setSearchStringCreator(l),this.processEventKey(s)})),this.addManagedListeners(r,{fieldPickerValueSelected:this.onEditorPickerValueSelected.bind(this)}),this.focusAfterAttached=t}onEditorPickerValueSelected(e){setTimeout(()=>this.params.stopEditing(!e.fromEnterKey))}buildRichSelectParams(){const e=this.params,{cellRenderer:t,cellHeight:i,value:s,values:n,formatValue:a,searchDebounceDelay:r,valueListGap:o,valueListMaxHeight:l,valueListMaxWidth:c,allowTyping:h,filterList:d,searchType:u,highlightMatch:p,valuePlaceholder:g,eventKey:f,multiSelect:y,suppressDeselectAll:v,suppressMultiSelectPillRenderer:x}=e,S={value:s,cellRenderer:t,cellRowHeight:i,searchDebounceDelay:r,valueFormatter:a,pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"virtual-list",pickerGap:o,allowTyping:h,filterList:d,searchType:u,highlightMatch:p,maxPickerHeight:l,maxPickerWidth:c,placeholder:g,initialInputValue:(f==null?void 0:f.length)===1?f:void 0,multiSelect:y,suppressDeselectAll:v,suppressMultiSelectPillRenderer:x};let M,D;return typeof n=="function"?M=n(e):M=n!=null?n:[],Array.isArray(M)?(S.valueList=M,S.searchStringCreator=this.getSearchStringCallback(M)):D=M,y&&h&&(e.allowTyping=S.allowTyping=!1,(0,m._warn)(181)),{params:S,valuesPromise:D}}getSearchStringCallback(e){var a;if(typeof e[0]!="object")return;const t=this.params,{colDef:i,formatValue:s}=t;if((a=i.cellEditorParams)!=null&&a.formatValue)return r=>r.map(s);const{keyCreator:n}=i;if(n){(0,m._warn)(266);const{column:r,node:o,data:l}=t;return c=>c.map(h=>{const d=(0,m._addGridCommonParams)(this.gos,{value:h,colDef:i,column:r,node:o,data:l});return n(d)})}return r=>r.map(s)}afterGuiAttached(){const{focusAfterAttached:e,params:t}=this;setTimeout(()=>{if(!this.isAlive())return;const i=this.richSelect,{allowTyping:s,eventKey:n}=t;if(e){const a=i.getFocusableElement();a.focus(),s&&(!n||n.length!==1)&&a.select()}i.showPicker(),this.isAsync||this.processEventKey(n)})}processEventKey(e){e&&(e==null?void 0:e.length)===1&&this.richSelect.searchTextFromString(e)}focusIn(){this.richSelect.getFocusableElement().focus()}getValue(){var i,s;const{params:e}=this,t=this.richSelect.getValue();return(s=(i=e.parseValue)==null?void 0:i.call(e,t))!=null?s:t}isPopup(){return!1}},i$={moduleName:"RichSelect",version:Re,beans:[],userComponents:{agRichSelect:eL,agRichSelectCellEditor:eL},icons:{richSelectOpen:"small-down",richSelectRemove:"cancel"},dependsOn:[St,m._EditCoreModule]},Yc="__AG_SELECT_ALL__",Xc="__AG_ADD_SELECTION_TO_FILTER__",s$={loadingOoo:"Loading...",blanks:"(Blanks)",searchOoo:"Search...",selectAll:"(Select All)",selectAllSearchResults:"(Select All Search Results)",addCurrentSelectionToFilter:"Add current selection to filter",noMatches:"No matches."},n$={tag:"div",cls:"ag-set-filter-item",attrs:{"aria-hidden":"true"},children:[{tag:"span",cls:"ag-set-filter-group-icons",children:[{tag:"span",ref:"eGroupClosedIcon",cls:"ag-set-filter-group-closed-icon"},{tag:"span",ref:"eGroupOpenedIcon",cls:"ag-set-filter-group-opened-icon"},{tag:"span",ref:"eGroupIndeterminateIcon",cls:"ag-set-filter-group-indeterminate-icon"}]},{tag:"ag-checkbox",ref:"eCheckbox",cls:"ag-set-filter-item-checkbox"}]},a$={tag:"div",cls:"ag-set-filter-item",children:[{tag:"ag-checkbox",ref:"eCheckbox",cls:"ag-set-filter-item-checkbox"}]},r$=class extends m.Component{constructor(e){var t;super(e.isGroup?n$:a$,[m.AgCheckboxSelector]),this.eCheckbox=m.RefPlaceholder,this.eGroupOpenedIcon=m.RefPlaceholder,this.eGroupClosedIcon=m.RefPlaceholder,this.eGroupIndeterminateIcon=m.RefPlaceholder,this.formattedValue=null,this.focusWrapper=e.focusWrapper,this.value=e.value,this.params=e.params,this.translate=e.translate,this.valueFormatter=e.valueFormatter,this.item=e.item,this.isSelected=e.isSelected,this.isTree=e.isTree,this.depth=(t=e.depth)!=null?t:0,this.isGroup=e.isGroup,this.groupsExist=e.groupsExist,this.isExpanded=e.isExpanded,this.hasIndeterminateExpandState=e.hasIndeterminateExpandState}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),getColDef:()=>this.params.colDef,getColumn:()=>this.params.column,getLocation:()=>"setFilterValue",shouldDisplayTooltip:()=>{var e,t;return(t=(e=this.shouldDisplayTooltip)==null?void 0:e.call(this))!=null?t:!0},getValueFormatted:()=>this.formattedValue,getAdditionalParams:()=>this.isTree?{level:this.depth}:{}})),this.addDestroyFunc(()=>{var e;return(e=this.destroyCellRendererComponent)==null?void 0:e.call(this)}),this.render(),this.eCheckbox.setLabelEllipsis(!0).setValue(this.isSelected,!0).setDisabled(!!this.params.readOnly).getInputElement().setAttribute("tabindex","-1"),this.refreshVariableAriaLabels(),this.isTree&&(this.depth>0&&(this.addCss("ag-set-filter-indent-"+this.depth),this.getGui().style.setProperty("--ag-indentation-level",String(this.depth))),this.isGroup?this.setupExpansion():this.groupsExist&&this.addCss("ag-set-filter-add-group-indent"),(0,m._setAriaLevel)(this.getAriaElement(),this.depth+1)),this.refreshAriaChecked(),!this.params.readOnly&&this.eCheckbox.onValueChange(e=>this.onCheckboxChanged(!!e))}getFocusableElement(){return this.focusWrapper}setupExpansion(){const{eGroupClosedIcon:e,eGroupOpenedIcon:t,eGroupIndeterminateIcon:i,hasIndeterminateExpandState:s,beans:n}=this;e.appendChild((0,m._createIcon)("setFilterGroupClosed",n,null)),t.appendChild((0,m._createIcon)("setFilterGroupOpen",n,null));const a=this.onExpandOrContractClicked.bind(this);this.addManagedElementListeners(e,{click:a}),this.addManagedElementListeners(t,{click:a}),s&&(i.appendChild((0,m._createIcon)("setFilterGroupIndeterminate",n,null)),this.addManagedElementListeners(i,{click:a})),this.setExpandedIcons(),this.refreshAriaExpanded()}onExpandOrContractClicked(){this.setExpanded(!this.isExpanded)}setExpanded(e,t){if(this.isGroup&&e!==this.isExpanded){this.isExpanded=e;const i={type:"expandedChanged",isExpanded:!!e,item:this.item};t||this.dispatchLocalEvent(i),this.setExpandedIcons(),this.refreshAriaExpanded()}}setExpandedIcons(){const{isExpanded:e,hasIndeterminateExpandState:t,eGroupClosedIcon:i,eGroupOpenedIcon:s,eGroupIndeterminateIcon:n}=this;(0,m._setDisplayed)(i,t?e===!1:!e),(0,m._setDisplayed)(s,e===!0),t&&(0,m._setDisplayed)(n,e===void 0)}onCheckboxChanged(e){this.isSelected=e;const t={type:"selectionChanged",isSelected:e,item:this.item};this.dispatchLocalEvent(t),this.refreshVariableAriaLabels(),this.refreshAriaChecked()}toggleSelected(){this.params.readOnly||this.setSelected(!this.isSelected)}setSelected(e,t){this.isSelected=e,this.eCheckbox.setValue(e,t),this.refreshAriaChecked()}refreshVariableAriaLabels(){if(!this.isTree)return;const e=this.getLocaleTextFunc(),t=this.eCheckbox.getValue(),i=t===void 0?e("ariaIndeterminate","indeterminate"):t?e("ariaVisible","visible"):e("ariaHidden","hidden"),s=e("ariaToggleVisibility","Press SPACE to toggle visibility");(0,m._setAriaLabelledBy)(this.eCheckbox.getInputElement(),void 0),this.eCheckbox.setInputAriaLabel(`${s} (${i})`)}setupFixedAriaLabels(e){if(!this.isTree)return;const i=this.getLocaleTextFunc()("ariaFilterValue","Filter Value"),s=this.getAriaElement();(0,m._setAriaLabel)(s,`${e} ${i}`),(0,m._setAriaDescribedBy)(s,this.eCheckbox.getInputElement().id)}refreshAriaChecked(){const e=this.getAriaElement();(0,m._setAriaChecked)(e,this.eCheckbox.getValue())}refreshAriaExpanded(){(0,m._setAriaExpanded)(this.getAriaElement(),!!this.isExpanded)}refresh(e,t,i){var o,l;this.item=e,t!==this.isSelected&&this.setSelected(t,!0),this.setExpanded(i,!0);const{cellRendererComponent:s,cellRendererParams:n,beans:a,params:r}=this;if(this.valueFunction){const c=this.valueFunction();this.setTooltipAndCellRendererParams(c,c),s||this.renderCellWithoutCellRenderer()}if(s){const c=(0,m._getCellRendererDetails)(a.userCompFactory,r,n);if(!((l=s.refresh)==null?void 0:l.call(s,(o=c==null?void 0:c.params)!=null?o:n))){const d=s;this.renderCell(),this.destroyBean(d)}}}render(){const{params:{column:e}}=this;let{value:t}=this,i=null;typeof t=="function"?(this.valueFunction=t,i=this.valueFunction(),t=i):this.isTree?i=(0,m._toStringOrNull)(t):i=this.getFormattedValue(e,t),this.formattedValue=i,this.setTooltipAndCellRendererParams(t,i),this.renderCell()}setTooltipAndCellRendererParams(e,t){var s;const i=this.gos;if(this.params.showTooltips&&(!(0,m._isShowTooltipWhenTruncated)(i)||!this.params.cellRenderer)){const n=t!=null?t:(0,m._toStringOrNull)(e);this.shouldDisplayTooltip=(0,m._getShouldDisplayTooltip)(i,()=>this.eCheckbox.getGui().querySelector(".ag-label")),(s=this.tooltipFeature)==null||s.setTooltipAndRefresh(n)}this.cellRendererParams=(0,m._addGridCommonParams)(i,{value:e,valueFormatted:t,colDef:this.params.colDef,column:this.params.column,setTooltip:(n,a)=>{var r;i.assertModuleRegistered("Tooltip",3),this.shouldDisplayTooltip=a,(r=this.tooltipFeature)==null||r.setTooltipAndRefresh(n)}})}getFormattedValue(e,t){return this.beans.valueSvc.formatValue(e,null,t,this.valueFormatter,!1)}renderCell(){const e=(0,m._getCellRendererDetails)(this.beans.userCompFactory,this.params,this.cellRendererParams),t=e==null?void 0:e.newAgStackInstance();if(t==null){this.renderCellWithoutCellRenderer();return}t.then(i=>{i&&(this.cellRendererComponent=i,this.eCheckbox.setLabel(i.getGui()),this.destroyCellRendererComponent=()=>this.destroyBean(i))})}renderCellWithoutCellRenderer(){var s;const{valueFormatted:e,value:t}=this.cellRendererParams;let i=(s=e==null?t:e)!=null?s:this.translate("blanks");typeof i!="string"&&((0,m._warn)(208),i=""),this.eCheckbox.setLabel(i),this.setupFixedAriaLabels(i)}getComponentHolder(){return this.params.column.getColDef()}},tL=class{getModelAsString(e,t){const{values:i}=e||t.getModel()||{},s=t.getValueModel();if(i==null||s==null)return"";const n=i.filter(o=>s.isKeyAvailable(o)),a=n.length,r=n.slice(0,10).map(o=>t.getFormattedValue(o));return`(${a}) ${r.join(",")}${a>10?",...":""}`}};function xS(e,t,i){let s=e;return s?(s=s.map(n=>(0,m._toStringOrNull)((0,m._makeNull)(n))),!t&&i&&s.some(n=>n==null)?(0,m._last)(s)==null?null:s.filter(n=>n!=null):s):null}var o$=class{constructor(e,t,i,s,n,a,r,o,l,c){this.rowModel=e,this.filterParams=t,this.createKey=i,this.caseFormat=s,this.valueSvc=n,this.treeDataOrGrouping=a,this.treeData=r,this.groupAllowUnbalanced=o,this.addManagedEventListeners=l,this.rowGroupColsSvc=c}extractUniqueValuesAsync(e,t){return new m.AgPromise(i=>{if(this.rowModel.isRowDataLoaded())i(this.extractUniqueValues(e,t));else{const[s]=this.addManagedEventListeners({rowCountReady:()=>{s==null||s(),i(this.extractUniqueValues(e,t))}})}})}extractUniqueValues(e,t){var l;const i=new Map,s=this.extractExistingFormattedKeys(t),n=new Set,a=this.treeData,r=(l=this.rowGroupColsSvc)==null?void 0:l.columns,o=(c,h)=>{const d=this.caseFormat(c);if(!n.has(d)){n.add(d);let u=c,p=(0,m._makeNull)(h);const g=s==null?void 0:s.get(d);g!=null&&(u=g,p=t.get(g)),i.set(u,p)}};return this.rowModel.forEachLeafNode(c=>{if(!c.data||!e(c))return;if(this.treeDataOrGrouping){this.addValueForTreeDataOrGrouping(c,a,r,o);return}const h=this.getValue(c);h!=null&&Array.isArray(h)?(h.forEach(d=>{o(this.createKey(d,c),d)}),h.length===0&&o(null,null)):o(this.createKey(h,c),h)}),i}addValueForTreeDataOrGrouping(e,t,i=[],s){var r,o,l;let n;if(t){if((r=e.childrenAfterGroup)!=null&&r.length)return;n=(l=e.getRoute())!=null?l:[(o=e.key)!=null?o:e.id]}else n=i.map(c=>this.valueSvc.getKeyForNode(c,e)),n.push(this.getValue(e));const a=xS(n,t,this.groupAllowUnbalanced);s(this.createKey(a),a)}getValue(e){return this.filterParams.getValue(e)}extractExistingFormattedKeys(e){if(!e)return null;const t=new Map;return e.forEach((i,s)=>{t.set(this.caseFormat(s),s)}),t}},l$=class{constructor({caseFormat:e}){this.filteringKeys=null,this.filteringKeysCaseFormatted=null,this.hasNoAppliedFilteringKeys=!1,this.caseFormat=e}allFilteringKeys(){return this.filteringKeys}allFilteringKeysCaseFormatted(){return this.filteringKeysCaseFormatted}setFilteringKeys(e){this.filteringKeys=new Set(e),this.hasNoAppliedFilteringKeys=!this.filteringKeys||this.filteringKeys.size===0,this.filteringKeysCaseFormatted=new Set,this.filteringKeys.forEach(t=>this.filteringKeysCaseFormatted.add(this.caseFormat(t)))}addFilteringKey(e){this.filteringKeys==null&&(this.filteringKeys=new Set,this.filteringKeysCaseFormatted=new Set),this.filteringKeys.add(e),this.filteringKeysCaseFormatted.add(this.caseFormat(e)),this.hasNoAppliedFilteringKeys&&(this.hasNoAppliedFilteringKeys=!1)}hasCaseFormattedFilteringKey(e){return this.filteringKeysCaseFormatted.has(this.caseFormat(e))}hasFilteringKey(e){return this.filteringKeys.has(e)}reset(){this.filteringKeys=null,this.filteringKeysCaseFormatted=null,this.hasNoAppliedFilteringKeys=!1}},c$=class{constructor(e,t,i,s){this.valueSvc=e,this.valueFormatter=t,this.formatter=i,this.column=s,this.displayedKeys=[]}updateDisplayedValuesToAllAvailable(e,t,i){this.displayedKeys=Array.from(i)}updateDisplayedValuesToMatchMiniFilter(e,t,i,s,n){this.displayedKeys=[];for(const a of i)if(a==null)n&&this.displayedKeys.push(a);else{const r=e(a),o=this.valueSvc.formatValue(this.column,null,r,this.valueFormatter,!1),l=this.formatter(o);s(l)&&this.displayedKeys.push(a)}}getDisplayedValueCount(){return this.displayedKeys.length}getDisplayedItem(e){return this.displayedKeys[e]}getSelectAllItem(){return Yc}getAddSelectionToFilterItem(){return Xc}getDisplayedKeys(){return this.displayedKeys}forEachDisplayedKey(e){this.displayedKeys.forEach(e)}someDisplayedKey(e){return this.displayedKeys.some(e)}hasGroups(){return!1}refresh(){}},h$=e=>(0,m._missing)(e)?null:!(e instanceof Date)||isNaN(e.getTime())?["NaN"]:[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())],iL=class{constructor(e,t,i,s){this.formatter=e,this.treeListPathGetter=t,this.treeListFormatter=i,this.treeDataOrGrouping=s,this.allDisplayedItemsTree=[],this.activeDisplayedItemsFlat=[],this.selectAllItem={depth:0,filterPasses:!0,available:!0,treeKey:Yc,children:this.allDisplayedItemsTree,expanded:!0,key:Yc,parentTreeKeys:[]},this.addSelectionToFilterItem={depth:0,filterPasses:!0,available:!0,treeKey:Xc,expanded:!0,key:Xc,parentTreeKeys:[]}}updateOnParamsChange(e){this.treeListFormatter=e}updateDisplayedValuesToAllAvailable(e,t,i,s){s==="reload"?this.generateItemTree(e,t,i):s==="otherFilter"?(this.updateAvailable(i),this.updateExpandAll()):s==="miniFilter"&&(this.resetFilter(),this.updateExpandAll()),this.flattenItems()}updateDisplayedValuesToMatchMiniFilter(e,t,i,s,n,a){a==="reload"?this.generateItemTree(e,t,i):a==="otherFilter"&&this.updateAvailable(i),this.updateFilter(s,n),this.updateExpandAll(),this.flattenItems()}generateItemTree(e,t,i){var n;this.allDisplayedItemsTree=[],this.groupsExist=!1;const s=this.getTreeListPathGetter(e,i);for(const a of t){const r=e(a),o=(n=s(r))!=null?n:[null];o.length>1&&(this.groupsExist=!0);const l=i.has(a);let c=this.allDisplayedItemsTree,h,d=[];o.forEach((u,p)=>{c||(c=[],h.children=c),h=c.find(g=>{var f;return((f=g.treeKey)==null?void 0:f.toUpperCase())===(u==null?void 0:u.toUpperCase())}),h||(h={treeKey:u,depth:p,filterPasses:!0,expanded:!1,available:l,parentTreeKeys:d},p===o.length-1&&(h.key=a),c.push(h)),c=h.children,d=[...d,u]})}this.updateAvailable(i),this.selectAllItem.children=this.allDisplayedItemsTree,this.selectAllItem.expanded=!1}getTreeListPathGetter(e,t){if(this.treeListPathGetter)return this.treeListPathGetter;if(this.treeDataOrGrouping)return s=>s;let i=!1;for(const s of t){const n=e(s);if(n instanceof Date){i=!0;break}else if(n!=null)break}return i?h$:((0,m._warn)(211),s=>[String(s)])}flattenItems(){this.activeDisplayedItemsFlat=[];const e=t=>{t.forEach(i=>{!i.filterPasses||!i.available||(this.activeDisplayedItemsFlat.push(i),i.children&&i.expanded&&e(i.children))})};e(this.allDisplayedItemsTree)}resetFilter(){const e=t=>{t.children&&t.children.forEach(i=>{e(i)}),t.filterPasses=!0};this.allDisplayedItemsTree.forEach(t=>e(t))}updateFilter(e,t){const i=s=>s.available?s.treeKey==null?t:e(this.formatter(this.treeListFormatter?this.treeListFormatter(s.treeKey,s.depth,s.parentTreeKeys):s.treeKey)):!1;this.allDisplayedItemsTree.forEach(s=>this.recursiveItemCheck(s,!1,i,"filterPasses"))}getDisplayedValueCount(){return this.activeDisplayedItemsFlat.length}getDisplayedItem(e){return this.activeDisplayedItemsFlat[e]}getSelectAllItem(){return this.selectAllItem}getAddSelectionToFilterItem(){return this.addSelectionToFilterItem}getDisplayedKeys(){const e=[];return this.forEachDisplayedKey(t=>e.push(t)),e}forEachDisplayedKey(e){const t=(i,s)=>{i.children?(!i.expanded||!s)&&i.children.forEach(n=>{n.filterPasses&&t(n,!1)}):e(i.key)};this.activeDisplayedItemsFlat.forEach(i=>t(i,!0))}someDisplayedKey(e){const t=(i,s)=>{if(i.children){if(!i.expanded||!s)return i.children.some(n=>n.filterPasses?t(n,!1):!1)}else return e(i.key);return!1};return this.activeDisplayedItemsFlat.some(i=>t(i,!0))}hasGroups(){return this.groupsExist}refresh(){this.updateExpandAll(),this.flattenItems()}updateExpandAll(){const e=(i,s,n)=>{for(const a of i){if(!a.filterPasses||!a.available||!a.children)continue;if(s=s||!!a.expanded,n=n||!a.expanded,s&&n)return;const r=e(a.children,s,n);if(r===void 0)return;r?s=!0:n=!0}return s&&n?void 0:s},t=this.getSelectAllItem();t.expanded=e(t.children,!1,!1)}recursiveItemCheck(e,t,i,s){let n=!1;e.children&&e.children.forEach(r=>{const o=this.recursiveItemCheck(r,t||i(e),i,s);n=n||o});const a=t||n||i(e);return e[s]=a,a}updateAvailable(e){const t=i=>e.has(i.key);this.allDisplayedItemsTree.forEach(i=>this.recursiveItemCheck(i,!1,t,"available"))}},d$=class{constructor(e){this.localEventService=new m.LocalEventService,this.miniFilterText=null,this.addCurrentSelectionToFilter=!1,this.providedValues=null,this.allValues=new Map,this.availableKeys=new Set,this.selectedKeys=new Set,this.initialised=!1;const{usingComplexObjects:t,rowGroupColsSvc:i,valueSvc:s,treeDataTreeList:n,groupingTreeList:a,filterParams:r,gos:o,valueFormatter:l,addManagedEventListeners:c}=e,{column:h,colDef:d,textFormatter:u,doesRowPassOtherFilter:p,suppressSorting:g,comparator:f,rowModel:y,values:v,caseSensitive:x,treeList:S,treeListPathGetter:M,treeListFormatter:D}=r;this.filterParams=r,this.gos=o,this.setIsLoading=e.setIsLoading,this.translate=e.translate,this.caseFormat=e.caseFormat,this.createKey=e.createKey,this.usingComplexObjects=!!e.usingComplexObjects,this.formatter=u!=null?u:k=>k!=null?k:null,this.doesRowPassOtherFilters=p,this.suppressSorting=g||!1,this.filteringKeys=new l$({caseFormat:this.caseFormat});const A=f!=null?f:d.comparator,w=!!n||!!a;this.compareByValue=!!(t&&A||w||S&&!M),w&&!A?this.entryComparator=this.createTreeDataOrGroupingComparator():S&&!M&&!A?this.entryComparator=([k,N],[O,L])=>(0,m._defaultComparator)(N,L):this.entryComparator=([k,N],[O,L])=>A(N,L),this.keyComparator=A!=null?A:m._defaultComparator,this.caseSensitive=!!x;const T=o.get("groupAllowUnbalanced");(0,m._isClientSideRowModel)(o,y)&&(this.clientSideValuesExtractor=new o$(y,this.filterParams,this.createKey,this.caseFormat,s,w,!!n,T,c,i)),v==null?this.valuesType=2:(this.valuesType=Array.isArray(v)?0:1,this.providedValues=v),this.displayValueModel=S?new iL(this.formatter,M,D,n||a):new c$(s,l,this.formatter,h),this.updateAllValues().then(k=>this.resetSelectionState(k||[]))}addEventListener(e,t,i){this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService.removeEventListener(e,t,i)}updateOnParamsChange(e){return new m.AgPromise(t=>{const{values:i,textFormatter:s,suppressSorting:n,treeListFormatter:a}=e,r=this.providedValues,o=this.suppressSorting;if(this.filterParams=e,this.formatter=s!=null?s:l=>l!=null?l:null,this.suppressSorting=n||!1,this.providedValues=i!=null?i:null,this.displayValueModel instanceof iL&&this.displayValueModel.updateOnParamsChange(a),this.providedValues!==r||this.suppressSorting!==o){!i||i.length===0?(this.valuesType=2,this.providedValues=null):this.valuesType=Array.isArray(i)?0:1;const l=this.getModel();this.updateAllValues().then(()=>{this.setModel(l).then(()=>t())})}else t()})}refreshValues(){return new m.AgPromise(e=>{this.allValuesPromise.then(()=>{const t=this.getModel();this.updateAllValues(),this.setModel(t).then(()=>e())})})}overrideValues(e){return new m.AgPromise(t=>{this.allValuesPromise.then(()=>{this.valuesType=0,this.providedValues=e,this.refreshValues().then(()=>t())})})}refreshAfterAnyFilterChanged(){return this.showAvailableOnly()?this.allValuesPromise.then(e=>(this.updateAvailableKeys(e!=null?e:[],"otherFilter"),!0)):m.AgPromise.resolve(!1)}isInitialised(){return this.initialised}updateAllValues(){return this.allValuesPromise=new m.AgPromise(e=>{switch(this.valuesType){case 2:this.getValuesFromRowsAsync(!1).then(t=>e(this.processAllValues(t)));break;case 0:{e(this.processAllValues(this.uniqueValues(this.validateProvidedValues(this.providedValues))));break}case 1:{this.setIsLoading(!0);const t=this.providedValues,{column:i,colDef:s}=this.filterParams,n=(0,m._addGridCommonParams)(this.gos,{success:a=>{this.setIsLoading(!1),e(this.processAllValues(this.uniqueValues(this.validateProvidedValues(a))))},colDef:s,column:i});window.setTimeout(()=>t(n),0);break}}}),this.allValuesPromise.then(e=>this.updateAvailableKeys(e||[],"reload")).then(()=>this.initialised=!0),this.allValuesPromise}processAllValues(e){const t=this.sortKeys(e);return this.allValues=e!=null?e:new Map,t}validateProvidedValues(e){if(this.usingComplexObjects&&(e!=null&&e.length)){const t=e[0];t&&typeof t!="object"&&typeof t!="function"&&(this.createKey(t)==null?(0,m._warn)(209):(0,m._warn)(210))}return e}setValuesType(e){this.valuesType=e}getValuesType(){return this.valuesType}isKeyAvailable(e){return this.availableKeys.has(e)}showAvailableOnly(){return this.valuesType===2}updateAvailableKeys(e,t){const i=this.showAvailableOnly()?this.sortKeys(this.getValuesFromRows(!0)):e;this.availableKeys=new Set(i),this.localEventService.dispatchEvent({type:"availableValuesChanged"}),this.updateDisplayedValues(t,e)}sortKeys(e){const t=e!=null?e:new Map;if(this.suppressSorting)return Array.from(t.keys());let i;return this.compareByValue?i=Array.from(t.entries()).sort(this.entryComparator).map(([s])=>s):i=Array.from(t.keys()).sort(this.keyComparator),this.filterParams.excelMode&&t.has(null)&&(i=i.filter(s=>s!=null),i.push(null)),i}getParamsForValuesFromRows(e=!1){if(!this.clientSideValuesExtractor)return(0,m._error)(113),null;const t=s=>!e||this.doesRowPassOtherFilters(s),i=e&&!this.caseSensitive?this.allValues:void 0;return{predicate:t,existingValues:i}}getValuesFromRows(e=!1){const t=this.getParamsForValuesFromRows(e);return t?this.clientSideValuesExtractor.extractUniqueValues(t.predicate,t.existingValues):null}getValuesFromRowsAsync(e=!1){const t=this.getParamsForValuesFromRows(e);return t?this.clientSideValuesExtractor.extractUniqueValuesAsync(t.predicate,t.existingValues):m.AgPromise.resolve(null)}setMiniFilter(e){return e=(0,m._makeNull)(e),this.miniFilterText===e?!1:(e===null&&this.setAddCurrentSelectionToFilter(!1),this.miniFilterText=e,this.updateDisplayedValues("miniFilter"),!0)}getMiniFilter(){return this.miniFilterText}updateDisplayedValues(e,t){if(e==="expansion"){this.displayValueModel.refresh();return}if(this.miniFilterText==null){this.displayValueModel.updateDisplayedValuesToAllAvailable(a=>this.getValue(a),t,this.availableKeys,e);return}const i=this.caseFormat(this.formatter(this.miniFilterText)||""),s=a=>a!=null&&this.caseFormat(a).indexOf(i)>=0,n=!!this.filterParams.excelMode&&s(this.translate("blanks"));this.displayValueModel.updateDisplayedValuesToMatchMiniFilter(a=>this.getValue(a),t,this.availableKeys,s,n,e)}getDisplayedValueCount(){return this.displayValueModel.getDisplayedValueCount()}getDisplayedItem(e){return this.displayValueModel.getDisplayedItem(e)}getSelectAllItem(){return this.displayValueModel.getSelectAllItem()}getAddSelectionToFilterItem(){return this.displayValueModel.getAddSelectionToFilterItem()}hasSelections(){return this.filterParams.defaultToNothingSelected?this.selectedKeys.size>0:this.allValues.size!==this.selectedKeys.size}getKeys(){return Array.from(this.allValues.keys())}getValues(){return Array.from(this.allValues.values())}getValue(e){return this.allValues.get(e)}setAddCurrentSelectionToFilter(e){this.addCurrentSelectionToFilter=e}isInWindowsExcelMode(){return this.filterParams.excelMode==="windows"}isAddCurrentSelectionToFilterChecked(){return this.isInWindowsExcelMode()&&this.addCurrentSelectionToFilter}showAddCurrentSelectionToFilter(){return this.isInWindowsExcelMode()&&(0,m._exists)(this.miniFilterText)&&this.miniFilterText.length>0}selectAllMatchingMiniFilter(e=!1){this.miniFilterText==null?this.selectedKeys=new Set(this.allValues.keys()):(e&&this.selectedKeys.clear(),this.displayValueModel.forEachDisplayedKey(t=>this.selectedKeys.add(t)))}deselectAllMatchingMiniFilter(){this.miniFilterText==null?this.selectedKeys.clear():this.displayValueModel.forEachDisplayedKey(e=>this.selectedKeys.delete(e))}selectKey(e){this.selectedKeys.add(e)}deselectKey(e){this.filterParams.excelMode&&this.isEverythingVisibleSelected()&&this.resetSelectionState(this.displayValueModel.getDisplayedKeys()),this.selectedKeys.delete(e)}isKeySelected(e){return this.selectedKeys.has(e)}isEverythingVisibleSelected(){return!this.displayValueModel.someDisplayedKey(e=>!this.isKeySelected(e))}isNothingVisibleSelected(){return!this.displayValueModel.someDisplayedKey(e=>this.isKeySelected(e))}getModel(){if(!this.hasSelections())return null;const e=this.isAddCurrentSelectionToFilterChecked()?this.filteringKeys.allFilteringKeys():null;if(e&&e.size>0){if(this.selectedKeys){const t=new Set([...Array.from(e),...Array.from(this.selectedKeys).filter(i=>!e.has(i))]);return Array.from(t)}return Array.from(e)}return Array.from(this.selectedKeys)}setModel(e){return this.allValuesPromise.then(t=>{if(e==null)this.resetSelectionState(t!=null?t:[]);else{this.selectedKeys.clear();const i=new Map;this.allValues.forEach((s,n)=>{i.set(this.caseFormat(n),n)}),e.forEach(s=>{const n=this.caseFormat((0,m._makeNull)(s)),a=i.get(n);a!==void 0&&this.selectKey(a)})}})}uniqueValues(e){const t=new Map,i=new Set;return(e!=null?e:[]).forEach(s=>{const n=(0,m._makeNull)(s),a=this.createKey(n),r=this.caseFormat(a);i.has(r)||(i.add(r),t.set(a,n))}),t}resetSelectionState(e){this.filterParams.defaultToNothingSelected?this.selectedKeys.clear():this.selectedKeys=new Set(e)}hasGroups(){return this.displayValueModel.hasGroups()}createTreeDataOrGroupingComparator(){return([e,t],[i,s])=>{if(t==null)return s==null?0:-1;if(s==null)return 1;for(let n=0;n<t.length;n++){if(n>=s.length)return 1;const a=(0,m._defaultComparator)(t[n],s[n]);if(a!==0)return a}return 0}}setAppliedModelKeys(e){this.filteringKeys.setFilteringKeys(e)}addToAppliedModelKeys(e){this.filteringKeys.addFilteringKey(e)}getAppliedModelKeys(){return this.filteringKeys.allFilteringKeys()}getCaseFormattedAppliedModelKeys(){return this.filteringKeys.allFilteringKeysCaseFormatted()}hasAppliedModelKey(e){return this.filteringKeys.hasCaseFormattedFilteringKey(e)}hasAnyAppliedModelKey(){return!this.filteringKeys.hasNoAppliedFilteringKeys}},sL=class extends m.ProvidedFilter{constructor(){super("setFilter"),this.filterType="set",this.eMiniFilter=m.RefPlaceholder,this.eFilterLoading=m.RefPlaceholder,this.eFilterLoadingIcon=m.RefPlaceholder,this.eSetFilterList=m.RefPlaceholder,this.eFilterNoMatches=m.RefPlaceholder,this.caseSensitive=!1,this.treeDataTreeList=!1,this.groupingTreeList=!1,this.hardRefreshVirtualList=!1,this.noValueFormatterSupplied=!1,this.filterModelFormatter=new tL,this.updateSetFilterOnParamsChange=e=>{var s,n;this.setFilterParams=e,this.caseSensitive=!!e.caseSensitive;const t=(s=e.keyCreator)!=null?s:e.colDef.keyCreator;this.setValueFormatter(e.valueFormatter,t,!!e.treeList,!!e.colDef.refData);const i=e.column.getId().startsWith(m.GROUP_AUTO_COLUMN_ID);this.treeDataTreeList=this.gos.get("treeData")&&!!e.treeList&&i,this.groupingTreeList=!!((n=this.rowGroupColsSvc)!=null&&n.columns.length)&&!!e.treeList&&i,this.createKey=this.generateCreateKey(t,this.treeDataTreeList||this.groupingTreeList)}}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc,this.dataTypeSvc=e.dataTypeSvc}postConstruct(){super.postConstruct()}updateUiVisibility(){}createBodyTemplate(){return{tag:"div",cls:"ag-set-filter",children:[{tag:"div",ref:"eFilterLoading",cls:"ag-filter-loading ag-loading ag-hidden",children:[{tag:"span",ref:"eFilterLoadingIcon",cls:"ag-loading-icon"},{tag:"span",cls:"ag-loading-text",children:this.translateForSetFilter("loadingOoo")}]},{tag:"ag-input-text-field",ref:"eMiniFilter",cls:"ag-mini-filter"},{tag:"div",ref:"eFilterNoMatches",cls:"ag-filter-no-matches ag-hidden",children:this.translateForSetFilter("noMatches")},{tag:"div",ref:"eSetFilterList",cls:"ag-set-filter-list",role:"presentation"}]}}getAgComponents(){return[m.AgInputTextFieldSelector]}handleKeyDown(e){if(super.handleKeyDown(e),!e.defaultPrevented)switch(e.key){case m.KeyCode.SPACE:this.handleKeySpace(e);break;case m.KeyCode.ENTER:this.handleKeyEnter(e);break;case m.KeyCode.LEFT:this.handleKeyLeft(e);break;case m.KeyCode.RIGHT:this.handleKeyRight(e);break}}handleKeySpace(e){var t;(t=this.getComponentForKeyEvent(e))==null||t.toggleSelected()}handleKeyEnter(e){const{excelMode:t,readOnly:i}=this.setFilterParams;!t||i||(e.preventDefault(),this.onBtApply(!1,!1,e),this.setFilterParams.excelMode==="mac"&&this.eMiniFilter.getInputElement().select())}handleKeyLeft(e){var t;(t=this.getComponentForKeyEvent(e))==null||t.setExpanded(!1)}handleKeyRight(e){var t;(t=this.getComponentForKeyEvent(e))==null||t.setExpanded(!0)}getComponentForKeyEvent(e){if(!this.eSetFilterList.contains((0,m._getActiveDomElement)(this.beans)))return;const t=this.virtualList.getLastFocusedRow();if(t==null)return;const i=this.virtualList.getComponentAt(t);if(i==null)return;e.preventDefault();const{readOnly:s}=this.setFilterParams;if(!s)return i}getCssIdentifier(){return"set-filter"}setModel(e){return e==null&&this.valueModel.getModel()==null?(this.setMiniFilter(null),m.AgPromise.resolve()):super.setModel(e)}refresh(e){if(this.applyExcelModeOptions(e),!super.refresh(e))return!1;const t=this.setFilterParams;return["treeList","treeListPathGetter","caseSensitive","comparator","excelMode"].some(s=>e[s]!==(t==null?void 0:t[s]))||this.haveColDefParamsChanged(e)?!1:(super.updateParams(e),this.updateSetFilterOnParamsChange(e),this.updateMiniFilter(),e.suppressSelectAll!==(t==null?void 0:t.suppressSelectAll)&&this.createVirtualListModel(e),this.valueModel.updateOnParamsChange(e).then(()=>{this.isAlive()&&this.refreshFilterValues()}),!0)}haveColDefParamsChanged(e){const{colDef:t,keyCreator:i}=e,{colDef:s,keyCreator:n}=this.setFilterParams,a=i!=null?i:t.keyCreator,r=n!=null?n:s==null?void 0:s.keyCreator,o=t.filterValueGetter!==(s==null?void 0:s.filterValueGetter),l=a!==r,c=!!this.dataTypeSvc&&!!a&&this.dataTypeSvc.getFormatValue(t.cellDataType)===a&&t.valueFormatter!==(s==null?void 0:s.valueFormatter);return o||l||c}setModelAndRefresh(e){return this.valueModel.setModel(e).then(()=>{this.isAlive()&&this.checkAndRefreshVirtualList()})}resetUiToDefaults(){return this.setMiniFilter(null),this.setModelAndRefresh(null)}setModelIntoUi(e){this.setMiniFilter(null);const t=e==null?null:e.values;return this.setModelAndRefresh(t)}getModelFromUi(){const e=this.valueModel.getModel();return e?{values:e,filterType:this.filterType}:null}getValueModel(){return this.valueModel}areModelsEqual(e,t){return e==null&&t==null?!0:e!=null&&t!=null&&(0,m._areEqual)(e.values,t.values)}setParams(e){var i;this.applyExcelModeOptions(e),super.setParams(e),this.updateSetFilterOnParamsChange(e);const t=(i=e.keyCreator)!=null?i:e.colDef.keyCreator;this.valueModel=new d$({filterParams:e,setIsLoading:s=>this.setIsLoading(s),translate:s=>this.translateForSetFilter(s),caseFormat:s=>this.caseFormat(s),createKey:this.createKey,valueFormatter:this.valueFormatter,usingComplexObjects:!!t,gos:this.gos,rowGroupColsSvc:this.rowGroupColsSvc,valueSvc:this.valueSvc,treeDataTreeList:this.treeDataTreeList,groupingTreeList:this.groupingTreeList,addManagedEventListeners:s=>this.addManagedEventListeners(s)}),this.initialiseFilterBodyUi(),this.addEventListenersForDataChanges()}onAddCurrentSelectionToFilterChange(e){this.valueModel.setAddCurrentSelectionToFilter(e)}setValueFormatter(e,t,i,s){let n=e;if(!n){if(t&&!i){(0,m._error)(249);return}this.noValueFormatterSupplied=!0,s||(n=a=>(0,m._toStringOrNull)(a.value))}this.valueFormatter=n}generateCreateKey(e,t){return t&&!e?((0,m._error)(250),()=>null):e?(i,s=null)=>{const n=this.getKeyCreatorParams(i,s);return(0,m._makeNull)(e(n))}:i=>(0,m._makeNull)((0,m._toStringOrNull)(i))}getFormattedValue(e){var s;let t=this.valueModel.getValue(e);this.noValueFormatterSupplied&&(this.treeDataTreeList||this.groupingTreeList)&&Array.isArray(t)&&(t=(0,m._last)(t));const i=this.valueSvc.formatValue(this.setFilterParams.column,null,t,this.valueFormatter,!1);return(s=i==null?(0,m._toStringOrNull)(t):i)!=null?s:this.translateForSetFilter("blanks")}applyExcelModeOptions(e){e.excelMode==="windows"?(e.buttons||(e.buttons=["apply","cancel"]),e.closeOnApply==null&&(e.closeOnApply=!0)):e.excelMode==="mac"&&(e.buttons||(e.buttons=["reset"]),e.applyMiniFilterWhileTyping==null&&(e.applyMiniFilterWhileTyping=!0),e.debounceMs==null&&(e.debounceMs=500)),e.excelMode&&e.defaultToNothingSelected&&(e.defaultToNothingSelected=!1,(0,m._warn)(207))}addEventListenersForDataChanges(){if(!this.isValuesTakenFromGrid())return;this.addManagedPropertyListeners(["groupAllowUnbalanced"],()=>{this.syncAfterDataChange()});const e=(0,m._debounce)(this,this.syncAfterDataChange.bind(this),0);this.addManagedEventListeners({cellValueChanged:t=>{t.column===this.setFilterParams.column&&e()}})}syncAfterDataChange(){const e=!this.applyActive||this.areModelsEqual(this.getModel(),this.getModelFromUi());return this.valueModel.refreshValues().then(()=>{this.isAlive()&&(this.checkAndRefreshVirtualList(),e&&this.onBtApply(!1,!0))})}setIsLoading(e){(0,m._setDisplayed)(this.eFilterLoading,e),e||(this.hardRefreshVirtualList=!0)}initialiseFilterBodyUi(){this.initVirtualList(),this.initMiniFilter(),this.initLoading()}initLoading(){const e=(0,m._createIconNoSpan)("setFilterLoading",this.beans,this.setFilterParams.column);e&&this.eFilterLoadingIcon.appendChild(e)}initVirtualList(){const t=this.getLocaleTextFunc()("ariaFilterList","Filter List"),i=!!this.setFilterParams.treeList,s=this.virtualList=this.createBean(new Od({cssIdentifier:"filter",ariaRole:i?"tree":"listbox",listName:t})),n=this.eSetFilterList;i&&n.classList.add("ag-set-filter-tree-list"),n&&n.appendChild(s.getGui());const{cellHeight:a}=this.setFilterParams;a!=null&&s.setRowHeight(a);const r=(l,c)=>this.createSetListItem(l,i,c);s.setComponentCreator(r);const o=(l,c)=>this.updateSetListItem(l,c);s.setComponentUpdater(o),this.createVirtualListModel(this.setFilterParams)}createVirtualListModel(e){let t;e.suppressSelectAll?t=new u$(this.valueModel):t=new p$(this.valueModel,()=>this.isSelectAllSelected()),e.treeList&&(t=new g$(t)),this.virtualList.setModel(t)}getSelectAllLabel(){const e=this.valueModel.getMiniFilter()==null||!this.setFilterParams.excelMode?"selectAll":"selectAllSearchResults";return this.translateForSetFilter(e)}getAddSelectionToFilterLabel(){return this.translateForSetFilter("addCurrentSelectionToFilter")}createSetListItem(e,t,i){const s=this.valueModel.hasGroups(),{isSelected:n,isExpanded:a}=this.isSelectedExpanded(e),{value:r,depth:o,isGroup:l,hasIndeterminateExpandState:c,selectedListener:h,expandedListener:d}=this.newSetListItemAttributes(e),u={focusWrapper:i,value:r,params:this.setFilterParams,translate:g=>this.translateForSetFilter(g),valueFormatter:this.valueFormatter,item:e,isSelected:n,isTree:t,depth:o,groupsExist:s,isGroup:l,isExpanded:a,hasIndeterminateExpandState:c},p=this.createBean(new r$(u));return p.addEventListener("selectionChanged",h),d&&p.addEventListener("expandedChanged",d),p}newSetTreeItemAttributes(e){var i,s,n,a,r,o;const t=this.valueModel.hasGroups();return e.key===Yc?{value:()=>this.getSelectAllLabel(),isGroup:t,depth:e.depth,hasIndeterminateExpandState:!0,selectedListener:l=>this.onSelectAll(l.isSelected),expandedListener:l=>this.onExpandAll(l.item,l.isExpanded)}:e.key===Xc?{value:()=>this.getAddSelectionToFilterLabel(),depth:e.depth,isGroup:!1,hasIndeterminateExpandState:!1,selectedListener:l=>{this.onAddCurrentSelectionToFilterChange(l.isSelected)}}:e.children?{value:(n=(s=(i=this.setFilterParams).treeListFormatter)==null?void 0:s.call(i,e.treeKey,e.depth,e.parentTreeKeys))!=null?n:e.treeKey,depth:e.depth,isGroup:!0,selectedListener:l=>this.onGroupItemSelected(l.item,l.isSelected),expandedListener:l=>this.onExpandedChanged(l.item,l.isExpanded)}:{value:(o=(r=(a=this.setFilterParams).treeListFormatter)==null?void 0:r.call(a,e.treeKey,e.depth,e.parentTreeKeys))!=null?o:e.treeKey,depth:e.depth,selectedListener:l=>this.onItemSelected(l.item.key,l.isSelected)}}newSetListItemAttributes(e){return this.isSetFilterModelTreeItem(e)?this.newSetTreeItemAttributes(e):e===Yc?{value:()=>this.getSelectAllLabel(),selectedListener:t=>this.onSelectAll(t.isSelected)}:e===Xc?{value:()=>this.getAddSelectionToFilterLabel(),selectedListener:t=>{this.onAddCurrentSelectionToFilterChange(t.isSelected)}}:{value:this.valueModel.getValue(e),selectedListener:t=>this.onItemSelected(t.item,t.isSelected)}}updateSetListItem(e,t){const{isSelected:i,isExpanded:s}=this.isSelectedExpanded(e);t.refresh(e,i,s)}isSelectedExpanded(e){let t,i;return this.isSetFilterModelTreeItem(e)?(i=e.expanded,e.key===Yc?t=this.isSelectAllSelected():e.key===Xc?t=this.valueModel.isAddCurrentSelectionToFilterChecked():e.children?t=this.areAllChildrenSelected(e):t=this.valueModel.isKeySelected(e.key)):e===Yc?t=this.isSelectAllSelected():e===Xc?t=this.valueModel.isAddCurrentSelectionToFilterChecked():t=this.valueModel.isKeySelected(e),{isSelected:t,isExpanded:i}}isSetFilterModelTreeItem(e){return(e==null?void 0:e.treeKey)!==void 0}initMiniFilter(){const{eMiniFilter:e}=this,t=this.getLocaleTextFunc();e.setDisplayed(!this.setFilterParams.suppressMiniFilter),e.setValue(this.valueModel.getMiniFilter()),e.onValueChange(()=>this.onMiniFilterInput()),e.setInputAriaLabel(t("ariaSearchFilterValues","Search filter values")),this.addManagedElementListeners(e.getInputElement(),{keydown:i=>this.onMiniFilterKeyDown(i)})}updateMiniFilter(){const{eMiniFilter:e}=this;e.isDisplayed()!==!this.setFilterParams.suppressMiniFilter&&e.setDisplayed(!this.setFilterParams.suppressMiniFilter);const t=this.valueModel.getMiniFilter();e.getValue()!==t&&e.setValue(t)}afterGuiAttached(e){super.afterGuiAttached(e),this.resetExpansion(),this.refreshVirtualList();const{eMiniFilter:t}=this;t.setInputPlaceholder(this.translateForSetFilter("searchOoo")),(!e||!e.suppressFocus)&&(t.isDisplayed()?t.getFocusableElement().focus():this.virtualList.awaitStable(()=>this.virtualList.focusRow(0)))}afterGuiDetached(){super.afterGuiDetached(),this.setFilterParams.excelMode&&this.resetMiniFilter();const e=this.getModel();(this.setFilterParams.excelMode||!this.areModelsEqual(e,this.getModelFromUi()))&&(this.resetUiToActiveModel(e),this.showOrHideResults())}applyModel(e="api"){this.setFilterParams.excelMode&&e!=="rowDataUpdated"&&this.valueModel.isEverythingVisibleSelected()&&this.valueModel.selectAllMatchingMiniFilter();const t=this.valueModel.showAddCurrentSelectionToFilter()&&this.valueModel.isAddCurrentSelectionToFilterChecked();if(t&&!this.getModel())return!1;const i=super.applyModel(e),s=this.getModel();return s?(t||this.valueModel.setAppliedModelKeys(new Set),s.values.forEach(n=>{this.valueModel.addToAppliedModelKeys(n)})):t||this.valueModel.setAppliedModelKeys(null),i}isModelValid(e){return this.setFilterParams.excelMode?e==null||e.values.length>0:!0}doesFilterPass(e){if(!this.valueModel.getCaseFormattedAppliedModelKeys())return!0;if(!this.valueModel.hasAnyAppliedModelKey())return!1;const{node:t}=e;if(this.treeDataTreeList)return this.doesFilterPassForTreeData(t);if(this.groupingTreeList)return this.doesFilterPassForGrouping(t);const i=this.getValueFromNode(t);return i!=null&&Array.isArray(i)?i.length===0?this.valueModel.hasAppliedModelKey(null):i.some(s=>this.isInAppliedModel(this.createKey(s,t))):this.isInAppliedModel(this.createKey(i,t))}doesFilterPassForTreeData(e){var t,i,s;return(t=e.childrenAfterGroup)!=null&&t.length?!1:this.isInAppliedModel(this.createKey(xS((s=e.getRoute())!=null?s:[(i=e.key)!=null?i:e.id],!0,this.gos.get("groupAllowUnbalanced"))))}doesFilterPassForGrouping(e){var i,s;const t=((s=(i=this.rowGroupColsSvc)==null?void 0:i.columns)!=null?s:[]).map(n=>this.valueSvc.getKeyForNode(n,e));return t.push(this.getValueFromNode(e)),this.isInAppliedModel(this.createKey(xS(t,!1,this.gos.get("groupAllowUnbalanced"))))}isInAppliedModel(e){return this.valueModel.hasAppliedModelKey(e)}getValueFromNode(e){return this.setFilterParams.getValue(e)}getKeyCreatorParams(e,t=null){const{colDef:i,column:s,api:n,context:a}=this.setFilterParams;return{value:e,colDef:i,column:s,node:t,data:t==null?void 0:t.data,api:n,context:a}}onNewRowsLoaded(){this.isValuesTakenFromGrid()&&this.syncAfterDataChange()}isValuesTakenFromGrid(){return this.valueModel.getValuesType()===2}setFilterValues(e){this.valueModel.overrideValues(e).then(()=>{this.isAlive()&&(this.checkAndRefreshVirtualList(),this.onUiChanged())})}resetFilterValues(){this.valueModel.setValuesType(2),this.syncAfterDataChange()}refreshFilterValues(){this.valueModel.isInitialised()&&this.valueModel.refreshValues().then(()=>{this.isAlive()&&(this.hardRefreshVirtualList=!0,this.checkAndRefreshVirtualList(),this.onUiChanged())})}onAnyFilterChanged(){setTimeout(()=>{this.isAlive()&&this.valueModel.refreshAfterAnyFilterChanged().then(e=>{e&&this.isAlive()&&(this.checkAndRefreshVirtualList(),this.showOrHideResults())})},0)}onMiniFilterInput(){if(!this.valueModel.setMiniFilter(this.eMiniFilter.getValue()))return;const{applyMiniFilterWhileTyping:e,readOnly:t}=this.setFilterParams;!t&&e?this.filterOnAllVisibleValues(!1):this.updateUiAfterMiniFilterChange()}updateUiAfterMiniFilterChange(){const{excelMode:e,readOnly:t}=this.setFilterParams;e==null||t?this.checkAndRefreshVirtualList():this.valueModel.getMiniFilter()==null?this.resetUiToActiveModel(this.getModel()):(this.valueModel.selectAllMatchingMiniFilter(!0),this.checkAndRefreshVirtualList(),this.onUiChanged()),this.showOrHideResults()}showOrHideResults(){const e=this.valueModel.getMiniFilter()!=null&&this.valueModel.getDisplayedValueCount()<1;(0,m._setDisplayed)(this.eFilterNoMatches,e),(0,m._setDisplayed)(this.eSetFilterList,!e)}resetMiniFilter(){this.eMiniFilter.setValue(null,!0),this.valueModel.setMiniFilter(null)}resetUiToActiveModel(e,t){this.setModelAndRefresh(e==null?null:e.values).then(()=>{this.isAlive()&&(this.onUiChanged(!1,"prevent"),t==null||t())})}handleCancelEnd(e){this.setMiniFilter(null),super.handleCancelEnd(e)}onMiniFilterKeyDown(e){const{excelMode:t,readOnly:i}=this.setFilterParams;e.key===m.KeyCode.ENTER&&!t&&!i&&this.filterOnAllVisibleValues()}filterOnAllVisibleValues(e=!0){this.valueModel.selectAllMatchingMiniFilter(!0),this.checkAndRefreshVirtualList(),this.onUiChanged(!1,e?"immediately":"debounce"),this.showOrHideResults()}focusRowIfAlive(e){return e==null?Promise.resolve():new Promise(t=>{window.setTimeout(()=>{this.isAlive()&&this.virtualList.focusRow(e),t()},0)})}onSelectAll(e){e?this.valueModel.selectAllMatchingMiniFilter():this.valueModel.deselectAllMatchingMiniFilter(),this.refreshAfterSelection()}onGroupItemSelected(e,t){const i=s=>{s.filterPasses&&(s.children?s.children.forEach(n=>i(n)):this.selectItem(s.key,t))};i(e),this.refreshAfterSelection()}onItemSelected(e,t){this.selectItem(e,t),this.refreshAfterSelection()}selectItem(e,t){t?this.valueModel.selectKey(e):this.valueModel.deselectKey(e)}onExpandAll(e,t){const i=s=>{s.filterPasses&&s.available&&s.children&&(s.children.forEach(n=>i(n)),s.expanded=t)};i(e),this.refreshAfterExpansion()}onExpandedChanged(e,t){e.expanded=t,this.refreshAfterExpansion()}refreshAfterExpansion(){const e=this.virtualList.getLastFocusedRow();this.valueModel.updateDisplayedValues("expansion"),this.checkAndRefreshVirtualList(),this.focusRowIfAlive(e)}refreshAfterSelection(){const e=this.virtualList.getLastFocusedRow();this.checkAndRefreshVirtualList(),this.onUiChanged(),this.focusRowIfAlive(e)}setMiniFilter(e){this.eMiniFilter.setValue(e),this.onMiniFilterInput()}getMiniFilter(){return this.valueModel.getMiniFilter()}checkAndRefreshVirtualList(){this.virtualList.refresh(!this.hardRefreshVirtualList),this.hardRefreshVirtualList&&(this.hardRefreshVirtualList=!1)}getFilterKeys(){return this.valueModel.getKeys()}getFilterValues(){return this.valueModel.getValues()}getValues(){return this.getFilterKeys()}refreshVirtualList(){this.setFilterParams.refreshValuesOnOpen?this.refreshFilterValues():this.checkAndRefreshVirtualList()}translateForSetFilter(e){return this.getLocaleTextFunc()(e,s$[e])}isSelectAllSelected(){if(this.setFilterParams.defaultToNothingSelected){if(this.valueModel.hasSelections()&&this.valueModel.isEverythingVisibleSelected())return!0;if(this.valueModel.isNothingVisibleSelected())return!1}else{if(this.valueModel.hasSelections()&&this.valueModel.isNothingVisibleSelected())return!1;if(this.valueModel.isEverythingVisibleSelected())return!0}}areAllChildrenSelected(e){const t=i=>{if(i.children){let s=!1,n=!1;return i.children.some(r=>{if(!r.filterPasses||!r.available)return!1;const o=t(r);return o===void 0?!0:(o?s=!0:n=!0,s&&n)})?void 0:s}else return this.valueModel.isKeySelected(i.key)};return this.setFilterParams.defaultToNothingSelected?this.valueModel.hasSelections()&&t(e):t(e)}destroy(){this.virtualList=this.destroyBean(this.virtualList),super.destroy()}caseFormat(e){return e==null||typeof e!="string"||this.caseSensitive?e:e.toUpperCase()}resetExpansion(){if(!this.setFilterParams.treeList)return;const e=this.valueModel.getSelectAllItem();if(this.isSetFilterModelTreeItem(e)){const t=i=>{i.children&&(i.children.forEach(s=>t(s)),i.expanded=!1)};t(e),this.valueModel.updateDisplayedValues("expansion")}}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e,this)}getPositionableElement(){return this.eSetFilterList}},u$=class{constructor(e){this.model=e}getRowCount(){return this.model.getDisplayedValueCount()}getRow(e){return this.model.getDisplayedItem(e)}areRowsEqual(e,t){return e===t}},p$=class{constructor(e,t){this.model=e,this.isSelectAllSelected=t}getRowCount(){const t=this.model.showAddCurrentSelectionToFilter()?2:1;return this.model.getDisplayedValueCount()+t}getRow(e){if(e===0)return this.model.getSelectAllItem();const t=this.model.showAddCurrentSelectionToFilter(),i=t?2:1;return e===1&&t?this.model.getAddSelectionToFilterItem():this.model.getDisplayedItem(e-i)}areRowsEqual(e,t){return e===t}},g$=class{constructor(e){this.model=e}getRowCount(){return this.model.getRowCount()}getRow(e){return this.model.getRow(e)}areRowsEqual(e,t){return e==null&&t==null?!0:e!=null&&t!=null&&e.treeKey===t.treeKey&&e.depth===t.depth}},f$={tag:"div",cls:"ag-floating-filter-input ag-set-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},m$=class extends m.Component{constructor(){super(f$,[m.AgInputTextFieldSelector]),this.eFloatingFilterText=m.RefPlaceholder,this.availableValuesListenerAdded=!1,this.filterModelFormatter=new tL}wireBeans(e){this.colNames=e.colNames}init(e){this.params=e,this.eFloatingFilterText.setDisabled(!0).addGuiEventListener("click",()=>this.params.showParentFilter()),this.setParams(e)}setParams(e){const t=this.colNames.getDisplayNameForColumn(e.column,"header",!0),i=this.getLocaleTextFunc();this.eFloatingFilterText.setInputAriaLabel(`${t} ${i("ariaFilterInput","Filter Input")}`)}refresh(e){this.params=e,this.setParams(e)}onParentModelChanged(e){this.updateFloatingFilterText(e)}parentSetFilterInstance(e){this.params.parentFilterInstance(t=>{if(!(t instanceof sL)){(0,m._error)(248);return}e(t)})}addAvailableValuesListener(){this.parentSetFilterInstance(e=>{const t=e.getValueModel();t&&this.addManagedListeners(t,{availableValuesChanged:()=>this.updateFloatingFilterText()})}),this.availableValuesListenerAdded=!0}updateFloatingFilterText(e){this.availableValuesListenerAdded||this.addAvailableValuesListener(),this.parentSetFilterInstance(t=>{this.eFloatingFilterText.setValue(this.filterModelFormatter.getModelAsString(e,t))})}},y$={moduleName:"SetFilter",version:Re,userComponents:{agSetColumnFilter:sL,agSetColumnFloatingFilter:m$},icons:{setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",setFilterLoading:"loading"},dependsOn:[St,m._ColumnFilterModule]},v$=".ag-status-bar{border-top:var(--ag-footer-row-border);display:flex;justify-content:space-between;line-height:1.5;overflow:hidden;padding-left:calc(var(--ag-spacing)*4);padding-right:calc(var(--ag-spacing)*4)}.ag-status-panel,:where(.ag-status-panel.ag-status-panel-aggregations .ag-status-name-value){display:inline-flex}.ag-status-name-value{color:var(--ag-status-bar-label-color);font-weight:var(--ag-status-bar-label-font-weight);margin-left:var(--ag-spacing);margin-right:var(--ag-spacing);padding-bottom:var(--ag-widget-container-vertical-padding);padding-top:var(--ag-widget-container-vertical-padding);white-space:nowrap}.ag-status-name-value-value{color:var(--ag-status-bar-value-color);font-weight:var(--ag-status-bar-value-font-weight)}.ag-status-bar-left{display:inline-flex}.ag-status-bar-center{display:inline-flex;text-align:center}.ag-status-bar-right{display:inline-flex}";function b$(e,t,i){return e.getCompDetails(t,x$,void 0,i,!0)}var x$={name:"statusPanel",optionalMethods:["refresh"]},C$={tag:"div",cls:"ag-status-bar",children:[{tag:"div",ref:"eStatusBarLeft",cls:"ag-status-bar-left",role:"status"},{tag:"div",ref:"eStatusBarCenter",cls:"ag-status-bar-center",role:"status"},{tag:"div",ref:"eStatusBarRight",cls:"ag-status-bar-right",role:"status"}]},S$=class extends m.Component{constructor(){super(C$),this.updateQueued=!1,this.panelsPromise=m.AgPromise.resolve(),this.eStatusBarLeft=m.RefPlaceholder,this.eStatusBarCenter=m.RefPlaceholder,this.eStatusBarRight=m.RefPlaceholder,this.compDestroyFunctions={},this.registerCSS(v$)}wireBeans(e){this.userCompFactory=e.userCompFactory,this.statusBarSvc=e.statusBarSvc}postConstruct(){this.processStatusPanels(new Map),this.addManagedPropertyListeners(["statusBar"],this.handleStatusBarChanged.bind(this))}processStatusPanels(e){var i;const t=(i=this.gos.get("statusBar"))==null?void 0:i.statusPanels;if(t){const s=t.filter(r=>r.align==="left"),n=t.filter(r=>r.align==="center"),a=t.filter(r=>!r.align||r.align==="right");this.panelsPromise=m.AgPromise.all([this.createAndRenderComponents(s,this.eStatusBarLeft,e),this.createAndRenderComponents(n,this.eStatusBarCenter,e),this.createAndRenderComponents(a,this.eStatusBarRight,e)])}else this.setDisplayed(!1)}handleStatusBarChanged(){this.updateQueued||(this.updateQueued=!0,this.panelsPromise.then(()=>{this.updateStatusBar(),this.updateQueued=!1}))}updateStatusBar(){var s;const e=(s=this.gos.get("statusBar"))==null?void 0:s.statusPanels,t=Array.isArray(e)&&e.length>0;this.setDisplayed(t);const i=new Map;t&&e.forEach(n=>{var o,l;const a=(o=n.key)!=null?o:n.statusPanel,r=this.statusBarSvc.getStatusPanel(a);if(r!=null&&r.refresh){const c=(0,m._addGridCommonParams)(this.gos,E(b({},(l=n.statusPanelParams)!=null?l:{}),{key:a}));r.refresh(c)&&(i.set(a,r),delete this.compDestroyFunctions[a],(0,m._removeFromParent)(r.getGui()))}}),this.resetStatusBar(),t&&this.processStatusPanels(i)}resetStatusBar(){(0,m._clearElement)(this.eStatusBarLeft),(0,m._clearElement)(this.eStatusBarCenter),(0,m._clearElement)(this.eStatusBarRight),this.destroyComponents(),this.statusBarSvc.unregisterAllComponents()}destroy(){this.destroyComponents(),super.destroy()}destroyComponents(){Object.values(this.compDestroyFunctions).forEach(e=>e()),this.compDestroyFunctions={}}createAndRenderComponents(e,t,i){const s=[];return e.forEach(n=>{const a=n.key||n.statusPanel,r=i.get(a);let o;if(r)o=m.AgPromise.resolve(r);else{const l=b$(this.userCompFactory,n,(0,m._addGridCommonParams)(this.gos,{key:a}));if(l==null)return;o=l.newAgStackInstance()}s.push({key:a,promise:o})}),m.AgPromise.all(s.map(n=>n.promise)).then(()=>{s.forEach(n=>{n.promise.then(a=>{const r=()=>{this.destroyBean(a)};this.isAlive()?(this.statusBarSvc.registerStatusPanel(n.key,a),t.appendChild(a.getGui()),this.compDestroyFunctions[n.key]=r):r()})})})}},M$={selector:"AG-STATUS-BAR",component:S$},D$={tag:"div",cls:"ag-status-name-value",children:[{tag:"span",ref:"eLabel"},":\xA0",{tag:"span",ref:"eValue",cls:"ag-status-name-value-value"}]},Up=class extends m.Component{constructor(){super(D$),this.eLabel=m.RefPlaceholder,this.eValue=m.RefPlaceholder}setLabel(e,t){this.setDisplayed(!1),this.eLabel.textContent=this.getLocaleTextFunc()(e,t)}setValue(e,t){this.eValue.textContent=this.valueFormatter((0,m._addGridCommonParams)(this.gos,{value:e,totalRows:t,key:this.key}))}},w$={selector:"AG-NAME-VALUE",component:Up},nL=e=>{let t=0;return e.forEachNodeAfterFilter(i=>{i.data&&t++}),t},Kp=e=>{let t=0;return e.forEachNode(i=>{i.data&&t++}),t};function A$(e,t){return typeof e!="number"?"":(0,m._formatNumberCommas)(Math.round(e*100)/100,t)}var I$={tag:"div",cls:"ag-status-panel ag-status-panel-aggregations",children:[{tag:"ag-name-value",ref:"avgAggregationComp"},{tag:"ag-name-value",ref:"countAggregationComp"},{tag:"ag-name-value",ref:"minAggregationComp"},{tag:"ag-name-value",ref:"maxAggregationComp"},{tag:"ag-name-value",ref:"sumAggregationComp"}]},T$=class extends m.Component{constructor(){super(I$,[w$]),this.sumAggregationComp=m.RefPlaceholder,this.countAggregationComp=m.RefPlaceholder,this.minAggregationComp=m.RefPlaceholder,this.maxAggregationComp=m.RefPlaceholder,this.avgAggregationComp=m.RefPlaceholder}postConstruct(){if(!(0,m._isClientSideRowModel)(this.gos)&&!(0,m._isServerSideRowModel)(this.gos)){(0,m._warn)(221);return}this.avgAggregationComp.setLabel("avg","Average"),this.countAggregationComp.setLabel("count","Count"),this.minAggregationComp.setLabel("min","Min"),this.maxAggregationComp.setLabel("max","Max"),this.sumAggregationComp.setLabel("sum","Sum"),this.addManagedEventListeners({cellSelectionChanged:this.onCellSelectionChanged.bind(this),modelUpdated:this.onCellSelectionChanged.bind(this)})}init(e){this.refresh(e)}refresh(e){var s;this.params=e;const t=(s=e.valueFormatter)!=null?s:({value:n})=>A$(n,this.getLocaleTextFunc.bind(this)),i=["avg","count","min","max","sum"];for(const n of i){const a=this.getAllowedAggregationValueComponent(n);a&&(a.key=n,a.valueFormatter=t.bind(this))}return this.onCellSelectionChanged(),!0}setAggregationComponentValue(e,t,i){var a;const s=this.getAllowedAggregationValueComponent(e),n=Kp(this.beans.rowModel);(0,m._exists)(s)&&s?(s.setValue(t,n),s.setDisplayed(i)):(a=this.getAggregationValueComponent(e))==null||a.setDisplayed(!1)}getAllowedAggregationValueComponent(e){const{aggFuncs:t}=this.params;return!t||t.includes(e)?this.getAggregationValueComponent(e):null}getAggregationValueComponent(e){const t=`${e}AggregationComp`;return this[t]}onCellSelectionChanged(){const e=this.beans,{rangeSvc:t,valueSvc:i}=e,s=t==null?void 0:t.getCellRanges();let n=0,a=0,r=0,o=null,l=null;const c={};if(s!=null&&s.length&&t)for(let u=0;u<s.length;u++){const p=s[u];let g=t.getRangeStartRow(p);const f=t.getRangeEndRow(p);for(;!((0,m._missing)(g)||!g||(0,m._isRowBefore)(f,g)||!g||!p.columns);)p.columns.forEach(v=>{if(g===null)return;const x=(0,m._createCellId)({rowPinned:g.rowPinned,column:v,rowIndex:g.rowIndex});if(c[x])return;c[x]=!0;const S=(0,m._getRowNode)(e,g);if((0,m._missing)(S))return;let M=i.getValue(v,S);(0,m._missing)(M)||M===""||(a++,!(typeof M=="object"&&"value"in M&&(M=M.value,M===""))&&(typeof M=="string"&&(M=Number(M)),typeof M=="number"&&!isNaN(M)&&(n+=M,(l===null||M>l)&&(l=M),(o===null||M<o)&&(o=M),r++)))}),g=(0,m._getRowBelow)(e,g)}const h=a>1,d=r>1;this.setAggregationComponentValue("count",a,h),this.setAggregationComponentValue("sum",n,d),this.setAggregationComponentValue("min",o,d),this.setAggregationComponentValue("max",l,d),this.setAggregationComponentValue("avg",n/r,d)}},k$=class extends Up{postConstruct(){if(this.setLabel("filteredRows","Filtered"),!(0,m._isClientSideRowModel)(this.gos)){(0,m._warn)(222);return}this.addCss("ag-status-panel"),this.addCss("ag-status-panel-filtered-row-count"),this.setDisplayed(!0);const e=this.onDataChanged.bind(this);this.addManagedEventListeners({modelUpdated:e})}onDataChanged(){const{rowModel:e}=this.beans,t=Kp(e),i=nL(e);this.setValue(i,t),this.setDisplayed(t!==i)}init(e){this.refresh(e),this.onDataChanged()}updateValueFormatter(e){this.valueFormatter=e!=null?e:({value:t})=>(0,m._formatNumberCommas)(t,this.getLocaleTextFunc.bind(this))}refresh(e){const{key:t,valueFormatter:i}=e;return this.key=t,this.updateValueFormatter(i),!0}},L$=class extends Up{postConstruct(){const e=this.gos;if(!(0,m._isClientSideRowModel)(e)&&!(0,m._isServerSideRowModel)(e)){(0,m._warn)(223);return}this.setLabel("selectedRows","Selected"),this.addCss("ag-status-panel"),this.addCss("ag-status-panel-selected-row-count");const t=this.onRowSelectionChanged.bind(this);this.addManagedEventListeners({modelUpdated:t,selectionChanged:t})}onRowSelectionChanged(){var n;const{selectionSvc:e,rowModel:t}=this.beans,i=(n=e==null?void 0:e.getSelectionCount())!=null?n:0,s=Kp(t);if(this.setValue(i,s),i<0){this.setDisplayed(!0);return}this.setDisplayed(i>0)}init(e){this.refresh(e),this.onRowSelectionChanged()}updateValueFormatter(e){this.valueFormatter=e!=null?e:({value:t})=>t==null||t>=0?(0,m._formatNumberCommas)(t,this.getLocaleTextFunc.bind(this)):this.getLocaleTextFunc()("statusBarLastRowUnknown","?")}refresh(e){const{key:t,valueFormatter:i}=e;return this.key=t,this.updateValueFormatter(i),!0}},P$=class extends Up{postConstruct(){if(!(0,m._isClientSideRowModel)(this.gos)){(0,m._warn)(224);return}this.setLabel("totalAndFilteredRows","Rows"),this.addCss("ag-status-panel"),this.addCss("ag-status-panel-total-and-filtered-row-count"),this.setDisplayed(!0),this.addManagedEventListeners({modelUpdated:this.onDataChanged.bind(this)})}onDataChanged(){const{rowModel:e}=this.beans,t=nL(e),i=Kp(e);this.setValue(t,i)}init(e){this.refresh(e),this.onDataChanged()}updateValueFormatter(e){this.valueFormatter=e!=null?e:({value:t,totalRows:i})=>{const s=this.getLocaleTextFunc.bind(this),n=(0,m._formatNumberCommas)(t,s),a=(0,m._formatNumberCommas)(i!=null?i:t,s);if(t===i)return n;const r=s();return`${n} ${r("of","of")} ${a}`}}refresh(e){const{key:t,valueFormatter:i}=e;return this.key=t,this.updateValueFormatter(i),!0}},E$=class extends Up{postConstruct(){if(this.setLabel("totalRows","Total Rows"),!(0,m._isClientSideRowModel)(this.gos)){(0,m._warn)(225);return}this.addCss("ag-status-panel"),this.addCss("ag-status-panel-total-row-count"),this.setDisplayed(!0),this.addManagedEventListeners({modelUpdated:this.onDataChanged.bind(this)})}onDataChanged(){const e=Kp(this.beans.rowModel);this.setValue(e,e)}init(e){this.refresh(e),this.onDataChanged()}updateValueFormatter(e){this.valueFormatter=e!=null?e:({value:t})=>(0,m._formatNumberCommas)(t,this.getLocaleTextFunc.bind(this))}refresh(e){const{key:t,valueFormatter:i}=e;return this.key=t,this.updateValueFormatter(i),!0}};function R$(e,t){var s;const i=(s=e.statusBarSvc)==null?void 0:s.getStatusPanel(t);return(0,m._unwrapUserComp)(i)}var N$=class extends m.BeanStub{constructor(){super(),this.beanName="statusBarSvc",this.comps=new Map}registerStatusPanel(e,t){this.comps.set(e,t)}unregisterStatusPanel(e){this.comps.delete(e)}unregisterAllComponents(){this.comps.clear()}getStatusPanel(e){return this.comps.get(e)}destroy(){this.unregisterAllComponents(),super.destroy()}},O$={moduleName:"StatusBar",version:Re,beans:[N$],userComponents:{agAggregationComponent:T$,agTotalRowCountComponent:E$,agFilteredRowCountComponent:k$,agTotalAndFilteredRowCountComponent:P$,agSelectedRowCountComponent:L$},selectors:[M$],apiFunctions:{getStatusPanel:R$},dependsOn:[St,m._KeyboardNavigationModule]};function aL(e){var t;return((t=e.excelCreator)==null?void 0:t.getFactoryMode())==="MULTI_SHEET"?((0,m._warn)(161),!1):!0}function F$(e,t){var i;if(aL(e))return(i=e.excelCreator)==null?void 0:i.getDataAsExcel(t)}function B$(e,t){var i;aL(e)&&((i=e.excelCreator)==null||i.exportDataAsExcel(t))}function _$(e,t){var i,s;return(i=e.excelCreator)==null||i.setFactoryMode("MULTI_SHEET"),(s=e.excelCreator)==null?void 0:s.getSheetDataForExcel(t)}function G$(e,t){var i;return(i=e.excelCreator)==null?void 0:i.getMultipleSheetsAsExcel(t)}function z$(e,t){var i;(i=e.excelCreator)==null||i.exportMultipleSheetsAsExcel(t)}var V$={moduleName:"ExcelExport",version:Re,beans:[x5],apiFunctions:{getDataAsExcel:F$,exportDataAsExcel:B$,getSheetDataForExcel:_$,getMultipleSheetsAsExcel:G$,exportMultipleSheetsAsExcel:z$},dependsOn:[m._SharedExportModule,St]};function j$(e){const t=e.cssIdentifier||"default",i=e.direction||"vertical";return{tag:"div",cls:`ag-group ag-${t}-group`,role:"presentation",children:[{tag:"div",ref:"eToolbar",cls:`ag-group-toolbar ag-${t}-group-toolbar`,children:[{tag:"ag-checkbox",ref:"cbGroupEnabled"}]},{tag:"div",ref:"eContainer",cls:`ag-group-container ag-group-container-${i} ag-${t}-group-container`}]}}var uo=class extends m.Component{constructor(e={}){super(j$(e),[m.AgCheckboxSelector]),this.params=e,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1,this.eToolbar=m.RefPlaceholder,this.cbGroupEnabled=m.RefPlaceholder,this.eContainer=m.RefPlaceholder;const{enabled:t,items:i,suppressEnabledCheckbox:s,expanded:n,suppressToggleExpandOnEnableChange:a,useToggle:r}=e;this.cssIdentifier=e.cssIdentifier||"default",this.enabled=t!=null?t:!0,this.items=i||[],this.useToggle=r!=null?r:!1,this.alignItems=e.alignItems||"center",this.expanded=n==null?!0:n,s!=null&&(this.suppressEnabledCheckbox=s),a!=null&&(this.suppressToggleExpandOnEnableChange=a)}postConstruct(){if(this.setupTitleBar(),this.items.length){const n=this.items;this.items=[],this.addItems(n)}const e=this.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange:t,onExpandedChange:i,suppressOpenCloseIcons:s}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(s!=null?s:!1),this.refreshChildDisplay(),(0,m._setDisplayed)(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(n=>{this.setEnabled(n,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(n)}),t!=null&&this.onEnableChange(t),i!=null&&this.onExpandedChange(i)}refreshChildDisplay(){var e;(0,m._setDisplayed)(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),(e=this.eTitleBar)==null||e.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(e){this.alignItems!==e&&this.removeCss(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=e;const t=`ag-group-item-alignment-${this.alignItems}`;return this.addCss(t),this}toggleGroupExpand(e,t){var i;if((i=this.eTitleBar)!=null&&i.isSuppressCollapse()&&!this.useToggle)e=!0,t=!0;else if(e=e!=null?e:!this.expanded,this.expanded===e)return this;return this.expanded=e,this.refreshChildDisplay(),(0,m._setDisplayed)(this.eContainer,e),t||this.dispatchLocalEvent({type:e?"expanded":"collapsed"}),this}addItems(e){e.forEach(t=>this.addItem(t))}prependItem(e){this.insertItem(e,!0)}addItem(e){this.insertItem(e,!1)}insertItem(e,t){const i=this.eContainer,s=e instanceof m.Component?e.getGui():e;s.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),t?(i.insertAdjacentElement("afterbegin",s),this.items.unshift(s)):(i.appendChild(s),this.items.push(s))}hideItem(e,t){const i=this.items[t];(0,m._setDisplayed)(i,!e)}getItemIndex(e){const t=e instanceof m.Component?e.getGui():e;return this.items.indexOf(t)}setTitle(e){var t;return(t=this.eTitleBar)==null||t.setTitle(e),this}addTitleBarWidget(e){var t;return(t=this.eTitleBar)==null||t.addWidget(e),this}addCssClassToTitleBar(e){var t;(t=this.eTitleBar)==null||t.addCss(e)}dispatchEnableChangeEvent(e){const t={type:"enableChange",enabled:e};this.dispatchLocalEvent(t)}setEnabled(e,t,i){var s;return this.enabled=e,this.refreshDisabledStyles(),i||this.toggleGroupExpand(e),t||(this.cbGroupEnabled.setValue(e),(s=this.eToggle)==null||s.setValue(e)),this}isEnabled(){return this.enabled}onEnableChange(e){return this.addManagedListeners(this,{enableChange:t=>e(t.enabled)}),this}onExpandedChange(e){return this.addManagedListeners(this,{expanded:()=>e(!0),collapsed:()=>e(!1)}),this}hideEnabledCheckbox(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(e){var t;return(t=this.eTitleBar)==null||t.hideOpenCloseIcons(e),this}refreshDisabledStyles(){var t;const e=!this.enabled;this.eContainer.classList.toggle("ag-disabled",e),(t=this.eTitleBar)==null||t.refreshDisabledStyles(this.suppressEnabledCheckbox&&e),this.eContainer.classList.toggle("ag-disabled-group-container",e)}setupTitleBar(){const e=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",e.getGui())}createDefaultTitleBar(){const e=this.createManagedBean(new W$(this.params));return this.eTitleBar=e,e.refreshOnExpand(this.expanded),this.addManagedListeners(e,{expandedChanged:t=>this.toggleGroupExpand(t.expanded)}),e}createToggleTitleBar(){var t;const e=this.createManagedBean(new m.AgToggleButton({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:i=>{this.setEnabled(i,!0),this.dispatchEnableChangeEvent(i)}}));return e.addCss("ag-group-title-bar"),e.addCss(`ag-${(t=this.params.cssIdentifier)!=null?t:"default"}-group-title-bar ag-unselectable`),this.eToggle=e,this.toggleGroupExpand(this.enabled),e}},CS="ag-disabled-group-title-bar";function H$(e){var i;const t=(i=e.cssIdentifier)!=null?i:"default";return{tag:"div",cls:`ag-group-title-bar ag-${t}-group-title-bar ag-unselectable`,role:e.suppressKeyboardNavigation?"presentation":"role",children:[{tag:"span",ref:"eGroupOpenedIcon",cls:`ag-group-title-bar-icon ag-${t}-group-title-bar-icon`,role:"presentation"},{tag:"span",ref:"eGroupClosedIcon",cls:`ag-group-title-bar-icon ag-${t}-group-title-bar-icon`,role:"presentation"},{tag:"span",ref:"eTitle",cls:`ag-group-title ag-${t}-group-title`}]}}var W$=class extends m.Component{constructor(e={}){super(H$(e)),this.suppressOpenCloseIcons=!1,this.suppressKeyboardNavigation=!1,this.eGroupOpenedIcon=m.RefPlaceholder,this.eGroupClosedIcon=m.RefPlaceholder,this.eTitle=m.RefPlaceholder;const{title:t,suppressOpenCloseIcons:i,suppressKeyboardNavigation:s}=e;t&&t.length>0&&(this.title=t),i!=null&&(this.suppressOpenCloseIcons=i),this.suppressKeyboardNavigation=s!=null?s:!1}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild((0,m._createIcon)("accordionClosed",this.beans,null)),this.eGroupOpenedIcon.appendChild((0,m._createIcon)("accordionOpen",this.beans,null)),this.addManagedElementListeners(this.getGui(),{click:()=>this.dispatchExpandChanged(),keydown:e=>{switch(e.key){case m.KeyCode.ENTER:case m.KeyCode.SPACE:e.preventDefault(),this.dispatchExpandChanged();break;case m.KeyCode.RIGHT:case m.KeyCode.LEFT:e.preventDefault(),this.dispatchExpandChanged(e.key===m.KeyCode.RIGHT);break}}})}refreshOnExpand(e){this.refreshAriaStatus(e),this.refreshOpenCloseIcons(e)}refreshAriaStatus(e){this.suppressOpenCloseIcons||(0,m._setAriaExpanded)(this.getGui(),e)}refreshOpenCloseIcons(e){const t=!this.suppressOpenCloseIcons;(0,m._setDisplayed)(this.eGroupOpenedIcon,t&&e),(0,m._setDisplayed)(this.eGroupClosedIcon,t&&!e)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(e){const t={type:"expandedChanged",expanded:e};this.dispatchLocalEvent(t)}setTitle(e){const t=this.getGui(),i=!!e&&e.length>0;e=i?e:void 0,this.eTitle.textContent=e!=null?e:"",(0,m._setDisplayed)(t,i),e!==this.title&&(this.title=e);const s=t.classList.contains(CS);return this.refreshDisabledStyles(s),this}addWidget(e){return this.getGui().appendChild(e),this}hideOpenCloseIcons(e){return this.suppressOpenCloseIcons=e,e&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(e){const t=this.getGui();e?(t.classList.add(CS),t.removeAttribute("tabindex")):(t.classList.remove(CS),typeof this.title=="string"&&!this.suppressKeyboardNavigation?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex"))}},Nt={selector:"AG-GROUP-COMPONENT",component:uo};function rL(e){const{filters:t}=e;return t&&t.length>0?t:[{filter:"agTextColumnFilter"},{filter:"agSetColumnFilter"}]}function oL(e,t){if(e!=null)for(let i=e.length-1;i>=0;i--)t(e[i],i)}function U$(e,t){return t.title!=null?t.title:e instanceof m.ProvidedFilter?e.getFilterTitle():"Filter"}var lL=class extends m.TabGuardComp{constructor(){super({tag:"div",cls:"ag-multi-filter ag-menu-list-compact"}),this.filterType="multi",this.filterDefs=[],this.filters=[],this.guiDestroyFuncs=[],this.filterGuis=[],this.activeFilterIndices=[],this.lastActivatedMenuItem=null,this.afterFiltersReadyFuncs=[]}postConstruct(){this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e)})}init(e){this.params=e,this.filterDefs=rL(e);const{column:t,filterChangedCallback:i}=e;this.column=t,this.filterChangedCallback=i;const s=[];return this.filterDefs.forEach((n,a)=>{const r=this.createFilter(n,a);r!=null&&s.push(r)}),new m.AgPromise(n=>{m.AgPromise.all(s).then(a=>{this.filters=a,this.refreshGui("columnMenu").then(()=>{n()})})}).then(()=>{this.afterFiltersReadyFuncs.forEach(n=>n()),this.afterFiltersReadyFuncs.length=0})}refreshGui(e){return e===this.lastOpenedInContainer?m.AgPromise.resolve():(this.tabGuardFeature.removeAllChildrenExceptTabGuards(),this.destroyChildren(),m.AgPromise.all(this.filters.map((t,i)=>{const s=this.filterDefs[i],n=U$(t,s);let a;if(s.display==="subMenu"&&e!=="toolPanel")a=this.insertFilterMenu(t,n).then(r=>r.getGui());else if(s.display==="subMenu"||s.display==="accordion"){const r=this.insertFilterGroup(t,n);a=m.AgPromise.resolve(r.getGui())}else a=m.AgPromise.resolve(t.getGui());return a})).then(t=>{t.forEach((i,s)=>{s>0&&this.appendChild((0,m._createElement)({tag:"div",cls:"ag-filter-separator"})),this.appendChild(i)}),this.filterGuis=t,this.lastOpenedInContainer=e}))}destroyChildren(){this.guiDestroyFuncs.forEach(e=>e()),this.guiDestroyFuncs.length=0,this.filterGuis.length=0}insertFilterMenu(e,t){const i=this.createBean(new yS);return i.init({menuItemDef:{name:t,subMenu:[],subMenuRole:"dialog",cssClasses:["ag-multi-filter-menu-item"],menuItem:Tk,menuItemParams:{cssClassPrefix:"ag-compact-menu-option",isCompact:!0}},level:0,isAnotherSubMenuOpen:()=>!1,childComponent:e,contextParams:{column:null,node:null,value:null}}).then(()=>{i.setParentComponent(this),this.guiDestroyFuncs.push(()=>this.destroyBean(i)),this.addManagedListeners(i,{menuItemActivated:n=>{this.lastActivatedMenuItem&&this.lastActivatedMenuItem!==n.menuItem&&this.lastActivatedMenuItem.deactivate(),this.lastActivatedMenuItem=n.menuItem}});const s=i.getGui();return i.addManagedElementListeners(s,{keydown:n=>{const{key:a}=n;switch(a){case m.KeyCode.UP:case m.KeyCode.RIGHT:case m.KeyCode.DOWN:case m.KeyCode.LEFT:n.preventDefault(),a===m.KeyCode.RIGHT&&i.openSubMenu(!0);break}},focusin:()=>i.activate(),focusout:()=>{!i.isSubMenuOpen()&&!i.isSubMenuOpening()&&i.deactivate()}}),i})}insertFilterGroup(e,t){const i=this.createBean(new uo({title:t,cssIdentifier:"multi-filter"}));return this.guiDestroyFuncs.push(()=>this.destroyBean(i)),i.addItem(e.getGui()),i.toggleGroupExpand(!1),e.afterGuiAttached&&i.addManagedListeners(i,{expanded:()=>e.afterGuiAttached({container:this.lastOpenedInContainer,suppressFocus:!0,hidePopup:this.hidePopup})}),i}isFilterActive(){return this.filters.some(e=>e.isFilterActive())}getLastActiveFilterIndex(){const e=this.activeFilterIndices;return e.length>0?e[e.length-1]:null}doesFilterPass(e,t){let i=!0;return this.filters.forEach(s=>{!i||s===t||!s.isFilterActive()||(i=s.doesFilterPass(e))}),i}getModelFromUi(){return{filterType:this.filterType,filterModels:this.filters.map(t=>{const i=t;return typeof i.getModelFromUi=="function"?i.getModelFromUi():null})}}getModel(){return this.isFilterActive()?{filterType:this.filterType,filterModels:this.filters.map(t=>t.isFilterActive()?t.getModel():null)}:null}setModel(e){const t=(s,n)=>new m.AgPromise(a=>{const r=s.setModel(n);r?r.then(()=>a()):a()});let i=[];return e==null?i=this.filters.map((s,n)=>t(s,null).then(()=>{this.updateActiveList(n)})):this.filters.forEach((s,n)=>{const a=e.filterModels.length>n?e.filterModels[n]:null,r=t(s,a).then(()=>{this.updateActiveList(n)});i.push(r)}),m.AgPromise.all(i).then(()=>{})}applyModel(e="api"){let t=!1;return this.filters.forEach(i=>{i instanceof m.ProvidedFilter&&(t=i.applyModel(e)||t)}),t}getChildFilterInstance(e){return this.filters[e]}afterGuiAttached(e){let t;e?(this.hidePopup=e.hidePopup,t=this.refreshGui(e.container)):(this.hidePopup=void 0,t=m.AgPromise.resolve());const i=e==null?void 0:e.suppressFocus;t.then(()=>{const{filterDefs:s,filters:n,filterGuis:a,beans:r}=this;let o=!!i;s&&oL(s,(c,h)=>{const d=h===0,u=c.display&&c.display!=="inline",p=i||!d||u,g=E(b({},e!=null?e:{}),{suppressFocus:p}),f=n==null?void 0:n[h];if(f&&(this.executeFunctionIfExistsOnFilter(f,"afterGuiAttached",g),d&&!p&&(o=!0)),!i&&d&&u){const y=a[h];y&&((0,m._focusInto)(y)||y.focus({preventScroll:!0}),o=!0)}});const l=(0,m._getActiveDomElement)(r);!o&&((0,m._isNothingFocused)(r)||this.getGui().contains(l))&&this.forceFocusOutOfContainer(!0)})}afterGuiDetached(){this.executeFunctionIfExists("afterGuiDetached")}onAnyFilterChanged(){this.executeFunctionIfExists("onAnyFilterChanged")}onNewRowsLoaded(){this.executeFunctionIfExists("onNewRowsLoaded")}destroy(){this.filters.forEach(e=>this.destroyBean(e)),this.filters.length=0,this.destroyChildren(),this.hidePopup=void 0,super.destroy()}executeFunctionIfExists(e,...t){oL(this.filters,i=>{this.executeFunctionIfExistsOnFilter(i,e,t)})}executeFunctionIfExistsOnFilter(e,t,...i){const s=e[t];typeof s=="function"&&s.apply(e,i)}createFilter(e,t){const{filterModifiedCallback:i,doesRowPassOtherFilter:s}=this.params,{filterManager:n,userCompFactory:a}=this.beans;let r;const o=E(b({},n.createFilterParams(this.column,this.column.getColDef())),{filterModifiedCallback:i,filterChangedCallback:h=>{this.executeWhenAllFiltersReady(()=>this.filterChanged(t,h))},doesRowPassOtherFilter:h=>s(h)&&this.doesFilterPass({node:h,data:h.data},r)}),l=(0,m._getFilterDetails)(a,e,o,"agTextColumnFilter");if(!l)return null;const c=l.newAgStackInstance();return c.then(h=>{if(h&&(r=h,e.display==="subMenu")){const d=h.getGui();(0,m._setAriaRole)(d,"dialog")}}),c}executeWhenAllFiltersReady(e){var t,i;((i=(t=this.filters)==null?void 0:t.length)!=null?i:0)>0?e():this.afterFiltersReadyFuncs.push(e)}updateActiveList(e){const{filters:t,activeFilterIndices:i}=this,s=t[e];(0,m._removeFromArray)(i,e),s.isFilterActive()&&i.push(e)}filterChanged(e,t){this.updateActiveList(e),this.filterChangedCallback(t);const i=this.filters[e];this.filters.forEach(s=>{s!==i&&typeof s.onAnyFilterChanged=="function"&&s.onAnyFilterChanged()})}onFocusIn(e){const t=this.lastActivatedMenuItem;t!=null&&!t.getGui().contains(e.target)&&(t.deactivate(),this.lastActivatedMenuItem=null)}getModelAsString(e){var s,n,a,r;if(!this.filters||!((s=e==null?void 0:e.filterModels)!=null&&s.length))return"";const t=(n=this.getLastActiveFilterIndex())!=null?n:0,i=this.filters[t];return(r=(a=i.getModelAsString)==null?void 0:a.call(i,e.filterModels[t]))!=null?r:""}},K$={tag:"div",cls:"ag-multi-floating-filter ag-floating-filter-input"},$$=class extends m.Component{constructor(){super(K$),this.floatingFilters=[],this.compDetailsList=[]}init(e){this.params=e;const{compDetailsList:t}=this.getCompDetailsList(e);return this.setParams(t)}setParams(e){const t=[];return e.forEach(i=>{const s=i==null?void 0:i.newAgStackInstance();s!=null&&(this.compDetailsList.push(i),t.push(s))}),m.AgPromise.all(t).then(i=>{i.forEach((s,n)=>{this.floatingFilters.push(s);const a=s.getGui();this.appendChild(a),n>0&&(0,m._setDisplayed)(a,!1)})})}refresh(e){this.params=e;const{compDetailsList:t,floatingFilterParamsList:i}=this.getCompDetailsList(e);t.length===this.compDetailsList.length&&t.every((n,a)=>{var r;return!((r=this.beans.filterManager)!=null&&r.areFilterCompsDifferent(this.compDetailsList[a],n))})?i.forEach((n,a)=>{var o;const r=this.floatingFilters[a];(o=r.refresh)==null||o.call(r,n)}):((0,m._clearElement)(this.getGui()),this.destroyBeans(this.floatingFilters),this.floatingFilters=[],this.compDetailsList=[],this.setParams(t))}getCompDetailsList(e){const t=[],i=[],s=e.filterParams,n=e.currentParentModel;return rL(s).forEach((a,r)=>{const o=E(b({},e),{parentFilterInstance:c=>{this.parentMultiFilterInstance(h=>{const d=h.getChildFilterInstance(r);d!=null&&c(d)})},currentParentModel:()=>{var c,h,d;return(d=(h=(c=n())==null?void 0:c.filterModels)==null?void 0:h[r])!=null?d:null}});(0,m._mergeDeep)(o.filterParams,a.filterParams);const l=this.getCompDetails(a,o);l&&(t.push(l),i.push(o))}),{compDetailsList:t,floatingFilterParamsList:i}}onParentModelChanged(e,t){t&&t.afterFloatingFilter||this.parentMultiFilterInstance(i=>{if(e==null)this.floatingFilters.forEach((s,n)=>{s.onParentModelChanged(null,t),(0,m._setDisplayed)(s.getGui(),n===0)});else{const s=i.getLastActiveFilterIndex();this.floatingFilters.forEach((n,a)=>{const r=e.filterModels.length>a?e.filterModels[a]:null;n.onParentModelChanged(r,t);const o=s==null?a===0:a===s;(0,m._setDisplayed)(n.getGui(),o)})}})}destroy(){this.destroyBeans(this.floatingFilters),this.floatingFilters.length=0,super.destroy()}getCompDetails(e,t){var r;const{filterManager:i,frameworkOverrides:s,userCompFactory:n}=this.beans,a=(r=(0,m._getDefaultFloatingFilterType)(s,e,()=>i.getDefaultFloatingFilter(this.params.column)))!=null?r:"agReadOnlyFloatingFilter";return(0,m._getFloatingFilterCompDetails)(n,e,t,a)}parentMultiFilterInstance(e){this.params.parentFilterInstance(t=>{t instanceof lL||(0,m._error)(120),e(t)})}},Y$={moduleName:"MultiFilter",version:Re,userComponents:{agMultiColumnFilter:lL,agMultiColumnFloatingFilter:$$},dependsOn:[St,m._ColumnFilterModule,Vm]},X$=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="aggColNameSvc"}getHeaderName(e,t){var c;if(this.gos.get("suppressAggFuncInHeader"))return t;const{valueColsSvc:i,colModel:s,rowGroupColsSvc:n}=this.beans,a=e.getColDef().pivotValueColumn,r=(0,m._exists)(a);let o=null,l;if(r){const h=(c=i==null?void 0:i.columns)!=null?c:[],d=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&h.length===1,u=e.getColDef().pivotTotalColumnIds!==void 0;if(d&&!u)return t;o=a?a.getAggFunc():null,l=!0}else{const h=e.isValueActive(),d=s.isPivotMode()||(n==null?void 0:n.columns.length)!==0;h&&d?(o=e.getAggFunc(),l=!0):l=!1}if(l){const h=typeof o=="string"?o:"func";return`${this.getLocaleTextFunc()(h,h)}(${t})`}return t}},Z$={sum:"Sum",first:"First",last:"Last",min:"Min",max:"Max",count:"Count",avg:"Average"},q$=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="aggFuncSvc",this.aggFuncsMap={},this.initialised=!1}postConstruct(){this.init()}init(){this.initialised||(this.initialiseWithDefaultAggregations(),this.addAggFuncs(this.gos.get("aggFuncs")))}initialiseWithDefaultAggregations(){const e=this.aggFuncsMap;e.sum=Q$,e.first=J$,e.last=eY,e.min=tY,e.max=iY,e.count=sY,e.avg=nY,this.initialised=!0}isAggFuncPossible(e,t){const s=this.getFuncNames(e).includes(t),n=(0,m._exists)(this.aggFuncsMap[t]);return s&&n}getDefaultFuncLabel(e){var t;return(t=Z$[e])!=null?t:e}getDefaultAggFunc(e){const t=e.getColDef().defaultAggFunc;if((0,m._exists)(t)&&this.isAggFuncPossible(e,t))return t;if(this.isAggFuncPossible(e,"sum"))return"sum";const i=this.getFuncNames(e);return i!=null&&i.length?i[0]:null}addAggFuncs(e){if(this.init(),!!e)for(const t of Object.keys(e))this.aggFuncsMap[t]=e[t]}getAggFunc(e){return this.init(),this.aggFuncsMap[e]}getFuncNames(e){const t=e.getColDef().allowedAggFuncs;return t==null?Object.keys(this.aggFuncsMap).sort():t}clear(){this.aggFuncsMap={}}};function Q$(e){const{values:t}=e;let i=null;for(let s=0;s<t.length;s++){const n=t[s];typeof n=="number"?i===null?i=n:i+=typeof i=="number"?n:BigInt(n):typeof n=="bigint"&&(i===null?i=n:i=(typeof i=="bigint"?i:BigInt(i))+n)}return i}function J$(e){return e.values.length>0?e.values[0]:null}function eY(e){return e.values.length>0?(0,m._last)(e.values):null}function tY(e){const{values:t}=e;let i=null;for(let s=0;s<t.length;s++){const n=t[s];(typeof n=="number"||typeof n=="bigint")&&(i===null||i>n)&&(i=n)}return i}function iY(e){const{values:t}=e;let i=null;for(let s=0;s<t.length;s++){const n=t[s];(typeof n=="number"||typeof n=="bigint")&&(i===null||i<n)&&(i=n)}return i}function sY(e){var n,a;const{values:t}=e;let i=0;for(let r=0;r<t.length;r++){const o=t[r];i+=o!=null&&typeof o.value=="number"?o.value:1}const s=(a=(n=e.rowNode)==null?void 0:n.aggData)==null?void 0:a[e.column.getColId()];return s&&s.value===i?s:{value:i,toString:function(){return this.value.toString()},toNumber:function(){return this.value}}}function nY(e){var r,o,l;const{values:t}=e;let i=0,s=0;for(let c=0;c<t.length;c++){const h=t[c];let d=null;typeof h=="number"||typeof h=="bigint"?(d=h,s++):h!=null&&(typeof h.value=="number"||typeof h.value=="bigint")&&typeof h.count=="number"&&(d=h.value*(typeof h.value=="number"?h.count:BigInt(h.count)),s+=h.count),typeof d=="number"?i+=typeof i=="number"?d:BigInt(d):typeof d=="bigint"&&(i=(typeof i=="bigint"?i:BigInt(i))+d)}let n=null;s>0&&(n=i/(typeof i=="number"?s:BigInt(s)));const a=(l=(r=e.rowNode)==null?void 0:r.aggData)==null?void 0:l[(o=e.column)==null?void 0:o.getColId()];return a&&a.count===s&&a.value===n?a:{count:s,value:n,toString:function(){return typeof this.value=="number"||typeof this.value=="bigint"?this.value.toString():""},toNumber:function(){return this.value}}}function aY(e,t){e.aggFuncSvc&&e.aggFuncSvc.addAggFuncs(t)}function rY(e){e.aggFuncSvc&&e.aggFuncSvc.clear()}function oY(e,t,i){var s,n;(n=(s=e.valueColsSvc)==null?void 0:s.setColumnAggFunc)==null||n.call(s,t,i,"api")}function Bd(e,t,i,s,n,a){const r=typeof i=="string"?e.aggFuncSvc.getAggFunc(i):i;if(typeof r!="function")return(0,m._error)(109,{aggFuncOrString:i}),null;const o=(0,m._addGridCommonParams)(e.gos,{values:t,column:s,colDef:s.colDef,pivotResultColumn:a,rowNode:n,data:n==null?void 0:n.data});return r(o)}var lY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="aggStage",this.refreshProps=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","suppressAggFilteredOnly","grandTotalRow"]),this.step="aggregate"}wireBeans(e){this.colModel=e.colModel,this.pivotColsSvc=e.pivotColsSvc,this.valueColsSvc=e.valueColsSvc,this.pivotResultCols=e.pivotResultCols,this.valueSvc=e.valueSvc}execute(e){var n,a,r;const t=!((a=(n=this.valueColsSvc)==null?void 0:n.columns)!=null&&a.length),i=!this.gos.getCallback("getGroupRowAgg");if(t&&i&&((r=e.changedPath)!=null&&r.active))return;const s=this.createAggDetails(e);this.recursivelyCreateAggData(s)}createAggDetails(e){var a;const t=this.colModel.isPivotActive(),i=(a=this.valueColsSvc)==null?void 0:a.columns,s=t&&this.pivotColsSvc?this.pivotColsSvc.columns:[];return{alwaysAggregateAtRootLevel:this.gos.get("alwaysAggregateAtRootLevel"),groupIncludeTotalFooter:!!(0,m._getGrandTotalRow)(this.gos),changedPath:e.changedPath,valueColumns:i!=null?i:[],pivotColumns:s,filteredOnly:!this.isSuppressAggFilteredOnly(),userAggFunc:this.gos.getCallback("getGroupRowAgg")}}isSuppressAggFilteredOnly(){return(0,m._getGroupAggFiltering)(this.gos)!==void 0||this.gos.get("suppressAggFilteredOnly")}recursivelyCreateAggData(e){const t=i=>{if(!i.hasChildren()){i.aggData&&this.setAggData(i,null);return}if(i.level===-1&&!e.groupIncludeTotalFooter){const a=!this.colModel.isPivotMode();if(!e.alwaysAggregateAtRootLevel&&a){this.setAggData(i,null);return}}this.aggregateRowNode(i,e)};e.changedPath.forEachChangedNodeDepthFirst(t,!0)}aggregateRowNode(e,t){const i=t.valueColumns.length===0,s=t.pivotColumns.length===0;let n;t.userAggFunc?n=t.userAggFunc({nodes:e.childrenAfterFilter}):i?n=null:s?n=this.aggregateRowNodeUsingValuesOnly(e,t):n=this.aggregateRowNodeUsingValuesAndPivot(e),this.setAggData(e,n),e.sibling&&this.setAggData(e.sibling,n)}aggregateRowNodeUsingValuesAndPivot(e){var a,r,o,l;const t={},i=(o=(r=(a=this.pivotResultCols)==null?void 0:a.getPivotResultCols())==null?void 0:r.list)!=null?o:[];let s=!0;const n=this.beans;for(let c=0;c<i.length;c++){const h=i[c],d=h.getColDef();if(d.pivotTotalColumnIds!=null){s=!1;continue}const u=(l=d.pivotKeys)!=null?l:[];let p;e.leafGroup?p=this.getValuesFromMappedSet(e.childrenMapped,u,d.pivotValueColumn):p=this.getValuesPivotNonLeaf(e,d.colId),t[d.colId]=Bd(n,p,d.pivotValueColumn.getAggFunc(),d.pivotValueColumn,e,h)}if(!s)for(let c=0;c<i.length;c++){const h=i[c],d=h.getColDef();if(d.pivotTotalColumnIds==null||!d.pivotTotalColumnIds.length)continue;const u=d.pivotTotalColumnIds.map(p=>t[p]);t[d.colId]=Bd(n,u,d.pivotValueColumn.getAggFunc(),d.pivotValueColumn,e,h)}return t}aggregateRowNodeUsingValuesOnly(e,t){const i={},{changedPath:s,valueColumns:n,filteredOnly:a}=t,r=s.active?s.getValueColumnsForNode(e,n):n,o=s.active?s.getNotValueColumnsForNode(e,n):null,l=this.getValuesNormal(e,r,a),c=e.aggData,h=this.beans;return r.forEach((d,u)=>{i[d.getId()]=Bd(h,l[u],d.getAggFunc(),d,e)}),o&&c&&o.forEach(d=>{i[d.getId()]=c[d.getId()]}),i}getValuesPivotNonLeaf(e,t){return e.childrenAfterFilter.map(i=>i.aggData[t])}getValuesFromMappedSet(e,t,i){let s=e;for(let n=0;n<t.length;n++){const a=t[n];s=s?s[a]:null}return s?s.map(n=>this.valueSvc.getValue(i,n)):[]}getValuesNormal(e,t,i){const s=[];t.forEach(()=>s.push([]));const n=t.length,a=i?e.childrenAfterFilter:e.childrenAfterGroup,r=a.length;for(let o=0;o<r;o++){const l=a[o];for(let c=0;c<n;c++){const h=t[c],d=this.valueSvc.getValue(h,l);s[c].push(d)}}return s}setAggData(e,t){const i=e.aggData;if(e.aggData=t,e.__localEventService){const s=n=>{const a=e.aggData?e.aggData[n]:void 0,r=i?i[n]:void 0;if(a===r)return;const o=this.colModel.getColById(n);o&&e.dispatchCellChangedEvent(o,a,r)};if(i)for(const n of Object.keys(i))s(n);if(t)for(const n of Object.keys(t))(!i||!(n in i))&&s(n)}}},cY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="filterAggStage",this.refreshProps=new Set([]),this.step="filter_aggregates"}wireBeans(e){this.filterManager=e.filterManager}execute(e){var c,h;const t=this.beans.colModel.isPivotMode(),i=((c=this.filterManager)==null?void 0:c.isAggregateFilterPresent())||((h=this.filterManager)==null?void 0:h.isAggregateQuickFilterPresent()),s=d=>!d.node.group,n=d=>d.node.leafGroup,a=(0,m._getGroupAggFiltering)(this.gos)||(t?n:s),{changedPath:r}=e,o=(d,u=!1)=>{d.childrenAfterFilter&&(d.childrenAfterAggFilter=d.childrenAfterFilter,u&&d.childrenAfterAggFilter.forEach(p=>o(p,u)),this.setAllChildrenCount(d)),d.sibling&&(d.sibling.childrenAfterAggFilter=d.childrenAfterAggFilter)},l=d=>{var u;d.childrenAfterAggFilter=((u=d.childrenAfterFilter)==null?void 0:u.filter(p=>{var y;return a({node:p})&&this.filterManager.doesRowPassAggregateFilters({rowNode:p})?(o(p,!0),!0):(y=p.childrenAfterAggFilter)==null?void 0:y.length}))||null,this.setAllChildrenCount(d),d.sibling&&(d.sibling.childrenAfterAggFilter=d.childrenAfterAggFilter)};r.forEachChangedNodeDepthFirst(i?l:o,!0)}setAllChildrenCountTreeData(e){var s;const t=e.childrenAfterAggFilter;let i=0;if(t){const n=t.length;i=n;for(let a=0;a<n;++a)i+=(s=t[a].allChildrenCount)!=null?s:0}e.setAllChildrenCount(i===0&&e.level>=0?null:i)}setAllChildrenCountGridGrouping(e){let t=0;e.childrenAfterAggFilter.forEach(i=>{i.group?t+=i.allChildrenCount:t++}),e.setAllChildrenCount(t)}setAllChildrenCount(e){if(!e.hasChildren()){e.setAllChildrenCount(null);return}this.gos.get("treeData")?this.setAllChildrenCountTreeData(e):this.setAllChildrenCountGridGrouping(e)}};function po(e,t){if(e.sibling)return;const i=(0,m._createRowNodeSibling)(e,t);i.footer=!0,i.setRowTop(null),i.setRowIndex(null),i.oldRowTop=null,i.id="rowGroupFooter_"+e.id,i.sibling=e,e.sibling=i}function SS(e){e.sibling&&(e.sibling.setRowTop(null),e.sibling.setRowIndex(null),e.sibling=void 0)}var hY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="footerSvc"}addTotalRows(e,t,i,s,n,a){let r=e;if(n){const c=s&&(0,m._getGrandTotalRow)(this.gos);return dY(a,c)&&(po(t,this.beans),i(t.sibling,r++)),r}const o=(0,m._getGroupTotalRowCallback)(this.gos);return(s&&o({node:t}))===a&&(po(t,this.beans),i(t.sibling,r++)),r}getTopDisplayIndex(e,t,i,s){let n=t;if(e[0].footer){if(t===0)return 0;n-=1}const a=e[e.length-1],r=n>=i.length;return a.footer&&r?a.rowIndex:s(n)}doesCellShowTotalPrefix(e,t){var i;return!e.footer||!(t!=null&&t.getColDef().showRowGroup)?!1:this.gos.get("treeData")?!0:e.level===-1?((i=this.beans.showRowGroupCols)==null?void 0:i.getShowRowGroupCols()[0])===t:!!e.rowGroupColumn&&t&&t.isRowGroupDisplayed(e.rowGroupColumn.getId())}applyTotalPrefix(e,t,i,s){var a,r,o;const n=(a=s.getColDef().cellRendererParams)==null?void 0:a.totalValueGetter;if(n){const l=(0,m._addGridCommonParams)(this.gos,{column:s,node:i,value:e,formattedValue:t});if(typeof n==="function")return n(l);if(typeof n=="string")return(r=this.beans.expressionSvc)==null?void 0:r.evaluate(n,l);(0,m._warn)(179)}return i.level===-1?this.getLocaleTextFunc()("footerTotal","Total")+" ":(o=this.getTotalValue(t!=null?t:e))!=null?o:""}getTotalValue(e){return this.getLocaleTextFunc()("footerTotal","Total")+" "+(e!=null?e:"")}};function dY(e,t){switch(t){case"top":case"pinnedTop":return e==="top";case"bottom":case"pinnedBottom":return e==="bottom";default:return!1}}var cL=class extends m.BaseColsService{constructor(){super(...arguments),this.beanName="valueColsSvc",this.eventName="columnValueChanged",this.columnProcessors={set:(e,t,i)=>this.setValueActive(t,e,i),add:(e,t,i)=>this.setValueActive(!0,e,i),remove:(e,t,i)=>this.setValueActive(!1,e,i)},this.columnExtractors={setFlagFunc:(e,t,i)=>this.setColValueActive(e,t,i),getIndexFunc:()=>{},getInitialIndexFunc:()=>{},getValueFunc:e=>{const t=e.aggFunc;if(t===null||t==="")return null;if(t!==void 0)return!!t},getInitialValueFunc:e=>e.initialAggFunc!=null&&e.initialAggFunc!=""},this.modifyColumnsNoEventsCallbacks={addCol:e=>this.columns.push(e),removeCol:e=>(0,m._removeFromArray)(this.columns,e)}}extractCols(e,t){return this.columns=super.extractCols(e,t),this.columns.forEach(i=>{const s=i.getColDef();s.aggFunc!=null&&s.aggFunc!=""?this.setColAggFunc(i,s.aggFunc):i.getAggFunc()||this.setColAggFunc(i,s.initialAggFunc)}),this.columns}setColumnAggFunc(e,t,i){if(!e)return;const s=this.colModel.getColDefCol(e);s&&(this.setColAggFunc(s,t),this.dispatchColumnChangedEvent(this.eventSvc,this.eventName,[s],i))}syncColumnWithState(e,t,i){const s=i("aggFunc").value1;s!==void 0&&(typeof s=="string"?(this.setColAggFunc(e,s),e.isValueActive()||(this.setColValueActive(e,!0,t),this.modifyColumnsNoEventsCallbacks.addCol(e))):((0,m._exists)(s)&&(0,m._warn)(33),e.isValueActive()&&(this.setColValueActive(e,!1,t),this.modifyColumnsNoEventsCallbacks.removeCol(e))))}setValueActive(e,t,i){if(e!==t.isValueActive()&&(this.setColValueActive(t,e,i),e&&!t.getAggFunc()&&this.aggFuncSvc)){const s=this.aggFuncSvc.getDefaultAggFunc(t);this.setColAggFunc(t,s)}}setColAggFunc(e,t){e.aggFunc=t,e.dispatchStateUpdatedEvent("aggFunc")}setColValueActive(e,t,i){e.aggregationActive!==t&&(e.aggregationActive=t,e.dispatchColEvent("columnValueChanged",i))}},MS={moduleName:"SharedAggregation",version:Re,beans:[q$,X$,hY,cL],apiFunctions:{addAggFuncs:aY,clearAggFuncs:rY,setColumnAggFunc:oY},dependsOn:[St]},hL={moduleName:"Aggregation",version:Re,beans:[lY,cY],rowModels:["clientSide"],dependsOn:[MS]},dL=class extends m.BaseColsService{constructor(){super(...arguments),this.beanName="pivotColsSvc",this.eventName="columnPivotChanged",this.columnProcessors={set:(e,t,i)=>this.setColPivotActive(e,t,i),add:(e,t,i)=>this.setColPivotActive(e,!0,i),remove:(e,t,i)=>this.setColPivotActive(e,!1,i)},this.columnOrdering={enableProp:"pivot",initialEnableProp:"initialPivot",indexProp:"pivotIndex",initialIndexProp:"initialPivotIndex"},this.columnExtractors={setFlagFunc:(e,t,i)=>this.setColPivotActive(e,t,i),getIndexFunc:e=>e.pivotIndex,getInitialIndexFunc:e=>e.initialPivotIndex,getValueFunc:e=>e.pivot,getInitialValueFunc:e=>e.initialPivot},this.modifyColumnsNoEventsCallbacks={addCol:e=>this.columns.push(e),removeCol:e=>(0,m._removeFromArray)(this.columns,e)}}syncColumnWithState(e,t,i,s){const{value1:n,value2:a}=i("pivot","pivotIndex");(n!==void 0||a!==void 0)&&(typeof a=="number"||n?(e.isPivotActive()||(this.setColPivotActive(e,!0,t),this.modifyColumnsNoEventsCallbacks.addCol(e)),s&&typeof a=="number"&&(s[e.getId()]=a)):e.isPivotActive()&&(this.setColPivotActive(e,!1,t),this.modifyColumnsNoEventsCallbacks.removeCol(e)))}setColPivotActive(e,t,i){e.pivotActive!==t&&(e.pivotActive=t,e.dispatchColEvent("columnPivotChanged",i)),e.dispatchStateUpdatedEvent("pivot")}},uY=class extends m.BaseColsService{constructor(){super(...arguments),this.beanName="rowGroupColsSvc",this.eventName="columnRowGroupChanged",this.columnProcessors={set:(e,t,i)=>this.setActive(t,e,i),add:(e,t,i)=>this.setActive(!0,e,i),remove:(e,t,i)=>this.setActive(!1,e,i)},this.columnOrdering={enableProp:"rowGroup",initialEnableProp:"initialRowGroup",indexProp:"rowGroupIndex",initialIndexProp:"initialRowGroupIndex"},this.columnExtractors={setFlagFunc:(e,t,i)=>this.setColRowGroupActive(e,t,i),getIndexFunc:e=>e.rowGroupIndex,getInitialIndexFunc:e=>e.initialRowGroupIndex,getValueFunc:e=>e.rowGroup,getInitialValueFunc:e=>e.initialRowGroup},this.modifyColumnsNoEventsCallbacks={addCol:e=>this.columns.push(e),removeCol:e=>(0,m._removeFromArray)(this.columns,e)}}moveColumn(e,t,i){if(this.columns.length===0)return;const s=this.columns[e],n=this.columns.slice(e,t);this.columns.splice(e,1),this.columns.splice(t,0,s),this.updateIndexMap(),this.eventSvc.dispatchEvent({type:this.eventName,columns:n,column:n.length===1?n[0]:null,source:i})}syncColumnWithState(e,t,i,s){const{value1:n,value2:a}=i("rowGroup","rowGroupIndex");(n!==void 0||a!==void 0)&&(typeof a=="number"||n?(e.isRowGroupActive()||(this.setColRowGroupActive(e,!0,t),this.modifyColumnsNoEventsCallbacks.addCol(e)),s&&typeof a=="number"&&(s[e.getId()]=a)):e.isRowGroupActive()&&(this.setColRowGroupActive(e,!1,t),this.modifyColumnsNoEventsCallbacks.removeCol(e)))}setActive(e,t,i){e!==t.isRowGroupActive()&&(this.setColRowGroupActive(t,e,i),(0,m._shouldUpdateColVisibilityAfterGroup)(this.gos,e)&&this.colModel.setColsVisible([t],!e,i))}setColRowGroupActive(e,t,i){e.rowGroupActive!==t&&(e.rowGroupActive=t,e.dispatchColEvent("columnRowGroupChanged",i)),e.dispatchStateUpdatedEvent("rowGroup")}},pY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="autoColSvc"}postConstruct(){this.addManagedPropertyListener("autoGroupColumnDef",this.updateColumns.bind(this))}addColumns(e){this.columns!=null&&(e.list=this.columns.list.concat(e.list),e.tree=this.columns.tree.concat(e.tree),(0,m._updateColsMap)(e))}createColumns(e,t){var A,w,T;const i=this.beans,{colModel:s,gos:n,rowGroupColsSvc:a,colGroupSvc:r}=i,o=s.isPivotMode(),l=(0,m._isGroupUseEntireRow)(n,o),c=o?n.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),h=a==null?void 0:a.columns,u=!(h&&h.length>0||n.get("treeData"))||c||l,p=()=>{this.columns&&((0,m._destroyColumnTree)(i,this.columns.tree),this.columns=null)};if(u){p();return}const g=this.generateAutoCols(h),f=(0,m._areColIdsEqual)(g,((A=this.columns)==null?void 0:A.list)||null),y=e.treeDepth,x=(this.columns?this.columns.treeDepth:-1)==y;if(f&&x)return;p();const S=(w=r==null?void 0:r.findDepth(e.tree))!=null?w:0,M=(T=r==null?void 0:r.balanceTreeForAutoCols(g,S))!=null?T:[];this.columns={list:g,tree:M,treeDepth:S,map:{}},t(k=>{if(!k)return null;const N=k.filter(O=>!(0,m.isColumnGroupAutoCol)(O));return[...g,...N]})}updateColumns(e){var i;const t=(0,m._convertColumnEventSourceType)(e.source);(i=this.columns)==null||i.list.forEach((s,n)=>this.updateOneAutoCol(s,n,t))}getColumn(e){var t,i;return(i=(t=this.columns)==null?void 0:t.list.find(s=>(0,m._columnsMatch)(s,e)))!=null?i:null}getColumns(){var e,t;return(t=(e=this.columns)==null?void 0:e.list)!=null?t:null}generateAutoCols(e=[]){const t=[],i=this.gos.get("treeData");let s=(0,m._isGroupMultiAutoColumn)(this.gos);return i&&s&&((0,m._warn)(182),s=!1),s?e.forEach((n,a)=>{t.push(this.createOneAutoCol(n,a))}):t.push(this.createOneAutoCol()),t}isSuppressAutoCol(){const e=this.gos;return e.get("groupDisplayType")==="custom"?!0:e.get("treeDataDisplayType")==="custom"}createOneAutoCol(e,t){let i;e?i=`${m.GROUP_AUTO_COLUMN_ID}-${e.getId()}`:i=m.GROUP_AUTO_COLUMN_ID;const s=this.createAutoColDef(i,e,t);s.colId=i;const n=new m.AgColumn(s,null,i,!0);return this.createBean(n),n}updateOneAutoCol(e,t,i){const s=e.getColDef(),n=typeof s.showRowGroup=="string"?s.showRowGroup:void 0,a=this.beans,r=n!=null?a.colModel.getColDefCol(n):void 0,o=e.getId(),l=this.createAutoColDef(o,r!=null?r:void 0,t);e.setColDef(l,null,i),(0,m._applyColumnState)(a,{state:[b({colId:o},l)]},i)}createAutoColDef(e,t,i){let s=this.createBaseColDef(t);const n=this.gos.get("autoGroupColumnDef");(0,m._mergeDeep)(s,n),s=(0,m._addColumnDefaultAndTypes)(this.beans,s,e,!0),this.gos.get("treeData")||(0,m._missing)(s.field)&&(0,m._missing)(s.valueGetter)&&(0,m._missing)(s.filterValueGetter)&&s.filter!=="agGroupColumnFilter"&&(s.filter=!1),i&&i>0&&(s.headerCheckboxSelection=!1);const a=(0,m._isColumnsSortingCoupledToGroup)(this.gos),r=s.valueGetter||s.field!=null;return a&&!r&&(s.sortIndex=void 0,s.initialSort=void 0),s}createBaseColDef(e){var a,r;const t=this.gos.get("autoGroupColumnDef"),s={headerName:this.getLocaleTextFunc()("group","Group"),showRowGroup:(a=e==null?void 0:e.getColId())!=null?a:!0};return t&&(t.cellRenderer||t.cellRendererSelector)||(s.cellRenderer="agGroupCellRenderer"),e&&(s.headerName=(r=this.beans.colNames.getDisplayNameForColumn(e,"header"))!=null?r:void 0,s.headerValueGetter=e.colDef.headerValueGetter),s}destroy(){var e;(0,m._destroyColumnTree)(this.beans,(e=this.columns)==null?void 0:e.tree),super.destroy()}},uL=class extends m.BeanStub{addExpandedCss(e,t){t.isExpandable()&&(e.push("ag-row-group"),e.push(t.expanded?"ag-row-group-expanded":"ag-row-group-contracted"))}getRowExpandedListeners(e){const{rowNode:t}=e,i=this.updateExpandedCss.bind(this,e,t);return{expandedChanged:i,hasChildrenChanged:i}}setExpanded(e,t,i,s){if(e.expanded===t)return;e.expanded=t,e.dispatchRowEvent("expandedChanged");const n=E(b({},(0,m._createGlobalRowEvent)(e,this.gos,"rowGroupOpened")),{expanded:t,event:i||null});this.dispatchExpandedEvent(n,s)}isExpandable(e){return e.footer?!1:this.beans.colModel.isPivotMode()?e.hasChildren()&&!e.leafGroup:e.hasChildren()||e.master}updateExpandedCss(e,t){const i=t.isExpandable(),s=t.expanded==!0;e.forEachGui(void 0,n=>{const a=n.rowComp;a.toggleCss("ag-row-group",i),a.toggleCss("ag-row-group-expanded",i&&s),a.toggleCss("ag-row-group-contracted",i&&!s),(0,m._setAriaExpanded)(n.element,i&&s)})}},gY=class extends uL{constructor(){super(...arguments),this.beanName="expansionSvc",this.events=[]}wireBeans(e){this.rowModel=e.rowModel}expandRows(e){const t=new Set(e);this.rowModel.forEachNode(i=>{i.id&&t.has(i.id)&&(i.expanded=!0)}),this.onGroupExpandedOrCollapsed()}expandAll(e){const{gos:t,colModel:i,eventSvc:s}=this.beans,n=this.rowModel,a=t.get("treeData"),r=i.isPivotActive(),o=c=>{c&&c.forEach(h=>{const d=()=>{h.expanded=e,o(h.childrenAfterGroup)};if(a){(0,m._exists)(h.childrenAfterGroup)&&d();return}if(r){!h.leafGroup&&d();return}h.group&&d()})},l=n.rootNode;l&&o(l.childrenAfterGroup),n.refreshModel({step:"map"}),s.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}onGroupExpandedOrCollapsed(){this.rowModel.refreshModel({step:"map"})}dispatchExpandedEvent(e,t){this.events.push(e);const i=()=>{this.rowModel.onRowGroupOpened(),this.events.forEach(n=>this.eventSvc.dispatchEvent(n));const s=this.events.map(n=>n.node);this.beans.rowRenderer.refreshCells({rowNodes:s}),this.events=[]};t?i():(this.dispatchExpandedDebounced==null&&(this.dispatchExpandedDebounced=this.debounce(i)),this.dispatchExpandedDebounced())}debounce(e){const t=this.beans.animationFrameSvc;if(!t)return()=>window.setTimeout(e,0);let i=!1;return()=>{if(!t.active){window.setTimeout(e,0);return}i||(i=!0,t.addDestroyTask(()=>{i=!1,e()}))}}};function pL(e){let t=e.get("groupHideParentOfSingleChild");return t||(t=e.get("groupRemoveSingleChildren"),!t&&e.get("groupRemoveLowestSingleChildren")&&(t="leafGroupsOnly")),{groupHideParentOfSingleChild:t,isGroupMultiAutoColumn:(0,m._isGroupMultiAutoColumn)(e),hideOpenParents:e.get("groupHideOpenParents"),grandTotalRow:(0,m._getGrandTotalRow)(e),groupTotalRow:(0,m._getGroupTotalRowCallback)(e)}}function gL(e,t,i){return e.groupHideParentOfSingleChild===!0&&i&&t.childrenAfterGroup.length===1}function fL(e,t,i){return e.groupHideParentOfSingleChild==="leafGroupsOnly"&&i&&t.leafGroup&&t.childrenAfterGroup.length===1}function mL(e,t,i,s,n,a){const r=s&&!i,o=s&&t.leafGroup,l=e.hideOpenParents&&t.expanded&&!t.master&&!o;return!r&&!l&&!n&&!a}var fY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="flattenStage",this.refreshProps=new Set(["groupHideParentOfSingleChild","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupTotalRow","masterDetail"]),this.step="map"}execute(e){var h;const t=e.rowNode,i=[],s=this.beans.colModel.isPivotMode(),n=s&&t.leafGroup&&t.aggData,a=n?[t]:t.childrenAfterSort,r=pL(this.gos);this.recursivelyAddToRowsToDisplay(r,a,i,s,0);const o=i.length>0,l=r.grandTotalRow;if(!n&&o&&l)if(po(t,this.beans),l==="pinnedBottom"||l==="pinnedTop")(h=this.beans.pinnedRowModel)==null||h.setGrandTotalPinned(l==="pinnedBottom"?"bottom":"top");else{const d=l==="top";this.addRowNodeToRowsToDisplay(r,t.sibling,i,0,d)}return i}recursivelyAddToRowsToDisplay(e,t,i,s,n){var a;if(t!=null&&t.length)for(let r=0;r<t.length;r++){const o=t[r],l=o.hasChildren(),c=gL(e,o,l),h=fL(e,o,l);if(mL(e,o,l,s,c,h)&&this.addRowNodeToRowsToDisplay(e,o,i,n),!(s&&o.leafGroup))if(l){const u=c||h;if(o.expanded||u){const p=e.groupTotalRow({node:o});p||SS(o);const g=u?n:n+1;p==="top"&&(po(o,this.beans),this.addRowNodeToRowsToDisplay(e,o.sibling,i,g)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,i,s,g),p==="bottom"&&(po(o,this.beans),this.addRowNodeToRowsToDisplay(e,o.sibling,i,g))}}else{const u=(a=this.beans.masterDetailSvc)==null?void 0:a.getDetail(o);u&&this.addRowNodeToRowsToDisplay(e,u,i,n)}}}addRowNodeToRowsToDisplay(e,t,i,s,n){n?i.unshift(t):i.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:s)}},mY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="groupStage",this.refreshProps=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType","treeData","treeDataChildrenField","treeDataParentIdField"]),this.step="group",this.approach=null,this.strategy=void 0}destroy(){super.destroy(),this.strategy=void 0,this.approach=null}createStrategy(){const{beans:e,approach:t}=this;let i;switch(t){case"treeSelfRef":i="treeParentIdStrategy";break;case"group":i="groupStrategy";break}if(i){const s=e.registry.createDynamicBean(i,!1);return this.createOptionalManagedBean(s),s}}execute(e){let t=this.strategy;const i=(0,m._getGroupingApproach)(this.gos);return this.approach!==i&&(this.approach=i,this.destroyBean(t),t&&this.approach!=="treeNested"&&this.approach!=="treePath"&&yY(e.rowNode),t=this.createStrategy(),this.strategy=t),t==null||t.execute(e),!!t}},yY=e=>{const t=e.allLeafChildren,i=e.sibling;e.treeNodeFlags=0,e.childrenAfterGroup=t,e.childrenMapped=null,e.groupData=null,i&&(i.childrenAfterGroup=e.childrenAfterGroup,i.childrenAfterAggFilter=e.childrenAfterAggFilter,i.childrenAfterFilter=e.childrenAfterFilter,i.childrenAfterSort=e.childrenAfterSort,i.childrenMapped=null,i.groupData=null);for(const s of t){const n=s.sibling;yL(s),n&&yL(n),s.parent=e,s.level=0,s.key=null,s.treeNodeFlags=0,(s.group||s.hasChildren())&&(s.group=!1,s.updateHasChildren())}e.updateHasChildren()},yL=e=>{e.allLeafChildren=null,e.childrenAfterGroup=null,e.childrenAfterAggFilter=null,e.childrenAfterFilter=null,e.childrenAfterSort=null,e.childrenMapped=null,e.groupData&&(e.groupData=null)};function vL(e,t,i){var r;let s=e;const n=s.level-t.level;if(n<=0||!i.get("groupHideOpenParents"))return!1;for(let o=0;o<n;o++){if(!(((r=s.parent)==null?void 0:r.getFirstChild())===s))return!1;s=s.parent}return s===t}var bL=class extends m.BeanStub{constructor(){super(...arguments),this.indentClass=null}init(e,t,i,s,n,a,r){var h,d;this.params=r,this.eGui=t,this.eCheckbox=i,this.eExpanded=s,this.eContracted=n,this.comp=e,this.compClass=a;const{node:o,column:l}=r;if(this.node=o,this.displayedNode=o,!this.isEmbeddedRowMismatch()){if(o.footer){this.initFooterCell();return}if(!l){this.initFullWidthCell();return}this.displayedNode=(d=(h=this.beans.showRowGroupColValueSvc)==null?void 0:h.getDisplayedNode(o,l))!=null?d:this.node,this.setupExpand(),this.setupCheckbox(),this.addGroupValue(),this.setupIndent()}}initFooterCell(){const{node:e}=this.params;this.addGroupValue(),this.setupIndent(),e.level===-1||this.comp.toggleCss("ag-row-group-leaf-indent",!0)}initFullWidthCell(){const e=()=>{const{rowDragSvc:t}=this.beans;if(!this.params.rowDrag||!t)return;const i=t.createRowDragComp(()=>this.params.value,this.params.node);this.createManagedBean(i),this.eGui.insertAdjacentElement("afterbegin",i.getGui())};this.setupExpand(),e(),this.setupCheckbox(),this.addGroupValue(),this.setupIndent()}getCellAriaRole(){var i,s;const e=(i=this.params.colDef)==null?void 0:i.cellAriaRole,t=(s=this.params.column)==null?void 0:s.getColDef().cellAriaRole;return e||t||"gridcell"}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const{visibleCols:e}=this.beans,t=this.params.pinned==="left",i=this.params.pinned==="right",s=!t&&!i;return this.gos.get("enableRtl")?e.isPinningLeft()?!i:!s:e.isPinningLeft()?!t:!s}addGroupValue(){var s;const{params:{value:e,valueFormatted:t}}=this,i=this.getInnerCompDetails();this.comp.setInnerRenderer(i,(s=t!=null?t:e)!=null?s:null)}setupExpand(){const{colModel:e}=this.beans,{eGridCell:t,column:i,suppressDoubleClickExpand:s}=this.params,n=(c,h)=>{const d=(0,m._createIconNoSpan)(c,this.beans,null);d&&(h.appendChild(d),this.addDestroyFunc(()=>h.removeChild(d)))};n("groupExpanded",this.eExpanded),n("groupContracted",this.eContracted);const a=this.comp,r=()=>{if(!this.isExpandable())return;const h=this.displayedNode.expanded;a.setExpandedDisplayed(h),a.setContractedDisplayed(!h),(0,m._setAriaExpanded)(t,!!this.displayedNode.expanded)},o=()=>{const c=this.isExpandable();a.toggleCss("ag-cell-expandable",c),a.toggleCss("ag-row-group",c);const h=!c&&e.isPivotMode();a.toggleCss("ag-pivot-leaf-group",h);const d=!e.isPivotMode()&&(!this.displayedNode.footer||this.displayedNode.level!==-1);a.toggleCss("ag-row-group-leaf-indent",!c&&d);const u=this.getChildCount(),p=u>0?`(${u})`:"";a.setChildCount(p),c?r():(a.setExpandedDisplayed(!1),a.setContractedDisplayed(!1),(0,m._removeAriaExpanded)(t))};(()=>{!((i==null?void 0:i.isCellEditable(this.displayedNode))&&this.gos.get("enableGroupEdit"))&&!s&&this.addManagedListeners(t,{dblclick:this.onCellDblClicked.bind(this)}),this.addManagedListeners(this.eExpanded,{click:this.onExpandClicked.bind(this)}),this.addManagedListeners(this.eContracted,{click:this.onExpandClicked.bind(this)}),this.addManagedListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedListeners(this.displayedNode,{allChildrenCountChanged:o,masterChanged:o,groupChanged:o,hasChildrenChanged:o,expandedChanged:r})})(),o()}getInnerCompDetails(){var l,c;const{userCompFactory:e,findSvc:t}=this.beans,i=this.params;if(i.fullWidth){const h=this.gos.get("groupRowRendererParams"),d=(0,m._getInnerCellRendererDetails)(e,h,i);return d||(t!=null&&t.isMatch(i.node,null)?(0,m._getInnerCellRendererDetails)(e,E(b({},h),{innerRenderer:"agFindCellRenderer"}),i):void 0)}const s=h=>h&&h.componentClass==this.compClass,n=(0,m._getInnerCellRendererDetails)(e,i,i);if(n&&!s(n))return n;const{displayedNode:{rowGroupColumn:a}}=this,r=a==null?void 0:a.colDef,o=a&&((l=i.column)==null?void 0:l.isRowGroupDisplayed(a.getId()));if(r&&o){const h=(0,m._getCellRendererDetails)(e,r,i);if(h)if(s(h)){if((c=r==null?void 0:r.cellRendererParams)!=null&&c.innerRenderer)return(0,m._getInnerCellRendererDetails)(e,r.cellRendererParams,i)}else return h}if(t!=null&&t.isMatch(i.node,i.column))return(0,m._getCellRendererDetails)(e,E(b({},r!=null?r:i.colDef),{cellRenderer:"agFindCellRenderer"}),i)}getChildCount(){const{column:e,suppressCount:t}=this.params;if(t)return 0;const{allChildrenCount:i,rowGroupColumn:s}=this.displayedNode;return!((i!=null?i:0)>0&&(!s||!e||(e==null?void 0:e.isRowGroupDisplayed(s.getId()))))||this.gos.get("showOpenedGroup")&&this.displayedNode!==this.node&&!vL(this.node,this.displayedNode,this.gos)?0:i!=null?i:0}isExpandable(){const{node:e,column:t,colDef:i}=this.params;if(!this.displayedNode.isExpandable()||e.rowPinned)return!1;if(!t)return!0;if(e.hasChildren()&&i){const{showRowGroup:a}=i;if(!a)return!1;if(a===!0)return!0}return e===this.displayedNode?e.rowGroupColumn&&(t==null?void 0:t.isRowGroupDisplayed(e.rowGroupColumn.getId()))?!0:e.master?(i==null?void 0:i.showRowGroup)===!0||(i==null?void 0:i.showRowGroup)==null:!1:vL(this.node,this.displayedNode,this.gos)}setupIndent(){const{suppressPadding:e,node:t,colDef:i}=this.params;if(e)return;const s=()=>{let n=0;i&&i.showRowGroup!==!0?n=0:n=t.uiLevel;const a="ag-row-group-indent-"+n;a!==this.indentClass&&(this.indentClass&&this.comp.toggleCss(this.indentClass,!1),this.indentClass=a,this.comp.toggleCss(a,!0),this.eGui.style.setProperty("--ag-indentation-level",String(n)))};this.addManagedListeners(t,{uiLevelChanged:s.bind(this)}),s()}setupCheckbox(){const{node:e}=this.params;!e.footer&&!e.rowPinned&&!e.detail&&(this.addManagedPropertyListener("rowSelection",({currentValue:i,previousValue:s})=>{const n=typeof i=="object"?i:void 0,a=typeof s=="object"?s:void 0;(n==null?void 0:n.checkboxLocation)!==(a==null?void 0:a.checkboxLocation)&&(this.destroyCheckbox(),this.addCheckbox())}),this.addCheckbox())}addCheckbox(){const{selectionSvc:e}=this.beans;if(!e||!(0,m._isRowSelection)(this.gos))return;const{node:t,column:i}=this.params,s=this.gos.get("rowSelection"),n=(0,m._getCheckboxLocation)(s);if(n==="selectionColumn")return;if(n==="autoGroupColumn"){const c=(i==null?void 0:i.getColDef().showRowGroup)!=null,h=!i&&t.group;if(!(c||h))return}const a=typeof s=="object"?(0,m._getCheckboxes)(s):this.params.checkbox;if(!(typeof a=="function"||a===!0))return;if(typeof(i==null?void 0:i.getColDef().showRowGroup)=="string"&&!this.isExpandable()){this.comp.setCheckboxSpacing(!0);return}const l=e.createCheckboxSelectionComponent();this.cbComp=l,this.createBean(l),l.init({rowNode:t,column:i,overrides:{isVisible:a,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(l.getGui()),this.comp.setCheckboxVisible(!0)}destroyCheckbox(){this.comp.setCheckboxSpacing(!1),this.comp.setCheckboxVisible(!1),this.cbComp&&this.eCheckbox.removeChild(this.cbComp.getGui()),this.cbComp=this.destroyBean(this.cbComp)}onExpandClicked(e){(0,m._isStopPropagationForAgGrid)(e)||((0,m._stopPropagationForAgGrid)(e),this.onExpandOrContract(e))}onKeyDown(e){!(e.key===m.KeyCode.ENTER)||this.params.suppressEnterExpand||this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if((0,m._isStopPropagationForAgGrid)(e))return;(0,m._isElementInEventPath)(this.eExpanded,e)||(0,m._isElementInEventPath)(this.eContracted,e)||this.onExpandOrContract(e)}onExpandOrContract(e){if(!this.isExpandable())return;const t=this.displayedNode,i=!t.expanded;!i&&t.sticky&&this.beans.ctrlsSvc.getScrollFeature().setVerticalScrollPosition(t.rowTop-t.stickyRowTop),t.setExpanded(i,e)}destroy(){super.destroy(),this.destroyCheckbox()}},vY={tag:"span",cls:"ag-cell-wrapper",children:[{tag:"span",ref:"eExpanded",cls:"ag-group-expanded ag-hidden"},{tag:"span",ref:"eContracted",cls:"ag-group-contracted ag-hidden"},{tag:"span",ref:"eCheckbox",cls:"ag-group-checkbox ag-invisible"},{tag:"span",ref:"eValue",cls:"ag-group-value"},{tag:"span",ref:"eChildCount",cls:"ag-group-child-count"}]},xL=class extends m.Component{constructor(){super(vY),this.eExpanded=m.RefPlaceholder,this.eContracted=m.RefPlaceholder,this.eCheckbox=m.RefPlaceholder,this.eValue=m.RefPlaceholder,this.eChildCount=m.RefPlaceholder}init(e){const t={setInnerRenderer:(a,r)=>this.setRenderDetails(a,r),setChildCount:a=>this.eChildCount.textContent=a,toggleCss:(a,r)=>this.toggleCss(a,r),setContractedDisplayed:a=>(0,m._setDisplayed)(this.eContracted,a),setExpandedDisplayed:a=>(0,m._setDisplayed)(this.eExpanded,a),setCheckboxVisible:a=>this.eCheckbox.classList.toggle("ag-invisible",!a),setCheckboxSpacing:a=>this.eCheckbox.classList.toggle("ag-group-checkbox-spacing",a)},i=this.createManagedBean(new bL),s=!e.colDef,n=this.getGui();i.init(t,n,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),s&&(0,m._setAriaRole)(n,i.getCellAriaRole())}setRenderDetails(e,t){e?e.newAgStackInstance().then(i=>{if(!i)return;const s=()=>this.destroyBean(i);this.isAlive()?(this.eValue.appendChild(i.getGui()),this.addDestroyFunc(s)):s()}):this.eValue.innerText=t}destroy(){this.destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}},bY=".ag-group-checkbox-spacing{width:var(--ag-icon-size)}:where(.ag-ltr) .ag-group-checkbox-spacing{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-checkbox-spacing{margin-left:var(--ag-cell-widget-spacing)}",xY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="showRowGroupColValueSvc"}getGroupValue(e,t){var a,r;if(!t)return e.group?{displayedNode:e,value:e.groupValue}:null;const i=this.beans.valueSvc,s=t.colDef.showRowGroup;if(!s)return null;if(e.level===-1&&e.footer)return{displayedNode:e,value:null};if(typeof s=="string"){if(((r=(a=this.beans.rowGroupColsSvc)==null?void 0:a.getColumnIndex(s))!=null?r:-1)>e.level)return null;const l=this.getDisplayedNode(e,t,!0);if(l)return{displayedNode:l,value:i.getValue(t,l)}}const n=i.getValue(t,e);if(n==null){const o=this.getDisplayedNode(e,t);if(o)return{displayedNode:o,value:i.getValue(t,o)}}return{displayedNode:e,value:n}}formatAndPrefixGroupColValue(e,t,i=!1){const s=this.formatGroupColValue(e,t,i),{value:n,displayedNode:a}=e,r=this.beans.footerSvc;return r!=null&&r.doesCellShowTotalPrefix(a,t)?r.applyTotalPrefix(n,s,a,t):a.footer&&a.level===-1?null:s}formatGroupColValue(e,t,i=!1){const s=this.beans.valueSvc,{displayedNode:n,value:a}=e,r=n.rowGroupColumn,o=n.group&&!t;if(r&&(o||(t==null?void 0:t.isRowGroupDisplayed(r.colId)))){if(i&&r.colDef.useValueFormatterForExport===!1)return null;const c=s.formatValue(r,n,a);return c==null&&n.key===""?this.getLocaleTextFunc()("blanks","(Blanks)"):c}return!t||n.group||i&&t.colDef.useValueFormatterForExport===!1?null:s.formatValue(t,n,a)}getDisplayedNode(e,t,i=!1){var l,c,h;const s=this.gos,n=s.get("groupHideOpenParents"),a=s.get("showOpenedGroup")&&!i;if(!n&&!a)return;const r=t.colDef.showRowGroup;if(r===!0)return e.group?void 0:(l=e.parent)!=null?l:void 0;let o=e;for(;o&&((c=o.rowGroupColumn)==null?void 0:c.getId())!=r;){const d=o===((h=o.parent)==null?void 0:h.getFirstChild());if(!a&&!d)return;o=o.parent}if(o!==e)return o!=null?o:void 0}},CY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="showRowGroupCols"}refresh(){this.showRowGroupCols=[],this.showRowGroupColsMap={};const{colModel:e,rowGroupColsSvc:t}=this.beans;e.getCols().forEach(i=>{const n=i.getColDef().showRowGroup,a=typeof n=="string";!a&&!(n===!0)||(this.showRowGroupCols.push(i),a?this.showRowGroupColsMap[n]=i:t&&t.columns.forEach(o=>{this.showRowGroupColsMap[o.getId()]=i}))})}getShowRowGroupCols(){return this.showRowGroupCols}getShowRowGroupCol(e){return this.showRowGroupColsMap[e]}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;const{rowGroupColsSvc:i,colModel:s}=this.beans;if(t===!0&&i)return i.columns.slice(0);const n=s.getColDefCol(t);return n?[n]:null}isRowGroupDisplayed(e,t){const{colDef:i}=e;if((i==null?void 0:i.showRowGroup)==null)return!1;const s=i.showRowGroup===!0,n=i.showRowGroup===t;return s||n}},SY=class extends m.BeanStub{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.extraTopHeight=0,this.extraBottomHeight=0}postConstruct(){this.isClientSide=(0,m._isClientSideRowModel)(this.gos),this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl}),this.resetStickyContainers()}setOffsetTop(e){this.extraTopHeight!==e&&(this.extraTopHeight=e,this.eventSvc.dispatchEvent({type:"stickyTopOffsetChanged",offset:e}))}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getLastPixelOfGroup(e){return this.isClientSide?DY(e):MY(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}updateStickyRows(e){const t=e==="top";let i=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,i);const{rowModel:s,rowRenderer:n,pinnedRowModel:a}=this.beans,r=t?n.firstVisibleVPixel-this.extraTopHeight:n.lastVisibleVPixel-this.extraTopHeight,o=new Set,l=u=>{if(o.add(u),t){const p=this.getLastPixelOfGroup(u),g=r+i+u.rowHeight;p<g?u.stickyRowTop=i+(p-g):u.stickyRowTop=i}else{const p=this.getFirstPixelOfGroup(u),g=r-(i+u.rowHeight);p>g?u.stickyRowTop=i-(p-g):u.stickyRowTop=i}i=0,o.forEach(p=>{const g=p.stickyRowTop+p.rowHeight;i<g&&(i=g)})},c=this.areFooterRowsStickySuppressed(),h=this.gos.get("suppressGroupRowsSticky"),d=u=>{if(!u.displayed)return!1;if(u.footer){if(c===!0||c==="grand"&&u.level===-1||c==="group"&&u.level>-1)return!1;const p=u.sibling.rowIndex?u.sibling.rowIndex+1===u.rowIndex:!1;return e==="bottom"&&p||u.level===-1&&(a!=null&&a.getGrandTotalPinned())?!1:!o.has(u)}return u.isExpandable()?h===!0||e==="bottom"?!1:!o.has(u)&&u.expanded:!1};for(let u=0;u<100;u++){let p=r+i;t||(p=r-i);const g=s.getRowIndexAtPixel(p),f=s.getRow(g);if(f==null)break;const v=this.getStickyAncestors(f).find(S=>(t?S.rowIndex<g:S.rowIndex>g)&&d(S));if(v){l(v);continue}if((t?f.rowTop<p:f.rowTop+f.rowHeight>p)&&d(f)){l(f);continue}break}return t||o.forEach(u=>{u.stickyRowTop=i-(u.stickyRowTop+u.rowHeight)}),this.refreshNodesAndContainerHeight(e,o,i)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(e===!0)return!0;const t=e==="group",i=e==="grand";return t&&i?!0:i?"grand":t?"group":!1}canRowsBeSticky(){const e=(0,m._isGroupRowsSticky)(this.gos),t=this.areFooterRowsStickySuppressed(),i=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!i)}getStickyAncestors(e){const t=[];let i=e.footer?e.sibling:e.parent;for(;i;)i.sibling&&t.push(i.sibling),t.push(i),i=i.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.resetStickyContainers()}resetStickyContainers(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some(i=>i.rowNode===e)){for(let i=0;i<this.stickyTopRowCtrls.length;i++){const s=this.stickyTopRowCtrls[i].rowNode;s!==e&&t.add(s)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows();return}for(let i=0;i<this.stickyBottomRowCtrls.length;i++){const s=this.stickyBottomRowCtrls[i].rowNode;s!==e&&t.add(s)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}refreshNodesAndContainerHeight(e,t,i){const s=e==="top",n=s?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,a={},r=[];for(let p=0;p<n.length;p++){const g=n[p].rowNode;if(!t.has(g)){a[g.id]=n[p],g.sticky=!1;continue}r.push(n[p])}const o=new Set;for(let p=0;p<r.length;p++)o.add(r[p].rowNode);const l=[];t.forEach(p=>{o.has(p)||(p.sticky=!0,l.push(this.createRowCon(p,!1,!1)))});let c=!!l.length||r.length!==n.length;s?this.topContainerHeight!==i&&(this.topContainerHeight=i,this.gridBodyCtrl.setStickyTopHeight(i),c=!0):this.bottomContainerHeight!==i&&(this.bottomContainerHeight=i,this.gridBodyCtrl.setStickyBottomHeight(i),c=!0),this.destroyRowCtrls(a,!1);const h=[...r,...l];h.sort((p,g)=>g.rowNode.rowIndex-p.rowNode.rowIndex),s||h.reverse(),h.forEach(p=>p.setRowTop(p.rowNode.stickyRowTop));const d=this.beans.pageBounds;let u=0;return s?(t.forEach(p=>{p.rowIndex<d.getFirstRow()&&(u+=p.rowHeight)}),u>this.topContainerHeight&&(u=this.topContainerHeight),this.setOffsetTop(u)):(t.forEach(p=>{p.rowIndex>d.getLastRow()&&(u+=p.rowHeight)}),u>this.bottomContainerHeight&&(u=this.bottomContainerHeight),this.setOffsetBottom(u)),c?(s?this.stickyTopRowCtrls=h:this.stickyBottomRowCtrls=h,!0):!1}ensureRowHeightsValid(){let e=!1;const t=i=>{const s=i.rowNode;if(s.rowHeightEstimated){const n=(0,m._getRowHeightForNode)(this.beans,s);s.setRowHeight(n.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}};function MY(e){var t,i,s,n;if(e.isExpandable()||e.footer){if(e.master&&e.detailNode)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1){let r=(t=e.childStore)==null?void 0:t.getStoreBounds();return e.footer&&(r=(i=e.sibling.childStore)==null?void 0:i.getStoreBounds()),((s=r==null?void 0:r.heightPx)!=null?s:0)+((n=r==null?void 0:r.topPx)!=null?n:0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}function DY(e){if(e.isExpandable()||e.footer){if(e.footer&&e.rowIndex===0)return Number.MAX_SAFE_INTEGER;if(!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1){let s=e.footer?e.sibling:e;for(;s.isExpandable()&&s.expanded;)if(s.master&&s.detailNode)s=s.detailNode;else if(s.childrenAfterSort){if(s.childrenAfterSort.length===0)break;s=(0,m._last)(s.childrenAfterSort)}return s.rowTop+s.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}var wY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="stickyRowSvc"}createStickyRowFeature(e,t,i){const s=this.gos;if((0,m._isGroupRowsSticky)(s)&&(0,m._isClientSideRowModel)(s)||(0,m._isServerSideRowModel)(s))return e.createManagedBean(new SY(t,i))}},CL={moduleName:"GroupCellRenderer",version:Re,userComponents:{agGroupRowRenderer:xL,agGroupCellRenderer:xL},dynamicBeans:{groupCellRendererCtrl:bL},icons:{groupContracted:"tree-closed",groupExpanded:"tree-open"},css:[bY],dependsOn:[St]},SL={moduleName:"GroupColumn",version:Re,beans:[pY,CY,xY,uY,dL,cL],dependsOn:[St,CL]},Hm={moduleName:"ClientSideRowModelHierarchy",version:Re,rowModels:["clientSide"],beans:[mY,fY,gY],dependsOn:[St]},DS={moduleName:"StickyRow",version:Re,beans:[wY]},AY=class extends m.Component{constructor(){super()}postConstruct(){this.setGui(this.createNorthPanel());const e=this.onRowGroupChanged.bind(this);this.addManagedEventListeners({columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedPropertyListener("rowGroupPanelShow",e),this.addManagedPropertyListener("pivotPanelShow",()=>this.onPivotPanelShow()),this.onRowGroupChanged()}createNorthPanel(){const e=(0,m._createElement)({tag:"div",cls:"ag-column-drop-wrapper",role:"presentation"}),t=new $k(!0);this.rowGroupComp=this.createManagedBean(t);const i=new Kk(!0);this.pivotComp=this.createManagedBean(i),e.appendChild(t.getGui()),e.appendChild(i.getGui());const s=this.onDropPanelVisible.bind(this);return this.addManagedListeners(t,{displayChanged:s}),this.addManagedListeners(i,{displayChanged:s}),this.onDropPanelVisible(),e}onDropPanelVisible(){const{rowGroupComp:e,pivotComp:t}=this,i=e.isDisplayed()&&t.isDisplayed(),s="ag-column-drop-horizontal-half-width";e.toggleCss(s,i),t.toggleCss(s,i)}onRowGroupChanged(){var i,s;const e=this.rowGroupComp;if(!e)return;const t=this.gos.get("rowGroupPanelShow");if(t==="always")e.setDisplayed(!0);else if(t==="onlyWhenGrouping"){const n=((s=(i=this.beans.rowGroupColsSvc)==null?void 0:i.columns)==null?void 0:s.length)!==0;e.setDisplayed(n)}else e.setDisplayed(!1)}onPivotPanelShow(){const e=this.pivotComp;if(!e)return;const t=this.gos.get("pivotPanelShow");if(t==="always")e.setDisplayed(!0);else if(t==="onlyWhenPivoting"){const i=this.beans.colModel.isPivotActive();e.setDisplayed(i)}else e.setDisplayed(!1)}},IY={selector:"AG-GRID-HEADER-DROP-ZONES",component:AY},TY={tag:"div",cls:"ag-group-filter",children:[{tag:"div",ref:"eGroupField"},{tag:"div",ref:"eUnderlyingFilter"}]},kY=class extends m.TabGuardComp{constructor(){super(TY),this.filterType="group",this.eGroupField=m.RefPlaceholder,this.eUnderlyingFilter=m.RefPlaceholder}wireBeans(e){this.filterManager=e.filterManager,this.showRowGroupCols=e.showRowGroupCols}postConstruct(){this.initialiseTabGuard({})}init(e){return this.updateParams(e).then(()=>{this.addManagedEventListeners({columnRowGroupChanged:()=>this.onColumnRowGroupChanged(),filterDestroyed:t=>this.onFilterDestroyed(t)})})}refresh(e){return this.updateParams(e),!0}updateParams(e){return this.params=e,this.validateParams(),this.updateGroups()}validateParams(){const{colDef:e}=this.params;e.field&&(0,m._warn)(234),e.filterValueGetter&&(0,m._warn)(235),e.filterParams&&(0,m._warn)(236)}updateGroups(){const e=this.updateGroupField();return this.getUnderlyingFilters(e)}getSourceColumns(){var t;if(this.groupColumn=this.params.column,this.gos.get("treeData"))return(0,m._warn)(237),[];const e=(t=this.showRowGroupCols)==null?void 0:t.getSourceColumnsForGroupColumn(this.groupColumn);return e||((0,m._warn)(183),[])}updateGroupField(){const e=this.eGroupField;(0,m._clearElement)(e),this.eGroupFieldSelect&&this.destroyBean(this.eGroupFieldSelect);const t=this.getSourceColumns(),i=t.filter(s=>s.isFilterAllowed());return i.length?(t.length===1?(this.selectedColumn=i[0],(0,m._setDisplayed)(e,!1)):((!this.selectedColumn||!i.some(s=>s.getId()===this.selectedColumn.getId()))&&(this.selectedColumn=i[0]),this.createGroupFieldSelectElement(i),e.appendChild(this.eGroupFieldSelect.getGui()),e.appendChild((0,m._createElement)({tag:"div",cls:"ag-filter-separator"})),(0,m._setDisplayed)(e,!0)),i):(this.selectedColumn=void 0,(0,m._setDisplayed)(e,!1),null)}createGroupFieldSelectElement(e){const t=this.createManagedBean(new m.AgSelect);this.eGroupFieldSelect=t;const i=this.getLocaleTextFunc();t.setLabel(i("groupFilterSelect","Select field:")),t.setLabelAlignment("top"),t.addOptions(e.map(s=>{var n;return{value:s.getId(),text:(n=this.beans.colNames.getDisplayNameForColumn(s,"groupFilter",!1))!=null?n:void 0}})),t.setValue(this.selectedColumn.getId()),t.onValueChange(s=>this.updateSelectedColumn(s)),t.addCss("ag-group-filter-field-select-wrapper"),e.length===1&&t.setDisabled(!0)}getUnderlyingFilters(e){var s;if(!e)return this.filterColumnPairs=void 0,this.selectedFilter=void 0,(s=this.beans.colFilter)==null||s.setColFilterActive(this.groupColumn,!1,"columnRowGroupChanged"),m.AgPromise.resolve();const t=[],i=[];return e.forEach(n=>{const a=this.filterManager.getOrCreateFilterWrapper(n);a!=null&&a.filterPromise&&t.push(a.filterPromise.then(r=>(r&&i.push({filter:r,column:n}),n.getId()===this.selectedColumn.getId()&&(this.selectedFilter=r!=null?r:void 0),r)))}),m.AgPromise.all(t).then(()=>{var n;this.filterColumnPairs=i,(n=this.beans.colFilter)==null||n.setColFilterActive(this.groupColumn,this.isFilterActive(),"columnRowGroupChanged")})}addUnderlyingFilterElement(){var t,i;if((0,m._clearElement)(this.eUnderlyingFilter),!this.selectedColumn)return m.AgPromise.resolve();const e=this.createManagedBean(new m.FilterWrapperComp(this.selectedColumn,"COLUMN_MENU"));return this.filterWrapperComp=e,e.hasFilter()?(this.eUnderlyingFilter.appendChild(e.getGui()),(i=(t=e.getFilter())==null?void 0:t.then(()=>{var s,n;(s=e.afterGuiAttached)==null||s.call(e,this.afterGuiAttachedParams),!((n=this.afterGuiAttachedParams)!=null&&n.suppressFocus)&&this.eGroupFieldSelect&&!this.eGroupFieldSelect.isDisabled()&&this.eGroupFieldSelect.getFocusableElement().focus()}))!=null?i:m.AgPromise.resolve()):m.AgPromise.resolve()}updateSelectedColumn(e){var i;if(!e)return;(i=this.filterWrapperComp)==null||i.afterGuiDetached(),this.destroyBean(this.filterWrapperComp);const t=this.getFilterColumnPair(e);this.selectedColumn=t==null?void 0:t.column,this.selectedFilter=t==null?void 0:t.filter,this.dispatchLocalEvent({type:"selectedColumnChanged"}),this.addUnderlyingFilterElement()}isFilterActive(){var e;return!!((e=this.filterColumnPairs)!=null&&e.some(({filter:t})=>t.isFilterActive()))}doesFilterPass(){return!0}getModel(){return null}setModel(){return m.AgPromise.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.addUnderlyingFilterElement()}afterGuiDetached(){var e,t;(0,m._clearElement)(this.eUnderlyingFilter),(t=(e=this.selectedFilter)==null?void 0:e.afterGuiDetached)==null||t.call(e)}onColumnRowGroupChanged(){this.updateGroups().then(()=>{this.dispatchLocalEvent({type:"columnRowGroupChanged"})})}onFilterDestroyed({column:e,source:t}){var s;if(t==="gridDestroyed")return;const i=e.getColId();(s=this.filterColumnPairs)!=null&&s.some(({column:n})=>n.getColId()===i)&&setTimeout(()=>{this.isAlive()&&this.updateGroups()})}getFilterColumnPair(e){var t;if(e)return(t=this.filterColumnPairs)==null?void 0:t.find(({column:i})=>i.getId()===e)}getSelectedFilter(){return this.selectedFilter}getSelectedColumn(){return this.selectedColumn}isFilterAllowed(){return!!this.selectedColumn}},LY={tag:"div",ref:"eFloatingFilter",cls:"ag-group-floating-filter ag-floating-filter-input",role:"presentation"},PY=class extends m.Component{constructor(){super(LY),this.eFloatingFilter=m.RefPlaceholder,this.haveAddedColumnListeners=!1}wireBeans(e){this.filterManager=e.filterManager}init(e){this.params=e;const t=(0,m._isGroupMultiAutoColumn)(this.gos);return new m.AgPromise(i=>{this.params.parentFilterInstance(s=>{this.parentFilterInstance=s,t?this.setupUnderlyingFloatingFilterElement().then(()=>i()):(this.setupReadOnlyFloatingFilterElement(),i())})}).then(()=>{const i=this.onColChange.bind(this);this.addManagedListeners(this.parentFilterInstance,{selectedColumnChanged:i,columnRowGroupChanged:i})})}refresh(e){this.params=e,this.setParams()}setParams(){var i;const e=this.beans.colNames.getDisplayNameForColumn(this.params.column,"header",!0),t=this.getLocaleTextFunc();(i=this.eFloatingFilterText)==null||i.setInputAriaLabel(`${e} ${t("ariaFilterInput","Filter Input")}`)}setupReadOnlyFloatingFilterElement(){this.eFloatingFilterText||(this.eFloatingFilterText=this.createManagedBean(new m.AgInputTextField),this.eFloatingFilterText.setDisabled(!0).addGuiEventListener("click",()=>this.params.showParentFilter()),this.setParams()),this.updateDisplayedValue(),this.eFloatingFilter.appendChild(this.eFloatingFilterText.getGui())}setupUnderlyingFloatingFilterElement(){this.showingUnderlyingFloatingFilter=!1,this.underlyingFloatingFilter=void 0,(0,m._clearElement)(this.eFloatingFilter);const e=this.parentFilterInstance.getSelectedColumn();if(e&&!e.isVisible()){const t=this.filterManager.getFloatingFilterCompDetails(e,this.params.showParentFilter);if(t)return this.haveAddedColumnListeners||(this.haveAddedColumnListeners=!0,this.addManagedListeners(e,{visibleChanged:this.onColumnVisibleChanged.bind(this),colDefChanged:this.onColDefChanged.bind(this)})),t.newAgStackInstance().then(i=>{var s,n;this.underlyingFloatingFilter=i,(n=this.underlyingFloatingFilter)==null||n.onParentModelChanged((s=this.parentFilterInstance.getSelectedFilter())==null?void 0:s.getModel()),this.appendChild(i.getGui()),this.showingUnderlyingFloatingFilter=!0})}return this.setupReadOnlyFloatingFilterElement(),m.AgPromise.resolve()}onColumnVisibleChanged(){this.setupUnderlyingFloatingFilterElement()}onColDefChanged(e){var i,s;if(!e.column)return;const t=this.filterManager.getFloatingFilterCompDetails(e.column,this.params.showParentFilter);t&&((s=(i=this.underlyingFloatingFilter)==null?void 0:i.refresh)==null||s.call(i,t.params))}onParentModelChanged(e,t){var i,s;this.showingUnderlyingFloatingFilter?(s=this.underlyingFloatingFilter)==null||s.onParentModelChanged((i=this.parentFilterInstance.getSelectedFilter())==null?void 0:i.getModel(),t):this.updateDisplayedValue()}updateDisplayedValue(){const{eFloatingFilterText:e,parentFilterInstance:t}=this;if(!t||!e)return;const i=t.getSelectedFilter();if(!i){e.setValue(""),e.setDisplayed(!1);return}if(e.setDisplayed(!0),i.getModelAsString){const s=i.getModel();e.setValue(s==null?"":i.getModelAsString(s))}else e.setValue("")}onColChange(){this.showingUnderlyingFloatingFilter||this.updateDisplayedValue()}},wS=class{constructor(){this.allSets=new Map}removeFromChildrenAfterGroup(e,t){var s;const i=this.getSet(e);((s=i.fromChildrenAfterGroup)!=null?s:i.fromChildrenAfterGroup=new Set).add(t)}isRemoveFromAllLeafChildren(e,t){var i,s;return!!((s=(i=this.allSets.get(e))==null?void 0:i.fromAllLeafChildren)!=null&&s.has(t))}preventRemoveFromAllLeafChildren(e,t){var i,s;(s=(i=this.allSets.get(e))==null?void 0:i.fromAllLeafChildren)==null||s.delete(t)}removeFromAllLeafChildren(e,t){var s;const i=this.getSet(e);((s=i.fromAllLeafChildren)!=null?s:i.fromAllLeafChildren=new Set).add(t)}getSet(e){let t=this.allSets.get(e);return t||(t={fromChildrenAfterGroup:null,fromAllLeafChildren:null},this.allSets.set(e,t)),t}getAllParents(){return Array.from(this.allSets.keys())}flush(){const e=this.allSets;for(const t of e.keys()){const i=e.get(t);if(i){const{fromChildrenAfterGroup:s,fromAllLeafChildren:n}=i,{childrenAfterGroup:a,allLeafChildren:r}=t;a&&s&&(ML(a,s),t.updateHasChildren()),r&&n&&ML(r,n)}}e.clear()}};function ML(e,t){let i=0;for(let s=0,n=e.length;s<n;++s){const a=e[s];t.has(a)||(e[i++]=a)}e.length=i}function EY(e){if(!e)return!1;const t=e.length;if(t<2)return!1;let i=!1;for(let s=1;s<t;s++)if(DL(e[s-1],e[s])>0){i=!0;break}return i?(e.sort(DL),!0):!1}function DL(e,t){const i=e.sourceRowIndex,s=t.sourceRowIndex,n=i>=0,a=s>=0,r=n&&a,o=!n&&!a;return r?i-s:o?e.__objectId-t.__objectId:n?1:-1}var RY=class extends m.BeanStub{wireBeans(e){this.colModel=e.colModel,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc,this.selectionSvc=e.selectionSvc,this.showRowGroupCols=e.showRowGroupCols}execute(e){var n;const t=this.createGroupingDetails(e),i=e.changedRowNodes;i?this.handleDeltaUpdate(t,i):this.shotgunResetEverything(t,!!e.afterColumnsChanged);const s=e.changedPath;this.positionLeafsAndGroups(s),this.orderGroups(t),(n=this.selectionSvc)==null||n.updateSelectableAfterGrouping(s)}positionLeafsAndGroups(e){e.forEachChangedNodeDepthFirst(t=>{if(t.childrenAfterGroup){const i=[],s=[];let n;t.childrenAfterGroup.forEach(a=>{var r;(r=a.childrenAfterGroup)!=null&&r.length?a.key===""&&!n?n=a:s.push(a):i.push(a)}),n&&s.push(n),t.childrenAfterGroup=[...i,...s]}},!1)}createGroupingDetails(e){var r,o,l;const{rowNode:t,changedPath:i,rowNodesOrderChanged:s}=e,n=(r=this.rowGroupColsSvc)==null?void 0:r.columns;return{expandByDefault:this.gos.get("groupDefaultExpanded"),groupedCols:n,rootNode:t,pivotMode:this.colModel.isPivotMode(),groupedColCount:(o=n==null?void 0:n.length)!=null?o:0,rowNodesOrderChanged:!!s,changedPath:i,groupAllowUnbalanced:this.gos.get("groupAllowUnbalanced"),isGroupOpenByDefault:this.gos.getCallback("isGroupOpenByDefault"),initialGroupOrderComparator:this.gos.getCallback("initialGroupOrderComparator"),keyCreators:(l=n==null?void 0:n.map(c=>c.getColDef().keyCreator))!=null?l:[]}}handleDeltaUpdate(e,{removals:t,updates:i,adds:s}){const n=new wS;t.size&&this.removeNodes(t,e,n);for(const o of i)this.moveNodeInWrongPath(o,e,n);const a=e.changedPath;for(const o of s)this.insertOneNode(o,e),a.active&&a.addParentNode(o.parent);const r=n.getAllParents();n.flush(),this.removeEmptyGroups(r,e),e.rowNodesOrderChanged&&this.sortChildren(e)}sortChildren(e){e.changedPath.forEachChangedNodeDepthFirst(t=>{EY(t.childrenAfterGroup)&&e.changedPath.addParentNode(t)},!1,!0)}orderGroups(e){const t=e.initialGroupOrderComparator;(0,m._exists)(t)&&i(e.rootNode);function i(s){(0,m._exists)(s.childrenAfterGroup)&&!s.leafGroup&&(s.childrenAfterGroup.sort((a,r)=>t({nodeA:a,nodeB:r})),s.childrenAfterGroup.forEach(a=>i(a)))}}getExistingPathForNode(e,t){const i=[];let s=e.parent;for(;s&&s!==t.rootNode;)i.push({key:s.key,rowGroupColumn:s.rowGroupColumn,field:s.field}),s=s.parent;return i.reverse(),i}moveNodeInWrongPath(e,t,i){t.changedPath.active&&t.changedPath.addParentNode(e.parent);const s=o=>o.key,n=this.getExistingPathForNode(e,t).map(s),a=this.getGroupInfo(e,t).map(s);(0,m._areEqual)(n,a)||this.moveNode(e,t,i)}moveNode(e,t,i){if(this.removeNodesFromParents([e],t,i),this.insertOneNode(e,t,i),e.setData(e.data),t.changedPath.active){const s=e.parent;t.changedPath.addParentNode(s)}}removeNodes(e,t,i){if(this.removeNodesFromParents(e,t,i),t.changedPath.active)for(const s of e)t.changedPath.addParentNode(s.parent)}forEachParentGroup(e,t,i){let s=t;for(;s&&s!==e.rootNode;)i(s),s=s.parent}removeNodesFromParents(e,t,i){const s=i==null,n=i||new wS;for(const a of e)this.removeFromParent(a,n),this.forEachParentGroup(t,a.parent,r=>{n.removeFromAllLeafChildren(r,a)});s&&n.flush()}removeEmptyGroups(e,t){let i=!0;const s=n=>{var l,c;const a=this.getChildrenMappedKey(n.key,n.rowGroupColumn),r=n.parent;return(r!=null&&r.childrenMapped?!r.childrenMapped[a]:!0)?!1:!!n.group&&((c=(l=n.childrenAfterGroup)==null?void 0:l.length)!=null?c:0)===0};for(;i;){i=!1;const n=new wS;e.forEach(a=>{this.forEachParentGroup(t,a,r=>{var o;s(r)&&(i=!0,this.removeFromParent(r,n),(o=this.selectionSvc)==null||o.setNodesSelected({nodes:[r],newValue:!1,source:"rowGroupChanged"}))})}),n.flush()}}removeFromParent(e,t){var s;e.parent&&(t?t.removeFromChildrenAfterGroup(e.parent,e):((0,m._removeFromArray)(e.parent.childrenAfterGroup,e),e.parent.updateHasChildren()));const i=this.getChildrenMappedKey(e.key,e.rowGroupColumn);(s=e.parent)!=null&&s.childrenMapped&&delete e.parent.childrenMapped[i],e.setRowTop(null),e.setRowIndex(null)}addToParent(e,t){const i=this.getChildrenMappedKey(e.key,e.rowGroupColumn);t!=null&&t.childrenMapped&&t.childrenMapped[i]!==e&&(t.childrenMapped[i]=e,t.childrenAfterGroup.push(e),mS(t,this.beans,!0))}areGroupColsEqual(e,t){return e==null||t==null||e.pivotMode!==t.pivotMode?!1:(0,m._areEqual)(e.groupedCols,t.groupedCols)&&(0,m._areEqual)(e.keyCreators,t.keyCreators)}checkAllGroupDataAfterColsChanged(e){const t=i=>{i&&i.forEach(s=>{var r;if(!s.group)return;const a={field:s.field,key:s.key,rowGroupColumn:s.rowGroupColumn,leafNode:(r=s.allLeafChildren)==null?void 0:r[0]};this.setGroupData(s,a),t(s.childrenAfterGroup)})};t(e.rootNode.childrenAfterGroup)}shotgunResetEverything(e,t){var a,r;if(this.noChangeInGroupingColumns(e,t))return;(r=(a=this.selectionSvc)==null?void 0:a.filterFromSelection)==null||r.call(a,o=>!o.group);const{groupedCols:i}=e,s=e.rootNode;s.leafGroup=i.length===0,s.childrenAfterGroup=[],s.childrenMapped={},s.updateHasChildren();const n=s.sibling;n&&(n.childrenAfterGroup=s.childrenAfterGroup,n.childrenMapped=s.childrenMapped),this.insertNodes(s.allLeafChildren,e)}noChangeInGroupingColumns(e,t){let i=!1;const s=this.showRowGroupCols.getShowRowGroupCols(),n=s?s.map(a=>a.getId()).join("-"):"";return t&&(i=this.areGroupColsEqual(e,this.oldGroupingDetails),this.oldGroupDisplayColIds!==n&&this.checkAllGroupDataAfterColsChanged(e)),this.oldGroupingDetails=e,this.oldGroupDisplayColIds=n,i}insertNodes(e,t){e.forEach(i=>{this.insertOneNode(i,t),t.changedPath.active&&t.changedPath.addParentNode(i.parent)})}insertOneNode(e,t,i){const s=this.getGroupInfo(e,t),n=this.findParentForNode(e,s,t,i);n.group||(0,m._warn)(184,{parentGroupData:n.data,childNodeData:e.data}),e.parent=n,e.level=s.length,n.childrenAfterGroup.push(e),n.updateHasChildren()}findParentForNode(e,t,i,s){let n=i.rootNode;return t.forEach((a,r)=>{n=this.getOrCreateNextNode(n,a,r,i),s!=null&&s.isRemoveFromAllLeafChildren(n,e)?s==null||s.preventRemoveFromAllLeafChildren(n,e):n.allLeafChildren.push(e)}),n}getOrCreateNextNode(e,t,i,s){var r;const n=this.getChildrenMappedKey(t.key,t.rowGroupColumn);let a=(r=e==null?void 0:e.childrenMapped)==null?void 0:r[n];return a||(a=this.createGroup(t,e,i,s),this.addToParent(a,e)),a}createGroup(e,t,i,s){const n=new m.RowNode(this.beans);return n.group=!0,n.field=e.field,n.rowGroupColumn=e.rowGroupColumn,this.setGroupData(n,e),n.key=e.key,n.id=this.createGroupId(n,t,i),n.level=i,n.leafGroup=i===s.groupedColCount-1,n.allLeafChildren=[],n.setAllChildrenCount(0),n.rowGroupIndex=i,n.childrenAfterGroup=[],n.childrenMapped={},n.updateHasChildren(),n.parent=t,this.setExpandedInitialValue(s,n),n}createGroupId(e,t,i){const s=(n,a)=>{if(!n.rowGroupColumn)return null;const r=a?s(a,a.parent,0):null;return`${r==null?"":r+"-"}${n.rowGroupColumn.getColId()}-${n.key}`};return m._ROW_ID_PREFIX_ROW_GROUP+s(e,t,i)}setGroupData(e,t){const i=t.rowGroupColumn;i&&t.leafNode&&(e.groupValue=this.valueSvc.getValue(i,t.leafNode)),e.groupData={},this.showRowGroupCols.getShowRowGroupCols().forEach(n=>{const a=e.rowGroupColumn;a!==null&&n.isRowGroupDisplayed(a.getId())&&(e.groupData[n.getColId()]=this.valueSvc.getValue(a,t.leafNode))})}getChildrenMappedKey(e,t){return t?t.getId()+"-"+e:e}setExpandedInitialValue(e,t){if(e.pivotMode&&t.leafGroup){t.expanded=!1;return}const i=e.isGroupOpenByDefault;if(i){const s={rowNode:t,field:t.field,key:t.key,level:t.level,rowGroupColumn:t.rowGroupColumn};t.expanded=i(s)==!0;return}if(e.expandByDefault===-1){t.expanded=!0;return}t.expanded=t.level<e.expandByDefault}getGroupInfo(e,t){const i=[];return t.groupedCols.forEach(s=>{let n=this.valueSvc.getKeyForNode(s,e),a=n!=null&&n!=="";if((t.pivotMode||!t.groupAllowUnbalanced)&&!a&&(n="",a=!0),a){const o={key:n,field:s.getColDef().field,rowGroupColumn:s,leafNode:e};i.push(o)}}),i}};function NY(e,t){var i;(i=e.rowGroupColsSvc)==null||i.setColumns(t,"api")}function OY(e,t){var i;(i=e.rowGroupColsSvc)==null||i.removeColumns(t,"api")}function FY(e,t){var i;(i=e.rowGroupColsSvc)==null||i.addColumns(t,"api")}function BY(e,t,i){var s,n;(n=(s=e.rowGroupColsSvc)==null?void 0:s.moveColumn)==null||n.call(s,t,i,"api")}function _Y(e){var t,i;return(i=(t=e.rowGroupColsSvc)==null?void 0:t.columns)!=null?i:[]}var wL={moduleName:"SharedRowGrouping",version:Re,apiFunctions:{setRowGroupColumns:NY,removeRowGroupColumns:OY,addRowGroupColumns:FY,getRowGroupColumns:_Y,moveRowGroupColumn:BY},dependsOn:[St,MS,SL,DS]},AL={moduleName:"RowGrouping",version:Re,dynamicBeans:{groupStrategy:RY},rowModels:["clientSide"],dependsOn:[wL,hL,Hm]},GY={moduleName:"RowGroupingPanel",version:Re,selectors:[IY],icons:{pivotPanel:"pivot",rowGroupPanel:"group",panelDelimiter:"small-right",panelDelimiterRtl:"small-left"},dependsOn:[St,m._PopupModule]},zY={moduleName:"GroupFilter",version:Re,userComponents:{agGroupColumnFilter:kY,agGroupColumnFloatingFilter:PY},dependsOn:[St,m._ColumnFilterModule]},VY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="rowModel",this.firstRow=-1,this.lastRow=-1,this.rowCount=-1,this.rowNodesByIndex={}}ensureRowHeightsValid(e,t,i,s){return!1}postConstruct(){const e=this.beans;this.rowHeight=(0,m._getRowHeightAsNumber)(e),this.addManagedEventListeners({viewportChanged:this.onViewportChanged.bind(this)}),this.addManagedPropertyListener("viewportDatasource",()=>this.updateDatasource()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=(0,m._getRowHeightAsNumber)(e),this.updateRowHeights()})}start(){this.updateDatasource()}isLastRowIndexKnown(){return!0}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){var t;const e=this.datasource;e&&((t=e.destroy)==null||t.call(e),this.beans.rowRenderer.datasourceChanged(),this.firstRow=-1,this.lastRow=-1)}updateDatasource(){const e=this.gos.get("viewportDatasource");e&&this.setViewportDatasource(e)}getPageSize(){return this.gos.get("viewportRowModelPageSize")}getBufferSize(){return this.gos.get("viewportRowModelBufferSize")}calculateFirstRow(e){const t=this.getBufferSize(),i=this.getPageSize(),s=e-t;return s<0?0:Math.floor(s/i)*i}calculateLastRow(e){if(e===-1)return e;const t=this.getBufferSize(),i=this.getPageSize(),s=e+t,n=Math.ceil(s/i)*i,a=this.rowCount-1;return Math.min(n,a)}onViewportChanged(e){var s;const t=this.calculateFirstRow(e.firstRow),i=this.calculateLastRow(e.lastRow);(this.firstRow!==t||this.lastRow!==i)&&(this.firstRow=t,this.lastRow=i,this.purgeRowsNotInViewport(),(s=this.datasource)==null||s.setViewportRange(this.firstRow,this.lastRow))}purgeRowsNotInViewport(){const e=this.rowNodesByIndex;Object.keys(e).forEach(t=>{const i=parseInt(t,10);if(i<this.firstRow||i>this.lastRow){if(this.isRowFocused(i))return;delete e[i]}})}isRowFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();return!t||t.rowPinned!=null?!1:t.rowIndex===e}setViewportDatasource(e){this.destroyDatasource(),this.datasource=e,this.rowCount=-1,e.init?e.init({setRowCount:this.setRowCount.bind(this),setRowData:this.setRowData.bind(this),getRow:this.getRow.bind(this)}):(0,m._warn)(226)}getType(){return"viewport"}getRow(e){return this.rowNodesByIndex[e]||(this.rowNodesByIndex[e]=this.createBlankRowNode(e)),this.rowNodesByIndex[e]}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}getRowCount(){return this.rowCount===-1?0:this.rowCount}getRowIndexAtPixel(e){return this.rowHeight!==0?Math.floor(e/this.rowHeight):0}getRowBounds(e){const t=this.rowHeight;return{rowHeight:t,rowTop:t*e}}updateRowHeights(){const e=this.rowHeight;this.forEachNode(t=>{t.setRowHeight(e),t.setRowTop(e*t.rowIndex)}),this.eventSvc.dispatchEvent({type:"modelUpdated",newData:!1,newPage:!1,keepRenderedRows:!0,animate:!1})}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}isEmpty(){return this.rowCount>0}isRowsToRender(){return this.rowCount>0}getNodesInRangeForSelection(e,t){const i=e.rowIndex,s=t.rowIndex,n=i<this.firstRow||i>this.lastRow,a=s<this.firstRow||s>this.lastRow;if(n||a)return[];const r=[],o=i<=s?i:s,l=i<=s?s:i;for(let c=o;c<=l;c++)r.push(this.rowNodesByIndex[c]);return r}forEachNode(e){let t=0;Object.keys(this.rowNodesByIndex).forEach(i=>{const s=parseInt(i,10),n=this.rowNodesByIndex[s];e(n,t),t++})}setRowData(e){const t=this.rowNodesByIndex;for(const i of Object.keys(e)){const s=e[i],n=parseInt(i,10);if(n>=this.firstRow&&n<=this.lastRow){let a=t[n];(0,m._missing)(a)&&(a=this.createBlankRowNode(n),t[n]=a),a.setDataAndId(s,n.toString())}}}createBlankRowNode(e){const t=new m.RowNode(this.beans),i=this.rowHeight;return t.setRowHeight(i),t.setRowTop(i*e),t.setRowIndex(e),t}setRowCount(e,t=!1){if(e===this.rowCount)return;this.rowCount=e;const i=this.eventSvc;i.dispatchEventOnce({type:"rowCountReady"}),i.dispatchEvent({type:"modelUpdated",newData:!1,newPage:!1,keepRenderedRows:t,animate:!1})}isRowPresent(e){return!!this.getRowNode(e.id)}},jY={moduleName:"ViewportRowModel",version:Re,rowModels:["viewport"],beans:[VY],dependsOn:[St]};function HY(e,t){var i;(i=e.clipboardSvc)==null||i.copyToClipboard(t)}function WY(e,t){var i;(i=e.clipboardSvc)==null||i.cutToClipboard(t)}function UY(e,t){var i;(i=e.clipboardSvc)==null||i.copySelectedRowsToClipboard(t)}function KY(e,t){var i;(i=e.clipboardSvc)==null||i.copySelectedRangeToClipboard(t)}function $Y(e){var t;(t=e.clipboardSvc)==null||t.copyRangeDown()}function YY(e){var t;(t=e.clipboardSvc)==null||t.pasteFromClipboard()}var AS="paste",IS="dragCopy",IL="clipboard";function XY(e,t=","){const i=[],s=a=>a==="\r"||a===`
`;let n=!1;if(e==="")return[[""]];for(let a=0,r=0,o=0;o<e.length;o++){const l=e[o-1],c=e[o],h=e[o+1],d=()=>{i[a]||(i[a]=[]),i[a][r]||(i[a][r]="")};if(d(),c==='"'&&(n?h==='"'?(i[a][r]+='"',o++):n=!1:(l===void 0||l===t||s(l))&&(n=!0)),!n&&c!=='"'){if(c===t){r++,d();continue}else if(s(c)){r=0,a++,d(),c==="\r"&&h===`
`&&o++;continue}}i[a][r]+=c}return i}var ZY=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="clipboardSvc",this.clientSideRowModel=null,this.gridCtrl=null,this.lastPasteOperationTime=0,this.navigatorApiFailed=!1}postConstruct(){const{gos:e,rowModel:t,ctrlsSvc:i}=this.beans;(0,m._isClientSideRowModel)(e,t)&&(this.clientSideRowModel=t),i.whenReady(this,s=>{this.gridCtrl=s.gridCtrl})}destroy(){super.destroy(),this.clientSideRowModel=null,this.gridCtrl=null}pasteFromClipboard(){!this.gos.get("suppressClipboardApi")&&!this.navigatorApiFailed&&navigator.clipboard&&navigator.clipboard.readText?navigator.clipboard.readText().then(this.processClipboardData.bind(this)).catch(t=>{(0,m._warn)(40,{e:t,method:"readText"}),this.navigatorApiFailed=!0,this.pasteFromClipboardLegacy()}):this.pasteFromClipboardLegacy()}pasteFromClipboardLegacy(){let e=!1;const t=i=>{const s=Date.now();s-this.lastPasteOperationTime<50&&(e=!0,i.preventDefault()),this.lastPasteOperationTime=s};this.executeOnTempElement(i=>{i.addEventListener("paste",t),i.focus({preventScroll:!0})},i=>{const s=i.value;e?this.refocusLastFocusedCell():this.processClipboardData(s),i.removeEventListener("paste",t)})}refocusLastFocusedCell(){const{focusSvc:e}=this.beans,t=e.getFocusedCell();t&&e.setFocusedCell({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0})}getClipboardDelimiter(){const e=this.gos.get("clipboardDelimiter");return(0,m._exists)(e)?e:"	"}processClipboardData(e){if(e==null)return;let t=XY(e,this.getClipboardDelimiter());const i=this.gos.getCallback("processDataFromClipboard");if(i&&(t=i({data:t})),t==null)return;this.gos.get("suppressLastEmptyLineOnPaste")&&this.removeLastLineIfBlank(t);const{rangeSvc:s}=this.beans,n=(a,r,o,l)=>{(s==null?void 0:s.isMoreThanOneCell())&&!this.hasOnlyOneValueToPaste(t)?this.pasteIntoActiveRange(s,t,a,r,l):this.pasteStartingFromFocusedCell(t,a,r,o,l)};this.doPasteOperation(n)}doPasteOperation(e){const t="clipboard",{eventSvc:i,focusSvc:s,rowRenderer:n,gos:a}=this.beans;i.dispatchEvent({type:"pasteStart",source:t});const{clientSideRowModel:r}=this,o=r==null?void 0:r.rootNode,l=o&&new m.ChangedPath(a.get("aggregateOnlyChangedColumns"),o),c={},h=[],d=s.getFocusedCell();e(c,h,d,l);const u=[...h];l&&(r.doAggregate(l),l.forEachChangedNodeDepthFirst(p=>{u.push(p)})),n.refreshCells({rowNodes:u}),this.dispatchFlashCells(c),this.fireRowChanged(h),this.refocusLastFocusedCell(),i.dispatchEvent({type:"pasteEnd",source:t})}pasteIntoActiveRange(e,t,i,s,n){const a=this.getRangeSize(e)%t.length!=0;let r=0,o=0;const l=(c,h,d,u)=>{if(u-r>=t.length){if(a)return;r+=o,o=0}const g=t[u-r];s.push(h);const f=this.gos.getCallback("processCellFromClipboard");d.forEach((y,v)=>{if(!y.isCellEditable(h)||y.isSuppressPaste(h))return;v>=g.length&&(v=v%g.length);const x=this.processCell(h,y,g[v],IS,f,!0);h.setDataValue(y,x,AS),n&&n.addParentNode(h.parent,[y]);const{rowIndex:S,rowPinned:M}=c,D=(0,m._createCellId)({rowIndex:S,column:y,rowPinned:M});i[D]=!0}),o++};this.iterateActiveRanges(!1,l)}getDisplayedColumnsStartingAt(e){let t=e;const i=[],s=this.beans.visibleCols;for(;t!=null;)i.push(t),t=s.getColAfter(t);return i}pasteStartingFromFocusedCell(e,t,i,s,n){if(!s)return;const a={rowIndex:s.rowIndex,rowPinned:s.rowPinned},r=this.getDisplayedColumnsStartingAt(s.column);this.isPasteSingleValueIntoRange(e)?this.pasteSingleValueIntoRange(e,i,t,n):this.pasteMultipleValues(e,a,i,r,t,IL,n)}isPasteSingleValueIntoRange(e){const t=this.beans.rangeSvc;return this.hasOnlyOneValueToPaste(e)&&!!t&&!t.isEmpty()}pasteSingleValueIntoRange(e,t,i,s){const n=e[0][0],a=(r,o,l)=>{t.push(o),l.forEach(c=>this.updateCellValue(o,c,n,i,IL,s))};this.iterateActiveRanges(!1,a)}hasOnlyOneValueToPaste(e){return e.length===1&&e[0].length===1}copyRangeDown(){const{rangeSvc:e,gos:t,valueSvc:i}=this.beans;if(!e||e.isEmpty())return;const s=[],n=(a,r,o,l)=>{const c=t.getCallback("processCellForClipboard"),h=t.getCallback("processCellFromClipboard"),d=(u,p,g)=>{s.length?(r.push(p),g.forEach((f,y)=>{if(!f.isCellEditable(p)||f.isSuppressPaste(p))return;const v=this.processCell(p,f,s[y],IS,h,!0);p.setDataValue(f,v,AS),l&&l.addParentNode(p.parent,[f]);const{rowIndex:x,rowPinned:S}=u,M=(0,m._createCellId)({rowIndex:x,column:f,rowPinned:S});a[M]=!0})):g.forEach(f=>{const y=this.processCell(p,f,i.getValue(f,p),IS,c,!1,!0);s.push(y)})};this.iterateActiveRanges(!0,d)};this.doPasteOperation(n)}removeLastLineIfBlank(e){const t=(0,m._last)(e);if(t&&t.length===1&&t[0]===""){if(e.length===1)return;(0,m._removeFromArray)(e,t)}}fireRowChanged(e){this.gos.get("editType")==="fullRow"&&e.forEach(t=>{this.eventSvc.dispatchEvent({type:"rowValueChanged",node:t,data:t.data,rowIndex:t.rowIndex,rowPinned:t.rowPinned})})}pasteMultipleValues(e,t,i,s,n,a,r){let o=t;const l=this.beans,{gos:c}=l,h=this.clientSideRowModel!=null&&!c.get("enableGroupEdit")&&!c.get("treeData"),d=()=>{for(;;){if(!o)return null;const u=(0,m._getRowNode)(l,o);if(o=(0,m._getRowBelow)(l,{rowPinned:o.rowPinned,rowIndex:o.rowIndex}),u==null)return null;if(!(u.detail||u.footer||h&&u.group))return u}};e.forEach(u=>{const p=d();p&&(u.forEach((g,f)=>this.updateCellValue(p,s[f],g,n,a,r)),i.push(p))})}updateCellValue(e,t,i,s,n,a){if(!e||!t||!t.isCellEditable(e)||t.isSuppressPaste(e))return;const r=this.processCell(e,t,i,n,this.gos.getCallback("processCellFromClipboard"),!0);e.setDataValue(t,r,AS);const{rowIndex:o,rowPinned:l}=e,c=(0,m._createCellId)({rowIndex:o,column:t,rowPinned:l});s[c]=!0,a&&a.addParentNode(e.parent,[t])}copyToClipboard(e={}){this.copyOrCutToClipboard(e)}cutToClipboard(e={},t="api"){this.gos.get("suppressCutToClipboard")||(this.eventSvc.dispatchEvent({type:"cutStart",source:t}),this.copyOrCutToClipboard(e,!0),this.eventSvc.dispatchEvent({type:"cutEnd",source:t}))}copyOrCutToClipboard(e,t){let{includeHeaders:i,includeGroupHeaders:s}=e;const{gos:n,focusSvc:a}=this.beans;i==null&&(i=n.get("copyHeadersToClipboard")),s==null&&(s=n.get("copyGroupHeadersToClipboard"));const r={includeHeaders:i,includeGroupHeaders:s},o=n.get("rowSelection"),l=n.get("cellSelection");let c=null;this.shouldCopyCells(l,o)?(this.copySelectedRangeToClipboard(r),c=0):this.shouldCopyRows(o)?(this.copySelectedRowsToClipboard(r),c=1):a.isAnyCellFocused()&&(this.copyFocusedCellToClipboard(r),c=2),t&&c!==null&&this.clearCellsAfterCopy(c)}shouldCopyCells(e,t){const{rangeSvc:i,selectionSvc:s,gos:n}=this.beans;if(!i||i.isEmpty())return!1;if(e)return!(typeof t=="object"&&t.copySelectedRows&&!(s!=null&&s.isEmpty()));{const a=n.get("suppressCopySingleCellRanges");return!(!i.isMoreThanOneCell()&&a)}}shouldCopyRows(e){var s,n;const{selectionSvc:t,gos:i}=this.beans;return(s=t==null?void 0:t.isEmpty())==null||s?!1:e&&typeof e!="string"?(n=e.copySelectedRows)!=null?n:!1:!i.get("suppressCopyRowsToClipboard")}clearCellsAfterCopy(e){const t=this.beans,{rangeSvc:i,focusSvc:s,eventSvc:n}=t;if(n.dispatchEvent({type:"keyShortcutChangedCellStart"}),e===0)i.clearCellRangeCellValues({cellEventSource:"clipboardSvc"});else if(e===1)this.clearSelectedRows();else{const a=s.getFocusedCell();if(a==null)return;const r=(0,m._getRowNode)(t,a);r&&this.clearCellValue(r,a.column)}n.dispatchEvent({type:"keyShortcutChangedCellEnd"})}clearSelectedRows(){var n;const{selectionSvc:e,visibleCols:t}=this.beans,i=(n=e==null?void 0:e.getSelectedNodes())!=null?n:[],s=t.allCols;for(const a of i)for(const r of s)this.clearCellValue(a,r)}clearCellValue(e,t){if(!t.isCellEditable(e))return;const i=this.beans.valueSvc.getDeleteValue(t,e);e.setDataValue(t,i,"clipboardSvc")}iterateActiveRanges(e,t,i){const s=this.beans.rangeSvc;if(!s||s.isEmpty())return;const n=s.getCellRanges();e?this.iterateActiveRange(n[0],t,i,!0):n.forEach((a,r)=>this.iterateActiveRange(a,t,i,r===n.length-1))}iterateActiveRange(e,t,i,s){const{beans:n}=this,{rangeSvc:a}=n;if(!a)return;let r=a.getRangeStartRow(e);const o=a.getRangeEndRow(e);i&&e.columns&&i(e.columns);let l=0,c=!1;for(;!c&&r!=null;){const h=(0,m._getRowNode)(n,r);c=(0,m._isSameRow)(r,o),t(r,h,e.columns,l++,c&&s),r=(0,m._getRowBelow)(n,r)}}copySelectedRangeToClipboard(e={}){const t=this.beans.rangeSvc;if(!t||t.isEmpty())return;const i=t.areAllRangesAbleToMerge(),{data:s,cellsToFlash:n}=i?this.buildDataFromMergedRanges(t,e):this.buildDataFromRanges(t,e);this.copyDataToClipboard(s),this.dispatchFlashCells(n)}buildDataFromMergedRanges(e,t){const i=new Set,s=e.getCellRanges(),n=new Map,a=[],r={};s.forEach(h=>{h.columns.forEach(p=>i.add(p));const{rowPositions:d,cellsToFlash:u}=this.getRangeRowPositionsAndCellsToFlash(e,h);d.forEach(p=>{const g=`${p.rowIndex}-${p.rowPinned||"null"}`;n.get(g)||(n.set(g,!0),a.push(p))}),Object.assign(r,u)});const o=this.beans.visibleCols.allCols,l=Array.from(i);return l.sort((h,d)=>{const u=o.indexOf(h),p=o.indexOf(d);return u-p}),{data:this.buildExportParams({columns:l,rowPositions:a,includeHeaders:t.includeHeaders,includeGroupHeaders:t.includeGroupHeaders}),cellsToFlash:r}}buildDataFromRanges(e,t){const i=e.getCellRanges(),s=[],n={};return i.forEach(a=>{const{rowPositions:r,cellsToFlash:o}=this.getRangeRowPositionsAndCellsToFlash(e,a);Object.assign(n,o),s.push(this.buildExportParams({columns:a.columns,rowPositions:r,includeHeaders:t.includeHeaders,includeGroupHeaders:t.includeGroupHeaders}))}),{data:s.join(`
`),cellsToFlash:n}}getRangeRowPositionsAndCellsToFlash(e,t){const i=[],s={},n=e.getRangeStartRow(t),a=e.getRangeEndRow(t);let r=n;for(;r&&(i.push(r),t.columns.forEach(o=>{const{rowIndex:l,rowPinned:c}=r,h=(0,m._createCellId)({rowIndex:l,column:o,rowPinned:c});s[h]=!0}),!(0,m._isSameRow)(r,a));)r=(0,m._getRowBelow)(this.beans,r);return{rowPositions:i,cellsToFlash:s}}getCellsToFlashFromRowNodes(e){const t=this.beans.visibleCols.allCols,i={};for(let s=0;s<e.length;s++){const{level:n,rowIndex:a,rowPinned:r,sibling:o}=e[s],l=n===-1?o.rowIndex:a;if(l!=null)for(let c=0;c<t.length;c++){const h=t[c],d=(0,m._createCellId)({rowIndex:l,column:h,rowPinned:r});i[d]=!0}}return i}copyFocusedCellToClipboard(e={}){var r,o;let t=this.beans.focusSvc.getFocusedCell();if(t==null)return;t=(o=(r=this.beans.rowSpanSvc)==null?void 0:r.getCellStart(t))!=null?o:t;const i=(0,m._createCellId)(t),s={rowPinned:t.rowPinned,rowIndex:t.rowIndex},n=t.column,a=this.buildExportParams({columns:[n],rowPositions:[s],includeHeaders:e.includeHeaders,includeGroupHeaders:e.includeGroupHeaders});this.copyDataToClipboard(a),this.dispatchFlashCells({[i]:!0})}copySelectedRowsToClipboard(e={}){var r;const{columnKeys:t,includeHeaders:i,includeGroupHeaders:s}=e,n=this.buildExportParams({columns:t,includeHeaders:i,includeGroupHeaders:s});this.copyDataToClipboard(n);const a=((r=this.beans.selectionSvc)==null?void 0:r.getSelectedNodes())||[];this.dispatchFlashCells(this.getCellsToFlashFromRowNodes(a))}buildExportParams(e){const{columns:t,rowPositions:i,includeHeaders:s=!1,includeGroupHeaders:n=!1}=e,{gos:a,csvCreator:r}=this.beans,o=({node:c,column:h})=>{var p;const{value:d,valueFormatted:u}=this.beans.valueSvc.getValueForDisplay(h,c,!0);return(p=u!=null?u:d)!=null?p:""},l={columnKeys:t,rowPositions:i,skipColumnHeaders:!s,skipColumnGroupHeaders:!n,suppressQuotes:!0,columnSeparator:this.getClipboardDelimiter(),onlySelected:!i,processCellCallback:a.getCallback("processCellForClipboard"),processRowGroupCallback:o,processHeaderCallback:a.getCallback("processHeaderForClipboard"),processGroupHeaderCallback:a.getCallback("processGroupHeaderForClipboard")};return r.getDataAsCsv(l,!0)}dispatchFlashCells(e){window.setTimeout(()=>{this.eventSvc.dispatchEvent({type:"flashCells",cells:e})},0)}processCell(e,t,i,s,n,a,r){var l;const o=this.beans.valueSvc;return n?n({column:t,node:e,value:i,type:s,formatValue:h=>{var d;return(d=o.formatValue(t,e!=null?e:null,h))!=null?d:h},parseValue:h=>o.parseValue(t,e!=null?e:null,h,o.getValue(t,e))}):a&&t.getColDef().useValueParserForImport!==!1?o.parseValue(t,e!=null?e:null,i,o.getValue(t,e)):r&&t.getColDef().useValueFormatterForExport!==!1&&(l=o.formatValue(t,e!=null?e:null,i))!=null?l:i}copyDataToClipboard(e){const t=this.gos.getCallback("sendToClipboard");if(t){t({data:e});return}if(!this.gos.get("suppressClipboardApi")&&navigator.clipboard){navigator.clipboard.writeText(e).catch(s=>{(0,m._warn)(40,{e:s,method:"writeText"}),this.copyDataToClipboardLegacy(e)});return}this.copyDataToClipboardLegacy(e)}copyDataToClipboardLegacy(e){this.executeOnTempElement(t=>{const i=(0,m._getDocument)(this.beans),s=(0,m._getActiveDomElement)(this.beans);t.value=e||" ",t.select(),t.focus({preventScroll:!0}),i.execCommand("copy")||(0,m._warn)(41),s!=null&&s.focus!=null&&s.focus({preventScroll:!0})})}executeOnTempElement(e,t){if(!this.gridCtrl)return;const i=(0,m._getDocument)(this.beans),s=i.createElement("textarea"),n=s.style;n.width="1px",n.height="1px";const a=i.documentElement;n.top=a.scrollTop+"px",n.left=a.scrollLeft+"px",n.position="absolute",n.opacity="0";const r=this.gridCtrl.getGui();r.appendChild(s);try{e(s)}catch(o){(0,m._warn)(42)}t?window.setTimeout(()=>{t(s),r.removeChild(s)},100):r.removeChild(s)}getRangeSize(e){const t=e.getCellRanges();let i=0,s=0;return t.length>0&&(i=e.getRangeStartRow(t[0]).rowIndex,s=e.getRangeEndRow(t[0]).rowIndex),i-s+1}},qY={moduleName:"Clipboard",version:Re,beans:[ZY],apiFunctions:{copyToClipboard:HY,cutToClipboard:WY,copySelectedRowsToClipboard:UY,copySelectedRangeToClipboard:KY,copySelectedRangeDown:$Y,pasteFromClipboard:YY},dependsOn:[St,m.CsvExportModule,m._KeyboardNavigationModule,m.HighlightChangesModule]},QY='.ag-row-number-cell{background-color:var(--ag-header-background-color);border:none;color:var(--ag-header-text-color);font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;white-space:nowrap;width:100%}:where(.ag-ltr) .ag-row-number-cell{text-align:right}:where(.ag-rtl) .ag-row-number-cell{text-align:left}.ag-row-numbers-resizer{bottom:-2px;cursor:ns-resize;height:4px;position:absolute;width:100%}:where(.ag-ltr) .ag-row-numbers-resizer{left:0}:where(.ag-rtl) .ag-row-numbers-resizer{right:0}:where(.ag-row-number-header.ag-row-number-selection-enabled){cursor:cell}.ag-row-number-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-row-number-range-selected{background-color:var(--ag-row-numbers-selected-color)}:where(.ag-ltr){.ag-row-number-header,:where(.ag-cell.ag-row-number-cell):not(.ag-cell-last-left-pinned){border-right:var(--ag-pinned-column-border)}:where(.ag-cell.ag-row-number-cell.ag-row-number-selection-enabled){cursor:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkO2NsaXAtcnVsZTpldmVub2RkO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxLjUiPjxwYXRoIGQ9Ik0zLjQ0NSA4LjkxMVY3LjQwOUg5Ljc1VjYuMDE0bDIuNTM1IDIuMTQ2LTIuNTM1IDIuMTQ2VjguOTExeiIgc3R5bGU9InN0cm9rZTojZmZmO3N0cm9rZS13aWR0aDouNDFweCIgdHJhbnNmb3JtPSJtYXRyaXgoMS41Nzg0IDAgMCAxLjg2NDI5IC00LjQxMyAtNy4yMTIpIi8+PC9zdmc+"),auto}}:where(.ag-rtl){.ag-row-number-header,:where(.ag-cell.ag-row-number-cell):not(.ag-cell-first-right-pinned){border-left:var(--ag-pinned-column-border)}:where(.ag-cell.ag-row-number-cell.ag-row-number-selection-enabled){cursor:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkO2NsaXAtcnVsZTpldmVub2RkO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxLjUiPjxwYXRoIGQ9Ik01Ljk3OSA4LjkxMXYxLjM5NUwzLjQ0NSA4LjE2bDIuNTM0LTIuMTQ2djEuMzk1aDYuMzA2djEuNTAyeiIgc3R5bGU9InN0cm9rZTojZmZmO3N0cm9rZS13aWR0aDouNDFweCIgdHJhbnNmb3JtPSJtYXRyaXgoMS41Nzg0IDAgMCAxLjg2NDI5IC00LjQxMyAtNy4yMTIpIi8+PC9zdmc+"),auto}}',JY={tag:"div",cls:"ag-row-numbers-resizer"},e6=class extends m.Component{constructor(e){super(JY),this.cellCtrl=e,this.initialYPosition=-1,this.dragging=!1}postConstruct(){const{beans:e,cellCtrl:t}=this,{dragSvc:i,environment:s}=e;this.defaultRowHeight=s.getDefaultRowHeight(),i.addDragSource({dragStartPixels:0,eElement:this.getGui(),onDragStart:this.onDragStart.bind(this),onDragging:this.onDragging.bind(this),onDragStop:this.onDragStop.bind(this),onDragCancel:this.onDragCancel.bind(this)});const n=t.getRowPosition();this.node=(0,m._getRowNode)(this.beans,n)}onDragStart(e){this.node&&(this.dragging=!0,this.initialHeight=this.node.rowHeight,this.beans.eventSvc.dispatchEvent({type:"rowResizeStarted",node:this.node,event:e,rowHeight:this.initialHeight}))}onDragging(e){const{clientY:t}=e;if(this.initialYPosition===-1||!this.dragging){this.initialYPosition=t;return}const{beans:i,initialHeight:s,initialYPosition:n,defaultRowHeight:a,node:r}=this;if(s==null)return;const o=r==null?void 0:r.rowHeight,l=Math.max(s-(n-t),a);if(o===l)return;r==null||r.setRowHeight(l);const{rowRenderer:c,rowModel:h,pinnedRowModel:d}=i,u=!!(r!=null&&r.rowPinned);u&&c.redraw({afterScroll:!0}),(!u||d!=null&&d.isManual())&&h.onRowHeightChanged({animate:!1})}onDragStop(e){var t;this.beans.eventSvc.dispatchEvent({type:"rowResizeEnded",node:this.node,event:e,rowHeight:(t=this.node)==null?void 0:t.rowHeight}),this.clearDragDetails()}onDragCancel(){this.clearDragDetails()}clearDragDetails(){this.initialYPosition=-1,this.initialHeight=null,this.dragging=!1}destroy(){this.clearDragDetails(),this.node=void 0,super.destroy()}};function TL(e){const t=e.get("rowNumbers");return!(!t||typeof t!="object"||!t.enableRowResizer)}var t6=class{constructor(e,t){this.beans=e,this.cellCtrl=t}refreshRowResizer(){!TL(this.beans.gos)||!this.isRowResizeSupported(this.cellCtrl.rowNode)?this.removeRowResizerFromCellComp():this.addResizerToCellComp()}isRowResizeSupported(e){const{pinnedRowModel:t,rowModel:i,visibleCols:s}=this.beans,n=!!i.onRowHeightChanged;return s.autoHeightCols.length?((0,m._warn)(276),!1):e.rowPinned!=null?t!=null&&t.isManual()?n:!0:n}addResizerToCellComp(){const{beans:e,cellCtrl:t}=this,{eGui:i}=t;let{rowResizer:s}=this;if(!s){if(s=e.registry.createDynamicBean("rowNumberRowResizer",!1,t),!s)return;this.rowResizer=e.context.createBean(s)}i.appendChild(s.getGui())}removeRowResizerFromCellComp(){if(!this.rowResizer)return;const{eGui:e}=this.cellCtrl;e.removeChild(this.rowResizer.getGui()),this.rowResizer=this.beans.context.destroyBean(this.rowResizer)}destroy(){this.removeRowResizerFromCellComp()}},i6=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="rowNumbersSvc",this.isIntegratedWithSelection=!1}postConstruct(){const e=(0,m._debounce)(this,this.refreshCells.bind(this,!1,!0),10);this.addManagedEventListeners({modelUpdated:e,rangeSelectionChanged:()=>this.refreshCells(!0),pinnedRowsChanged:e}),this.addManagedPropertyListeners(["rowNumbers","cellSelection"],t=>{this.refreshSelectionIntegration(),this.updateColumns(t)}),this.refreshSelectionIntegration()}addColumns(e){this.columns!=null&&(e.list=this.columns.list.concat(e.list),e.tree=this.columns.tree.concat(e.tree),(0,m._updateColsMap)(e))}createColumns(e,t){var u,p,g,f,y,v;if(!this.gos.get("rowNumbers"))return;const i=()=>{var x;(0,m._destroyColumnTree)(this.beans,(x=this.columns)==null?void 0:x.tree),this.columns=null},s=e.treeDepth,a=((p=(u=this.columns)==null?void 0:u.treeDepth)!=null?p:-1)==s,r=this.generateRowNumberCols();if((0,m._areColIdsEqual)(r,(f=(g=this.columns)==null?void 0:g.list)!=null?f:[])&&a)return;i();const{colGroupSvc:l}=this.beans,c=(y=l==null?void 0:l.findDepth(e.tree))!=null?y:0,h=(v=l==null?void 0:l.balanceTreeForAutoCols(r,c))!=null?v:[];this.columns={list:r,tree:h,treeDepth:c,map:{}},t(x=>{if(!x)return null;const S=x.filter(M=>!(0,m.isRowNumberCol)(M));return[...r,...S]})}handleMouseDownOnCell(e,t){return!this.isIntegratedWithSelection||t.target.classList.contains("ag-row-numbers-resizer")?!1:(t.shiftKey||setTimeout(()=>{this.focusFirstRenderedCellAtRowPosition(e)}),!0)}updateColumns(e){var i;const t=(0,m._convertColumnEventSourceType)(e.source);this.refreshSelectionIntegration(),(i=this.columns)==null||i.list.forEach(s=>{const n=this.createRowNumbersColDef();s.setColDef(n,null,t),(0,m._applyColumnState)(this.beans,{state:[b({colId:s.getColId()},n)]},t)})}getColumn(){var e,t;return(t=(e=this.columns)==null?void 0:e.list.find(m.isRowNumberCol))!=null?t:null}getColumns(){var e,t;return(t=(e=this.columns)==null?void 0:e.list)!=null?t:null}setupForHeader(e){const{column:t,eGridHeader:i}=e.params;(0,m.isRowNumberCol)(t)&&((0,m._setAriaLabel)(i,"Row Number"),this.addManagedElementListeners(i,{click:this.onHeaderClick.bind(this),keydown:this.onHeaderKeyDown.bind(this),focus:this.onHeaderFocus.bind(this)}))}createRowNumbersRowResizerFeature(e,t){if(TL(this.gos))return new t6(e,t)}refreshSelectionIntegration(){const{beans:e}=this,{gos:t,rangeSvc:i}=e,s=t.get("cellSelection");this.refreshRowNumberOverrides(),this.isIntegratedWithSelection=!!i&&!!s&&!this.isSuppressCellSelectionIntegration}refreshRowNumberOverrides(){const e=this.gos.get("rowNumbers");if(this.rowNumberOverrides={},!e||typeof e!="object")return;e.suppressCellSelectionIntegration&&(this.isSuppressCellSelectionIntegration=!0);const t=["contextMenuItems","context","onCellClicked","onCellContextMenu","onCellDoubleClicked","headerTooltip","headerStyle","headerComponent","headerComponentParams","suppressHeaderKeyboardEvent","tooltipField","tooltipValueGetter","tooltipComponent","tooltipComponentParams","valueGetter","valueFormatter","width","maxWidth","minWidth","resizable"];for(const i of t)e[i]!=null&&(this.rowNumberOverrides[i]=e[i])}onHeaderFocus(){var e;(e=this.beans.ariaAnnounce)==null||e.announceValue("Press Space to select all cells","ariaSelectAllCells")}onHeaderKeyDown(e){!this.isIntegratedWithSelection||e.key!==m.KeyCode.SPACE||(0,m._selectAllCells)(this.beans)}onHeaderClick(){this.isIntegratedWithSelection&&(0,m._selectAllCells)(this.beans)}refreshCells(e,t){var s,n;const i=this.getColumn();if(i){if(t){const a=(s=this.beans.autoWidthCalc)==null?void 0:s.getPreferredWidthForElements([this.createDummyElement(i)],2);a!=null&&((n=this.beans.colResize)==null||n.setColumnWidths([{key:i,newWidth:a}],!1,!0,"rowNumbersService"))}this.beans.rowRenderer.refreshCells({columns:[i],force:e})}}createDummyElement(e){const t=(0,m._createElement)({tag:"div",cls:"ag-cell-value ag-cell"});let i=String(this.beans.rowModel.getRowCount()+1);if(typeof this.rowNumberOverrides.valueFormatter=="function"){const s=(0,m._addGridCommonParams)(this.beans.gos,{data:void 0,value:i,node:null,column:e,colDef:e.colDef});i=this.rowNumberOverrides.valueFormatter(s)}return t.textContent=i,t}createRowNumbersColDef(){const{gos:e,contextMenuSvc:t}=this.beans,i=e.get("enableRtl");return E(b({minWidth:60,width:60,resizable:!1,valueGetter:this.valueGetter,contextMenuItems:this.isIntegratedWithSelection||!t?void 0:()=>[]},this.rowNumberOverrides),{colId:m.ROW_NUMBERS_COLUMN_ID,chartDataType:"excluded",suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPinned:!0,pinned:i?"right":"left",lockPosition:i?"right":"left",editable:!1,suppressFillHandle:!0,suppressAutoSize:!0,suppressSizeToFit:!0,suppressHeaderContextMenu:!0,suppressNavigable:!0,headerClass:this.getHeaderClass(),cellClass:this.getCellClass.bind(this),cellAriaRole:"rowheader"})}valueGetter(e){const t=e.node;if(t!=null&&t.rowPinned&&t.pinnedSibling){const{rowIndex:i}=t.pinnedSibling;return`${i==null?"-":i+1}`}return String(((t==null?void 0:t.rowIndex)||0)+1)}getHeaderClass(){const e=["ag-row-number-header"];return this.isIntegratedWithSelection&&e.push("ag-row-number-selection-enabled"),e}getCellClass(e){const{beans:t}=this,{rangeSvc:i,gos:s}=t,{node:n}=e,a=["ag-row-number-cell"],r=s.get("cellSelection");if(!i||!r)return a;this.isIntegratedWithSelection&&a.push("ag-row-number-selection-enabled");const o=i.getCellRanges();if(!o.length)return a;const l=this.beans.visibleCols.allCols.length-1,c=typeof r=="object"&&r.enableHeaderHighlight;for(const h of o)i.isRowInRange(n.rowIndex,n.rowPinned,h)&&(c&&a.push("ag-row-number-range-highlight"),h.columns.length===l&&a.push("ag-row-number-range-selected"));return a}generateRowNumberCols(){const{gos:e}=this;if(!e.get("rowNumbers"))return[];const t=this.createRowNumbersColDef(),i=t.colId;e.validateColDef(t,i,!0);const s=new m.AgColumn(t,null,i,!1);return this.createBean(s),[s]}focusFirstRenderedCellAtRowPosition(e){const{beans:t,gos:i}=this,{visibleCols:s,colViewport:n}=t,a=i.get("enableRtl")?s.rightCols:s.leftCols;let r;if(a.length==1){const h=(0,m._getRowNode)(t,e);if(!h)return;r=n.getColsWithinViewport(h)}else r=a;const o=r.find(h=>!(0,m.isRowNumberCol)(h));if(!o)return;const{rowPinned:l,rowIndex:c}=e;t.focusSvc.setFocusedCell({rowIndex:c,rowPinned:l,column:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}destroy(){var e;(0,m._destroyColumnTree)(this.beans,(e=this.columns)==null?void 0:e.tree),this.rowNumberOverrides=null,super.destroy()}},s6={moduleName:"RowNumbers",version:Re,beans:[i6],dynamicBeans:{rowNumberRowResizer:e6},dependsOn:[St,m.CellStyleModule,m._SharedDragAndDropModule],css:[QY]},n6={tag:"div",cls:"ag-filter-toolpanel-search",role:"presentation",children:[{tag:"div",ref:"eExpand",cls:"ag-filter-toolpanel-expand"},{tag:"ag-input-text-field",ref:"eFilterTextField",cls:"ag-filter-toolpanel-search-input"}]},a6=class extends m.Component{constructor(){super(...arguments),this.eExpand=m.RefPlaceholder,this.eFilterTextField=m.RefPlaceholder}postConstruct(){this.setTemplate(n6,[m.AgInputTextFieldSelector]);const e=this.getLocaleTextFunc();this.eFilterTextField.setAutoComplete(!1).setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input")).onValueChange(this.onSearchTextChanged.bind(this)),this.createExpandIcons(),this.setExpandState(0),this.addManagedElementListeners(this.eExpand,{click:this.onExpandClicked.bind(this)}),this.addManagedEventListeners({newColumnsLoaded:this.showOrHideOptions.bind(this)})}init(e){this.params=e,this.beans.colModel.ready&&this.showOrHideOptions()}createExpandIcons(){const{eExpand:e,beans:t}=this;e.appendChild(this.eExpandChecked=(0,m._createIconNoSpan)("accordionOpen",t)),e.appendChild(this.eExpandUnchecked=(0,m._createIconNoSpan)("accordionClosed",t)),e.appendChild(this.eExpandIndeterminate=(0,m._createIconNoSpan)("accordionIndeterminate",t))}showOrHideOptions(){const{params:e,eFilterTextField:t}=this,i=!e.suppressFilterSearch,s=!e.suppressExpandAll,n=this.getLocaleTextFunc();t.setInputPlaceholder(n("searchOoo","Search..."));const a=o=>o.getOriginalParent()&&o.isFilterAllowed(),r=this.beans.colModel.getCols().some(a);(0,m._setDisplayed)(t.getGui(),i),(0,m._setDisplayed)(this.eExpand,s&&r)}onSearchTextChanged(){this.onSearchTextChangedDebounced||(this.onSearchTextChangedDebounced=(0,m._debounce)(this,()=>this.dispatchLocalEvent({type:"searchChanged",searchText:this.eFilterTextField.getValue()}),300)),this.onSearchTextChangedDebounced()}onExpandClicked(){const e=this.currentExpandState===0?{type:"collapseAll"}:{type:"expandAll"};this.dispatchLocalEvent(e)}setExpandState(e){this.currentExpandState=e,(0,m._setDisplayed)(this.eExpandChecked,e===0),(0,m._setDisplayed)(this.eExpandUnchecked,e===1),(0,m._setDisplayed)(this.eExpandIndeterminate,e===2)}},r6={selector:"AG-FILTERS-TOOL-PANEL-HEADER",component:a6},o6={tag:"div",cls:"ag-filter-toolpanel-instance",children:[{tag:"div",ref:"eFilterToolPanelHeader",cls:"ag-filter-toolpanel-header ag-filter-toolpanel-instance-header",role:"button",attrs:{"aria-expanded":"false"},children:[{tag:"div",ref:"eExpand",cls:"ag-filter-toolpanel-expand"},{tag:"span",ref:"eFilterName",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilterIcon",cls:"ag-header-icon ag-filter-icon ag-filter-toolpanel-instance-header-icon",attrs:{"aria-hidden":"true"}}]},{tag:"div",ref:"agFilterToolPanelBody",cls:"ag-filter-toolpanel-instance-body ag-filter"}]},kL=class extends m.Component{constructor(e,t){super(o6),this.hideHeader=e,this.expandedCallback=t,this.eFilterToolPanelHeader=m.RefPlaceholder,this.eFilterName=m.RefPlaceholder,this.agFilterToolPanelBody=m.RefPlaceholder,this.eFilterIcon=m.RefPlaceholder,this.eExpand=m.RefPlaceholder,this.expanded=!1}postConstruct(){const{beans:e,eExpand:t}=this,i=(0,m._createIconNoSpan)("accordionOpen",e);this.eExpandChecked=i;const s=(0,m._createIconNoSpan)("accordionClosed",e);this.eExpandUnchecked=s,t.appendChild(i),t.appendChild(s)}setColumn(e){this.column=e;const{beans:t,eFilterToolPanelHeader:i,eFilterIcon:s,eExpandChecked:n,hideHeader:a}=this;this.eFilterName.innerText=t.colNames.getDisplayNameForColumn(e,"filterToolPanel",!1)||"",this.addManagedListeners(i,{click:this.toggleExpanded.bind(this),keydown:this.onKeyDown.bind(this)}),this.addManagedEventListeners({filterOpened:this.onFilterOpened.bind(this)}),this.addInIcon("filterActive",s,e),(0,m._setDisplayed)(s,this.isFilterActive(),{skipAriaHidden:!0}),(0,m._setDisplayed)(n,!1),a?((0,m._setDisplayed)(i,!1),i.removeAttribute("tabindex")):i.setAttribute("tabindex","0"),this.addManagedListeners(e,{filterChanged:this.onFilterChanged.bind(this)})}onKeyDown(e){const{key:t}=e,{ENTER:i,SPACE:s,LEFT:n,RIGHT:a}=m.KeyCode;t!==i&&t!==s&&t!==n&&t!==a||(e.preventDefault(),t===i||t===s?this.toggleExpanded():t===m.KeyCode.LEFT?this.collapse():this.expand())}getColumn(){return this.column}getColumnFilterName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"filterToolPanel",!1)}addCssClassToTitleBar(e){this.eFilterToolPanelHeader.classList.add(e)}addInIcon(e,t,i){if(t==null)return;const s=(0,m._createIconNoSpan)(e,this.beans,i);t.appendChild(s)}isFilterActive(){var e;return!!((e=this.beans.filterManager)!=null&&e.isFilterActive(this.column))}onFilterChanged(){(0,m._setDisplayed)(this.eFilterIcon,this.isFilterActive(),{skipAriaHidden:!0}),this.dispatchLocalEvent({type:"filterChanged"})}toggleExpanded(){this.expanded?this.collapse():this.expand()}expand(){this.expanded||(this.expanded=!0,(0,m._setAriaExpanded)(this.eFilterToolPanelHeader,!0),(0,m._setDisplayed)(this.eExpandChecked,!0),(0,m._setDisplayed)(this.eExpandUnchecked,!1),this.addFilterElement(),this.expandedCallback())}addFilterElement(e){var s;const t=(0,m._createElement)({tag:"div",cls:"ag-filter-toolpanel-instance-filter"}),i=this.createManagedBean(new m.FilterWrapperComp(this.column,"TOOLBAR"));this.filterWrapperComp=i,i.hasFilter()&&((s=i.getFilter())==null||s.then(n=>{this.underlyingFilter=n,n&&(t.appendChild(i.getGui()),this.agFilterToolPanelBody.appendChild(t),i.afterGuiAttached({container:"toolPanel",suppressFocus:e}))}))}collapse(){if(!this.expanded)return;this.expanded=!1,(0,m._setAriaExpanded)(this.eFilterToolPanelHeader,!1),this.removeFilterElement(),(0,m._setDisplayed)(this.eExpandChecked,!1),(0,m._setDisplayed)(this.eExpandUnchecked,!0);const e=this.filterWrapperComp;e==null||e.afterGuiDetached(),this.destroyBean(e),this.expandedCallback()}removeFilterElement(){(0,m._clearElement)(this.agFilterToolPanelBody)}isExpanded(){return this.expanded}refreshFilter(e){var i;if(!this.expanded)return;const t=this.underlyingFilter;t&&(e?typeof t.refreshVirtualList=="function"&&t.refreshVirtualList():(i=t.afterGuiDetached)==null||i.call(t))}onFilterOpened(e){e.source==="COLUMN_MENU"&&e.column===this.column&&this.expanded&&this.collapse()}},Sl=class xj extends m.Component{constructor(t,i,s,n,a){super(),this.columnGroup=t,this.childFilterComps=i,this.expandedCallback=s,this.depth=n,this.showingColumn=a,this.filterGroupComp=m.RefPlaceholder}postConstruct(){const t={cssIdentifier:"filter-toolpanel",direction:"vertical"};this.setTemplate({tag:"div",cls:"ag-filter-toolpanel-group-wrapper",children:[{tag:"ag-group-component",ref:"filterGroupComp"}]},[Nt],{filterGroupComp:t}),this.setGroupTitle();const{filterGroupComp:i,depth:s,childFilterComps:n,gos:a}=this;i.setAlignItems("stretch"),i.addCss(`ag-filter-toolpanel-group-level-${s}`),i.getGui().style.setProperty("--ag-indentation-level",String(s)),i.addCssClassToTitleBar(`ag-filter-toolpanel-group-level-${s}-header`),n.forEach(r=>{i.addItem(r),r.addCssClassToTitleBar(`ag-filter-toolpanel-group-level-${s+1}-header`),r.getGui().style.setProperty("--ag-indentation-level",String(s+1))}),this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui(),getLocation:()=>"filterToolPanelColumnGroup",shouldDisplayTooltip:(0,m._getShouldDisplayTooltip)(a,()=>i.getGui().querySelector(".ag-group-title"))})),this.refreshFilterClass(),this.addExpandCollapseListeners(),this.addFilterChangedListeners(),this.setupTooltip(),this.addInIcon("filterActive")}setupTooltip(){if(!this.showingColumn)return;const t=()=>{var i;(i=this.tooltipFeature)==null||i.setTooltipAndRefresh(this.columnGroup.getColDef().headerTooltip)};t(),this.addManagedEventListeners({newColumnsLoaded:t})}addCssClassToTitleBar(t){this.filterGroupComp.addCssClassToTitleBar(t)}refreshFilters(t){this.childFilterComps.forEach(i=>{i instanceof xj?i.refreshFilters(t):i.refreshFilter(t)})}isColumnGroup(){return(0,m.isProvidedColumnGroup)(this.columnGroup)}isExpanded(){return this.filterGroupComp.isExpanded()}getChildren(){return this.childFilterComps}getFilterGroupName(){var t;return(t=this.filterGroupName)!=null?t:""}getFilterGroupId(){return this.columnGroup.getId()}hideGroupItem(t,i){this.filterGroupComp.hideItem(t,i)}hideGroup(t){this.setDisplayed(!t)}addInIcon(t){const i=(0,m._createIconNoSpan)(t,this.beans);i&&i.classList.add("ag-filter-toolpanel-group-instance-header-icon"),this.filterGroupComp.addTitleBarWidget(i)}forEachToolPanelFilterChild(t){this.childFilterComps.forEach(i=>{i instanceof kL&&t(i)})}addExpandCollapseListeners(){const t=this.isColumnGroup()?()=>this.expandedCallback():()=>this.forEachToolPanelFilterChild(s=>s.expand()),i=this.isColumnGroup()?()=>this.expandedCallback():()=>this.forEachToolPanelFilterChild(s=>s.collapse());this.addManagedListeners(this.filterGroupComp,{expanded:t,collapsed:i})}getColumns(){return(0,m.isProvidedColumnGroup)(this.columnGroup)?this.columnGroup.getLeafColumns():[this.columnGroup]}addFilterChangedListeners(){this.getColumns().forEach(t=>{this.addManagedListeners(t,{filterChanged:()=>this.refreshFilterClass()})}),(0,m.isProvidedColumnGroup)(this.columnGroup)||this.addManagedEventListeners({filterOpened:this.onFilterOpened.bind(this)})}refreshFilterClass(){const t=this.getColumns(),i=()=>t.some(s=>s.isFilterActive());this.filterGroupComp.toggleCss("ag-has-filter",i())}onFilterOpened(t){t.source==="COLUMN_MENU"&&t.column===this.columnGroup&&this.isExpanded()&&this.collapse()}expand(){this.filterGroupComp.toggleGroupExpand(!0)}collapse(){this.filterGroupComp.toggleGroupExpand(!1)}setGroupTitle(){const t=this.columnGroup,i=(0,m.isProvidedColumnGroup)(t)?this.getColumnGroupName(t):this.getColumnName(t);this.filterGroupName=i,this.filterGroupComp.setTitle(i||"")}getColumnGroupName(t){return this.beans.colNames.getDisplayNameForProvidedColumnGroup(null,t,"filterToolPanel")}getColumnName(t){return this.beans.colNames.getDisplayNameForColumn(t,"filterToolPanel",!1)}destroyFilters(){this.childFilterComps=this.destroyBeans(this.childFilterComps),(0,m._clearElement)(this.getGui())}destroy(){this.destroyFilters(),super.destroy()}},l6=class extends m.Component{constructor(){super({tag:"div",cls:"ag-filter-list-panel"}),this.initialised=!1,this.hasLoadedInitialState=!1,this.isInitialState=!1,this.filterGroupComps=[],this.suppressOnColumnsChanged=!1,this.onColumnsChangedPending=!1}wireBeans(e){this.colModel=e.colModel}init(e){this.initialised=!0;const t=(0,m._addGridCommonParams)(this.gos,{suppressExpandAll:!1,suppressFilterSearch:!1,suppressSyncLayoutWithGrid:!1});(0,m._mergeDeep)(t,e),this.params=t,t.suppressSyncLayoutWithGrid||this.addManagedEventListeners({columnMoved:()=>this.onColumnsChanged()}),this.addManagedEventListeners({newColumnsLoaded:()=>this.onColumnsChanged(),toolPanelVisibleChanged:i=>{i.key==="filters"&&this.refreshFilters(i.visible)},dragStarted:()=>{this.suppressOnColumnsChanged=!0},dragStopped:()=>{this.suppressOnColumnsChanged=!1,this.onColumnsChangedPending&&(this.onColumnsChangedPending=!1,this.onColumnsChanged())}}),this.colModel.ready&&this.onColumnsChanged()}onColumnsChanged(){if(this.suppressOnColumnsChanged){this.onColumnsChangedPending=!0;return}const e=this.colModel.isPivotMode();!this.params.suppressSyncLayoutWithGrid&&!e?this.syncFilterLayout():this.buildTreeFromProvidedColumnDefs(),this.refreshAriaLabel()}syncFilterLayout(){Pk(this.colModel,this.setFiltersLayout.bind(this)),this.refreshAriaLabel()}buildTreeFromProvidedColumnDefs(){const e=this.colModel.getColDefColTree();this.recreateFilters(e)}setFiltersLayout(e){const t=Lk(this.colModel,e);this.recreateFilters(t)}recreateFilters(e){const t=(0,m._getActiveDomElement)(this.beans);this.hasLoadedInitialState||(this.hasLoadedInitialState=!0,this.isInitialState=!!this.params.initialState);const i=this.getExpansionState();this.destroyFilters();const s=this.recursivelyAddComps(e,0,i);this.filterGroupComps=s;const n=s.length;n&&(s.forEach(r=>this.appendChild(r)),this.setFirstAndLastVisible(0,n-1));const a=this.searchFilterText;(0,m._exists)(a)&&this.searchFilters(a),this.fireExpandedEvent(),this.getGui().contains(t)&&t.focus(),this.isInitialState=!1,this.refreshAriaLabel()}recursivelyAddComps(e,t,i){return e.map(s=>{var l,c;if((0,m.isProvidedColumnGroup)(s))return(c=(l=this.recursivelyAddFilterGroupComps(s,t,i))==null?void 0:l.flatMap(h=>h))!=null?c:[];const n=s;if(!this.shouldDisplayFilter(n))return[];const a=t===0,r=new kL(a,()=>this.onFilterExpanded());if(this.createBean(r),r.setColumn(n),i.get(n.getId())&&r.expand(),t>0)return r;const o=this.createBean(new Sl(n,[r],this.onGroupExpanded.bind(this),t,!0));return o.addCssClassToTitleBar("ag-filter-toolpanel-header"),i.get(o.getFilterGroupId())||o.collapse(),o}).flatMap(s=>s)}refreshAriaLabel(){const e=this.getLocaleTextFunc(),t=e("ariaFilterPanelList","Filter List"),i=e("filters","Filters"),l=this.getGui().querySelectorAll(".ag-filter-toolpanel-group-item:not(.ag-filter-toolpanel-group-wrapper, .ag-hidden)").length;(0,m._setAriaLabel)(this.getAriaElement(),`${t} ${l} ${i}`)}recursivelyAddFilterGroupComps(e,t,i){if(!this.filtersExistInChildren(e.getChildren()))return;const s=e.getColGroupDef();if(s&&s.suppressFiltersToolPanel)return[];const n=e.isPadding()?t:t+1,a=this.recursivelyAddComps(e.getChildren(),n,i).flatMap(l=>l);if(e.isPadding())return a;const r=new Sl(e,a,this.onGroupExpanded.bind(this),t,!1);this.createBean(r),r.addCssClassToTitleBar("ag-filter-toolpanel-header");const o=i.get(r.getFilterGroupId());return(this.isInitialState&&!o||o===!1)&&r.collapse(),[r]}filtersExistInChildren(e){return e.some(t=>(0,m.isProvidedColumnGroup)(t)?this.filtersExistInChildren(t.getChildren()):this.shouldDisplayFilter(t))}shouldDisplayFilter(e){const t=e.getColDef()&&e.getColDef().suppressFiltersToolPanel;return e.isFilterAllowed()&&!t}getExpansionState(){const e=new Map;if(this.isInitialState){const{expandedColIds:i,expandedGroupIds:s}=this.params.initialState;return i.forEach(n=>e.set(n,!0)),s.forEach(n=>e.set(n,!0)),e}const t=i=>{e.set(i.getFilterGroupId(),i.isExpanded()),i.getChildren().forEach(s=>{s instanceof Sl?t(s):e.set(s.getColumn().getId(),s.isExpanded())})};return this.filterGroupComps.forEach(t),e}refresh(){}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}expandFilterGroups(e,t){const i=[],s=n=>{const a=n.getFilterGroupId();(!t||t.includes(a))&&(e&&n.isColumnGroup()?n.expand():n.collapse(),i.push(a)),n.getChildren().forEach(o=>{o instanceof Sl&&s(o)})};if(this.filterGroupComps.forEach(s),this.onGroupExpanded(),t){const n=t.filter(a=>i.indexOf(a)<0);n.length>0&&(0,m._warn)(166,{unrecognisedGroupIds:n})}}expandFilters(e,t){const i=[],s=n=>{if(n instanceof Sl){let o=!1;return n.getChildren().forEach(l=>{s(l)&&(e?(n.expand(),o=!0):n.isColumnGroup()||n.collapse())}),o}const a=n.getColumn().getColId(),r=!t||t.includes(a);return r&&(e?n.expand():n.collapse(),i.push(a)),r};if(this.filterGroupComps.forEach(s),this.onGroupExpanded(),t){const n=t.filter(a=>i.indexOf(a)<0);n.length>0&&(0,m._warn)(167,{unrecognisedColIds:n})}}onGroupExpanded(){this.fireExpandedEvent()}onFilterExpanded(){this.dispatchLocalEvent({type:"filterExpanded"})}fireExpandedEvent(){let e=0,t=0;const i=n=>{n.isColumnGroup()&&(n.isExpanded()?e++:t++,n.getChildren().forEach(a=>{a instanceof Sl&&i(a)}))};this.filterGroupComps.forEach(i);let s;e>0&&t>0?s=2:t>0?s=1:s=0,this.dispatchLocalEvent({type:"groupExpanded",state:s})}performFilterSearch(e){this.searchFilterText=(0,m._exists)(e)?e.toLowerCase():null,this.searchFilters(this.searchFilterText)}searchFilters(e){const t=a=>!(0,m._exists)(e)||a.toLowerCase().indexOf(e)!==-1,i=(a,r)=>{if(!(a instanceof Sl))return t(a.getColumnFilterName()||"");const o=a.getChildren(),l=t(a.getFilterGroupName()),c=r||l;if(c){a.hideGroup(!1);for(let d=0;d<o.length;d++)i(o[d],c),a.hideGroupItem(!1,d);return!0}let h=!1;return o.forEach((d,u)=>{const p=i(d,r);a.hideGroupItem(!p,u),p&&(h=!0)}),a.hideGroup(!h),h};let s,n;this.filterGroupComps.forEach((a,r)=>{var l;i(a,!1);const o=(l=a.getGui())==null?void 0:l.classList.contains("ag-hidden");s===void 0?o||(s=r,n=r):!o&&n!==r&&(n=r)}),this.setFirstAndLastVisible(s,n),this.refreshAriaLabel()}setFirstAndLastVisible(e,t){this.filterGroupComps.forEach((i,s)=>{i.removeCss("ag-first-group-visible"),i.removeCss("ag-last-group-visible"),s===e&&i.addCss("ag-first-group-visible"),s===t&&i.addCss("ag-last-group-visible")})}refreshFilters(e){this.filterGroupComps.forEach(t=>t.refreshFilters(e))}getExpandedFiltersAndGroups(){const e=[],t=new Set,i=s=>{if(s instanceof Sl){s.getChildren().forEach(a=>i(a));const n=s.getFilterGroupId();s.isExpanded()&&!t.has(n)&&e.push(n)}else s.isExpanded()&&t.add(s.getColumn().getColId())};return this.filterGroupComps.forEach(i),{expandedGroupIds:e,expandedColIds:Array.from(t)}}destroyFilters(){this.filterGroupComps=this.destroyBeans(this.filterGroupComps),(0,m._clearElement)(this.getGui())}destroy(){this.destroyFilters(),super.destroy()}},c6={selector:"AG-FILTERS-TOOL-PANEL-LIST",component:l6},h6=".ag-filter-toolpanel{flex:1 1 0px;min-width:0}.ag-filter-toolpanel-header,.ag-filter-toolpanel-search{align-items:center;color:var(--ag-header-text-color);display:flex;font-weight:var(--ag-header-font-weight);padding:0 var(--ag-spacing);>*{align-items:center;display:flex}}.ag-filter-toolpanel-header{padding-bottom:var(--ag-spacing);padding-top:var(--ag-spacing);position:relative;&:focus-visible{border-radius:var(--ag-border-radius);box-shadow:inset var(--ag-focus-shadow)}}:where(.ag-ltr) .ag-filter-toolpanel-group-instance-header-icon,:where(.ag-ltr) .ag-filter-toolpanel-instance-header-icon{margin-left:var(--ag-spacing)}:where(.ag-rtl) .ag-filter-toolpanel-group-instance-header-icon,:where(.ag-rtl) .ag-filter-toolpanel-instance-header-icon{margin-right:var(--ag-spacing)}.ag-filter-toolpanel-search{min-height:var(--ag-header-height);padding-bottom:var(--ag-spacing);padding-top:var(--ag-widget-container-vertical-padding)}:where(.ag-filter-toolpanel-group:not(.ag-has-filter)>.ag-group-title-bar) .ag-filter-toolpanel-group-instance-header-icon{display:none}.ag-filter-toolpanel-search-input{flex-grow:1;height:calc(var(--ag-spacing)*4)}:where(.ag-ltr) .ag-filter-toolpanel-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-filter-toolpanel-group-title-bar-icon{margin-left:var(--ag-spacing)}.ag-filter-toolpanel-expand{cursor:pointer}:where(.ag-ltr) .ag-filter-toolpanel-expand{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-filter-toolpanel-expand{margin-left:var(--ag-spacing)}:where(.ag-ltr) .ag-filter-toolpanel-group-title-bar,:where(.ag-ltr) .ag-filter-toolpanel-instance-header{padding-left:calc(var(--ag-spacing) + var(--ag-filter-tool-panel-group-indent)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-filter-toolpanel-group-title-bar,:where(.ag-rtl) .ag-filter-toolpanel-instance-header{padding-right:calc(var(--ag-spacing) + var(--ag-filter-tool-panel-group-indent)*var(--ag-indentation-level))}:where(.ag-ltr) .ag-filter-toolpanel-instance-body{margin-left:var(--ag-filter-tool-panel-group-indent)}:where(.ag-rtl) .ag-filter-toolpanel-instance-body{margin-right:var(--ag-filter-tool-panel-group-indent)}.ag-filter-toolpanel-instance-filter{background-color:var(--ag-chrome-background-color)}.ag-filter-toolpanel-group-level-0{border-top:none}",d6={tag:"div",cls:"ag-filter-toolpanel",children:[{tag:"ag-filters-tool-panel-header",ref:"filtersToolPanelHeaderPanel"},{tag:"ag-filters-tool-panel-list",ref:"filtersToolPanelListPanel"}]},u6=class extends m.Component{constructor(){super(d6,[r6,c6]),this.filtersToolPanelHeaderPanel=m.RefPlaceholder,this.filtersToolPanelListPanel=m.RefPlaceholder,this.initialised=!1,this.listenerDestroyFuncs=[],this.registerCSS(h6)}init(e){this.initialised&&(this.listenerDestroyFuncs.forEach(o=>o()),this.listenerDestroyFuncs=[]),this.initialised=!0;const t=(0,m._addGridCommonParams)(this.gos,{suppressExpandAll:!1,suppressFilterSearch:!1,suppressSyncLayoutWithGrid:!1}),i=b(b({},t),e);this.params=i;const{filtersToolPanelHeaderPanel:s,filtersToolPanelListPanel:n}=this;s.init(i),n.init(i);const a=i.suppressExpandAll,r=i.suppressFilterSearch;a&&r&&s.setDisplayed(!1),this.listenerDestroyFuncs.push(...this.addManagedListeners(s,{expandAll:()=>n.expandFilterGroups(!0),collapseAll:()=>n.expandFilterGroups(!1),searchChanged:o=>n.performFilterSearch(o.searchText)}),...this.addManagedListeners(n,{filterExpanded:i.onStateUpdated,groupExpanded:o=>{s.setExpandState(o.state),i.onStateUpdated()}}))}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}setFilterLayout(e){this.filtersToolPanelListPanel.setFiltersLayout(e)}expandFilterGroups(e){this.filtersToolPanelListPanel.expandFilterGroups(!0,e)}collapseFilterGroups(e){this.filtersToolPanelListPanel.expandFilterGroups(!1,e)}expandFilters(e){this.filtersToolPanelListPanel.expandFilters(!0,e)}collapseFilters(e){this.filtersToolPanelListPanel.expandFilters(!1,e)}syncLayoutWithGrid(){this.filtersToolPanelListPanel.syncFilterLayout()}refresh(e){return this.init(e),!0}getState(){return this.filtersToolPanelListPanel.getExpandedFiltersAndGroups()}},p6={moduleName:"FiltersToolPanel",version:Re,userComponents:{agFiltersToolPanel:u6},icons:{filtersToolPanel:"filter"},dependsOn:[fS,St,m._ColumnFilterModule]},LL=class extends m.BeanStub{constructor(){super(...arguments),this.loadRowDataVersion=0}wireBeans(e){this.environment=e.environment}init(e,t){this.params=t,this.comp=e,t.pinned==null&&(this.setAutoHeightClasses(),this.setupRefreshStrategy(),this.createDetailGrid(),this.loadRowData(),this.addManagedEventListeners({fullWidthRowFocused:this.onFullWidthRowFocused.bind(this)}))}onFullWidthRowFocused(e){const t=this.params,i={rowIndex:t.node.rowIndex,rowPinned:t.node.rowPinned},s={rowIndex:e.rowIndex,rowPinned:e.rowPinned};(0,m._isSameRow)(i,s)&&(0,m._focusInto)(this.comp.getGui(),e.fromBelow)}setAutoHeightClasses(){const e=this.gos.get("detailRowAutoHeight"),t=e?"ag-details-row-auto-height":"ag-details-row-fixed-height",i=e?"ag-details-grid-auto-height":"ag-details-grid-fixed-height",s=this.comp;s.toggleCss(t,!0),s.toggleDetailGridCss(i,!0)}setupRefreshStrategy(){const e=this.params.refreshStrategy;if(e=="everything"||e=="nothing"||e=="rows"){this.refreshStrategy=e;return}e!=null&&(0,m._warn)(170,{providedStrategy:e}),this.refreshStrategy="rows"}createDetailGrid(){const{params:e,gos:t}=this;if((0,m._missing)(e.detailGridOptions)){(0,m._warn)(171);return}const i=t.get("theme"),s=e.detailGridOptions.theme;s&&s!==i&&(0,m._warn)(267);const n=E(b({themeStyleContainer:this.environment.eStyleContainer},e.detailGridOptions),{theme:i});t.get("detailRowAutoHeight")&&(n.domLayout="autoHeight"),this.comp.setDetailGrid(n)}registerDetailWithMaster(e){const{params:t,beans:{selectionSvc:i,findSvc:s}}=this,n=t.node.id,a=t.api,r={id:n,api:e},o=t.node;if(a.isDestroyed())return;a.addDetailGridInfo(n,r),o.detailGridInfo=r;const l=o.parent;s==null||s.registerDetailGrid(o,e);function c(){l&&(i==null||i.refreshMasterNodeState(l))}function h({node:d,source:u}){d!==l||u==="masterDetail"||e.isDestroyed()||i==null||i.setDetailSelectionState(l,t.detailGridOptions,e)}e.addEventListener("firstDataRendered",()=>{e.isDestroyed()||a.isDestroyed()||(i==null||i.setDetailSelectionState(l,t.detailGridOptions,e),e.addEventListener("selectionChanged",c),a.addEventListener("rowSelected",h))}),this.addDestroyFunc(()=>{o.detailGridInfo===r&&(a.isDestroyed()||a.removeDetailGridInfo(n),o.detailGridInfo=null)})}loadRowData(){var a,r,o;this.loadRowDataVersion++;const e=this.loadRowDataVersion,t=this.params;if(((a=t.detailGridOptions)==null?void 0:a.rowModelType)==="serverSide"){(o=(r=t.node.detailGridInfo)==null?void 0:r.api)==null||o.refreshServerSide({purge:!0});return}const i=t.getDetailRowData;if(!i){(0,m._warn)(172);return}const s=l=>{this.loadRowDataVersion===e&&this.comp.setRowData(l)},n={node:t.node,data:t.node.data,successCallback:s,context:(0,m._addGridCommonParams)(this.gos,{}).context};i(n)}refresh(){switch(this.refreshStrategy){case"nothing":return!0;case"everything":return!1}return this.loadRowData(),!0}},g6=class{constructor(e){this.parentWrapper=e}wrap(e,t,i,s){return this.parentWrapper.wrap(e,t,i,s)}},f6={tag:"div",cls:"ag-details-row"},m6={tag:"div",cls:"ag-details-row",role:"gridcell",children:[{tag:"div",ref:"eDetailGrid",cls:"ag-details-grid",role:"presentation"}]},y6=class extends m.Component{constructor(){super(...arguments),this.eDetailGrid=m.RefPlaceholder}wireBeans(e){this.context=e.context}init(e){this.params=e,this.selectAndSetTemplate();const t={toggleCss:(i,s)=>this.toggleCss(i,s),toggleDetailGridCss:(i,s)=>this.eDetailGrid.classList.toggle(i,s),setDetailGrid:i=>this.setDetailGrid(i),setRowData:i=>this.setRowData(i),getGui:()=>this.eDetailGrid};this.ctrl=this.createManagedBean(new LL),this.ctrl.init(t,e)}refresh(){var e,t;return(t=(e=this.ctrl)==null?void 0:e.refresh())!=null?t:!1}selectAndSetTemplate(){const e=this.params;if(e.pinned){this.setTemplate(f6);return}const t=()=>{this.setTemplate(m6)};if((0,m._missing)(e.template))t();else if(typeof e.template=="string")this.setTemplate(e.template,[]);else if(typeof e.template=="function"){const i=e.template,s=i(e);this.setTemplate(s,[])}else(0,m._warn)(168),t();this.eDetailGrid==null&&(0,m._warn)(169)}setDetailGrid(e){var a,r;if(!this.eDetailGrid)return;const t=this.context.getBean("frameworkCompWrapper"),i=new g6(t),{frameworkOverrides:s}=this.beans,n=(0,m.createGrid)(this.eDetailGrid,e,{frameworkOverrides:s,providedBeanInstances:{frameworkCompWrapper:i},modules:(0,m._getGridRegisteredModules)(this.params.api.getGridId(),(a=e.rowModelType)!=null?a:"clientSide")});this.detailApi=n,(r=this.ctrl)==null||r.registerDetailWithMaster(n),this.addDestroyFunc(()=>{n.destroy()})}setRowData(e){var t;(t=this.detailApi)==null||t.setGridOption("rowData",e)}};function Wm(e,t){var s;const i=(s=e.masterDetailSvc)==null?void 0:s.store;return i?t(i):void 0}function v6(e,t,i){Wm(e,s=>{s[t]=i})}function b6(e,t){Wm(e,i=>{delete i[t]})}function x6(e,t){return Wm(e,i=>i[t])}function C6(e,t){Wm(e,i=>{let s=0;Object.values(i).forEach(n=>{n&&t(n,s++)})})}var S6=".ag-details-row{width:100%}.ag-details-row-fixed-height{height:100%}.ag-details-grid{width:100%}.ag-details-grid-fixed-height{height:100%}",M6=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="masterDetailSvc",this.store={}}isEnabled(){const e=this.gos;return e.get("masterDetail")&&!e.get("treeData")}postConstruct(){(0,m._isClientSideRowModel)(this.gos)&&(this.enabled=this.isEnabled(),this.addManagedEventListeners({beforeRefreshModel:this.beforeRefreshModel.bind(this)}))}beforeRefreshModel({params:e}){if(e.changedProps){const t=this.isEnabled();if(this.enabled!==t){this.setMasters(null);return}}e.rowDataUpdated&&this.setMasters(e.changedRowNodes)}setMasters(e){var r,o;const t=this.isEnabled();this.enabled=t;const i=this.gos,s=i.get("isRowMaster"),n=i.get("groupDefaultExpanded"),a=(l,c,h)=>{var p,g;const d=l.master;let u=t;if(t)if(c||h){if(s){const f=l.data;u=!!f&&!!s(f)}}else u=d;if(u&&c)if(n===-1)l.expanded=!0;else{const f=(g=(p=this.beans.rowGroupColsSvc)==null?void 0:p.columns.length)!=null?g:0;l.expanded=f<n}else!u&&d&&(l.expanded=!1);u!==d&&(l.master=u,l.dispatchRowEvent("masterChanged"))};if(e){for(const l of e.updates)a(l,!1,!0);for(const l of e.adds)a(l,!0,!1)}else{const l=(o=(r=(0,m._getClientSideRowModel)(this.beans))==null?void 0:r.rootNode)==null?void 0:o.allLeafChildren;if(l)for(let c=0,h=l.length;c<h;++c)a(l[c],!0,!1)}}getDetail(e){if(!e.master||!e.expanded)return null;let t=e.detailNode;return t||(t=new m.RowNode(this.beans),t.detail=!0,t.selectable=!1,t.parent=e,(0,m._exists)(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t)}setupDetailRowAutoHeight(e,t){const{gos:i,beans:s}=this;if(!i.get("detailRowAutoHeight"))return;const n=()=>{const r=t.clientHeight;if(r!=null&&r>0){const o=()=>{const{rowModel:l}=this.beans,{rowNode:c}=e;c.setRowHeight(r),((0,m._isClientSideRowModel)(i,l)||(0,m._isServerSideRowModel)(i,l))&&l.onRowHeightChanged()};window.setTimeout(o,0)}},a=(0,m._observeResize)(s,t,n);e.addDestroyFunc(a),n()}destroy(){this.store={},super.destroy()}},D6={moduleName:"SharedMasterDetail",version:Re,beans:[M6],userComponents:{agDetailCellRenderer:y6},dynamicBeans:{detailCellRendererCtrl:LL},apiFunctions:{addDetailGridInfo:v6,removeDetailGridInfo:b6,getDetailGridInfo:x6,forEachDetailGridInfo:C6},dependsOn:[St,CL,DS],css:[S6]},w6={moduleName:"MasterDetail",version:Re,dependsOn:[D6,Hm,m.EventApiModule]},PL=class extends m.Component{constructor(){super(...arguments),this.changedCalculatedValues=!1,this.dragging=!1,this.shouldDestroyOnEndDragging=!1}postConstruct(){const{dragSvc:e,rangeSvc:t}=this.beans;e.addDragSource({dragStartPixels:0,eElement:this.getGui(),onDragStart:this.onDragStart.bind(this),onDragging:i=>{this.dragging=!0,t.autoScrollService.check(i),this.changedCalculatedValues&&(this.onDrag(i),this.changedCalculatedValues=!1)},onDragStop:i=>{this.dragging=!1,this.onDragEnd(i),this.clearDragProperties(),this.shouldDestroyOnEndDragging&&this.destroy()},onDragCancel:()=>{this.dragging=!1,this.onDragCancel(),this.clearDragProperties()}}),this.addManagedElementListeners(this.getGui(),{mousedown:this.preventRangeExtension.bind(this)})}getLastCellHovered(){return this.lastCellHovered}preventRangeExtension(e){e.stopPropagation()}onDragStart(e){[this.cellHoverListener]=this.addManagedElementListeners(this.beans.ctrlsSvc.get("gridCtrl").getGui(),{mousemove:this.updateValuesOnMove.bind(this)}),document.body.classList.add(this.getDraggingCssClass())}getDraggingCssClass(){return`ag-dragging-${this.type===0?"fill":"range"}-handle`}updateValuesOnMove(e){const t=(0,m._getCellPositionForEvent)(this.gos,e);!t||this.shouldSkipCell(t)||this.lastCellHovered&&(0,m._areCellsEqual)(t,this.lastCellHovered)||(this.lastCellHovered=t,this.changedCalculatedValues=!0)}clearDragProperties(){this.clearValues(),this.beans.rangeSvc.autoScrollService.ensureCleared(),document.body.classList.remove(this.getDraggingCssClass())}getType(){return this.type}refresh(e){const t=this.cellCtrl,i=this.getGui(),s=(0,m._last)(this.beans.rangeSvc.getCellRanges()),n=s.startRow,a=s.endRow;if(n&&a&&((0,m._isRowBefore)(a,n)?(this.rangeStartRow=a,this.rangeEndRow=n):(this.rangeStartRow=n,this.rangeEndRow=a)),t!==e||!(0,m._isVisible)(i)){this.cellCtrl=e;const r=e.comp.getParentOfValue();r&&r.appendChild(i)}this.cellRange=s}clearValues(){this.lastCellHovered=void 0,this.removeListeners()}removeListeners(){const e=this.cellHoverListener;e&&(e(),this.cellHoverListener=void 0)}destroy(){var t;if(!this.shouldDestroyOnEndDragging&&this.dragging){(0,m._setDisplayed)(this.getGui(),!1),this.shouldDestroyOnEndDragging=!0;return}this.shouldDestroyOnEndDragging=!1,super.destroy(),this.removeListeners();const e=this.getGui();(t=e.parentElement)==null||t.removeChild(e)}};function A6(e){const t=e.length;let i=0;if(t<=1)return e;for(let d=0;d<e.length;d++){const u=e[d],p=u.toString().split("e-");if(p.length>1){i=Math.max(i,parseInt(p[1],10));continue}Math.floor(u)!==u&&(i=Math.max(i,u.toString().split(".")[1].length))}let s=0,n=0,a=0,r=0,o=0;for(let d=0;d<t;d++)o=e[d],s+=d,n+=o,r+=d*d,a+=d*o;const l=(t*a-s*n)/(t*r-s*s),c=n/t-l*s/t,h=[];for(let d=0;d<=t;d++)h.push(parseFloat((d*l+c).toFixed(i)));return h}var I6={tag:"div",cls:"ag-fill-handle"},T6=class extends PL{constructor(){super(I6),this.markedCells=[],this.cellValues=[],this.isUp=!1,this.isLeft=!1,this.isReduce=!1,this.type=0}updateValuesOnMove(e){super.updateValuesOnMove(e),this.initialXY||(this.initialXY=(0,m._getNormalisedMousePosition)(this.beans,e));const{x:t,y:i}=this.initialXY,{x:s,y:n}=(0,m._getNormalisedMousePosition)(this.beans,e),a=Math.abs(t-s),r=Math.abs(i-n),o=this.getFillHandleDirection();let l;o==="xy"?l=a>r?"x":"y":l=o,l!==this.dragAxis&&(this.dragAxis=l,this.changedCalculatedValues=!0)}shouldSkipCell(e){return(0,m.isRowNumberCol)(e.column)}onDrag(e){if(!this.initialPosition){const i=this.cellCtrl;if(!i)return;this.initialPosition=i.cellPosition}const t=this.getLastCellHovered();t&&this.markPathFrom(this.initialPosition,t)}onDragEnd(e){if(this.initialXY=null,!this.markedCells.length)return;const t=this.dragAxis==="x",{cellRange:i,rangeStartRow:s,rangeEndRow:n,beans:a}=this,r=i.columns.length;let o;const{rangeSvc:l,eventSvc:c}=a;if(!this.isUp&&!this.isLeft)o=l.createCellRangeFromCellRangeParams({rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,columnStart:i.columns[0],rowEndIndex:t?n.rowIndex:this.lastCellMarked.rowIndex,rowEndPinned:t?n.rowPinned:this.lastCellMarked.rowPinned,columnEnd:t?this.lastCellMarked.column:i.columns[r-1]});else{const h=t?s:this.lastCellMarked;o=l.createCellRangeFromCellRangeParams({rowStartIndex:h.rowIndex,rowStartPinned:h.rowPinned,columnStart:t?this.lastCellMarked.column:i.columns[0],rowEndIndex:n.rowIndex,rowEndPinned:n.rowPinned,columnEnd:i.columns[r-1]})}o&&(c.dispatchEvent({type:"fillStart"}),this.handleValueChanged(i,o,e),l.setCellRanges([o]),c.dispatchEvent({type:"fillEnd",initialRange:i,finalRange:o}))}onDragCancel(){this.initialXY=null,this.markedCells.length&&this.clearMarkedPath()}getFillHandleDirection(){var t;const e=(t=(0,m._getFillHandle)(this.gos))==null?void 0:t.direction;return e?e!=="x"&&e!=="y"&&e!=="xy"?((0,m._warn)(177),"xy"):e:"xy"}handleValueChanged(e,t,i){var D;const{beans:s}=this,{rangeSvc:n,gos:a,valueSvc:r}=s,o=n.getRangeEndRow(e),l=n.getRangeStartRow(e),c=n.getRangeEndRow(t),h=n.getRangeStartRow(t),d=this.dragAxis==="y";if(this.isReduce&&!((D=(0,m._getFillHandle)(a))!=null&&D.suppressClearOnFillReduction)){const A=d?e.columns:e.columns.filter(T=>t.columns.indexOf(T)<0),w=d?(0,m._getRowBelow)(s,c):h;w&&this.clearCellsInRange(w,o,A);return}const u=[],p=[],g=[],f=[];let y=!0,v=0;const x=()=>{u.length=0,p.length=0,g.length=0,f.length=0,v=0},S=(A,w)=>{let T=this.isUp?o:l,k=!1;for(d&&(y=!0,x());!k&&T;){const N=(0,m._getRowNode)(s,T);if(!N)break;d&&A?M(u,A,N,()=>!(0,m._isSameRow)(T,this.isUp?l:o)):w&&(y=!0,x(),w.forEach(O=>M(u,O,N,()=>O!==(this.isLeft?e.columns[0]:(0,m._last)(e.columns))))),k=(0,m._isSameRow)(T,this.isUp?h:c),T=this.isUp?(0,m._getRowAbove)(this.beans,T):(0,m._getRowBelow)(s,T)}},M=(A,w,T,k)=>{let N,O=!1;if(y)N=r.getValue(w,T),p.push(N),g.push(r.getValue(w,T,!0)),f.push(r.formatValue(w,T,N)),y=k();else{const{value:L,fromUserFunction:F,sourceCol:B,sourceRowNode:_}=this.processValues({event:i,values:A,initialValues:p,initialNonAggregatedValues:g,initialFormattedValues:f,col:w,rowNode:T,idx:v++});if(N=L,w.isCellEditable(T)){const G=r.getValue(w,T);if(!F){if(B){const V=B.getColDef();if(V.useValueFormatterForExport!==!1&&V.valueFormatter){const j=r.formatValue(B,_,N);j!=null&&(N=j)}}w.getColDef().useValueParserForImport!==!1&&(N=r.parseValue(w,T,B?N:(0,m._toStringOrNull)(N),G))}!F||G!==N?T.setDataValue(w,N,"rangeSvc"):O=!0}}O||A.push({value:N,column:w,rowNode:T})};if(d)e.columns.forEach(A=>{S(A)});else{const A=this.isLeft?[...t.columns].reverse():t.columns;S(void 0,A)}}clearCellsInRange(e,t,i){const s={startRow:e,endRow:t,columns:i,startColumn:i[0]};this.beans.rangeSvc.clearCellRangeCellValues({cellRanges:[s]})}processValues(e){var p;const{event:t,values:i,initialValues:s,initialNonAggregatedValues:n,initialFormattedValues:a,col:r,rowNode:o,idx:l}=e,c=(p=(0,m._getFillHandle)(this.gos))==null?void 0:p.setFillValue,h=this.dragAxis==="y";let d;if(h?d=this.isUp?"up":"down":d=this.isLeft?"left":"right",c){const g=(0,m._addGridCommonParams)(this.gos,{event:t,values:i.map(({value:y})=>y),initialValues:s,initialNonAggregatedValues:n,initialFormattedValues:a,currentIndex:l,currentCellValue:this.beans.valueSvc.getValue(r,o),direction:d,column:r,rowNode:o}),f=c(g);if(f!==!1)return{value:f,fromUserFunction:!0}}const u=!i.some(({value:g})=>{const f=parseFloat(g);return isNaN(f)||f.toString()!==g.toString()});if(t.altKey||!u){if(u&&s.length===1){const v=this.isUp||this.isLeft?-1:1;return{value:parseFloat((0,m._last)(i).value)+1*v,fromUserFunction:!1}}const{value:g,column:f,rowNode:y}=i[l%i.length];return{value:g,fromUserFunction:!1,sourceCol:f,sourceRowNode:y}}return{value:(0,m._last)(A6(i.map(({value:g})=>Number(g)))),fromUserFunction:!1}}clearValues(){this.clearMarkedPath(),this.clearCellValues(),this.lastCellMarked=void 0,super.clearValues()}clearMarkedPath(){this.markedCells.forEach(e=>{if(!e.isAlive())return;const{comp:t}=e;t.toggleCss("ag-selection-fill-top",!1),t.toggleCss("ag-selection-fill-right",!1),t.toggleCss("ag-selection-fill-bottom",!1),t.toggleCss("ag-selection-fill-left",!1)}),this.markedCells.length=0,this.isUp=!1,this.isLeft=!1,this.isReduce=!1}clearCellValues(){this.cellValues.length=0}markPathFrom(e,t){if(this.clearMarkedPath(),this.clearCellValues(),this.dragAxis==="y"){if((0,m._isSameRow)(t,e))return;const i=(0,m._isRowBefore)(t,e),{rangeStartRow:s,rangeEndRow:n}=this;i&&(t.rowPinned==s.rowPinned&&t.rowIndex>=s.rowIndex||s.rowPinned!=n.rowPinned&&t.rowPinned==n.rowPinned&&t.rowIndex<=n.rowIndex)?(this.reduceVertical(e,t),this.isReduce=!0):(this.extendVertical(e,t,i),this.isReduce=!1)}else{const i=e.column,s=t.column;if(i===s)return;const n=this.beans.visibleCols.allCols,a=n.indexOf(i),r=n.indexOf(s);r<=a&&r>=n.indexOf(this.cellRange.columns[0])?(this.reduceHorizontal(e,t),this.isReduce=!0):(this.extendHorizontal(e,t,r<a),this.isReduce=!1)}this.lastCellMarked=t}extendVertical(e,t,i){const s=this.beans,{rangeSvc:n}=s;let a=e;do{const r=this.cellRange,o=r.columns.length;for(let l=0;l<o;l++){const c=r.columns[l],h={rowIndex:a.rowIndex,rowPinned:a.rowPinned},d=E(b({},h),{column:c}),u=n.isCellInSpecificRange(d,r),p=(0,m._isSameRow)(a,e);if(i&&(this.isUp=!0),!p){const g=(0,m._getCellByPosition)(s,d);if(g){this.markedCells.push(g);const f=g.comp;u||(f.toggleCss("ag-selection-fill-left",l===0),f.toggleCss("ag-selection-fill-right",l===o-1)),f.toggleCss(i?"ag-selection-fill-top":"ag-selection-fill-bottom",(0,m._isSameRow)(a,t))}}}if((0,m._isSameRow)(a,t))break}while(a=i?(0,m._getRowAbove)(this.beans,a):(0,m._getRowBelow)(s,a))}reduceVertical(e,t){let i=e;const s=this.beans;do{const n=this.cellRange,a=n.columns.length,r=(0,m._isSameRow)(i,t);for(let o=0;o<a;o++){const l={rowIndex:i.rowIndex,rowPinned:i.rowPinned},c=E(b({},l),{column:n.columns[o]}),h=(0,m._getCellByPosition)(s,c);h&&(this.markedCells.push(h),h.comp.toggleCss("ag-selection-fill-bottom",(0,m._isSameRow)(i,t)))}if(r)break}while(i=(0,m._getRowAbove)(s,i))}extendHorizontal(e,t,i){const s=this.beans,{visibleCols:n}=s,a=n.allCols,r=a.indexOf(i?t.column:e.column),o=a.indexOf(i?this.cellRange.columns[0]:t.column),l=i?0:1,c=a.slice(r+l,o+l),{rangeStartRow:h,rangeEndRow:d}=this;c.forEach(u=>{let p=h,g=!1;do{g=(0,m._isSameRow)(p,d);const f=(0,m._getCellByPosition)(s,{rowIndex:p.rowIndex,rowPinned:p.rowPinned,column:u});if(f){this.markedCells.push(f);const y=f.comp;y.toggleCss("ag-selection-fill-top",(0,m._isSameRow)(p,h)),y.toggleCss("ag-selection-fill-bottom",(0,m._isSameRow)(p,d)),i?(this.isLeft=!0,y.toggleCss("ag-selection-fill-left",u===c[0])):y.toggleCss("ag-selection-fill-right",u===(0,m._last)(c))}p=(0,m._getRowBelow)(s,p)}while(!g)})}reduceHorizontal(e,t){const i=this.beans,{visibleCols:s}=i,n=s.allCols,a=n.indexOf(t.column),r=n.indexOf(e.column),o=n.slice(a,r),{rangeStartRow:l,rangeEndRow:c}=this;o.forEach(h=>{let d=l,u=!1;do{u=(0,m._isSameRow)(d,c);const p=(0,m._getCellByPosition)(this.beans,{rowIndex:d.rowIndex,rowPinned:d.rowPinned,column:h});p&&(this.markedCells.push(p),p.comp.toggleCss("ag-selection-fill-right",h===o[0])),d=(0,m._getRowBelow)(i,d)}while(!u)})}refresh(e){const t=this.beans.rangeSvc.getCellRanges()[0];if(!t.startRow||!t.endRow){this.destroy();return}super.refresh(e)}},k6=class extends PL{constructor(){super({tag:"div",cls:"ag-range-handle"}),this.type=1,this.rangeFixed=!1}onDrag(e){const t=this.getLastCellHovered();if(!t)return;const i=this.beans.rangeSvc,s=i.getCellRanges(),n=(0,m._last)(s);this.rangeFixed||(this.fixRangeStartEnd(n),this.rangeFixed=!0),this.endPosition={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column},s.length===2&&s[0].type===m.CellRangeType.DIMENSION&&n.type===m.CellRangeType.VALUE&&!(0,m._isSameRow)(this.endPosition,i.getRangeEndRow(n))&&i.updateRangeEnd(s[0],E(b({},this.endPosition),{column:s[0].columns[0]}),!0),i.extendLatestRangeToCell(this.endPosition)}shouldSkipCell(e){return!1}onDragEnd(e){const t=(0,m._last)(this.beans.rangeSvc.getCellRanges());this.fixRangeStartEnd(t),this.rangeFixed=!1}onDragCancel(){this.rangeFixed=!1}fixRangeStartEnd(e){const t=this.beans.rangeSvc,i=t.getRangeStartRow(e),s=t.getRangeEndRow(e),n=e.columns[0];e.startRow=i,e.endRow=s,e.startColumn=n}},L6=".ag-body-viewport:not(.ag-has-focus) .ag-cell-range-single-cell:not(.ag-cell-inline-editing),.ag-cell-range-selected.ag-cell-range-chart,.ag-cell-range-selected:not(.ag-cell-focus){background-color:var(--ag-range-selection-background-color);&.ag-cell-range-chart{background-color:var(--ag-range-selection-chart-background-color)!important;&.ag-cell-range-chart-category{background-color:var(--ag-range-selection-chart-category-background-color)!important}}}.ag-cell-range-selected-1.ag-cell-range-chart,.ag-cell-range-selected-1:not(.ag-cell-focus),.ag-root:not(.ag-context-menu-open) .ag-body-viewport:not(.ag-has-focus) .ag-cell-range-selected-1:not(.ag-cell-inline-editing){background-color:var(--ag-range-selection-background-color)}.ag-cell-range-selected-2.ag-cell-range-chart,.ag-cell-range-selected-2:not(.ag-cell-focus){background-image:linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color))}.ag-cell-range-selected-3.ag-cell-range-chart,.ag-cell-range-selected-3:not(.ag-cell-focus){background-image:linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color)),linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color))}.ag-cell-range-selected-4.ag-cell-range-chart,.ag-cell-range-selected-4:not(.ag-cell-focus){background-image:linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color)),linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color)),linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color))}.ag-cell.ag-cell-range-selected:not(.ag-cell-range-single-cell){&.ag-cell-range-top{border-top-color:var(--ag-range-selection-border-color);border-top-style:var(--ag-range-selection-border-style)}&.ag-cell-range-right{border-right-color:var(--ag-range-selection-border-color);border-right-style:var(--ag-range-selection-border-style)}&.ag-cell-range-bottom{border-bottom-color:var(--ag-range-selection-border-color);border-bottom-style:var(--ag-range-selection-border-style)}&.ag-cell-range-left{border-left-color:var(--ag-range-selection-border-color);border-left-style:var(--ag-range-selection-border-style)}}.ag-cell.ag-selection-fill-top,.ag-cell.ag-selection-fill-top.ag-cell-range-selected{border-top:1px dashed;border-top-color:var(--ag-range-selection-border-color)}:where(.ag-ltr) .ag-cell.ag-selection-fill-right,:where(.ag-ltr) .ag-cell.ag-selection-fill-right.ag-cell-range-selected{border-right:1px dashed var(--ag-range-selection-border-color)!important}:where(.ag-rtl) .ag-cell.ag-selection-fill-right,:where(.ag-rtl) .ag-cell.ag-selection-fill-right.ag-cell-range-selected{border-left:1px dashed var(--ag-range-selection-border-color)!important}.ag-cell.ag-selection-fill-bottom,.ag-cell.ag-selection-fill-bottom.ag-cell-range-selected{border-bottom:1px dashed;border-bottom-color:var(--ag-range-selection-border-color)}:where(.ag-ltr) .ag-cell.ag-selection-fill-left,:where(.ag-ltr) .ag-cell.ag-selection-fill-left.ag-cell-range-selected{border-left:1px dashed var(--ag-range-selection-border-color)!important}:where(.ag-rtl) .ag-cell.ag-selection-fill-left,:where(.ag-rtl) .ag-cell.ag-selection-fill-left.ag-cell-range-selected{border-right:1px dashed var(--ag-range-selection-border-color)!important}.ag-fill-handle,.ag-range-handle{background-color:var(--ag-range-selection-border-color);bottom:-1px;height:6px;position:absolute;width:6px}:where(.ag-ltr) .ag-fill-handle,:where(.ag-ltr) .ag-range-handle{right:-1px}:where(.ag-rtl) .ag-fill-handle,:where(.ag-rtl) .ag-range-handle{left:-1px}.ag-fill-handle{cursor:cell}:where(.ag-ltr) .ag-range-handle{cursor:nwse-resize}:where(.ag-rtl) .ag-range-handle{cursor:nesw-resize}";function P6(e){var t,i;return(i=(t=e.rangeSvc)==null?void 0:t.getCellRanges())!=null?i:null}function E6(e,t){var i;(i=e.rangeSvc)==null||i.addCellRange(t)}function EL(e){var t;(t=e.rangeSvc)==null||t.removeAllCellRanges()}var $p="ag-cell-range-selected",R6="ag-cell-range-chart",N6="ag-cell-range-single-cell",O6="ag-cell-range-chart-category",F6="ag-cell-range-handle",B6="ag-cell-range-top",_6="ag-cell-range-right",G6="ag-cell-range-bottom",z6="ag-cell-range-left";function V6(e){var s;const t=e.get("cellSelection");return t!==void 0?typeof t!="boolean"?((s=t.handle)==null?void 0:s.mode)==="range":!1:e.get("enableRangeHandle")}function RL(e){var s;const t=e.get("cellSelection");return t!==void 0?typeof t!="boolean"?((s=t.handle)==null?void 0:s.mode)==="fill":!1:e.get("enableFillHandle")}var j6=class{constructor(e,t){this.beans=e,this.cellCtrl=t,this.rangeSvc=e.rangeSvc}setComp(e){this.cellComp=e,this.eGui=this.cellCtrl.eGui,this.onCellSelectionChanged()}onCellSelectionChanged(){const e=this.cellComp;if(!e)return;const{rangeSvc:t,cellCtrl:i,eGui:s}=this,n=t.getCellRangeCount(i.cellPosition);this.rangeCount=n;const a=this.getHasChartRange();this.hasChartRange=a,e.toggleCss($p,n!==0),e.toggleCss(`${$p}-1`,n===1),e.toggleCss(`${$p}-2`,n===2),e.toggleCss(`${$p}-3`,n===3),e.toggleCss(`${$p}-4`,n>=4),e.toggleCss(R6,a),(0,m._setAriaSelected)(s,n>0?!0:void 0),e.toggleCss(N6,this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle()}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),i=!t&&e.top,s=!t&&e.right,n=!t&&e.bottom,a=!t&&e.left,r=this.cellComp;r.toggleCss(B6,i),r.toggleCss(_6,s),r.toggleCss(G6,n),r.toggleCss(z6,a)}isSingleCell(){const{rangeSvc:e}=this;return this.rangeCount===1&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeSvc:e}=this;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(i=>[m.CellRangeType.DIMENSION,m.CellRangeType.VALUE].includes(i.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,i=!1,s=!1,n=!1;const{rangeSvc:a,beans:{visibleCols:r},cellCtrl:{cellPosition:o}}=this,l=o.column,c=a.getCellRanges().filter(u=>a.isCellInSpecificRange(o,u));if(!c.length)return{top:t,right:i,bottom:s,left:n};let h,d;e?(h=r.getColAfter(l),d=r.getColBefore(l)):(h=r.getColBefore(l),d=r.getColAfter(l)),h||(n=!0),d||(i=!0);for(let u=0;u<c.length&&!(t&&i&&s&&n);u++){const p=c[u],g=a.getRangeStartRow(p),f=a.getRangeEndRow(p);!t&&(0,m._isSameRow)(g,o)&&(t=!0),!s&&(0,m._isSameRow)(f,o)&&(s=!0),!n&&h&&p.columns.indexOf(h)<0&&(n=!0),!i&&d&&p.columns.indexOf(d)<0&&(i=!0)}return{top:t,right:i,bottom:s,left:n}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.toggleCss(F6,!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeSvc,i=t.getCellRanges(),s=i.length;if(this.rangeCount<1||s<1)return!1;const n=(0,m._last)(i),{cellPosition:a}=this.cellCtrl,r=RL(e)&&!this.cellCtrl.column.isSuppressFillHandle(),o=V6(e);let l=s===1&&!this.cellCtrl.editing&&(r||o);if(this.hasChartRange){const h=i[0].type===m.CellRangeType.DIMENSION&&t.isCellInSpecificRange(a,i[0]);this.cellComp.toggleCss(O6,h),l=n.type===m.CellRangeType.VALUE}return l&&n.endRow!=null&&t.isContiguousRange(n)&&t.isBottomRightCell(n,a)}addSelectionHandle(){var a;const{beans:e,rangeSvc:t}=this,i=(0,m._last)(t.getCellRanges()).type,n=RL(e.gos)&&(0,m._missing)(i)?0:1;if(this.selectionHandle&&this.selectionHandle.getType()!==n&&(this.selectionHandle=e.context.destroyBean(this.selectionHandle)),!this.selectionHandle){const r=e.registry.createDynamicBean(n===0?"fillHandle":"rangeHandle",!1);r&&(this.selectionHandle=e.context.createBean(r))}(a=this.selectionHandle)==null||a.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},H6=class extends m.BeanStub{constructor(e){super(),this.eContainer=e}postConstruct(){const{beans:e,gos:t,eContainer:i}=this,s=e.rangeSvc,n={eElement:i,onDragStart:s.onDragStart.bind(s),onDragStop:s.onDragStop.bind(s),onDragging:s.onDragging.bind(s)},a=e.dragSvc,r=a.addDragSource.bind(a,n),o=a.removeDragSource.bind(a,n);this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{(0,m._isCellSelectionEnabled)(t)?r():o()}),this.addDestroyFunc(o),(0,m._isCellSelectionEnabled)(t)&&r()}},W6=class extends m.BeanStub{constructor(e,t){super(),this.column=e,this.comp=t,this.columnMap=new Map,this.isActive=!1,this.resetColumnMap()}postConstruct(){this.addManagedPropertyListener("cellSelection",()=>{this.refreshActive()}),this.refreshActive(),this.setupRangeHeaderHighlight()}resetColumnMap(){this.columnMap.clear();let e;this.column.isColumn?e=[this.column]:e=this.column.getDisplayedLeafColumns();for(const t of e)this.columnMap.set(t,!1)}refreshActive(){const{gos:e,rangeSvc:t}=this.beans,i=e.get("cellSelection");this.isActive=!!(i&&t&&typeof i=="object"&&i.enableHeaderHighlight)}setupRangeHeaderHighlight(){const e=this.onRangeSelectionChanged.bind(this);this.addManagedEventListeners({rangeSelectionChanged:e,columnPinned:e,columnMoved:e,columnGroupOpened:e}),e()}onRangeSelectionChanged(){if(!this.isActive)return;this.resetColumnMap();const e=this.beans.rangeSvc.getCellRanges();let t=!1,i=!0;for(const s of e){if(t)break;for(const n of s.columns)this.columnMap.has(n)&&(this.columnMap.set(n,!0),t||(t=!0))}for(const s of Array.from(this.columnMap.values()))if(s===!1){i=!1;break}this.comp.toggleCss("ag-header-range-highlight",t&&i)}destroy(){super.destroy(),this.comp=null,this.column=null}},U6=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="rangeSvc",this.cellRanges=[],this.bodyScrollListener=this.onBodyScroll.bind(this),this.dragging=!1,this.intersectionRange=!1}wireBeans(e){this.rowModel=e.rowModel,this.dragSvc=e.dragSvc,this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.cellNavigation=e.cellNavigation,this.ctrlsSvc=e.ctrlsSvc,this.valueSvc=e.valueSvc}postConstruct(){const e=this.onColumnsChanged.bind(this),t=()=>this.removeAllCellRanges(),i=this.refreshLastRangeStart.bind(this);this.addManagedEventListeners({newColumnsLoaded:e,columnVisible:e,columnValueChanged:e,columnPivotModeChanged:t,columnRowGroupChanged:t,columnPivotChanged:t,columnGroupOpened:i,columnMoved:i,columnPinned:i}),this.ctrlsSvc.whenReady(this,s=>{const n=s.gridBodyCtrl;this.autoScrollService=new m.AutoScrollService({scrollContainer:n.eBodyViewport,scrollAxis:"xy",getVerticalPosition:()=>n.scrollFeature.getVScrollPosition().top,setVerticalPosition:a=>n.scrollFeature.setVerticalScrollPosition(a),getHorizontalPosition:()=>n.scrollFeature.getHScrollPosition().left,setHorizontalPosition:a=>n.scrollFeature.setHorizontalScrollPosition(a),shouldSkipVerticalScroll:()=>!(0,m._isDomLayout)(this.gos,"normal"),shouldSkipHorizontalScroll:()=>!n.scrollFeature.isHorizontalScrollShowing()})})}onDragStart(e){var c;if(!(0,m._isCellSelectionEnabled)(this.gos))return;const{ctrlKey:t,metaKey:i,shiftKey:s}=e,n=t||i,r=!(0,m._getSuppressMultiRanges)(this.gos)?n:!1,o=s&&!!((c=this.cellRanges)!=null&&c.length);!r&&(!o||(0,m._exists)((0,m._last)(this.cellRanges).type))&&this.removeAllCellRanges(!0);const l=this.dragSvc.startTarget;if(l&&this.updateValuesOnMove(l),!!this.lastCellHovered){if(this.dragging=!0,this.lastMouseEvent=e,this.intersectionRange=r&&this.getCellRangeCount(this.lastCellHovered)>1,o||this.setNewestRangeStartCell(this.lastCellHovered),this.cellRanges.length>0)this.draggingRange=(0,m._last)(this.cellRanges);else{const h={rowIndex:this.lastCellHovered.rowIndex,rowPinned:this.lastCellHovered.rowPinned},d=this.getColumnsFromModel([this.lastCellHovered.column]);if(!d||!d.length)return;this.draggingRange={startRow:h,endRow:h,columns:d,startColumn:this.newestRangeStartCell.column},this.cellRanges.push(this.draggingRange)}this.ctrlsSvc.getGridBodyCtrl().eBodyViewport.addEventListener("scroll",this.bodyScrollListener,{passive:!0}),this.dispatchChangedEvent(!0,!1,this.draggingRange.id)}}onDragging(e){const{dragging:t,lastCellHovered:i,newestRangeStartCell:s,autoScrollService:n,cellHasChanged:a}=this;if(!t||!e)return;this.updateValuesOnMove(e.target),this.lastMouseEvent=e;const r=p=>i&&i.rowPinned===p&&s.rowPinned===p,o=r("top")||r("bottom");if(n.check(e,o),!a||!i)return;const l=s==null?void 0:s.column,c=i==null?void 0:i.column,h=this.calculateColumnsBetween(l,c);if(!h)return;const{rowIndex:d,rowPinned:u}=i;this.draggingRange.endRow={rowIndex:d,rowPinned:u},this.draggingRange.columns=h,this.dispatchChangedEvent(!1,!1,this.draggingRange.id)}onDragStop(){if(!this.dragging)return;const{id:e}=this.draggingRange;this.autoScrollService.ensureCleared(),this.ctrlsSvc.getGridBodyCtrl().eBodyViewport.removeEventListener("scroll",this.bodyScrollListener),this.lastMouseEvent=null,this.dragging=!1,this.draggingRange=void 0,this.lastCellHovered=void 0,this.intersectionRange&&(this.intersectionRange=!1,this.intersectLastRange()),this.dispatchChangedEvent(!1,!0,e)}onColumnsChanged(){this.refreshLastRangeStart();const e=this.visibleCols.allCols;this.cellRanges.forEach(i=>{const s=i.columns;i.columns=i.columns.filter(a=>a.isVisible()&&e.indexOf(a)!==-1),!(0,m._areEqual)(s,i.columns)&&this.dispatchChangedEvent(!1,!0,i.id)});const t=this.cellRanges.length;this.cellRanges=this.cellRanges.filter(i=>i.columns.length>0),t>this.cellRanges.length&&this.dispatchChangedEvent(!1,!0)}refreshLastRangeStart(){const e=(0,m._last)(this.cellRanges);e&&this.refreshRangeStart(e)}isContiguousRange(e){const t=e.columns;if(!t.length)return!1;const i=this.visibleCols.allCols,s=t.map(n=>i.indexOf(n)).sort((n,a)=>n-a);return(0,m._last)(s)-s[0]+1===t.length}getRangeStartRow(e){var s,n;return e.startRow&&e.endRow?(0,m._isRowBefore)(e.startRow,e.endRow)?e.startRow:e.endRow:{rowIndex:0,rowPinned:((n=(s=this.beans.pinnedRowModel)==null?void 0:s.getPinnedTopRowCount())!=null?n:0)>0?"top":null}}getRangeEndRow(e){var s,n;if(e.startRow&&e.endRow)return(0,m._isRowBefore)(e.startRow,e.endRow)?e.endRow:e.startRow;const t=(n=(s=this.beans.pinnedRowModel)==null?void 0:s.getPinnedBottomRowCount())!=null?n:0;return t>0?{rowIndex:t-1,rowPinned:"bottom"}:{rowIndex:this.rowModel.getRowCount()-1,rowPinned:null}}setRangeToCell(e,t=!1){const{gos:i}=this;if(!(0,m._isCellSelectionEnabled)(i))return;const s=i.get("rowNumbers"),n=(0,m.isRowNumberCol)(e.column);s&&this.setSelectionMode(n);const a=this.calculateColumnsBetween(e.column,e.column);if(!a)return;((0,m._getSuppressMultiRanges)(this.gos)||!t||(0,m._missing)(this.cellRanges))&&this.removeAllCellRanges(!0);const o={rowIndex:e.rowIndex,rowPinned:e.rowPinned},l={startRow:o,endRow:o,columns:a,startColumn:e.column};this.cellRanges.push(l),this.setNewestRangeStartCell(e),this.onDragStop(),this.dispatchChangedEvent(!0,!0)}extendLatestRangeToCell(e){if(this.isEmpty()||!this.newestRangeStartCell)return;const t=(0,m._last)(this.cellRanges);this.setSelectionMode((0,m.isRowNumberCol)(e.column)),this.updateRangeEnd(t,e)}updateRangeEnd(e,t,i=!1){const s=t.column,n=this.calculateColumnsBetween(e.startColumn,s);!n||this.isLastCellOfRange(e,t)||(e.columns=n,e.endRow={rowIndex:t.rowIndex,rowPinned:t.rowPinned},i||this.dispatchChangedEvent(!0,!0,e.id))}getRangeEdgeColumns(e){const t=this.visibleCols.allCols,i=e.columns.map(s=>t.indexOf(s)).filter(s=>s>-1).sort((s,n)=>s-n);return{left:t[i[0]],right:t[(0,m._last)(i)]}}extendLatestRangeInDirection(e){if(this.isEmpty()||!this.newestRangeStartCell)return;const t=e.key,i=e.ctrlKey||e.metaKey,s=(0,m._last)(this.cellRanges),n=this.newestRangeStartCell,a=s.columns[0],r=(0,m._last)(s.columns),o=s.endRow.rowIndex,l=s.endRow.rowPinned,h={column:n.column===a?r:a,rowIndex:o,rowPinned:l},d=this.cellNavigation.getNextCellToFocus(t,h,i);if(d)return this.setCellRange({rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:d.rowIndex,rowEndPinned:d.rowPinned,columnStart:n.column,columnEnd:d.column}),d}setCellRange(e){(0,m._isCellSelectionEnabled)(this.gos)&&(this.removeAllCellRanges(!0),this.addCellRange(e))}setCellRanges(e){if(!(0,m._areEqual)(this.cellRanges,e)&&this.verifyCellRanges(this.gos)){this.removeAllCellRanges(!0);for(const t of e){if(t.columns&&t.startRow){const i=this.getColumnsFromModel(t.columns);if(!i||i.length===0)continue;t.columns=i;const{startRow:s}=t;this.setNewestRangeStartCell({rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:t.columns[0]})}this.cellRanges.push(t)}this.dispatchChangedEvent(!1,!0)}}clearCellRangeCellValues(e){const{beans:t,valueSvc:i,eventSvc:s}=this,{cellEventSource:n="rangeSvc",dispatchWrapperEvents:a,wrapperEventSource:r="deleteKey"}=e;let{cellRanges:o}=e;a&&(s.dispatchEvent({type:"cellSelectionDeleteStart",source:r}),s.dispatchEvent({type:"rangeDeleteStart",source:r})),o||(o=this.cellRanges),o.forEach(l=>{this.forEachRowInRange(l,c=>{const h=(0,m._getRowNode)(t,c);if(h)for(let d=0;d<l.columns.length;d++){const u=this.getColumnFromModel(l.columns[d]);if(!u||!u.isCellEditable(h))continue;const p=i.getDeleteValue(u,h);h.setDataValue(u,p,n)}})}),a&&(s.dispatchEvent({type:"cellSelectionDeleteEnd",source:r}),s.dispatchEvent({type:"rangeDeleteEnd",source:r}))}createCellRangeFromCellRangeParams(e){return this.createPartialCellRangeFromRangeParams(e,!1)}createPartialCellRangeFromRangeParams(e,t){var g;const{columns:i,columnStart:s,columnEnd:n,rowStartIndex:a,rowStartPinned:r,rowEndIndex:o,rowEndPinned:l}=e,c=this.getColumnsFromParams(i,s,n);if(!c||!t&&c.columns.length===0)return;const{columns:h,startsOnTheRight:d}=c,u=this.createRowPosition(a,r),p=this.createRowPosition(o,l);return{startRow:u,endRow:p,columns:h,startColumn:(g=this.getColumnFromModel(s))!=null?g:d?(0,m._last)(h):h[0]}}addCellRange(e){const t=this.gos;if(!(0,m._isCellSelectionEnabled)(t)||!this.verifyCellRanges(t))return;this.setSelectionMode(!1);const i=this.createCellRangeFromCellRangeParams(e);i&&(i.startRow&&this.setNewestRangeStartCell({rowIndex:i.startRow.rowIndex,rowPinned:i.startRow.rowPinned,column:i.startColumn}),this.cellRanges.push(i),this.dispatchChangedEvent(!1,!0,i.id))}getCellRanges(){return this.cellRanges}isEmpty(){return this.cellRanges.length===0}isMoreThanOneCell(){const e=this.cellRanges.length;if(e===0)return!1;if(e>1)return!0;const t=this.cellRanges[0],i=this.getRangeStartRow(t),s=this.getRangeEndRow(t);return i.rowPinned!==s.rowPinned||i.rowIndex!==s.rowIndex||t.columns.length!==1}areAllRangesAbleToMerge(){const e=new Map;if(this.cellRanges.length<=1)return!0;this.cellRanges.forEach(s=>{this.forEachRowInRange(s,n=>{const a=`${n.rowPinned||"normal"}_${n.rowIndex}`,r=e.get(a),o=s.columns.map(l=>l.getId());if(r){const l=o.filter(c=>r.indexOf(c)===-1);r.push(...l)}else e.set(a,o)})});let i;for(const s of e.values()){const n=s.sort().join();if(i===void 0){i=n;continue}if(i!==n)return!1}return!0}removeAllCellRanges(e){this.isEmpty()||(this.onDragStop(),this.cellRanges.length=0,e||this.dispatchChangedEvent(!1,!0))}isCellInAnyRange(e){return this.getCellRangeCount(e)>0}isCellInSpecificRange(e,t){const i=t.columns!==null&&t.columns.includes(e.column),s=this.isRowInRange(e.rowIndex,e.rowPinned,t);return i&&s}isBottomRightCell(e,t){const i=this.visibleCols.allCols,s=e.columns.map(c=>i.indexOf(c)).sort((c,h)=>c-h),{startRow:n,endRow:a}=e,r=(0,m._isRowBefore)(n,a)?a:n,o=i.indexOf(t.column)===(0,m._last)(s),l=t.rowIndex===r.rowIndex&&(0,m._makeNull)(t.rowPinned)===(0,m._makeNull)(r.rowPinned);return o&&l}getCellRangeCount(e){return this.isEmpty()?0:this.cellRanges.filter(t=>this.isCellInSpecificRange(e,t)).length}isRowInRange(e,t,i){const s=this.getRangeStartRow(i),n=this.getRangeEndRow(i),a={rowIndex:e,rowPinned:t||null},r=a.rowIndex===s.rowIndex&&a.rowPinned==s.rowPinned,o=a.rowIndex===n.rowIndex&&a.rowPinned==n.rowPinned;if(r||o)return!0;const l=!(0,m._isRowBefore)(a,s),c=(0,m._isRowBefore)(a,n);return l&&c}intersectLastRange(e){if(e&&this.dragging||(0,m._getSuppressMultiRanges)(this.gos)||this.isEmpty())return;const t=(0,m._last)(this.cellRanges),i=this.getRangeStartRow(t),s=this.getRangeEndRow(t),n=[];this.cellRanges.slice(0,-1).forEach(a=>{const r=this.getRangeStartRow(a),o=this.getRangeEndRow(a),l=a.columns,c=l.filter(d=>t.columns.indexOf(d)===-1);if(c.length===l.length){n.push(a);return}if((0,m._isRowBefore)(s,r)||(0,m._isRowBefore)(o,i)){n.push(a);return}const h=n.length;if((0,m._isRowBefore)(r,i)){const d={columns:[...l],startColumn:t.startColumn,startRow:b({},r),endRow:(0,m._getRowAbove)(this.beans,i)};n.push(d)}if(c.length>0){const d={columns:c,startColumn:c.includes(t.startColumn)?t.startColumn:c[0],startRow:this.rowMax([b({},i),b({},r)]),endRow:this.rowMin([b({},s),b({},o)])};n.push(d)}(0,m._isRowBefore)(s,o)&&n.push({columns:[...l],startColumn:t.startColumn,startRow:(0,m._getRowBelow)(this.beans,s),endRow:b({},o)}),n.length-h===1&&(n[n.length-1].id=a.id)}),this.cellRanges=n,e&&this.dispatchChangedEvent(!1,!0)}createRangeHighlightFeature(e,t,i){e.createManagedBean(new W6(t,i))}setSelectionMode(e){this.selectionMode=e?1:0}refreshRangeStart(e){const{startColumn:t,columns:i}=e,s=(l,c)=>{const h=e.columns.filter(d=>d!==l);l?(e.startColumn=l,e.columns=c?[l,...h]:[...h,l]):e.columns=h},{left:n,right:a}=this.getRangeEdgeColumns(e);if(t===i[0]&&t!==n){s(n,!0);return}if(t===(0,m._last)(i)&&t===a){s(a,!1);return}}setNewestRangeStartCell(e){this.newestRangeStartCell=e}getColumnsFromParams(e,t,i){const s=!e&&!t&&!i;let n,a=!1;return s||e?n=this.getColumnsFromModel(s?void 0:e):t&&i&&(n=this.calculateColumnsBetween(t,i),n&&n.length&&(a=n[0]!==this.getColumnFromModel(t))),n?{columns:n,startsOnTheRight:a}:void 0}createRowPosition(e,t){return e!=null?{rowIndex:e,rowPinned:t}:void 0}verifyCellRanges(e){const t=(0,m._isUsingNewCellSelectionAPI)(e)&&(0,m._getSuppressMultiRanges)(e)&&this.cellRanges.length>1;return t&&(0,m._warn)(93),!t}forEachRowInRange(e,t){const i=this.getRangeStartRow(e),s=this.getRangeEndRow(e);let n=i;for(;n&&(t(n),!(0,m._isSameRow)(n,s));)n=(0,m._getRowBelow)(this.beans,n)}onBodyScroll(){this.dragging&&this.lastMouseEvent&&this.onDragging(this.lastMouseEvent)}isLastCellOfRange(e,t){const{startRow:i,endRow:s}=e,n=(0,m._isRowBefore)(i,s)?s:i,a=t.rowIndex===n.rowIndex&&t.rowPinned===n.rowPinned,r=e.columns[0],o=(0,m._last)(e.columns),l=e.startColumn===r?o:r;return t.column===l&&a}rowMax(e){let t;return e.forEach(i=>{(t===void 0||(0,m._isRowBefore)(t,i))&&(t=i)}),t}rowMin(e){let t;return e.forEach(i=>{(t===void 0||(0,m._isRowBefore)(i,t))&&(t=i)}),t}updateValuesOnMove(e){const t=(0,m._getCellCtrlForEventTarget)(this.gos,e),i=t==null?void 0:t.cellPosition;if(this.cellHasChanged=!1,!(!i||this.lastCellHovered&&(0,m._areCellsEqual)(i,this.lastCellHovered))){if(t!=null&&t.editing){this.dragSvc.cancelDrag(e);return}this.lastCellHovered&&(this.cellHasChanged=!0),this.lastCellHovered=i}}shouldSkipCurrentColumn(e){return(0,m.isRowNumberCol)(e)}dispatchChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"cellSelectionChanged",started:e,finished:t,id:i}),this.eventSvc.dispatchEvent({type:"rangeSelectionChanged",started:e,finished:t,id:i})}getColumnFromModel(e){return typeof e=="string"?this.colModel.getCol(e):e}getColumnsFromModel(e){const{gos:t,visibleCols:i}=this,s=t.get("rowNumbers");(!e||this.selectionMode===1)&&(e=i.allCols);const n=[];for(const a of e){const r=this.getColumnFromModel(a);!r||s&&this.shouldSkipCurrentColumn(r)||n.push(r)}return n.length?n:void 0}calculateColumnsBetween(e,t){const i=this.visibleCols.allCols,s=this.getColumnFromModel(e),n=this.getColumnFromModel(t),a=s===n,r=i.indexOf(s);if(r<0){(0,m._warn)(178,{colId:s.getId()});return}const o=a?r:i.indexOf(n);if(o<0){(0,m._warn)(178,{colId:n.getId()});return}if(a||this.selectionMode===1)return this.getColumnsFromModel([s]);const l=Math.min(r,o),c=l===r?o:r,h=[];for(let d=l;d<=c;d++)h.push(i[d]);return this.getColumnsFromModel(h)}createDragListenerFeature(e){return new H6(e)}createCellRangeFeature(e,t){return new j6(e,t)}},TS={moduleName:"CellSelection",version:Re,beans:[U6],dynamicBeans:{fillHandle:T6,rangeHandle:k6},apiFunctions:{getCellRanges:P6,addCellRange:E6,clearRangeSelection:EL,clearCellSelection:EL},dependsOn:[St,m._KeyboardNavigationModule,m._DragModule],css:[L6]},nIe={moduleName:"RangeSelection",version:Re,dependsOn:[TS]},K6={tag:"div",cls:"ag-loading",children:[{tag:"span",ref:"eLoadingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eLoadingText",cls:"ag-loading-text"}]},$6=class extends m.Component{constructor(){super(K6),this.eLoadingIcon=m.RefPlaceholder,this.eLoadingText=m.RefPlaceholder}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){this.eLoadingText.textContent=this.getLocaleTextFunc()("loadingError","ERR")}setupLoading(){const e=(0,m._createIconNoSpan)("groupLoading",this.beans,null);e&&this.eLoadingIcon.appendChild(e),this.eLoadingText.textContent=this.getLocaleTextFunc()("loadingOoo","Loading")}refresh(e){return!1}},Y6={tag:"div",cls:"ag-skeleton-container"},X6=class extends m.Component{constructor(){super(Y6)}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>(0,m._setAriaLabelledBy)(e.eParentOfValue)),(0,m._setAriaLabelledBy)(e.eParentOfValue,t),e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");(0,m._setAriaLabel)(this.getGui(),t)}setupLoading(e){const t=(0,m._createElement)({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){const a=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${a}%`}this.getGui().appendChild(t);const n=this.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");(0,m._setAriaLabel)(this.getGui(),n)}refresh(e){return!1}},Z6={moduleName:"LoadingCellRenderer",version:Re,userComponents:{agLoadingCellRenderer:$6},icons:{groupLoading:"loading"},dependsOn:[St]},q6={moduleName:"SkeletonCellRenderer",version:Re,userComponents:{agSkeletonCellRenderer:X6},dependsOn:[St]};function Q6(e){return e.colModel.isPivotMode()}function J6(e,t,i){var s,n;return(n=(s=e.pivotResultCols)==null?void 0:s.lookupPivotResultCol(t,i))!=null?n:null}function e9(e,t){var i;(i=e.valueColsSvc)==null||i.setColumns(t,"api")}function t9(e){var t,i;return(i=(t=e.valueColsSvc)==null?void 0:t.columns)!=null?i:[]}function i9(e,t){var i;(i=e.valueColsSvc)==null||i.removeColumns(t,"api")}function s9(e,t){var i;(i=e.valueColsSvc)==null||i.addColumns(t,"api")}function n9(e,t){var i;(i=e.pivotColsSvc)==null||i.setColumns(t,"api")}function a9(e,t){var i;(i=e.pivotColsSvc)==null||i.removeColumns(t,"api")}function r9(e,t){var i;(i=e.pivotColsSvc)==null||i.addColumns(t,"api")}function o9(e){var t,i;return(i=(t=e.pivotColsSvc)==null?void 0:t.columns)!=null?i:[]}function l9(e,t){var i;(i=e.pivotResultCols)==null||i.setPivotResultCols(t,"api")}function c9(e){var i;const t=(i=e.pivotResultCols)==null?void 0:i.getPivotResultCols();return t?t.list:null}var NL="PivotRowTotal_",h9=({headerName:e},{headerName:t})=>e&&!t?1:!e&&t?-1:!e&&!t?0:e<t?-1:e>t?1:0,d9=e=>(t,i)=>e(t.headerName,i.headerName),u9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="pivotColDefSvc"}wireBeans(e){this.colModel=e.colModel,this.pivotColsSvc=e.pivotColsSvc,this.valueColsSvc=e.valueColsSvc,this.colNames=e.colNames}postConstruct(){const e=()=>{var i;return(i=this.gos.get("serverSidePivotResultFieldSeparator"))!=null?i:"_"};this.fieldSeparator=e(),this.addManagedPropertyListener("serverSidePivotResultFieldSeparator",()=>{this.fieldSeparator=e()});const t=()=>this.gos.get("pivotDefaultExpanded");this.pivotDefaultExpanded=t(),this.addManagedPropertyListener("pivotDefaultExpanded",()=>{this.pivotDefaultExpanded=t()})}createPivotColumnDefs(e){const t=this.createPivotColumnsFromUniqueValues(e);function i(a,r=[]){return a.forEach(o=>{o.children!==void 0?i(o.children,r):r.push(o)}),r}const s=i(t);this.addRowGroupTotals(t,s),this.addExpandablePivotGroups(t,s),this.addPivotTotalsToGroups(t,s);const n=s.map(a=>b({},a));return{pivotColumnGroupDefs:t,pivotColumnDefs:n}}createPivotColumnsFromUniqueValues(e){var n,a;const t=(a=(n=this.pivotColsSvc)==null?void 0:n.columns)!=null?a:[],i=t.length;return this.recursivelyBuildGroup(0,e,[],i,t)}recursivelyBuildGroup(e,t,i,s,n){var c;if(e>=s)return this.buildMeasureCols(i);const{pivotComparator:a}=n[e].getColDef(),r=a?d9(a):h9,o=(c=this.valueColsSvc)==null?void 0:c.columns;if((o==null?void 0:o.length)===1&&this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&e===s-1){const h=[];for(const d of t.keys()){const u=[...i,d],p=this.createColDef(o[0],d,u);p.columnGroupShow="open",h.push(p)}return h.sort(r),h}const l=[];for(const h of t.keys()){const d=this.pivotDefaultExpanded===-1||e<this.pivotDefaultExpanded,u=[...i,h];l.push({children:this.recursivelyBuildGroup(e+1,t.get(h),u,s,n),headerName:h,pivotKeys:u,columnGroupShow:"open",openByDefault:d,groupId:this.generateColumnGroupId(u)})}return l.sort(r),l}buildMeasureCols(e){var i,s;const t=(s=(i=this.valueColsSvc)==null?void 0:i.columns)!=null?s:[];return t.length===0?[this.createColDef(null,"-",e)]:t.map(n=>{const a=this.colNames.getDisplayNameForColumn(n,"header");return E(b({},this.createColDef(n,a,e)),{columnGroupShow:"open"})})}addExpandablePivotGroups(e,t){const i=this.gos.get("suppressExpandablePivotGroups");if(i||this.gos.get("pivotColumnGroupTotals"))return;const s=(n,a,r)=>{if("children"in n){const{valueColsSvc:c}=this,{columns:h=[]}=c!=null?c:{},d=new Map;n.children.forEach(g=>{s(g,a,d)});const u=!n.children.some(g=>g.children),p=u&&h.length===1&&this.gos.get("removePivotHeaderRowWhenSingleValueColumn");h.forEach(g=>{const f=this.colNames.getDisplayNameForColumn(g,"header"),y=this.createColDef(g,f,n.pivotKeys);y.pivotTotalColumnIds=d.get(g.getColId()),y.columnGroupShow=i?"open":"closed",y.aggFunc=g.getAggFunc(),(!u||p)&&(n.children.push(y),a.push(y))}),this.merge(r,d);return}if(!n.pivotValueColumn)return;const o=n.pivotValueColumn.getColId();r.has(o)?r.get(o).push(n.colId):r.set(o,[n.colId])};e.forEach(n=>{s(n,t,new Map)})}addPivotTotalsToGroups(e,t){var a;if(!this.gos.get("pivotColumnGroupTotals"))return;const i=this.gos.get("pivotColumnGroupTotals")==="after",s=(a=this.valueColsSvc)==null?void 0:a.columns,n=s==null?void 0:s.map(r=>r.getAggFunc());if(!(!n||n.length<1||!this.sameAggFuncs(n))&&s){const r=s[0];e.forEach(o=>{this.recursivelyAddPivotTotal(o,t,r,i)})}}recursivelyAddPivotTotal(e,t,i,s){const n=e;if(!n.children){const r=e;return r.colId?[r.colId]:null}let a=[];if(n.children.forEach(r=>{const o=this.recursivelyAddPivotTotal(r,t,i,s);o&&(a=a.concat(o))}),n.children.length>1){const o=this.getLocaleTextFunc()("pivotColumnGroupTotals","Total"),l=this.createColDef(i,o,e.pivotKeys,!0);l.pivotTotalColumnIds=a,l.aggFunc=i.getAggFunc(),l.columnGroupShow=this.gos.get("suppressExpandablePivotGroups")?"open":void 0;const c=e.children;s?c.push(l):c.unshift(l),t.push(l)}return a}addRowGroupTotals(e,t){var r,o;if(!this.gos.get("pivotRowTotals"))return;const i=this.gos.get("pivotRowTotals")==="after",n=((o=(r=this.valueColsSvc)==null?void 0:r.columns)!=null?o:[]).slice();i||n.reverse();const a=n.length>1||!this.gos.get("removePivotHeaderRowWhenSingleValueColumn");for(let l=0;l<n.length;l++){const c=n[l],h=this.colNames.getDisplayNameForColumn(c,"header"),d=this.createColDef(c,h,[]),u=[];for(let g=0;g<t.length;g++){const f=t[g];f.pivotValueColumn===c&&u.push(f.colId)}d.pivotTotalColumnIds=u,d.colId=NL+d.colId;const p=a?{children:[d],pivotKeys:[],groupId:`${NL}_pivotGroup_${c.getColId()}`}:d;t.push(d),i?e.push(p):e.unshift(p)}}createColDef(e,t,i,s=!1){const n={};if(e){const a=e.getColDef();Object.assign(n,a),n.hide=!1}return n.headerName=t,n.colId=this.generateColumnId(i||[],e&&!s?e.getColId():""),n.field=n.colId,n.valueGetter=a=>{var r;return(r=a.data)==null?void 0:r[a.colDef.field]},n.pivotKeys=i,n.pivotValueColumn=e,n.filter===!0&&(n.filter="agNumberColumnFilter"),n}sameAggFuncs(e){if(e.length==1)return!0;for(let t=1;t<e.length;t++)if(e[t]!==e[0])return!1;return!0}merge(e,t){t.forEach((i,s)=>{const a=[...e.has(s)?e.get(s):[],...i];e.set(s,a)})}generateColumnGroupId(e){var i,s;return`pivotGroup_${((s=(i=this.pivotColsSvc)==null?void 0:i.columns)!=null?s:[]).map(n=>n.getColId()).join("-")}_${e.join("-")}`}generateColumnId(e,t){var s,n;return`pivot_${((n=(s=this.pivotColsSvc)==null?void 0:s.columns)!=null?n:[]).map(a=>a.getColId()).join("-")}_${e.join("-")}_${t}`}createColDefsFromFields(e){const t=new Map;for(let n=0;n<e.length;n++){const r=e[n].split(this.fieldSeparator);let o=t;for(let l=0;l<r.length;l++){const c=r[l];let h=o.get(c);h||(h=new Map,o.set(c,h)),o=h}}const i=(n,a,r,o)=>{var d;const l=[];for(const[u,p]of r){const g=i(`${n}${this.fieldSeparator}${u}`,u,p,o+1);l.push(g)}if(l.length===0){const u=this.colModel.getColDefCol(a);if(u){const g=(d=this.colNames.getDisplayNameForColumn(u,"header"))!=null?d:a,f=this.createColDef(u,g,void 0,!1);return f.colId=n,f.aggFunc=u.getAggFunc(),f.valueGetter=y=>{var v;return(v=y.data)==null?void 0:v[n]},f}return{colId:n,headerName:a,valueGetter:g=>{var f;return(f=g.data)==null?void 0:f[n]}}}return this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&l.length===1&&"colId"in l[0]?(l[0].headerName=a,l[0]):{openByDefault:this.pivotDefaultExpanded===-1||o<this.pivotDefaultExpanded,groupId:n,headerName:a,children:l}},s=[];for(const[n,a]of t){const r=i(n,n,a,0);s.push(r)}return s}},p9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="pivotResultCols"}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols}destroy(){var e;(0,m._destroyColumnTree)(this.beans,(e=this.pivotResultCols)==null?void 0:e.tree),super.destroy()}isPivotResultColsPresent(){return this.pivotResultCols!=null}lookupPivotResultCol(e,t){if(this.pivotResultCols==null)return null;const i=this.colModel.getColDefCol(t);let s=null;return this.pivotResultCols.list.forEach(n=>{const a=n.getColDef().pivotKeys,r=n.getColDef().pivotValueColumn;(0,m._areEqual)(a,e)&&r===i&&(s=n)}),s}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.colModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){var i,s;if(this.colModel.ready&&!(e==null&&this.pivotResultCols==null)){if(e){this.processPivotResultColDef(e);const a=(t==="api"?m._createColumnTree:m._createColumnTreeWithIds)(this.beans,e,!1,((i=this.pivotResultCols)==null?void 0:i.tree)||this.previousPivotResultCols||void 0,t);(0,m._destroyColumnTree)(this.beans,(s=this.pivotResultCols)==null?void 0:s.tree,a.columnTree);const r=a.columnTree,o=a.treeDepth,l=(0,m._getColumnsFromTree)(r),c={};this.pivotResultCols={tree:r,treeDepth:o,list:l,map:c},this.pivotResultCols.list.forEach(d=>this.pivotResultCols.map[d.getId()]=d);const h=!!this.previousPivotResultCols;this.previousPivotResultCols=null,this.colModel.refreshCols(!h)}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null,this.colModel.refreshCols(!1);this.visibleCols.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),i=this.gos.get("processPivotResultColGroupDef");if(!t&&!i)return;const s=n=>{n.forEach(a=>{if((0,m._exists)(a.children)){const o=a;i&&i(o),s(o.children)}else t&&t(a)})};e&&s(e)}},OL="Exceeded maximum allowed pivot column count.",Um=e=>{const t={};return e.forEach((i,s)=>t[s]=i instanceof Map?Um(i):i),t},g9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="pivotStage",this.refreshProps=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),this.step="pivot",this.uniqueValues=new Map,this.lastTimeFailed=!1,this.maxUniqueValues=-1,this.currentUniqueCount=0}wireBeans(e){this.valueSvc=e.valueSvc,this.colModel=e.colModel,this.pivotResultCols=e.pivotResultCols,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueColsSvc=e.valueColsSvc,this.pivotColsSvc=e.pivotColsSvc,this.pivotColDefSvc=e.pivotColDefSvc}execute(e){const t=e.changedPath;this.colModel.isPivotActive()?this.executePivotOn(t):this.executePivotOff(t)}executePivotOff(e){this.aggregationColumnsHashLastTime=null,this.uniqueValues=new Map,this.pivotResultCols.isPivotResultColsPresent()&&(this.pivotResultCols.setPivotResultCols(null,"rowModelUpdated"),e&&(e.active=!1))}executePivotOn(e){var v,x,S,M,D,A;const t=(x=(v=this.valueColsSvc)==null?void 0:v.columns.length)!=null?x:1,i=this.gos.get("pivotMaxGeneratedColumns");this.maxUniqueValues=i===-1?-1:i/t;let s;try{s=this.bucketUpRowNodes(e)}catch(w){if(w.message===OL){this.pivotResultCols.setPivotResultCols([],"rowModelUpdated"),this.eventSvc.dispatchEvent({type:"pivotMaxColumnsExceeded",message:w.message}),this.lastTimeFailed=!0;return}throw w}const n=this.setUniqueValues(s),a=(M=(S=this.valueColsSvc)==null?void 0:S.columns)!=null?M:[],r=a.map(w=>`${w.getId()}-${w.getColDef().headerName}`).join("#"),o=a.map(w=>w.getAggFunc().toString()).join("#"),l=this.aggregationColumnsHashLastTime!==r,c=this.aggregationFuncsHashLastTime!==o;this.aggregationColumnsHashLastTime=r,this.aggregationFuncsHashLastTime=o;const h=((A=(D=this.rowGroupColsSvc)==null?void 0:D.columns)!=null?A:[]).map(w=>w.getId()).join("#"),d=h!==this.groupColumnsHashLastTime;this.groupColumnsHashLastTime=h;const u=this.gos.get("pivotRowTotals"),p=this.gos.get("pivotColumnGroupTotals"),g=this.gos.get("suppressExpandablePivotGroups"),f=this.gos.get("removePivotHeaderRowWhenSingleValueColumn"),y=u!==this.pivotRowTotalsLastTime||p!==this.pivotColumnGroupTotalsLastTime||g!==this.suppressExpandablePivotGroupsLastTime||f!==this.removePivotHeaderRowWhenSingleValueColumnLastTime;if(this.pivotRowTotalsLastTime=u,this.pivotColumnGroupTotalsLastTime=p,this.suppressExpandablePivotGroupsLastTime=g,this.removePivotHeaderRowWhenSingleValueColumnLastTime=f,this.lastTimeFailed||n||l||d||c||y){const{pivotColumnGroupDefs:w,pivotColumnDefs:T}=this.pivotColDefSvc.createPivotColumnDefs(this.uniqueValues);this.pivotColumnDefs=T,this.pivotResultCols.setPivotResultCols(w,"rowModelUpdated"),e&&(e.active=!1)}this.lastTimeFailed=!1}setUniqueValues(e){const t=JSON.stringify(Um(this.uniqueValues)),i=JSON.stringify(Um(e));return t!==i?(this.uniqueValues=e,!0):!1}bucketUpRowNodes(e){this.currentUniqueCount=0;const t=new Map;e.forEachChangedNodeDepthFirst(s=>{s.leafGroup&&(s.childrenMapped=null)});const i=s=>{var n;s.leafGroup?this.bucketRowNode(s,t):(n=s.childrenAfterFilter)==null||n.forEach(i)};return e.executeFromRootNode(i),t}bucketRowNode(e,t){var s;const i=(s=this.pivotColsSvc)==null?void 0:s.columns;(i==null?void 0:i.length)===0?e.childrenMapped=null:e.childrenMapped=Um(this.bucketChildren(e.childrenAfterFilter,i,0,t)),e.sibling&&(e.sibling.childrenMapped=e.childrenMapped)}bucketChildren(e,t=[],i,s){const n=new Map,a=t[i];if(e.forEach(o=>{let l=this.valueSvc.getKeyForNode(a,o);if((0,m._missing)(l)&&(l=""),!s.get(l)){this.currentUniqueCount+=1,s.set(l,new Map);const c=this.maxUniqueValues!==-1,h=this.currentUniqueCount>this.maxUniqueValues;if(c&&h)throw Error(OL)}n.has(l)||n.set(l,[]),n.get(l).push(o)}),i===t.length-1)return n;const r=new Map;for(const o of n.keys())r.set(o,this.bucketChildren(n.get(o),t,i+1,s.get(o)));return r}getPivotColumnDefs(){return this.pivotColumnDefs}},FL={moduleName:"SharedPivot",version:Re,beans:[p9,u9,dL],apiFunctions:{isPivotMode:Q6,getPivotResultColumn:J6,setValueColumns:e9,getValueColumns:t9,removeValueColumns:i9,addValueColumns:s9,setPivotColumns:n9,removePivotColumns:a9,addPivotColumns:r9,getPivotColumns:o9,setPivotResultColumns:l9,getPivotResultColumns:c9},dependsOn:[wL,m._ColumnGroupModule]},f9={moduleName:"Pivot",version:Re,rowModels:["clientSide"],beans:[g9],dependsOn:[FL,AL,Hm]},m9=(e,t)=>e.treeNode.sourceIdx-t.treeNode.sourceIdx,y9=m._EmptyArray.values(),v9=class NT{constructor(t,i){this.parent=t,this.key=i,this.children=null,this.invalidatedHead=null,this.invalidatedNext=void 0,this.row=null,this.oldRow=null,this.duplicateRows=null,this.childrenAfterGroup=m._EmptyArray,this.allLeafChildren=null,this.childrenChanged=!1,this.leafChildrenChanged=!1,this.sourceIdx=-1}get size(){var t,i;return(i=(t=this.children)==null?void 0:t.size)!=null?i:0}isEmptyFillerNode(){var t,i;return!((t=this.row)!=null&&t.data)&&!((i=this.children)!=null&&i.size)}enumChildren(){var t,i;return(i=(t=this.children)==null?void 0:t.values())!=null?i:y9}upsertKey(t){var s,n,a;typeof t!="string"&&(t=String(t));let i=(s=this.children)==null?void 0:s.get(t);return i||(i=new NT(this,t),(a=(n=this.children)!=null?n:this.children=new Map)==null||a.set(i.key,i)),i}appendKey(t){var n,a;const i=this.children;typeof t!="string"&&(t=String(t));let s=i==null?void 0:i.get(t);return s?(i.delete(t),i.set(t,s)):(s=new NT(this,t),(a=(n=this.children)!=null?n:this.children=new Map)==null||a.set(s.key,s)),s}destroy(){var s;const{row:t,parent:i}=this;t!==null&&t.treeNode===this&&(t.treeNode=null),i!==null&&(this.parent=null,(s=i.children)==null||s.delete(this.key))}setRow(t){const i=this.row;return i===t?!1:(i!==null&&(i.treeNode=null),t!==null&&(t.treeNode=this),this.row=t,!0)}removeRow(t){const{row:i,duplicateRows:s}=this;if(i===t){if(this.row=null,s!==null)for(const n of s){this.row=n,s.delete(n);break}}else if(!(s!=null&&s.delete(t)))return!1;return(s==null?void 0:s.size)===0&&(this.duplicateRows=null),t.treeNode=null,!0}addDuplicateRow(t){let i=this.duplicateRows;if(i===null)i=new Set,this.duplicateRows=i;else if(i.has(t))return!1;return i.add(t),t.treeNode=this,t.childrenAfterGroup=m._EmptyArray,t.allLeafChildren=null,!0}sortFirstDuplicateRow(){const t=this.duplicateRows,i=this.row;if(!i||!t)return i;let s=i;for(const n of t)n.sourceRowIndex<s.sourceRowIndex&&(s=n);return s!==i&&(t.delete(s),t.add(i),this.row=s),s}dequeueInvalidated(){var t;for(;;){const i=this.invalidatedHead;if(!i)return null;if(this.invalidatedHead=(t=i.invalidatedNext)!=null?t:null,i.parent===this)return i.invalidatedNext=void 0,i}}invalidate(){let t=this,i=this.parent;for(;i!==null&&t.invalidatedNext===void 0;)t.invalidatedNext=i.invalidatedHead,i.invalidatedHead=t,t=i,i=t.parent}invalidateOrder(){var i,s,n,a,r;const t=this.parent;!t||t.childrenChanged||(((s=(i=t.children)==null?void 0:i.size)!=null?s:0)>1||((a=(n=this.children)==null?void 0:n.size)!=null?a:0)>1||!((r=t.row)!=null&&r.data))&&(t.childrenChanged=!0,t.invalidate())}getNewSourceIdx(){var i,s,n;const t=this.row;return t!=null&&t.data?t.sourceRowIndex:(n=(s=(i=this.childrenAfterGroup[0])==null?void 0:i.treeNode)==null?void 0:s.sourceIdx)!=null?n:this.sourceIdx}updateChildrenAfterGroup(t,i){var c;this.childrenChanged=!1;const s=t&&((c=this.children)==null?void 0:c.size);if(!s)return this.childrenAfterGroup.length===0?!1:(this.childrenAfterGroup=i?[]:m._EmptyArray,this.leafChildrenChanged=!0,!0);let n=!1,a=this.childrenAfterGroup;a===m._EmptyArray?(a=new Array(s),this.childrenAfterGroup=a,n=!0):a.length!==s&&(a.length=s,n=!0);let r=0,o=-1,l=!1;for(const h of this.enumChildren()){const d=h.getNewSourceIdx();d<o&&(l=!0),o=d,h.sourceIdx=d;const u=h.row;a[r]!==u&&(a[r]=u,n=!0),++r}return n&&(this.leafChildrenChanged=!0),l&&this.reorderChildrenList(a),n||l}reorderChildrenList(t){const i=t.length,s=this.children;t.sort(m9),s.clear();for(let n=0;n<i;++n){const a=t[n].treeNode;s.set(a.key,a)}}updateAllLeafChildren(){var a,r;const{parent:t,childrenAfterGroup:i}=this;this.leafChildrenChanged=!1;let s=!1;const n=i.length;if(n===0)this.allLeafChildren&&(s||(s=this.allLeafChildren.length!==0),this.allLeafChildren=null);else{const o=(a=this.allLeafChildren)!=null?a:this.allLeafChildren=[],l=o.length;let c=0;for(let h=0;h<n;++h){const d=i[h],u=(r=d.treeNode)==null?void 0:r.allLeafChildren,p=u==null?void 0:u.length;if(d.data&&((c>=l||o[c]!==d)&&(o[c]=d,s=!0),++c),p)for(let g=0;g<p;++g){const f=u[g];(c>=l||o[c]!==f)&&(o[c]=f,s=!0),++c}}l!==c&&(o.length=c,s=!0)}s&&t&&(t.leafChildrenChanged=!0)}},b9=e=>(e.treeNodeFlags&1)!==0,BL=e=>(e.treeNodeFlags&2)!==0,_L=e=>(e.treeNodeFlags&4)!==0,x9=e=>(e.treeNodeFlags&8)!==0,GL=e=>(e.treeNodeFlags&16)!==0,zL=(e,t)=>{t?e.treeNodeFlags|=2:e.treeNodeFlags&=-3},C9=e=>{const t=e.treeNodeFlags;(t&1)!==0&&(e.treeNodeFlags=t|4)},S9=e=>{const t=e.treeNodeFlags;(t&1)!==0&&(e.treeNodeFlags=t|12)},go=e=>{e&&(e.treeNodeFlags|=16)},VL=e=>{const t=e.level<0,i=e.treeNodeFlags,s=(i&1)!==0;if(e.treeNodeFlags=1|i&-29,!s||t){const n=e.childrenAfterGroup;e.childrenAfterFilter=n,e.childrenAfterAggFilter=n,e.childrenAfterSort=n}if(t){const n=e.sibling;n&&(n.childrenAfterGroup=e.childrenAfterGroup,n.childrenMapped=e.childrenMapped)}},Yp=e=>{e.treeNodeFlags=0},M9=(e,t,i)=>{if(t!==i&&t!==null&&t.group&&BL(t)&&!e.isGroupOpenByDefault)return t.expanded;const s=e.isGroupOpenByDefault;return s?s({rowNode:i,field:i.field,key:i.key,level:i.level,rowGroupColumn:i.rowGroupColumn})==!0:e.expandByDefault===-1||i.level<e.expandByDefault},jL=class extends m.AbstractClientSideNodeManager{constructor(){super(...arguments),this.oldGroupDisplayColIds="",this.rowsPendingDestruction=null,this.treeCommitPending=!0,this.treeRoot=null}activate(e){super.activate(e),this.treeSetRootNode(e),this.treeCommitPending=!0}treeSetRootNode(e){let t=this.treeRoot;t||(t=new v9(null,""),t.childrenChanged=!0,this.treeRoot=t),t.row=e,e.treeNode=t}destroy(){super.destroy(),this.treeRoot=null,this.rowsPendingDestruction=null,this.oldGroupDisplayColIds=""}deactivate(){const{treeRoot:e,rootNode:t}=this;e&&(t&&e.removeRow(t),this.treeDestroy(e),e.destroy()),t&&Yp(t),this.commitDestroyedRows(),super.deactivate(),this.treeRoot=null,this.oldGroupDisplayColIds=""}treeSetRow(e,t,i){var a;const s=e.row;if(e===this.treeRoot)return!1;let n=!1;if(s!==t){const r=t.treeNode;r!==null&&r!==e&&(r.removeRow(t),r.invalidate()),s===null?(e.setRow(t),n=!0):s.data?e.addDuplicateRow(t)&&(n=!0):(e.setRow(t),this.destroyRow(s,!0),n=!0)}return!i&&!_L(t)&&(C9(t),n=!0),n&&e.invalidate(),(a=this.rowsPendingDestruction)==null||a.delete(t),n}treeRemove(e,t){if(e===this.treeRoot)return;let i=!1;if(e.removeRow(t)){const s=e.parent;s&&(s.childrenChanged=!0),this.destroyRow(t,!t.data),i=!0}i&&e.invalidate()}treeCommit(e){var o;const{treeRoot:t,rootNode:i}=this;if(!t||!i)return;this.treeCommitPending=!1;const s=this.treeData,n=e!=null&&e.active?e:null,a={rootNode:i,activeChangedPath:n,treeData:s,expandByDefault:this.gos.get("groupDefaultExpanded"),isGroupOpenByDefault:this.gos.getCallback("isGroupOpenByDefault")};this.treeCommitChildren(a,t,!1,0);const r=t.row;r&&(s&&(r.leafGroup=!1),t.childrenChanged&&t.updateChildrenAfterGroup(s,!0)&&go(r),(s||!n)&&(r.childrenAfterGroup=t.childrenAfterGroup),n&&GL(r)&&n.addParentNode(r),VL(r),r.updateHasChildren()),this.commitDestroyedRows(),s&&((o=this.beans.selectionSvc)==null||o.updateSelectableAfterGrouping(e))}treeCommitChildren(e,t,i,s){var n,a,r;for(;;){const o=t.dequeueInvalidated();if(o===null)break;o.parent===t&&this.treeCommitChild(e,o,i||!((a=(n=t.row)==null?void 0:n.expanded)==null||a),s)}t.childrenChanged||(t.childrenChanged=(e.treeData?t.size:0)!==((r=t.row.childrenAfterGroup)==null?void 0:r.length))}treeCommitChild(e,t,i,s){if(t.isEmptyFillerNode()){this.treeClear(t);return}if(this.treeCommitPreOrder(e,t,s),this.treeCommitChildren(e,t,i,s+1),t.isEmptyFillerNode()){this.treeClear(t);return}this.treeCommitPostOrder(e,t,i)}treeCommitPreOrder(e,t,i){let s=t.row;if(s===null?(s=this.createFillerRow(t,i),t.setRow(s)):(s=t.sortFirstDuplicateRow(),s.allChildrenCount===void 0&&(s.allChildrenCount=null)),e.treeData){if(s.level=i,s.parent=t.parent.row,t.oldRow!==s)for(const a of t.enumChildren()){const r=a.row;r!==null&&(r.parent=s)}const n=t.key;s.key!==n?(s.key=n,S9(s),this.setGroupData(s,n)):s.groupData||this.setGroupData(s,n)}else e.activeChangedPath||(s.level=0,s.parent=e.rootNode,s.key=t.key)}treeCommitPostOrder(e,t,i){var c,h;const s=t.parent,n=t.row,a=t.oldRow,r=n.group;if(t.childrenChanged&&t.updateChildrenAfterGroup(e.treeData,!1)&&go(n),t.leafChildrenChanged&&t.updateAllLeafChildren(),e.treeData||!e.activeChangedPath){n.childrenAfterGroup=t.childrenAfterGroup,n.allLeafChildren=t.allLeafChildren;const d=t.childrenAfterGroup.length>0,u=d||!n.data;r!==u?(go(n),mS(n,this.beans,u),!u&&!n.expanded&&zL(n,!1)):n.hasChildren()!==d&&(go(n),n.updateHasChildren()),u&&!BL(n)&&(n.expanded=M9(e,a,n),zL(n,!0)),_L(n)&&(go(s.row),x9(n)&&n.setData(n.data))}a!==n&&(t.oldRow=n,a!==null&&(r||t.size!==0)&&go(n),s.childrenChanged=!0,go(s.row)),GL(n)&&(this.treeData?(c=e.activeChangedPath)==null||c.addParentNode(n):go(e.rootNode)),VL(n),(h=t.duplicateRows)!=null&&h.size&&!t.duplicateRowsWarned&&(t.duplicateRowsWarned=!0,(0,m._warn)(186,{rowId:n.id,rowData:n.data,duplicateRowsData:Array.from(t.duplicateRows).map(d=>d.data)})),i&&n.rowIndex!==null&&n.clearRowTopAndRowIndex();const o=t.getNewSourceIdx(),l=t.sourceIdx;l!==o&&(t.sourceIdx=o,l!==-1&&(s.childrenChanged=!0))}createFillerRow(e,t){const i=new m.RowNode(this.beans);i.key=e.key,i.group=!0,i.field=null,i.leafGroup=!1,i.rowGroupIndex=null,i.allChildrenCount=null;let s=t+"-"+e.key,n=e.parent;for(;n!==null;){const a=n.parent;if(a===null)break;--t,s=`${t}-${n.key}-${s}`,n=a}return i.id=m._ROW_ID_PREFIX_ROW_GROUP+s,i}setGroupData(e,t){var n;e.groupValue=t;const i={};e.groupData=i;const s=(n=this.beans.showRowGroupCols)==null?void 0:n.getShowRowGroupCols();if(s)for(const a of s)i[a.getColId()]=t}treeClear(e){const{parent:t,oldRow:i}=e;if(t!==null&&i!==null&&(t.childrenChanged=!0,t.row!==null&&go(t.row)),e!==this.treeRoot){let s=e.row;for(;s!==null&&e.removeRow(s);)this.destroyRow(s,!s.data),s=e.row}for(const s of e.enumChildren())this.treeClear(s);e.destroy()}treeDestroy(e){const{row:t,duplicateRows:i}=e;if(t&&(e!==this.treeRoot&&!t.data?this.destroyRow(t,!0):Yp(t)),i)for(const s of i)e!==this.treeRoot&&!s.data?this.destroyRow(s,!0):Yp(s);for(const s of e.enumChildren())this.treeDestroy(s);e.destroy()}destroyRow(e,t){var i;if(e.isSelected())t=!1;else if(!b9(e)){Yp(e);return}if(!t){((i=this.rowsPendingDestruction)!=null?i:this.rowsPendingDestruction=new Set).add(e);return}Yp(e),e.clearRowTopAndRowIndex(),e.groupData=null}commitDestroyedRows(){const{rowsPendingDestruction:e}=this;let t=null;if(e!==null){for(const i of e)this.destroyRow(i,!0),i.isSelected()&&(t!=null?t:t=[]).push(i);this.rowsPendingDestruction=null}t&&this.deselectNodes(t)}refreshModel(e,t){var i,s,n,a,r;if(t&&this.treeCommitPending&&this.treeCommit(e.changedPath),!!e.afterColumnsChanged)if(this.treeData){const o=(n=(s=(i=this.beans.showRowGroupCols)==null?void 0:i.getShowRowGroupCols())==null?void 0:s.map(l=>l.getId()).join("-"))!=null?n:"";if(this.oldGroupDisplayColIds!==o){this.oldGroupDisplayColIds=o;const l=(a=this.rootNode)==null?void 0:a.childrenAfterGroup;if(l)for(let c=0,h=(r=l.length)!=null?r:0;c<h;++c){const d=l[c],u=d.treeNode;u&&this.setGroupData(d,u.key)}}}else this.oldGroupDisplayColIds=""}},D9=e=>{if(typeof e!="string"||!e.length)return[];const t=e.split(".");return t.includes("__proto__")?[]:t},HL=e=>{const t=D9(e);let i=null;const s=t.length-1;return s===0?i=n=>n==null?void 0:n[e]:s>0?i=n=>{let a=n;for(let r=0;r<=s&&a!==null&&a!==void 0;++r)if(a=a[t[r]],r<s&&typeof a!="object"&&a!==void 0)return null;return a}:i=()=>{},i.path=e,i},w9=class extends jL{constructor(){super(...arguments),this.beanName="csrmChildrenTreeNodeSvc",this.childrenGetter=null}get treeData(){return this.gos.get("treeData")}extractRowData(){const e=this.treeRoot;return e&&Array.from(e.enumChildren(),t=>t.row.data)}destroy(){super.destroy(),this.childrenGetter=null}activate(e){const t=this.childrenGetter,i=this.gos.get("treeDataChildrenField");(!t||t.path!==i)&&(this.childrenGetter=HL(i)),super.activate(e)}updateRowData(e,t){return(0,m._warn)(268),{changedRowNodes:t,rowNodeTransaction:{add:[],remove:[],update:[]},rowsInserted:!1}}loadNewRowData(e){const t=this.treeRoot,i=this.rootNode,s=this.childrenGetter,n=new Map,a=[];i.allLeafChildren=a,this.treeClear(t),this.treeSetRootNode(i);const r=(o,l)=>{let c=n.get(l);if(c!==void 0){(0,m._error)(2,{nodeId:c.id});return}c=this.createRowNode(l,a.length),n.set(l,c),a.push(c),o=o.upsertKey(c.id),this.treeSetRow(o,c,!0);const h=s==null?void 0:s(l);if(h)for(let d=0,u=h.length;d<u;++d)r(o,h[d])};for(let o=0,l=e.length;o<l;++o)r(t,e[o]);this.treeCommitPending=!0}setImmutableRowData(e,t){var D;this.dispatchRowDataUpdateStartedEvent(t);const i=this.gos,s=this.treeRoot,n=this.rootNode,a=this.childrenGetter,r=(0,m._getRowIdCallback)(i),o=!i.get("suppressMaintainUnsortedOrder"),l=new Map,c=new m.ChangedPath(!1,n);e.changedPath=c;const h=e.changedRowNodes,d=n.allLeafChildren,u=[],p=[];let g=!1,f=!1;const x=o?(A,w,T)=>{const k=w==null?void 0:w.length;let N=!0,O=-1;for(let L=0;L<k;++L){const F=S(A,w[L],T);F>=0&&(F<O&&(N=!1),O=F)}N||(g=!0,A.childrenChanged||(A.childrenChanged=!0,A.invalidate()))}:(A,w,T)=>{for(let k=0,N=w.length;k<N;++k)S(A,w[k],T)},S=(A,w,T)=>{let k=l.get(w);if(k!==void 0)return(0,m._warn)(2,{nodeId:k.id}),-1;const N=r({data:w,level:T});let O=!1;k=this.getRowNode(N),k?k.data!==w&&(h.update(k),k.updateData(w),!k.selectable&&k.isSelected()&&p.push(k)):(k=this.createRowNode(w,-1),h.add(k),O=!0),l.set(w,k);let L,F;o?(F=A.appendKey(k.id),L=k.sourceRowIndex,k.sourceRowIndex=u.push(k)-1):(F=A.upsertKey(k.id),L=-1),this.treeSetRow(F,k,O)&&(f=!0);const B=a==null?void 0:a(w);return B&&x(F,B,T+1),L};if(x(s,t,0),d)for(let A=0,w=d.length;A<w;++A){const T=d[A],k=T.treeNode;if(k){const N=T.data;N&&!l.has(N)&&(T.pinnedSibling&&((D=this.beans.pinnedRowModel)==null||D.pinRow(T.pinnedSibling,null)),h.remove(T),this.treeRemove(k,T))}}if(!o){const A=w=>{for(const T of w.enumChildren()){const k=T.row;k&&(k.sourceRowIndex=u.push(k)-1,A(T))}};A(s)}n.allLeafChildren=u,s.allLeafChildren=u,p.length&&this.deselectNodes(p),this.treeCommitPending=!0;const M=n.sibling;M&&(M.allLeafChildren=u),(f||g)&&(e.rowDataUpdated=!0,e.rowNodesOrderChanged||(e.rowNodesOrderChanged=g))}refreshModel(e,t){var s,n;const i=this.rootNode;if(i&&((s=e.changedProps)!=null&&s.has("treeData"))&&!e.newData){this.treeSetRootNode(i);const a=this.treeRoot,r=i.allLeafChildren;if(r)for(let o=0,l=r.length;o<l;++o){const c=r[o];c.groupData=null,(n=c.treeNode)==null||n.invalidate()}a.childrenChanged=!0,this.treeCommitPending=!0}super.refreshModel(e,t)}},A9=class extends jL{constructor(){super(...arguments),this.beanName="csrmPathTreeNodeSvc"}loadNewRowData(e){const t=this.rootNode,i=this.treeRoot;this.treeClear(i),this.treeSetRootNode(t),super.loadNewRowData(e);const s=t.allLeafChildren,n=this.gos.get("getDataPath");for(let a=0,r=s.length;a<r;++a)this.addOrUpdateRow(n,s[a],!0);this.treeCommitPending=!0}get treeData(){const e=this.gos;return e.get("treeData")&&!!e.get("getDataPath")}refreshModel(e,t){const i=e.changedRowNodes;i&&this.executeTransactions(i,e.rowNodesOrderChanged),super.refreshModel(e,t)}executeTransactions(e,t){var a;const i=this.treeRoot;if(!i)return;this.treeSetRootNode(this.rootNode);for(const r of e.removals){const o=r.treeNode;o&&this.treeRemove(o,r)}const s=this.gos.get("getDataPath");for(const r of e.updates)this.addOrUpdateRow(s,r,!1);for(const r of e.adds)this.addOrUpdateRow(s,r,!0);const n=(a=i.row)==null?void 0:a.allLeafChildren;if(t&&n)for(let r=0,o=n.length;r<o;++r){const l=n[r].treeNode;l&&l.sourceIdx!==r&&l.invalidateOrder()}this.treeCommitPending=!0}addOrUpdateRow(e,t,i){const s=this.treeRoot;if(!this.treeData){this.treeSetRow(s.upsertKey(t.id),t,i);return}const n=e==null?void 0:e(t.data),a=n==null?void 0:n.length;if(!a)(0,m._warn)(185,{data:t.data});else{let r=0,o=s;do o=o.upsertKey(n[r++]);while(r<a);this.treeSetRow(o,t,i)}}},Km=2147483648,kS=1073741824,$m=536870912,Ym=536870911,I9=class extends m.BeanStub{constructor(){super(...arguments),this.parentIdGetter=null,this.oldGroupDisplayColIds=null}destroy(){super.destroy(),this.parentIdGetter=null,this.oldGroupDisplayColIds=null}execute(e){var p;const t=e.rowNode;let i=!e.changedRowNodes,s=t.childrenAfterGroup;(!s||s===t.allLeafChildren)&&(i=!0,t.childrenAfterGroup=s=[]);let n=!1;(e.afterColumnsChanged||this.oldGroupDisplayColIds===null)&&(n=this.updateGroupDisplayColsIds());let a=this.parentIdGetter;const r=this.gos.get("treeDataParentIdField");(!a||a.path!==r)&&(a=HL(r));const o=!this.gos.get("getRowId");o||R9(this.beans.rowModel,e,a,i),s.length=t.treeNodeFlags&Ym,t.treeNodeFlags=0;const l=this.gos.get("groupDefaultExpanded"),c=this.gos.getCallback("isGroupOpenByDefault"),h=(p=e.changedPath)!=null&&p.active?e.changedPath:void 0;let d=0;const u=(g,f)=>{var O,L,F,B;++d;let y=g.treeNodeFlags;const v=(O=g.childrenAfterGroup)!=null?O:g.childrenAfterGroup=m._EmptyArray,x=y&Ym;let S=(y&kS)!==0;v.length!==x&&(v.length=x,S=!0);let M=S||(y&Km)!==0,D=S;g.treeNodeFlags=y&$m,g.level=f++;let A=0;for(let _=0;_<x;++_){const G=v[_];u(G,f)&&(D=!0),A+=((F=(L=G.allLeafChildren)==null?void 0:L.length)!=null?F:0)+1}let w=g.allLeafChildren;(w===v||w===void 0)&&(w=g.allLeafChildren=null),(D||((B=w==null?void 0:w.length)!=null?B:0)!==A)&&(D=P9(g,w,A));const T=g.id;(g.key!==T||!g.groupData||n)&&(M=!0,g.key=T,this.setGroupData(g,T));const k=g.group,N=x>0;return k!==N?(M=!0,mS(g,this.beans,N),!N&&!g.expanded&&(y=g.treeNodeFlags&=~$m)):g.hasChildren()!==N&&(M=!0,g.updateHasChildren()),N&&(y&$m)===0&&(g.treeNodeFlags|=$m,g.expanded=E9(c,l,g)),(S||D||i)&&L9(g,v),M&&(h==null||h.addParentNode(g)),D};for(let g=0,f=s.length;g<f;++g)u(s[g],0);i&&k9(t,s),d!==t.allLeafChildren.length&&!o&&T9(t,u)}updateGroupDisplayColsIds(){var t,i,s;const e=(s=(i=(t=this.beans.showRowGroupCols)==null?void 0:t.getShowRowGroupCols())==null?void 0:i.map(n=>n.getId()).join("-"))!=null?s:"";return this.oldGroupDisplayColIds!==e?(this.oldGroupDisplayColIds=e,!0):!1}setGroupData(e,t){var n;const i={};e.groupData=i;const s=(n=this.beans.showRowGroupCols)==null?void 0:n.getShowRowGroupCols();if(s)for(const a of s)i[a.getColId()]=t}},T9=(e,t)=>{const i=new Set,s=a=>{i.add(a);for(const r of a.childrenAfterGroup)s(r)};s(e);const n=e.childrenAfterGroup;n.length=0;for(const a of e.allLeafChildren)if(i.has(a))a.parent===e&&n.push(a);else{const r=a.parent;(0,m._warn)(270,{id:a.id,parentId:r.id}),r.childrenAfterGroup=r.childrenAfterGroup.filter(o=>o!==a),r.treeNodeFlags=r.treeNodeFlags-1|kS|Km,a.parent=e,t(a,0),s(a),n.push(a)}},k9=(e,t)=>{e.childrenAfterFilter=t,e.childrenAfterAggFilter=t,e.childrenAfterSort=t;const i=e.sibling;i&&(i.childrenAfterGroup=e.childrenAfterGroup,i.childrenAfterAggFilter=e.childrenAfterAggFilter,i.childrenAfterSort=e.childrenAfterSort)},L9=(e,t)=>{var s,n,a,r;(s=e.allLeafChildren)!=null||(e.allLeafChildren=null),(n=e.childrenAfterFilter)!=null||(e.childrenAfterFilter=t),(a=e.childrenAfterAggFilter)!=null||(e.childrenAfterAggFilter=t),(r=e.childrenAfterSort)!=null||(e.childrenAfterSort=t);const i=e.sibling;i&&(i.allLeafChildren=e.allLeafChildren,i.childrenAfterGroup=e.childrenAfterGroup,i.childrenAfterAggFilter=e.childrenAfterAggFilter,i.childrenAfterFilter=e.childrenAfterFilter,i.childrenAfterSort=e.childrenAfterSort)},P9=(e,t,i)=>{if(i===0)return t?(e.allLeafChildren=null,!!(t!=null&&t.length)):!1;let s=!1;t?t.length!==i&&(t.length=i,s=!0):(t=e.allLeafChildren=new Array(i),s=!0);let n=0;const a=e.childrenAfterGroup;if(a)for(const r of a){s||(s=t[n]!==r),t[n++]=r;const o=r.allLeafChildren;if(o)for(const l of o)s||(s=t[n]!==l),t[n++]=l}return s},E9=(e,t,i)=>e?e({rowNode:i,field:i.field,key:i.key,level:i.level,rowGroupColumn:i.rowGroupColumn})==!0:t===-1||i.level<t,R9=(e,{rowNode:t,changedRowNodes:i},s,n)=>{var l;const a=i==null?void 0:i.updates,r=i==null?void 0:i.adds,o=t.allLeafChildren;for(let c=0,h=o.length;c<h;++c){const d=o[c],u=(a==null?void 0:a.has(d))||(r==null?void 0:r.has(d)),p=d.parent;let g;if(u||n){const x=s(d.data);x==null?g=t:(g=e.getRowNode(x),g||((0,m._warn)(271,{id:d.id,parentId:x}),g=t))}else g=(l=d.parent)!=null?l:t;let f=g.treeNodeFlags;const y=f&Ym;f=f&~Ym|y+1;let v=g.childrenAfterGroup;(!v||v===m._EmptyArray)&&(g.childrenAfterGroup=v=[]),(v.length<=y||v[y]!==d)&&(v[y]=d,f|=kS),(u||d.parent!==g)&&(d.parent=g,f|=Km,p!==g&&p!==null&&(p.treeNodeFlags|=Km)),g.treeNodeFlags=f}},WL={moduleName:"SharedTreeData",version:Re,dependsOn:[St,MS,SL,DS]},N9={moduleName:"TreeData",version:Re,beans:[A9,w9],dynamicBeans:{treeParentIdStrategy:I9},rowModels:["clientSide"],dependsOn:[WL,hL,Hm]},O9="ag-Grid-MissingKey",F9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmBlockUtils"}wireBeans(e){this.valueSvc=e.valueSvc,this.showRowGroupCols=e.showRowGroupCols,this.nodeManager=e.ssrmNodeManager,this.expansionSvc=e.expansionSvc,this.serverSideRowModel=e.rowModel,this.storeFactory=e.ssrmStoreFactory}createRowNode(e){const t=new m.RowNode(this.beans),i=e.rowHeight!=null?e.rowHeight:(0,m._getRowHeightAsNumber)(this.beans);return t.setRowHeight(i),t.group=e.group,t.leafGroup=e.leafGroup,t.level=e.level,t.uiLevel=e.level,t.parent=e.parent,t.stub=!0,t.__needsRefreshWhenVisible=!1,t.group&&(t.expanded=!1,t.field=e.field,t.rowGroupColumn=e.rowGroupColumn,t.rowGroupIndex=e.level),t}destroyRowNode(e,t=!1){e.childStore&&!t&&(this.destroyBean(e.childStore),e.childStore=null),e.sibling&&!e.footer&&this.destroyRowNode(e.sibling,!1),e.clearRowTopAndRowIndex(),e.id!=null&&this.nodeManager.removeNode(e)}setTreeGroupInfo(e){e.updateHasChildren();const t=this.gos.get("getServerSideGroupKey"),i=e.hasChildren();i&&t!=null&&(e.key=t(e.data)),!i&&e.childStore!=null&&(this.destroyBean(e.childStore),e.childStore=null,e.expanded=!1)}setRowGroupInfo(e){if(e.key=this.valueSvc.getValue(e.rowGroupColumn,e),(e.key===null||e.key===void 0)&&(0,m._doOnce)(()=>{var n;(0,m._warn)(190,{rowGroupId:(n=e.rowGroupColumn)==null?void 0:n.getId(),data:e.data})},"SSBlock-BadKey"),this.gos.get("groupAllowUnbalanced")&&e.key===""){const n=this.serverSideRowModel.getParams();e.childStore=this.createBean(this.storeFactory.createStore(n,e))}(0,m._getGroupTotalRowCallback)(this.beans.gos)({node:e})&&(po(e,this.beans),e.sibling&&(e.sibling.uiLevel=e.uiLevel+1))}setMasterDetailInfo(e){const t=this.gos.get("isRowMaster");t!=null?e.master=t(e.data):e.master=!0}updateDataIntoRowNode(e,t){e.updateData(t),this.gos.get("treeData")?(this.setTreeGroupInfo(e),this.setChildCountIntoRowNode(e),this.updateRowFooter(e)):e.group?(this.setChildCountIntoRowNode(e),this.updateRowFooter(e)):this.gos.get("masterDetail")}updateRowFooter(e){if(!e.footer){if(e.group&&(0,m._getGroupTotalRowCallback)(this.beans.gos)({node:e})&&!e.sibling){po(e,this.beans);return}e.sibling&&SS(e)}}setDataIntoRowNode(e,t,i,s){var a;e.stub=!1;const n=this.gos.get("treeData");e.setDataAndId(t,i),n?this.setTreeGroupInfo(e):e.group?this.setRowGroupInfo(e):this.gos.get("masterDetail")&&this.setMasterDetailInfo(e),(n||e.group)&&(this.setGroupDataIntoRowNode(e),this.setChildCountIntoRowNode(e)),(0,m._exists)(t)&&(e.setRowHeight((0,m._getRowHeightForNode)(this.beans,e,!1,s).height),(a=e.sibling)==null||a.setRowHeight((0,m._getRowHeightForNode)(this.beans,e.sibling,!1,s).height))}setChildCountIntoRowNode(e){const t=this.gos.get("getChildCount");t&&e.setAllChildrenCount(t(e.data))}setGroupDataIntoRowNode(e){var s,n;e.groupValue=e.key;const t=(n=(s=this.showRowGroupCols)==null?void 0:s.getShowRowGroupCols())!=null?n:[],i=this.gos.get("treeData");t.forEach(a=>{if(e.groupData==null&&(e.groupData={}),i)e.groupData[a.getColId()]=e.key;else if(a.isRowGroupDisplayed(e.rowGroupColumn.getId())){const r=this.valueSvc.getValue(e.rowGroupColumn,e);e.groupData[a.getColId()]=r}})}clearDisplayIndex(e){var s,n;e.clearRowTopAndRowIndex(),e.hasChildren()&&!!e.childStore&&((s=e.childStore)==null||s.clearDisplayIndexes()),e.master&&e.detailNode&&((n=e.detailNode)==null||n.clearRowTopAndRowIndex())}setDisplayIndex(e,t,i,s){const n=this.gos.get("groupAllowUnbalanced")&&e.group&&e.key==="";if(this.gos.get("groupHideOpenParents")&&e.group&&e.expanded||n?(e.setRowIndex(null),e.setRowTop(null)):(e.setRowIndex(t.value++),e.setRowTop(i.value),i.value+=e.rowHeight),e.setUiLevel(s),e.footer)return;if(e.master&&(e.expanded&&e.detailNode?(e.detailNode.setRowIndex(t.value++),e.detailNode.setRowTop(i.value),i.value+=e.detailNode.rowHeight):e.detailNode&&e.detailNode.clearRowTopAndRowIndex()),e.hasChildren()&&!!e.childStore){const l=e.childStore;e.expanded||n?l.setDisplayIndexes(t,i,n?s:s+1):l.clearDisplayIndexes()}}extractRowBounds(e,t){const i=s=>({rowHeight:s.rowHeight,rowTop:s.rowTop});if(e.rowIndex===t)return i(e);if(e.hasChildren()&&e.expanded&&e.childStore){const s=e.childStore;if(s.isDisplayIndexInStore(t))return s.getRowBounds(t)}else if(e.master&&e.expanded&&e.detailNode&&e.detailNode.rowIndex===t)return i(e.detailNode)}isPixelInNodeRange(e,t){return!(0,m._exists)(e.rowTop)||!(0,m._exists)(e.rowHeight)?!1:t>=e.rowTop&&t<e.rowTop+e.rowHeight}getIndexAtPixel(e,t){if(this.isPixelInNodeRange(e,t))return e.rowIndex;const i=e.master&&e.expanded,s=e.detailNode;if(i&&s&&this.isPixelInNodeRange(s,t))return s.rowIndex;if(e.hasChildren()&&e.expanded&&e.childStore){const n=e.childStore;if(n.isPixelInRange(t))return n.getRowIndexAtPixel(t)}return null}createNodeIdPrefix(e){const t=[];let i=e;for(;i&&i.level>=0;)i.key===""?t.push(O9):t.push(i.key),i=i.parent;if(t.length>0)return t.reverse().join("-")}checkOpenByDefault(e){var t;return(t=this.expansionSvc)==null?void 0:t.checkOpenByDefault(e)}},B9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmExpandListener"}wireBeans(e){this.serverSideRowModel=e.rowModel,this.storeFactory=e.ssrmStoreFactory}postConstruct(){(0,m._isServerSideRowModel)(this.gos)&&this.addManagedEventListeners({rowGroupOpened:this.onRowGroupOpened.bind(this)})}onRowGroupOpened(e){const t=e.node;if(t.expanded){if(t.master)this.createDetailNode(t);else if((0,m._missing)(t.childStore)){const i=this.serverSideRowModel.getParams();t.childStore=this.createBean(this.storeFactory.createStore(i,t))}}else this.gos.get("purgeClosedRowNodes")&&(0,m._exists)(t.childStore)&&(t.childStore=this.destroyBean(t.childStore));this.eventSvc.dispatchEvent({type:"storeUpdated"})}createDetailNode(e){if((0,m._exists)(e.detailNode))return e.detailNode;const t=new m.RowNode(this.beans);t.detail=!0,t.selectable=!1,t.parent=e,(0,m._exists)(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1;const i=200,s=(0,m._getRowHeightForNode)(this.beans,t).height;return t.rowHeight=s||i,e.detailNode=t,t}},_9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmFilterListener"}wireBeans(e){this.serverSideRowModel=e.rowModel,this.filterManager=e.filterManager,this.listenerUtils=e.ssrmListenerUtils}postConstruct(){(0,m._isServerSideRowModel)(this.gos)&&this.addManagedEventListeners({advancedFilterEnabledChanged:()=>this.onFilterChanged(!0),filterChanged:()=>this.onFilterChanged()})}onFilterChanged(e){var l,c,h;const t=this.serverSideRowModel.getParams();if(!t)return;const i=t.filterModel;let s,n;if((l=this.filterManager)!=null&&l.isAdvFilterEnabled()){s=this.filterManager.getAdvFilterModel();const d=e?Object.keys(i!=null?i:{}):this.getAdvancedFilterColumns(i),u=this.getAdvancedFilterColumns(s);d.forEach(p=>u.add(p)),n=Array.from(u)}else if(s=(h=(c=this.filterManager)==null?void 0:c.getFilterModel())!=null?h:{},e){const d=this.getAdvancedFilterColumns(i);Object.keys(s).forEach(u=>d.add(u)),n=Array.from(d)}else n=this.findChangedColumns(i,s);const a=this.listenerUtils.isSortingWithValueColumn(n),r=this.listenerUtils.isSortingWithSecondaryColumn(n),o={valueColChanged:a,secondaryColChanged:r,changedColumns:n};this.serverSideRowModel.refreshAfterFilter(s,o)}findChangedColumns(e,t){const i={};Object.keys(e).forEach(n=>i[n]=!0),Object.keys(t).forEach(n=>i[n]=!0);const s=[];return Object.keys(i).forEach(n=>{const a=JSON.stringify(e[n]),r=JSON.stringify(t[n]);a!=r&&s.push(n)}),s}getAdvancedFilterColumns(e){const t=new Set;if(!e)return t;const i=s=>{s.filterType==="join"?s.conditions.forEach(n=>i(n)):t.add(s.colId)};return i(e),t}},G9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmListenerUtils"}wireBeans(e){this.pivotResultCols=e.pivotResultCols,this.valueColsSvc=e.valueColsSvc}isSortingWithValueColumn(e){var i,s;const t=((s=(i=this.valueColsSvc)==null?void 0:i.columns)!=null?s:[]).map(n=>n.getColId());for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!0;return!1}isSortingWithSecondaryColumn(e){var s;const t=(s=this.pivotResultCols)==null?void 0:s.getPivotResultCols();if(!t)return!1;const i=t.list.map(n=>n.getColId());for(let n=0;n<e.length;n++)if(i.indexOf(e[n])>-1)return!0;return!1}},z9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmSortSvc"}wireBeans(e){this.sortSvc=e.sortSvc,this.serverSideRowModel=e.rowModel,this.listenerUtils=e.ssrmListenerUtils}postConstruct(){(0,m._isServerSideRowModel)(this.gos)&&this.addManagedEventListeners({sortChanged:this.onSortChanged.bind(this)})}onSortChanged(){const e=this.serverSideRowModel.getParams();if(!e)return;const t=this.sortSvc.getSortModel(),i=e.sortModel,s=this.findChangedColumnsInSort(t,i),n=this.listenerUtils.isSortingWithValueColumn(s),a=this.listenerUtils.isSortingWithSecondaryColumn(s),r={valueColChanged:n,secondaryColChanged:a,changedColumns:s};this.serverSideRowModel.refreshAfterSort(t,r)}findChangedColumnsInSort(e,t){let i=[];[e,t].forEach(a=>{if(a){const r=a.map(o=>o.colId);i=i.concat(r)}});const s=(a,r)=>{const o=a?a.sort:null,l=r?r.sort:null;return o!==l},n=(a,r)=>{const o=a?t.indexOf(a):-1,l=r?e.indexOf(r):-1;return o!==l};return i.filter(a=>{const r=t.find(l=>l.colId===a),o=e.find(l=>l.colId===a);return s(r,o)||n(r,o)})}},V9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmNodeManager",this.rowNodes=new Map}addRowNode(e){const t=e.id;this.rowNodes.has(t)&&(0,m._warn)(187,{rowId:t,firstData:this.rowNodes.get(t).data,secondData:e.data}),this.rowNodes.set(t,e)}removeNode(e){const t=e.id;this.rowNodes.delete(t)}destroy(){this.clear(),super.destroy()}clear(){this.rowNodes.clear(),super.destroy()}},j9=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="rowModel",this.pauseStoreUpdateListening=!1,this.started=!1,this.managingPivotResultColumns=!1,this.onRowHeightChanged_debounced=(0,m._debounce)(this,this.onRowHeightChanged.bind(this),100)}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.pivotResultCols=e.pivotResultCols,this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc,this.valueColsSvc=e.valueColsSvc,this.filterManager=e.filterManager,this.sortSvc=e.sortSvc,this.rowRenderer=e.rowRenderer,this.nodeManager=e.ssrmNodeManager,this.storeFactory=e.ssrmStoreFactory,this.pivotColDefSvc=e.pivotColDefSvc}ensureRowHeightsValid(){return!1}start(){this.started=!0,this.updateDatasource()}destroyDatasource(){this.datasource&&(this.datasource.destroy&&this.datasource.destroy(),this.rowRenderer.datasourceChanged(),this.datasource=void 0)}postConstruct(){const e=this.resetRootStore.bind(this);this.addManagedEventListeners({newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.onStoreUpdated.bind(this),columnValueChanged:e,columnPivotChanged:e,columnRowGroupChanged:e,columnPivotModeChanged:e}),this.addManagedPropertyListeners(["masterDetail","treeData","removePivotHeaderRowWhenSingleValueColumn","cacheBlockSize"],e),this.addManagedPropertyListeners(["groupAllowUnbalanced","groupTotalRow"],()=>this.onStoreUpdated()),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights()),this.verifyProps(),this.addManagedPropertyListener("serverSideDatasource",()=>this.updateDatasource())}updateDatasource(){const e=this.gos.get("serverSideDatasource");e&&this.setDatasource(e)}verifyProps(){(0,m._isRowSelection)(this.gos)&&!this.gos.exists("getRowId")&&(0,m._warn)(188)}setDatasource(e){this.started&&(this.destroyDatasource(),this.datasource=e,this.resetRootStore())}applyRowData(e,t,i){const s=this.getRootStore();if(!s)return;const n=s.getChildStore(i);n&&n.applyRowData(e,t,e.rowData.length)}isLastRowIndexKnown(){const e=this.getRootStore();return e?e.isLastRowIndexKnown():!1}onColumnEverything(){var c,h,d,u,p;if(!this.storeParams){this.resetRootStore();return}const e=this.columnsToValueObjects((c=this.rowGroupColsSvc)==null?void 0:c.columns),t=this.columnsToValueObjects((h=this.valueColsSvc)==null?void 0:h.columns),i=this.columnsToValueObjects((d=this.pivotColsSvc)==null?void 0:d.columns),s=g=>{const f={};g.oldCols.forEach(x=>f[x.id]=x);const y=g.newCols.every(x=>{const S=f[x.id];return S&&delete f[x.id],S&&S.field===x.field&&S.aggFunc===x.aggFunc}),v=!g.allowRemovedColumns&&!!Object.values(f).length;return y&&!v},n=!(0,m._jsonEquals)(this.storeParams.sortModel,(p=(u=this.sortSvc)==null?void 0:u.getSortModel())!=null?p:[]),a=!s({oldCols:this.storeParams.rowGroupCols,newCols:e}),r=!s({oldCols:this.storeParams.pivotCols,newCols:i}),o=!!(e!=null&&e.length)&&!s({oldCols:this.storeParams.valueCols,newCols:t,allowRemovedColumns:!0});if(n||a||r||o)this.resetRootStore();else{const g=this.createStoreParams();this.storeParams.rowGroupCols=g.rowGroupCols,this.storeParams.pivotCols=g.pivotCols,this.storeParams.valueCols=g.valueCols}}destroyRootStore(){!this.rootNode||!this.rootNode.childStore||(this.rootNode.childStore=this.destroyBean(this.rootNode.childStore),this.nodeManager.clear())}refreshAfterSort(e,t){this.storeParams&&(this.storeParams.sortModel=e);const i=this.getRootStore();i&&(i.refreshAfterSort(t),this.onStoreUpdated())}generateSecondaryColumns(e){var i;if(!this.pivotColDefSvc){this.gos.assertModuleRegistered("SharedPivot",2);return}const t=this.pivotColDefSvc.createColDefsFromFields(e);this.managingPivotResultColumns=!0,(i=this.pivotResultCols)==null||i.setPivotResultCols(t,"rowModelUpdated")}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes(),t=(0,m._getRowHeightForNode)(this.beans,this.rootNode);if(this.rootNode.setRowHeight(t.height,t.estimated),this.rootNode.sibling){const i=(0,m._getRowHeightForNode)(this.beans,this.rootNode.sibling);this.rootNode.sibling.setRowHeight(i.height,i.estimated)}e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{const i=(0,m._getRowHeightForNode)(this.beans,t);t.setRowHeight(i.height,i.estimated);const s=t.detailNode;if(s){const n=(0,m._getRowHeightForNode)(this.beans,s);s.setRowHeight(n.height,n.estimated)}if(t.sibling){const n=(0,m._getRowHeightForNode)(this.beans,t.sibling);s==null||s.setRowHeight(n.height,n.estimated)}e=!0}),e}resetRootStore(){var e;this.destroyRootStore(),this.rootNode=new m.RowNode(this.beans),this.rootNode.group=!0,this.rootNode.level=-1,this.datasource&&(this.storeParams=this.createStoreParams(),this.rootNode.childStore=this.createBean(this.storeFactory.createStore(this.storeParams,this.rootNode)),this.updateRowIndexesAndBounds()),this.managingPivotResultColumns&&((e=this.pivotResultCols)==null||e.setPivotResultCols(null,"api"),this.managingPivotResultColumns=!1),this.dispatchModelUpdated(!0)}columnsToValueObjects(e=[]){return e.map(t=>({id:t.getId(),aggFunc:t.getAggFunc(),displayName:this.colNames.getDisplayNameForColumn(t,"model"),field:t.getColDef().field}))}createStoreParams(){var a,r,o,l,c,h,d,u,p;const e=this.columnsToValueObjects((a=this.rowGroupColsSvc)==null?void 0:a.columns),t=this.columnsToValueObjects((r=this.valueColsSvc)==null?void 0:r.columns),i=this.columnsToValueObjects((o=this.pivotColsSvc)==null?void 0:o.columns),s=(0,m._isGetRowHeightFunction)(this.gos);return{valueCols:t,rowGroupCols:e,pivotCols:i,pivotMode:this.colModel.isPivotMode(),filterModel:(l=this.filterManager)!=null&&l.isAdvFilterEnabled()?(c=this.filterManager)==null?void 0:c.getAdvFilterModel():(d=(h=this.filterManager)==null?void 0:h.getFilterModel())!=null?d:{},sortModel:(p=(u=this.sortSvc)==null?void 0:u.getSortModel())!=null?p:[],datasource:this.datasource,lastAccessedSequence:{value:0},dynamicRowHeight:s}}getParams(){return this.storeParams}dispatchModelUpdated(e=!1){this.eventSvc.dispatchEvent({type:"modelUpdated",animate:!e,keepRenderedRows:!e,newPage:!1,newData:!1})}onStoreUpdated(){this.pauseStoreUpdateListening||(this.updateRowIndexesAndBounds(),this.dispatchModelUpdated())}onRowHeightChanged(){this.updateRowIndexesAndBounds(),this.dispatchModelUpdated()}updateRowIndexesAndBounds(){const e=this.getRootStore();e&&e.setDisplayIndexes({value:0},{value:0},0)}retryLoads(){const e=this.getRootStore();e&&(e.retryLoads(),this.onStoreUpdated())}getRow(e){const t=this.getRootStore();if(t)return t.getRowUsingDisplayIndex(e)}setPaused(e){this.pauseStoreUpdateListening=e}expandAll(e){this.pauseStoreUpdateListening=!0,this.forEachNode(t=>{t.stub||t.hasChildren()&&t.setExpanded(e)}),this.pauseStoreUpdateListening=!1,this.onStoreUpdated()}refreshAfterFilter(e,t){this.storeParams&&(this.storeParams.filterModel=e);const i=this.getRootStore();i&&(i.refreshAfterFilter(t),this.onStoreUpdated())}getRootStore(){var e;return(e=this.rootNode)==null?void 0:e.childStore}getRowCount(){const e=this.getRootStore();return e?e.getDisplayIndexEnd():0}getTopLevelRowCount(){const e=this.getRootStore();return e?e.getRowCount():1}getTopLevelRowDisplayedIndex(e){const t=this.getRootStore();return t?t.getTopLevelRowDisplayedIndex(e):e}getRowBounds(e){const t=this.getRootStore();return t?t.getRowBounds(e):{rowTop:0,rowHeight:(0,m._getRowHeightAsNumber)(this.beans)}}getBlockStates(){const e=this.getRootStore();if(!e)return;const t={};return e.forEachStoreDeep(i=>{const s=i.getBlockStates();for(const n of Object.keys(s))t[n]=s[n]}),t}getRowIndexAtPixel(e){const t=this.getRootStore();return e<=0||!t?0:t.getRowIndexAtPixel(e)}isEmpty(){return!1}isRowsToRender(){return this.getRootStore()!=null&&this.getRowCount()>0}getType(){return"serverSide"}forEachNode(e){const t=this.getRootStore();t&&t.forEachNodeDeep(e)}forEachDisplayedNode(e){const t=(i,s)=>{i.stub||!i.displayed||e(i,s)};this.forEachNode(t)}forEachNodeAfterFilterAndSort(e,t=!1){const i=this.getRootStore();i&&i.forEachNodeDeepAfterFilterAndSort(e,void 0,t)}executeOnStore(e,t){if(!this.started)return!1;const i=this.getRootStore();if(!i)return!0;const s=i.getChildStore(e);return s&&t(s),!0}refreshStore(e={}){const t=e.route?e.route:[];this.executeOnStore(t,i=>i.refreshStore(e.purge==!0))}getStoreState(){const e=[],t=this.getRootStore();return t&&t.addStoreStates(e),e}getNodesInRangeForSelection(e,t){const i=e.rowIndex,s=t.rowIndex;if(i===null&&s===null)return[];if(s===null)return e?[e]:[];if(i===null)return[t];const n=[],[a,r]=[i,s].sort((o,l)=>o-l);return this.forEachNode(o=>{const l=o.rowIndex;l==null||o.stub||l>=a&&l<=r&&n.push(o)}),n.length!==r-a+1?null:n}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i),i.detailNode&&i.detailNode.id===e&&(t=i.detailNode)}),t}isRowPresent(e){return!!this.getRowNode(e.id)}setRowCount(e,t){const i=this.getRootStore();i&&i.setRowCount(e,t)}destroy(){this.destroyDatasource(),this.destroyRootStore(),super.destroy()}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}};function H9(e){var t,i;return(i=(t=e.selectionSvc)==null?void 0:t.getSelectionState())!=null?i:null}function W9(e,t){var i;(i=e.selectionSvc)==null||i.setSelectionState(t,"api")}function U9(e,t){var i;return(i=e.ssrmTxnManager)==null?void 0:i.applyTransaction(t)}function K9(e,t){var n,a,r;const i=(n=t.startRow)!=null?n:0,s=(a=t.route)!=null?a:[];if(i<0){(0,m._warn)(189,{startRow:i});return}(r=(0,m._getServerSideRowModel)(e))==null||r.applyRowData(t.successParams,i,s)}function $9(e,t,i){var s;return(s=e.ssrmTxnManager)==null?void 0:s.applyTransactionAsync(t,i)}function Y9(e){var t;(t=(0,m._getServerSideRowModel)(e))==null||t.retryLoads()}function X9(e){var t;return(t=e.ssrmTxnManager)==null?void 0:t.flushAsyncTransactions()}function Z9(e,t){var i;(i=(0,m._getServerSideRowModel)(e))==null||i.refreshStore(t)}function q9(e){var t,i;return(i=(t=(0,m._getServerSideRowModel)(e))==null?void 0:t.getStoreState())!=null?i:[]}var Q9=class extends uL{constructor(){super(...arguments),this.beanName="expansionSvc",this.queuedRowIds=new Set}wireBeans(e){this.serverSideRowModel=e.rowModel}postConstruct(){this.addManagedEventListeners({columnRowGroupChanged:()=>{this.queuedRowIds.clear()}})}checkOpenByDefault(e){if(!e.isExpandable())return;if(this.queuedRowIds.has(e.id)){this.queuedRowIds.delete(e.id),e.setExpanded(!0);return}const t=this.gos.getCallback("isServerSideGroupOpenByDefault");if(!t)return;const i={data:e.data,rowNode:e};t(i)&&e.setExpanded(!0)}expandRows(e){e.forEach(t=>{const i=this.serverSideRowModel.getRowNode(t);i?i.setExpanded(!0):this.queuedRowIds.add(t)})}expandAll(e){this.serverSideRowModel.expandAll(e)}onGroupExpandedOrCollapsed(){}dispatchExpandedEvent(e){this.eventSvc.dispatchEvent(e),this.beans.rowRenderer.refreshCells({rowNodes:[e.node]})}},LS=class extends m.BeanStub{constructor(e){super(),this.selectionCtx=e,this.selectedState={selectAll:!1,toggledNodes:new Set},this.selectAllUsed=!1,this.selectedNodes={}}getSelectedState(){return{selectAll:this.selectedState.selectAll,toggledNodes:[...this.selectedState.toggledNodes]}}setSelectedState(e){if(typeof e!="object"){(0,m._error)(116);return}if(!("selectAll"in e)){(0,m._error)(116);return}if(typeof e.selectAll!="boolean"){(0,m._error)(117);return}if(!("toggledNodes"in e)||!Array.isArray(e.toggledNodes))return(0,m._warn)(197);const t={selectAll:e.selectAll,toggledNodes:new Set};e.toggledNodes.forEach(s=>{typeof s=="string"?t.toggledNodes.add(s):(0,m._warn)(196,{key:s})});const i=t.selectAll||t.toggledNodes.size>1;if((0,m._isUsingNewRowSelectionAPI)(this.gos)&&!(0,m._isMultiRowSelection)(this.gos)&&i){(0,m._warn)(130);return}this.selectedState=t}deleteSelectionStateFromParent(e,t){if(this.selectedState.toggledNodes.size===0)return!1;let i=!1;return t.forEach(s=>{this.selectedState.toggledNodes.delete(s)&&(i=!0)}),i}setNodesSelected(e){const{nodes:t,clearSelection:i,newValue:s,source:n}=e;if(t.length===0)return 0;const a=i&&s;if(!(0,m._isMultiRowSelection)(this.gos)||a){if(t.length>1)return(0,m._error)(130),0;const o=t[0],l=o.footer?o.sibling:o;return s&&l.selectable?(this.selectedNodes={[l.id]:l},this.selectedState={selectAll:!1,toggledNodes:new Set([l.id])}):(this.selectedNodes={},this.selectedState={selectAll:!1,toggledNodes:new Set}),1}const r=(o,l=s)=>{const c=o.footer?o.sibling:o;l&&c.selectable?this.selectedNodes[c.id]=c:delete this.selectedNodes[c.id],l===this.selectedState.selectAll||!c.selectable?this.selectedState.toggledNodes.delete(c.id):this.selectedState.toggledNodes.add(c.id)};return t.forEach(o=>r(o)),t.length===1&&n==="api"&&this.selectionCtx.setRoot(t[0].footer?t[0].sibling:t[0]),1}processNewRow(e){this.selectedNodes[e.id]&&(this.selectedNodes[e.id]=e)}isNodeSelected(e){const t=this.selectedState.toggledNodes.has(e.id);return this.selectedState.selectAll?!t:t}getSelectedNodes(e=!1,t=!0){const{selectedState:{selectAll:i},selectedNodes:s,selectAllUsed:n}=this;return t&&n&&(0,m._warn)(199),e&&i?null:Object.values(s)}getSelectedRows(){var e;return((e=this.getSelectedNodes())!=null?e:[]).map(t=>t.data)}getSelectionCount(){return this.selectedState.selectAll?-1:this.selectedState.toggledNodes.size}isEmpty(){var e;return!this.selectedState.selectAll&&!((e=this.selectedState.toggledNodes)!=null&&e.size)}selectAllRowNodes(){this.reset(!0)}deselectAllRowNodes(){this.reset(!1)}reset(e){this.selectedState={selectAll:e,toggledNodes:new Set},this.selectedNodes={},this.selectAllUsed||(this.selectAllUsed=e)}getSelectAllState(){return this.selectedState.selectAll?this.selectedState.toggledNodes.size>0?null:!0:this.selectedState.toggledNodes.size>0?null:!1}},Xm=class extends m.BeanStub{constructor(e){super(),this.selectionCtx=e,this.selectedState={selectAllChildren:!1,toggledNodes:new Map}}wireBeans(e){this.rowModel=e.rowModel,this.rowGroupColsSvc=e.rowGroupColsSvc,this.filterManager=e.filterManager,this.selectionSvc=e.selectionSvc}postConstruct(){this.addManagedEventListeners({modelUpdated:()=>this.removeRedundantState(),columnRowGroupChanged:()=>this.selectionSvc.reset("rowGroupChanged")})}getSelectedState(){const{gos:e,rowGroupColsSvc:t,selectedState:i}=this,s=e.get("treeData"),n=(a,r,o)=>{const l={nodeId:o};if((s||t&&r<=t.columns.length)&&(l.selectAllChildren=a.selectAllChildren),a.toggledNodes.size){const c=[];a.toggledNodes.forEach((h,d)=>{const u=n(h,r+1,d);c.push(u)}),l.toggledNodes=c}return l};return n(i,0)}setSelectedState(e){if("selectAll"in e){(0,m._error)(111);return}const t=(i,s)=>{var o,l;if(typeof i!="object")throw(0,m._error)(243),new Error;if("selectAllChildren"in i&&typeof i.selectAllChildren!="boolean")throw(0,m._error)(244),new Error;if("toggledNodes"in i){if(!Array.isArray(i.toggledNodes))throw(0,m._error)(245),new Error;if(!i.toggledNodes.every(h=>typeof h=="object"&&"nodeId"in h&&typeof h.nodeId=="string"))throw(0,m._error)(246),new Error}const n=(o=i.selectAllChildren)!=null?o:!s,a=(l=i.toggledNodes)==null?void 0:l.map(c=>[c.nodeId,t(c,n)]);if(a==null?void 0:a.some(([,c])=>n===c.selectAllChildren&&c.toggledNodes.size===0))throw(0,m._error)(247),new Error;return{selectAllChildren:n,toggledNodes:new Map(a)}};try{this.selectedState=t(e,!!e.selectAllChildren)}catch(i){}}deleteSelectionStateFromParent(e,t){let i=this.selectedState;const s=[...e];for(;i&&s.length;)i=i.toggledNodes.get(s.pop());if(!i)return!1;let n=!1;return t.forEach(a=>{i!=null&&i.toggledNodes.delete(a)&&(n=!0)}),n&&this.removeRedundantState(),n}setNodesSelected({nodes:e,newValue:t,clearSelection:i,source:s}){if(e.length===0)return 0;const n=i&&t;if(!(0,m._isMultiRowSelection)(this.gos)||n){if(e.length>1)return(0,m._error)(130),0;this.deselectAllRowNodes()}return e.forEach(a=>{const r=a.footer?a.sibling:a,o=this.getRouteToNode(r);this.recursivelySelectNode(o,this.selectedState,t)}),this.removeRedundantState(),e.length===1&&s==="api"&&this.selectionCtx.setRoot(e[0].footer?e[0].sibling:e[0]),1}isNodeSelected(e){const t=this.getRouteToNode(e);return this.isNodePathSelected(t,this.selectedState)}isNodePathSelected([e,...t],i){if(t.length===0){const s=i.toggledNodes.has(e.id);if(e.hasChildren()){const n=i.toggledNodes.get(e.id);if(n&&n.toggledNodes.size)return}return i.selectAllChildren?!s:s}if(i.toggledNodes.has(e.id)){const s=i.toggledNodes.get(e.id);if(s)return this.isNodePathSelected(t,s)}return i.selectAllChildren}getRouteToNode(e){const t=[];let i=e;for(;i.parent;)t.push(i),i=i.parent;return t.reverse()}removeRedundantState(){var t;if((t=this.filterManager)!=null&&t.isAnyFilterPresent())return;const e=(i=this.selectedState,s,n)=>{if(i.toggledNodes.forEach((o,l)=>{e(o,l,i)}),s){const o=this.rowModel.getRowNode(s),l=o==null?void 0:o.childStore;if((l==null?void 0:l.isLastRowIndexKnown())&&i.toggledNodes.size>=l.getRowCount()){for(const d of i.toggledNodes.entries()){const[u,p]=d;if(p.toggledNodes.size>0||!this.rowModel.getRowNode(u))return}i.selectAllChildren=!i.selectAllChildren,i.toggledNodes.clear()}}const a=i.toggledNodes.size===0,r=(n==null?void 0:n.selectAllChildren)===i.selectAllChildren;a&&r&&(n==null||n.toggledNodes.delete(s))};e()}recursivelySelectNode([e,...t],i,s){var o;if(!e)return;if(!t.length){const l=e.selectable;if(i.selectAllChildren===s||!l){i.toggledNodes.delete(e.id);return}const h={selectAllChildren:s,toggledNodes:new Map};i.toggledNodes.set(e.id,h);return}const a=i.toggledNodes.has(e.id),r=(o=i.toggledNodes.get(e.id))!=null?o:{selectAllChildren:i.selectAllChildren,toggledNodes:new Map};a||i.toggledNodes.set(e.id,r),this.recursivelySelectNode(t,r,s),i.selectAllChildren===r.selectAllChildren&&r.toggledNodes.size===0&&i.toggledNodes.delete(e.id)}getSelectedNodes(e=!1){if((0,m._warn)(202),this.selectedState.selectAllChildren&&e)return null;const t=[];return this.rowModel.forEachNode(i=>{i.isSelected()&&t.push(i)}),t}processNewRow(){}getSelectedRows(){var e,t;return(t=(e=this.getSelectedNodes())==null?void 0:e.map(i=>i.data))!=null?t:[]}getSelectionCount(){return-1}isEmpty(){var e;return!this.selectedState.selectAllChildren&&!((e=this.selectedState.toggledNodes)!=null&&e.size)}selectAllRowNodes(){this.reset(!0)}deselectAllRowNodes(){this.reset(!1)}reset(e){this.selectedState={selectAllChildren:e,toggledNodes:new Map}}getSelectAllState(){return this.selectedState.selectAllChildren?this.selectedState.toggledNodes.size>0?null:!0:this.selectedState.toggledNodes.size>0?null:!1}},J9=class extends m.BaseSelectionService{constructor(){super(...arguments),this.beanName="selectionSvc"}postConstruct(){super.postConstruct(),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{const i=(0,m._getGroupSelectsDescendants)(this.gos),s=i&&this.selectionStrategy instanceof LS?Xm:!i&&this.selectionStrategy instanceof Xm?LS:void 0;s&&(this.destroyBean(this.selectionStrategy),this.selectionStrategy=this.createManagedBean(new s(this.selectionCtx)),this.shotgunResetNodeSelectionState(),this.dispatchSelectionChanged("api"))}),this.addManagedPropertyListeners(["rowSelection"],()=>{const i=(0,m._getRowSelectionMode)(this.gos);i!==this.selectionMode&&(this.selectionMode=i,this.deselectAllRowNodes({source:"api"}))}),this.selectionMode=(0,m._getRowSelectionMode)(this.gos);const t=(0,m._getGroupSelectsDescendants)(this.gos)?Xm:LS;this.selectionStrategy=this.createManagedBean(new t(this.selectionCtx))}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;let s=0;const n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);return n==null?0:(this.selectionCtx.selectAll=!1,"select"in n?(n.reset?this.selectionStrategy.deselectAllRowNodes({source:"api"}):this.selectionStrategy.setNodesSelected({nodes:n.deselect,newValue:!1,source:i}),s=this.selectionStrategy.setNodesSelected({nodes:n.select,newValue:!0,source:i})):s=this.selectionStrategy.setNodesSelected({nodes:[n.node],newValue:n.newValue,clearSelection:n.clearSelection,event:e,source:i}),this.shotgunResetNodeSelectionState(i),this.dispatchSelectionChanged(i),s)}getSelectionState(){return this.selectionStrategy.getSelectedState()}setSelectionState(e,t){if(!(0,m._isRowSelection)(this.gos)){(0,m._warn)(132);return}Array.isArray(e)||(this.selectionStrategy.setSelectedState(e),this.shotgunResetNodeSelectionState(),this.dispatchSelectionChanged(t))}setNodesSelected(e){if(!(0,m._isRowSelection)(this.gos)&&e.newValue)return(0,m._warn)(132),0;const a=e,{nodes:t}=a,i=We(a,["nodes"]);if(t.length>1&&this.selectionMode!=="multiRow")return(0,m._warn)(130),0;const s=b({nodes:t.filter(r=>r.selectable)},i);if(!s.nodes.length)return 0;const n=this.selectionStrategy.setNodesSelected(s);return this.shotgunResetNodeSelectionState(s.source),this.dispatchSelectionChanged(s.source),n}deleteSelectionStateFromParent(e,t){this.selectionStrategy.deleteSelectionStateFromParent(e,t)&&(this.shotgunResetNodeSelectionState(),this.dispatchSelectionChanged("api"))}shotgunResetNodeSelectionState(e){this.beans.rowModel.forEachNode(t=>{if(t.stub)return;const i=this.selectionStrategy.isNodeSelected(t);i!==t.isSelected()&&this.selectRowNode(t,i,void 0,e)})}getSelectedNodes(){var e;return(e=this.selectionStrategy.getSelectedNodes())!=null?e:[]}getSelectedRows(){return this.selectionStrategy.getSelectedRows()}getSelectionCount(){return this.selectionStrategy.getSelectionCount()}syncInRowNode(e){this.selectionStrategy.processNewRow(e);const t=this.selectionStrategy.isNodeSelected(e);if(t!=!1&&!e.selectable){this.selectionStrategy.setNodesSelected({nodes:[e],newValue:!1,source:"api"}),this.shotgunResetNodeSelectionState(),this.dispatchSelectionChanged("api");return}e.__selected=t}reset(){this.selectionStrategy.deselectAllRowNodes({source:"api"}),this.selectionCtx.reset()}isEmpty(){return this.selectionStrategy.isEmpty()}hasNodesToSelect(){return!0}selectAllRowNodes(e){if(!(0,m._isRowSelection)(this.gos)){(0,m._warn)(132);return}if(UL(e),(0,m._isUsingNewRowSelectionAPI)(this.gos)&&!(0,m._isMultiRowSelection)(this.gos))return(0,m._warn)(130);this.selectionStrategy.selectAllRowNodes(e),this.selectionCtx.selectAll=!0,this.beans.rowModel.forEachNode(t=>{t.stub||this.selectRowNode(t,!0,void 0,e.source)}),this.dispatchSelectionChanged(e.source)}deselectAllRowNodes(e){UL(e),this.selectionStrategy.deselectAllRowNodes(e),this.selectionCtx.selectAll=!1,this.beans.rowModel.forEachNode(t=>{t.stub||this.selectRowNode(t,!1,void 0,e.source)}),this.dispatchSelectionChanged(e.source)}getSelectAllState(e){return this.selectionStrategy.getSelectAllState(e)}getBestCostNodeSelection(){return(0,m._warn)(194,{method:"getBestCostNodeSelection"})}updateSelectable(){if(!(0,m._isRowSelection)(this.gos))return;const e=[];this.beans.rowModel.forEachNode(t=>{!this.updateRowSelectable(t,!0)&&t.isSelected()&&e.push(t)}),e.length&&this.setNodesSelected({nodes:e,newValue:!1,source:"selectableChanged"})}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.selectionStrategy instanceof Xm?null:this.selectionStrategy.getSelectedNodes(!0,!1),serverSideState:this.getSelectionState()})}updateSelectableAfterGrouping(){return(0,m._error)(194,{method:"updateSelectableAfterGrouping"})}refreshMasterNodeState(){}setDetailSelectionState(){}};function UL({selectAll:e}){(e==="filtered"||e==="currentPage")&&(0,m._warn)(195,{justCurrentPage:e==="currentPage"})}var e8=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="rowChildrenSvc"}getHasChildrenValue(e){const t=this.gos.get("treeData"),i=this.gos.get("isServerSideGroup");return!e.stub&&!e.footer&&(t?!!i&&i(e.data):!!e.group)}},t8=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="lazyBlockLoadingSvc",this.outboundRequests=0,this.cacheLoadingNodesMap=new Map,this.isCheckQueued=!1,this.nextBlockToLoad=void 0}wireBeans(e){this.rowRenderer=e.rowRenderer,this.rowModel=e.rowModel}postConstruct(){this.maxOutboundRequests=(0,m._getMaxConcurrentDatasourceRequests)(this.gos)}subscribe(e){this.cacheLoadingNodesMap.set(e,new Set)}unsubscribe(e){this.cacheLoadingNodesMap.delete(e)}queueLoadCheck(){this.isCheckQueued||(this.isCheckQueued=!0,setTimeout(()=>{this.queueLoadAction(),this.isCheckQueued=!1}))}onLoadComplete(){this.outboundRequests-=1,this.queueLoadCheck()}hasAvailableLoadBandwidth(){return this.maxOutboundRequests===void 0?!0:this.outboundRequests<this.maxOutboundRequests}queueLoadAction(){const e=this.getBlockToLoad();if(!e)return;const t=this.nextBlockToLoad&&this.nextBlockToLoad.cache===e.cache&&this.nextBlockToLoad.index===e.index;if(!t&&(!this.nextBlockToLoad||!t)){this.nextBlockToLoad=e,window.clearTimeout(this.loaderTimeout);const i=Number(this.nextBlockToLoad.index),s=this.nextBlockToLoad.cache,n=e.index+e.cache.getBlockSize();this.loaderTimeout=window.setTimeout(()=>{s.isAlive()&&(this.loaderTimeout=void 0,this.attemptLoad(s,i,n),this.nextBlockToLoad=void 0)},this.gos.get("blockLoadDebounceMillis"))}}attemptLoad(e,t,i){this.hasAvailableLoadBandwidth()&&(this.executeLoad(e,t,i),this.queueLoadCheck())}executeLoad(e,t,i){var d,u;const s=e.getSsrmParams(),n={startRow:t,endRow:i,rowGroupCols:s.rowGroupCols,valueCols:s.valueCols,pivotCols:s.pivotCols,pivotMode:s.pivotMode,groupKeys:(d=e.store.getParentNode().getRoute())!=null?d:[],filterModel:s.filterModel,sortModel:s.sortModel},a=this.cacheLoadingNodesMap.get(e),r=()=>{for(let p=0;p<i-t;p++)a.delete(t+p)},o=()=>{for(let p=0;p<i-t;p++)a.add(t+p)},l=p=>{this.onLoadComplete(),e.onLoadSuccess(t,i-t,p),r()},c=()=>{this.onLoadComplete(),e.onLoadFailed(t,i-t),r()},h=(0,m._addGridCommonParams)(this.gos,{request:n,success:l,fail:c,parentNode:e.store.getParentNode()});o(),this.outboundRequests+=1,(u=e.getSsrmParams().datasource)==null||u.getRows(h)}getBlockToLoad(){var o,l;const e=this.rowRenderer.firstRenderedRow,t=this.rowRenderer.lastRenderedRow;for(let c=e;c<=t;c++){const h=this.rowModel.getRow(c);if(!h)continue;const d=(o=h.parent)==null?void 0:o.childStore;if(!d)continue;const u=d.getCache(),p=u.getNodes().getBy("node",h);if(!p)continue;const g=this.cacheLoadingNodesMap.get(u);if(!(g!=null&&g.has(p.index))&&(h.__needsRefreshWhenVisible||h.stub&&!h.failedLoad))return{cache:u,index:u.getBlockStartIndex(p.index)}}let i=null,s=null,n=Number.MAX_SAFE_INTEGER;for(const c of this.cacheLoadingNodesMap.keys())c.getNodesToRefresh().forEach(d=>{if(d.rowIndex==null){s=d,i=c;return}const u=c.getNodes().getBy("node",d);if(!u)return;const p=this.cacheLoadingNodesMap.get(c);if(p!=null&&p.has(u.index))return;const g=Math.abs(e-d.rowIndex),f=Math.abs(d.rowIndex-t);g<n&&(s=d,n=g,i=c),f<n&&(s=d,n=f,i=c)});if(!i)return;const a=i,r=(l=a.getNodes().getBy("node",s))==null?void 0:l.index;return r==null?void 0:{cache:a,index:a.getBlockStartIndex(r)}}isRowLoading(e,t){var i,s;return(s=(i=this.cacheLoadingNodesMap.get(e))==null?void 0:i.has(t))!=null?s:!1}},i8=class{constructor(...e){this.indexes=e,this.maps=new Map(this.indexes.map(t=>[t,new Map]))}getSize(){return this.maps.get(this.indexes[0]).size}getBy(e,t){return this.maps.get(e).get(t)}set(e){this.indexes.forEach(t=>{this.maps.get(t).set(e[t],e)})}delete(e){this.indexes.forEach(t=>{this.maps.get(t).delete(e[t])})}clear(){this.maps.forEach(e=>e.clear())}getIterator(e){return this.maps.get(e).values()}forEach(e){const t=this.getIterator(this.indexes[0]);let i;for(;(i=t.next())&&!i.done;)e(i.value)}find(e){const t=this.getIterator(this.indexes[0]);let i;for(;(i=t.next())&&!i.done;)if(e(i.value))return i.value}filter(e){const t=this.getIterator(this.indexes[0]);let i;const s=[];for(;(i=t.next())&&!i.done;)e(i.value)&&s.push(i.value);return s}},s8=100,PS=class extends m.BeanStub{constructor(e,t,i,s){super(),this.live=!0,this.removedNodeCache=new Map,this.store=e,this.numberOfRows=t,this.isLastRowKnown=i,this.storeParams=s}wireBeans(e){this.rowRenderer=e.rowRenderer,this.blockUtils=e.ssrmBlockUtils,this.focusSvc=e.focusSvc,this.nodeManager=e.ssrmNodeManager,this.serverSideRowModel=e.rowModel,this.rowNodeSorter=e.rowNodeSorter,this.sortSvc=e.sortSvc,this.lazyBlockLoadingSvc=e.lazyBlockLoadingSvc,this.colModel=e.colModel}postConstruct(){this.lazyBlockLoadingSvc.subscribe(this),this.nodeMap=new i8("index","id","node"),this.nodeDisplayIndexMap=new Map,this.nodesToRefresh=new Set,this.defaultNodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),this.getRowIdFunc=(0,m._getRowIdCallback)(this.gos),this.isMasterDetail=this.gos.get("masterDetail")}destroy(){this.lazyBlockLoadingSvc.unsubscribe(this),this.numberOfRows=0,this.nodeMap.forEach(e=>this.blockUtils.destroyRowNode(e.node)),this.nodeMap.clear(),this.nodeDisplayIndexMap.clear(),this.nodesToRefresh.clear(),this.live=!1,super.destroy()}getRowByDisplayIndex(e){var l,c,h,d,u;if(!this.store.isDisplayIndexInStore(e))return;const t=this.nodeDisplayIndexMap.get(e);if(t)return(t.stub||t.__needsRefreshWhenVisible)&&this.lazyBlockLoadingSvc.queueLoadCheck(),t;if(this.gos.get("groupHideOpenParents")||this.gos.get("groupAllowUnbalanced")){const p=this.nodeMap.find(g=>{var f;return!!((f=g.node.childStore)!=null&&f.isDisplayIndexInStore(e))});if(p)return(l=p.node.childStore)==null?void 0:l.getRowUsingDisplayIndex(e)}if(e===this.store.getDisplayIndexStart())return this.createStubNode(0,e);const s=this.nodeDisplayIndexMap.get(e-1);if(s){if(this.isMasterDetail&&s.master&&s.expanded)return s.detailNode;if(s.expanded&&((c=s.childStore)!=null&&c.isDisplayIndexInStore(e)))return(h=s.childStore)==null?void 0:h.getRowUsingDisplayIndex(e);const p=this.nodeMap.getBy("node",s);return this.createStubNode(p.index+1,e)}const n=this.getSurroundingNodesByDisplayIndex(e);if(n==null){const p=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(p,e)}const{previousNode:a,nextNode:r}=n;if(a&&a.node.expanded&&((d=a.node.childStore)!=null&&d.isDisplayIndexInStore(e)))return(u=a.node.childStore)==null?void 0:u.getRowUsingDisplayIndex(e);if(r){const p=r.node.rowIndex-e,g=r.index-p;return this.createStubNode(g,e)}const o=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(o,e)}createStubNode(e,t){const i=this.store.getRowBounds(t),s=this.createRowAtIndex(e,null,n=>{n.setRowIndex(t),n.setRowTop(i.rowTop),this.nodeDisplayIndexMap.set(t,n)});if(e===0&&this.gos.get("groupHideOpenParents")){const n=this.store.getParentNode().groupData;if(n)for(const a of Object.keys(n))Bk(s,this.colModel,a,n[a])}return this.lazyBlockLoadingSvc.queueLoadCheck(),s}getRowByStoreIndex(e){var t;return(t=this.nodeMap.getBy("index",e))==null?void 0:t.node}skipDisplayIndexes(e,t,i){if(e===0)return;const s=(0,m._getRowHeightAsNumber)(this.beans);t.value+=e,i.value+=e*s}setDisplayIndexes(e,t,i){this.nodeDisplayIndexMap.clear();const s={};this.nodeMap.forEach(r=>{s[r.index]=r.node});let n=-1;for(const r of Object.keys(s)){const o=s[r],l=Number(r),c=l-1-n;this.skipDisplayIndexes(c,e,t);const h=l===0;if(o.setFirstChild(h),h&&this.gos.get("groupHideOpenParents")){const d=this.store.getParentNode().groupData;if(d)for(const u of Object.keys(d))Bk(o,this.colModel,u,h?d[u]:void 0)}this.blockUtils.setDisplayIndex(o,e,t,i),o.rowIndex!=null&&this.nodeDisplayIndexMap.set(o.rowIndex,o),n=l}const a=this.numberOfRows-1-n;this.skipDisplayIndexes(a,e,t),this.purgeExcessRows()}getRowCount(){return this.numberOfRows}setRowCount(e,t){this.numberOfRows=e,t!=null&&(this.isLastRowKnown=t,t===!1&&(this.numberOfRows+=1)),this.fireStoreUpdatedEvent()}getNodes(){return this.nodeMap}getNodeCachedByDisplayIndex(e){var t;return(t=this.nodeDisplayIndexMap.get(e))!=null?t:null}getNodesToRefresh(){return this.nodesToRefresh}getSurroundingNodesByDisplayIndex(e){let t,i;return this.nodeMap.forEach(s=>{if(e>s.node.rowIndex){(i==null||i.node.rowIndex<s.node.rowIndex)&&(i=s);return}if(t==null||t.node.rowIndex>s.node.rowIndex){t=s;return}}),!i&&!t?null:{previousNode:i,nextNode:t}}getDisplayIndexFromStoreIndex(e){var r,o;const t=this.nodeMap.getBy("index",e);if(t)return t.node.rowIndex;let i,s;if(this.nodeMap.forEach(l=>{if(e>l.index){(s==null||s.index<l.index)&&(s=l);return}if(i==null||i.index>l.index){i=l;return}}),!i)return this.store.getDisplayIndexEnd()-(this.numberOfRows-e);if(!s)return this.store.getDisplayIndexStart()+e;const n=e-s.index;return((o=(r=s.node.childStore)==null?void 0:r.getDisplayIndexEnd())!=null?o:s.node.rowIndex)+n}createRowAtIndex(e,t,i){var a,r;const s=this.nodeMap.getBy("index",e);if(s){const{node:o}=s;if(o.__needsRefreshWhenVisible=!1,this.doesNodeMatch(t,o))return this.blockUtils.updateDataIntoRowNode(o,t),this.nodesToRefresh.delete(o),o;if(this.getRowIdFunc==null&&o.hasChildren()&&o.expanded)return this.nodesToRefresh.delete(o),o;this.destroyRowAtIndex(e)}if(t&&this.getRowIdFunc!=null){const o=this.getRowId(t),l=o&&((a=this.removedNodeCache)==null?void 0:a.get(o));if(l)return(r=this.removedNodeCache)==null||r.delete(o),this.blockUtils.updateDataIntoRowNode(l,t),this.nodeMap.set({id:l.id,node:l,index:e}),this.nodesToRefresh.delete(l),l.__needsRefreshWhenVisible=!1,l;const c=this.nodeMap.getBy("id",o);if(c){this.nodeMap.delete(c);const{node:h,index:d}=c;return this.blockUtils.updateDataIntoRowNode(h,t),this.nodeMap.set({id:h.id,node:h,index:e}),this.nodesToRefresh.delete(h),h.__needsRefreshWhenVisible=!1,this.getBlockStartIndex(d)===this.getBlockStartIndex(e)||this.markBlockForVerify(d),h}}const n=this.blockUtils.createRowNode(this.store.getRowDetails());if(t!=null){const o=this.getPrefixedId(this.store.getIdSequence().value++);this.blockUtils.setDataIntoRowNode(n,t,o,void 0),this.serverSideRowModel.setPaused(!0),this.blockUtils.checkOpenByDefault(n),this.serverSideRowModel.setPaused(!1),this.nodeManager.addRowNode(n)}return this.nodeMap.set({id:n.id,node:n,index:e}),i&&i(n),n}getBlockStates(){var a;const e={},t={};this.nodeMap.forEach(({node:r,index:o})=>{var h;const l=this.getBlockStartIndex(o);!r.stub&&!r.failedLoad&&(e[l]=((h=e[l])!=null?h:0)+1);let c="loaded";r.failedLoad?c="failed":this.lazyBlockLoadingSvc.isRowLoading(this,l)?c="loading":(this.nodesToRefresh.has(r)||r.stub)&&(c="needsLoading"),t[l]||(t[l]=new Set),t[l].add(c)});const i={loading:4,failed:3,needsLoading:2,loaded:1},s=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),n={};for(const r of Object.keys(t)){const l=[...t[r]].sort((d,u)=>{var p,g;return((p=i[d])!=null?p:0)-((g=i[u])!=null?g:0)})[0],c=Number(r)/this.getBlockSize(),h=s?`${s}-${c}`:String(c);n[h]={blockNumber:c,startRow:Number(r),endRow:Number(r)+this.getBlockSize(),pageStatus:l,loadedRowCount:(a=e[r])!=null?a:0}}return n}destroyRowAtIndex(e){const t=this.nodeMap.getBy("index",e);t&&(this.nodeMap.delete(t),this.nodeDisplayIndexMap.delete(t.node.rowIndex),this.nodesToRefresh.size>0?this.removedNodeCache.set(t.node.id,t.node):this.blockUtils.destroyRowNode(t.node),this.nodesToRefresh.delete(t.node))}getSsrmParams(){return this.store.getSsrmParams()}getPrefixedId(e){return this.defaultNodeIdPrefix?this.defaultNodeIdPrefix+"-"+e:e.toString()}markBlockForVerify(e){const[t,i]=this.getBlockBounds(e);this.nodeMap.filter(n=>n.index>=t&&n.index<i).forEach(({node:n})=>{n.__needsRefreshWhenVisible=!0})}doesNodeMatch(e,t){if(t.stub)return!1;const i=this.getRowId(e);return i===null?t.data===e:t.id===i}purgeStubsOutsideOfViewport(){const{firstRenderedRow:e,lastRenderedRow:t}=this.rowRenderer,i=this.getBlockStartIndex(e),[,s]=this.getBlockBounds(t);this.nodeMap.forEach(n=>{this.lazyBlockLoadingSvc.isRowLoading(this,n.index)||n.node.failedLoad||n.node.stub&&(n.index<i||n.index>s)&&this.destroyRowAtIndex(n.index)})}getBlocksDistanceFromRow(e,t){const i={};return e.forEach(({node:s,index:n})=>{const[a,r]=this.getBlockBounds(n);if(a in i)return;const o=Math.abs(s.rowIndex-t);let l;const c=this.nodeMap.getBy("index",[r-1]);c&&(l=Math.abs(c.node.rowIndex-t));const h=l==null||o<l?o:l;i[a]=h}),Object.entries(i)}purgeExcessRows(){var p;if(this.purgeStubsOutsideOfViewport(),this.store.getDisplayIndexEnd()==null||this.storeParams.maxBlocksInCache==null)return;const{firstRenderedRow:e,lastRenderedRow:t}=this.rowRenderer,i=new Set,s=new Set;this.nodeMap.forEach(({index:g,node:f})=>{const y=this.getBlockStartIndex(g);i.add(y),f.rowIndex>=e&&f.rowIndex<=t&&s.add(y)});const n=Math.max(s.size,(p=this.storeParams.maxBlocksInCache)!=null?p:0),r=i.size-n;if(r<=0)return;let o=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;s.forEach(g=>{o>g&&(o=g),l<g&&(l=g)});const c=this.nodeMap.filter(({node:g,index:f})=>{const y=this.getBlockStartIndex(f);return!(y>=o&&y<=l)&&!this.isNodeCached(g)});if(c.length===0)return;const h=e+(t-e)/2,d=this.getBlocksDistanceFromRow(c,h),u=this.getBlockSize();d.sort((g,f)=>Math.sign(f[1]-g[1]));for(let g=0;g<Math.min(r,d.length);g++){const f=Number(d[g][0]);for(let y=f;y<f+u;y++){const v=this.nodeMap.getBy("index",y);!v||this.isNodeCached(v.node)||this.destroyRowAtIndex(y)}}}isNodeFocused(e){const t=this.focusSvc.getFocusCellToUseAfterRefresh();return!t||t.rowPinned!=null?!1:t.rowIndex===e.rowIndex}isNodeCached(e){const t=this.gos.get("groupAllowUnbalanced")&&e.key==="";return e.isExpandable()&&e.expanded||this.isNodeFocused(e)||t}extractDuplicateIds(e){if(this.getRowIdFunc==null)return[];const t=new Set,i=new Set;return e.forEach(s=>{const n=this.getRowId(s);if(t.has(n)){i.add(n);return}t.add(n)}),[...i]}onLoadSuccess(e,t,i){if(!this.live)return;const s=i.groupLevelInfo;if(this.store.setStoreInfo(s),this.getRowIdFunc!=null){const r=this.extractDuplicateIds(i.rowData);if(r.length>0){const o=r.join(", ");(0,m._warn)(205,{duplicateIdText:o}),this.onLoadFailed(e,t);return}}i.pivotResultFields&&this.serverSideRowModel.generateSecondaryColumns(i.pivotResultFields);const n=this.nodesToRefresh.size>0;if(i.rowData.forEach((r,o)=>{var h;const l=e+o,c=this.nodeMap.getBy("index",l);if((h=c==null?void 0:c.node)!=null&&h.stub){this.createRowAtIndex(l,r);return}if(c&&this.doesNodeMatch(r,c.node)){this.blockUtils.updateDataIntoRowNode(c.node,r),this.nodesToRefresh.delete(c.node),c.node.__needsRefreshWhenVisible=!1;return}this.createRowAtIndex(l,r)}),i.rowCount!=null&&i.rowCount!==-1)this.numberOfRows=i.rowCount,this.isLastRowKnown=!0;else if(t>i.rowData.length)this.numberOfRows=e+i.rowData.length,this.isLastRowKnown=!0;else if(!this.isLastRowKnown){const r=e+i.rowData.length+1;r>this.numberOfRows&&(this.numberOfRows=r)}this.isLastRowKnown&&this.nodeMap.filter(o=>o.index>=this.numberOfRows).forEach(o=>this.destroyRowAtIndex(o.index)),this.fireStoreUpdatedEvent();const a=this.nodesToRefresh.size===0;n&&a&&this.fireRefreshFinishedEvent()}fireRefreshFinishedEvent(){this.nodesToRefresh.size===0&&(this.removedNodeCache.forEach(t=>{this.blockUtils.destroyRowNode(t)}),this.removedNodeCache=new Map,this.store.fireRefreshFinishedEvent())}isStoreFullyLoaded(){const e=this.isLastRowKnown,t=this.nodeMap.getSize()===this.numberOfRows;if(!e||!t||this.nodesToRefresh.size>0)return;let i=-1;return this.nodeMap.find(n=>(i+=1,!!(n.index!==i||n.node.__needsRefreshWhenVisible||n.node.stub)))==null}isLastRowIndexKnown(){return this.isLastRowKnown}onLoadFailed(e,t){var n;if(!this.live)return;const i=this.nodesToRefresh.size>0;for(let a=e;a<e+t&&a<this.getRowCount();a++){let{node:r}=(n=this.nodeMap.getBy("index",a))!=null?n:{};r&&this.nodesToRefresh.delete(r),(!r||!r.stub)&&(r&&!r.stub&&this.destroyRowAtIndex(a),r=this.createRowAtIndex(a)),r.__needsRefreshWhenVisible=!1,r.failedLoad=!0}const s=this.nodesToRefresh.size===0;i&&s&&this.fireRefreshFinishedEvent(),this.fireStoreUpdatedEvent()}markNodesForRefresh(){this.nodeMap.forEach(e=>{e.node.stub&&!e.node.failedLoad||this.nodesToRefresh.add(e.node)}),this.lazyBlockLoadingSvc.queueLoadCheck(),this.isLastRowKnown&&this.numberOfRows===0&&(this.numberOfRows=1,this.isLastRowKnown=!1,this.fireStoreUpdatedEvent())}isNodeInCache(e){return!!this.nodeMap.getBy("id",e)}fireStoreUpdatedEvent(){this.live&&this.store.fireStoreUpdatedEvent()}getRowId(e){var s;if(this.getRowIdFunc==null)return null;const{level:t}=this.store.getRowDetails(),i=(s=this.store.getParentNode().getRoute())!=null?s:[];return this.getRowIdFunc({data:e,parentKeys:i.length>0?i:void 0,level:t})}getOrderedNodeMap(){const e={};return this.nodeMap.forEach(t=>e[t.index]=t),e}clearDisplayIndexes(){this.nodeDisplayIndexMap.clear()}clientSideSortRows(){var n,a;const e=(a=(n=this.sortSvc)==null?void 0:n.getSortOptions())!=null?a:[];if(!e.some(r=>r.sort!=null)||!this.rowNodeSorter)return;const i=new Array(this.nodeMap.getSize());this.nodeMap.forEach(r=>i[r.index]=r.node),this.nodeMap.clear(),this.rowNodeSorter.doFullSort(i,e).forEach((r,o)=>{this.nodeMap.set({id:r.id,node:r,index:o})})}updateRowNodes(e){const t=[];return e.forEach(i=>{const s=this.getRowId(i),n=this.nodeMap.getBy("id",s);n&&(this.blockUtils.updateDataIntoRowNode(n.node,i),t.push(n.node))}),t}insertRowNodes(e,t){const i=this.store.getRowCount()-(this.store.getParentNode().sibling?1:0),s=t==null&&this.isLastRowKnown?i:t;if(s==null||i<s)return[];const n={};e.forEach(l=>{const c=this.getRowId(l);c&&this.isNodeInCache(c)||(n[c]=l)});const a=Object.values(n),r=a.length;if(r===0)return[];const o=this.nodeMap.filter(l=>l.index>=s);return o.forEach(l=>this.nodeMap.delete(l)),o.forEach(l=>{this.nodeMap.set({node:l.node,index:l.index+r,id:l.id})}),this.numberOfRows+=r,a.map((l,c)=>this.createRowAtIndex(s+c,l))}removeRowNodes(e){const t=[],i=[];let s=0;const n=[...e],a=this.getOrderedNodeMap();let r=-1;for(const o of Object.keys(a)){r+=1;const l=a[o],c=n.findIndex(d=>d===l.id);if(c!==-1){n.splice(c,1),this.destroyRowAtIndex(Number(o)),t.push(l.node),s+=1;continue}if(s===0)continue;const h=Number(o);r!==h&&i.push(l.node),this.nodeMap.delete(l),this.nodeMap.set({id:l.id,node:l.node,index:h-s})}return this.numberOfRows-=this.isLastRowIndexKnown()?e.length:s,n.length>0&&i.length>0&&(i.forEach(o=>o.__needsRefreshWhenVisible=!0),this.lazyBlockLoadingSvc.queueLoadCheck()),t}getBlockSize(){return this.storeParams.cacheBlockSize||s8}getBlockStartIndex(e){const t=this.getBlockSize();return e-e%t}getBlockBounds(e){const t=this.getBlockStartIndex(e),i=this.getBlockSize();return[t,t+i]}},n8=class extends m.BeanStub{constructor(e,t,i){super(),this.idSequence={value:0},this.ssrmParams=e,this.parentRowNode=i,this.storeParams=t,this.level=i.level+1,this.group=e.rowGroupCols?this.level<e.rowGroupCols.length:!1,this.leafGroup=e.rowGroupCols?this.level===e.rowGroupCols.length-1:!1,this.info={}}wireBeans(e){this.blockUtils=e.ssrmBlockUtils,this.storeUtils=e.ssrmStoreUtils,this.selectionSvc=e.selectionSvc,this.rowGroupColsSvc=e.rowGroupColsSvc}postConstruct(){var i;let e=1;if(this.level===0&&(e=(i=this.storeUtils.getServerSideInitialRowCount())!=null?i:1,this.eventSvc.dispatchEventOnce({type:"rowCountReady"})),this.cache=this.createManagedBean(new PS(this,e,!1,this.storeParams)),!this.gos.get("treeData")&&this.group&&this.rowGroupColsSvc){const s=this.ssrmParams.rowGroupCols[this.level];this.groupField=s.field,this.rowGroupColumn=this.rowGroupColsSvc.columns[this.level]}}destroy(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.destroyBean(this.cache),super.destroy()}applyRowData(e,t,i){this.cache.onLoadSuccess(t,i,e)}applyTransaction(e){var h,d,u;const t=(0,m._getRowIdCallback)(this.gos);if(!t)return(0,m._warn)(206),{status:m.ServerSideTransactionResultStatus.Cancelled};const i=this.gos.getCallback("isApplyServerSideTransaction");if(i){const p={transaction:e,parentNode:this.parentRowNode,groupLevelInfo:this.info};if(!i(p))return{status:m.ServerSideTransactionResultStatus.Cancelled}}const s=this.cache.isStoreFullyLoaded();let n;(h=e.update)!=null&&h.length&&(n=this.cache.updateRowNodes(e.update));let a;if((d=e.add)!=null&&d.length){let p=e.addIndex;p!=null&&p<0&&(p=void 0),a=this.cache.insertRowNodes(e.add,p)}let r;if((u=e.remove)!=null&&u.length){const p=e.remove.map(f=>{var y;return t({level:this.level,parentKeys:(y=this.parentRowNode.getRoute())!=null?y:[],data:f})}),g=[...new Set(p)];r=this.cache.removeRowNodes(g)}const o=this.gos.get("serverSideEnableClientSideSort"),l=(n==null?void 0:n.length)||(a==null?void 0:a.length);return s&&o&&l&&this.cache.clientSideSortRows(),this.updateSelectionAfterTransaction(n,r),{status:m.ServerSideTransactionResultStatus.Applied,update:n,add:a,remove:r}}updateSelectionAfterTransaction(e,t){if(!this.selectionSvc)return;const i=[];e==null||e.forEach(s=>{s.isSelected()&&!s.selectable&&i.push(s)}),t==null||t.forEach(s=>{s.isSelected()&&i.push(s)}),i.length&&this.selectionSvc.setNodesSelected({newValue:!1,clearSelection:!1,nodes:i,source:"rowDataChanged"})}clearDisplayIndexes(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.cache.getNodes().forEach(e=>this.blockUtils.clearDisplayIndex(e.node)),this.parentRowNode.sibling&&this.blockUtils.clearDisplayIndex(this.parentRowNode.sibling),this.cache.clearDisplayIndexes()}getDisplayIndexStart(){return this.displayIndexStart}getDisplayIndexEnd(){return this.displayIndexEnd}getRowCount(){return this.parentRowNode.sibling?this.cache.getRowCount()+1:this.cache.getRowCount()}setRowCount(e,t){this.cache.setRowCount(e,t)}isDisplayIndexInStore(e){return this.cache.getRowCount()===0?!1:this.displayIndexStart<=e&&e<this.getDisplayIndexEnd()}setDisplayIndexes(e,t,i){this.displayIndexStart=e.value,this.topPx=t.value;const s=this.parentRowNode.level>-1&&(0,m._getGroupTotalRowCallback)(this.gos)({node:this.parentRowNode});s||SS(this.parentRowNode),s==="top"&&(po(this.parentRowNode,this.beans),this.blockUtils.setDisplayIndex(this.parentRowNode.sibling,e,t,i)),this.cache.setDisplayIndexes(e,t,i),s==="bottom"&&(po(this.parentRowNode,this.beans),this.blockUtils.setDisplayIndex(this.parentRowNode.sibling,e,t,i)),this.displayIndexEnd=e.value,this.heightPx=t.value-this.topPx}forEachStoreDeep(e,t={value:0}){e(this,t.value++),this.cache.getNodes().forEach(i=>{const s=i.node.childStore;s&&s.forEachStoreDeep(e,t)})}forEachNodeDeep(e,t={value:0}){this.cache.getNodes().forEach(i=>{e(i.node,t.value++);const s=i.node.childStore;s&&s.forEachNodeDeep(e,t)})}forEachNodeDeepAfterFilterAndSort(e,t={value:0},i=!1){const s=this.parentRowNode.level>-1&&(0,m._getGroupTotalRowCallback)(this.gos)({node:this.parentRowNode});s==="top"&&e(this.parentRowNode.sibling,t.value++);const n=this.cache.getOrderedNodeMap();for(const a of Object.values(n)){e(a.node,t.value++);const r=a.node.childStore;r&&r.forEachNodeDeepAfterFilterAndSort(e,t,i)}s==="bottom"&&e(this.parentRowNode.sibling,t.value++)}retryLoads(){this.cache.getNodes().forEach(({node:e})=>{e.failedLoad&&(e.failedLoad=!1,e.__needsRefreshWhenVisible=!0,e.stub=!0)}),this.forEachChildStoreShallow(e=>e.retryLoads()),this.fireStoreUpdatedEvent()}getRowUsingDisplayIndex(e){return this.parentRowNode.sibling&&e===this.parentRowNode.sibling.rowIndex?this.parentRowNode.sibling:this.cache.getRowByDisplayIndex(e)}getRowBounds(e){var o;if(!this.isDisplayIndexInStore(e))return null;const t=this.cache.getNodeCachedByDisplayIndex(e);if(t){const l=this.blockUtils.extractRowBounds(t,e);if(l)return l}const{previousNode:i,nextNode:s}=(o=this.cache.getSurroundingNodesByDisplayIndex(e))!=null?o:{};if(i){const l=this.blockUtils.extractRowBounds(i.node,e);if(l!=null)return l}const n=(0,m._getRowHeightAsNumber)(this.beans);if(s){const l=(s.node.rowIndex-e)*n;return{rowTop:s.node.rowTop-l,rowHeight:n}}const a=this.topPx+this.heightPx,r=(this.getDisplayIndexEnd()-e)*n;return{rowTop:a-r,rowHeight:n}}isPixelInRange(e){return e>=this.topPx&&e<this.topPx+this.heightPx}getRowIndexAtPixel(e){if(e<this.topPx)return this.getDisplayIndexStart();if(e>=this.topPx+this.heightPx)return this.getDisplayIndexEnd()-1;if(this.parentRowNode.sibling&&e>this.parentRowNode.sibling.rowTop&&e<this.parentRowNode.sibling.rowTop+this.parentRowNode.sibling.rowHeight)return this.parentRowNode.sibling.rowIndex;let t=Number.MAX_SAFE_INTEGER,i=null,s=Number.MAX_SAFE_INTEGER,n=null;if(this.cache.getNodes().forEach(({node:l})=>{const c=Math.abs(e-l.rowTop);if(l.rowTop<e){c<t&&(t=c,i=l);return}c<s&&(s=c,n=l)}),i=i,n=n,i){const l=this.blockUtils.getIndexAtPixel(i,e);if(l!=null)return l}const a=(0,m._getRowHeightAsNumber)(this.beans);if(n){const l=n.rowTop,c=Math.ceil((l-e)/a);return n.rowIndex-c}const r=this.topPx+this.heightPx,o=Math.floor((r-e)/a);return this.getDisplayIndexEnd()-o}getChildStore(e){return this.storeUtils.getChildStore(e,this,t=>{const i=this.cache.getNodes().find(s=>s.node.key==t);return i?i.node:null})}forEachChildStoreShallow(e){this.cache.getNodes().forEach(({node:t})=>{t.childStore&&e(t.childStore)})}refreshAfterSort(e){if(this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)){const i=this.cache.isStoreFullyLoaded(),s=this.gos.get("serverSideEnableClientSideSort");if(!(i&&s)){const a=this.cache.getRowCount(),r=this.cache.isLastRowIndexKnown();this.destroyBean(this.cache),this.cache=this.createManagedBean(new PS(this,a,r,this.storeParams));return}this.cache.clientSideSortRows()}this.forEachChildStoreShallow(i=>i.refreshAfterSort(e))}refreshAfterFilter(e){if(!this.storeUtils.isServerSideOnlyRefreshFilteredGroups()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)){this.refreshStore(!0);return}this.forEachChildStoreShallow(i=>i.refreshAfterFilter(e))}refreshStore(e){if(e){this.destroyBean(this.cache),this.cache=this.createManagedBean(new PS(this,1,!1,this.storeParams)),this.fireStoreUpdatedEvent();return}this.cache.markNodesForRefresh()}getTopLevelRowDisplayedIndex(e){const t=this.cache.getDisplayIndexFromStoreIndex(e);return t!=null?t:e}isLastRowIndexKnown(){return this.cache.isLastRowIndexKnown()}getRowNodesInRange(e,t){return this.cache.getNodes().filter(({node:i})=>i.rowIndex>=e.rowIndex&&i.rowIndex<=t.rowIndex).map(({node:i})=>i)}addStoreStates(e){var t;e.push({route:(t=this.parentRowNode.getRoute())!=null?t:[],rowCount:this.getRowCount(),lastRowIndexKnown:this.isLastRowIndexKnown(),info:this.info,maxBlocksInCache:this.storeParams.maxBlocksInCache,cacheBlockSize:this.storeParams.cacheBlockSize}),this.forEachChildStoreShallow(i=>i.addStoreStates(e))}getIdSequence(){return this.idSequence}getParentNode(){return this.parentRowNode}getRowDetails(){return{field:this.groupField,group:this.group,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn}}getSsrmParams(){return this.ssrmParams}setStoreInfo(e){e&&Object.assign(this.info,e)}fireStoreUpdatedEvent(){this.eventSvc.dispatchEvent({type:"storeUpdated"})}fireRefreshFinishedEvent(){this.eventSvc.dispatchEvent({type:"storeRefreshed",route:this.parentRowNode.getRoute()})}getBlockStates(){return this.cache.getBlockStates()}getStoreBounds(){return{topPx:this.topPx,heightPx:this.heightPx}}getCache(){return this.cache}getFirstNode(){var t;const e=this.cache.getNodes().getBy("index",0);return(t=e==null?void 0:e.node)!=null?t:null}},a8=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmStoreFactory"}wireBeans(e){this.colModel=e.colModel,this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc,this.rowAutoHeight=e.rowAutoHeight}createStore(e,t){const i=this.getStoreParams(e,t);return new n8(e,i,t)}getStoreParams(e,t){const i=this.getLevelSpecificParams(t),s=this.getBlockSize(i),n=this.getMaxBlocksInCache(e,i);return{cacheBlockSize:s,maxBlocksInCache:n}}getMaxBlocksInCache(e,t){var n;const i=t&&t.maxBlocksInCache!=null?t.maxBlocksInCache:this.gos.get("maxBlocksInCache");if(i!=null&&i>=0){if(e.dynamicRowHeight){(0,m._warn)(203);return}if((n=this.rowAutoHeight)!=null&&n.active){(0,m._warn)(204);return}return i}}getBlockSize(e){const t=e&&e.cacheBlockSize!=null?e.cacheBlockSize:this.gos.get("cacheBlockSize");return t!=null&&t>0?t:100}getLevelSpecificParams(e){var n,a,r,o;const t=this.gos.getCallback("getServerSideGroupLevelParams");if(!t)return;const i={level:e.level+1,parentRowNode:e.level>=0?e:void 0,rowGroupColumns:(a=(n=this.rowGroupColsSvc)==null?void 0:n.columns)!=null?a:[],pivotColumns:(o=(r=this.pivotColsSvc)==null?void 0:r.columns)!=null?o:[],pivotMode:this.colModel.isPivotMode()};return t(i)}},r8=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmStoreUtils"}wireBeans(e){this.colModel=e.colModel,this.serverSideRowModel=e.rowModel,this.storeFactory=e.ssrmStoreFactory}getChildStore(e,t,i){if(!(e!=null&&e.length))return t;const s=e[0],n=i(s);if(n){if(e.length===1&&!n.childStore){const o=this.serverSideRowModel.getParams();n.childStore=this.createBean(this.storeFactory.createStore(o,n))}const a=e.slice(1,e.length),r=n.childStore;return r?r.getChildStore(a):null}return null}isServerRefreshNeeded(e,t,i){if(i.valueColChanged||i.secondaryColChanged)return!0;const s=e.level+1;if(!(s<t.length))return!0;const r=t[s].id;return i.changedColumns.indexOf(r)>-1?!0:this.colModel.getCols().filter(h=>h.getColDef().showRowGroup&&i.changedColumns.includes(h.getId())).map(h=>h.getColDef().showRowGroup).some(h=>h===!0||h===r)}getServerSideInitialRowCount(){return this.gos.get("serverSideInitialRowCount")}isServerSideSortAllLevels(){return this.gos.get("serverSideSortAllLevels")&&(0,m._isServerSideRowModel)(this.gos)}isServerSideOnlyRefreshFilteredGroups(){return this.gos.get("serverSideOnlyRefreshFilteredGroups")&&(0,m._isServerSideRowModel)(this.gos)}},o8=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="ssrmTxnManager",this.asyncTransactions=[]}wireBeans(e){this.valueCache=e.valueCache,this.serverSideRowModel=e.rowModel,this.selectionSvc=e.selectionSvc}postConstruct(){(0,m._isServerSideRowModel)(this.gos)}applyTransactionAsync(e,t){this.asyncTransactionsTimeout==null&&this.scheduleExecuteAsync(),this.asyncTransactions.push({transaction:e,callback:t})}scheduleExecuteAsync(){const e=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimeout=window.setTimeout(()=>{this.executeAsyncTransactions()},e)}executeAsyncTransactions(){var n;if(!this.asyncTransactions)return;const e=[],t=[],i=[];let s=!1;this.asyncTransactions.forEach(a=>{let r;if(this.serverSideRowModel.executeOnStore(a.transaction.route,c=>{r=c.applyTransaction(a.transaction)})?r==null&&(r={status:m.ServerSideTransactionResultStatus.StoreNotFound}):r={status:m.ServerSideTransactionResultStatus.StoreNotStarted},t.push(r),r.status==m.ServerSideTransactionResultStatus.StoreLoading){i.push(a);return}a.callback&&e.push(()=>a.callback(r)),r.status===m.ServerSideTransactionResultStatus.Applied&&(s=!0)}),e.length>0&&window.setTimeout(()=>{e.forEach(a=>a())},0),this.asyncTransactionsTimeout=void 0,this.asyncTransactions=i,s&&((n=this.valueCache)==null||n.onDataChanged(),this.eventSvc.dispatchEvent({type:"storeUpdated"})),t.length>0&&this.eventSvc.dispatchEvent({type:"asyncTransactionsFlushed",results:t})}flushAsyncTransactions(){this.asyncTransactionsTimeout!=null&&clearTimeout(this.asyncTransactionsTimeout),this.executeAsyncTransactions()}applyTransaction(e){var s;let t;if(this.serverSideRowModel.executeOnStore(e.route,n=>{t=n.applyTransaction(e)}))if(t){if((s=this.valueCache)==null||s.onDataChanged(),t.remove&&this.selectionSvc){const n=t.remove.map(a=>a.id);this.selectionSvc.deleteSelectionStateFromParent(e.route||[],n)}return this.eventSvc.dispatchEvent({type:"storeUpdated"}),t}else return{status:m.ServerSideTransactionResultStatus.StoreNotFound};else return{status:m.ServerSideTransactionResultStatus.StoreNotStarted}}},l8={moduleName:"ServerSideRowModel",version:Re,rowModels:["serverSide"],beans:[j9,B9,r8,F9,V9,o8,_9,a8,G9,J9,t8,e8,Q9,z9],dependsOn:[St,m._SortModule,m._SharedRowSelectionModule,FL,WL,Z6,q6]},c8={moduleName:"ServerSideRowModelApi",version:Re,apiFunctions:{getServerSideSelectionState:H9,setServerSideSelectionState:W9,applyServerSideTransaction:U9,applyServerSideTransactionAsync:$9,applyServerSideRowData:K9,retryServerSideLoads:Y9,flushServerSideAsyncTransactions:X9,refreshServerSide:Z9,getServerSideGroupLevelState:q9},dependsOn:[St,m._CsrmSsrmSharedApiModule,m._SsrmInfiniteSharedApiModule]},h8=".ag-sparkline-wrapper{height:100%;line-height:normal;position:absolute;top:0;width:100%}",ES=Symbol("WrappedFunctionMarker"),KL=(e,t)=>{if(e[ES])return e;const i=(...s)=>t(e,...s);return i[ES]=ES,i};function d8(e){return{content:`${e.xValue} ${e.yValue}`}}function u8(e){return{content:`${e.yValue}`}}var p8=class extends m.Component{constructor(){super({tag:"div",cls:"ag-sparkline-wrapper",children:[{tag:"span",ref:"eSparkline"}]}),this.eSparkline=m.RefPlaceholder,this.cachedWidth=0,this.cachedHeight=0,this.dataRef=[],this.processedData=[]}postConstruct(){this.env=this.beans.environment,this.addManagedPropertyListeners(["chartThemeOverrides","chartThemes","styleNonce"],()=>this.refresh(this.params))}createListener(e=!0){return()=>{var t,i,s,n,a;return this.updateSize((s=(i=(t=this.params)==null?void 0:t.column)==null?void 0:i.getActualWidth())!=null?s:0,((a=(n=this.params)==null?void 0:n.node.rowHeight)!=null?a:0)-2,e)}}initGridObserver(){var n,a;const e=this.createListener(),t=this.createListener(!1),i=(n=this.params)==null?void 0:n.column,s=(a=this.params)==null?void 0:a.node;i.__addEventListener("columnStateUpdated",e),s.__addEventListener("heightChanged",e),this.addDestroyFunc(()=>{i.__removeEventListener("columnStateUpdated",e),s.__removeEventListener("heightChanged",e)}),t()}updateSize(e,t,i=!0){if(e-=this.env.getCellPadding(),e!==this.cachedWidth||t!==this.cachedHeight){this.cachedWidth=e,this.cachedHeight=t;const s=this.refresh.bind(this);i?(0,m._batchCall)(()=>this.isAlive()&&s()):s()}}init(e){this.params=e,this.initGridObserver()}refresh(e=this.params){var a,r,o,l,c,h;var t;this.params=e;const i=this.cachedWidth,s=this.cachedHeight,n=this.gos.get("styleNonce");if(!this.sparklineInstance&&e&&i>0&&s>0){if(this.sparklineOptions=E(b(b({container:this.eSparkline,width:i,height:s},e.sparklineOptions),n?{styleNonce:n}:{}),{data:this.processData(e.value)}),(a=(t=this.sparklineOptions).type)!=null||(t.type="line"),(r=this.sparklineOptions.tooltip)!=null&&r.renderer)this.wrapTooltipRenderer();else{const u=this.getDefaultTooltipRenderer();this.sparklineOptions.tooltip=E(b({},this.sparklineOptions.tooltip),{renderer:u})}const d=(o=this.sparklineOptions)==null?void 0:o.theme;return this.sparklineOptions.type==="bar"&&this.sparklineOptions.itemStyler?this.wrapItemStyler(this.sparklineOptions):(h=(c=(l=d==null?void 0:d.overrides)==null?void 0:l.bar)==null?void 0:c.series)!=null&&h.itemStyler&&this.wrapItemStyler(d.overrides.bar.series),this.sparklineInstance=e.createSparkline(this.sparklineOptions),!0}else if(this.sparklineInstance)return this.sparklineInstance.update(b(E(b({},this.sparklineOptions),{data:this.processData(e==null?void 0:e.value),width:i,height:s}),n?{styleNonce:n}:{})),!0;return!1}processData(e=[]){return e.length===0?e:(this.dataRef!==e&&(this.dataRef=e,this.processedData=Array.isArray(e[0])?e.filter(t=>t!=null):e),this.processedData)}createContext(){var e,t;return{data:(e=this.params)==null?void 0:e.data,cellData:(t=this.params)==null?void 0:t.value}}getDefaultTooltipRenderer(e){var a;const t=e==null?void 0:e.title,i=this.sparklineOptions.xKey,s=Array.isArray((a=this.sparklineOptions.data)==null?void 0:a[0]);return!t&&(i||s)?d8:u8}wrapItemStyler(e){e.itemStyler=KL(e.itemStyler,(t,i)=>t(E(b({},i),{context:this.createContext()})))}wrapTooltipRenderer(){this.sparklineOptions.tooltip=E(b({},this.sparklineOptions.tooltip),{renderer:KL(this.sparklineOptions.tooltip.renderer,(e,t)=>{const i=e(E(b({},t),{context:this.createContext()}));return typeof i=="string"?i:b(b({},this.getDefaultTooltipRenderer(i)(t)),i)})})}destroy(){var e;super.destroy(),(e=this.sparklineInstance)==null||e.destroy()}},$L="Sparklines",YL={moduleName:$L,version:Re,dependsOn:[St],validate:()=>({isValid:!1,message:(0,m._preInitErrMsg)(258)}),with:e=>(e.setup(),{moduleName:$L,version:Re,dependsOn:[St],css:[h8],userComponents:{agSparklineCellRenderer:{classImp:p8,params:{createSparkline:e.createSparkline}}},validate:()=>({isValid:!0})})},g8=".ag-find-cell{display:block;overflow:hidden;text-overflow:ellipsis}.ag-find-match{background-color:var(--ag-find-match-background-color);color:var(--ag-find-match-color)}.ag-find-active-match{background-color:var(--ag-find-active-match-background-color);color:var(--ag-find-active-match-color)}";function f8(e){var t;(t=e.findSvc)==null||t.next()}function m8(e){var t;(t=e.findSvc)==null||t.previous()}function y8(e){var t,i;return(i=(t=e.findSvc)==null?void 0:t.totalMatches)!=null?i:0}function v8(e,t,i){var s;(s=e.findSvc)==null||s.goTo(t,i)}function b8(e){var t;(t=e.findSvc)==null||t.clearActive()}function x8(e){var t;return(t=e.findSvc)==null?void 0:t.activeMatch}function C8(e,t){var n,a;const{node:i,column:s}=t;return(a=(n=e.findSvc)==null?void 0:n.getNumMatches(i,s))!=null?a:0}function S8(e,t){var i,s;return(s=(i=e.findSvc)==null?void 0:i.getParts(t))!=null?s:[]}function M8(e){var t;return(t=e.findSvc)==null?void 0:t.refresh(!0)}var D8={tag:"span",cls:"ag-find-cell"},w8=class extends m.Component{constructor(){super(D8)}init(e){this.refresh(e)}refresh(e){var d,u,p;const{node:t,column:i}=e,{findSvc:s,valueSvc:n}=this.beans,{value:a,valueFormatted:r}=n.getValueForDisplay(i,t,!0),o=(d=r!=null?r:a)!=null?d:"",l=this.getGui();(0,m._clearElement)(l);const c=s==null?void 0:s.getParts({value:o,node:t,column:i!=null?i:null});if(!c)return l.textContent=(u=(0,m._toString)(o))!=null?u:"",l.classList.remove("ag-find-cell-active-match"),!0;let h=!1;for(const{value:g,match:f,activeMatch:y}of c){const v=(p=(0,m._toString)(g))!=null?p:"";if(f){const x=(0,m._createElement)({tag:"mark",cls:"ag-find-match"});x.textContent=v,y&&(x.classList.add("ag-find-active-match"),h=!0),l.appendChild(x)}else l.appendChild(document.createTextNode(v))}return l.classList.toggle("ag-find-cell-active-match",h),!0}};function XL(e){return e==null?void 0:e.toLocaleLowerCase()}function Xp(e,t,i){const s=t((0,m._toString)(i));let n=0;if(s!=null&&s.length){let a=-1;for(;a=s.indexOf(e,a+1),a!=-1;)n++}return n}var A8=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="findSvc",this.active=!1,this.topMatches=new Map,this.topNodes=[],this.topNumMatches=0,this.centerMatches=new Map,this.centerNodes=[],this.centerNumMatches=0,this.bottomMatches=new Map,this.bottomNodes=[],this.caseFormat=XL,this.scrollOnRefresh=!1,this.totalMatches=0}postConstruct(){if(!(0,m._isClientSideRowModel)(this.gos))return;const e=this.refresh.bind(this,!1),t=this.refresh.bind(this,!0),i=(0,m._debounce)(this,()=>{this.isAlive()&&t()},0);this.refreshDebounced=i,this.addManagedPropertyListener("findSearchValue",e),this.addManagedPropertyListener("findOptions",({currentValue:n,previousValue:a})=>{(0,m._jsonEquals)(n,a)||e()}),this.addManagedPropertyListeners(["groupSuppressBlankHeader","showOpenedGroup"],t),this.addManagedEventListeners({modelUpdated:t,displayedColumnsChanged:t,pinnedRowDataChanged:t,cellValueChanged:i,rowNodeDataChanged:i});const s=this.beans.rowSpanSvc;s&&this.addManagedListeners(s,{spannedCellsUpdated:i}),e()}next(){this.findAcrossContainers(!1,["top",null,"bottom"],1,1)}previous(){this.findAcrossContainers(!0,["bottom",null,"top"],this.totalMatches,-1)}goTo(e,t){var o;if(!t&&e===((o=this.activeMatch)==null?void 0:o.numOverall))return;const{topMatches:i,topNumMatches:s,centerMatches:n,centerNumMatches:a,bottomMatches:r}=this;if(e<=s){this.goToInContainer(i,e,0);return}if(e<=a){this.goToInContainer(n,e,s);return}this.goToInContainer(r,e,s+a)}clearActive(){this.activeMatch&&this.setActive(void 0)}isMatch(e,t){var i;return this.active&&!!((i=this.getMatches(e.rowPinned).get(e))!=null&&i.some(([s])=>s===t))}getNumMatches(e,t){var i,s,n;return(n=(s=(i=this.getMatches(e.rowPinned).get(e))==null?void 0:i.find(([a])=>a===t))==null?void 0:s[1])!=null?n:0}getParts(e){var p,g;const{value:t,node:i,column:s,precedingNumMatches:n}=e,a=this.findSearchValue,r=(p=(0,m._toString)(t))!=null?p:"";if((0,m._missing)(a))return[{value:r}];const o=(g=this.caseFormat(r))!=null?g:"",l=this.getActiveMatchNum(i,s)-(n!=null?n:0);let c=0,h=0;const d=a.length,u=[];for(;;){const f=o.indexOf(a,c);if(f!=-1){h++,f>c&&u.push({value:r.slice(c,f)});const y=f+d;u.push({value:r.slice(f,y),match:!0,activeMatch:h===l}),c=y}else return c<r.length&&u.push({value:r.slice(c)}),u}}registerDetailGrid(e,t){const i=this.gos;if(!(0,m._isClientSideRowModel)(i))return;const s=()=>{var a;return(a=i.get("findOptions"))==null?void 0:a.searchDetail},n=a=>{var l,c;const r=(l=this.centerMatches.get(e))==null?void 0:l[0],o=(c=r==null?void 0:r[1])!=null?c:0;a!==o&&this.refreshDebounced()};t.addEventListener("findChanged",a=>{t.isDestroyed()||!this.isAlive()||!this.active||!s()||n(a.totalMatches)}),t.addEventListener("gridPreDestroyed",()=>{var l,c,h;if(!this.isAlive()||!this.active||!s())return;const a=e.parent,r=this.findSearchValue;if(!a||!r)return;const o=(h=(c=(l=i.get("detailCellRendererParams"))==null?void 0:l.getFindMatches)==null?void 0:c.call(l,{node:a,data:a.data,findSearchValue:i.get("findSearchValue"),updateMatches:this.refreshDebounced,getMatchesForValue:d=>Xp(r,this.caseFormat,d)}))!=null?h:0;n(o)}),s()&&t.setGridOption("findSearchValue",i.get("findSearchValue"))}refresh(e){var W,Y;const t=new Set([...this.topNodes,...this.centerNodes,...this.bottomNodes]);this.topNodes=[],this.centerNodes=[],this.bottomNodes=[];const{topNodes:i,topMatches:s,centerMatches:n,centerNodes:a,bottomNodes:r,bottomMatches:o,beans:{gos:l,visibleCols:c,rowModel:h,valueSvc:d,pinnedRowModel:u,pagination:p,rowSpanSvc:g,masterDetailSvc:f,colModel:y},findSearchValue:v}=this,x=l.get("findOptions"),S=x!=null&&x.caseSensitive?K=>K!=null?K:void 0:XL;this.caseFormat=S;const M=l.get("findSearchValue"),D=S(M==null?void 0:M.trim());this.findSearchValue=D,s.clear(),n.clear(),o.clear();const A=e?this.activeMatch:void 0;this.activeMatch=void 0;const w=l.get("masterDetail")&&(x==null?void 0:x.searchDetail)&&f;if((0,m._missing)(D)){if(this.active=!1,this.topNumMatches=0,this.centerNumMatches=0,this.totalMatches=0,this.refreshRows(t),w){const K=f.store;for(const Q of Object.keys(K))(Y=(W=K[Q])==null?void 0:W.api)==null||Y.findClearActive()}(0,m._missing)(v)||this.dispatchFindChanged();return}const T=c.allCols,k=l.getCallback("isFullWidthRow"),N=l.get("detailCellRendererParams"),O=l.get("fullWidthCellRendererParams"),L=l.get("groupRowRendererParams"),F=pL(l),B=y.isPivotMode();let _=0,G,V,j=!1;const H=(K,Q,Z,J)=>{if(!Z)return;let ae=G.get(K);ae||(ae=[],G.set(K,ae),V.push(K),J||t.add(K)),ae.push([Q,Z]),_+=Z},U=K=>{var ae,oe,le,de,ue,ie,re;if(j){let te=K.rowIndex,fe=K.parent;for(;te==null&&fe;)te=fe.rowIndex,fe=fe.parent;if(te==null||!p.isRowInPage(te))return}const Q=K.hasChildren();if(!mL(F,K,Q,B,gL(F,K,Q),fL(F,K,Q)))return;const Z=K.data;if(k!=null&&k({rowNode:K})){if(O){const te=(oe=(ae=O.getFindMatches)==null?void 0:ae.call(O,{node:K,data:Z,findSearchValue:M,updateMatches:this.refreshDebounced,getMatchesForValue:fe=>Xp(D,S,fe)}))!=null?oe:0;H(K,null,te)}return}if((0,m._isFullWidthGroupRow)(l,K,B)){let te;const fe=L==null?void 0:L.getFindText;if(fe){const Le=d.getValueForDisplay(void 0,K).value;te=fe((0,m._addGridCommonParams)(l,{value:Le,node:K,data:Z,column:null,colDef:null,getValueFormatted:()=>{const{valueFormatted:Ee}=d.getValueForDisplay(void 0,K,!0);return Ee}}))}else{const{value:Le,valueFormatted:Ee}=d.getValueForDisplay(void 0,K,!0);te=Ee!=null?Ee:Le}const me=Xp(D,S,te);H(K,null,me);return}const J=K.level>0&&l.get("groupHideOpenParents")&&((le=K.parent)==null?void 0:le.getFirstChild())===K&&!((de=K.parent)!=null&&de.expanded);for(const te of T){if((0,m.isRowNumberCol)(te)||(0,m.isColumnSelectionCol)(te))continue;const fe=g==null?void 0:g.getCellSpan(te,K);if(fe&&fe.firstNode!==K||te.colDef.showRowGroup&&J)continue;let me;const Le=te.colDef,Ee=Le.getFindText;if(Ee){const Ue=d.getValueForDisplay(te,K).value;me=Ee((0,m._addGridCommonParams)(l,{value:Ue,node:K,data:Z,column:te,colDef:Le,getValueFormatted:()=>{const{valueFormatted:je}=d.getValueForDisplay(te,K,!0);return je}}))}else{const{value:Ue,valueFormatted:je}=d.getValueForDisplay(te,K,!0);me=je!=null?je:Ue}const He=Xp(D,S,me);H(K,te,He)}if(K.master&&w){const te=K.detailNode;if(te){const fe=(ue=te.detailGridInfo)==null?void 0:ue.api;if(fe){fe.setGridOption("findSearchValue",M);const me=fe.findGetTotalMatches();H(te,null,me);return}}if(N){const fe=(re=(ie=N.getFindMatches)==null?void 0:ie.call(N,{node:K,data:Z,findSearchValue:M,updateMatches:this.refreshDebounced,getMatchesForValue:me=>Xp(D,S,me)}))!=null?re:0;H(te!=null?te:{parent:K,dummy:!0},null,fe,!te)}}};G=s,V=i,u==null||u.forEachPinnedRow("top",U),this.topNumMatches=_;let $=_;G=n,V=a,_=0,j=!!p&&!!(x!=null&&x.currentPageOnly),h.forEachNodeAfterFilterAndSort(U,!0),this.centerNumMatches=_,$+=_,G=o,V=r,_=0,j=!1,u==null||u.forEachPinnedRow("bottom",U),$+=_,this.totalMatches=$,this.active=!0,this.refreshRows(t),A&&this.resetActiveMatch(A),this.dispatchFindChanged()}resetActiveMatch(e){var c,h,d,u;const{column:t,numInMatch:i}=e;let s=e.node;if(s.dummy){const p=(c=s.parent)==null?void 0:c.detailNode;if(!p)return;s=p}const n=(h=s.rowPinned)!=null?h:null;if(!((u=(d=this.getMatches(n))==null?void 0:d.get(s))==null?void 0:u.some(([p,g])=>p===t&&g>=i)))return;let r=0;n==null?r=this.topNumMatches:n==="bottom"&&(r=this.topNumMatches+this.centerNumMatches),(()=>{const p=this.getMatches(n);for(const g of p.keys()){const f=g===s,y=p.get(g);for(const[v,x]of y){if(f&&v===t){r+=i;return}r+=x}}})();const l=E(b({},e),{node:s,numOverall:r});this.activeMatch=l,this.refreshRows(new Set([s]),t==null?void 0:new Set([t])),this.scrollOnRefresh&&(this.scrollOnRefresh=!1,this.scrollToActive(l)),this.setDetailActive(l)}refreshRows(e,t){e.size&&this.beans.rowRenderer.refreshCells({rowNodes:[...e],columns:t?[...t]:void 0,force:!0,suppressFlash:!0})}findAcrossContainers(e,t,i,s){var r;if(!this.totalMatches){this.setActive();return}const n=this.activeMatch;let a=t;if(n){const{column:o,node:l,numInMatch:c,numOverall:h}=n,d=(r=l.rowPinned)!=null?r:null,u=h+s;if(this.findInContainer(d,e,u,l,o,c))return;const g=t.indexOf(d),f=t.length;if(t.slice(g+1,f).some(v=>this.findInContainer(v,e,u)))return;a=t.slice(0,g+1)}a.some(o=>this.findInContainer(o,e,i))}findInContainer(e,t,i,s,n,a){const r=this.getMatches(e),o=this.getRowNodes(e),l=t?-1:1;if(s!=null){const u=r.get(s),p=u==null?void 0:u.findIndex(([f])=>f===n);if(p!=null&&p!=-1){const[f,y]=u[p];if(t?a>1:a<y)return this.setActive({column:f,node:s,numInMatch:a+l,numOverall:i}),!0}const g=p!=null&&p!=-1?u==null?void 0:u[p+l]:void 0;if(g){const[f,y]=g;return this.setActive({column:f,node:s,numInMatch:t?y:1,numOverall:i}),!0}}let c;if(s==null)c=o[t?o.length-1:0];else{const u=o.findIndex(p=>p===s);c=o[u+l]}if(c==null)return!1;const h=r.get(c),d=h==null?void 0:h[t?h.length-1:0];if(d){const[u,p]=d;return this.setActive({column:u,node:c,numInMatch:t?p:1,numOverall:i}),!0}return!1}dispatchFindChanged(){const{eventSvc:e,activeMatch:t,totalMatches:i,findSearchValue:s}=this;e.dispatchEvent({type:"findChanged",activeMatch:t,totalMatches:i,findSearchValue:s})}setActive(e){var i;if(e&&e.node.rowIndex==null){const s=e.node;let n=s.footer?s.sibling:s.parent;for(;n&&n.level!==-1;)n.expanded=!0,n=n.parent;this.activeMatch=e,this.scrollOnRefresh=!0,(i=this.beans.expansionSvc)==null||i.onGroupExpandedOrCollapsed();return}const t=this.activeMatch;this.activeMatch=e,this.refreshAndScrollToActive(e,t),e&&this.setDetailActive(e),this.dispatchFindChanged()}setDetailActive({node:e,numInMatch:t}){var i,s;e.detail&&((s=(i=e.detailGridInfo)==null?void 0:i.api)==null||s.findGoTo(t))}refreshAndScrollToActive(e,t){if(e||t){const i=new Set,s=new Set;let n=!1;const a=r=>{if(!r)return;const{node:o,column:l}=r;i.add(o),l==null?n=!0:s.add(l)};a(e),a(t),this.refreshRows(i,n?void 0:s)}e&&this.scrollToActive(e)}scrollToActive({node:{rowPinned:e,rowIndex:t},column:i}){var o;const{ctrlsSvc:s,pagination:n,gos:a}=this.beans,r=s.getScrollFeature();e==null&&t!=null&&(n&&!((o=a.get("findOptions"))!=null&&o.currentPageOnly)&&!n.isRowInPage(t)&&n.goToPageWithIndex(t),r.ensureIndexVisible(t)),r.ensureColumnVisible(i)}goToInContainer(e,t,i){let s=i;for(const n of e.keys()){const a=e.get(n);for(const[r,o]of a){if(t<=s+o){this.setActive({column:r,node:n,numInMatch:t-s,numOverall:t});return}s+=o}}}getMatches(e){return e==="top"?this.topMatches:e==="bottom"?this.bottomMatches:this.centerMatches}getRowNodes(e){return e==="top"?this.topNodes:e==="bottom"?this.bottomNodes:this.centerNodes}getActiveMatchNum(e,t){const i=this.activeMatch;return i!=null&&i.node===e&&i.column===t?i.numInMatch:0}destroy(){this.topMatches.clear(),this.topNodes.length=0,this.centerMatches.clear(),this.centerNodes.length=0,this.bottomMatches.clear(),this.bottomNodes.length=0,this.activeMatch=void 0,super.destroy()}},I8={moduleName:"FindCore",version:Re,rowModels:["clientSide"],beans:[A8],userComponents:{agFindCellRenderer:w8},css:[g8]},T8={moduleName:"Find",version:Re,apiFunctions:{findGetTotalMatches:y8,findGoTo:v8,findNext:f8,findPrevious:m8,findGetActiveMatch:x8,findGetNumMatches:C8,findGetParts:S8,findClearActive:b8,findRefresh:M8},dependsOn:[I8]},k8=class extends m.BeanStub{constructor(e){super(),this.beanName="agChartsExports",this.isEnterprise=!1,this.create=e.create,this._Theme=e._Theme,this._Scene=e._Scene,this.isEnterprise=e.isEnterprise,this._Util=e._Util}};function ZL(e){return e.chart!=null?e.chart:e}function Zc(e,t,i){if(e==null)return i;const s=t.split(".");let n=e;for(;s.length>1;)if(n=n[s.shift()],n==null)return i;const a=n[s[0]];return a!=null?a:i}function L8(e,t,i){if(e==null)return;const s=t.split(".");let n=e;s.forEach((a,r)=>{n[a]||(n[a]={}),r<s.length-1&&(n=n[a])}),n[s[s.length-1]]=i}var P8={column:"bar",groupedColumn:"bar",stackedColumn:"bar",normalizedColumn:"bar",bar:"bar",groupedBar:"bar",stackedBar:"bar",normalizedBar:"bar",line:"line",stackedLine:"line",normalizedLine:"line",scatter:"scatter",bubble:"bubble",pie:"pie",donut:"donut",doughnut:"donut",area:"area",stackedArea:"area",normalizedArea:"area",histogram:"histogram",radarLine:"radar-line",radarArea:"radar-area",nightingale:"nightingale",radialColumn:"radial-column",radialBar:"radial-bar",sunburst:"sunburst",rangeBar:"range-bar",rangeArea:"range-area",boxPlot:"box-plot",treemap:"treemap",heatmap:"heatmap",waterfall:"waterfall",funnel:"funnel",coneFunnel:"cone-funnel",pyramid:"pyramid"},E8=new Set(["columnLineCombo","areaColumnCombo","customCombo"]),R8=["grouped","stacked","normalized"],qL={area:{isCartesian:!0,canInvert:!0},bar:{isCartesian:!0,canInvert:!0},histogram:{isCartesian:!0},line:{isCartesian:!0,canInvert:!0},pie:{isPie:!0},donut:{isPie:!0,canInvert:!0},scatter:{isCartesian:!0},bubble:{isCartesian:!0},"radial-column":{isPolar:!0,isEnterprise:!0,isRadial:!0,canInvert:!0},"radial-bar":{isPolar:!0,isEnterprise:!0,isRadial:!0,canInvert:!0},"radar-line":{isPolar:!0,isEnterprise:!0,canInvert:!0},"radar-area":{isPolar:!0,isEnterprise:!0,canInvert:!0},nightingale:{isPolar:!0,isEnterprise:!0,canInvert:!0},"range-bar":{isCartesian:!0,isEnterprise:!0,canSwitchDirection:!0},"range-area":{isCartesian:!0,isEnterprise:!0},"box-plot":{isCartesian:!0,isEnterprise:!0,canSwitchDirection:!0},treemap:{isEnterprise:!0,isHierarchical:!0},sunburst:{isEnterprise:!0,isHierarchical:!0},heatmap:{isCartesian:!0,isEnterprise:!0},waterfall:{isCartesian:!0,isEnterprise:!0,canSwitchDirection:!0},funnel:{isCartesian:!0,isEnterprise:!0,canSwitchDirection:!0},"cone-funnel":{isCartesian:!0,isEnterprise:!0,canSwitchDirection:!0},pyramid:{isCartesian:!0,isEnterprise:!0,canSwitchDirection:!0}};function N8(e){return!!qL[e]}function RS(e){return E8.has(e)}function Ml(e,t){var i;return!!((i=qL[e])!=null&&i[t])}function O8(e){return Ml(Ot(e),"isEnterprise")}var F8=new Set(["stackedColumn","normalizedColumn","stackedBar","normalizedBar"]);function B8(e){return F8.has(e)}function Dl(e){return Ml(e,"isCartesian")}function NS(e){return e==="funnel"||e==="cone-funnel"||e==="pyramid"}function OS(e){return Ml(e,"isPolar")}function _8(e){return Ml(e,"isRadial")}function qc(e){return Ml(e,"isHierarchical")}function Zp(e){return e==="doughnut"?"donut":e}function QL(e){return P8[e]}function Ot(e){var t;return(t=QL(e))!=null?t:"line"}function JL(e){return Ml(e,"isPie")}function G8(e){return e==="pie"||e==="waterfall"||e==="histogram"||e==="funnel"||e==="coneFunnel"||e==="pyramid"}function FS(e){return qc(Ot(e))?void 0:1}function Zm(e){return qc(Ot(e))?2:G8(e)?1:void 0}function eP(e){return!RS(e)&&Ml(Ot(e),"canInvert")}function z8(e){return Ml(Ot(e),"canSwitchDirection")}function BS(e){switch(e){case"groupedColumn":case"stackedColumn":case"normalizedColumn":case"groupedBar":case"stackedBar":case"normalizedBar":case"stackedLine":case"normalizedLine":case"stackedArea":case"normalizedArea":return`${e}Full`;case"doughnut":return"donut";case"areaColumnCombo":return"AreaColumnCombo";default:return e}}var tP=["number","category","grouped-category","log","time"];function V8(e){switch(e){case"bar":case"stackedBar":case"normalizedBar":return["number","category"];case"groupedBar":return["number","grouped-category"];case"column":case"stackedColumn":case"normalizedColumn":case"line":case"stackedLine":case"normalizedLine":case"area":case"stackedArea":case"normalizedArea":case"histogram":return["category","number"];case"groupedColumn":return["grouped-category","number"];case"scatter":case"bubble":return["number","number"];default:return}}function j8(e,t,i,s,n){var S;const{chartOptionsToRestore:a,chartPaletteToRestore:r,chartThemeToRestore:o,agChartsExports:l}=e,c=Y8(e),h=_S(c,l._Theme),d=h?{baseTheme:c}:(S=iP(e,c))!=null?S:{},u=e.getGridOptionsChartThemeOverrides(),p=e.apiChartThemeOverrides,g=Ot(e.chartType),f=e.crossFiltering?W8(t,e,g):void 0,x=[h?K8(e,i,(()=>{const M=D=>D?Object.keys(D).some(A=>Zc(D[A],"title.enabled",!1)):!1;return M(u)||M(p)})()):void 0,$8(),s,f,u,p,b({},a!=null?a:{}),n].filter(M=>!!M).reduce((M,D)=>({baseTheme:M,overrides:D}),d);if(r&&c===o){const M=e.agChartsExports._Theme.getChartTheme(d).palette;H8(r,M)||(x.palette=r)}return x}function H8(e,t){const i=(s,n)=>{var a;return s===n?!0:(s==null?void 0:s.length)!==(n==null?void 0:n.length)?!1:(a=s==null?void 0:s.every((r,o)=>r===(n==null?void 0:n[o])))!=null?a:!1};return i(e.fills,t.fills)&&i(e.strokes,t.strokes)}function _S(e,t){return Object.keys(t.themes).includes(e)}function W8(e,t,i){const n={tooltip:{delay:500},legend:{listeners:{legendItemClick:r=>{const o=e.getChart(),l=[r.seriesId,`${r.seriesId}-filtered-out`];o.series.filter(c=>l.includes(c.id)).forEach(c=>c.toggleSeriesItem(void 0,"category",r.itemId,void 0))}}},listeners:{click:r=>t.crossFilterCallback(r,!0)}};if(i==="pie"||i==="donut")return{[i]:b({series:{fills:{$if:[{$eq:[{$value:"$index"},0]},{$map:[{$mix:[{$value:"$1"},{$ref:"backgroundColor"},.7]},{$palette:"fills"}]},{$palette:"fills"}]},strokes:{$if:[{$eq:[{$value:"$index"},0]},{$map:[{$mix:[{$value:"$1"},{$ref:"backgroundColor"},.7]},{$palette:"strokes"}]},{$palette:"strokes"}]}}},n)};const a={};return i!=="line"&&(a.fill={$if:[{$isEven:[{$value:"$index"}]},{$palette:"fill"},{$mix:[{$path:["../$prevIndex/fill",{$palette:"fill"}]},{$ref:"backgroundColor"},.7]}]}),{[i]:b({series:b({stroke:{$if:[{$isEven:[{$value:"$index"}]},{$palette:"stroke"},{$mix:[{$path:["../$prevIndex/fill",{$palette:"stroke"}]},{$ref:"backgroundColor"},.7]}]}},a)},n)}}var U8=tP.reduce((e,t)=>E(b({},e),{[t]:{title:{_enabledFromTheme:!0}}}),{});function K8(e,t,i){const s=e.getExtraPaddingDirections();return{common:E(b({},t?{animation:{duration:500}}:void 0),{axes:U8,padding:{top:!i&&s.includes("top")?40:20,right:s.includes("right")?30:20,bottom:s.includes("bottom")?40:20,left:s.includes("left")?30:20}})}}function $8(){return{pie:{series:{title:{_enabledFromTheme:!0},calloutLabel:{_enabledFromTheme:!0},sectorLabel:{enabled:!1,_enabledFromTheme:!0}}},donut:{series:{title:{_enabledFromTheme:!0},calloutLabel:{_enabledFromTheme:!0},sectorLabel:{enabled:!1,_enabledFromTheme:!0}}}}}function Y8(e){let t=e.getChartThemeName();const i=e.getChartThemes();return i.includes(t)||(t=i[0]),t}function iP(e,t){const{customChartThemes:i}=e,s=i&&i[t];return s||(0,m._warn)(140,{name:t}),s}var _d=class{constructor(e){this.chartProxyParams=e,this.clearThemeOverrides=!1,this.agChartsExports=e.agChartsExports,this.chart=e.chartInstance,this.chartType=e.chartType,this.crossFiltering=e.crossFiltering,this.crossFilterCallback=e.crossFilterCallback,this.standaloneChartType=Ot(this.chartType),this.chart==null?this.chart=e.agChartsExports.create(this.getCommonChartOptions()):this.clearThemeOverrides=!0}crossFilteringReset(){}update(e){this.getChartRef().update(this.getUpdateOptions(e,this.getCommonChartOptions(e.updatedOverrides)))}updateThemeOverrides(e){this.getChartRef().updateDelta({theme:{overrides:e}})}getChart(){return ZL(this.chart)}getChartRef(){return this.chart}downloadChart(e,t,i){const{chart:s}=this,n=ZL(s),a=t||(n.title?n.title.text:"chart"),{width:r,height:o}=e||{};s.download({width:r,height:o,fileName:a,fileFormat:i})}getChartImageDataURL(e){return this.getChart().getCanvasDataURL(e)}getChartOptions(){return this.chart.getOptions()}getChartThemeOverrides(){var t;return(t=this.getChartOptions().theme.overrides)!=null?t:{}}getChartPalette(){return this.agChartsExports._Theme.getChartTheme(this.getChartOptions().theme).palette}setPaired(e){const t=Ot(this.chartProxyParams.chartType);this.chart.updateDelta({theme:{overrides:{[t]:{paired:e}}}})}isPaired(){const e=Ot(this.chartProxyParams.chartType);return Zc(this.getChartThemeOverrides(),`${e}.paired`,!0)}lookupCustomChartTheme(e){return iP(this.chartProxyParams,e)}getSeriesGroupType(){}transformCategoryData(e,t){return e.map((i,s)=>{const n=i[t],a=n&&n.toString?n.toString():"",r=b({},i);return r[t]={id:s,value:n,toString:()=>a},r})}getCommonChartOptions(e){var r,o;const t=this.clearThemeOverrides?{}:(o=(r=this.chart)==null?void 0:r.getOptions())!=null?o:{},i=this.chart!=null?this.getActiveFormattingPanelOverrides():void 0;this.clearThemeOverrides=!1;const s=this.chartProxyParams.styleNonce,n=j8(this.chartProxyParams,this,this.agChartsExports.isEnterprise,this.getChartThemeDefaults(),e!=null?e:i),a=b(E(b({},t),{mode:"integrated"}),s?{styleNonce:s}:{});return this.chartProxyParams.suppressFieldDotNotation!==void 0&&(a.suppressFieldDotNotation=this.chartProxyParams.suppressFieldDotNotation),a.theme=n,a.container=this.chartProxyParams.parentElement,a}getChartThemeDefaults(){const e=this.getSeriesChartThemeDefaults(),t=e?{[this.standaloneChartType]:e}:{},i={enabled:!0,snap:!0,label:{enabled:!1}},s=this.agChartsExports.isEnterprise?{zoom:{enabled:!0},animation:{enabled:!0,duration:500},axes:{number:{crosshair:i},category:{crosshair:i},log:{crosshair:i},time:{crosshair:i}}}:{};return s.minHeight=0,s.minWidth=0,s.navigator={enabled:!1},b({common:s},t)}getSeriesChartThemeDefaults(){}getActiveFormattingPanelOverrides(){var t,i;if(this.clearThemeOverrides)return{};const e=(t=this.chart)==null?void 0:t.getOptions().theme;return(i=e==null?void 0:e.overrides)!=null?i:{}}destroy({keepChartInstance:e=!1}={}){if(e)return this.chart.resetAnimations(),this.chart;this.destroyChart()}destroyChart(){this.chart&&(this.chart.destroy(),this.chart=void 0)}},wl=class extends _d{constructor(){super(...arguments),this.crossFilteringAllPoints=new Set,this.crossFilteringSelectedPoints=[]}getUpdateOptions(e,t){const i=this.getAxes(e,t);return E(b({},t),{data:this.getData(e,i),axes:i,series:this.getSeries(e)})}getData(e,t){const i=["area","line"].includes(this.standaloneChartType);return this.crossFiltering&&i?this.getCrossFilterData(e):this.getDataTransformedData(e,t)}getDataTransformedData(e,t){const i=t[0].type,{categories:s,data:n}=e,[a]=s;switch(i){case"category":return this.transformCategoryData(n,a.id);case"time":return this.transformTimeData(n,a.id);default:return n}}getXAxisType(e){return e.grouping?"grouped-category":this.isXAxisOfType(e,"time",t=>t instanceof Date)?"time":this.isXAxisOfType(e,"number")?"number":"category"}isXAxisOfType(e,t,i){const[s]=e.categories;if(s!=null&&s.chartDataType)return s.chartDataType===t;if(!i)return!1;const n=e.data[0];return n?i(n[s.id]):!1}transformTimeData(e,t){var s;return((s=e[0])==null?void 0:s[t])instanceof Date?e:e.map(n=>{const a=n[t];return typeof a=="string"?E(b({},n),{[t]:new Date(a)}):n})}crossFilteringReset(){this.crossFilteringSelectedPoints=[],this.crossFilteringAllPoints.clear()}crossFilteringPointSelected(e){return this.crossFilteringSelectedPoints.length==0||this.crossFilteringSelectedPoints.includes(e)}crossFilteringDeselectedPoints(){return this.crossFilteringSelectedPoints.length>0&&this.crossFilteringAllPoints.size!==this.crossFilteringSelectedPoints.length}extractLineAreaCrossFilterSeries(e,t){const[i]=t.categories,s=n=>this.standaloneChartType==="area"?t.getCrossFilteringContext().lastSelectedChartId===t.chartId?n+"-total":n:n+"-total";return e.map(n=>(n.yKey=s(n.yKey),n.listeners={nodeClick:a=>{const r=a.datum[n.xKey],o=a.event.metaKey||a.event.ctrlKey;this.crossFilteringAddSelectedPoint(o,r),this.crossFilterCallback(a)}},n.marker={itemStyler:a=>{const r=a.datum[i.id];return{fill:a.highlighted?"yellow":a.fill,size:a.highlighted?14:this.crossFilteringPointSelected(r)?8:0}}},this.standaloneChartType==="area"&&(n.fillOpacity=this.crossFilteringDeselectedPoints()?.3:1),this.standaloneChartType==="line"&&(n.strokeOpacity=this.crossFilteringDeselectedPoints()?.3:1),n))}getCrossFilterData(e){this.crossFilteringAllPoints.clear();const[t]=e.categories,i=e.fields[0].colId,s=`${i}-filtered-out`,n=e.getCrossFilteringContext().lastSelectedChartId;return e.data.map(a=>{const r=a[t.id];this.crossFilteringAllPoints.add(r);const o=this.crossFilteringPointSelected(r);return this.standaloneChartType==="area"&&n===e.chartId&&(a[`${i}-total`]=o?a[i]:a[i]+a[s]),this.standaloneChartType==="line"&&(a[`${i}-total`]=o?a[i]:a[i]+a[s]),a})}crossFilteringAddSelectedPoint(e,t){e?this.crossFilteringSelectedPoints.push(t):this.crossFilteringSelectedPoints=[t]}isHorizontal(e){const t=this.standaloneChartType;if(t!=="waterfall"&&t!=="box-plot"&&t!=="range-bar")return!1;const i=e.theme,s=n=>{var r,o,l;const a=(l=(o=(r=n==null?void 0:n.overrides)==null?void 0:r[t])==null?void 0:o.series)==null?void 0:l.direction;return a!=null?a==="horizontal":typeof(n==null?void 0:n.baseTheme)=="object"?s(n.baseTheme):!1};return s(i)}},X8=class extends wl{getSeries(e){const t=e.fields[0];return[{type:this.standaloneChartType,xKey:t.colId,xName:t.displayName,yName:this.chartProxyParams.translate("histogramFrequency"),areaPlot:!1}]}getAxes(e){return[{type:"number",position:"bottom"},{type:"number",position:"left"}]}},Z8=class extends wl{getAxes(e,t){return[{type:this.getXAxisType(e),position:this.isHorizontal(t)?"left":"bottom"},{type:"number",position:this.isHorizontal(t)?"bottom":"left"}]}getSeries(e){var n;const[t]=e.categories,[i]=e.fields;return[{type:this.standaloneChartType,xKey:t.id,xName:t.name,yKey:i.colId,yName:(n=i.displayName)!=null?n:void 0}]}},q8=class extends _d{getUpdateOptions(e,t){return E(b({},t),{data:this.transformFunnelCategories(e),series:this.getSeries(e)})}transformFunnelCategories(e){const{data:t}=e,[{id:i}]=e.categories;return t.map((s,n)=>E(b({},s),{[i]:{name:s[i],id:n,toString:()=>s[i]}}))}getSeriesChartThemeDefaults(){const e={crosshair:{enabled:!1}};return b({zoom:{enabled:!1}},this.chartType!=="pyramid"&&{axes:{category:e,number:e}})}getSeries(e){const[{id:t}]=e.categories,[{colId:i}]=e.fields;return[{type:this.standaloneChartType,stageKey:t,valueKey:i}]}},qm="AG-GRID-DEFAULT-LABEL-KEY";function Q8(e,t){const i=sP(e,s,n);return GS(i);function s(r){return t.length}function n(r,o){const l=t[o],c=r[l];return a(c)}function a(r){return r==null?null:String(r)}}function J8(e,t){const i=sP(e,s,n);return GS(i);function s(a){var r,o;return(o=(r=t(a))==null?void 0:r.length)!=null?o:0}function n(a,r){const o=t(a);if(!o)return null;const l=o.length-1-r;return o[l]}}function GS(e,t=null,i){const{depth:s,rootValues:n,value:a,children:r}=e;if(n)return n.map(l=>b({[qm]:t},l));if(s===0)return[b({[qm]:t},a)];const o=[];for(const[l,c]of r.entries())o.push(...GS(c,l,!0));return i?[b({[qm]:t,children:o},a!=null?a:{})]:o}function sP(e,t,i){const s={depth:0,children:new Map};return e.forEach(a=>{const r=t(a);n(a,r,i,0,s)}),s;function n(a,r,o,l,c){if(l===r)return l===0?(c.rootValues||(c.rootValues=[]),c.rootValues.push(a)):c.value=a,c;{const h=o(a,l),d=c.children.get(h),u=n(a,r,o,l+1,d||{depth:0,children:new Map});return c.children.set(h,u),c.depth=Math.max(1+u.depth,c.depth),c}}}var eX=class extends _d{getUpdateOptions(e,t){const{fields:i}=e,[s,n]=i;return E(b({},t),{series:this.getSeries(s,n),data:this.getData(e,s,n)})}getSeriesChartThemeDefaults(){return{gradientLegend:{gradient:{preferredLength:200},position:"right"}}}getSeries(e,t){var i,s;return[{type:this.standaloneChartType,labelKey:qm,sizeKey:e==null?void 0:e.colId,sizeName:(i=e==null?void 0:e.displayName)!=null?i:void 0,colorKey:t==null?void 0:t.colId,colorName:(s=t==null?void 0:t.displayName)!=null?s:void 0}]}getData(e,t,i){var o;const{categories:s,data:n,groupData:a,grouping:r}=e;if(r){const l=i?n.concat((o=a==null?void 0:a.map(c=>{const h=b({},c);return delete h[t.colId],h}))!=null?o:[]):n;return J8(l,c=>{var h,d;return(d=(h=c[m.GROUP_AUTO_COLUMN_ID])==null?void 0:h.labels)!=null?d:null})}else{const l=s.map(({id:c})=>c);return Q8(n,l)}}},tX=class extends _d{getAxes(e){const t=this.standaloneChartType==="radial-bar";return[{type:t?"angle-number":"angle-category"},{type:t?"radius-category":"radius-number"}]}getSeries(e){const{fields:t,categories:i,seriesGroupType:s}=e,[n]=i,a=this.standaloneChartType==="radial-bar",r=this.getSeriesGroupTypeOptions(s);return t.map(o=>{var l,c;return b({type:this.standaloneChartType,angleKey:a?o.colId:n.id,angleName:a?(l=o.displayName)!=null?l:void 0:n.name,radiusKey:a?n.id:o.colId,radiusName:a?n.name:(c=o.displayName)!=null?c:void 0},r)})}getSeriesGroupType(){var s,n;const e=this.standaloneChartType;if(!["nightingale","radial-bar","radial-column"].includes(e))return;const t=(n=(s=this.getChart().series)==null?void 0:s[0])==null?void 0:n.properties.toJson(),i=()=>t.normalizedTo?"normalized":"stacked";return e==="nightingale"?t.grouped?"grouped":i():t.stacked?i():"grouped"}getUpdateOptions(e,t){const i=this.getAxes(e);return E(b({},t),{data:this.getData(e,i),axes:i,series:this.getSeries(e)})}getData(e,t){if(t.some(s=>s.type==="angle-category"||s.type==="radius-category")){const[s]=e.categories;return this.transformCategoryData(e.data,s.id)}else return e.data}getSeriesGroupTypeOptions(e){return e?{grouped:e==="grouped"||void 0,stacked:e!=="grouped"||void 0,normalizedTo:e==="normalized"?100:void 0}:{}}};function iX(e,t){return e.reduce((i,s,n,a)=>i.concat(t(s,n,a)),new Array)}var sX="AG-GRID-DEFAULT-HEATMAP-CATEGORY-KEY",nX="AG-GRID-DEFAULT-HEATMAP-SERIES-KEY",aX="AG-GRID-DEFAULT-HEATMAP-VALUE-KEY",rX=class extends _d{getUpdateOptions(e,t){const i=nX,s=aX,n=sX;return E(b({},t),{series:this.getSeries(e,i,s,n),data:this.getData(e,i,s,n)})}getSeries(e,t,i,s){const[n]=e.categories;return[{type:this.standaloneChartType,yKey:s,xKey:t,colorKey:i,yName:n.name,xName:void 0,colorName:void 0}]}getData(e,t,i,s){const[n]=e.categories;return iX(e.data,(a,r)=>{const o=a[n.id],l=o==null?"":String(o),c={id:r,value:o,toString:()=>l};return e.fields.map(({colId:h,displayName:d})=>E(b({},a),{[t]:d,[i]:a[h],[s]:c}))})}getSeriesChartThemeDefaults(){return{gradientLegend:{gradient:{preferredLength:200},position:"right"},series:{tooltip:{renderer:oX}}}}};function oX(e){const{xKey:t,yKey:i,colorKey:s,yName:n,datum:a}=e;return{title:"",data:[{label:n,value:a[i]},{label:a[t],value:s&&a[s]}].map(({label:o,value:l})=>({label:String(o),value:String(l)}))}}var lX=class extends m.BeanStub{wireBeans(e){this.sortSvc=e.sortSvc,this.gridRowModel=e.rowModel,this.colModel=e.colModel,this.valueSvc=e.valueSvc,this.pivotResultCols=e.pivotResultCols,this.rowNodeSorter=e.rowNodeSorter}getData(e){if(e.crossFiltering){if(e.grouping)return(0,m._warn)(141),{chartData:[],colNames:{}};if(!(0,m._isClientSideRowModel)(this.gos))return(0,m._warn)(142),{chartData:[],colNames:{}}}(0,m._isServerSideRowModel)(this.gos)&&e.pivoting&&this.updatePivotKeysForSSRM();const i=this.extractRowsFromGridRowModel(e);return i.chartData=this.aggregateRowsByDimension(e,i.chartData),i}extractRowsFromGridRowModel(e){const{crossFiltering:t,startRow:i,endRow:s,valueCols:n,dimensionCols:a,grouping:r}=e;let o=[];const l={},c={},h={};let d={},u=[],p;if(t)d=this.getFilteredRowNodes(),u=this.getAllRowNodes(),p=u.length;else{const x=this.gridRowModel.getRowCount()-1;i===s&&i===0&&a.length===0&&n.length===0?p=0:p=(s>=0?Math.min(s,x):x)-i+1}p>0&&n.forEach(x=>{let S=[];const M=x.getColDef().pivotKeys;M&&(S=M.slice());const D=x.getColDef().headerName;D&&S.push(D),S.length>0&&(l[x.getId()]=S)});let g=0,f=0;const y={};for(let x=0;x<p;x++){const S=t?u[x]:this.gridRowModel.getRow(x+i);if(S.footer||S.detail){g++;continue}const M={};a.forEach(D=>{const A=D.colId,w=this.colModel.getCol(A);if(w){const T=this.valueSvc.getValue(w,S);if(r){const k=T!=null&&T.toString?String(T.toString()):" ",N=this.getGroupLabels(S,k),O=N.slice().reverse(),L={value:O,id:f++,toString:()=>O.filter(Boolean).join(" - ")},F=L.toString(),B=y[F];M[A]=B||(y[F]=L),S.group&&(c[N.toString()]=x-g);const _=N.slice(1,N.length).toString();_&&(h[_]=c[_])}else M[A]=T}else M[br]=x+1}),n.forEach(D=>{const A=D.getColId();if(t){const w=A+"-filtered-out",T=this.valueSvc.getValue(D,S);let k=T;T!=null&&(typeof T.toNumber=="function"?k=T.toNumber():typeof T.value=="number"&&(k=T.value)),d[S.id]?(M[A]=k,M[w]=e.aggFunc||e.isScatter?void 0:0):(M[A]=e.aggFunc||e.isScatter?void 0:0,M[w]=k)}else{let w=this.valueSvc.getValue(D,S);w&&typeof w.value=="number"&&(w=w.value),w&&Object.prototype.hasOwnProperty.call(w,"toString")&&(w=parseFloat(w.toString())),M[A]=w!=null&&typeof w.toNumber=="function"?w.toNumber():w}}),o.push(M)}let v;if(r){const x=Object.values(h),S=o;o=[],v=[];for(let M=0;M<S.length;M++)(x.includes(M)?v:o).push(S[M])}return{chartData:o,colNames:l,groupChartData:v}}aggregateRowsByDimension(e,t){const i=e.dimensionCols;if(!e.aggFunc||i.length===0)return t;const s=(0,m._last)(i),n=s&&s.colId,a={},r=[];return t.forEach(o=>{let l=a;i.forEach(c=>{const h=c.colId,d=o[h];if(h===n){let u=l[d];u||(u={__children:[]},i.forEach(p=>{const g=p.colId;u[g]=o[g]}),l[d]=u,r.push(u)),u.__children.push(o)}else l[d]||(l[d]={}),l=l[d]})}),this.gos.assertModuleRegistered("SharedAggregation",1)&&r.forEach(o=>e.valueCols.forEach(l=>{const c=l.getColId();if(e.crossFiltering){const h=o.__children.filter(f=>typeof f[c]!="undefined").map(f=>f[c]),d=Bd(this.beans,h,e.aggFunc,l);o[c]=d&&typeof d.value!="undefined"?d.value:d;const u=`${c}-filtered-out`,p=o.__children.filter(f=>typeof f[u]!="undefined").map(f=>f[u]),g=Bd(this.beans,p,e.aggFunc,l);o[u]=g&&typeof g.value!="undefined"?g.value:g}else{const h=o.__children.map(u=>u[c]),d=Bd(this.beans,h,e.aggFunc,l);o[c]=d&&typeof d.value!="undefined"?d.value:d}})),r}updatePivotKeysForSSRM(){var i,s;const e=(s=(i=this.pivotResultCols)==null?void 0:i.getPivotResultCols())==null?void 0:s.list;if(!e)return;const t=this.extractPivotKeySeparator(e);e.forEach(n=>{if(t==="")n.getColDef().pivotKeys=[];else{const a=n.getColId().split(t);n.getColDef().pivotKeys=a.slice(0,a.length-1)}})}extractPivotKeySeparator(e){if(e.length===0)return"";const t=(s,n)=>{const a=s.getGroupId();return s.getParent()?t(s.getParent(),a):n.split(a)[1][0]},i=e[0];return i.getParent()==null?"":t(i.getParent(),i.getColId())}getGroupLabels(e,t){const i=[t];for(;e&&e.level!==0;)if(e=e.parent,e)if(e.group){const s=this.colModel.getCol(m.GROUP_AUTO_COLUMN_ID);if(s){const n=this.valueSvc.getValue(s,e),a=n!=null&&n.toString?String(n.toString()):" ";i.push(a)}}else i.push(e.key);return i}getFilteredRowNodes(){const e={};return this.gridRowModel.forEachNodeAfterFilterAndSort(t=>{e[t.id]=t}),e}getAllRowNodes(){const e=[];return this.gridRowModel.forEachNode(t=>{e.push(t)}),this.sortRowNodes(e)}sortRowNodes(e){var i;const t=(i=this.sortSvc)==null?void 0:i.getSortOptions();return!t||t.length==0||!this.rowNodeSorter?e:this.rowNodeSorter.doFullSort(e,t)}},cX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartColSvc",this.valueColsWithoutSeriesType=new Set}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.valueSvc=e.valueSvc}postConstruct(){const e=()=>this.valueColsWithoutSeriesType.clear();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e})}getColumn(e){return this.colModel.getColDefCol(e)}getAllDisplayedColumns(){return this.beans.visibleCols.allCols}getColDisplayName(e,t){const i="chart",s=this.colNames.getDisplayNameForColumn(e,i);if(t){const n=[s],a=r=>{if(!r)return;const o=this.colNames.getDisplayNameForColumnGroup(r,i);o!=null&&o.length&&(n.unshift(o),a(r.getParent()))};return a(e.getParent()),n.join(" - ")}return s}getRowGroupColumns(){var e,t;return(t=(e=this.beans.rowGroupColsSvc)==null?void 0:e.columns)!=null?t:[]}getGroupDisplayColumns(){var e,t;return(t=(e=this.beans.showRowGroupCols)==null?void 0:e.getShowRowGroupCols())!=null?t:[]}isPivotMode(){return this.colModel.isPivotMode()}isPivotActive(){return this.colModel.isPivotActive()}getChartColumns(){const e=this.colModel.getCols(),t=new Set,i=new Set;return e.forEach(s=>{const n=s.getColDef(),a=n.chartDataType;if(a)switch(a){case"category":case"time":t.add(s);return;case"series":i.add(s);return;case"excluded":return;default:(0,m._warn)(153,{chartDataType:a});break}if(n.colId==="ag-Grid-AutoColumn"){t.add(s);return}if(!s.isPrimary()){i.add(s);return}(this.isInferredValueCol(s)?i:t).add(s)}),{dimensionCols:t,valueCols:i}}isInferredValueCol(e){const t=e.getColId();if(t==="ag-Grid-AutoColumn")return!1;const i=(0,m._getRowNode)(this.beans,{rowIndex:0,rowPinned:null});if(!i)return this.valueColsWithoutSeriesType.has(t);let s=this.valueSvc.getValue(e,i);s==null&&(s=this.extractLeafData(i,e)),s!=null&&(typeof s.toNumber=="function"?s=s.toNumber():typeof s.value=="number"&&(s=s.value));const n=typeof s=="number"||e.colDef.cellDataType==="number"||["series","time"].includes(e.colDef.chartDataType);return n?this.valueColsWithoutSeriesType.add(t):s==null&&e.colDef.cellDataType!=="number"&&(0,m._warn)(265,{colId:t}),n}extractLeafData(e,t){if(!e.allLeafChildren)return null;for(let i=0;i<e.allLeafChildren.length;i++){const s=e.allLeafChildren[i],n=this.valueSvc.getValue(t,s);if(n!=null)return n}return null}destroy(){this.valueColsWithoutSeriesType.clear(),super.destroy()}},hX=new Set(["line","groupedColumn","stackedColumn","area","stackedArea"]),dX=class extends m.BeanStub{constructor(e){var t;super(),this.suppressComboChartWarnings=!1,this.chartDataModel=e,this.seriesChartTypes=(t=e.params.seriesChartTypes)!=null?t:[]}postConstruct(){this.initComboCharts()}update(e){this.seriesChartTypes=e!=null?e:this.seriesChartTypes,this.initComboCharts(),this.updateSeriesChartTypes()}initComboCharts(){const e=this.seriesChartTypes&&this.seriesChartTypes.length>0;(this.chartDataModel.chartType==="customCombo"||e)&&(this.chartDataModel.chartType="customCombo",this.savedCustomSeriesChartTypes=this.seriesChartTypes||[])}updateSeriesChartTypes(){if(this.chartDataModel.isComboChart()){if(this.seriesChartTypes=this.seriesChartTypes.map(e=>{const t=["groupedColumn","stackedColumn","stackedArea"].includes(e.chartType);return e.secondaryAxis=t?!1:e.secondaryAxis,e}),this.chartDataModel.chartType==="customCombo"){this.updateSeriesChartTypesForCustomCombo();return}this.updateChartSeriesTypesForBuiltInCombos()}}updateSeriesChartTypesForCustomCombo(){!(this.seriesChartTypes&&this.seriesChartTypes.length>0)&&!this.suppressComboChartWarnings&&(0,m._warn)(150),this.seriesChartTypes=this.seriesChartTypes.map(s=>(hX.has(s.chartType)||((0,m._warn)(151,{chartType:s.chartType}),s.chartType="line"),s));const t=s=>{(!this.savedCustomSeriesChartTypes||this.savedCustomSeriesChartTypes.length===0)&&(this.savedCustomSeriesChartTypes=this.seriesChartTypes);const n=this.savedCustomSeriesChartTypes.find(a=>a.colId===s.colId);return n||(s.selected&&!this.suppressComboChartWarnings&&(0,m._warn)(152,{colId:s.colId}),{colId:s.colId,chartType:"line",secondaryAxis:!1})},i=this.chartDataModel.valueColState.map(t);this.seriesChartTypes=i,this.savedCustomSeriesChartTypes=i,this.suppressComboChartWarnings=!0}updateChartSeriesTypesForBuiltInCombos(){const{chartType:e,valueColState:t}=this.chartDataModel,i=e==="columnLineCombo"?"groupedColumn":"stackedArea",s=e==="columnLineCombo"?"line":"groupedColumn",n=t.filter(r=>r.selected),a=Math.ceil(n.length/2);this.seriesChartTypes=n.map((r,o)=>{const l=o>=a?s:i;return{colId:r.colId,chartType:l,secondaryAxis:!1}})}},br="AG-GRID-DEFAULT-CATEGORY",uX=class extends m.BeanStub{constructor(e){super(),this.unlinked=!1,this.chartData=[],this.valueColState=[],this.dimensionColState=[],this.colNames={},this.crossFiltering=!1,this.grouping=!1,this.params=e,this.chartId=e.chartId,this.setParams(e)}wireBeans(e){this.rangeSvc=e.rangeSvc,this.chartTranslation=e.chartTranslation}setParams(e){const{chartType:t,pivotChart:i,chartThemeName:s,switchCategorySeries:n,aggFunc:a,cellRange:r,suppressChartRanges:o,unlinkChart:l,crossFiltering:c,seriesGroupType:h}=e;this.chartType=t,this.pivotChart=i!=null?i:!1,this.chartThemeName=s,this.switchCategorySeries=!!n,this.aggFunc=a,this.referenceCellRange=r,this.suppliedCellRange=r,this.suppressChartRanges=o!=null?o:!1,this.unlinked=!!l,this.crossFiltering=!!c,this.seriesGroupType=h}postConstruct(){this.datasource=this.createManagedBean(new lX),this.chartColSvc=this.createManagedBean(new cX),this.comboChartModel=this.createManagedBean(new dX(this)),this.updateCellRanges({setColsFromRange:!0}),this.updateData()}updateModel(e){const{cellRange:t,seriesChartTypes:i}=e;t!==this.suppliedCellRange&&(this.dimensionCellRange=void 0,this.valueCellRange=void 0),this.setParams(e),this.updateSelectedDimensions(t==null?void 0:t.columns),this.updateCellRanges({setColsFromRange:!0}),(this.isComboChart()||i)&&this.comboChartModel.update(i),this.unlinked||this.updateData()}updateCellRanges(e){const{updatedColState:t,resetOrder:i,maintainColState:s,setColsFromRange:n}=e!=null?e:{};this.valueCellRange&&(this.referenceCellRange=this.valueCellRange);const{dimensionCols:a,valueCols:r}=this.chartColSvc.getChartColumns(),o=this.getAllColumnsFromRanges();t&&this.updateColumnState(t,i),this.setDimensionCellRange(a,o,t),this.setValueCellRange(r,o,n),!t&&!s&&(this.resetColumnState(),this.syncDimensionCellRange()),this.comboChartModel.updateSeriesChartTypes()}updateData(){const{startRow:e,endRow:t}=this.getRowIndexes();this.pivotChart&&this.resetColumnState(),this.grouping=this.isGrouping();const i={aggFunc:this.aggFunc,dimensionCols:this.getSelectedDimensions(),grouping:this.grouping,pivoting:this.isPivotActive(),crossFiltering:this.crossFiltering,valueCols:this.getSelectedValueCols(),startRow:e,endRow:t,isScatter:["scatter","bubble"].includes(this.chartType)},{chartData:s,colNames:n,groupChartData:a}=this.datasource.getData(i);this.chartData=s,this.groupChartData=a,this.colNames=n,this.categoryAxisType=void 0}isGrouping(){const e=this.gos.get("treeData"),t=e?null:this.chartColSvc.getRowGroupColumns(),i=e||t&&t.length>0,s=this.getSelectedDimensions().map(({colId:r})=>r),a=this.chartColSvc.getGroupDisplayColumns().map(r=>r.getColId()).some(r=>s.includes(r));return!!i&&a}getSelectedValueCols(){return this.valueColState.filter(e=>e.selected).map(e=>e.column)}getSelectedDimensions(){return this.dimensionColState.filter(e=>e.selected)}getColDisplayName(e,t){return this.chartColSvc.getColDisplayName(e,t)}isPivotMode(){return this.chartColSvc.isPivotMode()}getChartDataType(e){const t=this.chartColSvc.getColumn(e);return t?t.getColDef().chartDataType:void 0}isPivotActive(){return this.chartColSvc.isPivotActive()}createCellRange(e,...t){return{id:this.chartId,startRow:this.referenceCellRange.startRow,endRow:this.referenceCellRange.endRow,columns:t,startColumn:e===m.CellRangeType.DIMENSION||this.referenceCellRange.startColumn==null?t[0]:this.referenceCellRange.startColumn,type:e}}getAllColumnsFromRanges(){if(this.pivotChart)return new Set(this.chartColSvc.getAllDisplayedColumns());const e=this.dimensionCellRange||this.valueCellRange?[]:this.referenceCellRange.columns;return this.dimensionCellRange&&e.push(...this.dimensionCellRange.columns),this.valueCellRange&&e.push(...this.valueCellRange.columns),new Set(e)}getRowIndexes(){let e=0,t=0;const{rangeSvc:i,valueCellRange:s,dimensionCellRange:n}=this,a=s||n;if(i&&a){e=i.getRangeStartRow(a).rowIndex;const r=i.getRangeEndRow(a);t=r.rowPinned==="bottom"?-1:r.rowIndex}return{startRow:e,endRow:t}}resetColumnState(){const{dimensionCols:e,valueCols:t}=this.chartColSvc.getChartColumns(),i=this.getAllColumnsFromRanges(),s=this.valueColState.length<1;this.dimensionColState=[],this.valueColState=[];const n=qc(Ot(this.chartType));let a=!1,r=1;const o=this.suppliedCellRange.columns[0];e.forEach(h=>{const d=h.getColId()==="ag-Grid-AutoColumn";let u=!1;this.crossFiltering&&this.aggFunc?o.getColId()===h.getColId()&&(u=!0):u=d?!0:(!a||n)&&i.has(h),this.dimensionColState.push({column:h,colId:h.getColId(),displayName:this.getColDisplayName(h),selected:u,order:r++}),u&&(a=!0)});const l={colId:br,displayName:this.chartTranslation.translate("defaultCategory"),selected:!a,order:0};this.dimensionColState.unshift(l);const c=this.referenceCellRange.columns.filter(h=>t.has(h));t.forEach(h=>{s&&this.referenceCellRange.columns.includes(h)&&(h=c.shift()),this.valueColState.push({column:h,colId:h.getColId(),displayName:this.getColDisplayName(h),selected:i.has(h),order:r++})})}updateColumnState(e,t){const i=c=>c.colId===e.colId,{dimensionColState:s,valueColState:n}=this,a=s.find(i),r=n.find(i);if(a)if(qc(Ot(this.chartType)))a.selected=e.selected;else{const h=e.selected?a:s.filter(d=>d!==a).find(({selected:d})=>d);s.forEach(d=>d.selected=d===h)}else r&&(r.selected=e.selected);const o=[...s,...n],l=[];t||(o.forEach((c,h)=>{h===e.order&&l.push(e.colId),c.colId!==e.colId&&l.push(c.colId)}),o.forEach(c=>{const h=l.indexOf(c.colId);c.order=h>=0?l.indexOf(c.colId):o.length-1})),this.reorderColState()}reorderColState(){const e=(t,i)=>t.order-i.order;this.dimensionColState.sort(e),this.valueColState.sort(e)}setDimensionCellRange(e,t,i){this.dimensionCellRange=void 0;const s=qc(Ot(this.chartType));if(!i&&!this.dimensionColState.length){const o=new Array;e.forEach(l=>{o.length>0&&!s||!t.has(l)||o.push(l)}),o.length>0&&(this.dimensionCellRange=this.createCellRange(m.CellRangeType.DIMENSION,...o));return}let n=i?[i]:[];if(this.crossFiltering&&this.aggFunc){const o=this.suppliedCellRange.columns[0];n=this.dimensionColState.filter(l=>l.colId===o.getColId())}else(s||n.length===0||n.some(({column:o})=>!o||!e.has(o)))&&(n=this.dimensionColState.filter(o=>o.selected));const a=n.length===1?n[0].colId===br:!1,r=n.map(({column:o})=>o).filter(o=>o!=null);r.length>0&&!a&&(this.dimensionCellRange=this.createCellRange(m.CellRangeType.DIMENSION,...r))}setValueCellRange(e,t,i){this.valueCellRange=void 0;const s=[],n=Zm(this.chartType);let a=0;if(e.forEach(r=>{i?(n==null||a<n)&&t.has(r)&&(s.push(r),a++):this.valueColState.some(o=>o.selected&&o.colId===r.getColId())&&s.push(r)}),s.length>0){let r=[];this.valueColState.length>0?r=this.valueColState.map(o=>o.colId):t.forEach(o=>r.push(o.getColId())),s.sort((o,l)=>r.indexOf(o.getColId())-r.indexOf(l.getColId())),this.valueCellRange=this.createCellRange(m.CellRangeType.VALUE,...s)}}resetCellRanges(e,t){if(!e&&!t)return;const{dimensionCols:i,valueCols:s}=this.chartColSvc.getChartColumns(),n=this.getAllColumnsFromRanges();e&&this.setDimensionCellRange(i,n),t&&this.setValueCellRange(s,n)}updateSelectedDimensions(e){const t=new Set(e.map(s=>s.getColId()));if(qc(Ot(this.chartType))){const s=this.dimensionColState.filter(a=>t.has(a.colId)),n=new Set(s.map(a=>a.colId));this.dimensionColState=this.dimensionColState.map(a=>E(b({},a),{selected:n.has(a.colId)}))}else{const n=(this.dimensionColState.find(a=>t.has(a.colId))||this.dimensionColState[0]).colId;this.dimensionColState=this.dimensionColState.map(a=>E(b({},a),{selected:a.colId===n}))}}syncDimensionCellRange(){const e=this.getSelectedDimensions();if(e.length===0)return;const t=e.map(({column:i})=>i).filter(i=>i!=null);t.length>0&&(this.dimensionCellRange=this.createCellRange(m.CellRangeType.DIMENSION,...t))}isComboChart(e){return RS(e!=null?e:this.chartType)}},nP=class extends wl{getAxes(e,t){return[{type:this.getXAxisType(e),position:this.isHorizontal(t)?"left":"bottom"},{type:"number",position:this.isHorizontal(t)?"bottom":"left"}]}computeSeriesStatistics(e,t){const{data:i,fields:s}=e,[n]=e.categories,a=n.id||br,r=this.groupDataByCategory(a,i);return Array.from(r).map(([o,l])=>{const c={[n.id]:o};return s.forEach((h,d)=>{const u=l.map(g=>g[h.colId]).filter(g=>typeof g=="number"&&!isNaN(g)),p=t(u);for(const g of Object.keys(p)){const f=`${g}:${d}`;c[f]=u.length>0?p[g]:null}}),c})}groupDataByCategory(e,t){const i=s=>{if(e===br)return 1;const n=s[e];return n==null?"":n instanceof Date?n.getTime():n};return t.reduce((s,n)=>{const a=i(n),r=s.get(a);return r?r.push(n):s.set(a,[n]),s},new Map)}},pX=class extends nP{getSeries(e){const[t]=e.categories;return e.fields.map((i,s)=>{var n;return{type:this.standaloneChartType,xKey:t.id,xName:t.name,yName:(n=i.displayName)!=null?n:void 0,minName:"Min",q1Name:"Q1",medianName:"Median",q3Name:"Q3",maxName:"Max",minKey:`min:${s}`,q1Key:`q1:${s}`,medianKey:`median:${s}`,q3Key:`q3:${s}`,maxKey:`max:${s}`}})}getData(e){return this.computeSeriesStatistics(e,t=>{const i=t.sort((s,n)=>s-n);return{min:i[0],q1:this.quantile(i,.25),median:this.quantile(i,.5),q3:this.quantile(i,.75),max:i[i.length-1]}})}quantile(e,t){const i=(e.length-1)*t,s=Math.floor(i),n=i-s;return e[s+1]!==void 0?e[s]+n*(e[s+1]-e[s]):e[s]}},gX=class extends nP{getSeries(e){const[t]=e.categories;return e.fields.map((i,s)=>{var n;return{type:this.standaloneChartType,xKey:t.id,xName:t.name,yName:(n=i.displayName)!=null?n:void 0,yLowName:"Min",yHighName:"Max",yLowKey:`min:${s}`,yHighKey:`max:${s}`}})}getData(e){return this.computeSeriesStatistics(e,t=>({min:Math.min(...t),max:Math.max(...t)}))}},fX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="enterpriseChartProxyFactory"}createChartProxy(e){switch(e.chartType){case"histogram":return new X8(e);case"radarLine":case"radarArea":case"nightingale":case"radialColumn":case"radialBar":return new tX(e);case"rangeBar":case"rangeArea":return new gX(e);case"boxPlot":return new pX(e);case"treemap":case"sunburst":return new eX(e);case"heatmap":return new rX(e);case"waterfall":return new Z8(e);case"funnel":case"coneFunnel":case"pyramid":return new q8(e)}}},aP=class extends m.BeanStub{constructor(e,t,i,s){super(),this.chartController=e,this.eGui=t,this.cssClass=i,this.createPanels=s,this.panels=[]}postConstruct(){this.addManagedListeners(this.chartController,{chartUpdated:()=>this.refreshPanels(!0),chartApiUpdate:()=>this.refreshPanels(!1)})}addComponent(e){this.createBean(e),this.panels.push(e),e.addCss(this.cssClass),this.eGui.appendChild(e.getGui())}refreshPanels(e){const t=this.chartController.getChartType(),i=this.chartController.isGrouping(),s=Ot(t);e&&t===this.chartType&&i===this.isGrouping||(this.destroyPanels(),this.createPanels(t,s),this.chartType=t,this.isGrouping=i)}destroyPanels(){this.panels.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)}),this.panels=[]}destroy(){this.destroyPanels(),super.destroy()}},mX=class extends m.Component{constructor(e){super(),this.chartMenuParamsFactory=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuParamsFactory.addEnableParams("animation.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("animation"),suppressEnabledCheckbox:!0,useToggle:!0}),t=this.chartMenuParamsFactory.getDefaultNumberInputParams("animation.duration","durationMillis",{min:0});this.setTemplate(`<div>
            <ag-group-component data-ref="animationGroup">
                <ag-input-number-field data-ref="animationHeightInput"></ag-input>
            </ag-group-component>
        </div>`,[Nt,m.AgInputNumberFieldSelector],{animationGroup:e,animationHeightInput:t})}},yX={tag:"div",cls:"ag-color-input",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:"input",ref:"eInput",cls:"ag-input-field-input"},{tag:"div",ref:"eColor",cls:"ag-color-input-color"}]}]},vX=class extends m.AgInputTextField{constructor(){super({template:yX}),this.eColor=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation,this.color=e.agChartsExports._Util.Color}setColor(e){const t=e.toRgbaString();this.setValue(this.color.fromString(t).toHexString().toUpperCase(),!0),this.eColor.style.backgroundColor=t}setValue(e,t){const i=this.color.validColorString(e!=null?e:"");return this.eInput.setCustomValidity(i?"":this.chartTranslation.translate("invalidColor")),super.setValue(e,t),i&&!t&&this.dispatchLocalEvent({type:"colorChanged"}),this}onColorChanged(e){this.addManagedListeners(this,{colorChanged:()=>e(this.color.fromString(this.value))})}},bX={selector:"AG-COLOR-INPUT",component:vX},rP=8,Qm=[],xX=class extends m.Component{constructor(e){super(`<div class="ag-color-panel" tabindex="-1">
            <div data-ref="spectrumColor" class="ag-spectrum-color">
                <div class="ag-spectrum-sat ag-spectrum-fill">
                    <div data-ref="spectrumVal" class="ag-spectrum-val ag-spectrum-fill">
                        <div data-ref="spectrumDragger" class="ag-spectrum-dragger"></div>
                    </div>
                </div>
            </div>
            <div class="ag-spectrum-tools">
                <div data-ref="spectrumHue" class="ag-spectrum-hue ag-spectrum-tool">
                    <div class="ag-spectrum-hue-background"></div>
                    <div data-ref="spectrumHueSlider" class="ag-spectrum-slider"></div>
                </div>
                <div data-ref="spectrumAlpha" class="ag-spectrum-alpha ag-spectrum-tool">
                    <div class="ag-spectrum-alpha-background"></div>
                    <div data-ref="spectrumAlphaSlider" class="ag-spectrum-slider"></div>
                </div>
                <ag-color-input data-ref="colorInput"></ag-color-input>
                <div data-ref="recentColors" class="ag-recent-colors"></div>
            </div>
        </div>`,[bX]),this.H=1,this.S=1,this.B=1,this.A=1,this.isSpectrumDragging=!1,this.isSpectrumHueDragging=!1,this.isSpectrumAlphaDragging=!1,this.colorChanged=!1,this.spectrumColor=m.RefPlaceholder,this.spectrumVal=m.RefPlaceholder,this.spectrumDragger=m.RefPlaceholder,this.spectrumHue=m.RefPlaceholder,this.spectrumHueSlider=m.RefPlaceholder,this.spectrumAlpha=m.RefPlaceholder,this.spectrumAlphaSlider=m.RefPlaceholder,this.colorInput=m.RefPlaceholder,this.recentColors=m.RefPlaceholder,this.picker=e.picker}wireBeans(e){this._Color=e.agChartsExports._Util.Color}postConstruct(){this.initTabIndex(),this.initRecentColors(),this.addGuiEventListener("focus",()=>this.spectrumColor.focus()),this.addGuiEventListener("keydown",e=>{e.key===m.KeyCode.ENTER&&!e.defaultPrevented&&this.destroy()}),this.addManagedListeners(this.spectrumColor,{keydown:e=>this.moveDragger(e)}),this.addManagedListeners(this.spectrumAlphaSlider,{keydown:e=>this.moveAlphaSlider(e)}),this.addManagedListeners(this.spectrumHueSlider,{keydown:e=>this.moveHueSlider(e)}),this.addManagedListeners(this.spectrumVal,{mousedown:this.onSpectrumDraggerDown.bind(this)}),this.addManagedListeners(this.spectrumHue,{mousedown:this.onSpectrumHueDown.bind(this)}),this.addManagedListeners(this.spectrumAlpha,{mousedown:this.onSpectrumAlphaDown.bind(this)}),this.addGuiEventListener("mousemove",e=>{this.onSpectrumDraggerMove(e),this.onSpectrumHueMove(e),this.onSpectrumAlphaMove(e)}),this.addManagedListeners(document,{mouseup:this.onMouseUp.bind(this)}),this.colorInput.onColorChanged(this.setColor.bind(this)),this.addManagedListeners(this.recentColors,{click:this.onRecentColorClick.bind(this),keydown:e=>{(e.key===m.KeyCode.ENTER||e.key===m.KeyCode.SPACE)&&(e.preventDefault(),this.onRecentColorClick(e))}})}initTabIndex(){const e=this.tabIndex=this.gos.get("tabIndex").toString();this.spectrumColor.setAttribute("tabindex",e),this.spectrumHueSlider.setAttribute("tabindex",e),this.spectrumAlphaSlider.setAttribute("tabindex",e)}refreshSpectrumRect(){return this.spectrumValRect=this.spectrumVal.getBoundingClientRect()}refreshHueRect(){return this.spectrumHueRect=this.spectrumHue.getBoundingClientRect()}refreshAlphaRect(){return this.spectrumAlphaRect=this.spectrumAlpha.getBoundingClientRect()}onSpectrumDraggerDown(e){e.preventDefault(),this.refreshSpectrumRect(),this.isSpectrumDragging=!0,this.moveDragger(e)}onSpectrumDraggerMove(e){this.isSpectrumDragging&&this.moveDragger(e)}onSpectrumHueDown(e){this.refreshHueRect(),this.isSpectrumHueDragging=!0,this.moveHueSlider(e)}onSpectrumHueMove(e){this.isSpectrumHueDragging&&this.moveHueSlider(e)}onSpectrumAlphaDown(e){this.refreshAlphaRect(),this.isSpectrumAlphaDragging=!0,this.moveAlphaSlider(e)}onSpectrumAlphaMove(e){this.isSpectrumAlphaDragging&&this.moveAlphaSlider(e)}onMouseUp(){this.isSpectrumDragging=!1,this.isSpectrumHueDragging=!1,this.isSpectrumAlphaDragging=!1}moveDragger(e){const t=this.spectrumValRect;if(!t)return;let i,s;if(e instanceof MouseEvent)i=e.clientX-t.left,s=e.clientY-t.top;else{const n=e.key===m.KeyCode.LEFT,a=e.key===m.KeyCode.RIGHT,r=e.key===m.KeyCode.UP,o=e.key===m.KeyCode.DOWN,l=r||o,c=n||a;if(!l&&!c)return;e.preventDefault();const{x:h,y:d}=this.getSpectrumValue();i=h+(c?n?-5:5:0),s=d+(l?r?-5:5:0)}i=Math.max(i,0),i=Math.min(i,t.width),s=Math.max(s,0),s=Math.min(s,t.height),this.setSpectrumValue(i/t.width,1-s/t.height)}moveHueSlider(e){const t=this.spectrumHueRect;if(!t)return;const i=this.moveSlider(this.spectrumHueSlider,e);i!=null&&(this.H=1-i/t.width,this.update())}moveAlphaSlider(e){const t=this.spectrumAlphaRect;if(!t)return;const i=this.moveSlider(this.spectrumAlphaSlider,e);i!=null&&(this.A=i/t.width,this.update())}moveSlider(e,t){var r;const i=e.getBoundingClientRect(),s=(r=e.parentElement)==null?void 0:r.getBoundingClientRect();if(!e||!s)return null;const n=i.width/2;let a;if(t instanceof MouseEvent)a=Math.floor(t.clientX-s.left);else{const o=t.key===m.KeyCode.LEFT,l=t.key===m.KeyCode.RIGHT;if(!o&&!l)return null;t.preventDefault();const c=o?-5:5;a=parseFloat(e.style.left)+n+c}return a=Math.max(a,0),a=Math.min(a,s.width),e.style.left=a-n+"px",a}update(e){const{A:t,S:i,B:s,H:n,_Color:a}=this,r=n*360,o=a.fromHSB(r,i,s,t),l=o.toRgbaString(),h=a.fromHSB(r,i,s).toRgbaString(),u=a.fromHSB(r,1,1).toRgbaString(),p=this.picker;a.fromString(p.getValue()).toRgbaString()!==l&&(this.colorChanged=!0),p.setValue(l),this.spectrumColor.style.backgroundColor=u,this.spectrumDragger.style.backgroundColor=h,this.spectrumHueSlider.style.backgroundColor=u,this.spectrumAlpha.style.setProperty("--ag-internal-spectrum-alpha-color-from",a.fromHSB(r,i,s,0).toRgbaString()),this.spectrumAlpha.style.setProperty("--ag-internal-spectrum-alpha-color-to",h),this.spectrumAlpha.style.setProperty("--ag-internal-spectrum-alpha-color",l),e||this.colorInput.setColor(o)}setSpectrumValue(e,t,i){const s=this.spectrumValRect||this.refreshSpectrumRect();if(s==null)return;const n=this.spectrumDragger,a=n.getBoundingClientRect();e=Math.max(0,e),e=Math.min(1,e),t=Math.max(0,t),t=Math.min(1,t),this.S=e,this.B=t,n.style.left=e*s.width-a.width/2+"px",n.style.top=(1-t)*s.height-a.height/2+"px",this.update(i)}getSpectrumValue(){const e=this.spectrumDragger,t=e.getBoundingClientRect(),i=parseFloat(e.style.left)+t.width/2,s=parseFloat(e.style.top)+t.height/2;return{x:i,y:s}}initRecentColors(){const e=Qm,t=e.map((i,s)=>`<div class="ag-recent-color" id=${s} style="background-color: ${i}; width: 15px; height: 15px;" recent-color="${i}" tabIndex="${this.tabIndex}"></div>`);this.recentColors.innerHTML=t.join(""),(0,m._setDisplayed)(this.recentColors,!!e.length)}setValue(e){const t=this._Color.fromString(e);this.setColor(t,!0)}setColor(e,t){const[i,s,n]=e.toHSB();this.H=(isNaN(i)?0:i)/360,this.A=e.a;const a=this.spectrumHueRect||this.refreshHueRect(),r=this.spectrumAlphaRect||this.refreshAlphaRect();this.spectrumHueSlider.style.left=`${(this.H-1)*-a.width-this.spectrumHueSlider.getBoundingClientRect().width/2}px`,this.spectrumAlphaSlider.style.left=`${this.A*r.width-this.spectrumAlphaSlider.getBoundingClientRect().width/2}px`,this.setSpectrumValue(s,n,!t)}onRecentColorClick(e){const t=e.target;if(!(0,m._exists)(t.id))return;const i=parseInt(t.id,10);this.setValue(Qm[i]),this.destroy()}addRecentColor(){const t=this._Color.fromHSB(this.H*360,this.S,this.B,this.A).toRgbaString();let i=Qm;!this.colorChanged||i[0]===t||(i=i.filter(s=>s!=t),i=[t].concat(i),i.length>rP&&(i=i.slice(0,rP)),Qm=i)}destroy(){this.addRecentColor(),super.destroy()}},oP=class extends m.AgPickerField{constructor(e){super(b({pickerAriaLabelKey:"ariaLabelColorPicker",pickerAriaLabelValue:"Color Picker",pickerType:"ag-list",className:"ag-color-picker",pickerIcon:"chartsColorPicker"},e))}postConstruct(){this.eDisplayFieldColor=(0,m._createElement)({tag:"span",cls:"ag-color-picker-color"}),this.eDisplayFieldText=(0,m._createElement)({tag:"span",cls:"ag-color-picker-value"}),this.eDisplayField.append(this.eDisplayFieldColor,this.eDisplayFieldText),super.postConstruct(),this.value&&this.setValue(this.value)}createPickerComponent(){var s;const e=this.eWrapper.getBoundingClientRect(),t=this.beans.popupSvc.getParentRect();return this.createBean(new jp({closable:!1,modal:!0,hideTitleBar:!0,minWidth:190,width:190,height:250,x:e.right-t.left-190,y:e.top-t.top-250-((s=this.config.pickerGap)!=null?s:0),postProcessPopupParams:{type:"colorPicker",eventSource:this.eWrapper}}))}renderAndPositionPicker(){const e=this.pickerComponent,t=this.createBean(new xX({picker:this}));return e.addCss("ag-color-dialog"),t.addDestroyFunc(()=>{e.isAlive()&&this.destroyBean(e)}),e.setParentComponent(this),e.setBodyComponent(t),t.setValue(this.getValue()),t.getGui().focus(),e.addDestroyFunc(()=>{this.isDestroyingPicker?this.isDestroyingPicker=!1:(this.beforeHidePicker(),this.isDestroyingPicker=!0,t.isAlive()&&this.destroyBean(t),this.isAlive()&&this.getFocusableElement().focus())}),()=>{var i;return(i=this.pickerComponent)==null?void 0:i.close()}}setValue(e){return this.value===e?this:(this.eDisplayFieldColor.style.backgroundColor=e,this.eDisplayFieldText.textContent=this.beans.agChartsExports._Util.Color.fromString(e).toHexString().toUpperCase(),super.setValue(e))}getValue(){return this.value}},xr={selector:"AG-COLOR-PICKER",component:oP},CX=class extends m.Component{constructor(e){super(),this.chartMenuParamsFactory=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuParamsFactory.addEnableParams("crosshair.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("crosshair"),suppressEnabledCheckbox:!0,useToggle:!0}),t=this.chartMenuParamsFactory.getDefaultCheckboxParams("crosshair.label.enabled","crosshairLabel"),i=this.chartMenuParamsFactory.getDefaultCheckboxParams("crosshair.snap","crosshairSnap"),s=this.chartMenuParamsFactory.getDefaultColorPickerParams("crosshair.stroke","color");this.setTemplate(`<div>
            <ag-group-component data-ref="crosshairGroup">
                <ag-checkbox data-ref="crosshairLabelCheckbox"></ag-checkbox>
                <ag-checkbox data-ref="crosshairSnapCheckbox"></ag-checkbox>
                <ag-color-picker data-ref="crosshairStrokeColorPicker"></ag-color-picker>
            </ag-group-component>
        </div>`,[Nt,m.AgCheckboxSelector,xr],{crosshairGroup:e,crosshairLabelCheckbox:t,crosshairSnapCheckbox:i,crosshairStrokeColorPicker:s})}},SX=class extends m.AgAbstractInputField{constructor(e){super(e,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min:e,max:t,step:i}=this.config;e!=null&&this.setMinValue(e),t!=null&&this.setMaxValue(t),this.setStep(i||1)}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>{const t=e.target.value;this.setValue(t)}})}setMinValue(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this}setMaxValue(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this}setStep(e){return this.eInput.setAttribute("step",e.toString()),this}setValue(e,t){this.min!=null&&(e=Math.max(parseFloat(e),this.min).toString()),this.max!=null&&(e=Math.min(parseFloat(e),this.max).toString());const i=super.setValue(e,t);return this.eInput.value=e,i}},MX={selector:"AG-INPUT-RANGE",component:SX},Un=class extends m.AgAbstractLabel{constructor(e){super(e,`<div class="ag-slider">
            <label data-ref="eLabel"></label>
            <div class="ag-wrapper ag-slider-wrapper">
                <ag-input-range data-ref="eSlider"></ag-input-range>
                <ag-input-number-field data-ref="eText"></ag-input-number-field>
            </div>
        </div>`,[MX,m.AgInputNumberFieldSelector]),this.eLabel=m.RefPlaceholder,this.eSlider=m.RefPlaceholder,this.eText=m.RefPlaceholder,this.labelAlignment="top"}postConstruct(){super.postConstruct(),this.eSlider.addCss("ag-slider-field");const{minValue:e,maxValue:t,textFieldWidth:i,step:s,value:n,onValueChange:a}=this.config;e!=null&&this.setMinValue(e),t!=null&&this.setMaxValue(t),i!=null&&this.setTextFieldWidth(i),s!=null&&this.setStep(s),n!=null&&this.setValue(n),a!=null&&this.onValueChange(a)}onValueChange(e){return this.addManagedListeners(this.eText,{fieldValueChanged:()=>{const t=parseFloat(this.eText.getValue());this.eSlider.setValue(t.toString(),!0),e(t||0)}}),this.addManagedListeners(this.eSlider,{fieldValueChanged:()=>{const t=this.eSlider.getValue();this.eText.setValue(t,!0),e(parseFloat(t))}}),this}setSliderWidth(e){return this.eSlider.setWidth(e),this}setTextFieldWidth(e){return this.eText.setWidth(e),this}setMinValue(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this}setMaxValue(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this}getValue(){return this.eText.getValue()}setValue(e,t){return this.getValue()===e?this:(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}setStep(e){return this.eSlider.setStep(e),this.eText.setStep(e),this}},Mn={selector:"AG-SLIDER",component:Un},DX=class extends m.Component{constructor(e){super(),this.chartMenuParamsFactory=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuParamsFactory.addEnableParams("navigator.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("navigator"),suppressEnabledCheckbox:!0,useToggle:!0}),t=this.chartMenuParamsFactory.getDefaultSliderParams("navigator.height","height",60);t.minValue=10;const i=this.chartMenuParamsFactory.getDefaultCheckboxParams("navigator.miniChart.enabled","miniChart");this.setTemplate(`<div>
            <ag-group-component data-ref="navigatorGroup">
                <ag-slider data-ref="navigatorHeightSlider"></ag-slider>
                <ag-checkbox data-ref="navigatorMiniChartCheckbox"></ag-checkbox>
            </ag-group-component>
        </div>`,[Nt,Mn,m.AgCheckboxSelector],{navigatorGroup:e,navigatorHeightSlider:t,navigatorMiniChartCheckbox:i})}},wX=class extends m.Component{constructor(e){super(),this.chartMenuParamsFactory=e,this.zoomScrollingStepInput=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuParamsFactory.addEnableParams("zoom.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("zoom"),suppressEnabledCheckbox:!0,useToggle:!0}),t=this.chartMenuParamsFactory.getDefaultCheckboxParams("zoom.enableScrolling","scrollingZoom"),i=this.chartMenuParamsFactory.getDefaultSliderParams("zoom.scrollingStep","scrollingStep",1);i.step=.01,i.minValue=i.step;const s=this.chartMenuParamsFactory.getDefaultCheckboxParams("zoom.enableSelecting","selectingZoom");t.onValueChange=(n=>a=>{n&&(n(a),this.zoomScrollingStepInput.setDisabled(!a))})(t.onValueChange),this.setTemplate(`<div>
            <ag-group-component data-ref="zoomGroup">
                <ag-checkbox data-ref="zoomSelectingCheckbox"></ag-checkbox>
                <ag-checkbox data-ref="zoomScrollingCheckbox"></ag-checkbox>
                <ag-slider data-ref="zoomScrollingStepInput"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,m.AgCheckboxSelector,Mn],{zoomGroup:e,zoomScrollingCheckbox:t,zoomScrollingStepInput:i,zoomSelectingCheckbox:s}),this.zoomScrollingStepInput.setDisabled(!t.value)}},AX=["navigator","zoom","animation","crosshair"],IX=class extends m.Component{constructor(e){super('<div class="ag-chart-advanced-settings-wrapper"></div>'),this.chartMenuContext=e}postConstruct(){this.chartPanelFeature=this.createManagedBean(new aP(this.chartMenuContext.chartController,this.getGui(),"ag-chart-advanced-settings-section",(e,t)=>this.createPanels(e,t))),this.chartPanelFeature.refreshPanels()}createPanels(e,t){AX.forEach(i=>{if(!this.isGroupPanelShownForSeries(i,t))return;const s=this.createPanel(i);this.chartPanelFeature.addComponent(s)})}isGroupPanelShownForSeries(e,t){return e==="animation"||Dl(t)&&!NS(t)}createPanel(e){const{chartMenuParamsFactory:t,chartAxisMenuParamsFactory:i}=this.chartMenuContext;switch(e){case"navigator":return new DX(t);case"zoom":return new wX(t);case"animation":return new mX(t);case"crosshair":return new CX(i)}}},TX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="advSettingsMenuFactory"}showMenu(e,t){this.hideMenu();const i=this.createBean(new kX(e));this.activeDialog=this.createBean(new jp({title:this.beans.chartTranslation.translate("advancedSettings"),component:i,width:300,height:400,resizable:!0,movable:!0,centered:!0,closable:!0,afterGuiAttached:()=>{var s;(s=(0,m._findFocusableElements)(i.getGui())[0])==null||s.focus()},closedCallback:()=>{this.activeMenu=this.destroyBean(this.activeMenu),this.activeDialog=void 0,t==null||t.focus({preventScroll:!0})}})),this.activeMenu=i}hideMenu(){this.activeDialog&&this.destroyBean(this.activeDialog)}destroy(){this.activeMenu=this.destroyBean(this.activeMenu),this.activeDialog=this.destroyBean(this.activeDialog),super.destroy()}},kX=class extends m.TabGuardComp{constructor(e){super('<div class="ag-chart-advanced-settings"></div>'),this.chartMenuContext=e}postConstruct(){this.advancedSettingsPanel=this.createManagedBean(new IX(this.chartMenuContext)),this.getGui().appendChild(this.advancedSettingsPanel.getGui()),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),focusTrapActive:!0})}onTabKeyDown(e){if(e.defaultPrevented)return;e.preventDefault();const t=e.shiftKey,i=this.advancedSettingsPanel.getGui(),s=(0,m._findNextFocusableElement)(this.beans,i,!1,t);if(s)s.focus();else{const n=(0,m._findFocusableElements)(i);n.length&&n[t?n.length-1:0].focus()}}},LX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartMenuListFactory"}wireBeans(e){this.popupSvc=e.popupSvc,this.chartMenuSvc=e.chartMenuSvc,this.chartTranslation=e.chartTranslation}showMenuList(e){const{eventSource:t,showMenu:i,chartMenuContext:s}=e,n=this.chartMenuSvc.doChartToolPanelsExist(s.chartController),a=this.mapWithStockItems(this.getMenuItems(s.chartController,n),s,i,t,n);if(!a.length)return;const r=this.createBean(new PX(a));this.activeChartMenuList=r;let o=-1,l="left";this.gos.get("enableRtl")&&(o=1,l="right");const c=r.getGui();this.popupSvc.addPopup({modal:!0,eChild:c,closeOnEsc:!0,closedCallback:()=>{this.destroyBean(r),this.activeChartMenuList=void 0,(0,m._isNothingFocused)(this.beans)&&t.focus({preventScroll:!0})},afterGuiAttached:h=>r.afterGuiAttached(h),positionCallback:()=>{this.popupSvc.positionPopupByComponent({type:"chartMenu",eventSource:t,ePopup:c,alignSide:l,nudgeX:4*o,nudgeY:4,position:"under",keepWithinBounds:!0})},ariaLabel:"Chart Menu"})}getMenuItems(e,t){const i=[...t?["chartEdit"]:[],...e.isEnterprise()?["chartAdvancedSettings"]:[],e.isChartLinked()?"chartUnlink":"chartLink","chartDownload"],s=this.gos.get("chartMenuItems");return s?Array.isArray(s)?s:s((0,m._addGridCommonParams)(this.gos,{defaultItems:i})):i}mapWithStockItems(e,t,i,s,n){if(!e)return[];const a=[];return e.forEach(r=>{let o;if(typeof r=="string"?o=this.getStockMenuItem(r,t,i,s,n):o=b({},r),!o)return;const{subMenu:l}=o;Array.isArray(l)&&(o.subMenu=this.mapWithStockItems(l,t,i,s,n)),a.push(o)}),a}getStockMenuItem(e,t,i,s,n){switch(e){case"chartEdit":return n?this.createMenuItem(this.chartTranslation.translate("chartEdit"),"chartsMenuEdit",i):null;case"chartAdvancedSettings":return this.createMenuItem(this.chartTranslation.translate("chartAdvancedSettings"),"chartsMenuAdvancedSettings",()=>this.chartMenuSvc.openAdvancedSettings(t,s));case"chartUnlink":return t.chartController.isChartLinked()?this.createMenuItem(this.chartTranslation.translate("chartUnlink"),"unlinked",()=>this.chartMenuSvc.toggleLinked(t)):null;case"chartLink":return t.chartController.isChartLinked()?null:this.createMenuItem(this.chartTranslation.translate("chartLink"),"linked",()=>this.chartMenuSvc.toggleLinked(t));case"chartDownload":return this.createMenuItem(this.chartTranslation.translate("chartDownload"),"chartsDownload",()=>this.chartMenuSvc.downloadChart(t))}return null}createMenuItem(e,t,i){return{name:e,icon:(0,m._createIconNoSpan)(t,this.beans,null),action:i}}destroy(){this.destroyBean(this.activeChartMenuList),super.destroy()}},PX=class extends m.Component{constructor(e){super(`
            <div data-ref="eChartsMenu" role="presentation" class="ag-menu ag-chart-menu-popup"></div>
        `),this.menuItems=e,this.eChartsMenu=m.RefPlaceholder}postConstruct(){this.mainMenuList=this.createManagedBean(new Wp(0)),this.mainMenuList.addMenuItems(this.menuItems),this.mainMenuList.addEventListener("closeMenu",this.onHidePopup.bind(this)),this.eChartsMenu.appendChild(this.mainMenuList.getGui())}onHidePopup(){var e;(e=this.hidePopupFunc)==null||e.call(this)}afterGuiAttached({hidePopup:e}){e&&(this.hidePopupFunc=e,this.addDestroyFunc(e)),(0,m._focusInto)(this.mainMenuList.getGui())}},EX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartCrossFilterSvc"}wireBeans(e){this.colModel=e.colModel,this.valueSvc=e.valueSvc,this.filterManager=e.filterManager,(0,m._isClientSideRowModel)(this.gos,e.rowModel)&&(this.clientSideRowModel=e.rowModel)}filter(e,t=!1){var n,a;const i=(a=(n=this.filterManager)==null?void 0:n.getFilterModel())!=null?a:{};if(t){this.resetFilters(i);return}const s=this.extractFilterColId(e);this.isValidColumnFilter(s)?this.updateFilters(i,e,s):(0,m._warn)(154,{colId:s})}resetFilters(e){var i,s;Object.keys(e).length>0&&((i=this.filterManager)==null||i.setFilterModel(null),(s=this.filterManager)==null||s.onFilterChanged({source:"api"}))}updateFilters(e,t,i){var r;const s=this.extractFilterColId(t),n=t.datum[s];if(n===void 0)return;const a=n.toString();if(t.event.metaKey||t.event.ctrlKey){const o=this.getCurrentGridValuesForCategory(i),l=o.includes(a);let c;l?c=o.filter(h=>h!==a):(c=o,c.push(a)),e[i]=this.getUpdatedFilterModel(i,c)}else{const o=[a];e={[i]:this.getUpdatedFilterModel(i,o)}}(r=this.filterManager)==null||r.setFilterModel(e)}getUpdatedFilterModel(e,t){return this.getColumnFilterType(e)==="agMultiColumnFilter"?{filterType:"multi",filterModels:[null,{filterType:"set",values:t}]}:{filterType:"set",values:t}}getCurrentGridValuesForCategory(e){var s;const t=[],i=this.getColumnById(e);return(s=this.clientSideRowModel)==null||s.forEachNodeAfterFilter(n=>{if(i&&!n.group){const a=this.valueSvc.getValue(i,n)+"";t.includes(a)||t.push(a)}}),t}extractFilterColId(e){return e.xKey||e.calloutLabelKey}isValidColumnFilter(e){e.indexOf("-filtered-out")&&(e=e.replace("-filtered-out",""));const t=this.getColumnFilterType(e);return typeof t=="boolean"?t:["agSetColumnFilter","agMultiColumnFilter"].includes(t)}getColumnFilterType(e){const t=this.getColumnById(e);if(t)return t.getColDef().filter}getColumnById(e){return this.colModel.getCol(e)}},RX=["chartUnlink","chartLink","chartDownload","chartMenu"],Jm={settings:"chartSettings",data:"chartData",format:"chartFormat"},NX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartMenuSvc"}wireBeans(e){this.advSettingsMenuFactory=e.advSettingsMenuFactory}downloadChart(e,t,i,s){e.chartController.getChartProxy().downloadChart(t,i,s)}toggleLinked(e){e.chartController.detachChartRange()}openAdvancedSettings(e,t){var i;(i=this.advSettingsMenuFactory)==null||i.showMenu(e,t)}hideAdvancedSettings(){var e;(e=this.advSettingsMenuFactory)==null||e.hideMenu()}getChartToolbarOptions(){const e=["chartMenu"],t=this.gos.getCallback("getChartToolbarItems");return t?t({defaultItems:e}).filter(s=>RX.includes(s)?!0:((0,m._warn)(155,{option:s}),!1)):e}getChartToolPanels(e){var r;const t=this.gos.get("chartToolPanelsDef"),i=(r=t==null?void 0:t.panels)==null?void 0:r.map(o=>{const l=Jm[o];return l||(0,m._warn)(156,{panel:o}),l}).filter(o=>!!o);let s=i!=null?i:Object.values(Jm);e.isPivotChart()&&(s=s.filter(o=>o!=="chartData"));const n=t==null?void 0:t.defaultToolPanel,a=n&&Jm[n]||s[0];return{panels:s,defaultPanel:a}}doesChartToolbarExist(){return this.getChartToolbarOptions().length>0}doChartToolPanelsExist(e){const{panels:t}=this.getChartToolPanels(e);return t.length>0}},OX={pivotChartTitle:"Pivot Chart",rangeChartTitle:"Range Chart",settings:"Chart",data:"Set Up",format:"Customize",categories:"Categories",defaultCategory:"(None)",series:"Series",switchCategorySeries:"Switch Category / Series",categoryValues:"Category Values",seriesLabels:"Series Labels",aggregate:"Aggregate",xyValues:"X Y Values",paired:"Paired Mode",axis:"Axis",xAxis:"Horizontal Axis",yAxis:"Vertical Axis",polarAxis:"Polar Axis",radiusAxis:"Radius Axis",navigator:"Navigator",zoom:"Zoom",animation:"Animation",crosshair:"Crosshair",color:"Color",thickness:"Thickness",preferredLength:"Preferred Length",xType:"X Type",axisType:"Axis Type",automatic:"Automatic",category:"Category",number:"Number",time:"Time",timeFormat:"Time Format",autoRotate:"Auto Rotate",labelRotation:"Rotation",circle:"Circle",polygon:"Polygon",square:"Square",cross:"Cross",diamond:"Diamond",plus:"Plus",triangle:"Triangle",heart:"Heart",orientation:"Orientation",fixed:"Fixed",parallel:"Parallel",perpendicular:"Perpendicular",radiusAxisPosition:"Position",ticks:"Ticks",gridLines:"Grid Lines",width:"Width",height:"Height",length:"Length",padding:"Padding",spacing:"Spacing",chartStyle:"Chart Style",title:"Title",chartTitles:"Titles",chartTitle:"Chart Title",chartSubtitle:"Subtitle",horizontalAxisTitle:"Horizontal Axis Title",verticalAxisTitle:"Vertical Axis Title",polarAxisTitle:"Polar Axis Title",titlePlaceholder:"Chart Title",background:"Background",font:"Font",weight:"Weight",top:"Top",right:"Right",bottom:"Bottom",left:"Left",labels:"Labels",calloutLabels:"Callout Labels",sectorLabels:"Sector Labels",positionRatio:"Position Ratio",size:"Size",shape:"Shape",minSize:"Minimum Size",maxSize:"Maximum Size",legend:"Legend",position:"Position",markerSize:"Marker Size",markerStroke:"Marker Stroke",markerPadding:"Marker Padding",itemSpacing:"Item Spacing",itemPaddingX:"Item Padding X",itemPaddingY:"Item Padding Y",layoutHorizontalSpacing:"Horizontal Spacing",layoutVerticalSpacing:"Vertical Spacing",strokeWidth:"Stroke Width",offset:"Offset",offsets:"Offsets",tooltips:"Tooltips",callout:"Callout",markers:"Markers",shadow:"Shadow",blur:"Blur",xOffset:"X Offset",yOffset:"Y Offset",lineWidth:"Line Width",lineDash:"Line Dash",lineDashOffset:"Dash Offset",scrollingZoom:"Scrolling",scrollingStep:"Scrolling Step",selectingZoom:"Selecting",durationMillis:"Duration (ms)",crosshairLabel:"Label",crosshairSnap:"Snap to Node",normal:"Normal",bold:"Bold",italic:"Italic",boldItalic:"Bold Italic",predefined:"Predefined",fillOpacity:"Fill Opacity",strokeColor:"Line Color",strokeOpacity:"Line Opacity",miniChart:"Mini-Chart",histogramBinCount:"Bin count",connectorLine:"Connector Line",seriesItems:"Series Items",seriesItemType:"Item Type",seriesItemPositive:"Positive",seriesItemNegative:"Negative",seriesItemLabels:"Item Labels",columnGroup:"Column",barGroup:"Bar",pieGroup:"Pie",lineGroup:"Line",scatterGroup:"X Y (Scatter)",areaGroup:"Area",polarGroup:"Polar",statisticalGroup:"Statistical",hierarchicalGroup:"Hierarchical",specializedGroup:"Specialized",combinationGroup:"Combination",groupedColumnTooltip:"Grouped",stackedColumnTooltip:"Stacked",normalizedColumnTooltip:"100% Stacked",groupedBarTooltip:"Grouped",stackedBarTooltip:"Stacked",normalizedBarTooltip:"100% Stacked",pieTooltip:"Pie",donutTooltip:"Donut",lineTooltip:"Line",stackedLineTooltip:"Stacked",normalizedLineTooltip:"100% Stacked",groupedAreaTooltip:"Area",stackedAreaTooltip:"Stacked",normalizedAreaTooltip:"100% Stacked",scatterTooltip:"Scatter",bubbleTooltip:"Bubble",histogramTooltip:"Histogram",radialColumnTooltip:"Radial Column",radialBarTooltip:"Radial Bar",radarLineTooltip:"Radar Line",radarAreaTooltip:"Radar Area",nightingaleTooltip:"Nightingale",rangeBarTooltip:"Range Bar",rangeAreaTooltip:"Range Area",boxPlotTooltip:"Box Plot",treemapTooltip:"Treemap",sunburstTooltip:"Sunburst",waterfallTooltip:"Waterfall",heatmapTooltip:"Heatmap",columnLineComboTooltip:"Column & Line",areaColumnComboTooltip:"Area & Column",customComboTooltip:"Custom Combination",innerRadius:"Inner Radius",startAngle:"Start Angle",endAngle:"End Angle",reverseDirection:"Reverse Direction",groupPadding:"Group Padding",seriesPadding:"Series Padding",tile:"Tile",whisker:"Whisker",cap:"Cap",capLengthRatio:"Length Ratio",labelPlacement:"Placement",inside:"Inside",outside:"Outside",noDataToChart:"No data available to be charted.",pivotChartRequiresPivotMode:"Pivot Chart requires Pivot Mode enabled.",chartSettingsToolbarTooltip:"Menu",chartLinkToolbarTooltip:"Linked to Grid",chartUnlinkToolbarTooltip:"Unlinked from Grid",chartDownloadToolbarTooltip:"Download Chart",chartMenuToolbarTooltip:"Menu",chartEdit:"Edit Chart",chartAdvancedSettings:"Advanced Settings",chartLink:"Link to Grid",chartUnlink:"Unlink from Grid",chartDownload:"Download Chart",histogramFrequency:"Frequency",seriesChartType:"Series Chart Type",seriesType:"Series Type",secondaryAxis:"Secondary Axis",seriesAdd:"Add a series",categoryAdd:"Add a category",bar:"Bar",column:"Column",histogram:"Histogram",advancedSettings:"Advanced Settings",direction:"Direction",horizontal:"Horizontal",vertical:"Vertical",seriesGroupType:"Group Type",groupedSeriesGroupType:"Grouped",stackedSeriesGroupType:"Stacked",normalizedSeriesGroupType:"100% Stacked",legendEnabled:"Enabled",invalidColor:"Color value is invalid",groupedColumnFull:"Grouped Column",stackedColumnFull:"Stacked Column",normalizedColumnFull:"100% Stacked Column",groupedBarFull:"Grouped Bar",stackedBarFull:"Stacked Bar",normalizedBarFull:"100% Stacked Bar",stackedAreaFull:"Stacked Area",normalizedAreaFull:"100% Stacked Area",stackedLineFull:"Stacked Line",normalizedLineFull:"100% Stacked Line",customCombo:"Custom Combination",funnel:"Funnel",coneFunnel:"Cone Funnel",pyramid:"Pyramid",funnelGroup:"Funnel",funnelTooltip:"Funnel",coneFunnelTooltip:"Cone Funnel",pyramidTooltip:"Pyramid",dropOff:"Drop-Off",stageLabels:"Stage Labels",reverse:"Reverse",groupedColumn:"Grouped",stackedColumn:"Stacked",pie:"Pie",donut:"Donut",line:"Line",scatter:"Scatter",bubble:"Bubble",area:"Area",stackedArea:"Stacked",radarLine:"Radar Line",radarArea:"Radar Area",nightingale:"Nightingale",radialColumn:"Radial Column",radialBar:"Radial Bar",boxPlot:"Box Plot",rangeBar:"Range Bar",rangeArea:"Range Area",treemap:"Treemap",sunburst:"Sunburst",waterfall:"Waterfall",heatmap:"Heatmap",columnLineCombo:"Column & Line",AreaColumnCombo:"Area & Column",ariaChartMenuClose:"Close Chart Edit Menu",ariaChartSelected:"Selected",group:"Group",timeFormatSlashesDDMMYYYY:"DD/MM/YYYY",timeFormatSlashesMMDDYYYY:"MM/DD/YYYY",timeFormatSlashesDDMMYY:"DD/MM/YY",timeFormatSlashesMMDDYY:"MM/DD/YY",timeFormatDotsDDMYY:"DD.M.YY",timeFormatDotsMDDYY:"M.DD.YY",timeFormatDashesYYYYMMDD:"YYYY-MM-DD",timeFormatSpacesDDMMMMYYYY:"DD MMMM YYYY",timeFormatHHMMSS:"HH:MM:SS",timeFormatHHMMSSAmPm:"HH:MM:SS AM/PM",sum:"Sum",first:"First",last:"Last",min:"Min",max:"Max",count:"Count",avg:"Average"},FX=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartTranslation"}translate(e){const t=this.getLocaleTextFunc(),i=OX[e];return t(e,i)}},Gd=e=>t=>t==null?!0:e(t),lP=e=>typeof e=="string",cP=e=>typeof e=="boolean",BX=e=>typeof e=="object",fo=(e,t)=>i=>`AG Grid - unable to update chart as invalid params supplied:  \`${e}: ${i}\`, expected ${t}.`,hP=e=>`${e} is not supported in AG Charts Community ('ag-charts-enterprise' hasn't been loaded). See https://www.ag-grid.com/javascript-data-grid/integrated-charts-installation/ for more details.`,_X=["doughnut"],zS=["type","chartId","chartType","chartThemeName","chartThemeOverrides","unlinkChart"];function GX(e){return!!QL(e)||RS(e)}function zX(e){return _X.includes(e)}var VX=Gd(e=>{if(GX(e))return!0;if(zX(e)){const t=Zp(e);return(0,m._warnOnce)(`The chart type '${e}' has been deprecated. Please use '${t}' instead.`),t}return!1}),jX=Gd(e=>typeof e=="object"),HX=Gd(e=>typeof e=="object"),WX=Gd(e=>typeof e=="string"||typeof e=="function"),dP=e=>({property:"chartType",validationFn:Gd(t=>e||!t||!O8(t)),warnMessage:t=>hP(`The '${t}' chart type`)}),uP=e=>({property:"switchCategorySeries",validationFn:Gd(t=>{if(!t||e)return!0}),warnMessage:()=>hP("'switchCategorySeries' has been ignored as it"),warnIfFixed:!0}),VS=()=>[{property:"chartId",validationFn:lP,warnMessage:fo("chartId","string")},{property:"chartType",validationFn:VX,warnMessage:fo("chartType","ChartType")},{property:"chartThemeName",validationFn:lP,warnMessage:fo("chartThemeName","string")},{property:"chartThemeOverrides",validationFn:jX,warnMessage:fo("chartThemeOverrides","AgChartThemeOverrides")},{property:"unlinkChart",validationFn:cP,warnMessage:fo("unlinkChart","boolean")}],pP=e=>[{property:"cellRange",validationFn:HX,warnMessage:fo("cellRange","ChartParamsCellRange")},{property:"suppressChartRanges",validationFn:cP,warnMessage:fo("suppressChartRanges","boolean")},{property:"aggFunc",validationFn:WX,warnMessage:fo("aggFunc","string or IAggFunc")},uP(e)];function UX(e,t){switch(e.type){case"rangeChartUpdate":return $X(e,t);case"pivotChartUpdate":return YX(e);case"crossFilterChartUpdate":return XX(e,t);default:return(0,m._warnOnce)(`Invalid value supplied for 'type': ${e.type}. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.`),!1}}function KX(e,t){return ey(e,[dP(t),uP(t)])}function $X(e,t){const i=[...VS(),dP(t),...pP(t),{property:"seriesChartTypes",validationFn:s=>s===void 0||Array.isArray(s)&&s.every(BX),warnMessage:fo("seriesChartTypes","Array of SeriesChartType")}];return ey(e,i,[...zS,"cellRange","suppressChartRanges","switchCategorySeries","aggFunc","seriesChartTypes","seriesGroupType"],"UpdateRangeChartParams")}function YX(e){const t=[...VS()];return ey(e,t,[...zS],"UpdatePivotChartParams")}function XX(e,t){const i=[...VS(),...pP(t)];return ey(e,i,[...zS,"cellRange","suppressChartRanges","aggFunc"],"UpdateCrossFilterChartParams")}function ey(e,t,i,s){let n;for(const a of t){const{property:r,validationFn:o,warnMessage:l,warnIfFixed:c}=a;if(r in e){const h=e[r],d=o(h);if(d===!0)continue;if(d===!1)return(0,m._warnOnce)(l(h)),!1;n=n||b({},e),n[r]=d,c&&(0,m._warnOnce)(l(h))}}if(i){for(const a of Object.keys(e))if(!i.includes(a))return(0,m._warnOnce)(`Unexpected property supplied. ${s} does not contain: \`${a}\`.`),!1}return n||!0}var gP=["ag-default","ag-material","ag-sheets","ag-polychroma","ag-vivid"],ZX=class extends m.BeanStub{constructor(e){super(),this.model=e,this.isEnterprise=()=>this.agChartsExports.isEnterprise}wireBeans(e){this.rangeSvc=e.rangeSvc,this.agChartsExports=e.agChartsExports}postConstruct(){this.setChartRange(),this.model.unlinked&&this.rangeSvc&&this.rangeSvc.setCellRanges([]);const e=this.updateForGridChange.bind(this,{});this.addManagedEventListeners({cellSelectionChanged:t=>{t.id&&t.id===this.model.chartId&&this.updateForRangeChange()},columnMoved:e,columnPinned:e,columnVisible:e,columnRowGroupChanged:e,modelUpdated:e,cellValueChanged:this.updateForDataChange.bind(this)})}update(e){if(!this.validUpdateType(e))return!1;const t=UX(e,this.agChartsExports.isEnterprise);if(!t)return!1;const i=t===!0?e:t;return this.applyValidatedChartParams(i),!0}applyValidatedChartParams(e){var l,c,h,d,u,p,g,f,y;const{chartId:t,chartType:i,chartThemeName:s,unlinkChart:n}=e,a={chartId:t,pivotChart:this.model.pivotChart,chartType:i!=null?i:this.model.chartType,chartThemeName:s!=null?s:this.model.chartThemeName,unlinkChart:n!=null?n:this.model.unlinked,cellRange:this.model.suppliedCellRange,switchCategorySeries:this.model.switchCategorySeries,aggFunc:this.model.aggFunc,seriesChartTypes:void 0,suppressChartRanges:!1,crossFiltering:!1},r=b({},a);switch(e.type){case"rangeChartUpdate":r.cellRange=(l=this.createCellRange(e))!=null?l:this.model.suppliedCellRange,r.switchCategorySeries=(c=e.switchCategorySeries)!=null?c:this.model.switchCategorySeries,r.aggFunc=(h=e.aggFunc)!=null?h:this.model.aggFunc,r.seriesChartTypes=e.seriesChartTypes,r.suppressChartRanges=(d=e.suppressChartRanges)!=null?d:this.model.suppressChartRanges,r.seriesGroupType=(u=e.seriesGroupType)!=null?u:this.model.seriesGroupType;break;case"crossFilterChartUpdate":r.cellRange=(p=this.createCellRange(e))!=null?p:this.model.suppliedCellRange,r.switchCategorySeries=!1,r.aggFunc=(g=e.aggFunc)!=null?g:this.model.aggFunc,r.crossFiltering=!0,r.suppressChartRanges=(f=e.suppressChartRanges)!=null?f:this.model.suppressChartRanges;break;case"pivotChartUpdate":r.switchCategorySeries=!1;break}this.model.updateModel(r),r.unlinkChart||r.suppressChartRanges?(y=this.rangeSvc)==null||y.setCellRanges([]):this.setChartRange()}updateForGridChange(e){if(this.model.unlinked)return;const{maintainColState:t,setColsFromRange:i}=e!=null?e:{};this.model.updateCellRanges({maintainColState:t,setColsFromRange:i}),this.model.updateData(),this.setChartRange()}updateForDataChange(){this.model.unlinked||(this.model.updateData(),this.raiseChartModelUpdateEvent())}updateForRangeChange(){this.updateForGridChange({setColsFromRange:!0}),this.raiseChartRangeSelectionChangedEvent()}updateForPanelChange(e){this.model.updateCellRanges(e),this.model.updateData(),e.skipAnimation&&this.getChartProxy().getChartRef().skipAnimations(),this.setChartRange(),this.raiseChartRangeSelectionChangedEvent()}updateThemeOverrides(e){this.chartProxy.updateThemeOverrides(e)}getChartUpdateParams(e){const i=this.getSelectedValueColState().map(r=>({colId:r.colId,displayName:r.displayName})),s=this.getChartData(),n=this.getSelectedDimensions(),a={data:s,groupData:this.model.groupChartData,grouping:this.isGrouping(),categories:n.map(r=>{var o;return{id:r.colId,name:r.displayName,chartDataType:(o=this.model.categoryAxisType)!=null?o:this.model.getChartDataType(r.colId)}}),fields:i,chartId:this.getChartId(),getCrossFilteringContext:()=>({lastSelectedChartId:"xxx"}),seriesChartTypes:this.getSeriesChartTypes(),updatedOverrides:e,seriesGroupType:this.model.seriesGroupType};return this.isCategorySeriesSwitched()?this.invertCategorySeriesParams(a):a}invertCategorySeriesParams(e){const[t]=e.categories,i=[{id:br,name:""}],s=e.data.map((a,r)=>{const o=`${t.id}:${r}`,l=a[t.id],c=l==null?"":String(l);return{colId:o,displayName:c}}),n=e.fields.map(a=>{const r={[br]:a.displayName};for(const[o,l]of e.data.entries()){const c=`${t.id}:${o}`,h=l[a.colId];r[c]=h}return r});return E(b({},e),{categories:i,fields:s,data:n})}getChartModel(){var i,s;const e=this.model.pivotChart?"pivot":"range",t=this.isComboChart()?this.model.comboChartModel.seriesChartTypes:void 0;return{modelType:e,chartId:this.model.chartId,chartType:this.model.chartType,chartThemeName:this.getChartThemeName(),chartOptions:(i=this.chartProxy)==null?void 0:i.getChartThemeOverrides(),chartPalette:(s=this.chartProxy)==null?void 0:s.getChartPalette(),cellRange:this.getCellRangeParams(),switchCategorySeries:this.model.switchCategorySeries,suppressChartRanges:this.model.suppressChartRanges,aggFunc:this.model.aggFunc,unlinkChart:this.model.unlinked,seriesChartTypes:t,seriesGroupType:this.model.seriesGroupType}}getChartId(){return this.model.chartId}getChartData(){return this.model.chartData}getChartType(){return this.model.chartType}setChartType(e){this.updateMultiSeriesAndCategory(this.model.chartType,e),this.model.chartType=e,this.model.comboChartModel.updateSeriesChartTypes(),this.model.switchCategorySeries=!1,this.model.categoryAxisType=void 0,this.model.seriesGroupType=void 0,this.raiseChartModelUpdateEvent()}isCategorySeriesSwitched(){return this.model.switchCategorySeries&&!this.model.isGrouping()}switchCategorySeries(e){eP(this.getChartType())&&(this.model.switchCategorySeries=e,this.raiseChartModelUpdateEvent())}getAggFunc(){return this.model.aggFunc}setAggFunc(e,t){this.model.aggFunc!==e&&(this.model.aggFunc=e,!t&&(this.model.updateData(),this.raiseChartModelUpdateEvent()))}updateMultiSeriesAndCategory(e,t){var o,l;const i=(c,h)=>{let d=0;for(const u of c)u.selected&&(d>=h?u.selected=!1:d++);d===0&&(c[0].selected=!0)},s=FS(t),n=Zm(t),a=s!=null&&((o=FS(e))!=null?o:100)>(s!=null?s:100),r=n!=null&&((l=Zm(e))!=null?l:100)>(n!=null?n:100);a&&i(this.model.dimensionColState,s),r&&i(this.model.valueColState,n),(a||r)&&(this.model.resetCellRanges(a,r),this.setChartRange(!0))}setChartThemeName(e,t){this.model.chartThemeName=e,t||this.raiseChartModelUpdateEvent()}getChartThemeName(){return this.model.chartThemeName}isPivotChart(){return this.model.pivotChart}isPivotMode(){return this.model.isPivotMode()}isGrouping(){return this.model.isGrouping()}isCrossFilterChart(){return this.model.crossFiltering}getThemeNames(){return this.gos.get("chartThemes")||gP}getThemes(){return this.getThemeNames().map(t=>{const s=_S(t,this.agChartsExports._Theme)?t:this.chartProxy.lookupCustomChartTheme(t);return this.agChartsExports._Theme.getChartTheme(s)})}getPalettes(){return this.getThemes().map(t=>t.palette)}getValueColState(){return this.model.valueColState.map(this.displayNameMapper.bind(this))}getSelectedValueColState(){return this.getValueColState().filter(e=>e.selected)}getSelectedDimensions(){return this.model.getSelectedDimensions()}displayNameMapper(e){const{column:t}=e;if(t)e.displayName=this.model.getColDisplayName(t,this.model.isPivotMode());else{const i=this.model.colNames[e.colId];e.displayName=i?i.join(" - "):this.model.getColDisplayName(t)}return e}getColStateForMenu(){return{dimensionCols:this.model.dimensionColState,valueCols:this.getValueColState()}}setChartRange(e=!1){this.rangeSvc&&!this.model.suppressChartRanges&&!this.model.unlinked&&this.rangeSvc.setCellRanges(this.getCellRanges()),e||this.raiseChartModelUpdateEvent()}detachChartRange(){this.model.unlinked=!this.model.unlinked,this.model.unlinked?this.rangeSvc&&this.rangeSvc.setCellRanges([]):this.updateForGridChange(),this.dispatchLocalEvent({type:"chartLinkedChanged"})}setChartProxy(e){this.chartProxy=e}getChartProxy(){return this.chartProxy}isActiveXYChart(){return["scatter","bubble"].includes(this.getChartType())}isChartLinked(){return!this.model.unlinked}customComboExists(){const e=this.model.comboChartModel.savedCustomSeriesChartTypes;return e&&e.length>0}getSeriesChartTypes(){return this.model.comboChartModel.seriesChartTypes}isComboChart(e){return this.model.isComboChart(e)}updateSeriesChartType(e,t,i){const s=this.model.comboChartModel.seriesChartTypes.find(n=>n.colId===e);if(s){const n=this.model.chartType!=="customCombo";n&&(this.model.chartType="customCombo");const a=s.chartType;t!=null&&(s.chartType=t),i!=null&&(s.secondaryAxis=i),this.model.comboChartModel.savedCustomSeriesChartTypes=this.model.comboChartModel.seriesChartTypes,this.model.comboChartModel.updateSeriesChartTypes(),this.updateForDataChange(),n&&this.dispatchLocalEvent({type:"chartTypeChanged"}),a!==t&&this.dispatchLocalEvent({type:"chartSeriesChartTypeChanged"}),this.raiseChartOptionsChangedEvent()}}getActiveSeriesChartTypes(){const e=this.getSelectedValueColState().map(t=>t.colId);return this.getSeriesChartTypes().filter(t=>e.includes(t.colId))}getChartSeriesTypes(e){const t=e!=null?e:this.getChartType();return this.isComboChart(t)?["line","bar","area"]:[Ot(t)]}getChartSeriesType(){const e=this.getSeriesChartTypes();if(e.length===0)return"bar";const t=e[0].chartType;return t==="columnLineCombo"?"bar":t==="areaColumnCombo"?"area":Ot(t)}getCellRanges(){return[this.model.dimensionCellRange,this.model.valueCellRange].filter(e=>e)}createCellRange(e){var t;return e.cellRange&&((t=this.rangeSvc)==null?void 0:t.createPartialCellRangeFromRangeParams(e.cellRange,!0))}validUpdateType(e){var n;if(!e.type)return(0,m._warn)(136),!1;const t={"Range Chart":()=>!this.isPivotChart()&&!this.isCrossFilterChart(),"Pivot Chart":()=>this.isPivotChart(),"Cross Filter Chart":()=>this.isCrossFilterChart()},i=(n=Object.keys(t).find(a=>t[a]()))!=null?n:"Range Chart",s=e.type===`${i[0].toLowerCase()}${i.slice(1).replace(/ /g,"")}Update`;return s||(0,m._warn)(137,{currentChartType:i,type:e.type}),s}getCellRangeParams(){const e=this.getCellRanges(),t=e[0],i=t&&t.startRow||null,s=t&&t.endRow||null;return{rowStartIndex:i&&i.rowIndex,rowStartPinned:i&&i.rowPinned,rowEndIndex:s&&s.rowIndex,rowEndPinned:s&&s.rowPinned,columns:e.reduce((n,a)=>n.concat(a.columns.map(r=>r.getId())),[])}}setCategoryAxisType(e){this.model.categoryAxisType=e,this.raiseChartModelUpdateEvent()}getSeriesGroupType(){var e;return(e=this.model.seriesGroupType)!=null?e:this.chartProxy.getSeriesGroupType()}setSeriesGroupType(e){this.model.seriesGroupType=e,this.raiseChartModelUpdateEvent()}raiseChartModelUpdateEvent(){this.dispatchLocalEvent({type:"chartModelUpdate"}),this.raiseChartOptionsChangedEvent()}raiseChartUpdatedEvent(){this.dispatchLocalEvent({type:"chartUpdated"})}raiseChartApiUpdateEvent(){this.dispatchLocalEvent({type:"chartApiUpdate"})}raiseChartOptionsChangedEvent(){var i;const{chartId:e,chartType:t}=this.getChartModel();this.eventSvc.dispatchEvent({type:"chartOptionsChanged",chartId:e,chartType:t,chartThemeName:this.getChartThemeName(),chartOptions:(i=this.chartProxy)==null?void 0:i.getChartThemeOverrides()})}raiseChartRangeSelectionChangedEvent(){this.eventSvc.dispatchEvent({type:"chartRangeSelectionChanged",id:this.model.chartId,chartId:this.model.chartId,cellRange:this.getCellRangeParams()})}destroy(){super.destroy(),this.rangeSvc&&this.rangeSvc.setCellRanges([])}},qX=class extends wl{getAxes(e){const t=[{type:this.getXAxisType(e),position:"bottom"},{type:"number",position:"left"}];if(this.isNormalised()){const i=t[1];i.label=E(b({},i.label),{formatter:s=>Math.round(s.value)+"%"})}return t}getSeries(e){const[t]=e.categories,i=e.fields.map(s=>({type:this.standaloneChartType,xKey:t.id,xName:t.name,yKey:s.colId,yName:s.displayName,normalizedTo:this.chartType==="normalizedArea"?100:void 0,stacked:["normalizedArea","stackedArea"].includes(this.chartType)}));return this.crossFiltering?this.extractLineAreaCrossFilterSeries(i,e):i}isNormalised(){return!this.crossFiltering&&this.chartType==="normalizedArea"}},QX=new Set(["bar","groupedBar","stackedBar","normalizedBar"]),JX=class extends wl{getAxes(e){const t=[{type:this.getXAxisType(e),position:this.isHorizontal()?"left":"bottom"},{type:"number",position:this.isHorizontal()?"bottom":"left"}];if(this.isNormalised()){const i=t[1];i.label=E(b({},i.label),{formatter:s=>Math.round(s.value)+"%"})}return t}getSeries(e){const[t]=e.categories,i=e.fields.map(s=>({type:this.standaloneChartType,direction:this.isHorizontal()?"horizontal":"vertical",stacked:this.crossFiltering||B8(this.chartType),normalizedTo:this.isNormalised()?100:void 0,xKey:t.id,xName:t.name,yKey:s.colId,yName:s.displayName}));return this.crossFiltering?this.extractCrossFilterSeries(i):i}extractCrossFilterSeries(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i],n=E(b({},s),{listeners:{nodeClick:this.crossFilterCallback}}),a=E(b({},n),{yKey:`${n.yKey}-filtered-out`,showInLegend:!1});t.push(n),t.push(a)}return t}isNormalised(){const e=["normalizedColumn","normalizedBar"];return!this.crossFiltering&&e.includes(this.chartType)}isHorizontal(){return QX.has(this.chartType)}},eZ=class extends wl{getAxes(e){const t=[{type:this.getXAxisType(e),position:"bottom"},{type:"number",position:"left"}];if(this.isNormalised()){const i=t[1];i.label=E(b({},i.label),{formatter:s=>Math.round(s.value)+"%"})}return t}getSeries(e){const[t]=e.categories,i=["normalizedLine","stackedLine"].includes(this.chartType),s=e.fields.map(n=>({type:this.standaloneChartType,xKey:t.id,xName:t.name,yKey:n.colId,yName:n.displayName,normalizedTo:i&&this.isNormalised()?100:void 0,stacked:i}));return this.crossFiltering?this.extractLineAreaCrossFilterSeries(s,e):s}isNormalised(){const e=["normalizedLine"];return!this.crossFiltering&&e.includes(this.chartType)}},tZ=class extends wl{getAxes(e){return[{type:"number",position:"bottom"},{type:"number",position:"left"}]}getSeries(e){const[t]=e.categories,i=this.isPaired(),s=this.getSeriesDefinitions(e.fields,i),n=t.id===br?void 0:t,a=s.map(r=>{var l,c,h,d,u;return r!=null&&r.sizeField?{type:"bubble",xKey:r.xField.colId,xName:(l=r.xField.displayName)!=null?l:void 0,yKey:r.yField.colId,yName:(c=r.yField.displayName)!=null?c:void 0,title:`${r.yField.displayName} vs ${r.xField.displayName}`,sizeKey:r.sizeField.colId,sizeName:(h=r.sizeField.displayName)!=null?h:"",labelKey:n?n.id:r.yField.colId,labelName:n?n.name:void 0}:{type:"scatter",xKey:r.xField.colId,xName:(d=r.xField.displayName)!=null?d:void 0,yKey:r.yField.colId,yName:(u=r.yField.displayName)!=null?u:void 0,title:`${r.yField.displayName} vs ${r.xField.displayName}`,labelKey:n?n.id:r.yField.colId,labelName:n?n.name:void 0}});return this.crossFiltering?this.extractCrossFilterSeries(a,e):a}extractCrossFilterSeries(e,t){const{data:i}=t,s=l=>`${l}-filtered-out`,n=(l,c)=>{var d;const h=[1/0,-1/0];if(c!=null)for(const u of l){const p=(d=u[c])!=null?d:u[s(c)];p<h[0]&&(h[0]=p),p>h[1]&&(h[1]=p)}if(h[0]<=h[1])return h},a=l=>{let c;if(l.type==="bubble"){const{sizeKey:h}=l;c=n(i,h)}return E(b({},l),{domain:c,highlightStyle:{item:{fill:"yellow"}},listeners:E(b({},l.listeners),{nodeClick:this.crossFilterCallback})})},r=l=>{const{yKey:c,xKey:h}=l;let d={};return l.type==="bubble"&&(d={sizeKey:s(l.sizeKey)}),E(b(b({},l),d),{yKey:s(c),xKey:s(h),showInLegend:!1,listeners:E(b({},l.listeners),{nodeClick:u=>{const p=u.datum[s(h)],g=E(b({},u),{xKey:h,datum:E(b({},u.datum),{[h]:p})});this.crossFilterCallback(g)}})})},o=e.map(a);return[...o,...o.map(r)]}getSeriesDefinitions(e,t){if(e.length<2)return[];const i=this.chartType==="bubble";if(t)return i?e.map((n,a)=>a%3===0?{xField:n,yField:e[a+1],sizeField:e[a+2]}:null).filter(n=>n&&n.yField&&n.sizeField):e.map((n,a)=>a%2===0?{xField:n,yField:e[a+1]}:null).filter(n=>n&&n.yField);const s=e[0];return i?e.map((n,a)=>a%2===1?{xField:s,yField:n,sizeField:e[a+1]}:null).filter(n=>n&&n.sizeField):e.filter((n,a)=>a>0).map(n=>({xField:s,yField:n}))}},iZ=class extends wl{getAxes(e){const t=e?e.fields:[],i=new Map(t.map(r=>[r.colId,r])),{primaryYKeys:s,secondaryYKeys:n}=this.getYKeys(t,e.seriesChartTypes),a=[{type:this.getXAxisType(e),position:"bottom"}];return s.length>0&&a.push({type:"number",keys:s,position:"left"}),n.length>0&&n.forEach(r=>{const o=i.get(r);if(!(o&&o.colId===r))return;const c={type:"number",keys:[r],position:"right"};a.push(c)}),a}getSeries(e){const{fields:t,seriesChartTypes:i}=e,[s]=e.categories;return t.map(n=>{const a=i.find(r=>r.colId===n.colId);if(a){const r=a.chartType,l=["groupedColumn","groupedBar"].includes(r)?{grouped:!0}:{};return b({type:Ot(r),xKey:s.id,yKey:n.colId,yName:n.displayName,stacked:["stackedArea","stackedColumn"].includes(r)},l)}})}getYKeys(e,t){const i=[],s=[];return e.forEach(n=>{const a=n.colId,r=t.find(o=>o.colId===a);r&&(r.secondaryAxis?s.push(a):i.push(a))}),{primaryYKeys:i,secondaryYKeys:s}}};function sZ(e){const t=e.currentOffset;e.currentOffset-=e.offsetAmount;const i=e.currentOffset;return e.currentOffset-=e.offsetAmount,{outerRadiusOffset:t,innerRadiusOffset:i}}var nZ=class extends _d{getUpdateOptions(e,t){return E(b({},t),{data:this.crossFiltering?this.getCrossFilterData(e):e.data,series:this.getSeries(e)})}getSeries(e){const[t]=e.categories,i=e.fields.length,s={currentOffset:0,offsetAmount:i>1?20:40},n=this.getFields(e).map(a=>{const r={type:this.standaloneChartType,angleKey:a.colId,angleName:a.displayName,sectorLabelKey:a.colId,calloutLabelName:t.name,calloutLabelKey:t.id};if(this.chartType==="donut"||this.chartType==="doughnut"){const{outerRadiusOffset:o,innerRadiusOffset:l}=sZ(s),c=a.displayName?{title:{text:a.displayName,showInLegend:i>1}}:void 0;return b(E(b({},r),{type:"donut",outerRadiusOffset:o,innerRadiusOffset:l}),c)}return r});return this.crossFiltering?this.extractCrossFilterSeries(n):n}getCrossFilterData(e){const t=e.fields[0].colId,i=`${t}-filtered-out`;return e.data.map(s=>{const n=s[t]+s[i];return s[`${t}-total`]=n,s[i]=1,s[t]=s[t]/n,s})}extractCrossFilterSeries(e){const t=e[0],i=t.angleKey,s=E(b({},t),{radiusMin:0,radiusMax:1,listeners:{nodeClick:this.crossFilterCallback},legendItemKey:t.calloutLabelKey,angleKey:`${i}-total`}),n=E(b({},s),{radiusKey:i,sectorLabelKey:`${i}-total`});return[E(b({},s),{radiusKey:`${i}-filtered-out`,showInLegend:!1}),n]}getFields(e){return this.chartType==="pie"?e.fields.slice(0,1):e.fields}},aZ=class extends m.Component{constructor(){super('<div class="ag-chart-menu" data-ref="eMenu"></div>'),this.eMenu=m.RefPlaceholder,this.buttonListenersDestroyFuncs=[]}wireBeans(e){this.chartTranslation=e.chartTranslation}updateParams(e){const{buttons:t}=e;this.createButtons(t)}createButtons(e){this.buttonListenersDestroyFuncs.forEach(i=>i==null?void 0:i()),this.buttonListenersDestroyFuncs=[];const t=this.eMenu;(0,m._clearElement)(t),e.forEach(i=>{const{buttonName:s,iconName:n,callback:a}=i,r=this.createButton(n),o=this.chartTranslation.translate(s+"ToolbarTooltip");o&&r instanceof HTMLElement&&(r.title=o),this.buttonListenersDestroyFuncs.push(...this.addManagedElementListeners(r,{click:l=>a(l.currentTarget)})),t.appendChild(r)})}createButton(e){const t=(0,m._createIconNoSpan)(e,this.beans);t.classList.add("ag-chart-menu-icon");const i=(0,m._createElement)({tag:"button",attrs:{type:"button"},cls:"ag-chart-menu-toolbar-button"});return i.appendChild(t),i}destroy(){this.buttonListenersDestroyFuncs=[],super.destroy()}},rZ=".ag-pill-select{display:flex;flex-direction:column}:where(.ag-pill-select){.ag-column-drop-list{padding:0}.ag-select{padding-top:var(--ag-spacing)}.ag-picker-field-wrapper{background-color:transparent;border:0}.ag-picker-field-display{cursor:pointer;font-weight:500}.ag-picker-field-display,.ag-picker-field-icon{color:var(--ag-chart-menu-label-color)}}",oZ=class extends m.Component{constructor(e){super('<div class="ag-pill-select" role="presentation"></div>'),this.config=e!=null?e:{};const{selectedValueList:t,valueFormatter:i,valueList:s}=this.config;this.selectedValues=t!=null?t:[],this.valueList=s!=null?s:[],this.valueFormatter=i!=null?i:n=>(0,m._escapeString)(n),this.registerCSS(rZ)}postConstruct(){const{ariaLabel:e,onValuesChange:t,dragSourceId:i}=this.config;this.dropZonePanel=this.createManagedBean(new cZ({getValues:()=>this.selectedValues,setValues:n=>this.updateValues(n),isDraggable:()=>this.selectedValues.length>1},n=>this.valueFormatter(n),e,i)),this.getGui().appendChild(this.dropZonePanel.getGui()),this.initSelect(),t!=null&&(this.onValuesChange=t)}setValues(e,t){const{added:i,removed:s,updated:n}=this.getChanges(this.valueList,e);let a=!1;return(i.length||s.length||n.length)&&(a=!0),this.valueList=e,this.updateValues(t,a,!0),this}setValueFormatter(e){return this.valueFormatter=e,this}initSelect(){const e=this.createSelectOptions();if(!e.length)return!1;const{selectPlaceholder:t}=this.config;return this.eSelect=this.createBean(new m.AgSelect({options:e,placeholder:t,onValueChange:i=>this.addValue(i),pickerIcon:"chartsMenuAdd"})),this.getGui().appendChild(this.eSelect.getGui()),!0}createSelectOptions(){const e=[],{maxSelection:t}=this.config;return t&&this.selectedValues.length>=t||this.valueList.forEach(i=>{this.selectedValues.includes(i)||e.push({value:i,text:this.valueFormatter(i)})}),e}addValue(e){this.dropZonePanel.addItem(e)}updateValues(e,t,i){var h,d,u,p,g;const s=this.selectedValues;this.selectedValues=e;const n=this.getChanges(s,e),a=t||n.added.length||n.removed.length,r=(0,m._getActiveDomElement)(this.beans),o=(h=this.eSelect)==null?void 0:h.getGui().contains(r),l=(d=this.dropZonePanel)==null?void 0:d.getGui().contains(r);i||(u=this.onValuesChange)==null||u.call(this,n);const c=a?!this.refreshSelect():!1;this.dropZonePanel.refreshGui(),a&&o&&(c?this.dropZonePanel.focusList(!0):(p=this.eSelect)==null||p.getFocusableElement().focus()),l&&!e.length&&((g=this.eSelect)==null||g.getFocusableElement().focus())}getChanges(e,t){const i=t.filter(a=>!e.includes(a)),s=e.filter(a=>!t.includes(a)),n=t.filter((a,r)=>e[r]!==a);return{added:i,removed:s,updated:n,selected:t}}refreshSelect(){if(!this.eSelect)return this.initSelect();const e=this.createSelectOptions();return e.length?(this.eSelect.clearOptions().addOptions(e).setValue(void 0,!0),!0):((0,m._removeFromParent)(this.eSelect.getGui()),this.eSelect=this.destroyBean(this.eSelect),!1)}destroy(){this.destroyBean(this.eSelect),super.destroy()}},lZ=class extends Uk{constructor(e,t,i,s,n,a){super(t,i,!1),this.value=e,this.valueFormatter=s,this.draggable=n,this.sourceId=a}getItem(){return this.value}getDisplayName(){return this.valueFormatter(this.value)}getAriaDisplayName(){return this.getDisplayName()}getTooltip(){}createGetDragItem(){return()=>({value:this.value})}getDragSourceType(){return m.DragSourceType.ChartPanel}getDragSourceId(){return this.sourceId}isMovable(){return this.isDraggable()}isDraggable(){return this.draggable}},cZ=class extends Wk{constructor(e,t,i,s){super(!1),this.model=e,this.valueFormatter=t,this.ariaLabel=i,this.sourceId=s}postConstruct(){super.init()}isItemDroppable(e,t){return this.isSourceEventFromTarget(t)||this.sourceId!=null&&this.sourceId===t.dragSource.sourceId}updateItems(e){this.model.setValues(e)}getExistingItems(){return this.model.getValues()}getIconName(){return this.isPotentialDndItems()?"move":"notAllowed"}getAriaLabel(){return this.ariaLabel}createPillComponent(e,t,i){return new lZ(e,t,i,this.valueFormatter,this.model.isDraggable(),this.sourceId)}getItems(e){return[e.value]}isInterestedIn(e){return e===m.DragSourceType.ChartPanel}},fP=class extends m.Component{constructor(e,t,i,s){super(s),this.chartController=e,this.allowMultipleSelection=t,this.maxSelection=i}wireBeans(e){this.chartTranslation=e.chartTranslation}addItem(e){this.groupComp.addItem(e)}createGroup(e,t,i,s,n){if(this.allowMultipleSelection){const a=e.filter(r=>r.selected);this.valuePillSelect=this.groupComp.createManagedBean(new oZ({valueList:e,selectedValueList:a,valueFormatter:t,selectPlaceholder:this.chartTranslation.translate(i),dragSourceId:s,onValuesChange:r=>this.onValueChange(r),maxSelection:this.maxSelection})),this.groupComp.addItem(this.valuePillSelect)}else{const a=this.createValueSelectParams(e);a.onValueChange=r=>{e.forEach(o=>{o.selected=!1}),r.selected=!0,r.colId===br&&this.chartController.setAggFunc(void 0,!0),this.chartController.updateForPanelChange({updatedColState:r,skipAnimation:n==null?void 0:n()})},this.valueSelect=this.groupComp.createManagedBean(new m.AgSelect(a)),this.groupComp.addItem(this.valueSelect)}}refreshValueSelect(e){if(!this.valueSelect)return;const{options:t,value:i}=this.createValueSelectParams(e);this.valueSelect.clearOptions().addOptions(t).setValue(i,!0)}createValueSelectParams(e){let t;return{options:e.map(s=>{var a;const n=(a=s.displayName)!=null?a:"";return s.selected&&(t=s),{value:s,text:n}}),value:t}}onValueChange({added:e,updated:t,removed:i,selected:s}){let n,a;const r=()=>{s.forEach((o,l)=>{o.order=l}),a=!0};e.length?(n=e[0],n.selected=!0,r()):i.length?(n=i[0],n.selected=!1):t.length&&(r(),n=t[0]),n&&this.chartController.updateForPanelChange({updatedColState:n,resetOrder:a})}destroy(){this.valuePillSelect=void 0,this.valueSelect=void 0,super.destroy()}},hZ="sum",dZ=class extends fP{constructor(e,t,i,s,n){super(e,i,void 0,'<div id="categoriesGroup"></div>'),this.title=t,this.dimensionCols=s,this.isOpen=n}postConstruct(){this.groupComp=this.createBean(new uo({title:this.title,enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen})),this.createGroup(this.dimensionCols,e=>{var t;return(t=e.displayName)!=null?t:""},"categoryAdd","categorySelect",()=>!this.chartController.getAggFunc()),this.createAggFuncControls(this.dimensionCols),this.getGui().appendChild(this.groupComp.getGui())}refresh(e){var t;(t=this.valuePillSelect)==null||t.setValues(e,e.filter(i=>i.selected)),this.refreshValueSelect(e),this.refreshAggFuncControls(e,this.chartController.getAggFunc())}createAggFuncControls(e){const t=this.chartController.getAggFunc();this.groupComp.addItem(this.aggFuncToggle=this.createBean(new m.AgToggleButton({label:this.chartTranslation.translate("aggregate"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:t!=null,onValueChange:i=>{var n,a;const s=i?hZ:void 0;this.chartController.setAggFunc(s),(n=this.aggFuncSelect)==null||n.setValue(s,!0),(a=this.aggFuncSelect)==null||a.setDisplayed(s!=null)}}))),this.groupComp.addItem(this.aggFuncSelect=this.createBean(new m.AgSelect({options:[{value:"sum",text:this.chartTranslation.translate("sum")},{value:"first",text:this.chartTranslation.translate("first")},{value:"last",text:this.chartTranslation.translate("last")},{value:"min",text:this.chartTranslation.translate("min")},{value:"max",text:this.chartTranslation.translate("max")},{value:"count",text:this.chartTranslation.translate("count")},{value:"avg",text:this.chartTranslation.translate("avg")}],value:typeof t=="string"?t:void 0,onValueChange:i=>{this.chartController.setAggFunc(i)}}))),this.refreshAggFuncControls(e,t)}refreshAggFuncControls(e,t){var n,a,r,o;const s=e.filter(l=>l.selected).some(l=>l.colId!==br);(n=this.aggFuncToggle)==null||n.setValue(t!=null),(a=this.aggFuncSelect)==null||a.setValue(typeof t=="string"?t:void 0,!0),(r=this.aggFuncToggle)==null||r.setDisplayed(s),(o=this.aggFuncSelect)==null||o.setDisplayed(s&&t!=null)}clearAggFuncControls(){this.aggFuncToggle=this.destroyBean(this.aggFuncToggle),this.aggFuncSelect=this.destroyBean(this.aggFuncSelect)}destroy(){this.clearAggFuncControls(),this.groupComp=this.destroyBean(this.groupComp),super.destroy()}},Qc=class extends m.BeanStub{constructor(e){super(),this.chartOptionsProxy=e}wireBeans(e){this.chartTranslation=e.chartTranslation}getDefaultColorPickerParams(e,t,i){return this.addValueParams(e,{label:this.chartTranslation.translate(t!=null?t:"color"),labelWidth:"flex",inputWidth:"flex",labelAlignment:"top",pickerGap:6},i)}getDefaultNumberInputParams(e,t,i){return this.addValueParams(e,{label:this.chartTranslation.translate(t),labelAlignment:"top",labelWidth:"flex",inputWidth:"flex",precision:i==null?void 0:i.precision,step:i==null?void 0:i.step,min:i==null?void 0:i.min,max:i==null?void 0:i.max},{parseInputValue:s=>{const n=Number(s);return isNaN(n)?void 0:n},formatInputValue:s=>s==null?"":`${s}`})}getDefaultSliderParams(e,t,i,s){var r;let n=(r=this.chartOptionsProxy.getValue(e))!=null?r:0;s&&Array.isArray(n)&&(n=n[0]);const a=this.getDefaultSliderParamsWithoutValueParams(n,t,i);return a.onValueChange=o=>this.chartOptionsProxy.setValue(e,s?[o]:o),a}getDefaultSliderParamsWithoutValueParams(e,t,i){return{label:this.chartTranslation.translate(t),minValue:0,maxValue:Math.max(e,i),textFieldWidth:45,value:`${e}`}}getDefaultCheckboxParams(e,t,i){const s=this.chartOptionsProxy.getValue(e),n={label:this.chartTranslation.translate(t),value:s,readOnly:i==null?void 0:i.readOnly,passive:i==null?void 0:i.passive};return n.onValueChange=a=>{this.chartOptionsProxy.setValue(e,typeof a=="boolean"?a:void 0)},n}getDefaultToggleParams(e,t,i){const s=this.chartOptionsProxy.getValue(e),n={label:this.chartTranslation.translate(t),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:s,readOnly:i==null?void 0:i.readOnly,passive:i==null?void 0:i.passive};return n.onValueChange=a=>{this.chartOptionsProxy.setValue(e,typeof a=="boolean"?a:void 0)},n}getDefaultSelectParams(e,t,i){return this.getDefaultSelectParamsWithoutValueParams(t,i,this.chartOptionsProxy.getValue(e),s=>{this.chartOptionsProxy.setValue(e,s)})}getDefaultSelectParamsWithoutValueParams(e,t,i,s){return{label:this.chartTranslation.translate(e),labelAlignment:"top",options:t,pickerGap:6,value:i,onValueChange:s}}getDefaultFontPanelParams(e,t){const i=s=>`${e}.${s}`;return this.addEnableParams(i("enabled"),{name:this.chartTranslation.translate(t),suppressEnabledCheckbox:!1,chartMenuParamsFactory:this,keyMapper:i})}addValueParams(e,t,i){const s=this.chartOptionsProxy.getValue(e);return t.value=i!=null&&i.formatInputValue?i.formatInputValue(s):s,t.onValueChange=n=>{const a=i!=null&&i.parseInputValue?i.parseInputValue(n):n;this.chartOptionsProxy.setValue(e,a)},t}addEnableParams(e,t){var i;return t.enabled=(i=this.chartOptionsProxy.getValue(e))!=null?i:!1,t.onEnableChange=s=>this.chartOptionsProxy.setValue(e,s),t}getChartOptions(){return this.chartOptionsProxy}},uZ=class extends m.Component{constructor(e,t){super(),this.chartMenuContext=e,this.isOpen=t,this.chartSpecificGroup=m.RefPlaceholder,this.hasContent=!1}wireBeans(e){this.chartTranslation=e.chartTranslation,this.chartSvc=e.chartSvc}postConstruct(){const t={title:this.getTitle(),enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen,items:[...this.createDirectionSelect(),this.createReverseSelect(),this.createGroupTypeSelect()]};this.setTemplate(`
            <div id="chartSpecificGroup">
                <ag-group-component data-ref="chartSpecificGroup"></ag-group-component>
            </div>`,[Nt],{chartSpecificGroup:t}),this.setDisplayed(this.hasContent)}refresh(){this.hasContent=!1,this.chartSpecificGroup.setTitle(this.getTitle()),this.updateDirectionSelect(),this.updateReverseSelect(),this.updateGroupTypeSelect(),this.setDisplayed(this.hasContent)}getTitle(){const e=this.chartMenuContext.chartController.getChartType();return this.chartTranslation.translate(BS(e))}createDirectionSelect(){if(!this.chartSvc.isEnterprise())return[];const{chartOptionsService:e,chartController:t}=this.chartMenuContext,i=e.getSeriesOptionsProxy(()=>Ot(t.getChartType())),s=this.createManagedBean(new Qc(i)),n=["horizontal","vertical"].map(o=>({value:o,text:this.chartTranslation.translate(o)})),a=s.getDefaultSelectParams("direction","direction",n),r=a.onValueChange;return a.onValueChange=o=>{r(o),t.raiseChartModelUpdateEvent()},this.directionSelect=this.createManagedBean(new m.AgSelect(a)),this.updateDirectionSelect(),[this.directionSelect]}createReverseSelect(){const{chartMenuParamsFactory:e}=this.chartMenuContext,t=e.getDefaultToggleParams("series.reverse","reverse");return this.reverseToggle=this.createManagedBean(new m.AgToggleButton(t)),this.updateReverseSelect(),this.reverseToggle}updateReverseSelect(){const e=this.chartMenuContext.chartController.getChartType()==="pyramid";this.updateDisplayed(this.reverseToggle,e)}updateDirectionSelect(){const e=z8(this.chartMenuContext.chartController.getChartType());this.updateDisplayed(this.directionSelect,e)}createGroupTypeSelect(){const{chartController:e,chartMenuParamsFactory:t}=this.chartMenuContext;return this.groupTypeSelect=this.createManagedBean(new m.AgSelect(t.getDefaultSelectParamsWithoutValueParams("seriesGroupType",R8.map(i=>({value:i,text:this.chartTranslation.translate(`${i}SeriesGroupType`)})),e.getSeriesGroupType(),i=>e.setSeriesGroupType(i)))),this.updateGroupTypeSelect(),this.groupTypeSelect}updateGroupTypeSelect(){const e=["radialColumn","radialBar","nightingale"].includes(this.chartMenuContext.chartController.getChartType());this.updateDisplayed(this.groupTypeSelect,e)}updateDisplayed(e,t){e==null||e.setDisplayed(t),e&&(this.hasContent=this.hasContent||t)}},pZ=class extends m.Component{constructor(e,t,i){super('<div id="seriesChartTypeGroup"></div>'),this.chartController=e,this.columns=t,this.isOpen=i,this.selectedColIds=[],this.chartTypeComps=new Map,this.secondaryAxisComps=new Map}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){this.createSeriesChartTypeGroup(this.columns)}refresh(e){(0,m._areEqual)(this.getValidColIds(e),this.selectedColIds)?this.refreshComps():this.recreate(e)}recreate(e){this.isOpen=this.seriesChartTypeGroupComp.isExpanded(),(0,m._clearElement)(this.getGui()),this.destroyBean(this.seriesChartTypeGroupComp),this.columns=e,this.selectedColIds=[],this.clearComps(),this.postConstruct()}getValidColIds(e){const t=this.chartController.getSeriesChartTypes();return e.filter(i=>i.selected&&!!t.filter(s=>s.colId===i.colId)[0]).map(({colId:i})=>i)}createSeriesChartTypeGroup(e){this.seriesChartTypeGroupComp=this.createBean(new uo({title:this.chartTranslation.translate("seriesChartType"),enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen}));const t=this.chartController.getSeriesChartTypes();e.forEach(i=>{if(!i.selected)return;const s=t.filter(c=>c.colId===i.colId)[0];if(!s)return;this.selectedColIds.push(i.colId);const n=this.seriesChartTypeGroupComp.createManagedBean(new uo({title:i.displayName,enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!0,cssIdentifier:"charts-format-sub-level"})),a=c=>["groupedColumn","stackedColumn","stackedArea"].includes(c),r=this.seriesChartTypeGroupComp.createManagedBean(new m.AgCheckbox({label:this.chartTranslation.translate("secondaryAxis"),labelWidth:"flex",disabled:a(s.chartType),value:!!s.secondaryAxis,onValueChange:c=>this.chartController.updateSeriesChartType(i.colId,void 0,c)}));n.addItem(r);const o=["line","area","stackedArea","groupedColumn","stackedColumn"].map(c=>({value:c,text:this.chartTranslation.translate(BS(c))})),l=n.createManagedBean(new m.AgSelect({options:o,value:s.chartType,onValueChange:c=>this.chartController.updateSeriesChartType(i.colId,c)}));n.addItem(l),this.seriesChartTypeGroupComp.addItem(n),this.chartTypeComps.set(i.colId,l),this.secondaryAxisComps.set(i.colId,r)}),this.getGui().appendChild(this.seriesChartTypeGroupComp.getGui())}refreshComps(){const e=this.chartController.getSeriesChartTypes();this.selectedColIds.forEach(t=>{const i=e.find(a=>a.colId===t);if(!i)return;const s=this.chartTypeComps.get(t),n=this.secondaryAxisComps.get(t);s==null||s.setValue(i.chartType),n==null||n.setValue(!!i.secondaryAxis),n==null||n.setDisabled(this.isSecondaryAxisDisabled(i.chartType))})}clearComps(){this.chartTypeComps.clear(),this.secondaryAxisComps.clear()}isSecondaryAxisDisabled(e){return["groupedColumn","stackedColumn","stackedArea"].includes(e)}destroy(){this.clearComps(),this.seriesChartTypeGroupComp=this.destroyBean(this.seriesChartTypeGroupComp),super.destroy()}},gZ=class extends fP{constructor(e,t,i,s,n,a,r){super(e,s,n,'<div id="seriesGroup"></div>'),this.chartOptionsService=t,this.title=i,this.valueCols=a,this.isOpen=r}postConstruct(){if(this.groupComp=this.createBean(new uo({title:this.title,enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen})),this.chartController.isActiveXYChart()){const e=this.groupComp.createManagedBean(new m.AgToggleButton({label:this.chartTranslation.translate("paired"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:this.chartOptionsService.getPairedMode(),onValueChange:t=>{this.chartOptionsService.setPairedMode(!!t),this.chartController.updateForGridChange({maintainColState:!0})}}));this.groupComp.addItem(e)}this.createGroup(this.valueCols,this.generateGetSeriesLabel(this.valueCols),"seriesAdd","seriesSelect"),this.getGui().appendChild(this.groupComp.getGui())}refresh(e){var t,i;(t=this.valuePillSelect)==null||t.setValueFormatter(this.generateGetSeriesLabel(e)),(i=this.valuePillSelect)==null||i.setValues(e,e.filter(s=>s.selected)),this.refreshValueSelect(e)}generateGetSeriesLabel(e){if(!this.chartController.isActiveXYChart())return a=>{var r;return(r=a.displayName)!=null?r:""};const t=e.filter(a=>a.selected),i=this.chartController.getChartType()==="bubble",s=this.chartOptionsService.getPairedMode(),n=new Map;return n.set(0,"X"),n.set(1,"Y"),n.set(2,"size"),a=>{var c;const r=(c=a.displayName)!=null?c:"";if(!a.selected)return r;const o=t.indexOf(a);if(o===-1)return r;let l;return s?l=n.get(o%(i?3:2)):o===0?l="X":l=i&&o%2===0?"size":"Y",`${r} (${l})`}}destroy(){this.groupComp=this.destroyBean(this.groupComp),super.destroy()}},fZ={groups:[{type:"categories",isOpen:!0},{type:"series",isOpen:!0},{type:"seriesChartType",isOpen:!0},{type:"chartSpecific",isOpen:!0}]},mZ=class extends m.Component{constructor(e){super('<div class="ag-chart-data-wrapper ag-scrollable-container"></div>'),this.chartMenuContext=e,this.isSwitchCategorySeriesToggled=!1,this.restoreSwitchCategorySeriesToggleFocus=!1,this.panels=[],this.chartController=e.chartController}wireBeans(e){this.chartTranslation=e.chartTranslation,this.chartSvc=e.chartSvc}postConstruct(){this.createSwitchCategorySeriesToggle(),this.isSwitchCategorySeriesToggled=this.chartController.isCategorySeriesSwitched(),this.updatePanels();const e=this.updatePanels.bind(this);this.addManagedListeners(this.chartController,{chartModelUpdate:e,chartApiUpdate:e})}destroy(){this.clearPanelComponents(),super.destroy()}updatePanels(){var r,o,l,c,h;const e=this.chartType,t=this.isSwitchCategorySeriesToggled,{dimensionCols:i,valueCols:s}=this.chartController.getColStateForMenu();this.chartType=this.chartController.getChartType(),this.isSwitchCategorySeriesToggled=this.chartController.isCategorySeriesSwitched();const n=this.isSwitchCategorySeriesToggled!==t;this.canRefresh(e,this.chartType)&&!n?((r=this.categoriesDataPanel)==null||r.refresh(i),(o=this.seriesDataPanel)==null||o.refresh(s),(l=this.seriesChartTypePanel)==null||l.refresh(s),(c=this.chartSpecificPanel)==null||c.refresh()):this.recreatePanels(i,s);const a=eP(this.chartType)&&this.chartSvc.isEnterprise()&&!this.chartController.isGrouping();(0,m._setDisplayed)(this.switchCategorySeriesToggle.getGui(),a),n&&((h=this.switchCategorySeriesToggle)==null||h.setValue(this.chartController.isCategorySeriesSwitched())),this.restoreSwitchCategorySeriesToggleFocus&&(this.restoreSwitchCategorySeriesToggleFocus=!1,a&&this.switchCategorySeriesToggle.getFocusableElement().focus())}canRefresh(e,t){if(e===void 0)return!1;if(e===t)return!0;const i=s=>["columnLineCombo","areaColumnCombo","customCombo"].includes(s);return!!(i(e)&&i(t))}recreatePanels(e,t){var n,a;this.clearPanelComponents();const{chartType:i}=this;if(!i)return;const s=this.chartController.isCategorySeriesSwitched();(n=this.getDataPanelDef().groups)==null||n.forEach(({type:r,isOpen:o})=>{r===(s?"series":"categories")?(this.categoriesDataPanel=this.createBean(new dZ(this.chartController,this.getCategoryGroupTitle(s),this.getCategoryGroupMultipleSelect(i,s),e,o)),this.panels.push(this.categoriesDataPanel)):r===(s?"categories":"series")?(this.seriesDataPanel=this.createBean(new gZ(this.chartController,this.chartMenuContext.chartOptionsService,this.getSeriesGroupTitle(s),this.getSeriesGroupMultipleSelect(i,s),this.getSeriesGroupMaxSelection(i,s),t,o)),this.panels.push(this.seriesDataPanel)):r==="seriesChartType"?this.chartController.isComboChart()&&(this.seriesChartTypePanel=this.createBean(new pZ(this.chartController,t,o)),this.panels.push(this.seriesChartTypePanel)):r==="chartSpecific"?(this.chartSpecificPanel=this.createBean(new uZ(this.chartMenuContext,o)),this.panels.push(this.chartSpecificPanel)):(0,m._warn)(144,{type:r})}),(a=s?this.categoriesDataPanel:this.seriesDataPanel)==null||a.addItem(this.switchCategorySeriesToggle.getGui()),this.addPanelComponents()}addPanelComponents(){if(!this.panels.length)return;const t=(0,m._getDocument)(this.beans).createDocumentFragment();for(const i of this.panels)i.addCss("ag-chart-data-section"),t.appendChild(i.getGui());this.getGui().appendChild(t)}clearPanelComponents(){const e=this.getGui();this.panels.forEach(t=>{e.removeChild(t.getGui()),this.destroyBean(t)}),this.panels=[]}getDataPanelDef(){var e,t;return(t=(e=this.gos.get("chartToolPanelsDef"))==null?void 0:e.dataPanel)!=null?t:fZ}getCategoryGroupTitle(e){return e?this.chartTranslation.translate("seriesLabels"):this.chartTranslation.translate(this.chartController.isActiveXYChart()?"labels":"categories")}getCategoryGroupMultipleSelect(e,t){return t?!1:FS(e)!==1}getSeriesGroupTitle(e){return e?this.chartTranslation.translate("categoryValues"):this.chartTranslation.translate(this.chartController.isActiveXYChart()?"xyValues":"series")}getSeriesGroupMultipleSelect(e,t){return this.getSeriesGroupMaxSelection(e,t)!==1}getSeriesGroupMaxSelection(e,t){if(!t)return Zm(e)}createSwitchCategorySeriesToggle(){this.switchCategorySeriesToggle=this.createManagedBean(new m.AgToggleButton({label:this.chartTranslation.translate("switchCategorySeries"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:this.chartController.isCategorySeriesSwitched(),onValueChange:e=>{this.restoreSwitchCategorySeriesToggleFocus=!0,this.chartController.switchCategorySeries(e)}}))}},yZ=class extends m.AgAbstractLabel{constructor(e){super(e,`<div class="ag-angle-select">
            <div data-ref="eLabel"></div>
            <div class="ag-wrapper ag-angle-select-wrapper">
                <div class="ag-angle-select-field">
                    <div data-ref="eParentCircle" class="ag-angle-select-parent-circle">
                        <div data-ref="eChildCircle" class="ag-angle-select-child-circle"></div>
                    </div>
                </div>
                <ag-input-number-field data-ref="eAngleValue"></ag-input-number-field>
            </div>
        </div>`,[m.AgInputNumberFieldSelector]),this.eLabel=m.RefPlaceholder,this.eParentCircle=m.RefPlaceholder,this.eChildCircle=m.RefPlaceholder,this.eAngleValue=m.RefPlaceholder,this.radius=0,this.offsetX=0,this.offsetY=0}wireBeans(e){this.dragSvc=e.dragSvc}postConstruct(){var i;super.postConstruct();const{value:e,onValueChange:t}=this.config;e!=null&&this.setValue(e,void 0,!0),t!=null&&this.onValueChange(t),this.dragListener={eElement:this.eParentCircle,dragStartPixels:0,onDragStart:()=>{this.parentCircleRect=this.eParentCircle.getBoundingClientRect()},onDragging:s=>this.calculateAngleDrag(s),onDragStop:()=>{}},(i=this.dragSvc)==null||i.addDragSource(this.dragListener),this.eAngleValue.setLabel("").setLabelWidth(5).setInputWidth(45).setMin(0).setMax(360).setValue(`${this.degrees}`).onValueChange(s=>{(s==null||s==="")&&(s="0"),s=this.eAngleValue.normalizeValue(s);let n=parseFloat(s);n>180&&(n=n-360),this.setValue(n)}),this.updateNumberInput(),(0,m._exists)(this.getValue())&&this.eAngleValue.setValue(this.normalizeNegativeValue(this.getValue()).toString()),this.addManagedListeners(this,{fieldValueChanged:()=>{this.eAngleValue.getInputElement().contains((0,m._getActiveDomElement)(this.beans))||this.updateNumberInput()}})}updateNumberInput(){const e=this.normalizeNegativeValue(this.getValue());this.eAngleValue.setValue(e.toString())}positionChildCircle(e){const t=this.parentCircleRect||{width:24,height:24},i=this.eChildCircle,s=t.width/2,n=t.height/2;i.style.left=`${s+Math.cos(e)*8}px`,i.style.top=`${n+Math.sin(e)*8}px`}calculatePolar(){const e=this.offsetX,t=this.offsetY,i=Math.atan2(t,e);this.degrees=this.toDegrees(i),this.radius=Math.sqrt(e*e+t*t),this.positionChildCircle(i)}calculateCartesian(){const e=this.toRadians(this.getValue()),t=this.getRadius();this.setOffsetX(Math.cos(e)*t).setOffsetY(Math.sin(e)*t)}setOffsetX(e){return this.offsetX!==e&&(this.offsetX=e,this.calculatePolar()),this}setOffsetY(e){return this.offsetY!==e&&(this.offsetY=e,this.calculatePolar()),this}calculateAngleDrag(e){const t=this.parentCircleRect,i=t.width/2,s=t.height/2,n=e.clientX-t.left,a=e.clientY-t.top,r=n-i,o=a-s,l=Math.atan2(o,r);this.setValue(l,!0)}toDegrees(e){return e/Math.PI*180}toRadians(e){return e/180*Math.PI}normalizeNegativeValue(e){return e<0?360+e:e}normalizeAngle180(e){return e%=Math.PI*2,e<-Math.PI?e+=Math.PI*2:e>=Math.PI&&(e-=Math.PI*2),e}getRadius(){return this.radius}setRadius(e){return this.radius===e?this:(this.radius=e,this.calculateCartesian(),this)}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>{e(this.degrees)}}),this}getValue(e){return e?this.toRadians(this.degrees):this.degrees}setValue(e,t,i){let s;return t?s=e:s=this.normalizeAngle180(this.toRadians(e)),e=this.toDegrees(s),this.degrees!==e&&(this.degrees=Math.floor(e),this.calculateCartesian(),this.positionChildCircle(s),i||this.dispatchLocalEvent({type:"fieldValueChanged"})),this}setWidth(e){return(0,m._setFixedWidth)(this.getGui(),e),this}setDisabled(e){return super.setDisabled(e),this.eAngleValue.setDisabled(e),this}destroy(){var e;(e=this.dragSvc)==null||e.removeDragSource(this.dragListener),super.destroy()}};function vZ(e){return e[0].toUpperCase()+e.substring(1).toLowerCase()}var Al=class extends m.Component{constructor(e){super(),this.params=e,this.fontGroup=m.RefPlaceholder,this.activeComps=[],this.chartOptions=e.chartMenuParamsFactory.getChartOptions()}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{cssIdentifier:e="charts-format-sub-level",name:t,enabled:i,onEnableChange:s,suppressEnabledCheckbox:n,chartMenuParamsFactory:a,keyMapper:r}=this.params,o={cssIdentifier:e,direction:"vertical",suppressOpenCloseIcons:!0,title:t,enabled:i,suppressEnabledCheckbox:!0,onEnableChange:l=>{s&&s(l)},useToggle:!n};this.setTemplate(`<div class="ag-font-panel">
        <ag-group-component data-ref="fontGroup">
            <ag-select data-ref="familySelect"></ag-select>
            <ag-select data-ref="weightStyleSelect"></ag-select>
            <div class="ag-charts-font-size-color">
                <ag-select data-ref="sizeSelect"></ag-select>
                <ag-color-picker data-ref="colorPicker"></ag-color-picker>
            </div>
        </ag-group-component>
    </div>`,[Nt,m.AgSelectSelector,xr],{fontGroup:o,familySelect:this.getFamilySelectParams(),weightStyleSelect:this.getWeightStyleSelectParams(),sizeSelect:this.getSizeSelectParams(),colorPicker:a.getDefaultColorPickerParams(r("color"))}),this.toggleCss("ag-font-panel-no-header",!t)}addItem(e,t){t?this.fontGroup.prependItem(e):this.fontGroup.addItem(e),this.activeComps.push(e)}setEnabled(e){this.fontGroup.setEnabled(e)}getFamilySelectParams(){const e=["Arial, sans-serif","Aria Black, sans-serif","Book Antiqua,  serif","Charcoal, sans-serif","Comic Sans MS, cursive","Courier, monospace","Courier New, monospace","Gadget, sans-serif","Geneva, sans-serif","Helvetica, sans-serif","Impact, sans-serif","Lucida Console, monospace","Lucida Grande, sans-serif","Lucida Sans Unicode,  sans-serif","Monaco, monospace","Palatino Linotype, serif","Palatino, serif","Times New Roman, serif","Times, serif","Verdana, sans-serif"],t=this.getInitialFontValue("fontFamily");let i=e[0];if(t){const a=e.map(r=>r.toLowerCase()).indexOf(t.toLowerCase());if(a>=0)i=e[a];else{const r=vZ(t);e.push(r),i=r}}const s=e.sort().map(n=>({value:n,text:n}));return this.params.chartMenuParamsFactory.getDefaultSelectParamsWithoutValueParams("font",s,`${i}`,n=>this.setFont({fontFamily:n}))}getSizeSelectParams(){const e=[8,10,12,14,16,18,20,22,24,26,28,30,32,34,36],t=this.getInitialFontValue("fontSize");e.includes(t)||e.push(t);const i=e.sort((s,n)=>s-n).map(s=>({value:`${s}`,text:`${s}`}));return this.params.chartMenuParamsFactory.getDefaultSelectParamsWithoutValueParams("size",i,`${t}`,s=>this.setFont({fontSize:parseInt(s,10)}))}getWeightStyleSelectParams(){var a,r;const e=(a=this.getInitialFontValue("fontWeight"))!=null?a:"normal",t=(r=this.getInitialFontValue("fontStyle"))!=null?r:"normal",i=[{name:"normal",weight:"normal",style:"normal"},{name:"bold",weight:"bold",style:"normal"},{name:"italic",weight:"normal",style:"italic"},{name:"boldItalic",weight:"bold",style:"italic"}];let s=i.find(o=>o.weight===e&&o.style===t);s||(s={name:"predefined",weight:e,style:t},i.unshift(s));const n=i.map(o=>({value:o.name,text:this.chartTranslation.translate(o.name)}));return this.params.chartMenuParamsFactory.getDefaultSelectParamsWithoutValueParams("weight",n,s.name,o=>{const l=i.find(c=>c.name===o);this.setFont({fontWeight:l.weight,fontStyle:l.style})})}destroyActiveComps(){this.activeComps.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)})}destroy(){this.destroyActiveComps(),super.destroy()}setFont(e){const{keyMapper:t}=this.params;for(const i of Object.keys(e)){const s=e[i];s&&this.chartOptions.setValue(t(i),s)}}getInitialFontValue(e){const{keyMapper:t}=this.params;return this.chartOptions.getValue(t(e))}},bZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e,this.axisTicksSizeSlider=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{chartMenuUtils:e}=this,t=e.addEnableParams("tick.enabled",{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("ticks"),suppressEnabledCheckbox:!0,useToggle:!0}),i=e.getDefaultColorPickerParams("tick.stroke"),s=e.getDefaultSliderParams("tick.width","width",10),n=e.getDefaultSliderParams("tick.size","length",30);this.setTemplate(`<div>
            <ag-group-component data-ref="axisTicksGroup">
                <ag-color-picker data-ref="axisTicksColorPicker"></ag-color-picker>
                <ag-slider data-ref="axisTicksWidthSlider"></ag-slider>
                <ag-slider data-ref="axisTicksSizeSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,xr,Mn],{axisTicksGroup:t,axisTicksColorPicker:i,axisTicksWidthSlider:s,axisTicksSizeSlider:n})}setTickSizeSliderDisplayed(e){this.axisTicksSizeSlider.setDisplayed(e)}},xZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e,this.chartOptions=e.getChartOptions()}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuUtils.addEnableParams("gridLine.enabled",{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("gridLines"),suppressEnabledCheckbox:!0,useToggle:!0}),t=this.getGridLineColorPickerParams("color"),i=this.getGridLineWidthSliderParams("thickness"),s=this.getGridLineDashSliderParams("lineDash");this.setTemplate(`<div>
            <ag-group-component data-ref="gridLineGroup">
                <ag-color-picker data-ref="gridLineColorPicker"></ag-color-picker>
                <ag-slider data-ref="gridLineWidthSlider"></ag-slider>
                <ag-slider data-ref="gridLineLineDashSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,xr,Mn],{gridLineGroup:e,gridLineColorPicker:t,gridLineWidthSlider:i,gridLineLineDashSlider:s})}getGridLineColorPickerParams(e){return this.chartMenuUtils.getDefaultColorPickerParams("gridLine.style",e,{formatInputValue:t=>{var i;return(i=t==null?void 0:t[0])==null?void 0:i.stroke},parseInputValue:t=>{var s;const i=(s=this.chartOptions.getValue("gridLine.style"))!=null?s:[];return i.length===0?[{stroke:t,lineDash:[]}]:[E(b({},i[0]),{stroke:t})]}})}getGridLineWidthSliderParams(e){return this.chartMenuUtils.getDefaultSliderParams("gridLine.width",e,10)}getGridLineDashSliderParams(e){var n,a;const t=this.chartOptions.getValue("gridLine.style"),i=(a=(n=t==null?void 0:t[0])==null?void 0:n.lineDash)==null?void 0:a[0],s=this.chartMenuUtils.getDefaultSliderParamsWithoutValueParams(i!=null?i:0,e,30);return s.onValueChange=r=>{const o=this.chartOptions.getValue("gridLine.style.0.stroke");this.chartOptions.setValue("gridLine.style",[{lineDash:[r],stroke:o}])},s}},CZ="%d %B %Y",ty=class extends m.Component{constructor(e,t){super(),this.axisType=e,this.options=t,this.axisGroup=m.RefPlaceholder,this.axisTypeSelect=m.RefPlaceholder,this.axisPositionSelect=m.RefPlaceholder,this.axisTimeFormatSelect=m.RefPlaceholder,this.activePanels=[],this.updateFuncs=[];const{chartOptionsService:i,seriesType:s,chartController:n}=t;this.chartOptionsService=i,this.chartController=n,this.chartOptionsSeriesProxy=i.getSeriesOptionsProxy(()=>s)}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){var f;const{isExpandedOnInit:e,chartOptionsService:t,registerGroupComponent:i}=this.options,s=this.axisType,n={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.translate(s),expanded:e,suppressEnabledCheckbox:!0},a=t.getCartesianAxisOptionsProxy(this.axisType),r=this.createManagedBean(new Qc(a)),o=this.createManagedBean(new Qc(t.getCartesianAxisThemeOverridesProxy(this.axisType))),l=this.getAxisTypeSelectParams(r,t.getCartesianAxisAppliedThemeOverridesProxy(this.axisType)),c=this.getAxisPositionSelectParams(r),h=this.getAxisTimeFormatSelectParams(r),d=this.getAxisColorInputParams(o),u=this.getAxisLineWidthSliderParams(o);this.setTemplate(`<div>
            <ag-group-component data-ref="axisGroup">
                <ag-select data-ref="axisTypeSelect"></ag-select>
                <ag-select data-ref="axisTimeFormatSelect"></ag-select>
                <ag-select data-ref="axisPositionSelect"></ag-select>
                <ag-color-picker data-ref="axisColorInput"></ag-color-picker>
                <ag-slider data-ref="axisLineWidthSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,m.AgSelectSelector,xr,Mn],{axisGroup:n,axisTypeSelect:l!=null?l:void 0,axisPositionSelect:c!=null?c:void 0,axisTimeFormatSelect:h!=null?h:void 0,axisColorInput:d,axisLineWidthSlider:u}),i(this.axisGroup),this.axisTypeSelect.setDisplayed(!!((f=l.options)!=null&&f.length)),c||this.removeTemplateComponent(this.axisPositionSelect);const p=()=>{const y=a.getValue("type")==="time";(0,m._setDisplayed)(this.axisTimeFormatSelect.getGui(),y)};h?(p(),this.addManagedEventListeners({chartOptionsChanged:()=>{p()}})):this.removeTemplateComponent(this.axisTimeFormatSelect),this.initGridLines(o),this.initAxisTicks(o),this.initAxisLabels(o);const g=()=>this.updateFuncs.forEach(y=>y());this.addManagedListeners(this.chartController,{chartUpdated:g,chartModelUpdate:()=>setTimeout(()=>{this.isAlive()&&(this.refreshAxisTypeSelect(r),p())})})}getAxisTypeSelectParams(e,t){const i=e.getChartOptions(),s=this.getAxisTypeSelectOptions(),n=e.getDefaultSelectParams("type","axisType",s);return n.onValueChange=a=>{var d;const r=i.getValue("type");if(a===r)return;const o=t.getValue("*"),l=r==="time",c=a==="time",h=l!==c?c?CZ:void 0:null;if(this.chartOptionsService.setCartesianCategoryAxisType(this.axisType,a),h!==null){const u=(d=i.getValue("label"))!=null?d:{};i.setValue("label",E(b({},u),{format:h}))}t.setValue("*",o)},n}refreshAxisTypeSelect(e){const t=this.getAxisTypeSelectOptions(),i=!!t.length;this.axisTypeSelect.setDisplayed(i),i&&this.axisTypeSelect.clearOptions().addOptions(t).setValue(e.getChartOptions().getValue("type"))}getAxisTypeSelectOptions(){const e=this.chartController,t=e.getChartType(),i=()=>{const s=e.getChartData()[0];return s?e.getSelectedDimensions().every(n=>!isNaN(parseFloat(s[n.colId]))):!1};return["heatmap","histogram","boxPlot","rangeBar","scatter","bubble"].includes(t)||e.isGrouping()||!this.isCategoryAxis()||e.isCategorySeriesSwitched()||!i()?[]:["category","number","time"].map(s=>({value:s,text:this.translate(s)}))}isCategoryAxis(){const e=this.chartOptionsSeriesProxy.getValue("direction")==="horizontal";return e&&this.axisType==="yAxis"||!e&&this.axisType==="xAxis"}getAxisPositionSelectParams(e){const t=((i,s)=>{switch(i){case"heatmap":return null;default:switch(s){case"xAxis":return[{value:"top",text:this.translate("top")},{value:"bottom",text:this.translate("bottom")}];case"yAxis":return[{value:"left",text:this.translate("left")},{value:"right",text:this.translate("right")}]}}})(this.chartController.getChartType(),this.axisType);return t?e.getDefaultSelectParams("position","position",t):null}getAxisTimeFormatSelectParams(e){if(!this.isCategoryAxis())return null;const t=[{value:"%d/%m/%Y",text:this.translate("timeFormatSlashesDDMMYYYY")},{value:"%m/%d/%Y",text:this.translate("timeFormatSlashesMMDDYYYY")},{value:"%d/%m/%y",text:this.translate("timeFormatSlashesDDMMYY")},{value:"%m/%d/%y",text:this.translate("timeFormatSlashesMMDDYY")},{value:"%d.%e.%y",text:this.translate("timeFormatDotsDDMYY")},{value:"%e.%d.%y",text:this.translate("timeFormatDotsMDDYY")},{value:"%Y-%m-%d",text:this.translate("timeFormatDashesYYYYMMDD")},{value:"%d %B %Y",text:this.translate("timeFormatSpacesDDMMMMYYYY")},{value:"%H:%M:%S",text:this.translate("timeFormatHHMMSS")},{value:"%I:%M:%S %p",text:this.translate("timeFormatHHMMSSAmPm")}];return e.getDefaultSelectParams("label.format","timeFormat",t)}getAxisColorInputParams(e){return e.getDefaultColorPickerParams("line.stroke")}getAxisLineWidthSliderParams(e){var a;const t=e.getChartOptions(),i=()=>t.getValue("line.enabled")?t.getValue("line.width"):null,s=r=>{t.setValues([{expression:"line.enabled",value:r!=null},{expression:"line.width",value:r!=null?r:0}])},n=e.getDefaultSliderParamsWithoutValueParams((a=i())!=null?a:0,"thickness",10);return n.onValueChange=r=>{s(r===0?null:r)},n}initGridLines(e){if(this.chartController.getChartType()==="heatmap")return;const i=this.createBean(new xZ(e));this.axisGroup.addItem(i),this.activePanels.push(i)}initAxisTicks(e){if(!this.hasConfigurableAxisTicks())return;const t=this.createBean(new bZ(e));this.axisGroup.addItem(t),this.activePanels.push(t);const i=()=>t.setTickSizeSliderDisplayed(this.isGroupedCategoryAxis());this.updateFuncs.push(i),i()}hasConfigurableAxisTicks(){switch(this.chartController.getChartType()){case"radarLine":case"radarArea":case"rangeBar":case"boxPlot":case"waterfall":return!1;default:return!0}}initAxisLabels(e){const t={name:this.translate("labels"),enabled:!0,suppressEnabledCheckbox:!0,chartMenuParamsFactory:e,keyMapper:s=>`label.${s}`},i=this.createBean(new Al(t));this.axisGroup.addItem(i),this.activePanels.push(i),this.addAdditionalLabelComps(i,e)}addAdditionalLabelComps(e,t){this.addLabelPadding(e,t);const i=this.createRotationWidget("labelRotation",t),s=this.initLabelRotation(i,t);e.addItem(s),e.addItem(i)}initLabelRotation(e,t){const i=t.getChartOptions(),s=()=>i.getValue("label.rotation"),n=()=>i.getValue("label.autoRotate"),a=h=>{h&&(this.prevRotation=s()),i.setValues([{expression:"label.autoRotate",value:h},{expression:"label.rotation",value:h?void 0:this.prevRotation}]),e.setDisplayed(!h)},o=typeof s()=="number"?!1:n(),l=this.createBean(new m.AgCheckbox({label:this.translate("autoRotate"),value:o,onValueChange:a}));e.setDisplayed(!o);const c=()=>l.setDisplayed(this.isGroupedCategoryAxis());return this.updateFuncs.push(c),c(),l}createRotationWidget(e,t){var l;const i=t.getChartOptions(),s=()=>i.getValue("label.rotation"),n=c=>i.setValue("label.rotation",c),r=`${this.chartTranslation.translate(e)} \xB0`,o=new yZ({label:r,labelWidth:"flex",value:(l=s())!=null?l:0,onValueChange:n});return this.updateFuncs.push(()=>{var c;o.setValue((c=s())!=null?c:0)}),this.createBean(o)}isGroupedCategoryAxis(){return this.chartOptionsService.getCartesianAxisOptionsProxy(this.axisType).getValue("type")==="grouped-category"?!this.isCategoryAxis():!0}addLabelPadding(e,t){const i=this.createBean(new Un(t.getDefaultSliderParams("label.spacing","padding",30)));e.addItem(i)}translate(e){return this.chartTranslation.translate(e)}removeTemplateComponent(e){(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)}destroyActivePanels(){this.activePanels.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)})}destroy(){this.destroyActivePanels(),super.destroy()}},SZ=class extends m.Component{constructor(e){super(),this.options=e,this.axisGroup=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{isExpandedOnInit:e,chartAxisMenuParamsFactory:t,registerGroupComponent:i}=this.options,s={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.translate("polarAxis"),expanded:e,suppressEnabledCheckbox:!0},n=t.getDefaultColorPickerParams("line.stroke"),a=t.getDefaultSliderParams("line.width","thickness",10);this.setTemplate(`<div>
            <ag-group-component data-ref="axisGroup">
                <ag-color-picker data-ref="axisColorInput"></ag-color-picker>
                <ag-slider data-ref="axisLineWidthSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,xr,Mn],{axisGroup:s,axisColorInput:n,axisLineWidthSlider:a}),i(this.axisGroup),this.initAxis(),this.initAxisLabels(),this.initRadiusAxis()}initAxis(){const e=this.options.chartController.getChartType();if(["radarLine","radarArea"].includes(e)){const i=[{value:"circle",text:this.translate("circle")},{value:"polygon",text:this.translate("polygon")}];this.axisGroup.addItem(this.createSelect({labelKey:"shape",options:i,property:"shape"}))}e!=="pie"&&this.axisGroup.addItem(this.createSlider({labelKey:"innerRadius",defaultMaxValue:1,property:"innerRadiusRatio"}))}initAxisLabels(){const e={name:this.translate("labels"),enabled:!0,suppressEnabledCheckbox:!0,chartMenuParamsFactory:this.options.chartAxisMenuParamsFactory,keyMapper:s=>`label.${s}`},t=this.createManagedBean(new Al(e)),i=this.createOrientationWidget();t.addItem(i),this.axisGroup.addItem(t)}createOrientationWidget(){const e=[{value:"fixed",text:this.translate("fixed")},{value:"parallel",text:this.translate("parallel")},{value:"perpendicular",text:this.translate("perpendicular")}];return this.createSelect({labelKey:"orientation",options:e,property:"label.orientation"})}initRadiusAxis(){const e=Ot(this.options.chartController.getChartType());if(!_8(e))return;const t=[this.createSlider({labelKey:"groupPadding",defaultMaxValue:1,property:"paddingInner"}),this.createSlider({labelKey:"seriesPadding",defaultMaxValue:1,property:"groupPaddingInner"})],i=this.createManagedBean(new uo({cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,enabled:!0,suppressEnabledCheckbox:!0,title:this.translate("padding"),items:t})).hideEnabledCheckbox(!0).hideOpenCloseIcons(!0);this.axisGroup.addItem(i)}createSlider(e){const{labelKey:t,defaultMaxValue:i,step:s=.05,property:n}=e,a=this.options.chartAxisMenuParamsFactory.getDefaultSliderParams(n,t,i);return a.step=s,this.createManagedBean(new Un(a))}createSelect(e){const{labelKey:t,options:i,property:s}=e;return this.createManagedBean(new m.AgSelect(this.options.chartAxisMenuParamsFactory.getDefaultSelectParams(s,t,i)))}translate(e){return this.chartTranslation.translate(e)}},MZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuUtils.addEnableParams("background.visible",{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("background"),suppressEnabledCheckbox:!0,useToggle:!0}),t=this.chartMenuUtils.getDefaultColorPickerParams("background.fill");this.setTemplate(`<div>
            <ag-group-component data-ref="chartBackgroundGroup">
                <ag-color-picker data-ref="colorPicker"></ag-color-picker>
            </ag-group-component>
        <div>`,[Nt,xr],{chartBackgroundGroup:e,colorPicker:t})}},DZ=class extends m.Component{constructor(e,t){super(),this.chartMenuUtils=e,this.chartController=t,this.paddingTopSlider=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("padding"),suppressEnabledCheckbox:!0},t=i=>this.chartMenuUtils.getDefaultSliderParams("padding."+i,i,200);this.setTemplate(`<div>
            <ag-group-component data-ref="chartPaddingGroup">
                <ag-slider data-ref="paddingTopSlider"></ag-slider>
                <ag-slider data-ref="paddingRightSlider"></ag-slider>
                <ag-slider data-ref="paddingBottomSlider"></ag-slider>
                <ag-slider data-ref="paddingLeftSlider"></ag-slider>
            </ag-group-component>
        <div>`,[Nt,Mn],{chartPaddingGroup:e,paddingTopSlider:t("top"),paddingRightSlider:t("right"),paddingBottomSlider:t("bottom"),paddingLeftSlider:t("left")}),this.addManagedEventListeners({chartOptionsChanged:i=>{this.updateTopPadding(i.chartOptions)}})}updateTopPadding(e){const t=[...this.chartController.getChartSeriesTypes(),"common"].map(i=>{var s,n;return(n=(s=e==null?void 0:e[i])==null?void 0:s.padding)==null?void 0:n.top}).find(i=>i!=null);t!=null&&this.paddingTopSlider.setValue(`${t}`)}},wZ=class extends m.Component{constructor(e){super(),this.options=e,this.chartGroup=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{chartController:e,chartMenuParamsFactory:t,isExpandedOnInit:i,registerGroupComponent:s}=this.options,n={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.chartTranslation.translate("chartStyle"),expanded:i,suppressEnabledCheckbox:!0,items:[this.createManagedBean(new DZ(t,e)),this.createManagedBean(new MZ(t))]};this.setTemplate(`<div>
            <ag-group-component data-ref="chartGroup"></ag-group-component>
        </div>`,[Nt],{chartGroup:n}),s(this.chartGroup)}},AZ=class extends m.BeanStub{constructor(e){super(),this.groupContainer=e,this.id=0,this.groupComponents=new Map}addGroupComponent(e){const t=this.id++;this.groupComponents.set(t,e),e.isExpanded()&&(this.expandedGroupComponent=t),e.onExpandedChange(i=>{var s;if(i){const n=this.expandedGroupComponent;if(this.expandedGroupComponent=t,n!=null){const a=e.getGui(),r=a.offsetTop-this.groupContainer.parentElement.scrollTop;(s=this.groupComponents.get(n))==null||s.toggleGroupExpand(!1,!0);let o=a.offsetTop-r;o<0&&(o=0),o!==this.groupContainer.parentElement.scrollTop&&(this.groupContainer.parentElement.scrollTop=o)}}else this.expandedGroupComponent=void 0})}destroy(){this.groupComponents.clear(),super.destroy()}},IZ=class extends m.Component{constructor(e,t){super(),this.options=e,this.chartMenuContext=t,this.legendGroup=m.RefPlaceholder,this.enabledGroup=m.RefPlaceholder,this.isGradient=["treemap","sunburst","heatmap"].includes(e.seriesType),this.key=this.isGradient?"gradientLegend":"legend",this.chartController=t.chartController}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{chartMenuParamsFactory:e,isExpandedOnInit:t,registerGroupComponent:i}=this.options,s=this.createManagedBean(new m.AgSelect(e.getDefaultSelectParams(`${this.key}.position`,"position",["top","right","bottom","left"].map(r=>({value:r,text:this.chartTranslation.translate(r)})))));this.enabledGroup=this.createManagedBean(new uo(e.addEnableParams(`${this.key}.enabled`,{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("legendEnabled"),suppressEnabledCheckbox:!0,useToggle:!0,items:[this.createLabelPanel(e),s,...this.getItems(e)]})));const n={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.chartTranslation.translate("legend"),suppressEnabledCheckbox:!0,expanded:t,items:[this.enabledGroup]};this.setTemplate(`<div>
            <ag-group-component data-ref="legendGroup">
            </ag-group-component>
        </div>`,[Nt],{legendGroup:n}),i(this.legendGroup);const a=this.updateLegendEnabledState.bind(this);this.addManagedListeners(this.chartController,{chartModelUpdate:a,chartApiUpdate:a})}updateLegendEnabledState(){const{valueCols:e}=this.chartController.getColStateForMenu();this.enabledGroup.setEnabled(e.filter(t=>t.selected).length>1)}getItems(e){const t=(i,s,n)=>this.createManagedBean(new Un(e.getDefaultSliderParams(`${this.key}.${i}`,s,n)));return this.isGradient?[this.createManagedBean(new m.AgCheckbox(e.addValueParams("gradientLegend.reverseOrder",{label:this.chartTranslation.translate("reverseDirection"),labelWidth:"flex"}))),t("gradient.thickness","thickness",40),t("gradient.preferredLength","preferredLength",300),t("spacing","spacing",200)]:[t("spacing","spacing",200),t("item.marker.size","markerSize",40),t("item.marker.strokeWidth","markerStroke",10),t("item.marker.padding","itemSpacing",20),t("item.paddingX","layoutHorizontalSpacing",50),t("item.paddingY","layoutVerticalSpacing",50)]}createLabelPanel(e){const t=this.isGradient?"gradientLegend.scale.label":"legend.item.label",i={enabled:!0,suppressEnabledCheckbox:!0,chartMenuParamsFactory:e,keyMapper:s=>`${t}.${s}`,cssIdentifier:"charts-format-sub-level-no-header"};return this.createManagedBean(new Al(i))}},TZ=class extends m.Component{constructor(e){super(),this.params=e,this.toggleableGroup=m.RefPlaceholder,this.activeComps=[],this.chartOptions=e.chartMenuParamsFactory.getChartOptions()}postConstruct(){const{tag:e,cssIdentifier:t="charts-format-sub-level",title:i,suppressEnabledCheckbox:s}=this.params,n=this.params.chartMenuParamsFactory.addEnableParams(`${e}.enabled`,{cssIdentifier:t,direction:"vertical",suppressOpenCloseIcons:!0,title:i,suppressEnabledCheckbox:!0,useToggle:!s});this.setTemplate(`<div class="ag-toggleable-group-panel">
                <ag-group-component data-ref="toggleableGroup">
                </ag-group-component>
            </div>`,[Nt],{toggleableGroup:n}),this.toggleCss("ag-toggleable-group-panel-no-header",!i)}addItem(e,t){t?this.toggleableGroup.prependItem(e):this.toggleableGroup.addItem(e),this.activeComps.push(e)}setEnabled(e){this.toggleableGroup.setEnabled(e)}destroyActiveComps(){this.activeComps.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)})}destroy(){this.destroyActiveComps(),super.destroy()}},kZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslation.translate("callout"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(`<div>
            <ag-group-component data-ref="calloutGroup">
                <ag-slider data-ref="calloutLengthSlider"></ag-slider>
                <ag-slider data-ref="calloutStrokeWidthSlider"></ag-slider>
                <ag-slider data-ref="labelOffsetSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,Mn],{calloutGroup:e,calloutLengthSlider:this.chartMenuUtils.getDefaultSliderParams("calloutLine.length","length",40),calloutStrokeWidthSlider:this.chartMenuUtils.getDefaultSliderParams("calloutLine.strokeWidth","strokeWidth",10),labelOffsetSlider:this.chartMenuUtils.getDefaultSliderParams("calloutLabel.offset","offset",30)})}},LZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslation.translate("cap"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0},t=this.chartMenuUtils.getDefaultSliderParams("cap.lengthRatio","capLengthRatio",1);t.step=.05,this.setTemplate(`<div>
            <ag-group-component data-ref="capsGroup">
                <ag-slider data-ref="capLengthRatioSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,Mn],{capsGroup:e,capLengthRatioSlider:t})}},PZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslation.translate("connectorLine"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(`<div>
            <ag-group-component data-ref="lineGroup">
                <ag-color-picker data-ref="lineColorPicker"></ag-color-picker>
                <ag-slider data-ref="lineStrokeWidthSlider"></ag-slider>
                <ag-slider data-ref="lineOpacitySlider"></ag-slider>
                <ag-slider data-ref="lineDashSlider"></ag-slider>                
            </ag-group-component>
        </div>`,[Nt,xr,Mn],{lineGroup:e,lineColorPicker:this.chartMenuUtils.getDefaultColorPickerParams("line.stroke"),lineStrokeWidthSlider:this.getSliderParams("strokeWidth",10,"line.strokeWidth"),lineDashSlider:this.getSliderParams("lineDash",30,"line.lineDash",1,!0),lineOpacitySlider:this.getSliderParams("strokeOpacity",1,"line.strokeOpacity",.05)})}getSliderParams(e,t,i,s=1,n=!1){const a=this.chartMenuUtils.getDefaultSliderParams(i,e,t,n);return a.step=s,a}};function mP(e){return["square","circle","cross","diamond","plus","triangle","heart"].map(t=>({value:t,text:e.translate(t)}))}var EZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.chartMenuUtils.addEnableParams("marker.enabled",{cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslation.translate("markers"),suppressEnabledCheckbox:!0,useToggle:!0,suppressOpenCloseIcons:!0});this.setTemplate(`<div>
            <ag-group-component data-ref="seriesMarkersGroup">
                <ag-select data-ref="seriesMarkerShapeSelect"></ag-select>
                <ag-slider data-ref="seriesMarkerSizeSlider"></ag-slider>
                <ag-slider data-ref="seriesMarkerStrokeWidthSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,m.AgSelectSelector,Mn],{seriesMarkersGroup:e,seriesMarkerShapeSelect:this.chartMenuUtils.getDefaultSelectParams("marker.shape","shape",mP(this.chartTranslation)),seriesMarkerSizeSlider:this.chartMenuUtils.getDefaultSliderParams("marker.size","size",60),seriesMarkerStrokeWidthSlider:this.chartMenuUtils.getDefaultSliderParams("marker.strokeWidth","strokeWidth",10)})}},RZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e,this.seriesItemsGroup=m.RefPlaceholder,this.activePanels=[]}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslation.translate("seriesItems"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(`<div>
            <ag-group-component data-ref="seriesItemsGroup">
                <ag-select data-ref="seriesItemSelect"></ag-select>
            </ag-group-component>
        </div>`,[Nt,m.AgSelectSelector],{seriesItemsGroup:e,seriesItemSelect:this.getSeriesItemsParams()}),this.initSeriesControls()}getSeriesItemsParams(){const e=[{value:"positive",text:this.chartTranslation.translate("seriesItemPositive")},{value:"negative",text:this.chartTranslation.translate("seriesItemNegative")}],t=i=>{this.destroyActivePanels(),this.initSeriesControls(i)};return this.chartMenuUtils.getDefaultSelectParamsWithoutValueParams("seriesItemType",e,"positive",t)}initSeriesControls(e="positive"){this.initSlider("strokeWidth",10,`item.${e}.strokeWidth`),this.initSlider("lineDash",30,`item.${e}.lineDash`,1,!0),this.initSlider("strokeOpacity",1,`item.${e}.strokeOpacity`,.05,!1),this.initSlider("fillOpacity",1,`item.${e}.fillOpacity`,.05,!1),this.initItemLabels(e)}initSlider(e,t,i,s=1,n=!1){const a=this.chartMenuUtils.getDefaultSliderParams(i,e,t,n);a.step=s;const r=this.seriesItemsGroup.createManagedBean(new Un(a));this.seriesItemsGroup.addItem(r),this.activePanels.push(r)}initItemLabels(e){const t=this.chartMenuUtils.getDefaultFontPanelParams(`item.${e}.label`,"seriesItemLabels"),i=this.createBean(new Al(t));this.seriesItemsGroup.addItem(i),this.activePanels.push(i)}destroyActivePanels(){this.activePanels.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)})}destroy(){this.destroyActivePanels(),super.destroy()}},NZ=class extends m.Component{constructor(e,t="shadow"){super(),this.chartMenuUtils=e,this.propertyKey=t}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e=this.propertyKey,t=this.chartMenuUtils.addEnableParams(`${e}.enabled`,{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslation.translate("shadow"),suppressEnabledCheckbox:!0,useToggle:!0}),i=this.chartMenuUtils.getDefaultColorPickerParams(`${e}.color`);this.setTemplate(`<div>
            <ag-group-component data-ref="shadowGroup">
                <ag-color-picker data-ref="shadowColorPicker"></ag-color-picker>
                <ag-slider data-ref="shadowBlurSlider"></ag-slider>
                <ag-slider data-ref="shadowXOffsetSlider"></ag-slider>
                <ag-slider data-ref="shadowYOffsetSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,xr,Mn],{shadowGroup:t,shadowColorPicker:i,shadowBlurSlider:this.getSliderParams("blur",0,20),shadowXOffsetSlider:this.getSliderParams("xOffset",-10,10),shadowYOffsetSlider:this.getSliderParams("yOffset",-10,10)})}getSliderParams(e,t,i){const s=`${this.propertyKey}.${e}`,n=this.chartMenuUtils.getDefaultSliderParams(s,e,i);return n.minValue=t,n}},OZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(`<div>
            <ag-group-component data-ref="groupSpacing">
                <ag-slider data-ref="groupPaddingSlider"></ag-slider>
                <ag-slider data-ref="groupSpacingSlider"></ag-slider>
            </ag-group-component>
            <ag-group-component data-ref="tileSpacing">
                <ag-slider data-ref="tilePaddingSlider"></ag-slider>
                <ag-slider data-ref="tileSpacingSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,Mn],{groupSpacing:E(b({},e),{title:this.chartTranslation.translate("group")}),tileSpacing:E(b({},e),{title:this.chartTranslation.translate("tile")}),groupPaddingSlider:this.getSliderParams("padding","group.padding"),groupSpacingSlider:this.getSliderParams("spacing","group.gap"),tilePaddingSlider:this.getSliderParams("padding","tile.padding"),tileSpacingSlider:this.getSliderParams("spacing","tile.gap")})}getSliderParams(e,t){return this.chartMenuUtils.getDefaultSliderParams(t,e,10)}},FZ=class extends m.Component{constructor(e){super(),this.chartMenuUtils=e}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const e={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslation.translate("whisker"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(`<div>
            <ag-group-component data-ref="whiskersGroup">
                <ag-color-picker data-ref="whiskerColorPicker"></ag-color-picker>
                <ag-slider data-ref="whiskerThicknessSlider"></ag-slider>
                <ag-slider data-ref="whiskerOpacitySlider"></ag-slider>
                <ag-slider data-ref="whiskerLineDashSlider"></ag-slider>
                <ag-slider data-ref="whiskerLineDashOffsetSlider"></ag-slider>
            </ag-group-component>
        </div>`,[Nt,xr,Mn],{whiskersGroup:e,whiskerColorPicker:this.chartMenuUtils.getDefaultColorPickerParams("whisker.stroke"),whiskerThicknessSlider:this.chartMenuUtils.getDefaultSliderParams("whisker.strokeWidth","strokeWidth",10),whiskerOpacitySlider:this.chartMenuUtils.getDefaultSliderParams("whisker.strokeOpacity","strokeOpacity",1),whiskerLineDashSlider:this.chartMenuUtils.getDefaultSliderParams("whisker.lineDash","lineDash",30,!0),whiskerLineDashOffsetSlider:this.chartMenuUtils.getDefaultSliderParams("whisker.lineDashOffset","lineDashOffset",30)})}},Xt="tooltips",Cs="strokeWidth",qp="lineWidth",Gs="lineDash",Qi="lineOpacity",zs="fillOpacity",zi="labels",mo="shadow",iy="stageLabels",Qp="markers",BZ=class extends m.Component{constructor(e){super(),this.options=e,this.seriesGroup=m.RefPlaceholder,this.activePanels=[],this.widgetFuncs={lineWidth:()=>this.initStrokeWidth(qp),[Cs]:()=>this.initStrokeWidth("strokeWidth"),lineColor:()=>this.initLineColor(),[Gs]:()=>this.initLineDash(),[Qi]:()=>this.initOpacity("strokeOpacity"),[zs]:()=>this.initOpacity("fillOpacity"),markers:()=>new EZ(this.chartMenuUtils),[zi]:()=>this.initLabels(),sectorLabels:()=>this.initSectorLabels(),[mo]:()=>new NZ(this.chartMenuUtils),[Xt]:()=>this.initTooltips(),bins:()=>this.initBins(),whiskers:()=>new FZ(this.chartMenuUtils),caps:()=>new LZ(this.chartMenuUtils),connectorLine:()=>new PZ(this.chartMenuUtils),seriesItems:()=>new RZ(this.chartMenuUtils),tileSpacing:()=>new OZ(this.chartMenuUtils),shape:()=>this.initShape(),size:()=>this.initSize("size","size"),minSize:()=>this.initSize("size","minSize"),maxSize:()=>this.initSize("maxSize","maxSize"),dropoff:()=>this.initDropOff(),stageLabels:()=>this.initStageLabels()},this.seriesWidgetMappings={bar:[Xt,Cs,Gs,Qi,zs,zi,mo],pie:[Xt,Cs,Qi,zs,zi,"sectorLabels",mo],donut:[Xt,Cs,Qi,zs,zi,"sectorLabels",mo],line:[Xt,qp,Gs,Qi,Qp,zi],scatter:[Xt,"shape","size",Cs,zi],bubble:[Xt,"shape","minSize","maxSize",Cs,zi],area:[Xt,qp,Gs,Qi,zs,Qp,zi,mo],histogram:[Xt,"bins",Cs,Gs,Qi,zs,zi,mo],"radial-column":[Xt,Cs,Gs,Qi,zs,zi],"radial-bar":[Xt,Cs,Gs,Qi,zs,zi],"radar-line":[Xt,Cs,Gs,Qi,Qp,zi],"radar-area":[Xt,Cs,Gs,Qi,zs,Qp,zi],nightingale:[Xt,Cs,Gs,Qi,zs,zi],"box-plot":[Xt,Cs,Gs,Qi,zs,"whiskers","caps"],"range-bar":[Xt,Cs,Gs,Qi,zs,zi],"range-area":[Xt,qp,Gs,Qi,zs,Qp,zi,mo],treemap:[Xt,"tileSpacing"],sunburst:[Xt],heatmap:[Xt,zi,"lineColor",qp,Qi],waterfall:[Xt,"connectorLine","seriesItems"],funnel:[Xt,Cs,Gs,Qi,zs,zi,"dropoff",iy,mo],"cone-funnel":[Xt,Cs,Gs,Qi,zs,zi,iy],pyramid:[Xt,Cs,Gs,Qi,zs,zi,iy,mo]},this.seriesType=e.seriesType}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{isExpandedOnInit:e,chartOptionsService:t,chartController:i,registerGroupComponent:s}=this.options,n={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.translate("series"),expanded:e,suppressEnabledCheckbox:!0};this.setTemplate(`<div>
            <ag-group-component data-ref="seriesGroup">
            </ag-group-component>
        </div>`,[Nt],{seriesGroup:n}),s(this.seriesGroup),this.chartMenuUtils=this.createManagedBean(new Qc(t.getSeriesOptionsProxy(()=>this.seriesType))),this.addManagedListeners(i,{chartSeriesChartTypeChanged:this.refreshWidgets.bind(this)}),this.refreshWidgets()}refreshWidgets(){const{chartController:e}=this.options;this.destroyActivePanels(),e.getChartProxy().getChart().waitForUpdate().then(()=>{var s;this.isAlive()&&(e.isComboChart()&&(this.updateSeriesType(),this.initSeriesSelect()),((s=this.seriesWidgetMappings[this.seriesType])!=null?s:[]).forEach(n=>{const a=this.widgetFuncs[n]();let r;if(Array.isArray(a)){const o=this.createBean(a[0]);r=o,a[1](o)}else r=this.createBean(a);this.seriesGroup.addItem(r),this.activePanels.push(r)}))}).catch(i=>(0,m._error)(105,{e:i}))}initSeriesSelect(){const e=this.createBean(new m.AgSelect(this.chartMenuUtils.getDefaultSelectParamsWithoutValueParams("seriesType",this.getSeriesSelectOptions(),`${this.seriesType}`,t=>{this.seriesType=t,this.refreshWidgets()})));this.seriesGroup.addItem(e),this.activePanels.push(e)}initTooltips(){return new m.AgToggleButton(this.chartMenuUtils.addValueParams("tooltip.enabled",{label:this.translate("tooltips"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex"}))}initLineColor(){return new oP(this.chartMenuUtils.getDefaultColorPickerParams("stroke","strokeColor"))}initStrokeWidth(e,t){return new Un(this.chartMenuUtils.getDefaultSliderParams(t?`${t}.${e}`:"strokeWidth",e,10))}initLineDash(e){return new Un(this.chartMenuUtils.getDefaultSliderParams(e?`${e}.lineDash`:"lineDash","lineDash",30,!0))}initOpacity(e,t){const i=this.chartMenuUtils.getDefaultSliderParams(t?`${t}.${e}`:e,e,1);return i.step=.05,new Un(i)}initDropOff(){return[new TZ({tag:"dropOff",cssIdentifier:"charts-format-sub-level",title:this.translate("dropOff"),suppressEnabledCheckbox:!1,chartMenuParamsFactory:this.chartMenuUtils}),i=>{[this.initStrokeWidth("strokeWidth","dropOff"),this.initLineDash("dropOff"),this.initOpacity("strokeOpacity","dropOff"),this.initOpacity("fillOpacity","dropOff")].forEach(s=>{const n=i.createManagedBean(s);i.addItem(n),this.activePanels.push(n)})}]}initLabels(){const e=JL(this.seriesType),t=e?"calloutLabel":"label",i=e?"calloutLabels":"labels",s=this.chartMenuUtils.getDefaultFontPanelParams(t,i);return[new Al(s),r=>{if(e){const o=r.createManagedBean(new kZ(this.chartMenuUtils));r.addItem(o),this.activePanels.push(o)}if(this.seriesType==="range-bar"){const o=[{value:"inside",text:this.translate("inside")},{value:"outside",text:this.translate("outside")}],l=r.createManagedBean(new m.AgSelect(this.chartMenuUtils.getDefaultSelectParams("label.placement","labelPlacement",o)));r.addItem(l),this.activePanels.push(l);const c=r.createManagedBean(new Un(this.chartMenuUtils.getDefaultSliderParams("label.padding","padding",200)));r.addItem(c),this.activePanels.push(c)}}]}initSectorLabels(){const e=this.chartMenuUtils.getDefaultFontPanelParams("sectorLabel","sectorLabels");return[new Al(e),s=>{const n=this.chartMenuUtils.getDefaultSliderParams("sectorLabel.positionRatio","positionRatio",1);n.step=.05;const a=s.createManagedBean(new Un(n));s.addItem(a)}]}initStageLabels(){return new Al(this.chartMenuUtils.getDefaultFontPanelParams("stageLabel",iy))}initBins(){var s;const e=this.chartMenuUtils.getDefaultSliderParams("binCount","histogramBinCount",20),t=this.chartMenuUtils.getChartOptions(),i=((s=t.getValue("bins"))!=null?s:t.getValue("calculatedBins",!0)).length;return e.value=`${i}`,e.maxValue=Math.max(i,20),new Un(e)}initShape(){return new m.AgSelect(this.chartMenuUtils.getDefaultSelectParams("shape","shape",mP(this.chartTranslation)))}initSize(e,t){return new Un(this.chartMenuUtils.getDefaultSliderParams(e,t,60))}getSeriesSelectOptions(){const e=this.getActiveSeriesTypes();return["area","bar","line"].filter(t=>e.includes(t)).map(t=>({value:t,text:this.translate(t)}))}updateSeriesType(){const e=this.getActiveSeriesTypes();!e.includes(this.seriesType)&&e.length>0&&(this.seriesType=e[0])}getActiveSeriesTypes(){return this.options.chartController.getActiveSeriesChartTypes().map(e=>Ot(e.chartType))}translate(e){return this.chartTranslation.translate(e)}destroyActivePanels(){this.activePanels.forEach(e=>{(0,m._removeFromParent)(e.getGui()),this.destroyBean(e)})}destroy(){this.destroyActivePanels(),super.destroy()}},Jp=class extends m.Component{constructor(e,t,i){super("<div></div>"),this.chartMenuUtils=e,this.name=t,this.key=i,this.chartOptions=e.getChartOptions()}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){this.initFontPanel()}hasTitle(){const e=this.chartOptions.getValue(this.key);return e&&e.enabled&&e.text&&e.text.length>0}initFontPanel(){const e=this.hasTitle(),t={name:this.chartTranslation.translate(this.name),enabled:e,suppressEnabledCheckbox:!1,chartMenuParamsFactory:this.chartMenuUtils,keyMapper:i=>`${this.key}.${i}`,onEnableChange:i=>this.onEnableChange(i)};this.fontPanel=this.createManagedBean(new Al(t)),this.fontPanel.addItem(this.createBean(new m.AgInputTextField(this.getTextInputParams())),!0),this.fontPanel.addItem(this.createBean(new Un(this.getSpacingSliderParams()))),this.getGui().appendChild(this.fontPanel.getGui())}getTextInputParams(){return this.chartMenuUtils.addValueParams(`${this.key}.text`,{label:this.chartTranslation.translate("title"),labelAlignment:"top"})}getSpacingSliderParams(){return this.chartMenuUtils.getDefaultSliderParams(`${this.key}.spacing`,"spacing",100)}onEnableChange(e){this.chartOptions.setValue(`${this.key}.enabled`,e)}},_Z=class extends Jp{wireBeans(e){super.wireBeans(e),this.chartMenuSvc=e.chartMenuSvc}postConstruct(){this.titlePlaceholder=this.chartTranslation.translate("titlePlaceholder"),super.postConstruct(),this.addManagedEventListeners({chartTitleEdit:()=>{this.fontPanel.setEnabled(this.hasTitle())}})}getTextInputParams(){const e=super.getTextInputParams();return this.shouldOverrideTextWithPlaceholder(e.value)&&(e.value=this.titlePlaceholder),e}getSpacingSliderParams(){const e=super.getSpacingSliderParams();return e.value="10",e}onEnableChange(e){if(this.chartMenuSvc.doesChartToolbarExist()){const i=this.chartOptions.getValue("padding.top");this.chartOptions.setValue("padding.top",e?i-20:i+20)}this.chartOptions.setValue(`${this.key}.enabled`,e);const t=this.chartOptions.getValue(`${this.key}.text`);e&&this.shouldOverrideTextWithPlaceholder(t)&&this.chartOptions.setValue(`${this.key}.text`,this.titlePlaceholder)}shouldOverrideTextWithPlaceholder(e){return e==="Title"||(e==null?void 0:e.trim().length)===0}},GZ=class extends m.Component{constructor(e){super(),this.options=e,this.titleGroup=m.RefPlaceholder}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){const{chartMenuParamsFactory:e,chartAxisMenuParamsFactory:t,chartOptionsService:i,seriesType:s,isExpandedOnInit:n=!1,registerGroupComponent:a}=this.options,r=[];if(Dl(s)&&s!=="pyramid"){const l=c=>this.createManagedBean(new Qc(i.getCartesianAxisThemeOverridesProxy(c)));r.push(this.createManagedBean(new Jp(l("xAxis"),"horizontalAxisTitle","title"))),r.push(this.createManagedBean(new Jp(l("yAxis"),"verticalAxisTitle","title")))}else OS(s)&&r.push(this.createManagedBean(new Jp(t,"polarAxisTitle","title")));const o={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.chartTranslation.translate("chartTitles"),expanded:n,suppressEnabledCheckbox:!0,items:[this.createManagedBean(new _Z(e,"chartTitle","title")),this.createManagedBean(new Jp(e,"chartSubtitle","subtitle")),...r]};this.setTemplate(`<div>
            <ag-group-component data-ref="titleGroup"></ag-group-component>
        </div>`,[Nt],{titleGroup:o}),a(this.titleGroup)}},zZ={groups:[{type:"chart"},{type:"titles"},{type:"legend"},{type:"series"},{type:"axis"}]},yP=["axis","horizontalAxis","verticalAxis"],VZ=class extends m.Component{constructor(e){super('<div class="ag-chart-format-wrapper"></div>'),this.chartMenuContext=e}postConstruct(){this.groupExpansionFeature=this.createManagedBean(new AZ(this.getGui())),this.chartPanelFeature=this.createManagedBean(new aP(this.chartMenuContext.chartController,this.getGui(),"ag-chart-format-section",(e,t)=>this.createPanels(t))),this.chartPanelFeature.refreshPanels()}createPanels(e){var i;let t=!1;(i=this.getFormatPanelDef().groups)==null||i.forEach(({type:s,isOpen:n=!1})=>{if(!this.isGroupPanelShownInSeries(s,e))return;n&&(t&&(0,m._warn)(145,{group:s}),t=!0);const a=o=>this.groupExpansionFeature.addGroupComponent(o),r=E(b({},this.chartMenuContext),{isExpandedOnInit:n,seriesType:e,registerGroupComponent:a});switch(s){case"chart":this.chartPanelFeature.addComponent(new wZ(r));break;case"titles":this.chartPanelFeature.addComponent(new GZ(r));break;case"legend":this.chartPanelFeature.addComponent(new IZ(r,this.chartMenuContext));break;case"axis":OS(e)?this.chartPanelFeature.addComponent(new SZ(r)):Dl(e)&&(this.chartPanelFeature.addComponent(new ty("xAxis",r)),this.chartPanelFeature.addComponent(new ty("yAxis",r)));break;case"horizontalAxis":this.chartPanelFeature.addComponent(new ty("xAxis",r));break;case"verticalAxis":this.chartPanelFeature.addComponent(new ty("yAxis",r));break;case"series":this.chartPanelFeature.addComponent(new BZ(r));break;default:(0,m._warn)(147,{group:s})}})}getFormatPanelDef(){var t;const e=(t=this.gos.get("chartToolPanelsDef"))==null?void 0:t.formatPanel;return e||zZ}isGroupPanelShownInSeries(e,t){const i=["chart","titles","legend","series"].includes(e)||Dl(t)&&yP.includes(e)||OS(t)&&e==="axis",s=NS(t)&&e==="legend"||NS(t)&&yP.includes(e);return i&&!s}},jZ="ag-chart-mini-thumbnail-canvas",Jc=class extends m.Component{constructor(e,t,i){super(),this.agChartsExports=t,this.tooltipName=i,this.size=58,this.padding=5;const{_Scene:s}=t;this.root=new s.Group;const n=new s.Scene({width:this.size,height:this.size});n.canvas.element.classList.add(jZ),n.setRoot(this.root),n.setContainer(e),this.scene=n}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){this.scene.canvas.element.title=this.chartTranslation.translate(this.tooltipName);try{this.scene.render()}catch(e){(0,m._error)(108,{e})}}};function eg(e){const{stacked:t,size:i,padding:s,xScalePadding:n,xScaleDomain:a,yScaleDomain:r,agChartsExports:{_Scene:o}}=e,l=new o.CategoryScale;l.domain=a,l.range=[s,i-s],l.paddingInner=n,l.paddingOuter=n;const c=new o.LinearScale;c.domain=r,c.range=[i-s,s];const h=(d,u,p)=>d.map((g,f)=>{const y=p.convert(g),v=new o.Rect;return v.x=u.convert(f),v.y=y,v.width=u.bandwidth,v.height=p.convert(0)-y,v.strokeWidth=0,v.crisp=!0,v});return t?e.data.map(d=>h(d,l,c)):h(e.data,l,c)}function HZ(e,t,i,s){const n=[],a=[];t.forEach(l=>{l.forEach(([c,h])=>{n.push(c),a.push(h)})});const r=new e.LinearScale;r.domain=[Math.min(...n),Math.max(...n)],r.range=[s,i-s];const o=new e.LinearScale;return o.domain=[Math.min(...a),Math.max(...a)],o.range=[i-s,s],{xScale:r,yScale:o}}function vP(e,t,i,s){const n=[0,t[0].length-1],a=t.reduce((l,c)=>(c.forEach(h=>{h<l[0]&&(l[0]=h),h>l[1]&&(l[1]=h)}),l),[1/0,-1/0]);a[0]--,a[a.length-1]++;const r=new e.LinearScale;r.domain=n,r.range=[s,i-s];const o=new e.LinearScale;return o.domain=a,o.range=[i-s,s],{xScale:r,yScale:o}}function bP(e,t,i){return e.map(s=>s.map((n,a)=>[a>0?"lineTo":"moveTo",t.convert(a),i.convert(n)]))}function WZ(e,t,i){return e.map(([s,n],a)=>[a>0?"lineTo":"moveTo",t.convert(s),i.convert(n)])}function UZ(e){const t=e[0],i=e[1],s=(0,m._last)(e);return(i[1]!==s[1]||i[2]!==s[2])&&e.push([t[0],i[1],i[2]]),e}function xP(e,t){const i=new e.Path;return t.forEach(([s,n,a])=>i.path[s](n,a)),i}function KZ(e,t,i){return e.map((s,n,a)=>{const o=[...i?$Z(a,n,t):CP(s,t)].reverse().map(([h,d,u])=>["lineTo",d,u]),l=s[0],c=(0,m._last)(o);return(l[1]!==c[1]||l[2]!==c[2])&&o.push(["lineTo",l[1],l[2]]),[...s,...o]})}function $Z(e,t,i){return t===0?CP(e[t],i):[...e[t-1]]}function CP(e,t){return e.map(([i,s])=>[i,s,t.convert(0)])}function SP(e,t){const i=xP(e,t);return i.fill=void 0,i.lineCap="round",i.strokeWidth=3,i}function YZ({_Scene:e},t,i,s,n){const{xScale:a,yScale:r}=HZ(e,i,s,n),h=i.map(u=>WZ(u,a,r)).map(u=>UZ(u)).map(u=>SP(e,u)).reduce((u,p)=>u.concat(p),[]),d=new e.Group;return d.setClipRect(new e.BBox(n,n,s-n*2,s-n*2)),d.append(h),t.append(d),h}function jS({_Scene:e},t,i,s,n){const{xScale:a,yScale:r}=vP(e,i,s,n),l=bP(i,a,r).map(h=>SP(e,h)),c=new e.Group;return c.setClipRect(new e.BBox(n,n,s-n*2,s-n*2)),c.append(l),t.append(c),l}function XZ(e,t,i,s,n,a=!1){const{xScale:r,yScale:o}=vP(e,i,s,n),l=KZ(bP(i,r,o),o,a),c=new e.Group;c.setClipRect(new e.BBox(n,n,s-n*2,s-n*2));const h=l.map(d=>xP(e,d));return c.append(h),t.append(c),h}function MP(e){return e.map((t,i,s)=>t.map((n,a)=>s.slice(0,i+1).reduce((r,o)=>r+o[a],0)))}function DP(e){const t=e.map((i,s)=>e.reduce((n,a)=>Math.max(n,a[s]),0));return e.map(i=>i.map((s,n)=>s/t[n]*19))}function wP(e,t,i,s,n,a,r=0){const{_Scene:o}=e,l=new o.LinearScale;l.domain=[0,7],l.range=[-Math.PI,Math.PI].map(g=>g+Math.PI/2);const c=new o.LinearScale;c.domain=[0,10],c.range=[n,a];const h=[],d=s/2,u=i.map(g=>{const f=new o.Path;return f.strokeWidth=1,f.strokeOpacity=.5,f.lineCap="round",f.fill=void 0,f.fillOpacity=.8,g.forEach((y,v)=>{const x=l.convert(v),S=n+a-c.convert(y),M=S*Math.cos(x)+d,D=S*Math.sin(x)+d;if(f.path[v>0?"lineTo":"moveTo"](M,D),r>0){const A=new o.Marker({shape:"circle"});A.x=M,A.y=D,A.size=r,h.push(A)}}),f.path.closePath(),f}),p=new o.Group;return p.append([...u,...h]),t.append(p),{paths:u,markers:h}}function sy(e){let[t,i]=[1/0,-1/0];return{processedData:e.reduce((n,a,r)=>{var c;const o=r>0?n[r-1]:void 0;(c=n[r])!=null||(n[r]=[]);const l=n[r];return a.forEach((h,d)=>{o&&(h+=o[d]),l[d]=h,l[d]<t&&(t=l[d]),l[d]>i&&(i=l[d])}),n},[]),min:t,max:i}}var ZZ=[[[13,16],[13,12],[3,12],[3,16]],[[12,11],[12,7],[4,7],[4,11]],[[10.125,6],[10.125,1.5],[5.875,1.5],[5.875,6]]],HS=class extends Jc{constructor(e,t,i,s,n,a="funnelTooltip",r=ZZ){super(e,t,a),this.shapes=YZ(t,this.root,r,this.size,this.padding),this.updateColors(i,s)}updateColors(e,t){this.shapes.forEach(i=>{i.fill=e[0],i.stroke=t[0],i.strokeWidth=0})}},qZ={chartType:"funnel",miniChart:HS},QZ=[[[13,16],[10.75,11.5],[5.25,11.5],[3,16]],[[10.75,11.5],[8.875,6],[7.125,6],[5.25,11.5]],[[8.875,6],[8.875,1.5],[7.125,1.5],[7.125,6]]],JZ=class extends HS{constructor(e,t,i,s,n,a="coneFunnelTooltip"){super(e,t,i,s,n,a,QZ)}updateColors(e,t){this.shapes.forEach((i,s)=>{i.fill=e[0],i.fillOpacity=1-s*.2,i.stroke=t[0],i.strokeWidth=0})}},e7={chartType:"coneFunnel",miniChart:JZ},t7=[[[8,16],[10,12],[6,12]],[[10.5,11],[12.5,7],[3.5,7],[5.5,11]],[[13,6],[15.5,1.5],[.5,1.5],[3,6]]],i7=class extends HS{constructor(e,t,i,s,n,a="pyramidTooltip"){super(e,t,i,s,n,a,t7)}updateColors(e,t){this.shapes.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s],i.strokeWidth=0})}},s7={chartType:"pyramid",miniChart:i7},ln=class extends Jc{constructor(e,t,i){super(e,t,i),this.stroke="gray",this.axisOvershoot=3}postConstruct(){const{_Scene:e}=this.agChartsExports,t=this.size,i=this.padding,s=new e.Line;s.x1=i,s.y1=i,s.x2=i,s.y2=t-i+this.axisOvershoot,s.stroke=this.stroke;const n=new e.Line;n.x1=i-this.axisOvershoot+1,n.y1=t-i,n.x2=t-i+1,n.y2=t-i,n.stroke=this.stroke;const a=this.root;a.append(s),a.append(n),super.postConstruct()}},n7=class extends ln{constructor(e,t,i,s){super(e,t,"groupedColumnTooltip"),this.columnData=[2,3,4];const{root:n,columnData:a,size:r,padding:o}=this;this.columns=eg({stacked:!1,root:n,data:a,size:r,padding:o,xScaleDomain:[0,1,2],yScaleDomain:[0,4],xScalePadding:.3,agChartsExports:t}),n.append(this.columns),this.updateColors(i,s)}updateColors(e,t){this.columns.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]})}},a7={chartType:"groupedColumn",miniChart:n7},r7=[[8,12,16],[6,9,12],[2,3,4]],AP=class extends ln{constructor(e,t,i,s,n,a=r7,r=[0,16],o="stackedColumnTooltip"){super(e,t,o);const{root:l,size:c,padding:h}=this;this.stackedColumns=eg({stacked:!0,root:l,data:a,size:c,padding:h,xScaleDomain:[0,1,2],yScaleDomain:r,xScalePadding:.3,agChartsExports:t}),l.append((0,m._flatten)(this.stackedColumns)),this.updateColors(i,s)}updateColors(e,t){this.stackedColumns.forEach((i,s)=>i.forEach(n=>{n.fill=e[s],n.stroke=t[s]}))}},o7={chartType:"stackedColumn",miniChart:AP},l7=[[10,10,10],[6,7,8],[2,4,6]],c7=class extends AP{constructor(e,t,i,s,n){super(e,t,i,s,n,l7,[0,10],"normalizedColumnTooltip")}},h7={chartType:"normalizedColumn",miniChart:c7},d7=class extends ln{constructor(e,t,i,s){super(e,t,"groupedBarTooltip");const{_Scene:n}=t,a=this.padding,r=this.size,o=[2,3,4],l=new n.CategoryScale;l.domain=[0,1,2],l.range=[a,r-a],l.paddingInner=.3,l.paddingOuter=.3;const c=new n.LinearScale;c.domain=[0,4],c.range=[r-a,a];const h=c.convert(0),d=l.bandwidth;this.bars=o.map((u,p)=>{const g=new n.Rect;return g.x=a,g.y=l.convert(p),g.width=h-c.convert(u),g.height=d,g.strokeWidth=0,g.crisp=!0,g}),this.updateColors(i,s),this.root.append(this.bars)}updateColors(e,t){this.bars.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]})}},u7={chartType:"groupedBar",miniChart:d7},p7=[[8,12,16],[6,9,12],[2,3,4]],IP=class extends ln{constructor(e,t,i,s,n,a=p7,r=[0,16],o="stackedBarTooltip"){super(e,t,o);const{_Scene:l}=t,c=this.size,h=this.padding,d=new l.CategoryScale;d.domain=[0,1,2],d.range=[h,c-h],d.paddingInner=.3,d.paddingOuter=.3;const u=new l.LinearScale;u.domain=r,u.range=[c-h,h];const p=u.convert(0),g=d.bandwidth;this.bars=a.map(f=>f.map((y,v)=>{const x=new l.Rect;return x.x=h,x.y=d.convert(v),x.width=p-u.convert(y),x.height=g,x.strokeWidth=0,x.crisp=!0,x})),this.updateColors(i,s),this.root.append((0,m._flatten)(this.bars))}updateColors(e,t){this.bars.forEach((i,s)=>i.forEach(n=>{n.fill=e[s],n.stroke=t[s]}))}},g7={chartType:"stackedBar",miniChart:IP},f7=[[10,10,10],[6,7,8],[2,4,6]],m7=class extends IP{constructor(e,t,i,s,n){super(e,t,i,s,n,f7,[0,10],"normalizedBarTooltip")}},y7={chartType:"normalizedBar",miniChart:m7},TP=class extends Jc{constructor(e,t,i,s,n,a=.6,r="donutTooltip"){super(e,t,r);const{size:o,padding:l,agChartsExports:{_Scene:c}}=this,h=(o-l*2)/2,d=h+l,u=c.toRadians,p=[[u(-90),u(30)],[u(30),u(120)],[u(120),u(180)],[u(180),u(210)],[u(210),u(240)],[u(240),u(270)]];this.sectors=p.map(([g,f])=>{const y=new c.Sector;return y.centerX=d,y.centerY=d,y.innerRadius=h*a,y.outerRadius=h,y.startAngle=g,y.endAngle=f,y.stroke=void 0,y.strokeWidth=0,y.inset=.75,y}),this.updateColors(i,s),this.root.append(this.sectors)}updateColors(e,t){this.sectors.forEach((i,s)=>{i.fill=e[s%e.length],i.stroke=t[s%t.length]})}},kP={chartType:"donut",miniChart:TP},v7=class extends TP{constructor(e,t,i,s,n){super(e,t,i,s,n,0,"pieTooltip")}},b7={chartType:"pie",miniChart:v7},WS=[[1,3,5],[2,6,4],[5,3,1]],US=class extends ln{constructor(e,t,i,s,n,a=WS,r="lineTooltip"){super(e,t,r);const{size:o,padding:l,root:c}=this;this.lines=jS(t,c,a,o,l),this.updateColors(i,s)}updateColors(e,t){this.lines.forEach((i,s)=>{i.stroke=e[s]})}},x7={chartType:"line",miniChart:US},LP=MP(WS),C7=class extends US{constructor(e,t,i,s,n,a=LP,r="stackedLineTooltip"){super(e,t,i,s,n,a,r)}},S7={chartType:"stackedLine",miniChart:C7},M7=DP(LP),D7=class extends US{constructor(e,t,i,s,n,a=M7,r="normalizedLineTooltip"){super(e,t,i,s,n,a,r)}},w7={chartType:"normalizedLine",miniChart:D7},A7=class extends ln{constructor(e,t,i,s){super(e,t,"scatterTooltip");const{size:n,padding:a,agChartsExports:{_Scene:r}}=this,o=[[[.3,3],[1.1,.9],[2,.4],[3.4,2.4]],[[0,.3],[1,2],[2.4,1.4],[3,0]]],l=new r.LinearScale;l.domain=[-.5,4],l.range=[a*2,n-a];const c=new r.LinearScale;c.domain=[-.5,3.5],c.range=[n-a,a];const h=[];o.forEach(u=>{u.forEach(([p,g])=>{const f=new r.Arc;f.strokeWidth=0,f.centerX=l.convert(p),f.centerY=c.convert(g),f.radius=2.5,h.push(f)})}),this.points=h,this.updateColors(i,s);const d=new r.Group;d.setClipRect(new r.BBox(a,a,n-a*2,n-a*2)),d.append(this.points),this.root.append(d)}updateColors(e,t){this.points.forEach((i,s)=>{i.stroke=t[s%t.length],i.fill=e[s%e.length]})}},I7={chartType:"scatter",miniChart:A7},T7=class extends ln{constructor(e,t,i,s){super(e,t,"bubbleTooltip");const{size:n,padding:a,agChartsExports:{_Scene:r}}=this,o=[[[.1,.3,5],[.5,.4,7],[.2,.8,7]],[[.8,.7,5],[.7,.3,9]]],l=new r.LinearScale;l.domain=[0,1],l.range=[a*2,n-a];const c=new r.LinearScale;c.domain=[0,1],c.range=[n-a,a];const h=[];o.forEach(u=>{u.forEach(([p,g,f])=>{const y=new r.Arc;y.strokeWidth=0,y.centerX=l.convert(p),y.centerY=c.convert(g),y.radius=f,y.fillOpacity=.7,h.push(y)})}),this.points=h,this.updateColors(i,s);const d=new r.Group;d.setClipRect(new r.BBox(a,a,n-a*2,n-a*2)),d.append(this.points),this.root.append(d)}updateColors(e,t){this.points.forEach((i,s)=>{i.stroke=t[s%t.length],i.fill=e[s%e.length]})}},k7={chartType:"bubble",miniChart:T7},PP=WS,EP=class extends ln{constructor(e,t,i,s,n,a=PP,r="groupedAreaTooltip",o=!1){super(e,t,r),this.areas=XZ(t._Scene,this.root,a,this.size,this.padding,o),this.updateColors(i,s)}updateColors(e,t){this.areas.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s],i.strokeWidth=1,i.strokeOpacity=.75,i.fillOpacity=.7})}},L7={chartType:"area",miniChart:EP},RP=MP(PP),NP=class extends EP{constructor(e,t,i,s,n,a=RP,r="stackedAreaTooltip"){super(e,t,i,s,n,a,r,!0)}updateColors(e,t){this.areas.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]})}},P7={chartType:"stackedArea",miniChart:NP},E7=DP(RP),R7=class extends NP{constructor(e,t,i,s,n,a=E7,r="normalizedAreaTooltip"){super(e,t,i,s,n,a,r)}},N7={chartType:"normalizedArea",miniChart:R7},O7=class extends ln{constructor(e,t,i,s){super(e,t,"histogramTooltip");const{padding:n,size:a,agChartsExports:{_Scene:r}}=this,o=[2,5,11,13,10,6,1],l=new r.LinearScale;l.domain=[0,o.length],l.range=[n,a-n];const c=new r.LinearScale;c.domain=[0,o.reduce((d,u)=>Math.max(d,u),0)],c.range=[a-n,n];const h=c.convert(0);this.bars=o.map((d,u)=>{const p=c.convert(d),g=l.convert(u),f=l.convert(u+1),y=new r.Rect;return y.x=g,y.y=p,y.width=f-g,y.height=h-p,y.strokeWidth=1,y.strokeOpacity=.75,y.crisp=!0,y}),this.updateColors(i,s),this.root.append(this.bars)}updateColors([e],[t]){this.bars.forEach(i=>{i.fill=e,i.stroke=t})}},F7={chartType:"histogram",miniChart:O7},zd=class extends Jc{constructor(e,t,i){super(e,t,i),this.stroke="gray",this.showRadiusAxisLine=!0,this.showAngleAxisLines=!0}postConstruct(){const{_Scene:e}=this.agChartsExports,t=this.size,i=this.padding,s=i*2,n=(t-s)/2,a=this.showAngleAxisLines?[n,n*.8,n*.6,n*.4]:[],r=new e.Line;r.x1=t/2,r.y1=i,r.x2=t/2,r.y2=t-i-n-a[a.length-1],r.stroke=this.stroke,r.strokeOpacity=.5,r.fill=void 0,r.visible=this.showRadiusAxisLine;const o=i+n;this.gridLines=a.map((c,h)=>{const d=new e.Path;return d.path.arc(o,o,c,0,2*Math.PI),d.strokeWidth=1,d.stroke=this.stroke,d.strokeOpacity=h===0?.5:.2,d.fill=void 0,d});const l=this.root;l.append(r),this.gridLines.length>0&&l.append(this.gridLines),super.postConstruct()}},B7=class extends zd{constructor(e,t,i,s){super(e,t,"radialColumnTooltip"),this.data=[[6,8,10,2,6,5],[4,4,3,6,4,4],[5,4,2,9,8,9]],this.showRadiusAxisLine=!1;const{padding:n,size:a,data:r,agChartsExports:{_Scene:o}}=this,l=(a-n*2)/2,h=l*.4,d=new o.CategoryScale;d.domain=r[0].map((v,x)=>x),d.range=[0,2*Math.PI],d.paddingInner=0,d.paddingOuter=0;const u=d.bandwidth*.7,{processedData:p,max:g}=sy(r),f=new o.LinearScale;f.domain=[0,g],f.range=[h,l];const y=this.size/2;this.series=p.map((v,x)=>{const M=x===0?void 0:p[x-1],D=new o.TranslatableGroup({zIndex:1e6}),A=v.map((w,T)=>{const k=M==null?void 0:M[T],N=f.convert(w),O=f.convert(k!=null?k:0),L=d.convert(T),F=L+u,B=o.getRadialColumnWidth(L,F,l,.5,.5),_=new o.RadialColumnShape;return _.columnWidth=B,_.innerRadius=O,_.outerRadius=N,_.startAngle=L,_.endAngle=F,_.isBeveled=!0,_.axisInnerRadius=h,_.axisOuterRadius=l,_.stroke=void 0,_.strokeWidth=0,_});return D.append(A),D.translationX=y,D.translationY=y,D}),this.root.append(this.series),this.updateColors(i,s)}updateColors(e,t){this.series.forEach((i,s)=>{for(const n of i.children())n.fill=e[s%e.length],n.stroke=t[s%t.length]})}},_7={chartType:"radialColumn",miniChart:B7},G7=class extends zd{constructor(e,t,i,s){super(e,t,"radialBarTooltip"),this.data=[[6,8,10],[4,4,3],[5,4,2]],this.showRadiusAxisLine=!1;const{size:n,padding:a,data:r,agChartsExports:{_Scene:o}}=this,l=(n-a)/2,h=l*.4,d=new o.CategoryScale;d.domain=r[0].map((S,M)=>M),d.range=[h,l],d.paddingInner=.5,d.paddingOuter=0;const u=d.bandwidth,{processedData:p,max:g}=sy(r),f=new o.LinearScale;f.domain=[0,Math.ceil(g*1.5)];const y=3/2*Math.PI,v=y+2*Math.PI;f.range=[y,v];const x=n/2;this.series=p.map((S,M)=>{const D=M<0?void 0:p[M-1],A=new o.Group({zIndex:1e6}),w=S.map((T,k)=>{var G;const N=(G=D==null?void 0:D[k])!=null?G:0,O=d.convert(k),L=O-u,F=f.convert(N),B=f.convert(T),_=new o.Sector;return _.centerX=x,_.centerY=x,_.innerRadius=L,_.outerRadius=O,_.startAngle=F,_.endAngle=B,_.stroke=void 0,_.strokeWidth=0,_});return A.append(w),A}),this.root.append(this.series),this.updateColors(i,s)}updateColors(e,t){this.series.forEach((i,s)=>{for(const n of i.children())n.fill=e[s%e.length],n.stroke=t[s%t.length]})}},z7={chartType:"radialBar",miniChart:G7},V7=class extends zd{constructor(e,t,i,s){super(e,t,"radarLineTooltip"),this.markerSize=4,this.data=[[8,7,8,7,8,8,7,8],[6,8,5,10,6,7,4,6],[0,3,3,5,4,4,2,0]],this.showRadiusAxisLine=!1;const{size:n,padding:a,root:r,data:o}=this,l=(n-a*2)/2,c=0,{paths:h,markers:d}=wP(t,r,o,n,l,c,this.markerSize);this.lines=h,this.markers=d,this.updateColors(i,s)}updateColors(e,t){this.lines.forEach((i,s)=>{const n=this.data[s].length;i.stroke=e[s];const a=s*n,r=a+n;this.markers.slice(a,r).forEach(l=>{l.stroke=t[s],l.fill=e[s]})})}},j7={chartType:"radarLine",miniChart:V7},H7=class extends zd{constructor(e,t,i,s){super(e,t,"radarAreaTooltip"),this.data=[[8,10,5,7,4,1,5,8],[1,1,2,7,7,8,10,1],[4,5,9,9,4,2,3,4]];const{size:n,padding:a,root:r,data:o}=this;this.showRadiusAxisLine=!1;const l=(n-a*2)/2,c=l-n*.3;this.areas=wP(t,r,o,n,l,c).paths,this.updateColors(i,s)}updateColors(e,t){this.areas.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]})}},W7={chartType:"radarArea",miniChart:H7},U7=class extends zd{constructor(e,t,i,s){super(e,t,"nightingaleTooltip"),this.data=[[6,10,9,8,7,8],[4,6,5,4,5,5],[3,5,4,3,4,7]],this.showRadiusAxisLine=!1;const{size:n,padding:a,data:r,agChartsExports:{_Scene:o}}=this,l=(n-a*2)/2,c=new o.CategoryScale;c.domain=r[0].map((f,y)=>y),c.range=[-Math.PI,Math.PI],c.paddingInner=0,c.paddingOuter=0;const h=c.bandwidth*.7,{processedData:d,max:u}=sy(r),p=new o.LinearScale;p.domain=[0,u],p.range=[0,l];const g=n/2;this.series=d.map((f,y)=>{const v=y<0?void 0:d[y-1],x=new o.Group({zIndex:1e6}),S=f.map((M,D)=>{const A=v==null?void 0:v[D],w=p.convert(M),T=p.convert(A!=null?A:0),k=c.convert(D),N=k+h,O=new o.Sector;return O.centerX=g,O.centerY=g,O.innerRadius=T,O.outerRadius=w,O.startAngle=k,O.endAngle=N,O.stroke=void 0,O.strokeWidth=0,O});return x.append(S),x}),this.root.append(this.series),this.updateColors(i,s)}updateColors(e,t){this.series.forEach((i,s)=>{for(const n of i.children())n.fill=e[s%e.length],n.stroke=t[s%t.length]})}},K7={chartType:"nightingale",miniChart:U7},$7=class extends ln{constructor(e,t,i,s){super(e,t,"rangeBarTooltip");const n=[3,3.5,3];this.bars=this.createRangeBar(this.root,n,this.size,this.padding,"vertical"),this.updateColors(i,s)}updateColors(e,t){this.bars.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]})}createRangeBar(e,t,i,s,n){const a=n==="horizontal",r=2*s,{_Scene:o}=this.agChartsExports,l=new o.CategoryScale;l.domain=t.map((g,f)=>f),l.range=[s,i-s],l.paddingInner=.3,l.paddingOuter=.3;const c=.7,h=1.3,d=new o.LinearScale;d.domain=[t.reduce((g,f)=>Math.min(g,f),1/0)*c,t.reduce((g,f)=>Math.max(g,f),0)*h],d.range=[r,i-r];const u=l.bandwidth,p=t.map((g,f)=>{const[y,v]=[g*c,g*h],x=l.convert(f),S=d.convert(y),M=d.convert(v)-S,D=new o.Rect;return D.x=a?S:x,D.y=a?x:S,D.width=a?M:u,D.height=a?u:M,D.strokeWidth=0,D.crisp=!0,D});return e.append(p),p}},Y7={chartType:"rangeBar",miniChart:$7},X7=class extends ln{constructor(e,t,i,s){super(e,t,"rangeAreaTooltip");const n=4,a=[KS({offset:.375*n,length:n,pattern:{low:3,high:5,period:n}}),KS({offset:.375*n,length:n,pattern:{low:2.25,high:4.25,period:n}}),KS({offset:.75*n,length:n,pattern:{low:2.5,high:4.5,period:n}})],r=1.75,o=a.map(h=>h.map(([d,u])=>({x:d,low:u-.5*r,high:u+.5*r}))),{lines:l,areas:c}=this.createRangeArea(this.root,o,this.size,this.padding);this.lines=l,this.areas=c,this.updateColors(i,s)}updateColors(e,t){e=FP(e,1,2),t=FP(t,1,2),this.lines.forEach(([i,s],n)=>{i.fill=void 0,i.stroke=t[n],s.fill=void 0,s.stroke=t[n]}),this.areas.forEach((i,s)=>{i.fill=e[s]})}createRangeArea(e,t,i,s){const n=t.reduce((f,y)=>y.reduce((v,{x})=>Math.min(v,x),f),1/0),a=t.reduce((f,y)=>y.reduce((v,{x})=>Math.max(v,x),f),-1/0),r=t.reduce((f,y)=>y.reduce((v,{low:x})=>Math.min(v,x),f),1/0),o=t.reduce((f,y)=>y.reduce((v,{high:x})=>Math.max(v,x),f),-1/0),{_Scene:l}=this.agChartsExports,c=new l.LinearScale;c.domain=[n,a],c.range=[s,i-s];const h=2*s,d=new l.LinearScale;d.domain=[r,o],d.range=[i-h,h];const u=[],p=[];return t.map(f=>{const y=new l.Path,v=new l.Path,x=new l.Path;return u.push([y,v]),p.push(x),y.strokeWidth=0,v.strokeWidth=0,x.strokeWidth=0,x.fillOpacity=.8,y.path.clear(),v.path.clear(),x.path.clear(),f.map((S,M)=>{const{x:D,low:A,high:w}=S,T=c.convert(D),k=d.convert(A),N=d.convert(w),O=M>0?"lineTo":"moveTo";return y.path[O](T,N),v.path[O](T,k),x.path[O](T,N),[T,k]})}).forEach((f,y)=>{const v=f.length-1,x=p[y];for(let S=v;S>=0;S--){const[M,D]=f[S];x.path.lineTo(M,D)}}),e.append(p.concat(...u)),{lines:u,areas:p}}};function KS(e){const{offset:t,length:i,pattern:s}=e,n=o(t,i,s),a=0,r=i;return(n.length===0||n[0][0]!==a)&&n.unshift(l(a,t,s)),n[n.length-1][0]!==r&&n.push(l(r,t,s)),n;function o(h,d,u){const{period:p}=u,g=h/p,y=[0,.5].map(x=>x-g).map(OP).sort((x,S)=>x-S);return Array.from({length:Math.floor(y.length*(p/d))},(x,S)=>y[S%y.length]+Math.floor(S/y.length)).map(x=>x*p).map(x=>l(x,h,u))}function l(h,d,u){return[h,c(d+h,u)]}function c(h,d){const{low:u,high:p,period:g}=d,f=OP(h/g),y=f>.5?1-2*(f-.5):2*f;return u+(p-u)*y}}function OP(e){const t=e%1;return t<0?t+1:t}function FP(e,t,i){const s=[...e],n=s[t];return s[t]=s[i],s[i]=n,s}var Z7={chartType:"rangeArea",miniChart:X7},q7=class extends ln{constructor(e,t,i,s,n){super(e,t,"boxPlotTooltip");const{size:a,padding:r,agChartsExports:{_Scene:o}}=this,l=[11,11.5,10.5],c=1.2,h=1.1,d=.9,u=.8,p=new o.LinearScale;p.domain=[l.reduce((v,x)=>Math.min(v,x),1/0)*u,l.reduce((v,x)=>Math.max(v,x),0)*c],p.range=[a-1.5*r,r];const g=new o.CategoryScale;g.domain=l.map((v,x)=>x),g.range=[r,a-r],g.paddingInner=.4,g.paddingOuter=.2;const f=Math.round(g.bandwidth),y=Math.round(g.bandwidth/2);this.boxPlotGroups=l.map((v,x)=>{const[S,M,D,A]=[v*u,v*d,v*h,v*c],w=Math.round(p.convert(D)),T=Math.round(g.convert(x)),k=Math.round(T+f),N=Math.round(p.convert(M)),O=Math.round(p.convert(S)),L=Math.round(p.convert(v)),F=Math.round(p.convert(A)),B=T+y,_=new o.Group,G=new o.Rect,V=new o.Line,j=new o.Line,H=new o.Line,U=new o.Line,$=new o.Line;return G.x=T,G.y=w,G.width=f,G.height=N-w,G.strokeWidth=1,G.strokeOpacity=.75,G.crisp=!0,this.setLineProperties(V,T,k,L,L),this.setLineProperties(j,B,B,F,w),this.setLineProperties(H,B,B,O,N),this.setLineProperties(U,T,k,F,F),this.setLineProperties($,T,k,O,O),_.append([G,V,j,H,U,$]),_}),this.updateColors(i,s,n),this.root.append(this.boxPlotGroups)}updateColors(e,t,i){const{_Theme:s}=this.agChartsExports;this.boxPlotGroups.forEach((n,a)=>{for(const r of n.children()){const o=e[a%e.length];r.fill=i?o:s.resolveOperation({$mix:[o,{$ref:"backgroundColor"},.7]}),r.stroke=t[a%t.length]}})}setLineProperties(e,t,i,s,n){e.x1=t,e.x2=i,e.y1=s,e.y2=n,e.strokeOpacity=.75}},Q7={chartType:"boxPlot",miniChart:q7},J7=class extends Jc{constructor(e,t,i,s,n){super(e,t,"treemapTooltip");const{size:a,padding:r,agChartsExports:{_Scene:o}}=this,l=[[1,1],[3,2,1]],h=l.length%2===0?.3:.2,d=[r,a-r],u=l.length,p=u*(u+1)/2,g=h/(u-1),f=d[1]-d[0],y=f-h;let v=d[0];this.rects=l.reduce((S,M,D)=>{S!=null||(S=[]);const A=(u-D)/p,w=y*A,T=M.length,k=M.reduce((B,_)=>B+=_,0),N=h/(T-1||1),O=T>1?f-h:f;let L=d[0];const F=M.map(B=>{const _=new o.Rect,G=O*B/k;return _.x=v,_.y=L,_.width=w,_.height=G,_.strokeWidth=.75,_.crisp=!0,L+=G+N,_});return v+=w+g,S.push(...F),S},[]),this.updateColors(i,s,n);const x=new o.Group;x.setClipRect(new o.BBox(r,r,a-r,a-r)),x.append(this.rects),this.root.append(x)}updateColors(e,t,i){const{_Theme:s}=this.agChartsExports;this.rects.forEach((n,a)=>{n.fill=e[a%t.length],n.stroke=i?t[a%t.length]:s.resolveOperation({$ref:"backgroundColor"})})}},eq={chartType:"treemap",miniChart:J7},tq=class extends zd{constructor(e,t,i,s){super(e,t,"sunburstTooltip"),this.data=[[[],[]],[[],[]],[[],[]]],this.angleOffset=-Math.PI/2,this.innerRadiusRatio=0,this.showRadiusAxisLine=!1,this.showAngleAxisLines=!1;const{data:n,size:a,padding:r,angleOffset:o,innerRadiusRatio:l,agChartsExports:{_Scene:c}}=this,h=(a-r*2)/2,d=[o+0,o+2*Math.PI],u=Math.abs(d[1]-d[0]),p=[h*l,h],g=Math.abs(p[1]-p[0]);let f=0;const y=(D,A)=>{D.forEach(w=>{const T=A+1;f=Math.max(f,T),y(w,T)})};y(n,0);const v=g/f,x=this.size/2,S=d[0];this.series=[];const M=(D,A,w,T,k)=>{if(!Array.isArray(D))return;const O=A+1;let L=w;D.forEach((F,B,_)=>{let G=k;G||(G=new c.Group,this.series.push(G));const V=p[0]+A*v,j=p[0]+O*v,H=1/_.length,U=L,$=U+T*H,W=new c.Sector;W.centerX=x,W.centerY=x,W.innerRadius=V,W.outerRadius=j,W.startAngle=U,W.endAngle=$,W.stroke=void 0,W.strokeWidth=0,W.inset=.75,L=$,G.append(W),M(F,O,U,Math.abs($-U),G)})};M(n,0,S,u),this.root.append(this.series),this.updateColors(i,s)}updateColors(e,t){this.series.forEach((i,s)=>{for(const n of i.children())n.fill=e[s%e.length],n.stroke=t[s%t.length]})}},iq={chartType:"sunburst",miniChart:tq},sq=class extends Jc{constructor(e,t,i,s,n){var y,v;super(e,t,"heatmapTooltip");const{size:a,padding:r,agChartsExports:{_Scene:o}}=this,l=3,c=Array.from({length:l},(x,S)=>Array.from({length:l},(M,D)=>D)),h=c.map((x,S)=>S),d=new o.CategoryScale;d.domain=h,d.range=[r,a-r],d.paddingInner=.01,d.paddingOuter=.1;const u=new o.CategoryScale;u.domain=h,u.range=[r,a-r],u.paddingInner=.01,u.paddingOuter=.1;const p=(y=d.bandwidth)!=null?y:0,g=(v=u.bandwidth)!=null?v:0;this.rects=c.reduce((x,S,M)=>{x!=null||(x=[]);const D=S.map((A,w)=>{const T=new o.Rect;return T.x=d.convert(M),T.y=u.convert(w),T.width=p,T.height=g,T.strokeWidth=0,T.crisp=!0,T});return x.push(...D),x},[]),this.updateColors(i,s,n);const f=new o.Group;f.setClipRect(new o.BBox(r,r,a-r,a-r)),f.append(this.rects),this.root.append(f)}updateColors(e,t,i){const{_Theme:s,_Util:n}=this.agChartsExports,a=i?[e[0],e[1]]:s.resolveOperation({$palette:"divergingColors"}),r=i?t[0]:s.resolveOperation({$ref:"backgroundColor"}),o=n.interpolateColor(a[0],a[1]);this.rects.forEach((l,c)=>{l.fill=o(c*.2),l.stroke=r})}},nq={chartType:"heatmap",miniChart:sq},aq=class extends ln{constructor(e,t,i,s,n){super(e,t,"waterfallTooltip"),this.data=[4,3,-3,6,-3],this.bars=this.createWaterfall(this.root,this.data,this.size,this.padding,"vertical").bars,this.updateColors(i,s,n)}updateColors(e,t,i){const{data:s,agChartsExports:{_Theme:n}}=this,a={fill:i?e[0]:n.resolveOperation({$palette:"altUp.fill"}),stroke:i?t[0]:n.resolveOperation({$palette:"altUp.stroke"})},r={fill:i?e[1]:n.resolveOperation({$palette:"altDown.fill"}),stroke:i?t[1]:n.resolveOperation({$palette:"altDown.stroke"})};this.bars.forEach((o,l)=>{const c=s[l]>=0;o.fill=c?a.fill:r.fill,o.stroke=c?a.stroke:r.stroke})}createWaterfall(e,t,i,s,n){const a=2*s,{processedData:r,min:o,max:l}=sy(t.map(S=>[S])),c=r.reduce((S,M)=>S.concat(M),[]),{_Scene:h}=this.agChartsExports,d=new h.LinearScale;d.domain=[Math.min(o,0),l],d.range=[i-a,a];const u=new h.CategoryScale;u.domain=t.map((S,M)=>M),u.range=[s,i-s],u.paddingInner=.2,u.paddingOuter=.3;const p=u.bandwidth,g=new h.Path;g.stroke="#575757",g.strokeWidth=0;const f=Math.floor(g.strokeWidth)%2/2,y=g.path;y.clear();const v=n==="horizontal",x=c.map((S,M)=>{const D=M>0?c[M-1]:0,w=t[M]>0,T=Math.round(d.convert(S)),k=Math.round(d.convert(D)),N=(w?T:k)-f,O=(w?k:T)+f,L=Math.abs(O-N),F=u.convert(M),B=new h.Rect;B.x=v?N:F,B.y=v?F:N,B.width=v?L:p,B.height=v?p:L,B.strokeWidth=0,B.crisp=!0;const _=T+f,G=k+f;if(M>0){const H=v?G:B.x,U=v?B.y:G;y.lineTo(H,U)}const V=v?_:B.x,j=v?B.y:_;return y.moveTo(V,j),B});return e.append([g,...x]),{bars:x}}},rq={chartType:"waterfall",miniChart:aq},oq=class extends ln{constructor(e,t,i,s){super(e,t,"columnLineComboTooltip"),this.columnData=[3,4],this.lineData=[[5,4,6,5,4]];const{root:n,columnData:a,lineData:r,size:o,padding:l}=this;this.columns=eg({stacked:!1,root:n,data:a,size:o,padding:l,xScaleDomain:[0,1],yScaleDomain:[0,4],xScalePadding:.5,agChartsExports:t}),n.append(this.columns),this.lines=jS(t,n,r,o,l),this.updateColors(i,s)}updateColors(e,t){this.columns.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]}),this.lines.forEach((i,s)=>{i.stroke=e[s+2]})}},lq={chartType:"columnLineCombo",miniChart:oq},cq=class extends ln{constructor(e,t,i,s){super(e,t,"areaColumnComboTooltip"),this.columnData=[3,4.5],this.areaData=[[5,4,6,5,4]];const{root:n,columnData:a,areaData:r,size:o,padding:l,agChartsExports:{_Scene:c}}=this;this.columns=eg({stacked:!1,root:n,data:a,size:o,padding:l,xScaleDomain:[0,1],yScaleDomain:[0,6],xScalePadding:.5,agChartsExports:t});const h=new c.CategoryScale;h.range=[l,o-l],h.domain=[0,1,2,3,4],h.paddingInner=1,h.paddingOuter=0;const d=new c.LinearScale;d.range=[o-l,l],d.domain=[0,6];const u=[],p=d.convert(0),g=h.convert(0);r.forEach((v,x)=>{const S=u[x]||(u[x]=[]);v.forEach((D,A)=>{const w=D,T=A,k=h.convert(T),N=d.convert(w);S[A]={x:k,y:N}});const M=h.convert(v.length-1);u[x].push({x:M,y:p},{x:g,y:p})}),this.areas=u.map(v=>{const x=new c.Path;x.strokeWidth=0,x.fillOpacity=.8;const S=x.path;return v.forEach((M,D)=>S[D>0?"lineTo":"moveTo"](M.x,M.y)),x});const f=new c.Group;f.setClipRect(new c.BBox(l,l,o-l*2,o-l*2));const y=new c.Group;y.setClipRect(new c.BBox(l,l,o-l*2,o-l*2)),f.append(this.areas),y.append(this.columns),n.append(f),n.append(y),this.updateColors(i,s)}updateColors(e,t){this.areas.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]}),this.columns.forEach((i,s)=>{i.fill=e[s+1],i.stroke=t[s+1]})}},hq={chartType:"areaColumnCombo",miniChart:cq},dq=class extends Jc{constructor(e,t,i,s){super(e,t,"customComboTooltip"),this.columnData=[3,4],this.lineData=[[5,4,6,5,4]];const{root:n,columnData:a,lineData:r,size:o,padding:l,agChartsExports:{_Scene:c}}=this;this.columns=eg({stacked:!1,root:n,data:a,size:o,padding:l,xScaleDomain:[0,1],yScaleDomain:[0,4],xScalePadding:.5,agChartsExports:t}),n.append(this.columns),this.lines=jS(this.agChartsExports,n,r,o,l);const h="grey",d=3,u=new c.Line;u.x1=l,u.y1=l,u.x2=l,u.y2=o-l+d,u.stroke=h;const p=new c.Line;p.x1=l-d+1,p.y1=o-l,p.x2=o-l+1,p.y2=o-l,p.stroke=h;const g=new c.Path;this.buildPenIconPath(g),g.fill="whitesmoke",g.stroke="darkslategrey",g.strokeWidth=1,n.append([p,u,g]),this.updateColors(i,s)}updateColors(e,t){this.columns.forEach((i,s)=>{i.fill=e[s],i.stroke=t[s]}),this.lines.forEach((i,s)=>{i.stroke=e[s+2]})}buildPenIconPath(e){const{path:t}=e;t.moveTo(25.76,43.46),t.lineTo(31.27,48.53),t.moveTo(49.86,22),t.lineTo(49.86,22),t.cubicCurveTo(49.01994659053345,21.317514933510974,47.89593834348529,21.09645997825817,46.86,21.41),t.lineTo(46.86,21.41),t.cubicCurveTo(45.55460035985361,21.77260167850787,44.38777081121966,22.517979360321792,43.51,23.55),t.lineTo(25.51,43.8),t.lineTo(25.43,43.89),t.lineTo(23.01,51.89),t.lineTo(22.83,52.46),t.lineTo(31.02,48.86),t.lineTo(49.02,28.52),t.lineTo(49.02,28.52),t.cubicCurveTo(49.940716461596224,27.521914221246085,50.54302631059587,26.2720342455763,50.75,24.93),t.lineTo(50.75,24.93),t.cubicCurveTo(50.95363374988308,23.866379846512814,50.62080640232334,22.77066734274871,49.86,22),t.closePath(),t.moveTo(41.76,25.5),t.lineTo(47.34,30.5),t.moveTo(40.74,26.65),t.lineTo(46.25,31.71)}},uq={chartType:"customCombo",miniChart:dq},BP={columnGroup:{column:{range:!0,pivot:!0,enterprise:!1,icon:a7},stackedColumn:{range:!0,pivot:!0,enterprise:!1,icon:o7},normalizedColumn:{range:!0,pivot:!0,enterprise:!1,icon:h7}},barGroup:{bar:{range:!0,pivot:!0,enterprise:!1,icon:u7},stackedBar:{range:!0,pivot:!0,enterprise:!1,icon:g7},normalizedBar:{range:!0,pivot:!0,enterprise:!1,icon:y7}},pieGroup:{pie:{range:!0,pivot:!0,enterprise:!1,icon:b7},donut:{range:!0,pivot:!0,enterprise:!1,icon:kP},doughnut:{range:!0,pivot:!0,enterprise:!1,icon:kP}},lineGroup:{line:{range:!0,pivot:!0,enterprise:!1,icon:x7},stackedLine:{range:!0,pivot:!0,enterprise:!1,icon:S7},normalizedLine:{range:!0,pivot:!0,enterprise:!1,icon:w7}},scatterGroup:{scatter:{range:!0,pivot:!0,enterprise:!1,icon:I7},bubble:{range:!0,pivot:!0,enterprise:!1,icon:k7}},areaGroup:{area:{range:!0,pivot:!0,enterprise:!1,icon:L7},stackedArea:{range:!0,pivot:!0,enterprise:!1,icon:P7},normalizedArea:{range:!0,pivot:!0,enterprise:!1,icon:N7}},polarGroup:{radarLine:{range:!0,pivot:!1,enterprise:!0,icon:j7},radarArea:{range:!0,pivot:!1,enterprise:!0,icon:W7},nightingale:{range:!0,pivot:!1,enterprise:!0,icon:K7},radialColumn:{range:!0,pivot:!1,enterprise:!0,icon:_7},radialBar:{range:!0,pivot:!1,enterprise:!0,icon:z7}},statisticalGroup:{boxPlot:{range:!0,pivot:!1,enterprise:!0,icon:Q7},histogram:{range:!0,pivot:!1,enterprise:!1,icon:F7},rangeBar:{range:!0,pivot:!1,enterprise:!0,icon:Y7},rangeArea:{range:!0,pivot:!1,enterprise:!0,icon:Z7}},hierarchicalGroup:{treemap:{range:!0,pivot:!0,enterprise:!0,icon:eq},sunburst:{range:!0,pivot:!0,enterprise:!0,icon:iq}},specializedGroup:{heatmap:{range:!0,pivot:!1,enterprise:!0,icon:nq},waterfall:{range:!0,pivot:!1,enterprise:!0,icon:rq}},combinationGroup:{columnLineCombo:{range:!0,pivot:!0,enterprise:!1,icon:lq},areaColumnCombo:{range:!0,pivot:!0,enterprise:!1,icon:hq},customCombo:{range:!0,pivot:!0,enterprise:!1,icon:uq}},funnelGroup:{funnel:{range:!0,pivot:!1,enterprise:!0,icon:qZ},coneFunnel:{range:!0,pivot:!1,enterprise:!0,icon:e7},pyramid:{range:!0,pivot:!1,enterprise:!0,icon:s7}}},pq={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","donut"],lineGroup:["line","stackedLine","normalizedLine"],areaGroup:["area","stackedArea","normalizedArea"],scatterGroup:["scatter","bubble"],polarGroup:["radarLine","radarArea","nightingale","radialColumn","radialBar"],statisticalGroup:["boxPlot","histogram","rangeBar","rangeArea"],hierarchicalGroup:["treemap","sunburst"],specializedGroup:["heatmap","waterfall"],funnelGroup:["funnel","coneFunnel","pyramid"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},gq=class extends m.Component{constructor(e,t,i,s,n=pq){super('<div class="ag-chart-settings-mini-wrapper"></div>'),this.wrappers=new Map,this.chartController=e,this.fills=t,this.strokes=i,this.isCustomTheme=s,this.chartGroups=b({},n)}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){!this.chartController.customComboExists()&&this.chartGroups.combinationGroup&&(this.chartGroups.combinationGroup=this.chartGroups.combinationGroup.filter(a=>a!=="customCombo"));const e=this.getGui(),t=this.chartController.isEnterprise(),i=this.chartController.isPivotChart(),s=!i,n=Object.keys(this.chartGroups).map(a=>{var c;const r=a in BP?BP[a]:void 0;if(!r)return(0,m._warn)(148,{group:a}),null;const l=((c=this.chartGroups[a])!=null?c:[]).map(h=>{const d=h in r?r[h]:void 0;return d?!t&&d.enterprise?null:s&&d.range||i&&d.pivot?d:null:((0,m._warn)(149,{group:a,chartType:h}),null)}).filter(h=>h!=null);return l.length===0?null:{label:this.chartTranslation.translate(a),items:l}}).filter(a=>a!=null);for(const{label:a,items:r}of n){const o=this.createBean(new uo({title:a,suppressEnabledCheckbox:!0,enabled:!0,suppressOpenCloseIcons:!0,cssIdentifier:"charts-settings",direction:"horizontal",suppressKeyboardNavigation:!0}));for(const l of r){const{miniChart:c,chartType:h}=l.icon,d=document.createElement("div");d.classList.add("ag-chart-mini-thumbnail"),d.setAttribute("tabindex","0"),d.setAttribute("role","button");const u=h,p=()=>{this.chartController.setChartType(u),this.updateSelectedMiniChart()};this.addManagedListeners(d,{click:p,keydown:g=>{(g.key==m.KeyCode.ENTER||g.key===m.KeyCode.SPACE)&&(g.preventDefault(),p())}}),this.wrappers.set(u,d),this.createBean(new c(d,this.beans.agChartsExports,this.fills,this.strokes,this.isCustomTheme)),o.addItem(d)}e.appendChild(o.getGui())}this.updateSelectedMiniChart()}updateSelectedMiniChart(){const e=this.chartController.getChartType();this.wrappers.forEach((t,i)=>{const s=i===e;t.classList.toggle("ag-selected",s);const n=this.chartTranslation.translate(BS(i)),a=s?`${n}. ${this.chartTranslation.translate("ariaChartSelected")}`:n;(0,m._setAriaLabel)(t,a)})}destroy(){this.wrappers.clear(),super.destroy()}},fq=class extends m.Component{constructor(e){super(`<div class="ag-chart-settings-wrapper">
            <div data-ref="eMiniChartsContainer" class="ag-chart-settings-mini-charts-container ag-scrollable-container"></div>
            <div data-ref="eNavBar" class="ag-chart-settings-nav-bar">
                <div data-ref="ePrevBtn" class="ag-chart-settings-prev">
                    <button type="button" class="ag-button ag-chart-settings-prev-button"></button>
                </div>
                <div data-ref="eCardSelector" class="ag-chart-settings-card-selector"></div>
                <div data-ref="eNextBtn" class="ag-chart-settings-next">
                    <button type="button" class="ag-button ag-chart-settings-next-button"></button>
                </div>
            </div>
        </div>`),this.chartController=e,this.eMiniChartsContainer=m.RefPlaceholder,this.eNavBar=m.RefPlaceholder,this.eCardSelector=m.RefPlaceholder,this.ePrevBtn=m.RefPlaceholder,this.eNextBtn=m.RefPlaceholder,this.miniChartsContainers=[],this.cardItems=[],this.activePaletteIndex=0,this.palettes=[],this.themes=[]}postConstruct(){this.resetPalettes(),this.ePrevBtn.insertAdjacentElement("afterbegin",(0,m._createIconNoSpan)("chartsThemePrevious",this.beans)),this.eNextBtn.insertAdjacentElement("afterbegin",(0,m._createIconNoSpan)("chartsThemeNext",this.beans)),this.addManagedElementListeners(this.ePrevBtn,{click:()=>this.setActivePalette(this.getPrev(),"left")}),this.addManagedElementListeners(this.eNextBtn,{click:()=>this.setActivePalette(this.getNext(),"right")});const e=()=>this.resetPalettes(!0);this.addManagedListeners(this.chartController,{chartTypeChanged:e,chartApiUpdate:e}),this.scrollSelectedIntoView()}scrollSelectedIntoView(){setTimeout(()=>{const e=s=>!s.getGui().classList.contains("ag-hidden"),i=this.miniChartsContainers.find(e).getGui().querySelector(".ag-selected");if(i){const s=i.offsetParent;s&&this.eMiniChartsContainer.scrollTo(0,s.offsetTop)}},250)}resetPalettes(e){var n,a;const t=this.chartController.getPalettes(),i=(a=(n=this.gos.get("chartToolPanelsDef"))==null?void 0:n.settingsPanel)==null?void 0:a.chartGroupsDef;if((0,m._areEqual)(t,this.palettes)&&!e||this.isAnimating)return;this.palettes=t,this.themes=this.chartController.getThemeNames(),this.activePaletteIndex=this.themes.findIndex(r=>r===this.chartController.getChartThemeName()),this.cardItems=[],(0,m._clearElement)(this.eCardSelector),this.destroyMiniCharts();const{themes:s}=this;this.palettes.forEach((r,o)=>{const l=this.activePaletteIndex===o,{fills:c=[],strokes:h=[]}=r,d=s[o],u=!_S(d,this.beans.agChartsExports._Theme),p=this.createBean(new gq(this.chartController,c,h,u,i));this.miniChartsContainers.push(p),this.eMiniChartsContainer.appendChild(p.getGui()),this.addCardLink(o),l?p.updateSelectedMiniChart():p.setDisplayed(!1)}),(0,m._setDisplayed)(this.eNavBar,this.palettes.length>1),(0,m._radioCssClass)(this.cardItems[this.activePaletteIndex],"ag-selected","ag-not-selected")}addCardLink(e){const t=document.createElement("div");t.classList.add("ag-chart-settings-card-item"),this.addManagedElementListeners(t,{click:()=>{this.setActivePalette(e,e<this.activePaletteIndex?"left":"right")}}),this.eCardSelector.appendChild(t),this.cardItems.push(t)}getPrev(){let e=this.activePaletteIndex-1;return e<0&&(e=this.palettes.length-1),e}getNext(){let e=this.activePaletteIndex+1;return e>=this.palettes.length&&(e=0),e}setActivePalette(e,t){if(this.isAnimating||this.activePaletteIndex===e)return;(0,m._radioCssClass)(this.cardItems[e],"ag-selected","ag-not-selected");const i=this.miniChartsContainers[this.activePaletteIndex],s=i.getGui(),n=this.miniChartsContainers[e],a=n.getGui();i.updateSelectedMiniChart(),n.updateSelectedMiniChart();const r=t==="left"?-1:1,o=a.style.left=`${(0,m._getAbsoluteWidth)(this.getGui())*r}px`;this.activePaletteIndex=e,this.isAnimating=!0;const l="ag-animating";n.setDisplayed(!0),i.addCss(l),n.addCss(l),this.chartController.setChartThemeName(this.themes[e]),window.setTimeout(()=>{s.style.left=`${-parseFloat(o)}px`,a.style.left="0px"},0),window.setTimeout(()=>{this.isAnimating=!1,i.removeCss(l),n.removeCss(l),i.setDisplayed(!1)},300)}destroyMiniCharts(){(0,m._clearElement)(this.eMiniChartsContainer),this.miniChartsContainers=this.destroyBeans(this.miniChartsContainers)}destroy(){this.destroyMiniCharts(),super.destroy()}},mq="data",yq="format",vq=class extends m.Component{constructor(e,t){super(),this.panels=e,this.chartMenuContext=t,this.tabs=[]}wireBeans(e){this.chartTranslation=e.chartTranslation}postConstruct(){this.panels.forEach(e=>{const t=e.replace("chart","").toLowerCase(),i=this.createPanel(t),s=this.createTab(e,t,i);this.tabs.push(s),this.addDestroyFunc(()=>this.destroyBean(i))}),this.tabbedLayout=new Zk({items:this.tabs,cssClass:"ag-chart-tabbed-menu",keepScrollPosition:!0,suppressFocusBodyOnOpen:!0,suppressTrapFocus:!0,enableCloseButton:!0,closeButtonAriaLabel:this.chartTranslation.translate("ariaChartMenuClose"),onCloseClicked:()=>{var e;(e=this.eventSource)==null||e.focus({preventScroll:!0}),this.dispatchLocalEvent({type:"closed"})}}),this.createBean(this.tabbedLayout)}createTab(e,t,i){const s=(0,m._createElement)({tag:"div",cls:`ag-chart-tab ag-chart-${t}`});this.createBean(i),s.appendChild(i.getGui());const n=this.chartTranslation.translate(t);return{title:(0,m._createElement)({tag:"div",children:n}),titleLabel:n,bodyPromise:m.AgPromise.resolve(s),getScrollableContainer:()=>s.querySelector(".ag-scrollable-container")||s,name:e}}showTab(e){const t=this.tabs[e];this.tabbedLayout.showItem(t)}getGui(){return this.tabbedLayout&&this.tabbedLayout.getGui()}showMenu(e,t){var i;this.eventSource=e,t||(i=this.tabbedLayout)==null||i.focusHeader(!0)}destroy(){this.parentComponent&&this.parentComponent.isAlive()&&this.destroyBean(this.parentComponent),super.destroy()}createPanel(e){switch(e){case mq:return new mZ(this.chartMenuContext);case yq:return new VZ(this.chartMenuContext);default:return new fq(this.chartMenuContext.chartController)}}},bq=class extends m.Component{constructor(e,t,i){super('<div class="ag-chart-menu-wrapper"></div>'),this.eChartContainer=e,this.eMenuPanelContainer=t,this.chartMenuContext=i,this.buttons={chartLink:{iconName:"linked",callback:()=>this.chartMenuSvc.toggleLinked(this.chartMenuContext)},chartUnlink:{iconName:"unlinked",callback:()=>this.chartMenuSvc.toggleLinked(this.chartMenuContext)},chartDownload:{iconName:"chartsDownload",callback:()=>this.chartMenuSvc.downloadChart(this.chartMenuContext)},chartMenu:{iconName:"chartsMenu",callback:s=>this.showMenuList(s)}},this.panels=[],this.menuVisible=!1,this.chartController=i.chartController}wireBeans(e){this.chartMenuSvc=e.chartMenuSvc,this.chartMenuListFactory=e.chartMenuListFactory,this.environment=e.environment}postConstruct(){this.chartToolbar=this.createManagedBean(new aZ),this.getGui().appendChild(this.chartToolbar.getGui()),this.refreshToolbarAndPanels(),this.addManagedEventListeners({chartCreated:e=>{var t;e.chartId===this.chartController.getChartId()&&((t=this.gos.get("chartToolPanelsDef"))!=null&&t.defaultToolPanel)&&this.showMenu({panel:this.defaultPanel,suppressFocus:!0})}}),this.addManagedListeners(this.chartController,{chartLinkedChanged:this.refreshToolbarAndPanels.bind(this)}),this.refreshMenuClasses(),this.addManagedListeners(this.chartController,{chartApiUpdate:this.refreshToolbarAndPanels.bind(this)})}isVisible(){return this.menuVisible}getExtraPaddingDirections(){return["chartMenu","chartLink","chartUnlink","chartDownload"].some(e=>this.chartToolbarOptions.includes(e))?["top"]:[]}refreshToolbarAndPanels(){this.initToolbarOptionsAndPanels(),this.updateToolbar()}initToolbarOptionsAndPanels(){const{panels:e,defaultPanel:t}=this.chartMenuSvc.getChartToolPanels(this.chartController);this.panels=e,this.defaultPanel=t,this.chartToolbarOptions=this.chartMenuSvc.getChartToolbarOptions()}updateToolbar(){const e=this.chartToolbarOptions.map(t=>{const{iconName:i,callback:s}=this.buttons[t];return{buttonName:t,iconName:i,callback:s}});this.chartToolbar.updateParams({buttons:e})}createMenuPanel(e){const t=this.menuPanel=this.createBean(new mk({height:"100%",closable:!0,hideTitleBar:!0,cssIdentifier:"chart-menu"}));return t.setParentComponent(this),this.eMenuPanelContainer.appendChild(t.getGui()),this.tabbedMenu=this.createBean(new vq(this.panels,this.chartMenuContext)),this.addManagedListeners(this.tabbedMenu,{closed:()=>{this.hideMenu()}}),this.addManagedListeners(t,{destroyed:()=>this.destroyBean(this.tabbedMenu)}),new m.AgPromise(i=>{window.setTimeout(()=>{t.setBodyComponent(this.tabbedMenu),this.tabbedMenu.showTab(e),i(t)},100)})}showContainer(e,t){this.menuPanel&&(this.menuVisible=!0,this.refreshMenuClasses(),this.tabbedMenu.showMenu(e,t))}showMenu(e){const{panel:t,eventSource:i,suppressFocus:s}=e!=null?e:{};if(this.menuPanel&&!t)this.showContainer(i,s);else{const n=t||this.defaultPanel;let a=this.panels.indexOf(n);a<0&&((0,m._warn)(143,{panel:t}),a=this.panels.indexOf(this.defaultPanel)),this.menuPanel?(this.tabbedMenu.showTab(a),this.showContainer(i,s)):this.createMenuPanel(a).then(()=>this.showContainer(i,s))}}hideMenu(){this.menuVisible=!1,this.refreshMenuClasses()}refreshMenuClasses(){this.eChartContainer.classList.toggle("ag-chart-menu-visible",this.menuVisible),this.eChartContainer.classList.toggle("ag-chart-menu-hidden",!this.menuVisible)}showMenuList(e){this.chartMenuListFactory.showMenuList({eventSource:e,showMenu:()=>this.showMenu({eventSource:e}),chartMenuContext:this.chartMenuContext})}destroy(){super.destroy(),this.menuPanel&&this.menuPanel.isAlive()&&this.destroyBean(this.menuPanel),this.tabbedMenu&&this.tabbedMenu.isAlive()&&this.destroyBean(this.tabbedMenu)}},_P=["number","category","time","grouped-category"],xq=["angle-category","angle-number","radius-category","radius-number"],Cq=[..._P,...xq],Sq=class extends m.BeanStub{constructor(e){super(),this.chartController=e}getChartThemeOverridesProxy(){return{getValue:e=>this.getChartOption(e),setValue:(e,t)=>this.setChartThemeOverrides([{expression:e,value:t}]),setValues:e=>this.setChartThemeOverrides(e)}}getAxisThemeOverridesProxy(){return{getValue:e=>this.getAxisProperty(e),setValue:(e,t)=>this.setAxisThemeOverrides([{expression:e,value:t}]),setValues:e=>this.setAxisThemeOverrides(e)}}getCartesianAxisOptionsProxy(e){return{getValue:t=>this.getCartesianAxisProperty(e,t),setValue:(t,i)=>this.setCartesianAxisOptions(e,[{expression:t,value:i}]),setValues:t=>this.setCartesianAxisOptions(e,t)}}getCartesianAxisThemeOverridesProxy(e){return{getValue:t=>this.getCartesianAxisProperty(e,t),setValue:(t,i)=>this.setCartesianAxisThemeOverrides(e,[{expression:t,value:i}]),setValues:t=>this.setCartesianAxisThemeOverrides(e,t)}}getCartesianAxisAppliedThemeOverridesProxy(e){return{getValue:t=>this.getCartesianAxisThemeOverride(e,t==="*"?null:t),setValue:(t,i)=>this.setCartesianAxisThemeOverrides(e,[{expression:t==="*"?null:t,value:i}]),setValues:t=>this.setCartesianAxisThemeOverrides(e,t)}}getSeriesOptionsProxy(e){return{getValue:(t,i)=>this.getSeriesOption(e(),t,i),setValue:(t,i)=>this.setSeriesOptions(e(),[{expression:t,value:i}]),setValues:t=>this.setSeriesOptions(e(),t)}}getPersistedChartThemeOverrides(e,t,i,s){const n=this.getRetainedChartThemeOverrideKeys(i,s),a=this.getRetainedChartAxisThemeOverrideKeys(null,i,s),r=this.createChartOptions();for(const o of n){const l=this.retrieveChartOptionsThemeOverride(e,i,o);l!==void 0&&this.assignChartOptionsThemeOverride(r,s,o,l)}return t&&this.assignPersistedAxisOverrides({existingAxes:t,retainedChartAxisThemeOverrideKeys:a,existingChartOptions:e,targetChartOptions:r,existingChartType:i,targetChartType:s}),r.theme.overrides}assignPersistedAxisOverrides(e){const{existingAxes:t,retainedChartAxisThemeOverrideKeys:i,existingChartOptions:s,targetChartOptions:n,existingChartType:a,targetChartType:r}=e;for(const{expression:o,targetAxisTypes:l}of i)for(const c of t.map(h=>h.type)){const h=this.retrieveChartOptionsThemeOverride(s,a,["axes",c,o].join("."));if(h!==void 0)for(const d of l)this.assignChartOptionsThemeOverride(n,r,["axes",d,o].join("."),h)}}getRetainedChartThemeOverrideKeys(e,t){const i=["animation"],s=["zoom","navigator"],n=((a,r)=>{const o=new Array;return Dl(Ot(a))&&Dl(Ot(r))&&o.push(...s),o})(e,t);return[...i,...n]}getRetainedChartAxisThemeOverrideKeys(e,t,i){return Dl(Ot(t))&&Dl(Ot(i))?this.getRetainedCartesianAxisThemeOverrideKeys(e).map(n=>({expression:n,targetAxisTypes:_P})):[]}getRetainedCartesianAxisThemeOverrideKeys(e){const t=e==="xAxis"?["",".top",".bottom"]:e==="yAxis"?["",".left",".right"]:["",".left",".right",".top",".bottom"],i=["crosshair"],s=new Array;for(const n of i)for(const a of t)s.push(`${n}${a}`);return s}getChartOption(e){return Zc(this.getChart(),e,void 0)}setChartThemeOverrides(e){const t=this.getChartType(),i=this.createChartOptions();for(const{expression:s,value:n}of e)this.assignChartOptionsThemeOverride(i,t,s,n);this.applyChartOptions(i)}applyChartOptions(e,t){if(Object.keys(e).length===0)return;this.updateChart(e),!(t!=null&&t.silent)&&this.raiseChartOptionsChangedEvent()}awaitChartOptionUpdate(e){this.chartController.getChartProxy().getChart().waitForUpdate().then(()=>e()).catch(i=>(0,m._error)(108,{e:i}))}getAxisProperty(e){var t;return Zc((t=this.getChart().axes)==null?void 0:t[0],e,void 0)}setAxisThemeOverrides(e){var n;const t=this.getChart(),i=this.getChartType(),s=this.createChartOptions();for(const{expression:a,value:r}of e){const o=(n=t.axes)==null?void 0:n.filter(l=>{const c=a.split(".");let h=l;for(const d of c){if(!(d in h))return!1;h=h[d]}return!0});if(o)for(const l of o)this.isValidAxisType(l)&&this.assignChartAxisThemeOverride(s,i,l.type,null,a,r)}this.applyChartOptions(s)}getCartesianAxisProperty(e,t){const i=this.getChartAxes(),s=this.getCartesianAxis(i,e);return Zc(s,t,void 0)}getCartesianAxisThemeOverride(e,t){const i=this.getChartAxes(),s=this.getCartesianAxis(i,e);if(!s||!this.isValidAxisType(s))return;const n=this.getChartType(),a=this.getChart().getOptions();return this.retrieveChartAxisThemeOverride(a,n,s.type,e==="yAxis"?["left","right"]:["bottom","top"],t)}setCartesianAxisThemeOverrides(e,t){const i=this.getChartAxes(),s=this.getCartesianAxis(i,e);if(!s||!this.isValidAxisType(s))return;const n=this.getChartType(),a=this.createChartOptions();for(const{expression:r,value:o}of t)this.assignChartAxisThemeOverride(a,n,s.type,e==="yAxis"?["left","right"]:["bottom","top"],r,o);this.applyChartOptions(a)}setCartesianAxisOptions(e,t){this.updateCartesianAxisOptions(e,(i,s,n)=>{const a=s.indexOf(n);for(const{expression:r,value:o}of t)this.assignChartOption(i,`axes.${a}.${r}`,o)})}updateCartesianAxisOptions(e,t){const i=this.getChart().getOptions(),s="axes"in i?i.axes:void 0;if(!i||!s)return;const n=this.getChartAxes(),a=this.getCartesianAxis(n,e);if(!a)return;const r=this.createChartOptions();r.axes=s,t(r,n,a,i),this.applyChartOptions(r)}setCartesianCategoryAxisType(e,t){this.updateCartesianAxisOptions(e,(i,s,n,a)=>{const r=this.getChartType();this.assignPersistedAxisOverrides({existingAxes:[n],retainedChartAxisThemeOverrideKeys:this.getRetainedChartAxisThemeOverrideKeys(e,r,r),existingChartOptions:a,targetChartOptions:i,existingChartType:r,targetChartType:r}),this.assignChartOption(i,"axes.0.type",t),this.chartController.setCategoryAxisType(t)})}getCartesianAxis(e,t){if(!(e.length<2))switch(t){case"xAxis":return e[0].direction==="x"?e[0]:e[1];case"yAxis":return e[1].direction==="y"?e[1]:e[0]}}getSeriesOption(e,t,i){const s=this.getChart().series.find(n=>Mq(e,n));return Zc(i?s:s==null?void 0:s.properties.toJson(),t,void 0)}setSeriesOptions(e,t){const i=this.createChartOptions();for(const{expression:s,value:n}of t)this.assignChartOptionsSeriesThemeOverride(i,e,`series.${s}`,n);this.applyChartOptions(i)}getPairedMode(){return this.chartController.getChartProxy().isPaired()}setPairedMode(e){this.chartController.getChartProxy().setPaired(e)}getChartAxes(){var t;return(t=this.getChart().axes)!=null?t:[]}retrieveChartAxisThemeOverride(e,t,i,s,n){if(s)for(const a of s){const r=this.retrieveChartOptionsThemeOverride(e,t,["axes",i,a,...n?[n]:[]].join("."));if(r!==void 0)return r}else return this.retrieveChartOptionsThemeOverride(e,t,["axes",i,...n?[n]:[]].join("."))}assignChartAxisThemeOverride(e,t,i,s,n,a){if(s)for(const r of s)this.assignChartOptionsThemeOverride(e,t,["axes",i,r,...n?[n]:[]].join("."),a);else this.assignChartOptionsThemeOverride(e,t,["axes",i,...n?[n]:[]].join("."),a)}isValidAxisType(e){return Cq.includes(e.type)}getChartType(){return this.chartController.getChartType()}getChart(){return this.chartController.getChartProxy().getChart()}updateChart(e){const t=this.chartController.getChartProxy().getChartRef();t.skipAnimations(),t.updateDelta(e)}createChartOptions(){return{theme:{overrides:{}}}}retrieveChartOptionsThemeOverride(e,t,i){const s=this.getChartThemeOverridesSeriesTypeKeys(t);for(const n of s){const a=this.retrieveChartOptionsSeriesThemeOverride(e,n,i);if(a!==void 0)return a}}assignChartOptionsThemeOverride(e,t,i,s){const n=this.getChartThemeOverridesSeriesTypeKeys(t);for(const a of n)this.assignChartOptionsSeriesThemeOverride(e,a,i,s)}retrieveChartOptionsSeriesThemeOverride(e,t,i){return this.retrieveChartOption(e,["theme","overrides",t,...i?[i]:[]].join("."))}assignChartOptionsSeriesThemeOverride(e,t,i,s){this.assignChartOption(e,["theme","overrides",t,...i?[i]:[]].join("."),s)}getChartThemeOverridesSeriesTypeKeys(e){const t=this.chartController.getChartSeriesTypes(e);return this.chartController.isComboChart()&&t.push("common"),t}retrieveChartOption(e,t){return Zc(e,t,void 0)}assignChartOption(e,t,i){L8(e,t,i)}raiseChartOptionsChangedEvent(){const e=this.chartController.getChartModel();this.eventSvc.dispatchEvent({type:"chartOptionsChanged",chartId:e.chartId,chartType:e.chartType,chartThemeName:this.chartController.getChartThemeName(),chartOptions:e.chartOptions})}};function Mq(e,t){return N8(e)&&t.type===e}var Dq=class extends m.Component{constructor(e){super(`
            <div style="height: 100%; width: 100%;">
                <div class="ag-chart" data-ref="eWrapper">
                    <div data-ref="eChartContainer" class="ag-chart-components-wrapper ag-chart-menu-hidden">
                        <div data-ref="eChart" class="ag-chart-canvas-wrapper"></div>
                        <div data-ref="eEmpty" class="ag-chart-empty-text ag-unselectable"></div>
                    </div>
                    <div data-ref="eMenuContainer" class="ag-chart-docked-container"></div>
                </div>
            </div>
            `),this.eChart=m.RefPlaceholder,this.eWrapper=m.RefPlaceholder,this.eChartContainer=m.RefPlaceholder,this.eMenuContainer=m.RefPlaceholder,this.eEmpty=m.RefPlaceholder,this.params=e}wireBeans(e){this.crossFilterService=e.chartCrossFilterSvc,this.chartTranslation=e.chartTranslation,this.chartMenuSvc=e.chartMenuSvc,this.focusSvc=e.focusSvc,this.popupSvc=e.popupSvc,this.enterpriseChartProxyFactory=e.enterpriseChartProxyFactory,this.environment=e.environment}postConstruct(){const e=E(b({},this.params),{chartType:Zp(this.params.chartType),chartThemeName:this.getThemeName()}),t=this.gos.get("enableRtl");this.eWrapper.classList.add(t?"ag-rtl":"ag-ltr");const i=this.createBean(new uX(e));this.chartController=this.createManagedBean(new ZX(i)),this.chartOptionsService=this.createManagedBean(new Sq(this.chartController)),this.validateCustomThemes(),this.createChart(),this.params.insideDialog?this.addDialog():(this.addManagedEventListeners({gridStylesChanged:this.updateTheme.bind(this)}),this.updateTheme()),this.addMenu(),this.addManagedElementListeners(this.getGui(),{focusin:this.setActiveChartCellRange.bind(this)}),this.addManagedListeners(this.chartController,{chartModelUpdate:this.update.bind(this)}),this.addManagedPropertyListeners(["chartThemeOverrides","chartThemes"],this.reactivePropertyUpdate.bind(this)),this.update(),this.raiseChartCreatedEvent()}updateTheme(){this.environment.applyThemeClasses(this.getGui())}createChart(){var n;let e;this.chartProxy&&(e=this.chartProxy.destroy({keepChartInstance:!0}));const t=(a,r)=>{const o=this.params.crossFilteringContext;o.lastSelectedChartId=r?"":this.chartController.getChartId(),r&&this.params.crossFilteringResetCallback(),this.crossFilterService.filter(a,r)},i=this.chartController.getChartType(),s={agChartsExports:this.beans.agChartsExports,chartType:i,chartInstance:e,getChartThemeName:this.getChartThemeName.bind(this),getChartThemes:this.getChartThemes.bind(this),customChartThemes:this.gos.get("customChartThemes"),styleNonce:this.gos.get("styleNonce"),getGridOptionsChartThemeOverrides:()=>this.getGridOptionsChartThemeOverrides(),getExtraPaddingDirections:()=>{var a,r;return(r=(a=this.chartMenu)==null?void 0:a.getExtraPaddingDirections())!=null?r:[]},apiChartThemeOverrides:this.params.chartThemeOverrides,crossFiltering:(n=this.params.crossFiltering)!=null?n:!1,crossFilterCallback:t,parentElement:this.eChart,grouping:this.chartController.isGrouping(),chartThemeToRestore:this.params.chartThemeName,chartOptionsToRestore:this.params.chartOptionsToRestore,chartPaletteToRestore:this.params.chartPaletteToRestore,seriesChartTypes:this.chartController.getSeriesChartTypes(),suppressFieldDotNotation:this.gos.get("suppressFieldDotNotation"),translate:a=>this.chartTranslation.translate(a)};if(this.params.chartOptionsToRestore=void 0,this.chartType=i,this.chartProxy=this.createChartProxy(s),!this.chartProxy){(0,m._warn)(138,{chartType:s.chartType});return}this.chartController.setChartProxy(this.chartProxy),this.createMenuContext()}createMenuContext(){if(this.chartMenuContext)return;const e=this.createManagedBean(new Qc(this.chartOptionsService.getChartThemeOverridesProxy())),t=this.createManagedBean(new Qc(this.chartOptionsService.getAxisThemeOverridesProxy()));this.chartMenuContext={chartController:this.chartController,chartOptionsService:this.chartOptionsService,chartMenuParamsFactory:e,chartAxisMenuParamsFactory:t}}getChartThemeName(){return this.chartController.getChartThemeName()}getChartThemes(){return this.chartController.getThemeNames()}getGridOptionsChartThemeOverrides(){return this.gos.get("chartThemeOverrides")}createChartProxy(e){var s;const{chartType:t}=e;switch(t){case"column":case"bar":case"groupedColumn":case"stackedColumn":case"normalizedColumn":case"groupedBar":case"stackedBar":case"normalizedBar":return new JX(e);case"pie":case"donut":case"doughnut":return new nZ(e);case"area":case"stackedArea":case"normalizedArea":return new qX(e);case"line":case"stackedLine":case"normalizedLine":return new eZ(e);case"scatter":case"bubble":return new tZ(e);case"columnLineCombo":case"areaColumnCombo":case"customCombo":return new iZ(e)}const i=(s=this.enterpriseChartProxyFactory)==null?void 0:s.createChartProxy(e);if(!i)throw(0,m._errMsg)(251,{chartType:t});return i}addDialog(){const e=this.chartTranslation.translate(this.params.pivotChart?"pivotChartTitle":"rangeChartTitle"),{width:t,height:i}=this.getBestDialogSize(),s=this.params.focusDialogOnOpen?()=>setTimeout(()=>(0,m._focusInto)(this.getGui())):void 0;this.chartDialog=new jp({resizable:!0,movable:!0,maximizable:!0,title:e,width:t,height:i,component:this,centered:!0,closable:!0,afterGuiAttached:s,postProcessPopupParams:{type:"chart"}}),this.createBean(this.chartDialog),this.chartDialog.addEventListener("destroyed",()=>{this.destroy(),this.chartMenuSvc.hideAdvancedSettings();const n=this.focusSvc.getFocusedCell();setTimeout(()=>{this.focusSvc.isAlive()&&(n?this.focusSvc.setFocusedCell(E(b({},n),{forceBrowserFocus:!0})):(0,m._focusGridInnerElement)(this.beans))})})}getBestDialogSize(){const e=this.popupSvc.getPopupParent(),t=(0,m._getAbsoluteWidth)(e)*.75,i=(0,m._getAbsoluteHeight)(e)*.75,s=.553,n=this.chartProxy.getChart();let a=this.params.insideDialog?850:n.width,r=this.params.insideDialog?470:n.height;return(a>t||r>i)&&(a=Math.min(a,t),r=Math.round(a*s),r>i&&(r=i,a=Math.min(a,Math.round(r/s)))),{width:a,height:r}}addMenu(){this.params.crossFiltering||(this.chartMenu=this.createBean(new bq(this.eChartContainer,this.eMenuContainer,this.chartMenuContext)),this.eChartContainer.appendChild(this.chartMenu.getGui()))}update(e){if(e!=null&&e.chartId&&!this.chartController.update(e))return;const t=this.chartTypeChanged(e),i=t||this.chartEmpty?(n=>{const a=this.chartType,r=n,o=this.chartProxy.getChart(),l=o==null?void 0:o.getOptions(),c=o==null?void 0:o.axes;return this.chartOptionsService.getPersistedChartThemeOverrides(l,c,a,r!=null?r:a)})(t):void 0;t&&this.createChart(),i&&(e!=null&&e.chartThemeOverrides)&&(0,m._mergeDeep)(i,e.chartThemeOverrides);const s=i!=null?i:e==null?void 0:e.chartThemeOverrides;this.updateChart(s),e!=null&&e.chartId&&this.chartProxy.getChart().waitForUpdate().then(()=>{this.chartController.raiseChartApiUpdateEvent()})}updateChart(e){const{chartProxy:t}=this,i=this.chartController.getSelectedValueColState(),s=this.chartController.getChartData(),n=this.handleEmptyChart(s,i.length);if(this.chartEmpty=n,n){e&&this.chartController.updateThemeOverrides(e);return}const a=this.chartController.getChartUpdateParams(e);t.update(a),this.chartProxy.getChart().waitForUpdate().then(()=>{this.chartController.raiseChartUpdatedEvent()})}chartTypeChanged(e){const[t,i]=[this.chartController.getChartType(),e==null?void 0:e.chartType],s=i?Zp(i):void 0;return this.chartType!==t?s!=null?s:t:s&&t!==s?s:null}getChartModel(){return this.chartController.getChartModel()}getChartImageDataURL(e){return this.chartProxy.getChartImageDataURL(e)}handleEmptyChart(e,t){const i=this.chartController.isPivotChart()&&!this.chartController.isPivotMode(),s=this.chartController.getChartType();let n=1;this.chartController.isActiveXYChart()?n=s==="bubble"?3:2:qc(Ot(s))&&(n=0);const a=t<n||e.length===0;if(this.eChart){const r=i||a;(0,m._setDisplayed)(this.eChart,!r),(0,m._setDisplayed)(this.eEmpty,r)}return i?(this.eEmpty.textContent=this.chartTranslation.translate("pivotChartRequiresPivotMode"),!0):a?(this.eEmpty.textContent=this.chartTranslation.translate("noDataToChart"),!0):!1}downloadChart(e,t,i){this.chartProxy.downloadChart(e,t,i)}openChartToolPanel(e){const t=e&&Jm[e];this.chartMenu.showMenu({panel:t})}closeChartToolPanel(){this.chartMenu.hideMenu()}getChartId(){return this.chartController.getChartId()}getUnderlyingChart(){return this.chartProxy.getChartRef()}crossFilteringReset(){this.chartProxy.crossFilteringReset()}setActiveChartCellRange(e){this.getGui().contains(e.relatedTarget)||this.chartController.setChartRange(!0)}getThemeName(){const e=this.gos.get("chartThemes")||gP;if(e.length===0)throw new Error((0,m._errMsg)(254));const{chartThemeName:t}=this.params;return e.includes(t)?t:e[0]}getAllKeysInObjects(e){const t={};return e.filter(i=>i!=null).forEach(i=>{Object.keys(i).forEach(s=>t[s]=null)}),Object.keys(t)}validateCustomThemes(){const e=this.getChartThemes(),t=this.gos.get("customChartThemes");t&&this.getAllKeysInObjects([t]).forEach(i=>{e.includes(i)||(0,m._warn)(139,{customThemeName:i})})}reactivePropertyUpdate(){this.chartController.setChartThemeName(this.getThemeName(),!0);const e=this.getChartId(),t=this.chartController.isCrossFilterChart()?"crossFilter":this.getChartModel().modelType,i=this.gos.get("chartThemeOverrides")||{};this.update({type:`${t}ChartUpdate`,chartId:e,chartThemeOverrides:i})}raiseChartCreatedEvent(){this.chartProxy.getChart().waitForUpdate().then(()=>{this.eventSvc.dispatchEvent({type:"chartCreated",chartId:this.chartController.getChartId()})})}raiseChartDestroyedEvent(){this.eventSvc.dispatchEvent({type:"chartDestroyed",chartId:this.chartController.getChartId()})}destroy(){var t;super.destroy(),this.chartProxy&&this.chartProxy.destroy(),this.destroyBean(this.chartMenu),this.chartDialog&&this.chartDialog.isAlive()&&this.destroyBean(this.chartDialog),(t=this.onDestroyColorSchemeChangeListener)==null||t.call(this);const e=this.getGui();(0,m._clearElement)(e),(0,m._removeFromParent)(e),this.raiseChartDestroyedEvent()}},tg=!1;function wq(e){const t=e.version;return e.version==null&&(e.version=zq(e)),e=Vs("23.0.0",e,Aq),e=Vs("24.0.0",e,Iq),e=Vs("25.1.0",e,Tq),e=Vs("26.0.0",e,kq),e=Vs("26.1.0",e,Lq),e=Vs("26.2.0",e,Pq),e=Vs("28.0.0",e,Eq),e=Vs("28.2.0",e,Rq),e=Vs("29.0.0",e,Nq),e=Vs("29.1.0",e,GP),e=Vs("29.2.0",e,zP),e=Vs("30.0.0",e,Oq),e=Vs("31.0.0",e,Fq),e=Vs("32.0.0",e,Bq),e=Vs("33.0.0",e,_q),e=Gq(e),e=Vs(Re,e,i=>i),tg&&t!==e.version&&console.log("AG Grid: ChartModel migration complete",{model:e}),e}function Aq(e){return e=Ss("chartOptions.legend.item.marker.type","shape",e),e=Ss("chartOptions.seriesDefaults.marker.type","shape",e),e=Ss("chartOptions.legend.padding","spacing",e),e}function Iq(e){var p;e=kt("chartOptions.seriesDefaults.marker.minSize",e);const h=e,{chartType:t,chartPalette:i,chartOptions:d}=h,u=d,{xAxis:s,yAxis:n}=u,a=We(u,["xAxis","yAxis"]),r=We(h,["chartType","chartPalette","chartOptions"]),o=V8(t),l=o==null?void 0:o.map((g,f)=>b({type:g},f===0?s:n));return b({chartType:t,chartThemeName:(p={borneo:"ag-default",material:"ag-material",bright:"ag-vivid"}[i])!=null?p:"ag-default",chartOptions:E(b({},a),{axes:l,xAxis:s,yAxis:n})},r)}function Tq(e){return e=Ss("chartOptions.seriesDefaults.label.minRequiredAngle","minAngle",e),e}function kq(e){return e=yo("chartOptions.seriesDefaults.highlightStyle",e,n=>{var a=n,{dimOpacity:i}=a,s=We(a,["dimOpacity"]);return b(b({},s),i!=null?{series:{dimOpacity:i}}:{})}),e=kt("chart",e),e=kt("chartOptions.seriesDefaults.tooltipClass",e),e=kt("chartOptions.seriesDefaults.tooltipTracking",e),e=jP("chartOptions.axes[].label.rotation",0,e),e=jP("chartOptions.axes[].label.rotation",335,e),e}function Lq(e){const t=a=>{var r=a,{item:i,series:s}=r,n=We(r,["item","series"]);return b({item:b(b({},n),i)},s?{series:s}:{})};return e=yo("chartOptions.seriesDefaults.highlightStyle",e,t),e=yo("chartOptions.series[].highlightStyle",e,t),e}function Pq(e){e=ny("chartOptions.seriesDefaults.fill.opacity","chartOptions.seriesDefaults.fillOpacity",e),e=ny("chartOptions.seriesDefaults.stroke.opacity","chartOptions.seriesDefaults.strokeOpacity",e),e=ny("chartOptions.seriesDefaults.stroke.width","chartOptions.seriesDefaults.strokeWidth",e),e=kt("chartOptions.seriesDefaults.fill",e),e=kt("chartOptions.seriesDefaults.stroke",e),e=kt("chartOptions.seriesDefaults.callout.colors",e),e=kt("chartOptions.xAxis",e),e=kt("chartOptions.yAxis",e);const u=e,{chartType:t,chartOptions:p}=u,g=p,{axes:i,series:s,seriesDefaults:n}=g,a=We(g,["axes","series","seriesDefaults"]),r=We(u,["chartType","chartOptions"]),o=Zp(t),l=Ot(o),c=[l],h={};if(!JL(l)){const f={top:{},bottom:{},left:{},right:{}},y=i.map(S=>{var M=S,{type:v}=M,x=We(M,["type"]);return{[v]:b(b({},f),x)}}).reduce(UP,{});tP.filter(v=>y[v]==null).forEach(v=>{y[v]=b({},f)}),h.axes=y}const d=c.map(f=>({[f]:b(E(b({},h),{series:n}),a)})).reduce(UP,{});return e=E(b({},r),{chartType:o,chartOptions:d}),e}function Eq(e){return e=kt("chartOptions.*.title.padding",e),e=kt("chartOptions.*.subtitle.padding",e),e=kt("chartOptions.*.axes.*.title.padding",e),e=$S("chartOptions.*.axes.*.title.enabled",!1,e),e}function Rq(e){return e=Ss("chartOptions.pie.series.callout","calloutLine",e),e=Ss("chartOptions.pie.series.label","calloutLabel",e),e=Ss("chartOptions.pie.series.labelKey","sectorLabelKey",e),e=Ss("chartOptions.pie.series.labelName","sectorLabelName",e),e=Ss("chartOptions.donut.series.callout","calloutLine",e),e=Ss("chartOptions.donut.series.label","calloutLabel",e),e=Ss("chartOptions.donut.series.labelKey","sectorLabelKey",e),e=Ss("chartOptions.donut.series.labelName","sectorLabelName",e),e}function Nq(e){return e=ig("chartOptions.scatter.series.fill","chartOptions.scatter.series.marker.fill",e),e=ig("chartOptions.scatter.series.fillOpacity","chartOptions.scatter.series.marker.fillOpacity",e),e=ig("chartOptions.scatter.series.stroke","chartOptions.scatter.series.marker.stroke",e),e=ig("chartOptions.scatter.series.strokeOpacity","chartOptions.scatter.series.marker.strokeOpacity",e),e=ig("chartOptions.scatter.series.strokeWidth","chartOptions.scatter.series.marker.strokeWidth",e),e=ny("chartOptions.scatter.series.paired","chartOptions.scatter.paired",e),e}function GP(e){return e=kt("chartOptions.axes[].tick.count",e),e}function zP(e){return e=yo("chartOptions.*.tooltip",e,n=>{var a=n,{tracking:i}=a,s=We(a,["tracking"]);var o,l,c,h;const r=b({},s);return i===!1?((o=r.position)!=null||(r.position={type:"pointer"}),(l=r.range)!=null||(r.range="nearest")):i===!0&&((c=r.position)!=null||(r.position={type:"node"}),(h=r.range)!=null||(r.range="nearest")),r}),e}function Oq(e){return e=Ss("chartOptions.pie.series.labelKey","sectorLabelKey",e),e=Ss("chartOptions.pie.series.labelName","sectorLabelName",e),e=GP(e),e=zP(e),e=kt("chartOptions.*.series.flipXY",e),e=HP("chartOptions.common.legend.enabled",!0,e),e=$S("chartOptions.common.legend.position","right",e),e}function Fq(e){const t={"ag-pastel":"ag-sheets","ag-solar":"ag-polychroma"},i=Ss("chartOptions.column","bar",e),s=t[i.chartThemeName]||i.chartThemeName;return E(b({},i),{chartThemeName:s})}function Bq(e){return e=Wa("chartOptions.*.autoSize",!0,e,(t,i)=>{t[i]===!0||t[i]===!1&&(t.minHeight=600,t.minWidth=300),delete t[i]}),e}function _q(e){return e=kt("chartOptions.*.axes.category.label.format",e),e=kt("chartOptions.*.axes.category.crosshair.label.format",e),e=kt("chartOptions.*.axes.angle-category.label.format",e),e=kt("chartOptions.*.axes.radius-category.label.format",e),e=Ss("chartOptions.*.axes.*.label.padding","spacing",e),e=Ss("chartOptions.*.navigator.miniChart.label.padding","spacing",e),e=kt("chartOptions.*.axes.*.crossLines.label.className",e),e=Wa("chartOptions.*.axes.*.crossLines.label.position",!0,e,(t,i)=>{typeof t[i]=="string"&&(t[i]=t[i].replace(/([A-Z])/,"-$1").toLowerCase())}),e=kt("chartOptions.bullet",e),e=WP("chartOptions.bar.series.label.placement",e,{inside:"inside-center",outside:"inside-end"}),e=WP("chartOptions.waterfall.series.item.*.label.placement",e,{inside:"inside-center",start:"outside-start",end:"outside-end"}),e=kt("chartOptions.*.navigator.min",e),e=kt("chartOptions.*.navigator.max",e),e=kt("chartOptions.*.zoom.ratioX",e),e=kt("chartOptions.*.zoom.ratioY",e),e=kt("chartOptions.*.zoom.rangeX",e),e=kt("chartOptions.*.zoom.rangeY",e),e}function Gq(e){return e=kt("chartOptions.*.width",e),e=kt("chartOptions.*.height",e),e=$S("chartOptions.*.axes.category.label.autoRotate",!0,e),e}function zq(e){var c,h;const t=e;if(e.version!=null)return e.version;const i=(d,...u)=>Object.keys(d||{}).some(p=>u.includes(p)),s=t.chartOptions,n=i(s,"seriesDefaults")?s==null?void 0:s.seriesDefaults:s==null?void 0:s[Object.keys(s)[0]],a={"27.0.0":i(t,"seriesChartTypes"),"26.2.0":!i(s,"seriesDefaults"),"26.1.0":i(n==null?void 0:n.highlightStyle,"item"),"26.0.0":i(n==null?void 0:n.highlightStyle,"series"),"25.1.0":i(n==null?void 0:n.label,"minAngle"),"25.0.0":i(t,"modelType","aggFunc","unlinkChart","suppressChartRanges")||i(n,"lineDash","lineDashOffset"),"24.0.0":i(t,"chartThemeName","chart")||i(s,"series"),"23.2.0":i(s,"navigator"),"23.0.0":i((h=(c=s==null?void 0:s.legend)==null?void 0:c.item)==null?void 0:h.marker,"shape"),"22.1.0":i(t,"chartPalette","chartType")},r="27.1.0",o=Object.entries(a).filter(([d,u])=>u);tg&&console.log("AG Grid: ChartModel migration",{heuristicVersionCandidates:o});const[l=r]=o[0];return tg&&console.log("AG Grid: ChartModel migration",{heuristicVersion:l}),l}function Vs(e,t,i){if(VP(e)>VP(t.version)){tg&&console.log("AG Grid: ChartModel migration",{migratingTo:e});const s=i(t);return s.version=e,tg&&console.log("AG Grid: ChartModel migration",{migratedTo:e,result:s}),s}return t}function Vq(e){const t=e.includes("-beta")?e.replace(/-beta.*/,""):e,i=typeof t=="string"?t.split(".").map(s=>Number(s)):[];if(i.length!==3||i.some(s=>isNaN(s)))throw new Error((0,m._errMsg)(253,{version:t}));return{major:i[0],minor:i[1],patch:i[2]}}function VP(e){const{major:t,minor:i,patch:s}=Vq(e);return t*1e4+i*100+s}function jP(e,t,i){return Wa(e,!0,i,(s,n)=>{s[n]===t&&delete s[n]})}function $S(e,t,i){return Wa(e,!1,i,(s,n)=>{s[n]==null&&(s[n]=t)})}function HP(e,t,i){var a;typeof e=="string"&&(e=e.split("."));const s=e[0];return e.length>1&&(i[s]=HP(e.slice(1),t,(a=i[s])!=null?a:{})),Object.keys(i).includes(s)||(i[s]=t),i}function ny(e,t,i){let s,n=!1;return i=Wa(e,!0,i,(a,r)=>{n=!0,s=a[r],delete a[r]}),n?Wa(t,!1,i,(a,r)=>{a[r]=s}):i}function ig(e,t,i){let s,n=!1;return i=Wa(e,!0,i,(a,r)=>{n=!0,s=a[r],delete a[r]}),n?Wa(t,!1,i,(a,r)=>{a[r]===void 0&&(a[r]=s)}):i}function Ss(e,t,i){return Wa(e,!0,i,(s,n)=>{s[t]=s[n],delete s[n]})}function kt(e,t){return Wa(e,!0,t,(i,s)=>delete i[s])}function Wa(e,t,i,s){const n=e instanceof Array?e:e.split("."),a=n.slice(0,n.length-1),r=n[n.length-1];return yo(a,i,o=>{const l=Object.keys(o).includes(r);if(t&&!l)return o;const c=b({},o);return s(c,r),c})}function yo(e,t,i){const s=e instanceof Array?e:e.split(".");if(t=b({},t),s.length===0)return i(t);if(s[0].startsWith("{")){const n=s[0].substring(1,s[0].lastIndexOf("}")).split(",");for(const a of n)t[a]!=null&&(t[a]=yo(s.slice(1),t[a],i))}else if(s[0].endsWith("[]")){const n=s[0].substring(0,e[0].indexOf("["));t[n]instanceof Array&&(t[n]=t[n].map(a=>yo(s.slice(1),a,i)))}else if(s[0]==="*")for(const n of Object.keys(t))t[n]=yo(s.slice(1),t[n],i);else t[s[0]]!=null&&(t[s[0]]=yo(s.slice(1),t[s[0]],i));return t}function WP(e,t,i){return Wa(e,!0,t,(s,n)=>{var a;typeof s[n]=="string"&&(s[n]=(a=i[n])!=null?a:n)})}var UP=(e,t)=>b(b({},e),t),jq=class extends m.BeanStub{constructor(){super(...arguments),this.beanName="chartSvc",this.activeCharts=new Set,this.activeChartComps=new Set,this.crossFilteringContext={lastSelectedChartId:""},this.isEnterprise=()=>this.agChartsExports.isEnterprise}wireBeans(e){this.visibleCols=e.visibleCols,this.rangeSvc=e.rangeSvc,this.agChartsExports=e.agChartsExports}updateChart(e){if(this.activeChartComps.size===0){(0,m._warn)(124);return}const t=[...this.activeChartComps].find(i=>i.getChartId()===e.chartId);if(!t){(0,m._warn)(125,{chartId:e.chartId});return}t.update(e)}getChartModels(){const e=[],t=i=>E(b({},i),{version:Re});return this.activeChartComps.forEach(i=>e.push(t(i.getChartModel()))),e}getChartRef(e){let t;return this.activeCharts.forEach(i=>{i.chartId===e&&(t=i)}),t}getChartComp(e){let t;return this.activeChartComps.forEach(i=>{i.getChartId()===e&&(t=i)}),t}getChartImageDataURL(e){let t;return this.activeChartComps.forEach(i=>{i.getChartId()===e.chartId&&(t=i.getChartImageDataURL(e.fileFormat))}),t}downloadChart(e){const t=Array.from(this.activeChartComps).find(i=>i.getChartId()===e.chartId);t==null||t.downloadChart(e.dimensions,e.fileName,e.fileFormat)}openChartToolPanel(e){const t=Array.from(this.activeChartComps).find(i=>i.getChartId()===e.chartId);t==null||t.openChartToolPanel(e.panel)}closeChartToolPanel(e){const t=Array.from(this.activeChartComps).find(i=>i.getChartId()===e);t==null||t.closeChartToolPanel()}createChartFromCurrentRange(e="groupedColumn",t){const i=this.getSelectedRange();return this.createChart({cellRange:i,chartType:e,focusDialogOnOpen:!t})}restoreChart(e,t){if(!e){(0,m._warn)(126);return}e.version!==Re&&(e=wq(e));let i,s,n,a;if(e.modelType==="pivot"?(this.gos.updateGridOptions({options:{pivotMode:!0},source:"pivotChart"}),i=this.createCellRange(void 0,!0),s=!0,n=!0):(i=this.createCellRange(e.cellRange),a=e.chartPalette,n=e.suppressChartRanges),!!i)return this.createChart(E(b({},e),{cellRange:i,pivotChart:s,suppressChartRanges:n,chartContainer:t,chartOptionsToRestore:e.chartOptions,chartPaletteToRestore:a}))}createRangeChart(e,t){const i=this.createCellRange(e.cellRange);if(i)return this.createChart(E(b({},e),{cellRange:i,focusDialogOnOpen:!t}))}createPivotChart(e,t){this.gos.updateGridOptions({options:{pivotMode:!0},source:"pivotChart"});const i=this.createCellRange(void 0,!0);if(i)return this.createChart(E(b({},e),{cellRange:i,pivotChart:!0,suppressChartRanges:!0,focusDialogOnOpen:!t}))}createCrossFilterChart(e,t){const i=this.createCellRange(e.cellRange);if(!i)return;const n=typeof e.suppressChartRanges!="undefined"&&e.suppressChartRanges!==null?e.suppressChartRanges:!0;return this.createChart(E(b({},e),{cellRange:i,suppressChartRanges:n,crossFiltering:!0,focusDialogOnOpen:!t}))}createChart(e){const t=KX(e,this.agChartsExports.isEnterprise);if(!t)return;e=t===!0?e:t;const{chartType:i,chartContainer:s}=e,n=this.gos.getCallback("createChartContainer"),a=E(b({},e),{chartId:this.generateId(),chartType:Zp(i),insideDialog:!(s||n),crossFilteringContext:this.crossFilteringContext,crossFilteringResetCallback:()=>this.activeChartComps.forEach(l=>l.crossFilteringReset())}),r=new Dq(a);this.createBean(r);const o=this.createChartRef(r);return s?s.appendChild(o.chartElement):n?n(o):r.addEventListener("destroyed",()=>{this.activeChartComps.delete(r),this.activeCharts.delete(o)}),o}createChartRef(e){const t={destroyChart:()=>{this.activeCharts.has(t)&&(this.destroyBean(e),this.activeChartComps.delete(e),this.activeCharts.delete(t))},focusChart:()=>{(0,m._focusInto)(e.getGui())},chartElement:e.getGui(),chart:e.getUnderlyingChart(),chartId:e.getChartModel().chartId};return this.activeCharts.add(t),this.activeChartComps.add(e),t}getSelectedRange(){var a;const e=(a=this.rangeSvc)==null?void 0:a.getCellRanges();if(!e||e.length===0)return{columns:[]};const t=new Set;let i=Number.MAX_VALUE,s=-Number.MAX_VALUE;if(e.forEach(({startRow:r,endRow:o,columns:l})=>{if(!(r&&o))return;l.forEach(p=>t.add(p));let{rowIndex:c,rowPinned:h}=r,{rowIndex:d,rowPinned:u}=o;if(h==="top"){if(u==="top")return;c=0}if(u==="bottom"){if(h==="bottom")return;d=this.beans.pageBounds.getLastRow()}c!==void 0&&(i=Math.min(i,c)),d!==void 0&&(s=Math.max(s,d))}),i===Number.MAX_VALUE||s===-Number.MAX_VALUE)return{columns:[]};const n=Array.from(t);return{columns:n,startColumn:n[0],startRow:{rowIndex:i,rowPinned:void 0},endRow:{rowIndex:s,rowPinned:void 0}}}generateId(){return`id-${Math.random().toString(36).substring(2,18)}`}createCellRange(e,t){var n;const i=t?{rowStartIndex:null,rowStartPinned:void 0,rowEndIndex:null,rowEndPinned:void 0,columns:this.visibleCols.allCols.map(a=>a.getColId())}:e,s=i&&((n=this.rangeSvc)==null?void 0:n.createPartialCellRangeFromRangeParams(i,!0));return s||(0,m._warn)(127,{allRange:t}),s}destroy(){this.activeCharts.forEach(e=>e.destroyChart()),super.destroy()}};function Hq(e){return e.frameworkOverrides.wrapIncoming(()=>{var t;return(t=e.chartSvc)==null?void 0:t.getChartModels()})}function Wq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.getChartRef(t)})}function Uq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.getChartImageDataURL(t)})}function Kq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.downloadChart(t)})}function $q(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.openChartToolPanel(t)})}function Yq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.closeChartToolPanel(t.chartId)})}function Xq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.createRangeChart(t,!0)})}function Zq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.createPivotChart(t,!0)})}function qq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.createCrossFilterChart(t,!0)})}function Qq(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.chartSvc)==null?void 0:i.updateChart(t)})}function Jq(e,t,i){return e.frameworkOverrides.wrapIncoming(()=>{var s;return(s=e.chartSvc)==null?void 0:s.restoreChart(t,i)})}var eQ=`.ag-chart{display:flex;height:100%;position:relative;width:100%}.ag-chart-components-wrapper{display:flex}.ag-chart-canvas-wrapper,.ag-chart-components-wrapper{flex:1 1 auto;position:relative}.ag-chart-menu{background:var(--ag-background-color);background-color:color-mix(in srgb,transparent,var(--ag-background-color) 30%);border-radius:var(--ag-border-radius);display:flex;flex-direction:row;gap:20px;padding:4px 2px;position:absolute;top:8px;width:auto;--ag-icon-size:20px}:where(.ag-ltr) .ag-chart-menu{justify-content:right;right:calc(var(--ag-cell-horizontal-padding) + var(--ag-spacing) - 4px)}:where(.ag-rtl) .ag-chart-menu{justify-content:left;left:calc(var(--ag-cell-horizontal-padding) + var(--ag-spacing) - 4px)}.ag-chart-docked-container{min-width:var(--ag-chart-menu-panel-width);position:relative}:where(.ag-chart-menu-hidden)~.ag-chart-docked-container{display:none}.ag-chart-tabbed-menu{display:flex;flex-direction:column;height:100%;overflow:hidden;width:100%}.ag-chart-tabbed-menu-header{cursor:default;flex:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-chart-tabbed-menu-body{align-items:stretch;display:flex;flex:1 1 auto;overflow:hidden;position:relative;&:after{background:linear-gradient(var(--ag-background-color),transparent);content:"";display:block;height:16px;left:0;position:absolute;right:0;top:0}}.ag-chart-tab{overflow:hidden;overflow-y:auto;width:100%}.ag-chart-settings{overflow-x:hidden}.ag-chart-settings-wrapper{display:flex;flex-direction:column;height:100%;overflow:hidden;position:relative;width:100%}.ag-chart-settings-nav-bar{align-items:center;border-top:1px solid var(--ag-border-color);display:flex;height:30px;padding:0 10px;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%}.ag-chart-settings-card-selector{align-items:center;display:flex;flex:1 1 auto;height:100%;justify-content:space-around;padding:0 10px}.ag-chart-settings-card-item{background-color:var(--ag-foreground-color);border-radius:4px;cursor:pointer;height:8px;position:relative;width:8px;&.ag-not-selected{opacity:.2}&:before{background-color:transparent;content:" ";display:block;height:20px;left:50%;margin-left:-10px;margin-top:-10px;position:absolute;top:50%;width:20px}&.ag-selected{background-color:var(--ag-accent-color)}}.ag-chart-settings-next,.ag-chart-settings-prev{flex:none;position:relative;&:focus-within{border-radius:1px;box-shadow:var(--ag-focus-shadow)}}.ag-chart-settings-next-button,.ag-chart-settings-prev-button{cursor:pointer;height:100%;left:0;opacity:0;position:absolute;top:0;width:100%}.ag-chart-settings-mini-charts-container{flex:1 1 auto;overflow:hidden auto;position:relative}.ag-chart-settings-mini-wrapper{display:flex;flex-direction:column;left:0;min-height:100%;overflow:hidden;padding-bottom:var(--ag-widget-container-vertical-padding);position:absolute;top:0;width:100%;&.ag-animating{transition:left .3s;transition-timing-function:ease-in-out}}.ag-chart-mini-thumbnail{border:1px solid var(--ag-border-color);border-radius:5px;cursor:pointer;padding:1px;&.ag-selected{border-color:var(--ag-accent-color);border-width:2px;padding:unset}&:focus-visible{border-color:var(--ag-accent-color);box-shadow:var(--ag-focus-shadow)}}.ag-chart-mini-thumbnail-canvas{display:block}.ag-chart-advanced-settings-wrapper,.ag-chart-data-wrapper,.ag-chart-format-wrapper{display:flex;flex-direction:column;padding-bottom:16px;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-chart-advanced-settings-wrapper,.ag-chart-data-wrapper{height:100%;overflow-y:auto}.ag-chart-advanced-settings{background-color:var(--ag-chrome-background-color)}.ag-chart-advanced-settings,.ag-chart-advanced-settings-wrapper{width:100%}.ag-chart-advanced-settings-wrapper{padding-bottom:0}.ag-chart-advanced-settings-section{border-bottom:1px solid var(--ag-border-color);display:flex;margin:0;padding-bottom:var(--ag-widget-container-vertical-padding);padding-top:var(--ag-widget-container-vertical-padding)}.ag-chart-empty-text{align-items:center;background-color:var(--ag-background-color);display:flex;height:100%;justify-content:center;top:0;width:100%}.ag-charts-font-size-color{align-self:stretch;display:flex;justify-content:space-between}.ag-charts-data-group-item{padding-bottom:var(--ag-widget-container-vertical-padding);position:relative}.ag-charts-data-group-item:where(:not(:last-child)){margin-bottom:var(--ag-spacing)}.ag-chart-menu-icon{border-radius:var(--ag-border-radius);cursor:pointer;margin:2px 0;opacity:.8;&:hover{opacity:1}}.ag-chart-menu-toolbar-button{background-color:unset;border:0;border-radius:1px;padding:0 2px}.ag-chart-data-column-drag-handle{margin-left:var(--ag-spacing)}.ag-charts-advanced-settings-top-level-group-title-bar{background-color:unset;position:relative}.ag-charts-data-group-container{padding:calc(var(--ag-widget-container-vertical-padding)*.5) var(--ag-widget-container-horizontal-padding)}.ag-charts-data-group-item:where(:not(.ag-charts-format-sub-level-group,.ag-pill-select,.ag-select)){height:var(--ag-list-item-height)}.ag-charts-data-group-item:where(.ag-picker-field){margin-top:var(--ag-spacing)}.ag-charts-advanced-settings-top-level-group-container,.ag-charts-format-top-level-group-container{margin-left:calc(var(--ag-spacing)*2);padding:var(--ag-spacing)}.ag-charts-advanced-settings-top-level-group-item,.ag-charts-format-top-level-group-item{margin:var(--ag-spacing) 0}.ag-charts-format-sub-level-group-container{display:flex;flex-direction:column;padding:var(--ag-widget-vertical-spacing) 0}.ag-charts-settings-group-container{display:grid;grid-template-columns:60px 1fr 60px 1fr 60px;padding:var(--ag-spacing);row-gap:8px;:where(.ag-chart-mini-thumbnail:nth-child(3n+1)){grid-column:1}:where(.ag-chart-mini-thumbnail:nth-child(3n+2)){grid-column:3}:where(.ag-chart-mini-thumbnail:nth-child(3n+3)){grid-column:5}}.ag-chart-data-section,.ag-chart-format-section{display:flex;margin:0;:where(.ag-label:not(.ag-group-title-bar)){color:var(--ag-chart-menu-label-color)}:where(.ag-label-align-top .ag-label){margin-bottom:var(--ag-widget-vertical-spacing);margin-top:calc(var(--ag-widget-vertical-spacing)*.5)}:where(.ag-slider.ag-label-align-top .ag-label){margin-bottom:0}:where(label){display:inline-block}}.ag-chart-menu-panel{--ag-panel-background-color:var(--ag-chrome-background-color)}:where(.ag-ltr) .ag-chart-menu-panel{border-left:1px solid var(--ag-border-color)}:where(.ag-rtl) .ag-chart-menu-panel{border-right:1px solid var(--ag-border-color)}.ag-charts-data-group-title-bar,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-container,.ag-charts-settings-group-title-bar{border-top:none;font-weight:500;padding:0 calc(var(--ag-spacing)*1.5)}.ag-charts-format-sub-level-group-title-bar{background:none;font-weight:500;padding:var(--ag-widget-vertical-spacing) 0}.ag-chart-data-wrapper,.ag-chart-format-wrapper,.ag-charts-data-group-container,.ag-charts-data-group-title-bar,.ag-charts-format-sub-level-group,.ag-charts-format-sub-level-group-container>*,.ag-charts-format-sub-level-group-item:last-child,.ag-charts-format-top-level-group,.ag-charts-format-top-level-group-item,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-container,.ag-charts-settings-group-title-bar,:where(.ag-charts-format-top-level-group) .ag-charts-format-top-level-group-container{margin:0;padding:0}.ag-charts-data-group-title-bar,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-title-bar{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:relative}.ag-charts-data-group,.ag-charts-format-top-level-group{border-top:1px solid var(--ag-border-color)}:where(.ag-charts-data-group) .ag-charts-data-group-container,:where(.ag-charts-format-top-level-group) .ag-charts-format-top-level-group-container,:where(.ag-charts-settings-group) .ag-charts-settings-group-container{padding:0 var(--ag-widget-container-horizontal-padding)}.ag-charts-format-sub-level-group-container>*,.ag-charts-format-sub-level-no-header-group-container>*,.ag-charts-format-top-level-group-container>*{margin-bottom:var(--ag-widget-vertical-spacing)}.ag-charts-advanced-settings-top-level-group-container{margin:0}:where(.ag-charts-advanced-settings-top-level-group){.ag-charts-advanced-settings-top-level-group-container,.ag-charts-advanced-settings-top-level-group-title-bar{padding:0 var(--ag-widget-container-horizontal-padding)}}.ag-charts-advanced-settings-top-level-group-item{margin-bottom:0;margin-top:calc(var(--ag-widget-vertical-spacing)*2)}.ag-chart-settings-card-item.ag-not-selected:hover{opacity:.35}.ag-angle-select{align-items:center;display:flex}.ag-angle-select-wrapper{display:flex}.ag-angle-select-parent-circle{background-color:var(--ag-background-color);border:1px solid;border-color:var(--ag-border-color);border-radius:12px;display:block;height:24px;position:relative;width:24px}.ag-angle-select-child-circle{background-color:var(--ag-foreground-color);border-radius:3px;height:6px;left:12px;margin-left:-3px;margin-top:-4px;position:absolute;top:4px;width:6px}.ag-slider-wrapper{display:flex;:where(.ag-input-field){flex:1 1 auto}}.ag-color-panel{display:flex;flex-direction:column;padding:var(--ag-spacing);text-align:center;width:100%}.ag-spectrum-color{cursor:default;flex:1 1 auto;overflow:visible;position:relative}.ag-spectrum-fill{inset:0;position:absolute}.ag-spectrum-val{background-image:linear-gradient(0deg,#000,hsla(20,42%,65%,0));cursor:pointer}.ag-spectrum-dragger{background:#000;border:3px solid #fff;border-radius:18px;box-shadow:0 0 2px 0 rgba(0,0,0,.24);cursor:pointer;height:18px;pointer-events:none;position:absolute;width:18px}.ag-spectrum-alpha,.ag-spectrum-hue{cursor:default}.ag-spectrum-hue-background{background:linear-gradient(270deg,red 3%,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red);height:100%;width:100%}.ag-spectrum-alpha-background{background:linear-gradient(to right,var(--ag-internal-spectrum-alpha-color-from),var(--ag-internal-spectrum-alpha-color-to)),url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>') 0 0 /4px 4px;height:100%;width:100%}.ag-spectrum-tool{border-radius:2px;cursor:pointer;height:11px;margin-bottom:10px;position:relative}.ag-spectrum-slider{border:2px solid #fff;border-radius:13px;box-shadow:0 1px 4px 0 rgba(0,0,0,.37);height:13px;margin-top:-12px;pointer-events:none;position:absolute;width:13px}:where(.ag-spectrum-alpha) .ag-spectrum-slider{background:linear-gradient(to bottom,var(--ag-internal-spectrum-alpha-color),var(--ag-internal-spectrum-alpha-color)) var(--ag-background-color)}.ag-recent-colors{display:flex;gap:6px;margin-bottom:2px;margin-left:var(--ag-spacing);margin-right:var(--ag-spacing)}.ag-recent-color{border:1px solid var(--ag-border-color);cursor:pointer}.ag-angle-select[disabled]{opacity:.5;pointer-events:none}:where(.ag-ltr) .ag-angle-select-field,:where(.ag-ltr) .ag-slider-field{margin-right:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-angle-select-field,:where(.ag-rtl) .ag-slider-field{margin-left:calc(var(--ag-spacing)*2)}.ag-color-dialog{border-radius:5px}:where(.ag-color-picker){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:var(--ag-spacing)}.ag-picker-field-display{align-items:center;display:flex;flex-direction:row;min-height:var(--ag-list-item-height)}}:where(.ag-ltr) .ag-color-picker-color,:where(.ag-ltr) .ag-color-picker-value{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-color-picker-color,:where(.ag-rtl) .ag-color-picker-value{margin-left:var(--ag-spacing)}.ag-spectrum-tools{padding-bottom:0;padding-left:0;padding-right:0}.ag-spectrum-alpha-background,.ag-spectrum-hue-background{border-radius:2px}.ag-color-input-color,.ag-color-picker-color,.ag-recent-color{border-radius:4px}.ag-spectrum-sat{background-image:linear-gradient(90deg,#fff,hsla(20,42%,65%,0))}.ag-recent-color,.ag-spectrum-color,.ag-spectrum-slider{&:where(:not(:disabled,[readonly])):focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-color-input-color,.ag-color-picker-color{border:1px solid var(--ag-border-color);border-radius:2px;height:var(--ag-icon-size);width:var(--ag-icon-size)}:where(.ag-color-input){.ag-color-input-color{position:absolute}}:where(.ag-ltr) :where(.ag-color-input){.ag-input-field-input{padding-left:calc(var(--ag-icon-size) + var(--ag-spacing)*2)}.ag-color-input-color{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-color-input){.ag-input-field-input{padding-right:calc(var(--ag-icon-size) + var(--ag-spacing)*2)}.ag-color-input-color{margin-right:var(--ag-spacing)}}.ag-range-field{align-items:center;display:flex;:where(.ag-input-wrapper){height:100%}}.ag-range-field-input{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:none;height:100%;overflow:visible;padding:0;width:100%;&:disabled{opacity:.5}}.ag-range-field-input{&::-webkit-slider-runnable-track{background-color:var(--ag-border-color);border-radius:1.5px;height:3px;margin:0;padding:0;width:100%}&::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;background-color:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:100%;height:var(--ag-icon-size);margin:0;padding:0;transform:translateY(calc(var(--ag-icon-size)*-.5 + 1.5px));width:var(--ag-icon-size)}&:focus::-webkit-slider-thumb{border-color:var(--ag-accent-color);box-shadow:var(--ag-focus-shadow)}&:active::-webkit-slider-runnable-track{background-color:var(--ag-accent-color)}}.ag-range-field-input{&::-moz-range-track{background-color:var(--ag-border-color);border-radius:1.5px;height:3px;margin:0;padding:0;width:100%}&::-moz-ag-range-thumb{-moz-appearance:none;appearance:none;background-color:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:100%;height:var(--ag-icon-size);margin:0;padding:0;transform:translateY(calc(var(--ag-icon-size)*-.5 + 1.5px));width:var(--ag-icon-size)}&:focus::-moz-ag-range-thumb{border-color:var(--ag-accent-color);box-shadow:var(--ag-focus-shadow)}&:active::-moz-ag-range-track{background-color:var(--ag-accent-color)}}`,KP=28,$P=6;function YS(e){return e&&e.match(/\d+\.\d+\.\d+/)}function tQ({gridMajorVersion:e,chartsMajorVersion:t}){const i=parseInt(e,10),s=parseInt(t,10),n=i-KP,a=s-$P,r=n>=0;return n===a&&r}function iQ(e){if(!e||!YS(e))return;const[t,i]=e.split(".")||[],s=`${t}.${i}.x`,a=parseInt(t,10)-KP+$P;if(a<0)return;const o=`${a}.${i}.x`;return{gridMajorMinor:s,chartsMajorMinor:o}}function ay({type:e,gridVersion:t,chartsVersion:i}){const s="AG Grid: AG Grid version is incompatible. Please see https://www.ag-grid.com/javascript-data-grid/modules/ for more information.";if(!t)return s;const n=iQ(t);if(!n)return s;const{gridMajorMinor:a,chartsMajorMinor:r}=n;return e==="incompatible"?`AG Grid version ${t} and AG Charts version ${i} is not supported. AG Grid version ${a} should be used with AG Chart ${r}. Please see https://www.ag-grid.com/javascript-data-grid/modules/ for more information.`:e==="invalidCharts"?`AG Grid version ${a} should be used with AG Chart ${r} not ${i}. Please see https://www.ag-grid.com/javascript-data-grid/modules/ for more information.`:s}function sQ({gridVersion:e,chartsVersion:t}){if(!YS(t))return{isValid:!1,message:ay({type:"invalidCharts",gridVersion:e,chartsVersion:t})};if(!YS(e))return{isValid:!1,message:ay({type:"invalidGrid",gridVersion:e,chartsVersion:t})};const[i,s]=e.split(".")||[],[n,a,r]=t.split(".")||[],o=tQ({gridMajorVersion:i,chartsMajorVersion:n});return o&&s===a||r.includes("beta")?{isValid:!0}:!o||s!==a?{isValid:!1,message:ay({type:"incompatible",gridVersion:e,chartsVersion:t})}:{isValid:!1,message:ay({type:"invalid",gridVersion:e,chartsVersion:t})}}var nQ={linked:"linked",unlinked:"unlinked",chartsMenu:"menu-alt",chartsDownload:"save",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus",chartsColorPicker:"small-down",chartsThemePrevious:"previous",chartsThemeNext:"next"},aQ={getChartModels:Hq,getChartRef:Wq,getChartImageDataURL:Uq,downloadChart:Kq,openChartToolPanel:$q,closeChartToolPanel:Yq,createRangeChart:Xq,createPivotChart:Zq,createCrossFilterChart:qq,updateChart:Qq,restoreChart:Jq},XS=[TS,St,m._SharedDragAndDropModule,m._PopupModule,Vm],YP="IntegratedCharts",aIe={moduleName:"GridCharts",version:Re,dependsOn:XS,validate:()=>({isValid:!1,message:`AG Grid: As of v33, the "GridChartsModule" has been deprecated. Please use "IntegratedChartsModule.with(...)" instead.
 ${(0,m._preInitErrMsg)(257)}`})},rQ={moduleName:YP,version:Re,dependsOn:XS,validate:()=>({isValid:!1,message:(0,m._preInitErrMsg)(257)}),with:e=>{var t;if(e.setup(),(t=e.setGridContext)==null||t.call(e,!0),e.isEnterprise&&e.setLicenseKey){const i={setLicenseKey:e.setLicenseKey};Op.setChartsLicenseManager(i)}return{moduleName:YP,version:Re,icons:nQ,apiFunctions:aQ,dependsOn:XS,css:[eQ],validate:()=>sQ({gridVersion:Re,chartsVersion:e.VERSION}),beans:[k8.bind(null,e),jq,FX,EX,LX,NX,fX,TX]}}},XP=[m.AllCommunityModule,qY,NK,V$,p6,w6,Qk,Jk,TS,i$,s6,AL,GY,zY,l8,c8,y$,Y$,SU,fS,O$,jY,f9,N9,T8],ZP="AllEnterprise",oQ={with:e=>({moduleName:ZP,version:Re,dependsOn:[...XP,rQ.with(e),YL.with(e)]}),moduleName:ZP,version:Re,dependsOn:XP},lQ=Object.defineProperty,qP=(e,t)=>{for(var i in t)lQ(e,i,{get:t[i],enumerable:!0})},se={};qP(se,{error:()=>JP,errorOnce:()=>dQ,log:()=>cQ,logGroup:()=>pQ,reset:()=>uQ,table:()=>hQ,warn:()=>QP,warnOnce:()=>sg});var ZS=new Set;function cQ(...e){console.log(...e)}function QP(e,...t){console.warn(`AG Charts - ${e}`,...t)}function JP(e,...t){typeof e=="object"?console.error("AG Charts error",e,...t):console.error(`AG Charts - ${e}`,...t)}function hQ(...e){console.table(...e)}function eE(e,t,i){let s;e instanceof Error?s=e.message:typeof e=="string"?s=e:typeof e=="object"?s=JSON.stringify(e):s=String(e);const n=`${t}: ${s}`;ZS.has(n)||(i(e),ZS.add(n))}function sg(e,...t){eE(e,"Logger.warn",i=>QP(i,...t))}function dQ(e,...t){eE(e,"Logger.error",i=>JP(i,...t))}function uQ(){ZS.clear()}function pQ(e,t){console.groupCollapsed(e);try{return t()}finally{console.groupEnd()}}var cn={};qP(cn,{detectChartDefinition:()=>vQ,getAxisModule:()=>bQ,getPresetModule:()=>xQ,getSeriesModule:()=>CQ,hasModule:()=>mQ,listModulesByType:()=>yQ,register:()=>tE,registerMany:()=>gQ,reset:()=>fQ});var ry=(e=>(e.Axis="axis",e.Chart="chart",e.Preset="preset",e.Plugin="plugin",e.Series="series",e))(ry||{}),vo=new Map;function tE(e){const t=vo.get(e.name);if(t&&(t.enterprise||!e.enterprise))throw new Error(`AG Charts - Module '${e.name}' already registered`);vo.set(e.name,e)}function gQ(e){for(const t of e)tE(t)}function fQ(){vo.clear()}function mQ(e){return vo.has(e)}function*yQ(e){for(const t of vo.values())ng(e,t)&&(yield t)}function vQ(e){for(const t of vo.values())if(ng("chart",t)&&t.detect(e))return t;throw new Error("AG Charts - Unknown chart type; Check options are correctly structured and series types are specified")}function bQ(e){const t=vo.get(e);if(ng("axis",t))return t}function xQ(e){const t=vo.get(e);if(ng("preset",t))return t}function CQ(e){const t=vo.get(e);if(ng("series",t))return t}function ng(e,t){return(t==null?void 0:t.type)===e}var ag=class{constructor(){this.events=new Map}on(e,t){var i;return this.events.has(e)||this.events.set(e,new Set),(i=this.events.get(e))==null||i.add(t),()=>this.off(e,t)}off(e,t){const i=this.events.get(e);i&&(i.delete(t),i.size===0&&this.events.delete(e))}emit(e,t){var i;(i=this.events.get(e))==null||i.forEach(s=>s(t))}clear(e){e?this.events.delete(e):this.events.clear()}},Cr={};typeof window!="undefined"?Cr.window=window:typeof global!="undefined"&&(Cr.window=global.window),typeof document!="undefined"?Cr.document=document:typeof global!="undefined"&&(Cr.document=global.document);function Sr(e){var t;return e?(t=Cr.document)==null?void 0:t[e]:Cr.document}function Ct(e){var t;return e?(t=Cr.window)==null?void 0:t[e]:Cr.window}function SQ(e){Cr.document=e}function MQ(e){Cr.window=e}function ke(e,t,i){const s=Sr().createElement(e);if(typeof t=="object"&&(i=t,t=void 0),t)for(const n of t.split(" "))s.classList.add(n);return i&&Object.assign(s.style,i),s}function Ti(e){return Sr().createElementNS("http://www.w3.org/2000/svg",e)}function DQ(e,t){const i=Sr("body"),s=ke("a",{display:"none"});s.href=e,s.download=t,i.appendChild(s),s.click(),setTimeout(()=>i.removeChild(s))}function wQ(e){const t=Ct("Option"),{style:i}=new t;return i.color=e,i.color||null}function ni(e){return e!=null}function Ke(e){return Array.isArray(e)}function AQ(e){return typeof e=="boolean"}function Mr(e){return e instanceof Date}function Vd(e){return Mr(e)&&!isNaN(Number(e))}function IQ(e){return e instanceof RegExp}function Dr(e){return typeof e=="function"}function Ve(e){return typeof e=="object"&&e!==null&&!Ke(e)}function rIe(e){return Ke(e)||Lt(e)}function Lt(e){var t;return typeof e=="object"&&e!==null&&((t=e.constructor)==null?void 0:t.name)==="Object"}function Ji(e){return typeof e=="string"}function ki(e){return typeof e=="number"}function Xe(e){return Number.isFinite(e)}function TQ(e){return typeof window!="undefined"&&e instanceof HTMLElement}function oIe(e,t){return Ji(t)&&Object.keys(e).includes(t)}function qS(e,t){return Object.values(e).includes(t)}function oy(e){return typeof e=="symbol"}function kQ(e){return Ji(e)&&(e==="none"||wQ(e)!=null)}function LQ(e,t){return e in t}function PQ(e,t=0,i){const{leading:s=!1,trailing:n=!0,maxWait:a=1/0}=i!=null?i:{};let r,o;if(a<t)throw new Error("Value of maxWait cannot be lower than waitMs.");function l(...c){if(s&&!o){o=Date.now(),r=setTimeout(()=>o=null,t),e(...c);return}let h=t;if(a!==1/0&&o){const d=Date.now()-o;t>a-d&&(h=a-d)}clearTimeout(r),o!=null||(o=Date.now()),r=setTimeout(()=>{o=null,n&&e(...c)},h)}return Object.assign(l,{cancel(){clearTimeout(r),o=null}})}function iE(e,t,i){const{leading:s=!0,trailing:n=!0}=i!=null?i:{};let a,r,o=!1;function l(){n&&r?(a=setTimeout(l,t),e(...r)):o=!1,r=null}function c(...h){o?r=h:(o=!0,a=setTimeout(l,t),s?e(...h):r=h)}return Object.assign(c,{cancel(){clearTimeout(a),o=!1,r=null}})}function sE(e,t,i=""){try{return e(...t)}catch(s){const n=i?` \`${i}\``:"";sg(`Uncaught exception in user callback${n}`,s)}}function rg(e,t="and",i=String,s=1/0){if(e.length===0)return"";if(e.length===1)return i(e[0]);e=e.map(i);const n=e.pop();if(e.length>=s){const a=e.length-(s-1);return`${e.slice(0,s-1).join(", ")}, and ${a} more ${t} ${n}`}return`${e.join(", ")} ${t} ${n}`}function QS(e,t=1/0){var s;if(typeof e=="number"){if(isNaN(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity"}const i=(s=JSON.stringify(e))!=null?s:typeof e;return i.length>t?`${i.slice(0,t)}... (+${i.length-t} characters)`:i}function EQ(e){let t=1;for(let i=0;i<e.length;i++)e.charCodeAt(i)===10&&t++;return t}function RQ(e,t){if(e===t)return 0;const[i,s]=e.length<t.length?[e,t]:[t,e],n=i.length,a=s.length;let r=new Array(n+1).fill(0).map((l,c)=>c),o=new Array(n+1);for(let l=1;l<=a;l++){o[0]=l;for(let c=1;c<=n;c++){const h=s[l-1]===i[c-1]?0:1;o[c]=Math.min(r[c]+1,o[c-1]+1,r[c-1]+h)}[r,o]=[o,r]}return r[n]}var ga=Symbol("description"),nE=Symbol("required"),ly=Symbol("marked"),aE=Symbol("undocumented"),cy=Symbol("union"),NQ=[["placement","position"],["padding","spacing","gap"],["color","fill","stroke"],["whisker","wick"],["nodeClick","seriesNodeClick"],["nodeDoubleClick","seriesNodeDoubleClick"],["src","url"]].reduce((e,t)=>{for(const i of t)e.set(i.toLowerCase(),new Set(t.filter(s=>s!==i)));return e},new Map),rE=(e=>(e.Invalid="invalid",e.Required="required",e.Unknown="unknown",e))(rE||{});function og(e,t){return Xe(t)?`${e}[${t}]`:e?`${e}.${t}`:t}var eh=class{constructor(e,t,i,s,n){this.type=e,this.description=t,this.value=i,this.path=s,this.key=n}setUnionType(e,t){if(this.path.startsWith(t)){const i=this.path.slice(t.length);this.altPath=`${t}[type=${e}]${i}`}}getPrefix(){const{altPath:e=this.path,key:t}=this;return!e&&!t?"Value":`Option \`${t?og(e,t):e}\``}toString(){const{description:e="unknown",type:t,value:i}=this;return t==="required"&&i==null?`${this.getPrefix()} is required and has not been provided; expecting ${e}, ignoring.`:`${this.getPrefix()} cannot be set to \`${QS(i,50)}\`; expecting ${e}, ignoring.`}},JS=class extends eh{constructor(e,t,i,s){super("unknown",void 0,t,i,s),this.suggestions=e,this.key=s}getPrefix(){return`Unknown option \`${og(this.path,this.key)}\``}getPostfix(){const e=rg(OQ(this.key,this.suggestions),"or",t=>`\`${t}\``);return e?`; Did you mean ${e}? Ignoring.`:", ignoring."}toString(){return`${this.getPrefix()}${this.getPostfix()}`}};function js(e,t,i=""){if(!Ve(e))return{cleared:null,invalid:[new eh("required","an object",e,i)]};const s={},n=[],a=new Set(Object.keys(e)),r=[];if(cy in t){const l=Object.keys(t),c=t[cy];if(e.type!=null&&l.includes(e.type)||e.type==null&&c!=null){const o=e,{type:h=c}=o,d=We(o,["type"]),u=js(d,t[h],i);Object.assign(s,{type:h},u.cleared);for(const p of u.invalid)p.setUnionType(h,i);n.push(...u.invalid)}else{const h=rg(l,"or",d=>`'${d}'`);n.push(new eh("required",`a keyword such as ${h}`,e.type,i,"type"))}return{cleared:s,invalid:n}}for(const l of Object.keys(t)){const c=t[l],h=c[nE],d=e[l];if(a.delete(l),typeof d=="undefined"&&(c[aE]||r.push(l),!h))continue;const u=og(i,l);if(Dr(c)){const g=c(d,{options:e,path:u});if(typeof g=="object"){if(n.push(...g.invalid),g.valid){s[l]=g.cleared;continue}else if(Hd(g.invalid,u))continue}else if(g){s[l]=d;continue}n.push(new eh(h?"required":"invalid",c[ga],d,i,l))}else{const p=js(d,c,u);p.cleared!=null&&(s[l]=p.cleared),n.push(...p.invalid)}}for(const l of a){const c=e[l];typeof c!="undefined"&&n.push(new JS(r,c,i,l))}return{cleared:s,invalid:n}}function OQ(e,t,i=2){const s=[],n=e.toLowerCase(),a=NQ.get(n);for(const r of t){const o=r.toLowerCase();(a!=null&&a.has(r)||o.includes(n)||RQ(n,o)<=i)&&s.push(r)}return s}function st(e,t){return Object.assign(Dr(e)?(i,s)=>e(i,s):b({},e),{[ga]:t})}function ee(e){return Object.assign(Dr(e)?(t,i)=>e(t,i):es(e),{[nE]:!0,[ga]:e[ga]})}function Ce(e){return Object.assign(Dr(e)?(t,i)=>e(t,i):es(e),{[aE]:!0,[ga]:e[ga]})}var es=(e,t="an object")=>st((i,s)=>{const n=js(i,e,s.path);return{valid:!Hd(n.invalid,s.path),cleared:n.cleared,invalid:n.invalid}},t),th=(e,t,i)=>E(b({},e),{[ga]:t,[cy]:i}),Pt=(...e)=>st((t,i)=>{const s=[];for(const n of e){const a=n(t,i);if(typeof a=="object"){if(s.push(...a.invalid),!a.valid)return{valid:!1,cleared:t,invalid:s};t=a.cleared}else if(!a)return!1}return{valid:!0,cleared:t,invalid:s}},e.map(t=>t[ga]).filter(Boolean).join(" and ")),Ne=(...e)=>st((t,i)=>{for(const s of e){const n=s(t,i);if(typeof n=="object"?n.valid:n)return n}return!1},e.map(t=>t[ga]).filter(Boolean).join(" or ")),hy=e=>Xe(e)||Vd(e),FQ=e=>Mr(e)||(Xe(e)||Ji(e))&&Vd(new Date(e)),hn=st(Ke,"an array"),q=st(AQ,"a boolean"),ft=st(Dr,"a function"),ye=st(kQ,"a color string"),wr=st(FQ,"a date"),_e=st(ni,"a defined value"),ne=st(Xe,"a number"),dy=st(Ve,"an object"),z=st(Ji,"a string"),oE=st(e=>typeof HTMLElement=="undefined"||e instanceof HTMLElement,"an html element"),jd=(e,t=1/0)=>{let i;return t===1/0?i=`an array of at least ${e} items`:e===t?i=`an array of exactly ${e} items`:e===0?i=`an array of no more than ${t} items`:i=`an array of at least ${e} and no more than ${t} items`,st(s=>Ke(s)&&s.length>=e&&s.length<=t,i)},lE=(e,t=1/0)=>{let i;return t===1/0?i=`a string of at least ${e} characters`:e===t?i=`an string of exactly ${e} characters`:e===0?i=`an string of no more than ${t} characters`:i=`an string of at least ${e} and no more than ${t} characters`,st(s=>Ji(s)&&s.length>=e&&s.length<=t,i)},cE=(e,t=!0)=>st(i=>Xe(i)&&(i>e||t&&i===e),`a number greater than ${t?"or equal to ":""}${e}`),hE=(e,t)=>st(i=>Xe(i)&&i>=e&&i<=t,`a number between ${e} and ${t} inclusive`),X=cE(0),e0=cE(0,!1),Me=hE(0,1),Ar=e=>st((t,{options:i})=>!hy(t)||!hy(i[e])||t<i[e],`the value to be less than \`${e}\``),Il=e=>st((t,{options:i})=>!hy(t)||!hy(i[e])||t>i[e],`the value to be greater than \`${e}\``);function ce(...e){Ve(e[0])&&(e=Object.values(e[0]));const t=rg(e,"or",i=>`'${i}'`);return st(i=>e.includes(i),`a keyword such as ${t}`)}var Oe=e=>st(t=>e===t,`the value ${JSON.stringify(e)}`),dE=(e,t)=>st(i=>i instanceof e,t!=null?t:`an instance of ${e.name}`),Ie=(e,t,i=!0)=>st((s,n)=>{if(!Ke(s))return!1;let a=i;const r=[],o=[],l=c=>a=i?a&&c:a||c;if(s.length===0)return{valid:!0,cleared:r,invalid:o};for(let c=0;c<s.length;c++){const h=s[c],d=e(h,{options:h,path:`${n.path}[${c}]`});typeof d=="object"?(a=l(d.valid),o.push(...d.invalid),d.cleared!=null&&r.push(d.cleared)):(a=l(d),d&&r.push(h))}return{valid:a,cleared:a||!i?r:null,invalid:o}},t!=null?t:`${e[ga]} array`),Li=(e,t="an object array")=>st((i,s)=>{if(!Ke(i))return!1;const n=[],a=[];for(let r=0;r<i.length;r++){const o=`${s.path}[${r}]`,l=js(i[r],e,o);Hd(l.invalid,o)||n.push(l.cleared),a.push(...l.invalid)}return{valid:!0,cleared:n,invalid:a}},t),uy=(e,t)=>st((i,s)=>Dr(i)?ly in i?!0:{valid:!0,cleared:Object.assign((...a)=>{const r=sE(i,a);if(r==null)return;const o=e(r,{options:r,path:""});if(typeof o=="object"){if(o.invalid.forEach(uE(s,t!=null?t:e[ga])),o.valid)return o.cleared}else{if(o)return r;sg(`Callback \`${s.path}\` returned an invalid value \`${QS(r,50)}\`; expecting ${t!=null?t:e[ga]}, ignoring.`)}},{[ly]:!0}),invalid:[]}:!1,"a function"),Ft=(e,t="an object")=>st((i,s)=>Dr(i)?ly in i?!0:{valid:!0,cleared:Object.assign((...a)=>{const r=sE(i,a,s.path);if(r==null)return;const o=js(r,e);return o.invalid.forEach(uE(s,t)),o.cleared},{[ly]:!0}),invalid:[]}:!1,"a function");function Hd(e,t){return e.some(i=>i.type==="required"&&i.path===t)}function uE(e,t){return i=>{if(i instanceof JS)return sg(`Callback \`${e.path}\` returned an unknown property \`${og(i.path,i.key)}\`${i.getPostfix()}`);const s=QS(i.value,50);sg(i.key?`Callback \`${e.path}\` returned an invalid property \`${og(i.path,i.key)}\`: \`${s}\`; expecting ${i.description}, ignoring.`:`Callback \`${e.path}\` returned an invalid value \`${s}\`; expecting ${t!=null?t:i.description}, ignoring.`)}}var py=e=>{if(!Ve(e))return!1;const t=Object.keys(e);return t.length===1&&t[0].startsWith("$")},BQ=es({color:ye,stop:Me},""),pE=st(e=>{let t=-1/0;for(const i of e)if((i==null?void 0:i.stop)!=null){if(i.stop<t)return!1;t=i.stop}return!0},"color stops to be defined in ascending order"),t0=Pt(jd(2),Ie(BQ),pE),i0=ce("axis","item","series"),s0=es({type:ee(Oe("gradient")),colorStops:ee(t0),rotation:ne,gradient:Ce(ce("linear","radial","conic")),bounds:Ce(i0),reverse:Ce(q)},"a gradient object with color stops"),ge={stroke:ye,strokeWidth:X,strokeOpacity:Me},gy=es({type:ee(Oe("gradient")),gradient:ee(ce("linear","radial","conic")),bounds:ee(i0),colorStops:ee(Ne(t0,Pt(jd(2),Ie(ye)))),rotation:ee(ne),reverse:ee(q)}),fy=es({type:ee(Oe("pattern")),pattern:ee(ce("vertical-lines","horizontal-lines","forward-slanted-lines","backward-slanted-lines","circles","squares","triangles","diamonds","stars","hearts","crosses")),path:lE(2),width:ee(X),height:ee(X),fill:ee(ye),fillOpacity:ee(Me),backgroundFill:ee(ye),backgroundFillOpacity:ee(Me),padding:ee(X),rotation:ee(ne),scale:ee(X),stroke:ee(ye),strokeWidth:ee(X),strokeOpacity:ee(Me)}),my=es({type:ee(Oe("image")),url:z,width:X,height:X,rotation:ee(ne),backgroundFill:ee(ye),backgroundFillOpacity:Me,fit:ee(ce("stretch","contain","cover")),repeat:ee(ce("repeat","repeat-x","repeat-y","no-repeat"))}),_Q=th({gradient:{colorStops:t0,rotation:ne,gradient:Ce(ce("linear","radial","conic")),bounds:Ce(i0),reverse:Ce(q)},pattern:E(b({pattern:ce("vertical-lines","horizontal-lines","forward-slanted-lines","backward-slanted-lines","circles","squares","triangles","diamonds","stars","hearts","crosses"),path:lE(2),width:X,height:X,rotation:ne,scale:X,fill:ye,fillOpacity:Me,backgroundFill:ye,backgroundFillOpacity:Me},ge),{padding:Ce(X)}),image:{url:ee(z),backgroundFill:ye,backgroundFillOpacity:Me,width:X,height:X,fit:ce("stretch","contain","cover","none"),repeat:ce("repeat","repeat-x","repeat-y","no-repeat"),rotation:ne}},"a color object"),Ir=Ne(ye,es(_Q,"a color object")),xe={fill:Ir,fillOpacity:Me};xe.fillGradientDefaults=Ce(gy),xe.fillPatternDefaults=Ce(fy),xe.fillImageDefaults=Ce(my);var De={lineDash:Ie(X),lineDashOffset:ne},gE=es({googleFont:z},"google font"),n0=Ne(z,py,gE,Ie(Ne(z,gE))),It={color:ye,fontFamily:n0,fontSize:X,fontStyle:ce("normal","italic","oblique"),fontWeight:Ne(X,ce("normal","bold","bolder","lighter"))};function yy(e){return typeof e=="undefined"?[]:Array.isArray(e)?e:[e]}function a0(e){return Array.from(new Set(e))}function r0(e,t){return e.reduce((i,s)=>{var a;const n=t(s);return(a=i[n])!=null||(i[n]=[]),i[n].push(s),i},{})}function fa(e,t){if(e==null||t==null||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(Array.isArray(e[i])&&Array.isArray(t[i])){if(!fa(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1;return!0}function lg(e,t,i=0){if(e.length===0)return[];const s=[];for(let n=0;n<t;n++)s.push(e.at((n+i)%e.length));return s}function GQ(e,t){const i=new Map;return t.forEach((s,n)=>{i.set(s,n)}),e.sort((s,n)=>{var o,l;const a=(o=i.get(s))!=null?o:1/0,r=(l=i.get(n))!=null?l:1/0;return a-r})}function zQ(e,t){let i=0;for(;i<e.length&&t(e[i]);)i+=1;const s=i;s!==0&&e.splice(0,s)}function VQ(e,t){let i=e.length-1;for(;i>=0&&t(e[i]);)i-=1;const s=e.length-1-i;s!==0&&e.splice(e.length-s,s)}var o0=class{constructor(){this.queue=[]}await(e=50){return new Promise(t=>{const i=()=>{clearTimeout(n),t(!0)},n=setTimeout(()=>{const a=this.queue.indexOf(i);a<0||(this.queue.splice(a,1),t(!1))},e);this.queue.push(i)})}notify(){this.queue.splice(0).forEach(e=>e())}};function fE(e=0){return new Promise(t=>{setTimeout(t,e)})}function*ih(...e){for(const t of e)yield*UC(t)}function jQ(e){return e!=null&&typeof e=="object"&&Symbol.iterator in e?e:[e]}function cg(e){for(const t of e)return t;throw new Error("AG Charts - no first() value found")}function*Zt(e){const t=[void 0,void 0];for(const i of Object.keys(e))t[0]=i,t[1]=e[i],yield t}function Tl(e){return e==="true"}function HQ(e){return Number(e)}function Kn(e){return e}var l0={role:Kn,"aria-checked":Tl,"aria-controls":Kn,"aria-describedby":Kn,"aria-disabled":Tl,"aria-expanded":Tl,"aria-haspopup":Kn,"aria-hidden":Tl,"aria-label":Kn,"aria-labelledby":Kn,"aria-live":Kn,"aria-orientation":Kn,"aria-selected":Tl,"data-focus-override":Tl,"data-focus-visible-override":Tl,"data-preventdefault":Tl,class:Kn,for:Kn,id:Kn,tabindex:HQ,title:Kn,placeholder:Kn};function $e(e,t,i){i==null||i===""||i===""?e==null||e.removeAttribute(t):e==null||e.setAttribute(t,i.toString())}function bo(e,t){if(t!=null)for(const[i,s]of Zt(t))i!=="class"&&$e(e,i,s)}function Wd(e,t,i){var n,a;if(!(e instanceof HTMLElement))return;const s=e.getAttribute(t);return s===null?i:(a=(n=l0[t])==null?void 0:n.call(l0,s))!=null?a:void 0}function Tr(e,t,i){e!=null&&(i==null?e.style.removeProperty(t):e.style.setProperty(t,i.toString()))}function WQ(e,t){for(const[i,s]of Zt(t))Tr(e,i,s)}function kl(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2);i(n)?(s=n,e=n+1):t=n-1}return s}function hg(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2);i(n)?(s=n,t=n-1):e=n+1}return s}function mE(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2),a=i(n);a==null?t=n-1:(s=a,e=n+1)}return s}function lIe(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2),a=i(n);a==null?e=n+1:(s=a,t=n-1)}return s}function UQ(e,t){const i=Math.max(e.length,t.length),s=new Set,n=new Set;for(let a=0;a<i;a++){const r=e[a],o=t[a];r!==o&&(n.has(o)?n.delete(o):o&&s.add(o),s.has(r)?s.delete(r):r&&n.add(r))}return{changed:s.size>0||n.size>0,added:s,removed:n}}function we(e,t,i){return Math.min(i,Math.max(e,t))}function KQ(e,t,i=1e-10){return e>=t[0]-i&&e<=t[1]+i}function mt(e,t,i=1e-10){return e===t||Math.abs(e-t)<i}function c0(e){return Math.sign(e)===-1||Object.is(e,-0)}function yE(e){return e%1===0}function h0(e,t=2){const i=10**t;return Math.round(e*i)/i}function vE(e,t){return Math.floor(e%t+(e<0?Math.abs(t):0))}function Ud(e){var n,a;if(Math.floor(e)===e)return 0;let t=String(e),i=0;if(e<1e-6||e>=1e21){let r;[t,r]=t.split("e"),r!=null&&(i=Number(r))}const s=(a=(n=t.split(".")[1])==null?void 0:n.length)!=null?a:0;return Math.max(s-i,0)}function bE(e){return Array.isArray(e)&&e.length>=2&&e.every(Xe)}function vy(e){return Array.isArray(e)&&e.length>=2&&e.every(bE)}function $Q(e){const t=e[0],i=e[e.length-1];return mt(t[0],i[0],.001)&&mt(t[1],i[1],.001)}function xE(e){return Array.isArray(e)&&e.every(vy)&&e.every($Q)}function CE(e){if(e===null)return!0;if(!Ve(e)||e.type==null)return!1;const{type:t,coordinates:i}=e;switch(t){case"GeometryCollection":return Array.isArray(e.geometries)&&e.geometries.every(CE);case"MultiPolygon":return Array.isArray(i)&&i.every(xE);case"Polygon":return xE(i);case"MultiLineString":return Array.isArray(i)&&i.every(vy);case"LineString":return vy(i);case"MultiPoint":return vy(i);case"Point":return bE(i);default:return!1}}function YQ(e){return Ve(e)&&e.type==="Feature"&&CE(e.geometry)}function XQ(e){return Ve(e)&&e.type==="FeatureCollection"&&Array.isArray(e.features)&&e.features.every(YQ)}var Kd=st(XQ,"a GeoJSON object"),d0=new Map,cIe=Symbol("ElementID"),SE=1;function hIe(){d0.clear(),SE=1}function Hs(e){var n;const t=e.constructor,i=Object.hasOwn(t,"className")?t.className:t.name;if(!i)throw new Error(`The ${t} is missing the 'className' property.`);const s=((n=d0.get(i))!=null?n:0)+1;return d0.set(i,s),`${i}-${s}`}function sh(){return`ag-charts-${SE++}`}function by(){var e,t;return(t=(e=crypto.randomUUID)==null?void 0:e.call(crypto))!=null?t:ZQ()}function ZQ(){const e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let t="";for(let i=0;i<e.length;i++)(i===4||i===6||i===8||i===10)&&(t+="-"),t+=e[i].toString(16).padStart(2,"0");return t}var ME=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(?:\.(\d+))?(~)?([%a-z])?$/i,DE=/^((?:[^#]|#[^{])*)#{([^}]+)}(.*)$/;function qQ(e){if(!Ji(e))return!1;const t=DE.exec(e);return ME.test(t?t[2]:e)}function wE(e){let t,i;const s=DE.exec(e);s&&([,t,e,i]=s);const n=ME.exec(e);if(!n)throw new Error(`The number formatter is invalid: ${e}`);const[,a,r,o,l,c,h,d,u,p,g]=n;return{fill:a,align:r,sign:o,symbol:l,zero:c,width:parseInt(h),comma:d,precision:parseInt(u),trim:!!p,type:g,prefix:t,suffix:i}}function AE(e){const t=typeof e=="string"?wE(e):e,{fill:i,align:s,sign:n="-",symbol:a,zero:r,width:o,comma:l,type:c,prefix:h="",suffix:d="",precision:u}=t;let{trim:p}=t;const g=u==null||isNaN(u);let f;if(!c)f=ma.g,p=!0;else if(c in ma&&c in $d)f=g?$d[c]:ma[c];else if(c in ma)f=ma[c];else if(c in $d)f=$d[c];else throw new Error(`The number formatter type is invalid: ${c}`);let y;return g?y=c?6:12:y=u,v=>{let x=f(v,y);return p&&(x=eJ(x)),l&&(x=tJ(x,l)),x=sJ(v,x,n),a&&a!=="#"&&(x=`${a}${x}`),a==="#"&&c==="x"&&(x=`0x${x}`),c==="s"&&(x=`${x}${iJ(v)}`),(c==="%"||c==="p")&&(x=`${x}%`),o!=null&&!isNaN(o)&&(x=nJ(x,o,i!=null?i:r,s)),x=`${h}${x}${d}`,x}}var $d={b:e=>xy(e).toString(2),c:e=>String.fromCharCode(e),d:e=>Math.round(Math.abs(e)).toFixed(0),o:e=>xy(e).toString(8),x:e=>xy(e).toString(16),X:e=>$d.x(e).toUpperCase(),n:e=>$d.d(e),"%":e=>`${xy(e*100).toFixed(0)}`},ma={e:(e,t)=>Math.abs(e).toExponential(t),E:(e,t)=>ma.e(e,t).toUpperCase(),f:(e,t)=>Math.abs(e).toFixed(t),F:(e,t)=>ma.f(e,t).toUpperCase(),g:(e,t)=>{if(e===0)return"0";const i=Math.abs(e),s=Math.floor(Math.log10(i));return s>=-4&&s<t?i.toFixed(t-1-s):i.toExponential(t-1)},G:(e,t)=>ma.g(e,t).toUpperCase(),n:(e,t)=>ma.g(e,t),p:(e,t)=>ma.r(e*100,t),r:(e,t)=>{if(e===0)return"0";const i=Math.abs(e),n=Math.floor(Math.log10(i))-(t-1);if(n<=0)return i.toFixed(-n);const a=10**n;return(Math.round(i/a)*a).toFixed()},s:(e,t)=>{const i=kE(e);return ma.r(e/10**i,t)},"%":(e,t)=>ma.f(e*100,t)},IE=-24,TE=24,QQ={[IE]:"y",[-21]:"z",[-18]:"a",[-15]:"f",[-12]:"p",[-9]:"n",[-6]:"\xB5",[-3]:"m",0:"",3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",[TE]:"Y"},JQ="\u2212";function xy(e){return Math.floor(Math.abs(e))}function eJ(e){return e.replace(/\.0+$/,"").replace(/(\.[1-9])0+$/,"$1")}function tJ(e,t){let i=e.indexOf(".");i<0&&(i=e.length);const s=e.substring(0,i).split(""),n=e.substring(i);for(let a=s.length-3;a>0;a-=3)s.splice(a,0,t);return`${s.join("")}${n}`}function iJ(e){return QQ[kE(e)]}function kE(e){return we(IE,e?Math.floor(Math.log10(Math.abs(e))/3)*3:0,TE)}function sJ(e,t,i=""){if(i==="(")return e>=0?t:`(${t})`;const s=i==="+"?"+":"";return`${e>=0?s:JQ}${t}`}function nJ(e,t,i=" ",s=">"){let n=e;if(s===">"||!s)n=n.padStart(t,i);else if(s==="<")n=n.padEnd(t,i);else if(s==="^"){const a=Math.max(0,t-n.length),r=Math.ceil(a/2),o=Math.floor(a/2);n=n.padStart(r+n.length,i),n=n.padEnd(o+n.length,i)}return n}var LE=Object.defineProperty,aJ=Object.getOwnPropertyDescriptor,Ua=(e,t)=>{for(var i in t)LE(e,i,{get:t[i],enumerable:!0})},I=(e,t,i,s)=>{for(var n=s>1?void 0:s?aJ(t,i):t,a=e.length-1,r;a>=0;a--)(r=e[a])&&(n=(s?r(t,i,n):r(n))||n);return s&&n&&LE(t,i,n),n},Cy=class{constructor(){this.destroyFns=[]}destroy(){for(const e of this.destroyFns)e()}},rJ=class{constructor(){this.modules=[],this.dependencies=new Map,this.modulesByOptionKey=new Map}register(...e){for(const t of e){this.registerDependencies(t);const i=this.modules.find(s=>t.type===s.type&&("optionsKey"in t&&"optionsKey"in s?t.optionsKey===s.optionsKey:!0)&&t.identifier===s.identifier);if(i){if(t.packageType==="enterprise"&&i.packageType==="community"){const s=this.modules.indexOf(i);this.modules.splice(s,1,t),"optionsKey"in t&&this.modulesByOptionKey.set(t.optionsKey,t)}}else this.modules.push(t),"optionsKey"in t&&this.modulesByOptionKey.set(t.optionsKey,t)}}hasEnterpriseModules(){return this.modules.some(e=>e.packageType==="enterprise")}*byType(...e){const t=new Set,i=this.modules.filter(a=>e.includes(a.type)),s=a=>{var o;const r=this.dependencies.get(a);return(o=r==null?void 0:r.flatMap(s).concat(r))!=null?o:[]},n=[];for(const a of i){const r="optionsKey"in a?a.optionsKey:a.contextKey;if(!t.has(r)){for(const o of s(r)){if(t.has(o))continue;const l=this.modulesByOptionKey.get(o);if(!l){n.push(o);continue}e.includes(l.type)&&(yield l,t.add(o))}yield a,t.add(r)}}if(n.length>0)throw new Error(`Could not resolve module dependencies: ${n}`)}registerDependencies(e){if(e.dependencies==null||e.dependencies.length===0)return;const t="optionsKey"in e?e.optionsKey:e.contextKey;this.dependencies.set(t,e.dependencies)}},kr=new rJ,nh={containsPoint:oJ,equals:lJ,isEmpty:cJ,normalize:hJ};function oJ(e,t,i){return t>=e.x&&t<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function lJ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function cJ(e){return e==null||e.height===0||e.width===0||isNaN(e.height)||isNaN(e.width)}function hJ(e){let{x:t,y:i,width:s,height:n}=e;return(s==null||s>0)&&(n==null||n>0)?e:(t!=null&&s!=null&&s<0&&(s=-s,t=t-s),i!=null&&n!=null&&n<0&&(n=-n,i=i-n),{x:t,y:i,width:s,height:n})}var Sy=Symbol("interpolate"),My=e=>e[Sy]!=null;function Dy(e,t,i,s=1/0){const n={nearest:void 0,distanceSquared:s};for(const a of i){const r=a.distanceSquared(e,t);if(r===0)return{nearest:a,distanceSquared:0};r<n.distanceSquared&&(n.nearest=a,n.distanceSquared=r)}return n}function dJ(e,t,i,s=1/0){var o,l;const{x:n=e,y:a=t}=(l=(o=i.transformPoint)==null?void 0:o.call(i,e,t))!=null?l:{},r={nearest:void 0,distanceSquared:s};for(const c of i.children){const{nearest:h,distanceSquared:d}=c.nearestSquared(n,a,r.distanceSquared);if(d===0)return{nearest:h,distanceSquared:d};d<r.distanceSquared&&(r.nearest=h,r.distanceSquared=d)}return r}var dg=class Rp{constructor(t,i,s,n){this.x=t,this.y=i,this.width=s,this.height=n}static fromDOMRect({x:t,y:i,width:s,height:n}){return new Rp(t,i,s,n)}static merge(t){let i=1/0,s=1/0,n=-1/0,a=-1/0;for(const r of t)r.x<i&&(i=r.x),r.y<s&&(s=r.y),r.x+r.width>n&&(n=r.x+r.width),r.y+r.height>a&&(a=r.y+r.height);return new Rp(i,s,n-i,a-s)}static nearestBox(t,i,s){return Dy(t,i,s)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:this.x+this.width,bottom:this.y+this.height,toJSON(){return{}}}}clone(){const{x:t,y:i,width:s,height:n}=this;return new Rp(t,i,s,n)}equals(t){return nh.equals(this,t)}containsPoint(t,i){return nh.containsPoint(this,t,i)}intersection(t){if(!this.collidesBBox(t))return;const i=we(t.x,this.x,t.x+t.width),s=we(t.y,this.y,t.y+t.height),n=we(t.x,this.x+this.width,t.x+t.width),a=we(t.y,this.y+this.height,t.y+t.height);return new Rp(i,s,n-i,a-s)}collidesBBox(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(t,i){if(this.containsPoint(t,i))return 0;const s=t-we(this.x,t,this.x+this.width),n=i-we(this.y,i,this.y+this.height);return s*s+n*n}shrink(t,i){if(typeof t=="number")this.applyMargin(t,i);else for(const s of Object.keys(t)){const n=t[s];typeof n=="number"&&this.applyMargin(n,s)}return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this}grow(t,i){if(typeof t=="number")this.applyMargin(-t,i);else for(const s of Object.keys(t)){const n=t[s];typeof n=="number"&&this.applyMargin(-n,s)}return this}applyMargin(t,i){switch(i){case"top":this.y+=t;case"bottom":this.height-=t;break;case"left":this.x+=t;case"right":this.width-=t;break;case"vertical":this.y+=t,this.height-=t*2;break;case"horizontal":this.x+=t,this.width-=t*2;break;case void 0:this.x+=t,this.y+=t,this.width-=t*2,this.height-=t*2;break}}translate(t,i){return this.x+=t,this.y+=i,this}[Sy](t,i){return new Rp(this.x*(1-i)+t.x*i,this.y*(1-i)+t.y*i,this.width*(1-i)+t.width*i,this.height*(1-i)+t.height*i)}};dg.zero=Object.freeze(new dg(0,0,0,0)),dg.NaN=Object.freeze(new dg(NaN,NaN,NaN,NaN));var ve=dg,uJ=2e3,PE=Date.now(),pJ=()=>{const e=Date.now()-PE;if(e>uJ){const t=(Math.floor(e/100)/10).toFixed(1);se.log(`**** ${t}s since last log message ****`)}PE=Date.now()},ct={create(...e){return Object.assign((...i)=>{ct.check(...e)&&(typeof i[0]=="function"&&(i=yy(i[0]())),pJ(),se.log(...i))},{check:()=>ct.check(...e),group:(i,s)=>ct.check(...e)?se.logGroup(i,s):s()})},check(...e){return e.length===0&&e.push(!0),yy(Ct("agChartsDebug")).some(i=>e.includes(i))},inDevelopmentMode(e){if(ct.check("dev"))return e()}};function EE({context:e,pixelRatio:t,width:i,height:s}){e.save(),e.resetTransform(),e.clearRect(0,0,Math.ceil(i*t),Math.ceil(s*t)),e.restore()}function RE(e){if(ct.check("canvas")){const t=e.save.bind(e),i=e.restore.bind(e);let s=0;Object.assign(e,{save(){t(),s++},restore(){if(s===0)throw new Error("AG Charts - Unable to restore() past depth 0");i(),s--},verifyDepthZero(){if(s!==0)throw new Error(`AG Charts - Save/restore depth is non-zero: ${s}`)}})}}function NE(e,t,i){return[Math.floor(e*i),Math.floor(t*i)]}var u0=class{constructor(e){const{width:t,height:i,pixelRatio:s,willReadFrequently:n=!1}=e;this.width=t,this.height=i,this.pixelRatio=s;const[a,r]=NE(t,i,s);this.canvas=new OffscreenCanvas(a,r),this.context=this.canvas.getContext("2d",{willReadFrequently:n}),this.context.setTransform(s,0,0,s,0,0),RE(this.context)}drawImage(e,t=0,i=0){return e.drawImage(this.canvas,t,i)}transferToImageBitmap(){return this.canvas.transferToImageBitmap()}resize(e,t,i){if(!(e>0&&t>0))return;const{canvas:s,context:n}=this;if(e!==this.width||t!==this.height||i!==this.pixelRatio){const[a,r]=NE(e,t,i);s.width=a,s.height=r}n.setTransform(i,0,0,i,0,0),this.width=e,this.height=t,this.pixelRatio=i}clear(){EE(this)}destroy(){this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0),this.canvas=null,this.context=null,Object.freeze(this)}},p0=Symbol("BREAK"),ug="__decorator_config",wy="__decorator_accessors";function gJ(e,t){g0(e,t).optional=!0}function g0(e,t){var c,h;if(Object.getOwnPropertyDescriptor(e,ug)==null&&Object.defineProperty(e,ug,{value:{}}),Object.getOwnPropertyDescriptor(e,wy)==null){const d=(c=Object.getPrototypeOf(e))==null?void 0:c[wy],u=(h=d==null?void 0:d.slice())!=null?h:[];Object.defineProperty(e,wy,{value:u})}const i=e[ug],s=t.toString();if(i[s]!=null)return i[s];i[s]={setters:[],getters:[],observers:[]};const n=Object.getOwnPropertyDescriptor(e,t);let a=n==null?void 0:n.get,r=n==null?void 0:n.set;if(a==null||r==null){const d=e[wy];let u=d.indexOf(t);u===-1&&(u=d.push(t)-1),a!=null||(a=function(){let p=this.__accessors;return p==null&&(p=d.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:p})),p[u]}),r!=null||(r=function(p){let g=this.__accessors;g==null&&(g=d.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:g})),g[u]=p})}return Object.defineProperty(e,t,{set:function(d){const{setters:u,observers:p}=i[s];let g;u.some(f=>f.length>2)&&(g=a.call(this));for(const f of u)if(d=f(this,t,d,g),d===p0)return;r.call(this,d);for(const f of p)f(this,d,g)},get:function(){let d=a.call(this);for(const u of i[s].getters)if(d=u(this,t,d),d===p0)return;return d},enumerable:!0,configurable:!1}),i[s]}function ah(e,t,i){return(s,n)=>{const a=g0(s,n);a.setters.push(e),t&&a.getters.unshift(t),i&&Object.assign(a,i)}}function OE(e){return(t,i)=>{g0(t,i).observers.push(e)}}function Ay(e){return typeof e!="undefined"&&ug in e}function rh(e){const t=new Set;for(;Ay(e);)t.add(e==null?void 0:e[ug]),e=Object.getPrototypeOf(e);return Array.from(t).flatMap(i=>Object.keys(i))}function FE(e){return rh(e).reduce((t,i)=>{var s;return t[i]=(s=e[i])!=null?s:null,t},{})}function dn(e,t){return Array.isArray(e)?!Array.isArray(t)||e.length!==t.length?!1:e.every((i,s)=>dn(i,t[s])):Lt(e)?Lt(t)?f0(e,t,dn):!1:e===t}function f0(e,t,i){if(Object.is(e,t))return!0;for(const s of Object.keys(t))if(!(s in e))return!1;for(const s of Object.keys(e))if(!(s in t)||!i(e[s],t[s]))return!1;return!0}function Je(...e){var i;const t={};for(const s of e){if(!Ve(s))continue;const n=Ay(s)?rh(s):Object.keys(s);for(const a of n)Lt(t[a])&&Lt(s[a])?t[a]=Je(t[a],s[a]):(i=t[a])!=null||(t[a]=s[a])}return t}function pg(...e){var i;const t={};for(const s of e){if(!Ve(s))continue;const n=Ay(s)?rh(s):Object.keys(s);for(const a of n)Lt(t[a])&&Lt(s[a])?t[a]=pg(t[a],s[a]):a in t||(i=t[a])!=null||(t[a]=s[a])}return t}function Iy(e,...t){return t&&Ke(e)?e.map(i=>Je(i,...t)):e}function BE(e,t){const i={};for(const[s,n]of Zt(e))i[s]=t(n,s,e);return i}function be(e,t){const i=b({},e);for(const s of t)delete i[s];return i}function Yd(e,t){return(Ke(t)?t:t.split(".")).reduce((s,n)=>s[n],e)}var m0=new Set(["__proto__","constructor","prototype"]);function y0(e,t,i){const s=Ke(t)?t.slice():t.split("."),n=s.pop();if(s.some(r=>m0.has(r)))return;const a=s.reduce((r,o)=>r[o],e);return a[n]=i,a[n]}function v0(e,t,i){if(i===void 0)return t;for(const s of e){const n=i[s];n!==void 0&&(t[s]=n)}return t}function oh(e){return e==null||typeof e!="object"||!Lt(e)||(Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{const i=e[t];i!==null&&(typeof i=="object"||typeof i=="function")&&!Object.isFrozen(i)&&oh(i)})),e}function _E(e,t){return Lt(e)&&t in e}function fJ(e,t){return _E(e,t)&&typeof e[t]=="string"}var Xd=(e,t)=>e===t;function he(e){return function(t,i){const s=`__${i}`;t[i]||mJ(t,i,s,e)}}function $n(e){return he(e)}function b0(e){const t=e!=null?e:{};return t.equals=fa,he(e)}function mJ(e,t,i,s){const{changeCb:n,convertor:a,checkDirtyOnAssignment:r=!1}=s!=null?s:{},o={changeCb:n,checkDirtyOnAssignment:r,convertor:a},l=bJ(i,vJ(yJ(xJ(i,o),o),o),o);Object.defineProperty(e,t,{set:l,get:function(){return this[i]},enumerable:!0,configurable:!0})}function yJ(e,t){const{convertor:i}=t;return i?function(s){e.call(this,i(s))}:e}var GE=Symbol("no-change");function vJ(e,t){const{changeCb:i}=t;return i?function(s){const n=e.call(this,s);return n!==GE&&i.call(this,this),n}:e}function bJ(e,t,i){const{checkDirtyOnAssignment:s}=i;return s?function(n){const a=t.call(this,n);return(n==null?void 0:n._dirty)===!0&&this.markDirty(e),a}:t}function xJ(e,t){const{equals:i=Xd}=t;return function(s){const n=this[e];return i(s,n)?GE:(this[e]=s,this.onChangeDetection(e),s)}}var zE=(e=>(e[e.All=0]="All",e[e.None=1]="None",e))(zE||{}),gg=class OT{constructor(t){var i,s,n;this.serialNumber=OT._nextSerialNumber++,this.childNodeCounts={groups:0,nonGroups:0,thisComplexity:0,complexity:0},this.id=Hs(this),this.pointerEvents=0,this.scene=void 0,this._dirty=!0,this.dirtyZIndex=!1,this.isContainerNode=!1,this.visible=!0,this.zIndex=0,this.name=t==null?void 0:t.name,this.tag=(i=t==null?void 0:t.tag)!=null?i:NaN,this.zIndex=(s=t==null?void 0:t.zIndex)!=null?s:0,((n=t==null?void 0:t.debugDirty)!=null?n:OT._debugEnabled)&&(this._debugDirtyProperties=new Map([["__first__",[]]]))}static toSVG(t,i,s){var r,o;const n=t==null?void 0:t.toSVG();if(n==null||!n.elements.length&&!((r=n.defs)!=null&&r.length))return;const a=Ti("svg");if(a.setAttribute("width",String(i)),a.setAttribute("height",String(s)),a.setAttribute("viewBox",`0 0 ${i} ${s}`),(o=n.defs)!=null&&o.length){const l=Ti("defs");l.append(...n.defs),a.append(l)}return a.append(...n.elements),a.outerHTML}static*extractBBoxes(t,i){for(const s of t)if(!i||s.visible&&!s.transitionOut){const n=s.getBBox();n&&(yield n)}}get datum(){return this._datum}set datum(t){this._datum!==t&&(this._previousDatum=this._datum,this._datum=t)}get previousDatum(){return this._previousDatum}get layerManager(){var t;return(t=this.scene)==null?void 0:t.layersManager}get imageLoader(){var t;return(t=this.scene)==null?void 0:t.imageLoader}get dirty(){return this._dirty}closestDatum(){for(const{datum:t}of this.traverseUp(!0))if(t!=null)return t}preRender(t,i=1){this.childNodeCounts.groups=0,this.childNodeCounts.nonGroups=1,this.childNodeCounts.complexity=i,this.childNodeCounts.thisComplexity=i;for(const s of this.children()){const n=s.preRender(t);this.childNodeCounts.groups+=n.groups,this.childNodeCounts.nonGroups+=n.nonGroups,this.childNodeCounts.complexity+=n.complexity}return this.childNodeCounts}render(t){var s,n;const{stats:i}=t;if(this._dirty=!1,this.debugDirtyProperties(),t.debugNodeSearch){const a=(s=this.name)!=null?s:this.id;t.debugNodeSearch.some(r=>typeof r=="string"?r===a:r.test(a))&&(t.debugNodes[(n=this.name)!=null?n:this.id]=this)}i&&(i.nodesRendered++,i.opsPerformed+=this.childNodeCounts.thisComplexity)}setScene(t){var i;this.scene=t,this._debug=(i=t==null?void 0:t.layersManager)==null?void 0:i.debug;for(const s of this.children())s.setScene(t)}sortChildren(t){if(this.dirtyZIndex=!1,!this.childNodes)return;const i=[...this.childNodes].sort(t);this.childNodes.clear();for(const s of i)this.childNodes.add(s)}*traverseUp(t){let i=this;for(t&&(yield i);i=i.parentNode;)yield i}*children(){if(this.childNodes)for(const t of this.childNodes)yield t}*descendants(){for(const t of this.children())yield t,yield*UC(t.descendants())}isLeaf(){var t;return!((t=this.childNodes)!=null&&t.size)}isRoot(){return!this.parentNode}append(t){var i,s;(i=this.childNodes)!=null||(this.childNodes=new Set);for(const n of jQ(t))(s=n.parentNode)==null||s.removeChild(n),this.childNodes.add(n),n.parentNode=this,n.setScene(this.scene);this.invalidateCachedBBox(),this.dirtyZIndex=!0,this.markDirty()}appendChild(t){return this.append(t),t}removeChild(t){var i,s,n;if(!((i=this.childNodes)!=null&&i.delete(t)))throw new Error(`AG Charts - internal error, unknown child node ${(s=t.name)!=null?s:t.id} in $${(n=this.name)!=null?n:this.id}`);delete t.parentNode,t.setScene(),this.invalidateCachedBBox(),this.dirtyZIndex=!0,this.markDirty()}remove(){var t;(t=this.parentNode)==null||t.removeChild(this)}clear(){var t;for(const i of this.children())delete i.parentNode,i.setScene();(t=this.childNodes)==null||t.clear(),this.invalidateCachedBBox()}destroy(){var t;(t=this.parentNode)==null||t.removeChild(this)}setProperties(t,i){if(i)for(const s of i)this[s]=t[s];else Object.assign(this,t);return this}containsPoint(t,i){return!1}pickNode(t,i){if(!(!this.visible||this.pointerEvents===1||!this.containsPoint(t,i))){if(this.childNodes!=null&&this.childNodes.size!==0){const s=[...this.children()];for(let n=s.length-1;n>=0;n--){const a=s[n].pickNode(t,i);if(a)return a}}else if(!this.isContainerNode)return this}}pickNodes(t,i,s=[]){if(!this.visible||this.pointerEvents===1||!this.containsPoint(t,i))return s;this.isContainerNode||s.push(this);for(const n of this.children())n.pickNodes(t,i,s);return s}invalidateCachedBBox(){var t;this.cachedBBox!=null&&(this.cachedBBox=void 0,(t=this.parentNode)==null||t.invalidateCachedBBox())}getBBox(){return this.cachedBBox==null&&(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}onChangeDetection(t){this.markDirty(t)}markDirty(t){const{_dirty:i}=this;t!=null&&this._debugDirtyProperties&&this.markDebugProperties(t),!(this.cachedBBox==null&&i)&&(this.invalidateCachedBBox(),this._dirty=!0,this.parentNode&&this.parentNode.markDirty())}markClean(){if(this._dirty){this._dirty=!1,this.debugDirtyProperties();for(const t of this.children())t.markClean()}}markDebugProperties(t){var n,a,r,o,l;const i=(a=(n=this._debugDirtyProperties)==null?void 0:n.get(t))!=null?a:[],s=(o=(r=new Error().stack)==null?void 0:r.split(`
`).filter(c=>c!=="Error"&&!c.includes(".markDebugProperties")&&!c.includes(".markDirty")&&!c.includes("Object.assign ")&&!c.includes(`${this.constructor.name}.`)))!=null?o:"unknown";i.push(s[0].replace(" at ","").trim()),(l=this._debugDirtyProperties)==null||l.set(t,i)}debugDirtyProperties(){this._debugDirtyProperties!=null&&(this._debugDirtyProperties.has("__first__")||this._debugDirtyProperties.forEach((t,i)=>{t.length>1&&(console.groupCollapsed(`Property changed multiple times before render: ${this.constructor.name}.${i} (${t.length}x)`),t.forEach(s=>console.log(s)),console.groupEnd())}),this._debugDirtyProperties.clear())}onZIndexChange(){const{parentNode:t}=this;t&&(t.dirtyZIndex=!0)}toSVG(){}};gg._nextSerialNumber=0,gg._debugEnabled=!1,I([he()],gg.prototype,"visible",2),I([$n({equals:dn,changeCb:e=>e.onZIndexChange()})],gg.prototype,"zIndex",2);var xo=gg,ya=Math.PI*2,fg=Math.PI/2;function bi(e){return e%=ya,e+=ya,e%=ya,e}function CJ(e){return e%=ya,e+=ya,e!==ya&&(e%=ya),e}function mg(e){return e%=ya,e<-Math.PI?e+=ya:e>=Math.PI&&(e-=ya),e}function Ll(e,t,i){const s=bi(e),n=bi(t),a=bi(i);return n<a?n<=s&&s<=a:n>a?n<=s||s<=a:!0}function Vi(e){return e/180*Math.PI}function SJ(e){return e/Math.PI*180}function Ty(e,t){return e=bi(e),t=bi(t),t-e+(e>t?ya:0)}function VE(e){const t=bi(e);return t<=fg?t/fg:t<=Math.PI?(Math.PI-t)/fg:t<=1.5*Math.PI?(t-Math.PI)/fg:(ya-t)/fg}function x0(e,t,i){const s=VE(i);return e*s+t*Math.abs(1-s)}function Co(e){return e?bi(Vi(e)):0}var lh=(e,t,i)=>e*(1-i)+t*i,C0=e=>{const t=e<0?-1:1,i=Math.abs(e);return i<=.04045?e/12.92:t*((i+.055)/1.055)**2.4},S0=e=>{const t=e<0?-1:1,i=Math.abs(e);return i>.0031308?t*(1.055*i**(1/2.4)-.055):12.92*e},jE=class pt{constructor(t,i,s,n=1){this.r=we(0,t||0,1),this.g=we(0,i||0,1),this.b=we(0,s||0,1),this.a=we(0,n||0,1)}static validColorString(t){return t.indexOf("#")>=0?!!pt.parseHex(t):t.indexOf("rgb")>=0?!!pt.stringToRgba(t):pt.nameToHex.has(t.toLowerCase())}static fromString(t){if(t.indexOf("#")>=0)return pt.fromHexString(t);const i=pt.nameToHex.get(t.toLowerCase());if(i)return pt.fromHexString(i);if(t.indexOf("rgb")>=0)return pt.fromRgbaString(t);throw new Error(`Invalid color string: '${t}'`)}static parseHex(t){t=t.replace(/ /g,"").slice(1);let i;switch(t.length){case 6:case 8:i=[];for(let s=0;s<t.length;s+=2)i.push(parseInt(`${t[s]}${t[s+1]}`,16));break;case 3:case 4:i=t.split("").map(s=>parseInt(s,16)).map(s=>s+s*16);break}if((i==null?void 0:i.length)>=3&&i.every(s=>s>=0))return i.length===3&&i.push(255),i}static fromHexString(t){const i=pt.parseHex(t);if(i){const[s,n,a,r]=i;return new pt(s/255,n/255,a/255,r/255)}throw new Error(`Malformed hexadecimal color string: '${t}'`)}static stringToRgba(t){let i=-1,s=-1;for(let o=0;o<t.length;o++){const l=t[o];if(i===-1&&l==="(")i=o;else if(l===")"){s=o;break}}if(i===-1||s===-1)return;const a=t.substring(i+1,s).split(","),r=[];for(let o=0;o<a.length;o++){const l=a[o];let c=parseFloat(l);if(!Number.isFinite(c))return;l.indexOf("%")>=0?(c=we(0,c,100),c/=100):o===3?c=we(0,c,1):(c=we(0,c,255),c/=255),r.push(c)}return r}static fromRgbaString(t){const i=pt.stringToRgba(t);if(i){if(i.length===3)return new pt(i[0],i[1],i[2]);if(i.length===4)return new pt(i[0],i[1],i[2],i[3])}throw new Error(`Malformed rgb/rgba color string: '${t}'`)}static fromArray(t){if(t.length===4)return new pt(t[0],t[1],t[2],t[3]);if(t.length===3)return new pt(t[0],t[1],t[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(t,i,s,n=1){const a=pt.HSBtoRGB(t,i,s);return new pt(a[0],a[1],a[2],n)}static fromHSL(t,i,s,n=1){const a=pt.HSLtoRGB(t,i,s);return new pt(a[0],a[1],a[2],n)}static fromOKLCH(t,i,s,n=1){const a=pt.OKLCHtoRGB(t,i,s);return new pt(a[0],a[1],a[2],n)}static padHex(t){return t.length===1?"0"+t:t}toHexString(){let t="#"+pt.padHex(Math.round(this.r*255).toString(16))+pt.padHex(Math.round(this.g*255).toString(16))+pt.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(t+=pt.padHex(Math.round(this.a*255).toString(16))),t}toRgbaString(t=3){const i=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],s=Math.pow(10,t);return this.a!==1?(i.push(Math.round(this.a*s)/s),`rgba(${i.join(", ")})`):`rgb(${i.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return pt.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(t,i,s){const n=C0(t),a=C0(i),r=C0(s),o=Math.cbrt(.4122214708*n+.5363325363*a+.0514459929*r),l=Math.cbrt(.2119034982*n+.6806995451*a+.1073969566*r),c=Math.cbrt(.0883024619*n+.2817188376*a+.6299787005*r),h=.2104542553*o+.793617785*l-.0040720468*c,d=1.9779984951*o-2.428592205*l+.4505937099*c,u=.0259040371*o+.7827717662*l-.808675766*c,p=Math.atan2(u,d)*180/Math.PI,g=h,f=Math.hypot(d,u),y=p>=0?p:p+360;return[g,f,y]}static OKLCHtoRGB(t,i,s){const n=t,a=i*Math.cos(s*Math.PI/180),r=i*Math.sin(s*Math.PI/180),o=(n+.3963377774*a+.2158037573*r)**3,l=(n-.1055613458*a-.0638541728*r)**3,c=(n-.0894841775*a-1.291485548*r)**3,h=4.0767416621*o-3.3077115913*l+.2309699292*c,d=-1.2684380046*o+2.6097574011*l-.3413193965*c,u=-.0041960863*o-.7034186147*l+1.707614701*c,p=S0(h),g=S0(d),f=S0(u);return[p,g,f]}static RGBtoHSL(t,i,s){const n=Math.min(t,i,s),a=Math.max(t,i,s),r=(a+n)/2;let o,l;if(a===n)o=0,l=0;else{const c=a-n;l=r>.5?c/(2-a-n):c/(a+n),a===t?o=(i-s)/c+(i<s?6:0):a===i?o=(s-t)/c+2:o=(t-i)/c+4,o*=360/6}return[o,l,r]}static HSLtoRGB(t,i,s){if(t=(t%360+360)%360,i===0)return[s,s,s];const n=s<.5?s*(1+i):s+i-s*i,a=2*s-n;function r(h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?a+(n-a)*6*h:h<1/2?n:h<2/3?a+(n-a)*(2/3-h)*6:a}const o=r(t/360+1/3),l=r(t/360),c=r(t/360-1/3);return[o,l,c]}static RGBtoHSB(t,i,s){const n=Math.min(t,i,s),a=Math.max(t,i,s),r=a===0?0:(a-n)/a;let o=0;if(n!==a){const l=a-n,c=(a-t)/l,h=(a-i)/l,d=(a-s)/l;t===a?o=d-h:i===a?o=2+c-d:o=4+h-c,o/=6,o<0&&(o=o+1)}return[o*360,r,a]}static HSBtoRGB(t,i,s){t=(t%360+360)%360/360;let n=0,a=0,r=0;if(i===0)n=a=r=s;else{const o=(t-Math.floor(t))*6,l=o-Math.floor(o),c=s*(1-i),h=s*(1-i*l),d=s*(1-i*(1-l));switch(o>>0){case 0:n=s,a=d,r=c;break;case 1:n=h,a=s,r=c;break;case 2:n=c,a=s,r=d;break;case 3:n=c,a=h,r=s;break;case 4:n=d,a=c,r=s;break;case 5:n=s,a=c,r=h;break}}return[n,a,r]}static mix(t,i,s){return new pt(lh(t.r,i.r,s),lh(t.g,i.g,s),lh(t.b,i.b,s),lh(t.a,i.a,s))}static lighten(t,i){const s=pt.RGBtoOKLCH(t.r,t.g,t.b);return pt.fromOKLCH(we(0,s[0]+i,1),s[1],s[2])}static darken(t,i){const s=pt.RGBtoOKLCH(t.r,t.g,t.b);return pt.fromOKLCH(we(0,s[0]-i,1),s[1],s[2])}static interpolate(t,i){const s=1/(t.length-1),n=t.map(a=>pt.RGBtoOKLCH(a.r,a.g,a.b));return Array.from({length:i},(a,r)=>{const o=r/(i-1),l=t.length<=2?0:Math.min(Math.floor(o*(t.length-1)),t.length-2),c=(o-l*s)/s,h=n[l],d=n[l+1];return pt.fromOKLCH(lh(h[0],d[0],c),lh(h[1],d[1],c),lh(h[2],d[2],c))})}};jE.nameToHex=new Map([["aliceblue","#F0F8FF"],["antiquewhite","#FAEBD7"],["aqua","#00FFFF"],["aquamarine","#7FFFD4"],["azure","#F0FFFF"],["beige","#F5F5DC"],["bisque","#FFE4C4"],["black","#000000"],["blanchedalmond","#FFEBCD"],["blue","#0000FF"],["blueviolet","#8A2BE2"],["brown","#A52A2A"],["burlywood","#DEB887"],["cadetblue","#5F9EA0"],["chartreuse","#7FFF00"],["chocolate","#D2691E"],["coral","#FF7F50"],["cornflowerblue","#6495ED"],["cornsilk","#FFF8DC"],["crimson","#DC143C"],["cyan","#00FFFF"],["darkblue","#00008B"],["darkcyan","#008B8B"],["darkgoldenrod","#B8860B"],["darkgray","#A9A9A9"],["darkgreen","#006400"],["darkgrey","#A9A9A9"],["darkkhaki","#BDB76B"],["darkmagenta","#8B008B"],["darkolivegreen","#556B2F"],["darkorange","#FF8C00"],["darkorchid","#9932CC"],["darkred","#8B0000"],["darksalmon","#E9967A"],["darkseagreen","#8FBC8F"],["darkslateblue","#483D8B"],["darkslategray","#2F4F4F"],["darkslategrey","#2F4F4F"],["darkturquoise","#00CED1"],["darkviolet","#9400D3"],["deeppink","#FF1493"],["deepskyblue","#00BFFF"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1E90FF"],["firebrick","#B22222"],["floralwhite","#FFFAF0"],["forestgreen","#228B22"],["fuchsia","#FF00FF"],["gainsboro","#DCDCDC"],["ghostwhite","#F8F8FF"],["gold","#FFD700"],["goldenrod","#DAA520"],["gray","#808080"],["green","#008000"],["greenyellow","#ADFF2F"],["grey","#808080"],["honeydew","#F0FFF0"],["hotpink","#FF69B4"],["indianred","#CD5C5C"],["indigo","#4B0082"],["ivory","#FFFFF0"],["khaki","#F0E68C"],["lavender","#E6E6FA"],["lavenderblush","#FFF0F5"],["lawngreen","#7CFC00"],["lemonchiffon","#FFFACD"],["lightblue","#ADD8E6"],["lightcoral","#F08080"],["lightcyan","#E0FFFF"],["lightgoldenrodyellow","#FAFAD2"],["lightgray","#D3D3D3"],["lightgreen","#90EE90"],["lightgrey","#D3D3D3"],["lightpink","#FFB6C1"],["lightsalmon","#FFA07A"],["lightseagreen","#20B2AA"],["lightskyblue","#87CEFA"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#B0C4DE"],["lightyellow","#FFFFE0"],["lime","#00FF00"],["limegreen","#32CD32"],["linen","#FAF0E6"],["magenta","#FF00FF"],["maroon","#800000"],["mediumaquamarine","#66CDAA"],["mediumblue","#0000CD"],["mediumorchid","#BA55D3"],["mediumpurple","#9370DB"],["mediumseagreen","#3CB371"],["mediumslateblue","#7B68EE"],["mediumspringgreen","#00FA9A"],["mediumturquoise","#48D1CC"],["mediumvioletred","#C71585"],["midnightblue","#191970"],["mintcream","#F5FFFA"],["mistyrose","#FFE4E1"],["moccasin","#FFE4B5"],["navajowhite","#FFDEAD"],["navy","#000080"],["oldlace","#FDF5E6"],["olive","#808000"],["olivedrab","#6B8E23"],["orange","#FFA500"],["orangered","#FF4500"],["orchid","#DA70D6"],["palegoldenrod","#EEE8AA"],["palegreen","#98FB98"],["paleturquoise","#AFEEEE"],["palevioletred","#DB7093"],["papayawhip","#FFEFD5"],["peachpuff","#FFDAB9"],["peru","#CD853F"],["pink","#FFC0CB"],["plum","#DDA0DD"],["powderblue","#B0E0E6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#FF0000"],["rosybrown","#BC8F8F"],["royalblue","#4169E1"],["saddlebrown","#8B4513"],["salmon","#FA8072"],["sandybrown","#F4A460"],["seagreen","#2E8B57"],["seashell","#FFF5EE"],["sienna","#A0522D"],["silver","#C0C0C0"],["skyblue","#87CEEB"],["slateblue","#6A5ACD"],["slategray","#708090"],["slategrey","#708090"],["snow","#FFFAFA"],["springgreen","#00FF7F"],["steelblue","#4682B4"],["tan","#D2B48C"],["teal","#008080"],["thistle","#D8BFD8"],["tomato","#FF6347"],["transparent","#00000000"],["turquoise","#40E0D0"],["violet","#EE82EE"],["wheat","#F5DEB3"],["white","#FFFFFF"],["whitesmoke","#F5F5F5"],["yellow","#FFFF00"],["yellowgreen","#9ACD32"]]);var yt=jE,ky=class{ticks(e,t,i){}niceDomain(e,t=this.domain){return t}tickFormatter(e){}datumFormatter(e){}get bandwidth(){}get step(){}get inset(){}},yg=(e,t)=>{const i=Symbol(String(t));e[i]=void 0,Object.defineProperty(e,t,{get(){return this[i]},set(s){this[i]!==s&&(this[i]=s,this.invalid=!0)},enumerable:!0,configurable:!1})},HE=e=>{const t=yt.fromString(e),[i,s,n]=yt.RGBtoOKLCH(t.r,t.g,t.b);return{l:i,c:s,h:n,a:t.a}},M0=1e-6,WE=e=>e.c<M0||e.l<M0||e.l>1-M0,MJ=(e,t,i)=>{i=we(0,i,1);let s;if(WE(e))s=t.h;else if(WE(t))s=e.h;else{const o=e.h;let l=t.h;const c=t.h-e.h;c>180?l-=360:c<-180&&(l+=360),s=o*(1-i)+l*i}const n=e.c*(1-i)+t.c*i,a=e.l*(1-i)+t.l*i,r=e.a*(1-i)+t.a*i;return yt.fromOKLCH(a,n,s,r)},Zd=class extends ky{constructor(){super(...arguments),this.type="color",this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(HE)}update(){const{domain:e,range:t}=this;e.length<2&&(se.warnOnce("`colorDomain` should have at least 2 values."),e.length===0?e.push(0,1):e.length===1&&e.push(e[0]+1));for(let i=1;i<e.length;i++){const s=e[i-1],n=e[i];if(s>=n){se.warnOnce("`colorDomain` values should be supplied in ascending order."),e.sort((a,r)=>a-r);break}}if(t.length<e.length)for(let i=t.length;i<e.length;i++)t.push(t.length>0?t[0]:"black");this.parsedRange=this.range.map(HE)}normalizeDomains(...e){return{domain:e.flat(),animatable:!0}}toDomain(){}convert(e){this.refresh();const{domain:t,range:i,parsedRange:s}=this,n=t[0],a=t.at(-1),r=i[0],o=i[i.length-1];if(e<=n)return r;if(e>=a)return o;let l,c;if(t.length===2){const u=(e-n)/(a-n),p=1/(i.length-1);l=i.length<=2?0:Math.min(Math.floor(u*(i.length-1)),i.length-2),c=(u-l*p)/p}else{for(l=0;l<t.length-2&&!(e<t[l+1]);l++);const u=t[l],p=t[l+1];c=(e-u)/(p-u)}const h=s[l],d=s[l+1];return MJ(h,d,c).toRgbaString()}invert(){}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&se.warnOnce("Expected update to not invalidate scale"))}};I([yg],Zd.prototype,"domain",2),I([yg],Zd.prototype,"range",2);var Ly=class{constructor(e,t=[],i){this.colorSpace=e,this.stops=t,this.bbox=i,this._cache=void 0}createGradient(e,t,i){var h;const s=(h=this.bbox)!=null?h:t;if(isNaN(s.x)||isNaN(s.y))return;if(this._cache!=null&&this._cache.ctx===e&&this._cache.bbox.equals(s))return this._cache.gradient;const{stops:n,colorSpace:a}=this;if(n.length===0)return;if(n.length===1)return n[0].color;let r=this.createCanvasGradient(e,s,i);if(r==null)return;const o=a==="oklch",l=.05;let c=n[0];r.addColorStop(c.stop,c.color);for(let d=1;d<n.length;d+=1){const u=n[d];if(o){const p=new Zd;p.domain=[c.stop,u.stop],p.range=[c.color,u.color];for(let g=c.stop+l;g<u.stop;g+=l)r.addColorStop(g,p.convert(g))}r.addColorStop(u.stop,u.color),c=u}return"createPattern"in r&&(r=r.createPattern()),this._cache={ctx:e,bbox:s,gradient:r},r}toSvg(e){var s;const t=(s=this.bbox)!=null?s:e,i=this.createSvgGradient(t);return this.stops.forEach(({stop:n,color:a})=>{const r=Ti("stop");r.setAttribute("offset",`${n}`),r.setAttribute("stop-color",`${a}`),i.appendChild(r)}),i}},UE=class extends Ly{constructor(e,t,i=0,s){super(e,t,s),this.angle=i}createCanvasGradient(e,t,i){var l,c;const{angle:n}=this,a=Co(n+-90),r=(l=i==null?void 0:i.centerX)!=null?l:t.x+t.width*.5,o=(c=i==null?void 0:i.centerY)!=null?c:t.y+t.height*.5;return e.createConicGradient(a,r,o)}createSvgGradient(e){return Ti("linearGradient")}},KE=class extends Ly{constructor(e,t,i=0,s){super(e,t,s),this.angle=i}getGradientPoints(e){const{angle:i}=this,s=Co(i+90),n=Math.cos(s),a=Math.sin(s),r=e.width,o=e.height,l=e.x+r*.5,c=e.y+o*.5,h=Math.sqrt(o*o+r*r)/2,d=Math.atan2(o,r);let u;s<Math.PI/2?u=s:s<Math.PI?u=Math.PI-s:s<1.5*Math.PI?u=s-Math.PI:u=2*Math.PI-s;const p=h*Math.abs(Math.cos(u-d));return{x0:l+n*p,y0:c+a*p,x1:l-n*p,y1:c-a*p}}createCanvasGradient(e,t){const{x0:i,y0:s,x1:n,y1:a}=this.getGradientPoints(t);if(!(isNaN(i)||isNaN(s)||isNaN(n)||isNaN(a)))return e.createLinearGradient(i,s,n,a)}createSvgGradient(e){const{x0:t,y0:i,x1:s,y1:n}=this.getGradientPoints(e),a=Ti("linearGradient");return a.setAttribute("x1",String(t)),a.setAttribute("y1",String(i)),a.setAttribute("x2",String(s)),a.setAttribute("y2",String(n)),a.setAttribute("gradientUnits","userSpaceOnUse"),a}},DJ=class extends Ly{constructor(e,t,i){super(e,t,i)}createCanvasGradient(e,t,i){var o,l,c,h;const s=(o=i==null?void 0:i.centerX)!=null?o:t.x+t.width*.5,n=(l=i==null?void 0:i.centerY)!=null?l:t.y+t.height*.5,a=(c=i==null?void 0:i.innerRadius)!=null?c:0,r=(h=i==null?void 0:i.outerRadius)!=null?h:Math.hypot(t.width*.5,t.height*.5)/Math.SQRT2;return e.createRadialGradient(s,n,a,s,n,r)}createSvgGradient(e){const t=e.x+e.width*.5,i=e.y+e.height*.5,s=Ti("radialGradient");return s.setAttribute("cx",String(t)),s.setAttribute("cy",String(i)),s.setAttribute("r",String(Math.hypot(e.width*.5,e.height*.5)/Math.SQRT2)),s.setAttribute("gradientUnits","userSpaceOnUse"),s}},P=gJ,Be=class{handleUnknownProperties(e,t){}set(e){var s;const{className:t=this.constructor.name}=this.constructor;if(typeof e!="object")return se.warn(`unable to set ${t} - expecting a properties object`),this;const i=new Set(Object.keys(e));for(const n of rh(this))if(i.has(n)){const a=e[n],r=this;if(qd(r[n]))if(r[n]instanceof vg){const o=r[n].reset(a);o!=null?r[n]=o:se.warn(`unable to set [${n}] - expecting a properties array`)}else r[n].set(a);else Lt(a)?r[n]=pg(a,(s=r[n])!=null?s:{}):r[n]=a;i.delete(n)}this.handleUnknownProperties(i,e);for(const n of i)se.warn(`unable to set [${n}] in ${t} - property is unknown`);return this}toJson(){return rh(this).reduce((e,t)=>{const i=this[t];return e[t]=qd(i)?i.toJson():i,e},{})}},vg=class Cj extends Array{constructor(t,...i){super(i.length);const n=(a=>{var r,o;return!!((o=(r=a==null?void 0:a.prototype)==null?void 0:r.constructor)!=null&&o.name)})(t)?a=>new t().set(a):t;Object.defineProperty(this,"itemFactory",{value:n,enumerable:!1,configurable:!1}),this.set(i)}set(t){if(Ke(t)){this.length=t.length;for(let i=0;i<t.length;i++)this[i]=this.itemFactory(t[i])}return this}reset(t){if(Array.isArray(t))return new Cj(this.itemFactory,...t)}toJson(){return this.map(t=>{var i,s;return(s=(i=t==null?void 0:t.toJson)==null?void 0:i.call(t))!=null?s:t})}};function qd(e){return e instanceof Be||e instanceof vg}var D0=class extends Be{constructor(){super(...arguments),this.color="black"}};I([P],D0.prototype,"stop",2),I([P],D0.prototype,"color",2);function wJ(e){let t;for(const i of e)if((i==null?void 0:i.stop)!=null){if(t!=null&&i.stop<t)return!1;t=i.stop}return!0}function $E(e){return e.flatMap((t,i)=>{var a;const{stop:s}=t,n=(a=e.at(i+1))==null?void 0:a.color;return n!=null?[t,{stop:s,color:n}]:[t]})}function AJ(e,t){const i=t==="discrete"?1:0,s=e.map((n,a,{length:r})=>({stop:(a+i)/(r-1+i),color:n}));return t==="discrete"?$E(s):s}function YE(e,t,i,s="continuous"){var g,f,y,v;const n=e.map(x=>typeof x=="string"?{color:x}:x);if(n.length===0)return AJ(t,s);if(!wJ(n))return se.warnOnce("[fills] must have the stops defined in ascending order"),[];const a=Math.min(...i),r=Math.max(...i),o=s==="discrete",l=new Float64Array(n.length);let c=0,h=-1;for(let x=0;x<n.length;x+=1){const S=n[x];if(x>=h){h=n.length-1;for(let D=x+1;D<n.length;D+=1)if(((g=n[D])==null?void 0:g.stop)!=null){h=D;break}}let M=S==null?void 0:S.stop;if(M==null){const D=(f=n[c])==null?void 0:f.stop,A=(y=n[h])==null?void 0:y.stop,w=D!=null?D:a,T=A!=null?A:r,k=o&&D==null?1:0;M=w+(T-w)*(x-c+k)/(h-c+k)}else c=x;l[x]=Math.max(0,Math.min(1,(M-a)/(r-a)))}let d=(v=n.find(x=>x.color!=null))==null?void 0:v.color,u;const p=n.map((x,S)=>{let M=x==null?void 0:x.color;const D=l[S];return M!=null?d=M:d!=null?M=d:(u==null&&(u=new Zd,u.domain=[0,1],u.range=t),M=u.convert(D)),{stop:D,color:M}});return s==="discrete"?$E(p):p}var IJ=class{constructor(e,t){var i,s,n,a,r;this.imageLoader=e,this._cache=void 0,this.url=t.url,this.backgroundFill=(i=t.backgroundFill)!=null?i:"black",this.backgroundFillOpacity=(s=t.backgroundFillOpacity)!=null?s:1,this.repeat=(n=t.repeat)!=null?n:"no-repeat",this.width=t.width,this.height=t.height,this.fit=(a=t.fit)!=null?a:"stretch",this.rotation=(r=t.rotation)!=null?r:0}createCanvasImage(e,t,i,s){if(!t)return null;const[n,a]=this.getSize(t.width,t.height,i,s);return n<1||a<1?(se.warnOnce("Image fill is too small to render, ignoring."),null):e.createPattern(t,this.repeat)}getSize(e,t,i,s){const{fit:n}=this;let a=e,r=t,o=1;const l=i/s,c=e/t;return n==="stretch"||e===0||t===0?(a=i,r=s):n==="contain"?o=c>l?i/e:s/t:n==="cover"&&(o=c>l?s/t:i/e),[Math.max(1,a*o),Math.max(1,r*o)]}setImageTransform(e,t){var M;if(typeof e=="string")return;const{url:i,rotation:s,width:n,height:a}=this,r=(M=this.imageLoader)==null?void 0:M.loadImage(i);if(!r)return;const o=Co(s),l=Math.cos(o),c=Math.sin(o),[h,d]=this.getSize(r.width,r.height,n!=null?n:t.width,a!=null?a:t.height),u=h/r.width,p=d/r.height,g=t.x+t.width/2,f=t.y+t.height/2,y=l*h-c*d,v=c*h+l*d,x=y/2,S=v/2;e==null||e.setTransform(new DOMMatrix([l*u,c*p,-c*u,l*p,g-x,f-S]))}createPattern(e,t,i,s){var c,h,d;const n=(c=this.width)!=null?c:t,a=(h=this.height)!=null?h:i,r=this._cache;if(r!=null&&r.ctx===e&&r.width===n&&r.height===a)return r.pattern;const o=(d=this.imageLoader)==null?void 0:d.loadImage(this.url,s),l=this.createCanvasImage(e,o,n,a);return l==null?this.backgroundFill:(this._cache={ctx:e,pattern:l,width:n,height:a},l)}toSvg(e,t){const{url:i,rotation:s,backgroundFill:n,backgroundFillOpacity:a}=this,{x:r,y:o,width:l,height:c}=e,h=Ti("pattern");h.setAttribute("viewBox",`0 0 ${l} ${c}`),h.setAttribute("x",String(r)),h.setAttribute("y",String(o)),h.setAttribute("width",String(l)),h.setAttribute("height",String(c)),h.setAttribute("patternUnits","userSpaceOnUse");const d=Ti("rect");d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("width",String(l)),d.setAttribute("height",String(c)),d.setAttribute("fill",n),d.setAttribute("fill-opacity",String(a)),h.appendChild(d);const u=Ti("image");return u.setAttribute("href",i),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(l)),u.setAttribute("height",String(c)),u.setAttribute("preserveAspectRatio","none"),u.setAttribute("transform",`scale(${1/t}) rotate(${s}, ${l/2}, ${c/2})`),h.appendChild(u),h}},TJ=/^[\t\n\f\r ]*([achlmqstvz])[\t\n\f\r ]*/i,Rt=/^[+-]?((\d*\.\d+)|(\d+\.)|(\d+))(e[+-]?\d+)?/i,kJ=/[\t\n\f\r ]*,?[\t\n\f\r ]*/,XE=/^[01]/,LJ={z:[],h:[Rt],v:[Rt],m:[Rt,Rt],l:[Rt,Rt],t:[Rt,Rt],s:[Rt,Rt,Rt,Rt],q:[Rt,Rt,Rt,Rt],c:[Rt,Rt,Rt,Rt,Rt,Rt],a:[Rt,Rt,Rt,XE,XE,Rt,Rt]};function PJ(e){if(!e)return;const t=[];let i=0,s;for(;i<e.length;){const n=TJ.exec(e.slice(i));let a;if(n==null){if(!s){se.warnOnce(`Invalid SVG path, error at index ${i}: Missing command.`);return}a=s}else a=n[1],i+=n[0].length;const r=EJ(a,e,i);if(!r)return;i=r[0],s=a,t.push(r[1])}return t}function EJ(e,t,i){const s=LJ[e.toLocaleLowerCase()],n={command:e,params:[]};for(const a of s){const r=t.slice(i),o=a.exec(r);if(o!=null){n.params.push(parseFloat(o[0])),i+=o[0].length;const l=kJ.exec(r.slice(o[0].length));l!=null&&(i+=l[0].length)}else{if(n.params.length===1)return[i,n];se.warnOnce(`Invalid SVG path, error at index ${i}: No path segment parameters for command [${e}]`);return}}return[i,n]}function bg(e,t,i,s){const n=e-i,a=t-s;return n*n+a*a}function xg(e,t,i,s,n,a,r){if(i===n&&s===a)return Math.min(r,bg(e,t,i,s));const o=n-i,l=a-s,c=Math.max(0,Math.min(1,((e-i)*o+(t-s)*l)/(o*o+l*l))),h=i+c*o,d=s+c*l;return Math.min(r,bg(e,t,h,d))}function RJ(e,t,i,s,n,a,r,o,l){o&&([r,a]=[a,r]);const c=Math.atan2(t-s,e-i);if(!Ll(c,a,r)){const d=i+Math.cos(a)*n,u=s+Math.sin(a)*n,p=i+Math.cos(a)*n,g=s+Math.sin(a)*n;return Math.min(l,bg(e,t,d,u),bg(e,t,p,g))}const h=n-Math.sqrt(bg(e,t,i,s));return Math.min(l,h*h)}function NJ(e,t){const i=-t/e;return e!==0&&i>=0&&i<=1?[i]:[]}function OJ(e,t,i){if(e===0)return NJ(t,i);const s=t*t-4*e*i,n=[];if(s===0){const a=-t/(2*e);a>=0&&a<=1&&n.push(a)}else if(s>0){const a=Math.sqrt(s),r=(-t-a)/(2*e),o=(-t+a)/(2*e);r>=0&&r<=1&&n.push(r),o>=0&&o<=1&&n.push(o)}return n}function FJ(e,t,i,s){if(e===0)return OJ(t,i,s);const n=t/e,a=i/e,r=s/e,o=(3*a-n*n)/9,l=(9*n*a-27*r-2*n*n*n)/54,c=o*o*o+l*l,h=1/3,d=[];if(c>=0){const u=Math.sqrt(c),p=Math.sign(l+u)*Math.pow(Math.abs(l+u),h),g=Math.sign(l-u)*Math.pow(Math.abs(l-u),h),f=Math.abs(Math.sqrt(3)*(p-g)/2),y=-h*n+(p+g);if(y>=0&&y<=1&&d.push(y),f===0){const v=-h*n-(p+g)/2;v>=0&&v<=1&&d.push(v)}}else{const u=Math.acos(l/Math.sqrt(-o*o*o)),p=h*n,g=2*Math.sqrt(-o),f=g*Math.cos(h*u)-p,y=g*Math.cos(h*(u+2*Math.PI))-p,v=g*Math.cos(h*(u+4*Math.PI))-p;f>=0&&f<=1&&d.push(f),y>=0&&y<=1&&d.push(y),v>=0&&v<=1&&d.push(v)}return d}function Qd(e,t,i,s,n,a,r,o){const l=(i-e)*(o-a)-(s-t)*(r-n);if(l===0)return 0;const c=((r-n)*(t-a)-(e-n)*(o-a))/l,h=((i-e)*(t-a)-(s-t)*(e-n))/l;return c>=0&&c<=1&&h>=0&&h<=1?1:0}function BJ(e,t,i,s,n,a,r,o,l,c,h,d){let u=0;const p=c-d,g=h-l,f=l*(d-c)-c*(h-l),y=ZE(e,i,n,r),v=ZE(t,s,a,o),x=p*y[0]+g*v[0],S=p*y[1]+g*v[1],M=p*y[2]+g*v[2],D=p*y[3]+g*v[3]+f,A=FJ(x,S,M,D);for(const w of A){const T=w*w,k=w*T,N=y[0]*k+y[1]*T+y[2]*w+y[3],O=v[0]*k+v[1]*T+v[2]*w+v[3];let L;l===h?L=(O-c)/(d-c):L=(N-l)/(h-l),L>=0&&L<=1&&u++}return u}function ZE(e,t,i,s){return[-e+3*t-3*i+s,3*e-6*t+3*i,-3*e+3*t,e]}function qE(e,t,i,s,n,a,r,o,l,c){if(isNaN(e)||isNaN(t))return 0;a&&([n,s]=[s,n]);const h=(c-o)/(l-r),d=o-h*r,u=Math.pow(h,2)+1,p=2*(h*(d-t)-e),g=Math.pow(e,2)+Math.pow(d-t,2)-Math.pow(i,2),f=Math.pow(p,2)-4*u*g;if(f<0)return 0;const y=(-p+Math.sqrt(f))/2/u,v=(-p-Math.sqrt(f))/2/u;let x=0;return[y,v].forEach(S=>{if(!(S>=Math.min(r,l)&&S<=Math.max(r,l)))return;const D=h*S+d,A=S-e,w=D-t,T=Math.atan2(w,A);Ll(T,s,n)&&x++}),x}function Py(e,t,i,s,n){return(1-n)**3*e+3*(1-n)**2*n*t+3*(1-n)*n**2*i+n**3*s}function Ey(e,t,i,s,n){if(n<=Math.min(e,s))return e<s?0:1;if(n>=Math.max(e,s))return e<s?1:0;let a=0,r=1,o=NaN;for(let l=0;l<12;l+=1)o=(a+r)/2,Py(e,t,i,s,o)<n?a=o:r=o;return o}function Ry(e,t,i,s,n,a,r,o,l){const c=(1-l)*e+l*i,h=(1-l)*t+l*s,d=(1-l)*i+l*n,u=(1-l)*s+l*a,p=(1-l)*n+l*r,g=(1-l)*a+l*o,f=(1-l)*c+l*d,y=(1-l)*h+l*u,v=(1-l)*d+l*p,x=(1-l)*u+l*g,S=(1-l)*f+l*v,M=(1-l)*y+l*x;return[[{x:e,y:t},{x:c,y:h},{x:f,y},{x:S,y:M}],[{x:S,y:M},{x:v,y:x},{x:p,y:g},{x:r,y:o}]]}function w0(e,t,i,s){const n=-e+3*t-3*i+s,a=2*(e-2*t+i),r=-e+t;if(n===0){if(a!==0){const l=-r/a;if(l>0&&l<1)return[l]}return[]}const o=a*a-4*n*r;if(o>=0){const l=Math.sqrt(o),c=(-a+l)/(2*n),h=(-a-l)/(2*n);return[c,h].filter(d=>d>0&&d<1)}return[]}function QE(e,t,i,s,n,a,r,o){const l=w0(e,i,n,r),c=w0(t,s,a,o);return[...l,...c]}var Jd=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.openedPath=!1,this.closedPath=!1}isEmpty(){return this.commands.length===0}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length||this.previousCommands.toString()!==this.commands.toString()||this.previousParams.toString()!==this.params.toString()}getPath2D(){return this.path2d}moveTo(e,t){this.openedPath=!0,this.path2d.moveTo(e,t),this.commands.push(0),this.params.push(e,t)}lineTo(e,t){this.openedPath?(this.path2d.lineTo(e,t),this.commands.push(1),this.params.push(e,t)):this.moveTo(e,t)}rect(e,t,i,s){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath()}appendSvg(e){let t=0,i=0,s,n,a=0,r=0;for(const{command:o,params:l}of e){s!=null||(s=l[0]),n!=null||(n=l[1]);const c=o===o.toLowerCase(),h=c?s:0,d=c?n:0;switch(o.toLowerCase()){case"m":this.moveTo(h+l[0],d+l[1]),s=h+l[0],n=d+l[1],t=s,i=n;break;case"c":this.cubicCurveTo(h+l[0],d+l[1],h+l[2],d+l[3],h+l[4],d+l[5]),a=h+l[2],r=d+l[3],s=h+l[4],n=d+l[5];break;case"s":this.cubicCurveTo(s+s-a,n+n-r,h+l[0],d+l[1],h+l[2],d+l[3]),a=h+l[0],r=d+l[1],s=h+l[2],n=d+l[3];break;case"q":this.cubicCurveTo((h+2*l[0])/3,(d+2*l[1])/3,(2*l[0]+l[2])/3,(2*l[1]+l[3])/3,l[2],l[3]),a=l[0],r=l[1],s=l[2],n=l[3];break;case"t":this.cubicCurveTo((s+2*(s+s-a))/3,(n+2*(n+n-r))/3,(2*(s+s-a)+l[0])/3,(2*(n+n-r)+l[1])/3,l[0],l[1]),a=s+s-a,r=n+n-r,s=l[0],n=l[1];break;case"a":this.ellipse(s,n,l[0],l[1],l[2]*Math.PI/180,l[3],l[4],h+l[5],d+l[6]),s=h+l[5],n=d+l[6];break;case"h":this.lineTo(h+l[0],n),s=h+l[0];break;case"l":this.lineTo(h+l[0],d+l[1]),s=h+l[0],n=d+l[1];break;case"v":this.lineTo(s,d+l[0]),n=d+l[0];break;case"z":this.closePath(),s=t,n=i;break;default:throw new Error(`Could not translate command '${o}' with '${l.join(" ")}'`)}}}ellipse(e,t,i,s,n,a,r,o,l){i=Math.abs(i),s=Math.abs(s);const c=(e-o)/2,h=(t-l)/2,d=Math.sin(n),u=Math.cos(n),p=u*c+d*h,g=-d*c+u*h,f=p/i,y=g/s;let v=f*f+y*y,x=(e+o)/2,S=(t+l)/2,M=0,D=0;v>=1?(v=Math.sqrt(v),i*=v,s*=v):(v=Math.sqrt(1/v-1),a===r&&(v=-v),M=v*i*y,D=-v*s*f,x+=u*M-d*D,S+=d*M+u*D);const A=Math.atan2((g-D)/s,(p-M)/i),w=Math.atan2((-g-D)/s,(-p-M)/i)-A,T=A+w,k=!!(1-r);this.ellipticalArc(x,S,i,s,n,A,T,k)}ellipticalArc(e,t,i,s,n,a,r,o){o&&([a,r]=[r,a]);const l=[],c=.5522847498307935,h=Math.sin(a),d=Math.cos(a),u=Math.sin(n),p=Math.cos(n);let g=p*d*i-u*h*s,f=u*d*i+p*h*s,y=-p*h*i-u*d*s,v=-u*h*i+p*d*s;l.push(g+e,f+t),r-=a,r=bi(r);const x=Math.PI/2,S=Math.floor(r/x),M=r%x;for(let D=0;D<S;D++)l.push(g+y*c+e,f+v*c+t,g*c+y+e,f*c+v+t,y+e,v+t),[g,y]=[y,-g],[f,v]=[v,-f];if(M>0){const D=Math.sin(M),A=Math.cos(M),w=Math.tan(M/4)*(4/3),T=A+w*D,k=D-w*A;l.push(g+y*w+e,f+v*w+t,g*T+y*k+e,f*T+v*k+t,g*A+y*D+e,f*A+v*D+t)}if(o)for(let D=0,A=l.length-2;D<A;D+=2,A-=2)[l[D],l[A]]=[l[A],l[D]],[l[D+1],l[A+1]]=[l[A+1],l[D+1]];for(let D=2;D<l.length;D+=6){const[A,w,T,k,N,O]=l.slice(D,D+6);this.cubicCurveTo(A,w,T,k,N,O)}}roundRect(e,t,i,s,n){n=Math.min(n,i/2,s/2),this.moveTo(e,t+n),this.arc(e+n,t+n,n,Math.PI,1.5*Math.PI),this.lineTo(e+n,t),this.lineTo(e+i-n,t),this.arc(e+i-n,t+n,n,1.5*Math.PI,2*Math.PI),this.lineTo(e+i,t+n),this.lineTo(e+i,t+s-n),this.arc(e+i-n,t+s-n,n,0,Math.PI/2),this.lineTo(e+i-n,t+s),this.lineTo(e+n,t+s),this.arc(e+ +n,t+s-n,n,Math.PI/2,Math.PI),this.lineTo(e,t+s-n),this.closePath()}arc(e,t,i,s,n,a){this.openedPath=!0,this.path2d.arc(e,t,i,s,n,a),this.commands.push(2),this.params.push(e,t,i,s,n,a?1:0)}cubicCurveTo(e,t,i,s,n,a){this.openedPath||this.moveTo(e,t),this.path2d.bezierCurveTo(e,t,i,s,n,a),this.commands.push(3),this.params.push(e,t,i,s,n,a)}closePath(){this.openedPath&&(this.path2d.closePath(),this.commands.push(4),this.openedPath=!1,this.closedPath=!0)}clear(e){e&&(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this.closedPath),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1,this.commands=[],this.params=[]}isPointInPath(e,t){const i=this.commands,s=this.params,n=i.length,a=-1e4,r=-1e4;let o=NaN,l=NaN,c=0,h=0,d=0;for(let u=0,p=0;u<n;u++)switch(i[u]){case 0:d+=Qd(o,l,c,h,a,r,e,t),c=s[p++],o=c,h=s[p++],l=h;break;case 1:d+=Qd(c,h,s[p++],s[p++],a,r,e,t),c=s[p-2],h=s[p-1];break;case 3:d+=BJ(c,h,s[p++],s[p++],s[p++],s[p++],s[p++],s[p++],a,r,e,t),c=s[p-2],h=s[p-1];break;case 2:{const g=s[p++],f=s[p++],y=s[p++],v=s[p++],x=s[p++],S=!!s[p++];if(d+=qE(g,f,y,v,x,S,a,r,e,t),!isNaN(o)){const M=g+Math.cos(v)*y,D=f+Math.sin(v)*y;d+=Qd(c,h,M,D,a,r,e,t)}c=g+Math.cos(x)*y,h=f+Math.sin(x)*y;break}case 4:d+=Qd(o,l,c,h,a,r,e,t);break}return d%2===1}distanceSquared(e,t){let i=1/0;const s=this.commands,n=this.params,a=s.length;let r=NaN,o=NaN,l=0,c=0;for(let h=0,d=0;h<a;h++)switch(s[h]){case 0:l=r=n[d++],c=o=n[d++];break;case 1:{const u=n[d++],p=n[d++];i=xg(e,t,l,c,u,p,i);break}case 3:se.error("Command.Curve distanceSquare not implemented");break;case 2:{const u=n[d++],p=n[d++],g=n[d++],f=n[d++],y=n[d++],v=u+Math.cos(f)*g,x=p+Math.sin(f)*g,S=!!n[d++];i=xg(e,t,l,c,v,x,i),i=RJ(e,t,u,p,g,f,y,S,i),l=u+Math.cos(y)*g,c=p+Math.sin(y)*g;break}case 4:i=xg(e,t,l,c,r,o,i);break}return i}toSVG(e=(t,i)=>({x:t,y:i})){const t=[],{commands:i,params:s}=this,n=(r,...o)=>{t.push(r);for(let l=0;l<o.length;l+=2){const{x:c,y:h}=e(o[l],o[l+1]);t.push(c,h)}};let a=0;for(const r of i)switch(r){case 0:n("M",s[a++],s[a++]);break;case 1:n("L",s[a++],s[a++]);break;case 3:n("C",s[a++],s[a++],s[a++],s[a++],s[a++],s[a++]);break;case 2:{const o=s[a++],l=s[a++],c=s[a++],h=s[a++],d=s[a++],u=s[a++];let p=u?h-d:d-h;p<0&&(p+=Math.ceil(-p/(2*Math.PI))*2*Math.PI),u&&(p=-p);const g=Math.max(Math.ceil(Math.abs(p)/(Math.PI/2)),1),f=p/g,y=4/3*Math.tan(f/4),v=t.length===0?"M":"L";n(v,o+Math.cos(h)*c,l+Math.sin(h)*c);for(let x=0;x<g;x+=1){const S=h+f*(x+0),M=h+f*(x+1),D=c*Math.sin(S),A=c*Math.cos(S),w=c*Math.sin(M),T=c*Math.cos(M);n("C",o+A-y*D,l+D+y*A,o+T+y*w,l+w-y*T,o+T,l+w)}break}case 4:t.push("Z");break}return t.join(" ")}computeBBox(){const{commands:e,params:t}=this;let[i,s,n,a]=[1/0,1/0,-1/0,-1/0],[r,o]=[NaN,NaN],[l,c]=[NaN,NaN];const h=(p,g,f)=>{i=Math.min(g,i),s=Math.min(p,s),n=Math.max(p,n),a=Math.max(g,a),f&&([r,o]=[p,g])},d=(p,g,f,y,v)=>{const x=p+f*Math.cos(y),S=g+f*Math.sin(y);h(x,S,v)};let u=0;for(const p of e)switch(p){case 0:h(t[u++],t[u++],!0),[l,c]=[r,o];break;case 1:h(t[u++],t[u++],!0);break;case 3:{const g=t[u++],f=t[u++],y=t[u++],v=t[u++],x=t[u++],S=t[u++];QE(r,o,g,f,y,v,x,S).forEach(D=>{const A=Py(r,g,y,x,D),w=Py(o,f,v,S,D);h(A,w)}),h(x,S,!0);break}case 2:{const g=t[u++],f=t[u++],y=t[u++],v=bi(t[u++]),x=bi(t[u++]),S=t[u++];d(g,f,y,v);const M=[0,Math.PI/2,Math.PI,3*Math.PI/2],[D,A]=S?[x,v]:[v,x];for(const w of M)(D<A&&D<=w&&w<=A||D>A&&(D<=w||w<=A))&&d(g,f,y,w);d(g,f,y,x,!0);break}case 4:[r,o]=[l,c];break}return new ve(s,i,n-s,a-i)}};function ts(e,t,i){const s=Math.round(t*e)/e;return i==null?s:i===0?0:i<1?Math.ceil(i*e)/e:Math.round((i+t)*e)/e-s}function JE(e,t){return Math.floor(t*e)/e}function A0(e,t,i){const{width:s,height:n,padding:a,strokeWidth:r}=t,o=s/2,l=n/2,c=Math.max(1,s-a-r/2),h=Math.max(1,n-a-r/2);let d=!1;for(const[u,p]of i){const g=o+(u-.5)*c,f=l+(p-.5)*h;d?e.lineTo(g,f):e.moveTo(g,f),d=!0}e.closePath()}var _J={circles(e,{width:t,strokeWidth:i,padding:s}){const n=t/2,a=Math.max(1,n-s-i/2);e.arc(n,n,a,0,Math.PI*2)},squares(e,{width:t,height:i,pixelRatio:s,padding:n,strokeWidth:a}){const r=n+a/2;e.moveTo(ts(s,r),ts(s,r)),e.lineTo(ts(s,t-r),ts(s,r)),e.lineTo(ts(s,t-r),ts(s,i-r)),e.lineTo(ts(s,r),ts(s,i-r)),e.closePath()},triangles(e,t){A0(e,t,[[.5,0],[1,1],[0,1]])},diamonds(e,t){A0(e,t,[[.5,0],[1,.5],[.5,1],[0,.5]])},stars(e,{width:t,height:i,padding:s}){const a=Math.max(1,(t-s)/2),r=a/2,o=Math.PI/2;for(let l=0;l<10;l++){const c=l%2===0?a:r,h=l*Math.PI/5-o,d=t/2+Math.cos(h)*c,u=i/2+Math.sin(h)*c;e.lineTo(d,u)}e.closePath()},hearts(e,{width:t,height:i,padding:s}){const n=Math.max(1,t/4-s/2),a=t/2,r=i/2+n/2;e.arc(a-n,r-n,n,Vi(130),Vi(330)),e.arc(a+n,r-n,n,Vi(220),Vi(50)),e.lineTo(a,r+n),e.closePath()},crosses(e,t){A0(e,t,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},"vertical-lines"(e,{width:t,height:i,pixelRatio:s,strokeWidth:n}){const a=ts(s,t/2)-n%2/2;e.moveTo(a,0),e.lineTo(a,i)},"horizontal-lines"(e,{width:t,height:i,pixelRatio:s,strokeWidth:n}){const a=ts(s,i/2)-n%2/2;e.moveTo(0,a),e.lineTo(t,a)},"forward-slanted-lines"(e,{width:t,height:i,strokeWidth:s}){const n=Math.atan2(i,t),a=s*Math.cos(n),r=s*Math.sin(n);e.moveTo(-a,r),e.lineTo(a,-r),e.moveTo(-a,i+r),e.lineTo(t+a,-r),e.moveTo(t-a,i+r),e.lineTo(t+a,i-r)},"backward-slanted-lines"(e,{width:t,height:i,strokeWidth:s}){const n=Math.atan2(i,t),a=s*Math.cos(n),r=s*Math.sin(n);e.moveTo(t-a,-r),e.lineTo(t+a,r),e.moveTo(-a,-r),e.lineTo(t+a,i+r),e.moveTo(-a,i-r),e.lineTo(a,i+r)}},GJ=class{constructor(e){var t,i,s,n,a,r,o,l,c,h,d,u,p;this._cache=void 0,this.width=Math.max((t=e==null?void 0:e.width)!=null?t:10,1),this.height=Math.max((i=e==null?void 0:e.height)!=null?i:10,1),this.fill=(s=e.fill)!=null?s:"none",this.fillOpacity=(n=e.fillOpacity)!=null?n:1,this.backgroundFill=(a=e.backgroundFill)!=null?a:"none",this.backgroundFillOpacity=(r=e.backgroundFillOpacity)!=null?r:1,this.stroke=(o=e.stroke)!=null?o:"black",this.strokeOpacity=(l=e.strokeOpacity)!=null?l:1,this.strokeWidth=(c=e.strokeWidth)!=null?c:1,this.padding=(h=e.padding)!=null?h:1,this.pattern=(d=e.pattern)!=null?d:"forward-slanted-lines",this.rotation=(u=e.rotation)!=null?u:0,this.scale=(p=e.scale)!=null?p:1,this.path=e.path}getPath(e){const{pattern:t,width:i,height:s,padding:n,strokeWidth:a,path:r}=this,o=new Jd,l=PJ(r);return l?o.appendSvg(l):_J[t](o,{width:i,height:s,pixelRatio:e,strokeWidth:a,padding:n}),o}renderStroke(e,t){const{stroke:i,strokeWidth:s,strokeOpacity:n}=this;s&&(t.strokeStyle=i,t.lineWidth=s,t.globalAlpha=n,t.stroke(e))}renderFill(e,t){const{fill:i,fillOpacity:s}=this;i!=="none"&&(t.fillStyle=i,t.globalAlpha=s,t.fill(e))}createCanvasPattern(e,t){const{width:i,height:s,scale:n,backgroundFill:a,backgroundFillOpacity:r}=this;if(i*n<1||s*n<1)return se.warnOnce("Pattern fill is too small to render, ignoring."),null;const o=new u0({width:i,height:s,pixelRatio:t*n}),l=o.context;a!=="none"&&(l.fillStyle=a,l.globalAlpha=r,l.fillRect(0,0,i,s));const c=this.getPath(t).getPath2D();this.renderFill(c,l),this.renderStroke(c,l);const h=e.createPattern(o.canvas,"repeat");return this.setPatternTransform(h,t),o.destroy(),h}setPatternTransform(e,t,i=0,s=0){const n=Co(this.rotation),a=1/t,r=Math.cos(n)*a,o=Math.sin(n)*a;e==null||e.setTransform(new DOMMatrix([r,o,-o,r,i,s]))}createPattern(e,t){if(this._cache!=null&&this._cache.ctx===e&&this._cache.pixelRatio===t)return this._cache.pattern;const i=this.createCanvasPattern(e,t);if(i!=null)return this._cache={ctx:e,pattern:i,pixelRatio:t},i}toSvg(){const{width:e,height:t,fill:i,fillOpacity:s,backgroundFill:n,backgroundFillOpacity:a,stroke:r,strokeWidth:o,strokeOpacity:l,rotation:c,scale:h}=this,d=Ti("pattern");d.setAttribute("viewBox",`0 0 ${e} ${t}`),d.setAttribute("width",String(e)),d.setAttribute("height",String(t)),d.setAttribute("patternUnits","userSpaceOnUse");const u=Ti("rect");u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(e)),u.setAttribute("height",String(t)),u.setAttribute("fill",n),u.setAttribute("fill-opacity",String(a)),d.appendChild(u);const p=Ti("path");return p.setAttribute("fill",i),p.setAttribute("fill-opacity",String(s)),p.setAttribute("stroke-opacity",String(l)),p.setAttribute("stroke",r),p.setAttribute("stroke-width",String(o)),p.setAttribute("transform",`rotate(${c}) scale(${h})`),p.setAttribute("d",this.getPath(1).toSVG()),d.appendChild(p),d}};function Ka(e){return Ve(e)&&e.type=="gradient"}function eR(e){return Ke(e)&&e.every(t=>typeof t=="string")}function ch(e){return e!==null&&Ve(e)&&e.type=="pattern"}function eu(e){return e!==null&&Ve(e)&&e.type=="image"}function zJ(e){return Ka(e)||ch(e)}var Ws=class lo extends xo{constructor(){super(...arguments),this.fillOpacity=1,this.strokeOpacity=1,this.fill=lo.defaultStyles.fill,this.stroke=lo.defaultStyles.stroke,this.strokeWidth=lo.defaultStyles.strokeWidth,this.lineDash=lo.defaultStyles.lineDash,this.lineDashOffset=lo.defaultStyles.lineDashOffset,this.lineCap=lo.defaultStyles.lineCap,this.lineJoin=lo.defaultStyles.lineJoin,this.miterLimit=void 0,this.opacity=lo.defaultStyles.opacity,this.fillShadow=lo.defaultStyles.fillShadow}restoreOwnStyles(){const{defaultStyles:t}=this.constructor;Object.assign(this,t)}getGradient(t){if(Ka(t))return this.createGradient(t)}createGradient(t){const{colorSpace:i="rgb",gradient:s="linear",colorStops:n,rotation:a=0,reverse:r=!1}=t;if(n==null)return;let o=YE(n,["black"],[0,1]);switch(r&&(o=o.map(l=>({color:l.color,stop:1-l.stop})).reverse()),s){case"linear":return new KE(i,o,a);case"radial":return new DJ(i,o);case"conic":return new UE(i,o,a)}}getPattern(t){if(ch(t))return this.createPattern(t)}createPattern(t){return new GJ(t)}getImage(t){if(eu(t))return this.createImage(t)}createImage(t){return new IJ(this.imageLoader,t)}onFillChange(){var t;typeof this.fill=="object"&&dn((t=this._cachedFill)!=null?t:{},this.fill)||(this.fillGradient=this.getGradient(this.fill),this.fillPattern=this.getPattern(this.fill),this.fillImage=this.getImage(this.fill),this._cachedFill=this.fill)}onStrokeChange(){this.strokeGradient=this.getGradient(this.stroke)}align(t,i){var s,n,a;return ts((a=(n=(s=this.layerManager)==null?void 0:s.canvas)==null?void 0:n.pixelRatio)!=null?a:1,t,i)}preRender(t,i){return this.dirty&&(this.cachedDefaultGradientFillBBox=void 0),super.preRender(t,i)}fillStroke(t,i){this.renderFill(t,i),this.renderStroke(t,i)}renderFill(t,i){const{fill:s,fillImage:n}=this;if(s&&s!=="none"){const{globalAlpha:a}=t;n&&(t.globalAlpha=n.backgroundFillOpacity,t.fillStyle=n.backgroundFill,this.executeFill(t,i),t.globalAlpha=a),this.applyFillAndAlpha(t),this.applyShadow(t),this.executeFill(t,i),t.globalAlpha=a}t.shadowColor="rgba(0, 0, 0, 0)"}executeFill(t,i){i?t.fill(i):t.fill()}applyFillAndAlpha(t){var l,c,h,d,u;const{fill:i,fillGradient:s,fillPattern:n,fillImage:a,fillOpacity:r,opacity:o}=this;if(t.globalAlpha*=o*r,s){const{fillBBox:p=(l=this.getDefaultGradientFillBBox())!=null?l:this.getBBox(),fillParams:g}=this;t.fillStyle=(c=s.createGradient(t,p,g))!=null?c:"black"}else if(n){const{x:p,y:g}=this.getBBox(),f=(u=(d=(h=this.layerManager)==null?void 0:h.canvas)==null?void 0:d.pixelRatio)!=null?u:1,y=n.createPattern(t,f);n.setPatternTransform(y,f,p,g),y?t.fillStyle=y:(t.fillStyle=n.fill,t.globalAlpha*=n.fillOpacity)}else if(a){const p=this.getBBox(),g=a.createPattern(t,p.width,p.height,this);a.setImageTransform(g,p),t.fillStyle=g!=null?g:"transparent"}else t.fillStyle=typeof i=="string"?i:"black"}applyStrokeAndAlpha(t){var r,o;const{stroke:i,strokeOpacity:s,strokeGradient:n,opacity:a}=this;t.strokeStyle=(o=(r=n==null?void 0:n.createGradient(t,this.getBBox()))!=null?r:typeof i=="string"?i:void 0)!=null?o:"black",t.globalAlpha*=a*s}applyShadow(t){var n,a;const i=(a=(n=this.layerManager)==null?void 0:n.canvas.pixelRatio)!=null?a:1,s=this.fillShadow;s!=null&&s.enabled&&(t.shadowColor=s.color,t.shadowOffsetX=s.xOffset*i,t.shadowOffsetY=s.yOffset*i,t.shadowBlur=s.blur*i)}renderStroke(t,i){const{stroke:s,strokeWidth:n,lineDash:a,lineDashOffset:r,lineCap:o,lineJoin:l,miterLimit:c}=this;if(s&&n){const{globalAlpha:h}=t;this.applyStrokeAndAlpha(t),t.lineWidth=n,a&&t.setLineDash(a),r&&(t.lineDashOffset=r),o&&(t.lineCap=o),l&&(t.lineJoin=l),c!=null&&(t.miterLimit=c),this.executeStroke(t,i),t.globalAlpha=h}}executeStroke(t,i){i?t.stroke(i):t.stroke()}getDefaultGradientFillBBox(){return this.cachedDefaultGradientFillBBox==null&&(this.cachedDefaultGradientFillBBox=Object.freeze(this.computeDefaultGradientFillBBox())),this.cachedDefaultGradientFillBBox}computeDefaultGradientFillBBox(){}containsPoint(t,i){return this.isPointInPath(t,i)}applySvgFillAttributes(t,i){var a,r,o,l;const{fill:s,fillOpacity:n}=this;if(typeof s=="string")t.setAttribute("fill",s);else if(Ka(s)&&this.fillGradient){i!=null||(i=[]);const c=this.fillGradient.toSvg((a=this.fillBBox)!=null?a:this.getBBox()),h=by();c.setAttribute("id",h),i.push(c),t.setAttribute("fill",`url(#${h})`)}else if(ch(s)&&this.fillPattern){i!=null||(i=[]);const c=this.fillPattern.toSvg(),h=by();c.setAttribute("id",h),i.push(c),t.setAttribute("fill",`url(#${h})`)}else if(eu(s)&&this.fillImage){i!=null||(i=[]);const c=(l=(o=(r=this.layerManager)==null?void 0:r.canvas)==null?void 0:o.pixelRatio)!=null?l:1,h=this.fillImage.toSvg(this.getBBox(),c),d=by();h.setAttribute("id",d),i.push(h),t.setAttribute("fill",`url(#${d})`)}else t.setAttribute("fill","none");return t.setAttribute("fill-opacity",String(n)),i}applySvgStrokeAttributes(t){const{stroke:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r}=this;if(i!=null&&(t.setAttribute("stroke",typeof i=="string"?i:"none"),t.setAttribute("stroke-opacity",String(s)),t.setAttribute("stroke-width",String(n))),(a==null?void 0:a.some(o=>o!==0))===!0){const o=a.length%2===1?[...a,...a]:a;t.setAttribute("stroke-dasharray",o.join(" ")),t.setAttribute("stroke-dashoffset",String(r))}}};Ws.defaultStyles={fill:"black",stroke:void 0,strokeWidth:0,lineDash:void 0,lineDashOffset:0,lineCap:void 0,lineJoin:void 0,opacity:1,fillShadow:void 0},I([he()],Ws.prototype,"fillOpacity",2),I([he()],Ws.prototype,"strokeOpacity",2),I([$n({equals:dn,changeCb:e=>e.onFillChange()})],Ws.prototype,"fill",2),I([$n({equals:dn,changeCb:e=>e.onStrokeChange()})],Ws.prototype,"stroke",2),I([he()],Ws.prototype,"strokeWidth",2),I([b0()],Ws.prototype,"lineDash",2),I([he()],Ws.prototype,"lineDashOffset",2),I([he()],Ws.prototype,"lineCap",2),I([he()],Ws.prototype,"lineJoin",2),I([he()],Ws.prototype,"miterLimit",2),I([he({convertor:e=>we(0,e,1)})],Ws.prototype,"opacity",2),I([$n({equals:Xd,checkDirtyOnAssignment:!0})],Ws.prototype,"fillShadow",2),I([$n({equals:nh.equals,changeCb:e=>e.onFillChange()})],Ws.prototype,"fillBBox",2),I([$n({equals:dn,changeCb:e=>e.onFillChange()})],Ws.prototype,"fillParams",2);var va=Ws,tR=[1,0,0,1,0,0],So=class KC{get e(){return[...this.elements]}constructor(t=tR){this.elements=[...t]}setElements(t){const i=this.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],this}get identity(){const t=this.elements;return mt(t[0],1)&&mt(t[1],0)&&mt(t[2],0)&&mt(t[3],1)&&mt(t[4],0)&&mt(t[5],0)}AxB(t,i,s){const n=t[0]*i[0]+t[2]*i[1],a=t[1]*i[0]+t[3]*i[1],r=t[0]*i[2]+t[2]*i[3],o=t[1]*i[2]+t[3]*i[3],l=t[0]*i[4]+t[2]*i[5]+t[4],c=t[1]*i[4]+t[3]*i[5]+t[5];s=s!=null?s:t,s[0]=n,s[1]=a,s[2]=r,s[3]=o,s[4]=l,s[5]=c}multiplySelf(t){return this.AxB(this.elements,t.elements),this}multiply(t){const i=new Array(6);return t instanceof KC?this.AxB(this.elements,t.elements,i):this.AxB(this.elements,[t.a,t.b,t.c,t.d,t.e,t.f],i),new KC(i)}preMultiplySelf(t){return this.AxB(t.elements,this.elements,this.elements),this}inverse(){const t=this.elements;let i=t[0],s=t[1],n=t[2],a=t[3];const r=t[4],o=t[5],l=1/(i*a-s*n);return i*=l,s*=l,n*=l,a*=l,new KC([a,-s,-n,i,n*o-a*r,s*r-i*o])}invertSelf(){const t=this.elements;let i=t[0],s=t[1],n=t[2],a=t[3];const r=t[4],o=t[5],l=1/(i*a-s*n);return i*=l,s*=l,n*=l,a*=l,t[0]=a,t[1]=-s,t[2]=-n,t[3]=i,t[4]=n*o-a*r,t[5]=s*r-i*o,this}transformPoint(t,i){const s=this.elements;return{x:t*s[0]+i*s[2]+s[4],y:t*s[1]+i*s[3]+s[5]}}transformBBox(t,i){const s=this.elements,n=s[0],a=s[1],r=s[2],o=s[3],l=t.width*.5,c=t.height*.5,h=t.x+l,d=t.y+c,u=Math.abs(l*n)+Math.abs(c*r),p=Math.abs(l*a)+Math.abs(c*o);return i!=null||(i=new ve(0,0,0,0)),i.x=h*n+d*r+s[4]-u,i.y=h*a+d*o+s[5]-p,i.width=u+u,i.height=p+p,i}toContext(t){if(this.identity)return;const i=this.elements;t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}static updateTransformMatrix(t,i,s,n,a,r,o){var D,A,w,T;const l=i,c=s;let h,d;l===1&&c===1?(h=0,d=0):(h=(D=o==null?void 0:o.scalingCenterX)!=null?D:0,d=(A=o==null?void 0:o.scalingCenterY)!=null?A:0);const u=n,p=Math.cos(u),g=Math.sin(u);let f,y;u===0?(f=0,y=0):(f=(w=o==null?void 0:o.rotationCenterX)!=null?w:0,y=(T=o==null?void 0:o.rotationCenterY)!=null?T:0);const v=a,x=r,S=h*(1-l)-f,M=d*(1-c)-y;return t.setElements([p*l,g*l,-g*c,p*c,p*S-g*M+f+v,g*S+p*M+y+x]),t}};function Pl(e){return sR(e.constructor)}var iR=Symbol("isMatrixTransform");function sR(e){return e[iR]===!0}function I0(e){var t,i;const s=e;if(sR(e))return e;const n=Symbol("matrix_combined_transform");class a extends s{constructor(){super(...arguments),this[i]=new So,this._dirtyTransform=!0}markDirtyTransform(){this._dirtyTransform=!0,super.markDirty()}onChangeDetection(o){super.onChangeDetection(o),this.markDirtyTransform()}updateMatrix(o){}computeTransformMatrix(){this._dirtyTransform&&(this[n].setElements(tR),this.updateMatrix(this[n]),this._dirtyTransform=!1)}toParent(o){return this.computeTransformMatrix(),this[n].identity?o.clone():this[n].transformBBox(o)}toParentPoint(o,l){return this.computeTransformMatrix(),this[n].identity?{x:o,y:l}:this[n].transformPoint(o,l)}fromParent(o){return this.computeTransformMatrix(),this[n].identity?o.clone():this[n].inverse().transformBBox(o)}fromParentPoint(o,l){return this.computeTransformMatrix(),this[n].identity?{x:o,y:l}:this[n].inverse().transformPoint(o,l)}computeBBox(){const o=super.computeBBox();return o&&this.toParent(o)}computeBBoxWithoutTransforms(){return super.computeBBox()}pickNode(o,l){return{x:o,y:l}=this.fromParentPoint(o,l),super.pickNode(o,l)}pickNodes(o,l,c){return{x:o,y:l}=this.fromParentPoint(o,l),super.pickNodes(o,l,c)}render(o){this.computeTransformMatrix();const{ctx:l}=o,c=this[n];let h=!1;c.identity||(l.save(),h=!0,c.toContext(l)),super.render(o),h&&l.restore()}toSVG(){this.computeTransformMatrix();const o=super.toSVG(),l=this[n];if(l.identity||o==null)return o;const c=Ti("g");c.append(...o.elements);const[h,d,u,p,g,f]=l.e;return c.setAttribute("transform",`matrix(${h} ${d} ${u} ${p} ${g} ${f})`),{elements:[c],defs:o.defs}}}return t=iR,i=n,a[t]=!0,a}function tu(e){var t;const i=e,s=Symbol("matrix_rotation");class n extends I0(i){constructor(){super(...arguments),this[t]=new So,this.rotationCenterX=0,this.rotationCenterY=0,this.rotation=0}updateMatrix(r){super.updateMatrix(r);const{rotation:o,rotationCenterX:l,rotationCenterY:c}=this;o!==0&&(So.updateTransformMatrix(this[s],1,1,o,0,0,{rotationCenterX:l,rotationCenterY:c}),r.multiplySelf(this[s]))}}return t=s,I([he()],n.prototype,"rotationCenterX",2),I([he()],n.prototype,"rotationCenterY",2),I([he()],n.prototype,"rotation",2),n}function T0(e){var t;const i=e,s=Symbol("matrix_scale");class n extends I0(i){constructor(){super(...arguments),this[t]=new So,this.scalingX=1,this.scalingY=1,this.scalingCenterX=0,this.scalingCenterY=0}updateMatrix(r){super.updateMatrix(r);const{scalingX:o,scalingY:l,scalingCenterX:c,scalingCenterY:h}=this;o===1&&l===1||(So.updateTransformMatrix(this[s],o,l,0,0,0,{scalingCenterX:c,scalingCenterY:h}),r.multiplySelf(this[s]))}}return t=s,I([he()],n.prototype,"scalingX",2),I([he()],n.prototype,"scalingY",2),I([he()],n.prototype,"scalingCenterX",2),I([he()],n.prototype,"scalingCenterY",2),n}function hh(e){var t;const i=e,s=Symbol("matrix_translation");class n extends I0(i){constructor(){super(...arguments),this[t]=new So,this.translationX=0,this.translationY=0}updateMatrix(r){super.updateMatrix(r);const{translationX:o,translationY:l}=this;o===0&&l===0||(So.updateTransformMatrix(this[s],1,1,0,o,l),r.multiplySelf(this[s]))}}return t=s,I([he()],n.prototype,"translationX",2),I([he()],n.prototype,"translationY",2),n}var ai=class{static fromCanvas(e,t){const i=[];for(const s of e.traverseUp())Pl(s)&&i.unshift(s);for(const s of i)t=s.fromParent(t);return Pl(e)&&(t=e.fromParent(t)),t}static toCanvas(e,t){t==null?t=e.getBBox():Pl(e)&&(t=e.toParent(t));for(const i of e.traverseUp())Pl(i)&&(t=i.toParent(t));return t}static fromCanvasPoint(e,t,i){const s=[];for(const n of e.traverseUp())Pl(n)&&s.unshift(n);for(const n of s)({x:t,y:i}=n.fromParentPoint(t,i));return Pl(e)&&({x:t,y:i}=e.fromParentPoint(t,i)),{x:t,y:i}}static toCanvasPoint(e,t,i){Pl(e)&&({x:t,y:i}=e.toParentPoint(t,i));for(const s of e.traverseUp())Pl(s)&&({x:t,y:i}=s.toParentPoint(t,i));return{x:t,y:i}}},k0=(e,t)=>Math.sign(e-t);function nR(e,t){if(typeof e=="number"&&typeof t=="number")return k0(e,t);const i=typeof e=="number"?[e]:e,s=typeof t=="number"?[t]:t,n=Math.min(i.length,s.length);for(let a=0;a<n;a+=1){const r=k0(i[a],s[a]);if(r!==0)return r}return k0(i.length,s.length)}var Cg,L0=class Am extends xo{constructor(t){super(t),this.opacity=1,this.renderToOffscreenCanvas=!1,this.optimizeForInfrequentRedraws=!1,this.layer=void 0,this.image=void 0,this._lastWidth=NaN,this._lastHeight=NaN,this._lastDevicePixelRatio=NaN,this.isContainerNode=!0,this.renderToOffscreenCanvas=(t==null?void 0:t.renderToOffscreenCanvas)===!0}static is(t){return t instanceof Am}static computeChildrenBBox(t,i=!0){return ve.merge(xo.extractBBoxes(t,i))}static compareChildren(t,i){return nR(t.zIndex,i.zIndex)||t.serialNumber-i.serialNumber}containsPoint(t,i){return!0}computeBBox(){return Am.computeChildrenBBox(this.children())}computeSafeClippingBBox(t){const i=this.computeBBox();if(!i.isFinite())return;let s=0;const n=4;for(const u of this.descendants())u instanceof va&&(s=Math.max(s,u.strokeWidth));const a=Math.max(1,s/2*n),{x:r,y:o}=ai.toCanvasPoint(this,0,0),l=JE(t,r+i.x-a)-r,c=JE(t,o+i.y-a)-o,h=Math.ceil(i.x+i.width-l+a),d=Math.ceil(i.y+i.height-c+a);return new ve(l,c,h,d)}prepareSharedCanvas(t,i,s){return Cg==null||Cg.pixelRatio!==s?Cg=new u0({width:t,height:i,pixelRatio:s}):Cg.resize(t,i,s),Cg}isDirty(t){const{width:i,height:s,devicePixelRatio:n}=t,{dirty:a,dirtyZIndex:r,layer:o}=this,l=o!=null&&(this._lastWidth!==i||this._lastHeight!==s),c=this._lastDevicePixelRatio!==n;if(this._lastWidth=i,this._lastHeight=s,this._lastDevicePixelRatio=n,a||r||l||c)return!0;for(const h of this.children())if(h.dirty)return!0;return!1}preRender(t){var s,n,a;const i=super.preRender(t,0);return i.groups+=1,i.nonGroups-=1,this.renderToOffscreenCanvas&&!this.optimizeForInfrequentRedraws&&i.nonGroups>0&&this.getVisibility()?(n=this.layer)!=null||(this.layer=(s=this.layerManager)==null?void 0:s.addLayer({name:this.name})):this.layer!=null&&((a=this.layerManager)==null||a.removeLayer(this.layer),this.layer=void 0),i}render(t){const{layer:i,renderToOffscreenCanvas:s}=this,n=b({},t);if(!s){this.renderInContext(n),super.render(n);return}const{ctx:a,stats:r,devicePixelRatio:o}=t;let{image:l}=this;if(this.isDirty(t)){l==null||l.bitmap.close(),l=void 0;const h=i?void 0:this.computeSafeClippingBBox(o),d=(u,...p)=>{var f;const g=u.context;n.ctx=g,u.clear(),g.save(),g.setTransform(...p),g.globalAlpha=1,this.renderInContext(n),g.restore(),(f=g.verifyDepthZero)==null||f.call(g)};if(i)d(i,a.getTransform());else if(h){const{x:u,y:p,width:g,height:f}=h,y=this.prepareSharedCanvas(g,f,o);d(y,o,0,0,o,-u*o,-p*o),l={bitmap:y.transferToImageBitmap(),x:u,y:p,width:g,height:f}}else this.dirtyZIndex&&this.sortChildren(Am.compareChildren);this.image=l,r&&r.layersRendered++}else this.skipRender(n),r&&r.layersSkipped++;const{globalAlpha:c}=a;if(a.globalAlpha=c*this.opacity,i)a.save(),a.resetTransform(),i.drawImage(a),a.restore();else if(l){const{bitmap:h,x:d,y:u,width:p,height:g}=l;a.drawImage(h,0,0,p*o,g*o,d,u,p,g)}a.globalAlpha=c,super.render(n)}skipRender(t){const{stats:i}=t;for(const s of this.children())s.markClean(),i&&(i.nodesSkipped+=this.childNodeCounts.groups+this.childNodeCounts.nonGroups,i.opsSkipped+=this.childNodeCounts.complexity)}applyClip(t,i){const{x:s,y:n,width:a,height:r}=i;t.beginPath(),t.rect(s,n,a,r),t.clip()}renderInContext(t){const{ctx:i,stats:s}=t;this.dirtyZIndex&&this.sortChildren(Am.compareChildren),i.save(),i.globalAlpha*=this.opacity,this.clipRect!=null&&(this.applyClip(i,this.clipRect),t.clipBBox=ai.toCanvas(this,this.clipRect));for(const n of this.children()){if(!n.visible){n.markClean(),s&&(s.nodesSkipped+=n.childNodeCounts.nonGroups+n.childNodeCounts.groups,s.opsSkipped+=n.childNodeCounts.complexity);continue}i.save(),n.render(t),i.restore()}i.restore()}setClipRect(t){this.clipRect=t?ai.fromCanvas(this,t):void 0}setClipRectCanvasSpace(t){this.clipRect=t}setScene(t){var i;this.layer&&((i=this.scene)==null||i.layersManager.removeLayer(this.layer),this.layer=void 0),super.setScene(t)}getVisibility(){for(const t of this.traverseUp(!0))if(!t.visible)return!1;return!0}toSVG(){if(!this.visible)return;const t=[],i=[];for(const s of this.children()){const n=s.toSVG();n!=null&&(i.push(...n.elements),n.defs!=null&&t.push(...n.defs))}return{elements:i,defs:t}}};L0.className="Group",I([he({convertor:e=>we(0,e,1)})],L0.prototype,"opacity",2);var Ge=L0,VJ=class extends T0(Ge){},jJ=class extends tu(Ge){},ds=class extends hh(Ge){},iu=class extends tu(hh(Ge)){};function Ny(e,t){e&&(t=nh.normalize(t),t.width==null?e.style.removeProperty("width"):e.style.width=`${t.width}px`,t.height==null?e.style.removeProperty("height"):e.style.height=`${t.height}px`,t.x==null?e.style.removeProperty("left"):e.style.left=`${t.x}px`,t.y==null?e.style.removeProperty("top"):e.style.top=`${t.y}px`)}function aR(e){const t=parseFloat(e.style.width)||e.offsetWidth,i=parseFloat(e.style.height)||e.offsetHeight,s=parseFloat(e.style.left)||e.offsetLeft,n=parseFloat(e.style.top)||e.offsetTop;return{x:s,y:n,width:t,height:i}}function HJ(e){var s;if(e.focus({preventScroll:!0}),((s=e.lastChild)==null?void 0:s.textContent)==null)return;const t=Sr().createRange();t.setStart(e.lastChild,e.lastChild.textContent.length),t.setEnd(e.lastChild,e.lastChild.textContent.length);const i=Ct().getSelection();i==null||i.removeAllRanges(),i==null||i.addRange(t)}function rR(){const e=Ct("navigator");if("scheduling"in e){const t=e.scheduling;if("isInputPending"in t)return t.isInputPending({includeContinuous:!0})}return!1}function Oy(e){return`ag-charts-icon ag-charts-icon-${e}`}var P0="class-instance";function Lr(e,t,i){if(Ke(t)){if(!Ke(e)||e.length!==t.length||t.some((s,n)=>Lr(e[n],s,i)!=null))return t}else if(Lt(t)){if(!Lt(e))return t;const s={},n=new Set([...Object.keys(e),...Object.keys(t)]);for(const a of n)if(e[a]!==t[a])if(i!=null&&i.has(a))s[a]=t[a];else if(typeof e[a]==typeof t[a]){const r=Lr(e[a],t[a],i);r!==null&&(s[a]=r)}else s[a]=t[a];return Object.keys(s).length?s:null}else if(e!==t)return t;return null}function oR(e,t){for(const i of Object.keys(e))if(e[i]!==(t==null?void 0:t[i]))return!1;return!0}function Bt(e,t){return Ke(e)?WJ(e,t):Lt(e)?UJ(e,t):e instanceof Map?new Map(Bt(Array.from(e))):E0(e)}function WJ(e,t){const i=[],s=t==null?void 0:t.seen;for(const n of e){if(typeof n=="object"&&(s!=null&&s.includes(n))){se.warn("cycle detected in array",n);continue}s==null||s.push(n),i.push(Bt(n,t)),s==null||s.pop()}return i}function UJ(e,t){var s,n;const i={};for(const a of Object.keys(e))(s=t==null?void 0:t.assign)!=null&&s.has(a)?i[a]=e[a]:(n=t==null?void 0:t.shallow)!=null&&n.has(a)?i[a]=E0(e[a]):i[a]=Bt(e[a],t);return i}function E0(e){return Ke(e)?e.slice(0):Lt(e)?b({},e):Mr(e)?new Date(e):IQ(e)?new RegExp(e.source,e.flags):e}function Pr(e,t,i,s,n,a){if(Ke(e)){a=t(e,s,n,a);let r=0;for(const o of e)a=Pr(o,t,i,s==null?void 0:s[r],n,a),r++}else if(Lt(e)){a=t(e,s,n,a);for(const r of Object.keys(e)){if(i!=null&&i.has(r))continue;const o=e[r];a=Pr(o,t,i,s==null?void 0:s[r],n,a)}}return a}function Sg(e,t,i={}){const{path:s,matcherPath:n=s==null?void 0:s.replace(/(\[[0-9+]+])/i,"[]"),skip:a=[]}=i;if(e==null)throw new Error(`AG Charts - target is uninitialised: ${s!=null?s:"<root>"}`);if(t==null)return e;if(qd(e))return e.set(t);const r=e,o=R0(e);for(const l of Object.keys(t)){if(m0.has(l))continue;const c=`${n?n+".":""}${l}`;if(a.includes(c))continue;const h=t[l],d=`${s?s+".":""}${l}`,u=r.constructor,p=r[l];try{const g=R0(p),f=R0(h);if(o===P0&&!(l in e||l==="context")){if(h===void 0)continue;se.warn(`unable to set [${d}] in ${u==null?void 0:u.name} - property is unknown`);continue}if(g!=null&&f!=null&&f!==g&&(g!==P0||f!=="object")){se.warn(`unable to set [${d}] in ${u==null?void 0:u.name} - can't apply type of [${f}], allowed types are: [${g}]`);continue}if(qd(p))r[l].set(h);else if(f==="object"&&l!=="context"){if(p==null){se.warn(`unable to set [${d}] in ${u==null?void 0:u.name} - property is unknown`);continue}Sg(p,h,E(b({},i),{path:d,matcherPath:c}))}else r[l]=h}catch(g){se.warn(`unable to set [${d}] in [${u==null?void 0:u.name}]; nested error is: ${g.message}`)}}return e}function R0(e){return e==null?null:TQ(e)||Mr(e)?"primitive":Ke(e)?"array":Ve(e)?Lt(e)?"object":P0:Dr(e)?"function":"primitive"}function Fy(e,t,i,s){return O0(e,t,s!=null?s:e,{matches:new Map},i)}var N0=Symbol("operation-resolved-undefined");function O0(e,t,i,s,n,a=[],r={}){if(Ke(e)){lR(e,t,i,s,a,r);let o=0;for(const l of e)O0(l,t,i,s,n,[...a,`${o}`],r),o++}else if(Lt(e)){lR(e,t,i,s,a,r);for(const o of Object.keys(e)){if(n!=null&&n.has(o))continue;const l=e[o];Mo(l)?e[o]=F0(l,t,i,s,[...a,o],r):O0(l,t,i,s,n,[...a,o],r)}}return r}function lR(e,t,i,s,n,a){if(Ke(e))for(let r=0;r<e.length;r++)e[r]=F0(e[r],t,i,s,[...n,`${r}`],a),e[r]===N0&&(e[r]=void 0);else{let r=!1;for(const o of Object.keys(e))e[o]=F0(e[o],t,i,s,[...n,o],a),r||(r=$a(o,_y)),e[o]===N0&&delete e[o];if(r&&Object.keys(e).length>1)for(const o of Object.keys(e))$a(o,_y)&&delete e[o]}}function F0(e,t,i,s,n,a){const r=Mo(e);if(!r)return e;a[n.join(".")]=e;const o=Mg(r.operation,r.values,t,i,n,s);return o===void 0?N0:o}function Mo(e){if(!Lt(e))return;const[t]=Object.keys(e);if($a(t,_y))return{operation:t,values:e[t]}}function Mg(e,t,i,s,n,a){var l;(l=a.referencedParams)!=null||(a.referencedParams=new Set);const r=["$find","$map"];Ke(t)&&!r.includes(e)&&(t=t.map(c=>{const h=Mo(c);return h?Mg(h.operation,h.values,i,s,n,a):c}));const o=_y[e];return o(t,n,i,s,a)}function $a(e,t){return Ji(e)&&(Ve(t)||Ke(t))&&e in t}function By(e){return ki(e)&&e>=0&&e<=1}function cR(e){return Ve(e)&&e.type=="gradient"}function KJ(e){return e!==null&&Ve(e)&&e.type=="pattern"}function $J(e){return e!==null&&Ve(e)&&e.type=="image"}function hR(e,t){const i=t.split("/");let s=[...e];t.startsWith("/")&&(s=[],i.shift());let n=!1;for(const a of i){if(a==="..")s.pop(),n||s.pop();else if(a===".")s.pop();else if(a==="$index"){const r=e.findLast(o=>!isNaN(Number(o)));r!=null&&s.push(r)}else if(a==="$prevIndex"){const r=e.findLast(o=>!isNaN(Number(o)));r!=null&&s.push(`${Number(r)-1}`)}else a.length!==0&&s.push(a);n=a===".."}return s}var YJ={$ref:dR,$path:tee,$palette:eee},XJ={$if:([e,t,i])=>e?t:i,$eq:([e,t])=>e===t,$not:([e])=>!e,$or:e=>Ke(e)&&e.some(Boolean),$and:e=>Ke(e)&&e.every(Boolean),$switch:()=>{},$isOperation:iee},ZJ={$isEven:see,$mul:nee,$round:aee},qJ={$map:ree,$find:oee,$merge:lee,$omit:cee,$value:hee},QJ={$rem:dee},JJ={$mix:uee,$foregroundBackgroundMix:pee,$foregroundBackgroundAccentMix:gee,$interpolate:fee,$isGradient:([e])=>cR(e),$isPattern:([e])=>KJ(e),$isImage:([e])=>$J(e)},_y=b(b(b(b(b(b({},YJ),XJ),ZJ),qJ),QJ),JJ);function dR(e,t,i,s,n){var r,o;if(!$a(e,i)){se.warnOnce(`\`$ref\` json operation failed on [${String(e)}] at [${t.join(".")}], expecting one of [${Object.keys(i).join(", ")}].`);return}const a=Mo(i[e]);if((a==null?void 0:a.operation)!=="$ref")return i[e];if((r=n.referencedParams)!=null&&r.has(a.values)){se.warnOnce(`\`$ref\` json operation failed on [${String(e)}] at [${t.join(".")}], circular reference detected with [${[...n.referencedParams].join(", ")}].`);return}return(o=n.referencedParams)==null||o.add(a.values),dR(a.values,t,i,s,n)}function eee(e,t,i,s){if(!Ji(e))return;const n=i.__palette;if(["fill","fillFallback","stroke","gradient","range2"].includes(e)){const r=t.findLastIndex(d=>!isNaN(Number(d)));let o=Number(t[r]);if(isNaN(o))return;const l=t.slice(0,r),c=["map-shape-background","map-line-background"],h=Yd(s,l).slice(0,o).filter(d=>c.includes(d.type)).length;switch(o-=h,e){case"fill":return lg(n.fills,1,o)[0];case"fillFallback":return lg(n.fillsFallback,1,o)[0];case"stroke":return lg(n.strokes,1,o)[0];case"gradient":return lg(n.sequentialColors,1,o)[0];case"range2":return lg(n.fills,2,o)}return}return e==="gradients"?n.sequentialColors:Yd(n,e)}function tee(e,t,i,s){let n=!1,a,r=!1,o=s;if(Ke(e))n=!0,a=e[1],r=e.length===3,o=r?e[2]:o,e=e[0];else if(!Ji(e)){se.warnOnce(`\`$path\` json operation failed on [${String(e)}] at [${t.join(".")}], expecting a string.`);return}const l=hR(r?[]:t,e);let c=o;for(const h of l){if(!$a(h,c)){if(n)return a;se.warnOnce(`\`$path\` json operation failed on [${String(e)}] at [${t.join(".")}] resolved to [${l.join(".")}], could not find path in object.`);return}c=c[h]}return Object.isFrozen(c)?Bt(c):c}function iee(e,t,i,s){const n=Ji(e)?hR(t,e):t,a=n.length===0?s:Yd(s,n);return Mo(a)!=null}function see([e],t){if(typeof e=="number")return e%2===0;se.warnOnce(`\`$isEven\` json operation failed on [${String(e)}] at [${t.join(".")}], expecting a number.`)}function nee([e,t],i){if(typeof e=="number"&&typeof t=="number")return e*t;se.warnOnce(`\`$mul\` json operation failed on [${String(e)}] and [${String(t)}] at [${i.join(".")}], expecting two numbers.`)}function aee([e],t){if(typeof e=="number")return Math.round(e);se.warnOnce(`\`$round\` json operation failed on [${String(e)}] at [${t.join(".")}], expecting a number.`)}function ree([e,t],i,s,n,a){const r=Mo(t);if(r&&(t=Mg(r.operation,r.values,s,n,i,a)),!Ke(t))return[];const o=Mo(e);return o?(a.matches.set(i.join("."),t),t.map(()=>({[o.operation]:o.values}))):[]}function oee([e,t],i,s,n,a){const r=Mo(t);if(r&&(t=Mg(r.operation,r.values,s,n,i,a)),!Ke(t))return;const o=Mo(e);return o?t.find(l=>Mg(o.operation,o.values,s,l,[],a)):e?t[0]:void 0}function lee(e){if(Ke(e)){for(const t of e)if(!Lt(t))return;return Je(...e)}}function cee([e,t]){if(!(!Ke(e)||!Lt(t)))return be(t,e)}function hee(e,t,i,s,n){var l;if(e!=="$1"&&e!=="$index")return e;const a=t.findLastIndex(c=>!isNaN(Number(c)));if(a===-1)return e;const r=Number(t[a]);if(e==="$index")return r;const o=t.slice(0,a).join(".");return(l=n.matches.get(o))==null?void 0:l.at(r)}function dee([e],t,i){const s="fontSize";if($a(s,i)&&typeof i[s]=="number"&&typeof e=="number")return Math.round(e*i[s]);se.warnOnce(`\`$rem\` json operation failed on [${String(e)}] at [${t.join(".")}], expecting a number.`)}function uee([e,t,i],s){const n=`\`$mix\` json operation failed on [${String(e)}, ${String(t)}, ${String(i)}] at [${s.join(".")}], expecting`,a=`${n} two colors and a number between 0 and 1.`;if(typeof t!="string"||!By(i)){se.warnOnce(a);return}if(typeof e=="string")try{return yt.mix(yt.fromString(e),yt.fromString(t),i).toString()}catch(o){se.warnOnce(a);return}if(!cR(e)){se.warnOnce(a);return}let r=e.colorStops;try{r=r==null?void 0:r.map(o=>{let l;return typeof o.color=="string"&&(l=yt.mix(yt.fromString(o.color),yt.fromString(t),i).toString()),E(b({},o),{color:l})})}catch(o){se.warnOnce(`${n} a gradient, a color and a number between 0 and 1.`);return}return E(b({},e),{colorStops:r})}function pee([e],t,i){const s="foregroundColor",n="backgroundColor";if($a(s,i)&&$a(n,i)&&typeof i[s]=="string"&&typeof i[n]=="string"&&By(e))return yt.mix(yt.fromString(i[s]),yt.fromString(i[n]),e).toString();se.warnOnce(`\`$foregroundBackgroundMix\` json operation failed on [${String(e)}}}] at [${t.join(".")}], expecting a number between 0 and 1.`)}function gee([e,t],i,s){const n="foregroundColor",a="backgroundColor",r="accentColor";if($a(n,s)&&$a(a,s)&&$a(r,s)&&typeof s[n]=="string"&&typeof s[a]=="string"&&typeof s[r]=="string"&&By(e)&&By(t))return yt.mix(yt.mix(yt.fromString(s[n]),yt.fromString(s[a]),e),yt.fromString(s[r]),t).toString();se.warnOnce(`\`$foregroundBackgroundAccentMix\` json operation failed on [${String(e)}, ${String(t)}}] at [${i.join(".")}], expecting two numbers between 0 and 1.`)}function fee([e,t]){if(!(!Ke(e)||!ki(t)))return yt.interpolate(e.map(i=>yt.fromString(i)),t).map(i=>i.toString())}var mee=class{constructor(){this.available=!0,this.acquireQueue=[]}acquire(e){return new Promise(t=>{this.acquireQueue.push([e,t]),this.available&&this.dispatchNext().catch(i=>se.errorOnce(i))})}async acquireImmediately(e){return this.available?(await this.acquire(e),!0):!1}async waitForClearAcquireQueue(){return this.acquire(()=>Promise.resolve(void 0))}async dispatchNext(){var i,s;this.available=!1;let[e,t]=(i=this.acquireQueue.shift())!=null?i:[];for(;e;){try{await e(),t==null||t()}catch(n){se.error("mutex callback error",n),t==null||t()}[e,t]=(s=this.acquireQueue.shift())!=null?s:[]}this.available=!0}},uR=class{constructor(){this.eventListeners=new Map}addEventListener(e,t){if(typeof t!="function")throw new Error("AG Charts - listener must be a Function");const i=this.eventListeners.get(e);i?i.add(t):this.eventListeners.set(e,new Set([t]))}removeEventListener(e,t){const i=this.eventListeners.get(e);i!=null&&(i.delete(t),i.size===0&&this.eventListeners.delete(e))}hasEventListener(e){return this.eventListeners.has(e)}clearEventListeners(){this.eventListeners.clear()}fireEvent(e){var t;(t=this.eventListeners.get(e.type))==null||t.forEach(i=>i(e))}},El=class extends Be{constructor(e=0,t=e,i=e,s=t){super(),this.top=e,this.right=t,this.bottom=i,this.left=s}};I([P],El.prototype,"top",2),I([P],El.prototype,"right",2),I([P],El.prototype,"bottom",2),I([P],El.prototype,"left",2);function vt(e,t){const i=Ke(e)?e:e.split(".");if(i.length===1){const[s]=i;return ah((n,a,r)=>n[s]=r,n=>n[s],t)}return ah((s,n,a)=>y0(s,i,a),s=>Yd(s,i),t)}function yee(e){return ah((t,i,s)=>t[e]=s)}function us(e,t){return ah((i,s,n)=>i[e][t!=null?t:s]=n)}function Dn(e){const{newValue:t,oldValue:i,changeValue:s}=e;return ah((n,a,r,o)=>(r!==o&&(o!==void 0&&(i==null||i.call(n,o)),r!==void 0&&(t==null||t.call(n,r)),s==null||s.call(n,r,o)),r))}function Rl(e){return OE(e)}function vee(e){return pR((t,i)=>Ct().requestAnimationFrame(t),e)}function bee(e){return pR((t,i=0)=>{i===0?queueMicrotask(t):setTimeout(t,i)},e)}function pR(e,t){let i=0,s=!1,n,a;const r=()=>s,o=()=>{s=!1,a==null||a(),a=void 0,n=void 0,i>0&&e(l)},l=()=>{const c=i;i=0,s=!0;const h=t({count:c});if(!h){o();return}h.then(o,o)};return{schedule(c){i===0&&!r()&&e(l,c),i++},async await(){if(r())for(n==null&&(n=new Promise(c=>{a=c}));r();)await n}}}var B0=["blur","change","contextmenu","focus","keydown","keyup","click","dblclick","mouseenter","mousemove","mouseleave","wheel","touchstart","touchmove","touchend","touchcancel"];function su(e,t,i){const{offsetX:s,offsetY:n,clientX:a,clientY:r}=t,{currentX:o,currentY:l}=Do.calcCurrentXY(i,t);return{type:e,offsetX:s,offsetY:n,clientX:a,clientY:r,currentX:o,currentY:l,sourceEvent:t}}function Gy(e,t,i){return{type:e,sourceEvent:t}}var xee={blur:e=>({type:"blur",sourceEvent:e}),change:e=>({type:"change",sourceEvent:e}),contextmenu:(e,t)=>su("contextmenu",e,t),focus:e=>({type:"focus",sourceEvent:e}),keydown:e=>({type:"keydown",sourceEvent:e}),keyup:e=>({type:"keyup",sourceEvent:e}),click:(e,t)=>su("click",e,t),dblclick:(e,t)=>su("dblclick",e,t),mouseenter:(e,t)=>su("mouseenter",e,t),mousemove:(e,t)=>su("mousemove",e,t),mouseleave:(e,t)=>su("mouseleave",e,t),wheel:e=>{const{offsetX:t,offsetY:i,clientX:s,clientY:n}=e,a=e.deltaMode===0?.01:1,r=e.deltaX*a,o=e.deltaY*a;return{type:"wheel",offsetX:t,offsetY:i,clientX:s,clientY:n,deltaX:r,deltaY:o,sourceEvent:e}},touchstart:(e,t)=>Gy("touchstart",e,t),touchmove:(e,t)=>Gy("touchmove",e,t),touchend:(e,t)=>Gy("touchend",e,t),touchcancel:(e,t)=>Gy("touchcancel",e,t)},Do=class{static alloc(e,t,i){return xee[e](t,i)}static isHTMLEvent(e){return B0.includes(e)}static calcCurrentXY(e,t){const i=e.getBoundingClientRect();return{currentX:t.clientX-i.x,currentY:t.clientY-i.y}}},Cee=class{constructor(){this.widgetListeners={},this.sourceListeners={}}initSourceHandler(e,t){var i;(i=this.sourceListeners)!=null||(this.sourceListeners={}),this.sourceListeners[e]=t}lazyGetWidgetListeners(e,t){var s,n,a;var i;if(!(e in((s=this.sourceListeners)!=null?s:{}))){const r=l=>{var h,d;const c=Do.alloc(e,l,t.getElement());for(const u of(d=(h=this.widgetListeners)==null?void 0:h[e])!=null?d:[])u(c,t)},o={};e.startsWith("touch")&&(o.passive=!1),this.initSourceHandler(e,r),t.getElement().addEventListener(e,r,o)}return(n=this.widgetListeners)!=null||(this.widgetListeners={}),(a=(i=this.widgetListeners)[e])!=null||(i[e]=[]),this.widgetListeners[e]}add(e,t,i){this.lazyGetWidgetListeners(e,t).push(i)}remove(e,t,i){const s=this.lazyGetWidgetListeners(e,t),n=s.indexOf(i);n>-1&&s.splice(n,1)}destroy(e){var t;for(const[i,s]of Zt((t=this.sourceListeners)!=null?t:{}))e.getElement().removeEventListener(i,s);this.widgetListeners=void 0,this.sourceListeners=void 0}},See=class{constructor(e,t,i,s){this.glob=e,this.self=t,this.window=Ct(),this.mousegeneral=l=>{l.stopPropagation(),l.stopImmediatePropagation()},this.mousemove=l=>{var c;l.stopPropagation(),l.stopImmediatePropagation(),(c=this.glob.globalMouseDragCallbacks)==null||c.mousemove(l)},this.mouseup=l=>{var c;l.button===0&&(l.stopPropagation(),l.stopImmediatePropagation(),(c=this.glob.globalMouseDragCallbacks)==null||c.mouseup(l),this.destroy())};const{window:n,mousegeneral:a,mousemove:r,mouseup:o}=this;n.addEventListener("mousedown",a,{capture:!0}),n.addEventListener("mouseenter",a,{capture:!0}),n.addEventListener("mouseleave",a,{capture:!0}),n.addEventListener("mouseout",a,{capture:!0}),n.addEventListener("mouseover",a,{capture:!0}),n.addEventListener("mousemove",r,{capture:!0}),n.addEventListener("mouseup",o,{capture:!0}),t.mouseDragger=this,e.globalMouseDragCallbacks=i,e.globalMouseDragCallbacks.mousedown(s)}destroy(){const{window:e,mousegeneral:t,mousemove:i,mouseup:s}=this;e.removeEventListener("mousedown",t,{capture:!0}),e.removeEventListener("mouseenter",t,{capture:!0}),e.removeEventListener("mouseleave",t,{capture:!0}),e.removeEventListener("mouseout",t,{capture:!0}),e.removeEventListener("mouseover",t,{capture:!0}),e.removeEventListener("mousemove",i,{capture:!0}),e.removeEventListener("mouseup",s,{capture:!0}),this.glob.globalMouseDragCallbacks=void 0,this.self.mouseDragger=void 0}};function Mee(e,t,i,s){if(e.globalMouseDragCallbacks==null)return new See(e,t,i,s)}var Dee=500,wee=100;function Aee(e,t){const i=e.clientX-t.clientX,s=e.clientY-t.clientY;return i*i+s*s}var _0=!1,Iee=class{constructor(e,t,i,s,n){this.glob=e,this.self=t,this.initialTouch=s,this.target=n,this.longTapInterrupted=!1,this.longtap=()=>{const{target:o,initialTouch:l}=this;if(!this.longTapInterrupted){o.dispatchEvent(new TouchEvent("touchcancel",{touches:[l],bubbles:!0})),_0=!0;const c=g=>{g.preventDefault()},h=g=>{_0=!1,g.preventDefault(),o.removeEventListener("touchmove",c),o.removeEventListener("touchend",h),o.removeEventListener("touchcancel",h)};o.addEventListener("touchmove",c,{passive:!1}),o.addEventListener("touchend",h,{passive:!1}),o.addEventListener("touchcancel",h,{passive:!1});const{clientX:d,clientY:u}=l,p=new PointerEvent("contextmenu",{bubbles:!0,cancelable:!0,view:Ct(),clientX:d,clientY:u,pointerType:"touch"});o.dispatchEvent(p)}},this.touchmove=o=>{var u;const{glob:l,self:c,initialTouch:h}=this,d=this.findInitialFinger(o.targetTouches);d!=null&&(this.longTapInterrupted=this.longTapInterrupted||Aee(h,d)>wee,c.dragTouchEnabled&&d!=null&&((u=l.globalTouchDragCallbacks)==null||u.touchmove(o,d)))},this.touchend=o=>{var c;this.longTapInterrupted=!0;const l=this.findInitialFinger(o.changedTouches,o.touches);l!=null&&((c=this.glob.globalTouchDragCallbacks)==null||c.touchend(o,l)),this.destroy()},this.longtapTimer=setTimeout(this.longtap,Dee);const{touchmove:a,touchend:r}=this;n.addEventListener("touchmove",a,{passive:!1}),n.addEventListener("touchstart",r,{passive:!1}),n.addEventListener("touchend",r,{passive:!1}),n.addEventListener("touchcancel",r,{passive:!1}),t.touchDragger=this,e.globalTouchDragCallbacks=i}destroy(){const{longtapTimer:e,touchmove:t,touchend:i}=this;clearTimeout(e),this.target.removeEventListener("touchstart",i),this.target.removeEventListener("touchmove",t),this.target.removeEventListener("touchend",i),this.target.removeEventListener("touchcancel",i),this.glob.globalTouchDragCallbacks=void 0,this.self.touchDragger=void 0}findInitialFinger(...e){const t=e.map(i=>Array.from(i)).flat();return Array.from(t).find(i=>i.identifier===this.initialTouch.identifier)}};function Tee(e,t,i,s,n){if(!(e.globalTouchDragCallbacks!=null||_0))return new Iee(e,t,i,s,n)}function G0(e,t,i,s){const{currentX:n,currentY:a}=Do.calcCurrentXY(e.getElement(),s),r=s.pageX-i.pageX,o=s.pageY-i.pageY;return{type:t,device:"mouse",offsetX:i.offsetX+r,offsetY:i.offsetY+o,clientX:s.clientX,clientY:s.clientY,currentX:n,currentY:a,originDeltaX:r,originDeltaY:o,sourceEvent:s}}function kee(e,{pageX:t,pageY:i}){const{x:s,y:n}=e.getElement().getBoundingClientRect();return{offsetX:t-s,offsetY:i-n}}function z0(e,t,i,s,n){const{currentX:a,currentY:r}=Do.calcCurrentXY(e.getElement(),n),o=n.pageX-i.pageX,l=n.pageY-i.pageY;return{type:t,device:"touch",offsetX:i.offsetX+o,offsetY:i.offsetY+l,clientX:n.clientX,clientY:n.clientY,currentX:a,currentY:r,originDeltaX:o,originDeltaY:l,sourceEvent:s}}var gR={},fR=class{constructor(e){this.dispatchCallback=e,this.dragTouchEnabled=!0}destroy(){var e,t,i,s;(e=this.dragTriggerRemover)==null||e.call(this),this.dragTriggerRemover=void 0,(t=this.listeners)==null||t.clear(),(i=this.mouseDragger)==null||i.destroy(),(s=this.touchDragger)==null||s.destroy()}getListenerSet(e){var i;(i=this.listeners)!=null||(this.listeners=new Map);let t=this.listeners.get(e);return t===void 0&&(t=new Set,this.listeners.set(e,t)),t}add(e,t,i){switch(this.getListenerSet(e).add(i),e){case"drag-start":case"drag-move":case"drag-end":{this.registerDragTrigger(t);break}}}remove(e,t,i){this.getListenerSet(e).delete(i)}registerDragTrigger(e){if(this.dragTriggerRemover==null){const t=s=>this.triggerMouseDrag(e,s),i=s=>this.triggerTouchDrag(e,s);e.getElement().addEventListener("mousedown",t),e.getElement().addEventListener("touchstart",i,{passive:!1}),this.dragTriggerRemover=()=>{e.getElement().removeEventListener("mousedown",t),e.getElement().removeEventListener("touchstart",i)}}}triggerMouseDrag(e,t){t.button===0&&this.startMouseDrag(e,t)}startMouseDrag(e,t){const i={pageX:NaN,pageY:NaN,offsetX:NaN,offsetY:NaN};v0(["pageX","pageY","offsetX","offsetY"],i,t);const s={mousedown:n=>{const a=G0(e,"drag-start",i,n);this.dispatch("drag-start",e,a)},mousemove:n=>{const a=G0(e,"drag-move",i,n);this.dispatch("drag-move",e,a)},mouseup:n=>{const a=G0(e,"drag-end",i,n);this.dispatch("drag-end",e,a),this.endDrag(e,a)}};this.mouseDragger=Mee(gR,this,s,t)}endDrag(e,{sourceEvent:t,clientX:i,clientY:s}){var r;const n=e.getElement(),a=n.getBoundingClientRect();nh.containsPoint(a,i,s)||(n.dispatchEvent(new MouseEvent("mouseleave",t)),(r=t.target)==null||r.dispatchEvent(new MouseEvent("mouseenter",t)))}triggerTouchDrag(e,t){const i=t.targetTouches[0];t.targetTouches.length===1&&i!=null&&this.startOneFingerTouch(e,t,i)}startOneFingerTouch(e,t,i){const s=b({pageX:NaN,pageY:NaN},kee(e,i));v0(["pageX","pageY"],s,i);const n={touchmove:(o,l)=>{const c=z0(e,"drag-move",s,o,l);this.dispatch("drag-move",e,c)},touchend:(o,l)=>{const c=z0(e,"drag-end",s,o,l);this.dispatch("drag-end",e,c)}},a=e.getElement();this.touchDragger=Tee(gR,this,n,i,a);const r=z0(e,"drag-start",s,t,i);this.dispatch("drag-start",e,r)}dispatch(e,t,i){for(const s of this.getListenerSet(e))s(i,t);this.dispatchCallback(e,i)}},Lee=class{constructor(e){this.elem=e}setBounds(e){var t;Ny((t=this.elemContainer)!=null?t:this.elem,e)}getBounds(){var e;return aR((e=this.elemContainer)!=null?e:this.elem)}static setElementContainer(e,t){const i=e.getBounds();Ny(t,i),WQ(e.elem,{width:"100%",height:"100%"}),e.elem.remove(),e.elemContainer=t,e.elemContainer.replaceChildren(e.elem)}},Er=class extends Lee{constructor(e){super(e),this.elem=e,this.index=NaN,this.children=[]}set id(e){$e(this.elem,"id",e)}get id(){return Wd(this.elem,"id")}getElement(){return this.elem}getBoundingClientRect(){return this.elem.getBoundingClientRect()}get clientWidth(){return this.elem.clientWidth}get clientHeight(){return this.elem.clientHeight}destroy(){var e,t,i;(e=this.parent)==null||e.removeChild(this),this.children.forEach(s=>{s.parent=void 0,s.destroy()}),this.children.length=0,this.destructor(),this.remove(),(t=this.internalListener)==null||t.destroy(),(i=this.htmlListener)==null||i.destroy(this)}remove(){var e;this.elem.remove(),(e=this.elemContainer)==null||e.remove()}setHidden(e){Tr(this.elem,"display",e?"none":void 0)}isHidden(){var e,t;return((t=(e=Ct())==null?void 0:e.getComputedStyle)==null?void 0:t.call(e,this.elem).display)==="none"}setCursor(e){Tr(this.elem,"cursor",e)}setTextContent(e){this.elem.textContent=e!=null?e:null}setAriaDescribedBy(e){$e(this.elem,"aria-describedby",e)}setAriaHidden(e){$e(this.elem,"aria-hidden",e)}setAriaLabel(e){$e(this.elem,"aria-label",e)}setAriaExpanded(e){$e(this.elem,"aria-expanded",e)}setAriaControls(e){$e(this.elem,"aria-controls",e)}setAriaHasPopup(e){$e(this.elem,"aria-haspopup",e)}setInnerHTML(e){this.elem.innerHTML=e}setPointerEvents(e){Tr(this.elem,"pointer-events",e)}isDisabled(){return Wd(this.elem,"aria-disabled",!1)}hasPopup(){const e=Wd(this.elem,"aria-haspopup");return e!==void 0&&e!=="false"}parseFloat(e){return e===""?0:parseFloat(e)}cssLeft(){return this.parseFloat(this.elem.style.left)}cssTop(){return this.parseFloat(this.elem.style.top)}cssWidth(){return this.parseFloat(this.elem.style.width)}cssHeight(){return this.parseFloat(this.elem.style.height)}focus(e){this.elem.focus(e)}setFocusOverride(e){$e(this.elem,"data-focus-override",e)}setPreventsDefault(e){$e(this.elem,"data-preventdefault",e)}setTabIndex(e){$e(this.elem,"tabindex",e)}addChild(e){this.addChildToDOM(e,this.getBefore(e)),this.children.push(e),e.index=this.children.length-1,e.parent=this,this.onChildAdded(e)}removeChild(e){const t=this.children.findIndex(i=>i===e);this.children.splice(t,1),this.removeChildFromDOM(e),this.onChildRemoved(e)}moveChild(e,t){e.domIndex!==t&&(e.domIndex=t,this.removeChildFromDOM(e),this.addChildToDOM(e,this.getBefore(e)))}addClass(...e){this.elem.classList.add(...e)}removeClass(...e){this.elem.classList.remove(...e)}toggleClass(e,t){this.elem.classList.toggle(e,t)}appendOrInsert(e,t){t?t.getElement().insertAdjacentElement("beforebegin",e):this.elem.appendChild(e)}addChildToDOM(e,t){this.appendOrInsert(e.getElement(),t)}removeChildFromDOM(e){this.elem.removeChild(e.getElement())}onChildAdded(e){}onChildRemoved(e){}getBefore({domIndex:e}){if(e!==void 0)return this.children.filter(t=>t.domIndex!==void 0&&t.domIndex>e).reduce((t,i)=>!t||i.domIndex<t.domIndex?i:t,void 0)}addListener(e,t){var i,s;return Do.isHTMLEvent(e)?((i=this.htmlListener)!=null||(this.htmlListener=new Cee),this.htmlListener.add(e,this,t)):((s=this.internalListener)!=null||(this.internalListener=new fR(this.onDispatch.bind(this))),this.internalListener.add(e,this,t)),()=>this.removeListener(e,t)}removeListener(e,t){var i,s;Do.isHTMLEvent(e)?(i=this.htmlListener)==null||i.remove(e,this,t):this.htmlListener!=null&&((s=this.internalListener)==null||s.remove(e,this,t))}setDragTouchEnabled(e){var t;(t=this.internalListener)!=null||(this.internalListener=new fR(this.onDispatch.bind(this))),this.internalListener.dragTouchEnabled=e}onDispatch(e,t){var s;if(!((s=t.sourceEvent)!=null&&s.bubbles))return;let{parent:i}=this;for(;i!=null;){const{internalListener:n}=i;if(n!=null){const a=b(b({},t),Do.calcCurrentXY(i.getElement(),t));n.dispatch(e,i,a)}i=i.parent}}static addWindowEvent(e,t){const i=s=>{s.persisted||t()};return Ct().addEventListener("pagehide",i),()=>Ct().removeEventListener("pagehide",i)}};function Pee(e=0,t=0){return new OffscreenCanvas(e,t).getContext("2d")}var V0=class{constructor(e=5){this.maxCacheSize=e,this.store=new Map}get(e){if(!this.store.has(e))return;const t=this.store.get(e);return this.store.delete(e),this.store.set(e,t),t}has(e){return this.store.has(e)}set(e,t){if(this.store.set(e,t),this.store.size>this.maxCacheSize){const i=this.store.keys();let s=this.store.size-this.maxCacheSize;for(;s>0;){const n=i.next();n.done||this.store.delete(n.value),s--}}return t}clear(){this.store.clear()}},Rr=class{static measureText(e,t){return this.getMeasurer(t).measureText(e)}static measureLines(e,t){return this.getMeasurer(t).measureLines(e)}static getMeasurer(e){var s,n,a;const t=typeof e.font=="string"?e.font:_t.toFontString(e.font),i=`${t}-${(s=e.textAlign)!=null?s:"start"}-${(n=e.textBaseline)!=null?n:"alphabetic"}`;return(a=this.instanceMap.get(i))!=null?a:this.createFontMeasurer(t,e,i)}static clear(){this.instanceMap.clear()}static createFontMeasurer(e,t,i){var a,r;const s=Pee();s.font=e,s.textAlign=(a=t.textAlign)!=null?a:"start",s.textBaseline=(r=t.textBaseline)!=null?r:"alphabetic";const n=new mR(s,t);return this.instanceMap.set(i,n),n}};Rr.instanceMap=new V0(10);var mR=class{constructor(e,t){var i;this.ctx=e,this.measureMap=new V0(100),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline),e.font=typeof t.font=="string"?t.font:_t.toFontString(t.font),this.textMeasurer=new j0(s=>this.cachedCtxMeasureText(s),(i=t.textBaseline)!=null?i:"alphabetic")}textWidth(e,t){return this.textMeasurer.textWidth(e,t)}measureText(e){return this.textMeasurer.measureText(e)}measureLines(e){return this.textMeasurer.measureLines(e)}cachedCtxMeasureText(e){if(!this.measureMap.has(e)){const t=this.ctx.measureText(e);this.measureMap.set(e,{actualBoundingBoxAscent:t.actualBoundingBoxAscent,emHeightAscent:t.emHeightAscent,emHeightDescent:t.emHeightDescent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,actualBoundingBoxLeft:t.actualBoundingBoxLeft,actualBoundingBoxRight:t.actualBoundingBoxRight,alphabeticBaseline:t.alphabeticBaseline,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent,hangingBaseline:t.hangingBaseline,ideographicBaseline:t.ideographicBaseline,width:t.width})}return this.measureMap.get(e)}},_t=class{static toFontString({fontSize:e=10,fontStyle:t,fontWeight:i,fontFamily:s,lineHeight:n}){let a="";return t&&(a+=`${t} `),i&&(a+=`${i} `),a+=`${e}px`,n&&(a+=`/${n}px`),a+=` ${s}`,a.trim()}static getLineHeight(e){return Math.ceil(e*this.defaultLineHeight)}static getVerticalModifier(e){switch(e){case"hanging":case"top":return 0;case"middle":return .5;case"alphabetic":case"bottom":case"ideographic":default:return 1}}};_t.EllipsisChar="\u2026",_t.defaultLineHeight=1.15,_t.lineSplitter=/\r?\n/g;var j0=class{constructor(e,t="alphabetic"){this.measureTextFn=e,this.textBaseline=t,this.charMap=new Map}getMetrics(e){var i,s;const t=this.measureTextFn(e);return(i=t.fontBoundingBoxAscent)!=null||(t.fontBoundingBoxAscent=t.emHeightAscent),(s=t.fontBoundingBoxDescent)!=null||(t.fontBoundingBoxDescent=t.emHeightDescent),{width:t.width,height:t.actualBoundingBoxAscent+t.actualBoundingBoxDescent,lineHeight:t.fontBoundingBoxAscent+t.fontBoundingBoxDescent,offsetTop:t.actualBoundingBoxAscent,offsetLeft:t.actualBoundingBoxLeft}}getMultilineMetrics(e){var h,d;let t=0,i=0,s=0,n=0,a=0;const r=_t.getVerticalModifier(this.textBaseline),o=[];let l=0;const c=e.length;for(const u of e){const p=this.measureTextFn(u);(h=p.fontBoundingBoxAscent)!=null||(p.fontBoundingBoxAscent=p.emHeightAscent),(d=p.fontBoundingBoxDescent)!=null||(p.fontBoundingBoxDescent=p.emHeightDescent),t<p.width&&(t=p.width),n<p.actualBoundingBoxLeft&&(n=p.actualBoundingBoxLeft),l===0?(i+=p.actualBoundingBoxAscent,s+=p.actualBoundingBoxAscent):a+=p.fontBoundingBoxAscent,l===c-1?i+=p.actualBoundingBoxDescent:a+=p.fontBoundingBoxDescent,o.push({text:u,width:p.width,height:p.actualBoundingBoxAscent+p.actualBoundingBoxDescent,lineHeight:p.fontBoundingBoxAscent+p.fontBoundingBoxDescent,offsetTop:p.actualBoundingBoxAscent,offsetLeft:p.actualBoundingBoxLeft}),l++}return i+=a,s+=a*r,{width:t,height:i,offsetTop:s,offsetLeft:n,lineMetrics:o}}textWidth(e,t){var i;if(t){let s=0;for(let n=0;n<e.length;n++)s+=this.textWidth(e.charAt(n));return s}return e.length>1?this.measureTextFn(e).width:(i=this.charMap.get(e))!=null?i:this.charWidth(e)}measureText(e){return this.getMetrics(e)}measureLines(e){const t=typeof e=="string"?e.split(_t.lineSplitter):e;return this.getMultilineMetrics(t)}charWidth(e){const{width:t}=this.measureTextFn(e);return this.charMap.set(e,t),t}},Yn=class $C extends va{constructor(){super(...arguments),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontSize=10,this.fontFamily="sans-serif",this.textAlign=$C.defaultStyles.textAlign,this.textBaseline=$C.defaultStyles.textBaseline}onTextChange(){var t,i;this.lines=(i=(t=this.text)==null?void 0:t.split(`
`).map(s=>s.trim()))!=null?i:[]}static computeBBox(t,i,s,n){const{offsetTop:a,offsetLeft:r,width:o,height:l}=Rr.measureLines(t,n),c=n.lineHeight?n.lineHeight*t.length:l;return new ve(i-r,s-a,o,c)}computeBBox(){const{x:t,y:i,lines:s,textBaseline:n,textAlign:a,lineHeight:r}=this;return $C.computeBBox(s,t,i,{font:this,textBaseline:n,textAlign:a,lineHeight:r})}getTextMeasureBBox(){return this.computeBBox()}isPointInPath(t,i){const s=this.getBBox();return s?s.containsPoint(t,i):!1}render(t){const{ctx:i,stats:s}=t;if(!this.lines.length||!this.layerManager)return s&&(s.nodesSkipped+=1),super.render(t);const{fill:n,stroke:a,strokeWidth:r}=this,{globalAlpha:o}=i,{pixelRatio:l}=this.layerManager.canvas;if(!n&&!(a!=null&&r>0))return super.render(t);const c=_t.toFontString(this);if(i.font!==c&&(i.font=c),i.textAlign=this.textAlign,i.textBaseline=this.textBaseline,n){this.applyFillAndAlpha(i);const{fillShadow:h}=this;h!=null&&h.enabled&&(i.shadowColor=h.color,i.shadowOffsetX=h.xOffset*l,i.shadowOffsetY=h.yOffset*l,i.shadowBlur=h.blur*l),this.renderLines((d,u,p)=>i.fillText(d,u,p)),i.globalAlpha=o}if(a&&r){this.applyStrokeAndAlpha(i),i.lineWidth=r;const{lineDash:h,lineDashOffset:d,lineCap:u,lineJoin:p}=this;h&&i.setLineDash([...h]),d&&(i.lineDashOffset=d),u&&(i.lineCap=u),p&&(i.lineJoin=p),this.renderLines((g,f,y)=>i.strokeText(g,f,y)),i.globalAlpha=o}super.render(t)}renderLines(t){var o;const{lines:i,x:s,y:n}=this,a=(o=this.lineHeight)!=null?o:_t.getLineHeight(this.fontSize);let r=(a-a*i.length)*_t.getVerticalModifier(this.textBaseline);for(const l of i)t(l,s,n+r),r+=a}setFont(t){this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.fontStyle=t.fontStyle,this.fontWeight=t.fontWeight}setAlign(t){this.textAlign=t.textAlign,this.textBaseline=t.textBaseline}toSVG(){var i,s,n,a,r,o,l;if(!this.visible||!this.text)return;const t=Ti("text");return this.applySvgFillAttributes(t),t.setAttribute("font-family",(s=(i=this.fontFamily)==null?void 0:i.split(",")[0])!=null?s:""),t.setAttribute("font-size",String(this.fontSize)),t.setAttribute("font-style",(n=this.fontStyle)!=null?n:""),t.setAttribute("font-weight",String((a=this.fontWeight)!=null?a:"")),t.setAttribute("text-anchor",{center:"middle",left:"start",right:"end",start:"start",end:"end"}[(r=this.textAlign)!=null?r:"start"]),t.setAttribute("alignment-baseline",{alphabetic:"alphabetic",top:"top",bottom:"bottom",hanging:"hanging",middle:"middle",ideographic:"ideographic"}[(o=this.textBaseline)!=null?o:"alphabetic"]),t.setAttribute("x",String(this.x)),t.setAttribute("y",String(this.y)),t.textContent=(l=this.text)!=null?l:"",{elements:[t]}}};Yn.className="Text",Yn.defaultStyles=E(b({},va.defaultStyles),{textAlign:"start",fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:"sans-serif",textBaseline:"alphabetic"}),I([he()],Yn.prototype,"x",2),I([he()],Yn.prototype,"y",2),I([he({convertor:e=>ni(e)?String(e):e,changeCb:e=>e.onTextChange()})],Yn.prototype,"text",2),I([he()],Yn.prototype,"fontStyle",2),I([he()],Yn.prototype,"fontWeight",2),I([he()],Yn.prototype,"fontSize",2),I([he()],Yn.prototype,"fontFamily",2),I([he()],Yn.prototype,"textAlign",2),I([he()],Yn.prototype,"textBaseline",2),I([he()],Yn.prototype,"lineHeight",2);var is=Yn,yR=class extends tu(is){},nu=class extends tu(hh(is)){},H0=class{static wrapText(e,t){return this.wrapLines(e,t).join(`
`)}static wrapLines(e,t){const i=this.textWrap(e,t);return t.overflow==="hide"&&i.some(s=>s.endsWith(_t.EllipsisChar))?[]:i}static appendEllipsis(e){return e.replace(/[.,]{1,5}$/,"")+_t.EllipsisChar}static truncateLine(e,t,i,s){const n=t.textWidth(_t.EllipsisChar);let a=0,r=0;for(;r<e.length;r++){const o=t.textWidth(e.charAt(r));if(a+o>i)break;a+=o}if(e.length===r&&(!s||a+n<=i))return s?e+_t.EllipsisChar:e;for(e=e.slice(0,r).trimEnd();e.length&&t.textWidth(e)+n>i;)e=e.slice(0,-1).trimEnd();return e+_t.EllipsisChar}static textWrap(e,t){const i=e.split(_t.lineSplitter),s=Rr.getMeasurer(t);if(t.textWrap==="never")return i.map(o=>this.truncateLine(o.trimEnd(),s,t.maxWidth));const n=[],a=t.textWrap==="hyphenate",r=t.textWrap==null||t.textWrap==="on-space";for(const o of i){let l=o.trimEnd();if(l===""){n.push(l);continue}let c=0,h=0,d=0;for(;c<l.length;){const u=l.charAt(c);if(h+=s.textWidth(u),u===" "&&(d=c),h>t.maxWidth){if(c===0)break;const p=s.textWidth(l.slice(0,c+1));if(p<=t.maxWidth){h=p,c++;continue}if(d){const y=this.getWordAt(l,d+1),v=s.textWidth(y);if(v<=t.maxWidth){n.push(l.slice(0,d).trimEnd()),l=l.slice(d).trimStart(),c=0,h=0,d=0;continue}else r&&v>t.maxWidth&&n.push(l.slice(0,d).trimEnd(),this.truncateLine(l.slice(d).trimStart(),s,t.maxWidth,!0))}else r&&n.push(this.truncateLine(l,s,t.maxWidth,!0));if(r){l="";break}const g=a?"-":"";let f=l.slice(0,c).trim();for(;f.length&&s.textWidth(f+g)>t.maxWidth;)f=f.slice(0,-1).trimEnd();if(n.push(f+g),!f.length){l="";break}l=l.slice(f.length).trimStart(),c=-1,h=0,d=0}c++}l&&n.push(l)}return this.avoidOrphans(n,s,t),this.clipLines(n,s,t)}static getWordAt(e,t){const i=e.indexOf(" ",t);return i===-1?e.slice(t):e.slice(t,i)}static clipLines(e,t,i){if(!i.maxHeight)return e;const{height:s,lineMetrics:n}=t.measureLines(e);if(s<=i.maxHeight)return e;for(let a=0,r=0;a<n.length;a++){const{lineHeight:o}=n[a];if(r+=o,r>i.maxHeight){if(i.overflow==="hide")return[];const l=e.slice(0,a||1),c=l.pop();return l.concat(this.truncateLine(c,t,i.maxWidth,!0))}}return e}static avoidOrphans(e,t,i){if(i.avoidOrphans===!1||e.length<2)return;const{length:s}=e,n=e[s-1],a=e[s-2];if(a.length<n.length)return;const r=a.lastIndexOf(" ");if(r===-1||r===a.indexOf(" ")||n.includes(" "))return;const o=a.slice(r+1);t.textWidth(n+o)<=i.maxWidth&&(e[s-2]=a.slice(0,r),e[s-1]=o+" "+n)}},Ht=class extends Be{constructor(){super(...arguments),this.id=Hs(this),this.node=new yR({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(e,t){return e.layoutManager.addListener("layout:complete",()=>this.updateA11yText(e,t))}computeTextWrap(e,t){var l,c;const{text:i,padding:s,wrapping:n}=this,a=Math.min((l=this.maxWidth)!=null?l:1/0,e)-s*2,r=(c=this.maxHeight)!=null?c:t-s*2;if(!isFinite(a)&&!isFinite(r)){this.node.text=i;return}const o=H0.wrapText(i!=null?i:"",{maxWidth:a,maxHeight:r,font:this,textWrap:n});this.node.text=o,this.truncated=o.includes(_t.EllipsisChar)}updateA11yText(e,t){var s,n;const{proxyInteractionService:i}=e;if(this.enabled&&this.text){const a=ai.toCanvas(this.node);if(a){const{id:r}=this;(s=this.proxyText)!=null||(this.proxyText=i.createProxyElement({type:"text",domManagerId:r,where:t})),this.proxyText.textContent=this.text,this.proxyText.setBounds(a),this.proxyText.addListener("mousemove",o=>this.handleMouseMove(e,o)),this.proxyText.addListener("mouseleave",o=>this.handleMouseLeave(e,o))}}else(n=this.proxyText)==null||n.destroy(),this.proxyText=void 0}handleMouseMove(e,t){if(t!=null&&this.enabled&&this.node.visible&&this.truncated){const{x:i,y:s}=ai.toCanvas(this.node),n=t.sourceEvent.offsetX+i,a=t.sourceEvent.offsetY+s;e.tooltipManager.updateTooltip(this.id,{canvasX:n,canvasY:a,showArrow:!1},[{type:"structured",title:this.text}])}}handleMouseLeave(e,t){e.tooltipManager.removeTooltip(this.id)}};Ht.SMALL_PADDING=10,I([P,us("node","visible")],Ht.prototype,"enabled",2),I([P,us("node")],Ht.prototype,"text",2),I([P,us("node")],Ht.prototype,"textAlign",2),I([P,us("node")],Ht.prototype,"fontStyle",2),I([P,us("node")],Ht.prototype,"fontWeight",2),I([P,us("node")],Ht.prototype,"fontSize",2),I([P,us("node")],Ht.prototype,"fontFamily",2),I([P,us("node","fill")],Ht.prototype,"color",2),I([P],Ht.prototype,"spacing",2),I([P],Ht.prototype,"maxWidth",2),I([P],Ht.prototype,"maxHeight",2),I([P],Ht.prototype,"wrapping",2),I([P],Ht.prototype,"padding",2),I([P],Ht.prototype,"layoutStyle",2);var W0=(e=>(e.X="x",e.Y="y",e.Angle="angle",e.Radius="radius",e))(W0||{});function Eee(e){switch(e){case"x":case"y":case"angle":case"radius":return!0;default:return!1}}var U0=(e=>(e[e.Caption=0]="Caption",e[e.Legend=1]="Legend",e[e.ToolbarLeft=2]="ToolbarLeft",e[e.ToolbarBottom=3]="ToolbarBottom",e[e.Navigator=4]="Navigator",e[e.Overlay=5]="Overlay",e))(U0||{}),vR=class{constructor(){this.events=new ag,this.elements=new Map}addListener(e,t){return this.events.on(e,t)}registerElement(e,t){return this.elements.has(e)?this.elements.get(e).add(t):this.elements.set(e,new Set([t])),()=>{var i;return(i=this.elements.get(e))==null?void 0:i.delete(t)}}createContext(e,t){var s;const i=new Ree(e,t);for(const n of Object.values(U0))typeof n=="number"&&((s=this.elements.get(n))==null||s.forEach(a=>a(i)));return i}emitLayoutComplete(e,t){var a,r;const i="layout:complete",{width:s,height:n}=e;this.events.emit(i,{type:i,axes:(a=t.axes)!=null?a:[],chart:{width:s,height:n},clipSeries:(r=t.clipSeries)!=null?r:!1,series:t.series})}},Ree=class{constructor(e,t){this.width=e,this.height=t,this.layoutBox=new ve(0,0,e,t)}},zy=class{constructor(){this.title=new Ht,this.subtitle=new Ht,this.footnote=new Ht}positionCaptions(e){const{title:t,subtitle:i,footnote:s}=this,n=e.layoutBox.height/10;if(t.enabled){const{spacing:a}=t;this.positionCaption("top",t,e.layoutBox,n),this.shrinkLayoutByCaption("top",t,e.layoutBox,a)}i.enabled&&(this.positionCaption("top",i,e.layoutBox,n),this.shrinkLayoutByCaption("top",i,e.layoutBox,i.spacing)),s.enabled&&(this.positionCaption("bottom",s,e.layoutBox,n),this.shrinkLayoutByCaption("bottom",s,e.layoutBox,s.spacing))}positionAbsoluteCaptions(e){const{title:t,subtitle:i,footnote:s}=this,{rect:n}=e.series;for(const a of[t,i,s])if(a.layoutStyle==="overlay"){if(a.textAlign==="left")a.node.x=n.x+a.padding;else if(a.textAlign==="right"){const r=a.node.getBBox();a.node.x=n.x+n.width-r.width-a.padding}}}computeX(e,t){return e==="left"?t.x:e==="right"?t.x+t.width:t.x+t.width/2}positionCaption(e,t,i,s){const n=Math.max(_t.getLineHeight(t.fontSize),s);t.node.x=this.computeX(t.textAlign,i)+t.padding,t.node.y=i.y+(e==="top"?0:i.height)+t.padding,t.node.textBaseline=e,t.computeTextWrap(i.width,n)}shrinkLayoutByCaption(e,t,i,s=0){if(t.layoutStyle==="block"){const n=t.node.getTextMeasureBBox();i.shrink(Math.ceil(e==="top"?n.y-i.y+n.height+s:i.y+i.height-n.y+s),e)}}};I([P],zy.prototype,"title",2),I([P],zy.prototype,"subtitle",2),I([P],zy.prototype,"footnote",2);var Nee=["candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"],Oee=class{constructor(e){this.chartService=e,this.mementoOriginatorKey="chartType"}createMemento(){var t,i;let e=(i=(t=this.chartService.publicApi)==null?void 0:t.getOptions())==null?void 0:i.chartType;return e==null&&(e="candlestick"),e}guardMemento(e){return e==null||Nee.includes(e)}restoreMemento(e,t,i){var n;if(i==null)return;const s={chartType:i};(n=this.chartService.publicApi)==null||n.updateDelta(s).catch(a=>se.error("error restoring state",a))}},K0=class{constructor(){this.destroyFns=[]}destroy(){this.destroyFns.forEach(e=>e()),this.destroyFns.length=0}setFns(e){this.destroy(),this.destroyFns=e}push(...e){this.destroyFns.push(...e)}},au="11.3.2",bR=Symbol("previous-memento-not-found"),Fee=class{constructor(e){this.history=[],this.historyIndex=-1,this.originators=new Map,this.clearState=new Map,this.maxHistoryLength=100,this.debug=ct.create(!0,"history"),this.destroyFns=new K0,this.destroyFns.setFns([e.addListener("series-undo",this.undo.bind(this)),e.addListener("series-redo",this.redo.bind(this))])}destroy(){this.destroyFns.destroy()}addMementoOriginator(e){this.originators.set(e.mementoOriginatorKey,e),this.clearState.set(e.mementoOriginatorKey,e.createMemento()),this.debugEvent("History add originator:",e.mementoOriginatorKey)}clear(){this.debug("History clear:",Object.keys(this.originators)),this.history=[],this.historyIndex=-1;for(const[e,t]of this.originators.entries())this.clearState.set(e,t.createMemento())}record(e,...t){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.length>this.maxHistoryLength&&(this.history=this.history.slice(-this.maxHistoryLength));const i=new Map;for(const s of t){if(!this.originators.has(s.mementoOriginatorKey))throw new Error(`Originator [${s.mementoOriginatorKey}] has not been added to the HistoryManager.`);i.set(s.mementoOriginatorKey,s.createMemento())}this.history.push({label:e,mementos:i}),this.historyIndex=this.history.length-1,this.debugEvent(`History record: [${e}]`)}undo(){const e=this.history[this.historyIndex];if(e){for(const t of e.mementos.keys()){const i=this.findPreviousMemento(t);if(i===bR)throw new Error(`Could not find previous memento for [${t}].`);this.restoreMemento(t,i)}this.historyIndex-=1,this.debugEvent(`History undo: [${e.label}]`)}}redo(){const e=this.history[this.historyIndex+1];if(e){for(const[t,i]of e.mementos.entries())this.restoreMemento(t,i);this.historyIndex+=1,this.debugEvent(`History redo: [${e.label}]`)}}findPreviousMemento(e){for(let t=this.historyIndex-1;t>=0;t--)if(this.history[t].mementos.has(e))return this.history[t].mementos.get(e);return this.clearState.has(e)?this.clearState.get(e):bR}restoreMemento(e,t){var i;(i=this.originators.get(e))==null||i.restoreMemento(au,au,t)}debugEvent(...e){this.debug(...e,this.history.map((t,i)=>i===this.historyIndex?`** ${t.label} **`:t.label))}},xR=class FT{constructor(t){this.version=t.split("-")[0]}save(...t){const i={version:this.version};for(const s of Object.values(t))i[s.mementoOriginatorKey]=this.encode(s,s.createMemento());return i}restore(t,...i){if(typeof t!="object"){se.warnOnce(`Could not restore data of type [${typeof t}], expecting an object, ignoring.`);return}if(t==null){se.warnOnce("Could not restore data of type [null], expecting an object, ignoring.");return}if(!("version"in t)||typeof t.version!="string"){se.warnOnce("Could not restore data, missing [version] string in object, ignoring.");return}for(const s of i){const n=this.decode(s,t[s.mementoOriginatorKey]),a=[];if(!s.guardMemento(n,a)){const r=a.length>0?`

${a.join(`

`)}

`:"";se.warnOnce(`Could not restore [${s.mementoOriginatorKey}] data, value was invalid, ignoring.${r}`,n);return}s.restoreMemento(this.version,t.version,n)}}encode(t,i){try{return JSON.parse(JSON.stringify(i,FT.encodeTypes))}catch(s){throw new Error(`Failed to encode [${t.mementoOriginatorKey}] value [${s}].`,{cause:s})}}decode(t,i){if(i==null)return i;try{return JSON.parse(JSON.stringify(i),FT.decodeTypes)}catch(s){throw new Error(`Failed to decode [${t.mementoOriginatorKey}] value [${s}].`,{cause:s})}}static encodeTypes(t,i){return Mr(this[t])?{__type:"date",value:this[t].toISOString()}:i}static decodeTypes(t,i){return Ve(this[t])&&"__type"in this[t]&&this[t].__type==="date"?new Date(this[t].value):i}},Bee=class{constructor(){this.caretaker=new xR(au),this.state=new Map}setState(e,t){dn(this.state.get(e.mementoOriginatorKey),t)||this.setStateAndRestore(e,t)}setStateAndRestore(e,t){this.state.set(e.mementoOriginatorKey,t),this.restoreState(e)}restoreState(e){const{caretaker:t,state:i}=this;if(!i.has(e.mementoOriginatorKey))return;const s=i.get(e.mementoOriginatorKey);t.restore({version:t.version,[e.mementoOriginatorKey]:s},e)}},_ee=`.ag-charts-wrapper,.ag-charts-wrapper:after,.ag-charts-wrapper:before,.ag-charts-wrapper *,.ag-charts-wrapper *:after,.ag-charts-wrapper *:before{box-sizing:border-box}.ag-charts-wrapper{--align-items: center;--justify-content: center;position:relative;user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ag-charts-wrapper--safe-horizontal{--justify-content: flex-start}.ag-charts-wrapper--safe-vertical{--align-items: flex-start}.ag-charts-tab-guard{width:0%;height:0%;position:absolute;pointer-events:none}.ag-charts-canvas-center{width:100%;height:100%;position:absolute;touch-action:auto;pointer-events:auto;display:flex;align-items:var(--align-items);justify-content:var(--justify-content)}.ag-charts-canvas-container,.ag-charts-canvas{position:relative;user-select:none;-webkit-user-select:none}.ag-charts-canvas-container>*,.ag-charts-canvas>*{pointer-events:none}.ag-charts-canvas canvas{display:block}.ag-charts-series-area{outline:none;pointer-events:auto;position:absolute}.ag-charts-swapchain{top:0;left:0;outline:none;opacity:0;pointer-events:none;position:absolute;width:100%;height:100%}.ag-charts-swapchain:focus-visible{opacity:1}.ag-charts-canvas-proxy,.ag-charts-canvas-overlay{inset:0;pointer-events:none;position:absolute;user-select:none;-webkit-user-select:none}.ag-charts-canvas-overlay>*{position:absolute;pointer-events:auto}.ag-charts-theme-default,.ag-charts-theme-default-dark{--ag-charts-accent-color: #2196f3;--ag-charts-background-color: #fff;--ag-charts-border-color: #dddddd;--ag-charts-foreground-color: #464646;--ag-charts-font-family: Verdana, sans-serif;--ag-charts-font-size: 12px;--ag-charts-font-weight: 400;--ag-charts-padding: 20px;--ag-charts-shadow-color: #00000080;--ag-charts-subtle-text-color: #8c8c8c;--ag-charts-text-color: #464646;--ag-charts-chrome-background-color: #fafafa;--ag-charts-chrome-font-family: Verdana, sans-serif;--ag-charts-chrome-font-size: 12px;--ag-charts-chrome-font-weight: 400;--ag-charts-chrome-subtle-text-color: #8c8c8c;--ag-charts-chrome-text-color: #181d1f;--ag-charts-input-background-color: #fff;--ag-charts-input-text-color: #464646;--ag-charts-crosshair-label-background-color: #fff;--ag-charts-crosshair-label-text-color: #464646;--ag-charts-spacing: 4px;--ag-charts-border-radius: 4px;--ag-charts-icon-size: 16px;--ag-charts-shadow: 0 2px 8px 0 color-mix(in srgb, black 8%, transparent);--ag-charts-focus-shadow: 0 0 0 3px var(--ag-charts-accent-color);--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 12%);--ag-charts-input-border-color: var(--ag-charts-border-color);--ag-charts-input-border-radius: var(--ag-charts-border-radius);--ag-charts-input-focus-border-color: var(--ag-charts-accent-color);--ag-charts-input-focus-text-color: var(--ag-charts-accent-color);--ag-charts-input-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-input-disabled-border-color: var(--ag-charts-border-color);--ag-charts-input-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-input-text-color) 50% );--ag-charts-input-placeholder-text-color: color-mix( in srgb, var(--ag-charts-input-background-color), var(--ag-charts-input-text-color) 60% );--ag-charts-button-background-color: var(--ag-charts-background-color);--ag-charts-button-border-color: var(--ag-charts-border-color);--ag-charts-button-border-radius: var(--ag-charts-border-radius);--ag-charts-button-text-color: var(--ag-charts-text-color);--ag-charts-button-focus-background-color: color-mix( in srgb, var(--ag-charts-button-background-color), var(--ag-charts-accent-color) 12% );--ag-charts-button-focus-border-color: var(--ag-charts-accent-color);--ag-charts-button-focus-text-color: var(--ag-charts-accent-color);--ag-charts-button-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-button-disabled-border-color: var(--ag-charts-border-color);--ag-charts-button-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-chrome-text-color) 50% );--ag-charts-checkbox-background-color: color-mix( in srgb, var(--ag-charts-background-color), var(--ag-charts-foreground-color) 35% );--ag-charts-checkbox-checked-background-color: var(--ag-charts-accent-color);--ag-charts-chrome-font-size-small: var(--ag-charts-chrome-font-size);--ag-charts-chrome-font-size-medium: calc(var(--ag-charts-chrome-font-size) * (13 / 12));--ag-charts-chrome-font-size-large: calc(var(--ag-charts-chrome-font-size) * (14 / 12));--ag-charts-border: solid 1px var(--ag-charts-border-color);--ag-charts-focus-border: solid 1px var(--ag-charts-accent-color);--ag-charts-focus-border-shadow: 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%);--ag-charts-layer-menu: 6;--ag-charts-layer-ui-overlay: 5;--ag-charts-layer-tooltip: 4;--ag-charts-layer-toolbar: 3;--ag-charts-layer-crosshair: 2;--ag-charts-layer-annotations: 1}.ag-charts-theme-default-dark{--ag-charts-shadow: 0 2px 12px 0 color-mix(in srgb, black 33.3%, transparent);--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 22%)}.ag-chart-canvas-wrapper .ag-charts-theme-default{--ag-charts-border-radius: var(--ag-border-radius, 4px);--ag-charts-border: var(--ag-borders-critical, solid 1px) var(--ag-charts-border-color);--ag-charts-focus-shadow: var(--ag-focus-shadow, 0 0 0 3px var(--ag-charts-accent-color));--ag-charts-focus-border-shadow: var( --ag-focus-shadow, 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%) )}.ag-charts-icon{display:block;width:20px;height:20px;speak:none;speak:never;mask:var(--icon) center / contain no-repeat;background-color:currentColor;transition:background-color .25s ease-in-out}.ag-charts-icon-align-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNyAxMGg2djFIN3pNNCA3aDEydjFINHptMSA2aDEwdjFINXoiLz48L3N2Zz4=)}.ag-charts-icon-align-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNCAxMGg2djFINHptMC0zaDEydjFINHptMCA2aDEwdjFINHoiLz48L3N2Zz4=)}.ag-charts-icon-align-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTAgMTBoNnYxaC02ek00IDdoMTJ2MUg0em0yIDZoMTB2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-arrow-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1LjI5MyA0LjVIMTIuNXYtMUgxN3Y0aC0xVjUuMjA3bC05LjY0NiA5LjY0Ny0uNzA4LS43MDh6IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDE2YTIuNSAyLjUgMCAxIDEtNSAwIDIuNSAyLjUgMCAwIDEgNSAwbS0yLjUgMS41YTEuNSAxLjUgMCAxIDAgMC0zIDEuNSAxLjUgMCAwIDAgMCAzIiBmaWxsPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-arrow-down-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02IDhMMS41IDhMMTAgMThMMTguNSA4TDE0IDhMMTQgM0w2IDNMNiA4Wk03IDRMNyA5SDMuNjYyNDRMMTAgMTYuNDU2TDE2LjMzNzYgOUwxMyA5TDEzIDRMNyA0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-arrow-up-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNCAxMkgxOC41TDEwIDJMMS41IDEySDZMNi4wMDAwMiAxN0gxNFYxMlpNMTMgMTZWMTFIMTYuMzM3NkwxMCAzLjU0NDA1TDMuNjYyNDQgMTFIN0w3LjAwMDAyIDE2SDEzWiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-callout-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtNC41MTRhMjYgMjYgMCAwIDAtMi4wMTcgMS41NGwtLjMxNC4yNmMtLjU1LjQ1Ny0xLjExNS45MjYtMS43NiAxLjQtLjY2OS40OTEtMS41NjItLjAxMi0xLjU2Mi0uOFYxNEg0LjVBMS41IDEuNSAwIDAgMSAzIDEyLjV6TTQuNSA0YS41LjUgMCAwIDAtLjUuNXY4YS41LjUgMCAwIDAgLjUuNWgxLjgzM3YzLjM3MmEzNiAzNiAwIDAgMCAxLjY3OC0xLjMzOGwuMzItLjI2NWEyNiAyNiAwIDAgMSAyLjIyNS0xLjY4NWwuMTI2LS4wODRIMTUuNWEuNS41IDAgMCAwIC41LS41di04YS41LjUgMCAwIDAtLjUtLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyAxdjNoMnYxMkg3djNINnYtM0g0VjRoMlYxek01IDVoM3YxMEg1ek0xMSAxNFY2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6bTEtN2gzdjZoLTN6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-close{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtNSA1IDEwIDEwTTUgMTUgMTUgNSIgc3Ryb2tlPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-comment-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy41MTMgMy45OTVhNi41IDYuNSAwIDAgMSA2LjA5OCAxMS40MWMtLjU4OC4zOTMtMS4yMTcuNTM2LTEuODI5LjU4NWExMyAxMyAwIDAgMS0xLjI3LjAxN0EyNyAyNyAwIDAgMCAxMCAxNkg0LjVhLjUuNSAwIDAgMS0uNS0uNVYxMHEwLS4yNDctLjAwNy0uNTEzYy0uMDA4LS40MTYtLjAxNi0uODU3LjAxNy0xLjI2OS4wNS0uNjEyLjE5Mi0xLjI0LjU4NS0xLjgzYTYuNSA2LjUgMCAwIDEgMi45MTgtMi4zOTNtMy41Ni42MWE1LjUgNS41IDAgMCAwLTUuNjQ2IDIuMzRjLS4yNjYuMzk3LS4zNzkuODQyLS40MiAxLjM1NC0uMDMuMzYtLjAyMi43MTgtLjAxNSAxLjEwOFE1IDkuNjg5IDUgMTB2NWg1cS4zMTEuMDAxLjU5My4wMDhjLjM5LjAwNy43NDcuMDE1IDEuMTA4LS4wMTUuNTEyLS4wNDEuOTU3LS4xNTQgMS4zNTUtLjQyYTUuNSA1LjUgMCAwIDAtMS45ODMtOS45NjciIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-crosshair-add-line{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-date-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMiAyaDF2MTZIMnptMTUgMGgxdjE2aC0xeiIgZmlsbD0iIzE4MUQxRiIvPjxwYXRoIGQ9Ik0xMy4xNTcgMTFINXYtMWg3Ljc5M0wxMSA4LjIwN2wuNzA3LS43MDcgMy4xODIgMy4xODItMy4xODIgMy4xODItLjcwNy0uNzA3eiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-date-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMyAySDJ2MTZoMXptMy41MDcgNC44OUw4LjUgNC44OTVWMTBINXYxaDMuNXY3aDF2LTdoNS4wODhsLTEuOTU3IDEuOTU3LjcwNy43MDcgMy4xODItMy4xODJMMTMuMzM4IDcuM2wtLjcwNy43MDdMMTQuNjI0IDEwSDkuNVY0LjkzMmwxLjk1NyAxLjk1Ny43MDctLjcwN0w4Ljk4MiAzIDUuOCA2LjE4MnoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-delete{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTguNDk2IDguOTk2QS41LjUgMCAwIDEgOSA5LjQ5MnY0YS41LjUgMCAxIDEtMSAuMDA4di00YS41LjUgMCAwIDEgLjQ5Ni0uNTA0TTEyIDkuNWEuNS41IDAgMCAwLTEgMHY0YS41LjUgMCAwIDAgMSAweiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTYgNVYzLjVBMi41IDIuNSAwIDAgMSA4LjUgMWgzQTIuNSAyLjUgMCAwIDEgMTQgMy41VjVoMi44MzNhLjUuNSAwIDAgMSAwIDFIMTV2MTAuMjVjMCAuNDE1LS4wNjYuODYzLS4zIDEuMjIxLS4yNTcuMzk0LS42NzIuNjEyLTEuMi42MTJoLTdjLS41MjggMC0uOTQzLS4yMTgtMS4yLS42MTItLjIzNC0uMzU4LS4zLS44MDYtLjMtMS4yMjFWNkgzLjMzM2EuNS41IDAgMCAxIDAtMXptMS0xLjVBMS41IDEuNSAwIDAgMSA4LjUgMmgzQTEuNSAxLjUgMCAwIDEgMTMgMy41VjVIN3pNNiAxNi4yNVY2aDh2MTAuMjVjMCAuMzM1LS4wNTkuNTU0LS4xMzguNjc1LS4wNTUuMDg1LS4xNC4xNTgtLjM2Mi4xNThoLTdjLS4yMjIgMC0uMzA3LS4wNzMtLjM2Mi0uMTU4LS4wOC0uMTIxLS4xMzgtLjM0LS4xMzgtLjY3NSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-disjoint-channel,.ag-charts-icon-disjoint-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTkuMDI4IDE3LjQ2YTIuMjUgMi4yNSAwIDAgMC00LjA5Mi0xLjg1bC05LjUxMS0yLjM3OGEyLjI1IDIuMjUgMCAxIDAtLjIyNS45NzRsOS40NzUgMi4zNjlhMi4yNTEgMi4yNTEgMCAwIDAgNC4zNTMuODg2bS0xLjY2Mi0xLjk2NWExLjI1IDEuMjUgMCAxIDEtLjg4NSAyLjMzOCAxLjI1IDEuMjUgMCAwIDEgLjg4NS0yLjMzOE00LjM0MyAxMy42NjlhMS4yNSAxLjI1IDAgMSAwLTIuMzM4LS44ODUgMS4yNSAxLjI1IDAgMCAwIDIuMzM4Ljg4NU0zLjk3IDguNzY5YTIuMjUgMi4yNSAwIDAgMCAxLjQ1NS0yLjExbDkuNTExLTIuMzc4YTIuMjUgMi4yNSAwIDEgMC0uMjYtLjk2NUw1LjIgNS42ODVhMi4yNSAyLjI1IDAgMSAwLTEuMjMgMy4wODRtLjM3My0yLjU0N2ExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjc1LTMuNDM4YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-drag-handle{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjcuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjxjaXJjbGUgY3g9IjEzLjc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iMTMuNzUiIGN5PSIxMS43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjExLjc1IiByPSIuNzUiIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjUiLz48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iMTEuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA1aDEydjFIMnoiLz48Y2lyY2xlIGN4PSIxNS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4yNSIgY3k9IjE0LjUiIHI9IjEuNzUiIHN0cm9rZT0iIzAwMCIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0xOCAxNUg2di0xaDEyem0wLTQuNUgydi0xaDE2eiIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-trend-based-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJtNC45OTYgMTIuNjc0IDMuMjkxLTUuNzQzLjg2OC40OTctMy4yOTEgNS43NDN6Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4zNTEiIGN5PSIxNC41IiByPSIxLjc1IiBzdHJva2U9IiMwMDAiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTggNmgtN1Y1aDd6bTAgNC41aC03di0xaDd6bTAgNC41SDZ2LTFoMTJ6Ii8+PC9zdmc+)}.ag-charts-icon-fill-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtOC4wNzEgNC4wNi0uOTI0LS45MjQuNzA3LS43MDcgNy4yODggNy4yODgtNC45NSA0Ljk1YTMuNSAzLjUgMCAwIDEtNC45NSAwbC0xLjQxNC0xLjQxNGEzLjUgMy41IDAgMCAxIDAtNC45NXptLjcwNy43MDhMNC41MzYgOS4wMWEyLjUgMi41IDAgMCAwIDAgMy41MzZMNS45NSAxMy45NmEyLjUgMi41IDAgMCAwIDMuNTM1IDBsNC4yNDMtNC4yNDN6bTYuOSA3LjIwMi0uMzQ1LjM2My0uMzQ0LS4zNjNhLjUuNSAwIDAgMSAuNjg4IDBtLS4zNDUgMS4wOGE4IDggMCAwIDAtLjI4LjMyMyA0LjMgNC4zIDAgMCAwLS40MDkuNTgyYy0uMTEzLjIwMS0uMTQ0LjMyNi0uMTQ0LjM3OGEuODMzLjgzMyAwIDAgMCAxLjY2NyAwYzAtLjA1Mi0uMDMxLS4xNzctLjE0NC0uMzc4YTQuMyA0LjMgMCAwIDAtLjQxLS41ODIgOCA4IDAgMCAwLS4yOC0uMzIybS0uMzQ0LTEuMDguMzQ0LjM2My4zNDQtLjM2My4wMDIuMDAyLjAwNC4wMDQuMDEzLjAxMmE2IDYgMCAwIDEgLjIwNi4yMDhjLjEzMS4xMzYuMzA4LjMyNy40ODUuNTQ1LjE3Ni4yMTUuMzYzLjQ2Ny41MDcuNzI0LjEzNy4yNDMuMjczLjU1My4yNzMuODY4YTEuODMzIDEuODMzIDAgMSAxLTMuNjY3IDBjMC0uMzE1LjEzNi0uNjI1LjI3My0uODY4LjE0NC0uMjU3LjMzLS41MDkuNTA3LS43MjRhOSA5IDAgMCAxIC42NDUtLjcwOGwuMDQ2LS4wNDUuMDEzLS4wMTIuMDA0LS4wMDR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-hollow-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1vcGFjaXR5PSIuMTUiIGQ9Ik01IDVoM3YxMEg1eiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTcgMXYzaDJ2MTJIN3YzSDZ2LTNINFY0aDJWMXpNNSA1aDN2MTBINXptNyAyaDN2NmgtM3ptLTEgN1Y2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-horizontal-line,.ag-charts-icon-horizontal-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNLjUgOS41aDcuMzA2YTIuMjUgMi4yNSAwIDAgMSA0LjM4OCAwSDE5LjV2MWgtNy4zMDZhMi4yNSAyLjI1IDAgMCAxLTQuMzg4IDBILjV6bTkuNSAxLjc1YTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-line-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQuMjQyIDIuNzIyYy0uNjEyIDAtMS4yLjI0My0xLjYzMi42NzVsLTEuMzQzIDEuMzQ0YS41LjUgMCAwIDAtLjExMi4xMTJMNC4wNSAxMS45NTljLS4yMDcuMjA3LS4zNi40Ni0uNDQ2Ljc0di4wMDFsLS42OSAyLjc2N3YuMDAyYS44Mi44MiAwIDAgMCAxLjAyMiAxLjAyMWguMDAybDIuNjM0LS44MjJjLjI4LS4wODUuNTM0LS4yMzcuNzQtLjQ0M2w3LjEwNy03LjEwOGEuNS41IDAgMCAwIC4xMTItLjExMmwxLjM0My0xLjM0M2EyLjMwOCAyLjMwOCAwIDAgMC0xLjYzMi0zLjk0TTE0LjEyMiA3bDEuMDQ0LTEuMDQ1YTEuMzA4IDEuMzA4IDAgMSAwLTEuODQ5LTEuODVMMTIuMjcxIDUuMTV6bS0yLjU1OC0xLjE0Mi02LjgwNyA2LjgwOWEuOC44IDAgMCAwLS4xOTYuMzI1bC0uNzUgMi40NjggMi40Ny0uNzQ5YS44LjggMCAwIDAgLjMyNS0uMTk0bDYuODA4LTYuODF6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTcuMzYyIDQuODczLTQuNTk0IDYuNjU0LTQuODUtMy4zMTctNC4yNTEgNi45NzctLjg1NC0uNTJMNy42MTIgNi43OWw0Ljg5OSAzLjM1IDQuMDI4LTUuODM2eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-line-style-dashed{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDR2MUgyem0xMiAwaDR2MWgtNHpNOCA5aDR2MUg4eiIvPjwvc3ZnPg==)}.ag-charts-icon-line-style-dotted{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyLjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSI4LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSIxMi41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjE0LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-line-style-solid{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDE2djFIMnoiLz48L3N2Zz4=)}.ag-charts-icon-line-with-markers-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTk4IDQuODg4LTMuNTU2IDQuOTE4YTIuMjUgMi4yNSAwIDEgMS0zLjg2Ni43NWwtMS40MzItLjlhMi4yNCAyLjI0IDAgMCAxLTIuMDA5LjQzNWwtMy44MjggNi40MjgtLjg2LS41MTJMNi40NSA5LjYyM2EyLjI1IDIuMjUgMCAxIDEgMy41MS0uNzYxbDEuMzI5LjgzNWEyLjI0IDIuMjQgMCAwIDEgMi41NTctLjQ5N2wzLjU0Mi00Ljg5OHptLTQuOTYgNS4xNTNhMS4yNSAxLjI1IDAgMSAwLS42NCAyLjQxOSAxLjI1IDEuMjUgMCAwIDAgLjY0LTIuNDE5TTkuMSA4LjMyMXEuMDY2LS4xOTIuMDY3LS40MDRhMS4yNSAxLjI1IDAgMSAwLS4wNjcuNDA0IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-lock,.ag-charts-icon-locked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMjA3IDMuNzY0YTIuODk0IDIuODk0IDAgMCAwLTIuODk1IDIuODk0VjloNS43ODlWNi42NThhMi44OTQgMi44OTQgMCAwIDAtMi44OTUtMi44OTRNMTQuMSA5VjYuNjU4YTMuODk0IDMuODk0IDAgMSAwLTcuNzg5IDB2Mi4zNDlBMi41IDIuNSAwIDAgMCA0IDExLjV2M0EyLjUgMi41IDAgMCAwIDYuNSAxN2g4YTIuNSAyLjUgMCAwIDAgMi41LTIuNXYtM0EyLjUgMi41IDAgMCAwIDE0LjUgOXpNNi41IDEwQTEuNSAxLjUgMCAwIDAgNSAxMS41djNBMS41IDEuNSAwIDAgMCA2LjUgMTZoOGExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTNhMS41IDEuNSAwIDAgMC0xLjUtMS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-measurer-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibTQuNDYxIDEyLjcxIDEuNTMyLTEuNTMxIDEuNDE0IDEuNDE0LjcwNy0uNzA3TDYuNyAxMC40NzJsMS41MzItMS41MzMgMiAyIC43MDctLjcwNy0yLTIgNi4wMS02LjAxIDIuODMgMi44MjhMNS4wNSAxNy43NzggMi4yMjIgMTQuOTVsMS41MzItMS41MzIgMS40MTQgMS40MTQuNzA3LS43MDd6TS44MDggMTQuOTVsLjcwNy0uNzA3TDE0LjI0MyAxLjUxNWwuNzA3LS43MDcuNzA3LjcwNyAyLjgyOCAyLjgyOC43MDcuNzA3LS43MDcuNzA3TDUuNzU3IDE4LjQ4NWwtLjcwNy43MDctLjcwNy0uNzA3LTIuODI4LTIuODI4em0xMS4wNzgtNi44MzVMMTAuNDcgNi43bC43MDctLjcwNyAxLjQxNSAxLjQxNHptLjgyNC0zLjY1NCAxIDEgLjcwOC0uNzA3LTEtMXoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-note-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtMy4yMWwtMS40NjkgMi41N2ExIDEgMCAwIDEtMS42ODIuMDg1TDcuMjQzIDE0SDQuNUExLjUgMS41IDAgMCAxIDMgMTIuNXpNNC41IDRhLjUuNSAwIDAgMC0uNS41djhhLjUuNSAwIDAgMCAuNS41aDMuMjU3bDIuMTk2IDMuMDc0TDExLjcxIDEzaDMuNzlhLjUuNSAwIDAgMCAuNS0uNXYtOGEuNS41IDAgMCAwLS41LS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNi41IDYuNUEuNS41IDAgMCAxIDcgNmg2YS41LjUgMCAwIDEgMCAxSDdhLjUuNSAwIDAgMS0uNS0uNU02LjUgOS41QS41LjUgMCAwIDEgNyA5aDZhLjUuNSAwIDAgMSAwIDFIN2EuNS41IDAgMCAxLS41LS41IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-ohlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTEzIDExaC0zdi0xaDNWM2gxdjJoNHYxaC00djExaC0xek02IDE3di0yaDN2LTFINlY0SDV2MUgydjFoM3YxMXoiLz48L3N2Zz4=)}.ag-charts-icon-pan-end{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0ibTYuNjQ2IDEzLjgxMy0uMzUzLjM1NC43MDcuNzA3LjM1NC0uMzU0ek0xMS4xNjYgMTBsLjM1NC4zNTQuMzU0LS4zNTQtLjM1NC0uMzU0ek03LjM1NSA1LjQ4IDcgNS4xMjZsLS43MDcuNzA3LjM1My4zNTR6bTAgOS4wNCA0LjE2Ni00LjE2Ni0uNzA3LS43MDgtNC4xNjcgNC4xNjd6bTQuMTY2LTQuODc0TDcuMzU0IDUuNDhsLS43MDguNzA3IDQuMTY3IDQuMTY3ek0xMy4wODMgNXYxMGgxVjV6Ii8+PC9zdmc+)}.ag-charts-icon-pan-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNzkgNS44MzMgOC42MjUgMTBsNC4xNjYgNC4xNjctLjcwNy43MDdMNy4yMSAxMGw0Ljg3My00Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMSAxNC4xNjcgMTEuMzc2IDEwIDcuMjEgNS44MzNsLjcwNy0uNzA3TDEyLjc5IDEwbC00Ljg3MyA0Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-start{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgNXYxMGgxVjV6TTkuNjI0IDEwbDQuMTY2LTQuMTY3LS43MDctLjcwN0w4LjIxIDEwbDQuODc0IDQuODc0LjcwNy0uNzA3eiIvPjwvc3ZnPg==)}.ag-charts-icon-parallel-channel,.ag-charts-icon-parallel-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTcuNzIgNS4zMzFBMi4yNSAyLjI1IDAgMSAwIDE0LjcwNSAzLjZsLTkuNDkgNC41NjJhMi4yNSAyLjI1IDAgMSAwIC4yMDkgMS4wMWw5LjY2Mi00LjY0NmEyLjI1IDIuMjUgMCAwIDAgMi42MzQuODA1bS4zNzMtMi41NDdhMS4yNSAxLjI1IDAgMSAxLTIuMzM4Ljg4NSAxLjI1IDEuMjUgMCAwIDEgMi4zMzgtLjg4NU00LjM0MyA4LjY3YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODVNNS4zMDcgMTYuNzI4YTIuMjUgMi4yNSAwIDEgMS0uNTI1LS44NThsOS45MjMtNC43N2EyLjI1IDIuMjUgMCAxIDEgLjM4MS45MjZ6bS0uOTY0LjI3NGExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjAyMy01LjEwNmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-position-bottom{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzem0zLTNoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgMTNoOHYxSDZ6Ii8+PC9zdmc+)}.ag-charts-icon-position-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMyAxMGgxNHYxSDN6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDdoOHYxSDZ6bTAgNmg4djFINnoiLz48L3N2Zz4=)}.ag-charts-icon-position-top{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzeiIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik02IDdoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDEzaDh2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-price-label-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNC41IDNBMS41IDEuNSAwIDAgMCAzIDQuNVYxM2ExLjUgMS41IDAgMCAwIDEuNSAxLjVoLjgzM3YuMDU3Yy4yNDItLjI5OS41OTctLjUwMyAxLS41NDhWMTMuNUg0LjVBLjUuNSAwIDAgMSA0IDEzVjQuNWEuNS41IDAgMCAxIC41LS41aDExYS41LjUgMCAwIDEgLjUuNXY4YS41LjUgMCAwIDEtLjUuNWgtNC44MThsLS4xMjYuMDg0YTI2IDI2IDAgMCAwLTIuMjI1IDEuNjg1bC0uMzIuMjY1LS4wNjguMDU2YTEuNSAxLjUgMCAwIDEtMi42MDkgMS4zNTRjLjAzMy43NjMuOTA1IDEuMjM4IDEuNTYuNzU2LjY0Ni0uNDc0IDEuMjEtLjk0MyAxLjc2MS0xLjRsLjMxMy0uMjZBMjYgMjYgMCAwIDEgMTAuOTg2IDE0SDE1LjVhMS41IDEuNSAwIDAgMCAxLjUtMS41di04QTEuNSAxLjUgMCAwIDAgMTUuNSAzeiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOC43MTYgMTQuODE1YTIuMjUgMi4yNSAwIDEgMS00LjIxIDEuNTkzIDIuMjUgMi4yNSAwIDAgMSA0LjIxLTEuNTkzbS0xLjY2MiAxLjk2NmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS41IDYuMjI4IDcuMTY3IDguMzc2IDYuNSA3Ljc2MiA5LjUgNWwzIDIuNzYyLS42NjcuNjE0eiIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yIDE4di0xaDE2djF6TTIgM1YyaDE2djF6IiBmaWxsPSIjMTgxRDFGIi8+PC9zdmc+)}.ag-charts-icon-reset{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDQgNC40NDVhNS44MSA1LjgxIDAgMCAwLTcuMjU3IDIuNDUzLjUuNSAwIDAgMS0uODY1LS41MDJBNi44MSA2LjgxIDAgMSAxIDMgOS44MTNhLjUuNSAwIDAgMSAxIDAgNS44MSA1LjgxIDAgMSAwIDguMDQtNS4zNjgiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQuMjg5IDMuMDAyYS41LjUgMCAwIDEgLjUuNXYyLjY1NWgyLjY1NWEuNS41IDAgMCAxIDAgMUg0LjI5YS41LjUgMCAwIDEtLjUtLjVWMy41MDJhLjUuNSAwIDAgMSAuNS0uNSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-settings{--icon: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkIj48cGF0aCBkPSJNMTAgMTNhMyAzIDAgMSAwIDAtNiAzIDMgMCAwIDAgMCA2bTAtMWEyIDIgMCAxIDEtLjAwMS0zLjk5OUEyIDIgMCAwIDEgMTAgMTIiLz48cGF0aCBkPSJNMi4zMSAxNC4zNDVjLS44MTctMS40OTEuMDI3LTIuNDk5LjQ3NC0yLjg2NS41MzEtLjQzNC45NjktLjM2NS45NzItMS40OC0uMDAzLTEuMTE1LS40NDEtMS4wNDYtLjk3Mi0xLjQ4MS0uNDU0LS4zNzEtMS4zMTctMS40MDUtLjQzNC0yLjkzNmwuMDA1LS4wMDljLjg4NC0xLjUyIDIuMjA3LTEuMjkgMi43NTUtMS4wODMuNjQxLjI0My44MDEuNjU2IDEuNzY4LjEwMS45NjQtLjU2LjY4Ni0uOTA0Ljc5Ni0xLjU4Mi4wOTQtLjU3OC41NTktMS44NDMgMi4zMjYtMS44NDNoLjAxYzEuNzU5LjAwNSAyLjIyMiAxLjI2NiAyLjMxNiAxLjg0My4xMS42NzgtLjE2OCAxLjAyMi43OTYgMS41ODIuOTY3LjU1NSAxLjEyNy4xNDIgMS43NjgtLjEwMS41NDktLjIwOCAxLjg3Ni0uNDM4IDIuNzYgMS4wOTJzLjAyIDIuNTY1LS40MzQgMi45MzZjLS41MzEuNDM1LS45NjkuMzY2LS45NzIgMS40ODEuMDAzIDEuMTE1LjQ0MSAxLjA0Ni45NzIgMS40OC40NTQuMzcyIDEuMzE3IDEuNDA2LjQzNCAyLjkzN2wtLjAwNS4wMDljLS44ODQgMS41Mi0yLjIwNyAxLjI5LTIuNzU1IDEuMDgzLS42NDEtLjI0My0uODAxLS42NTYtMS43NjgtLjEwMS0uOTY0LjU2LS42ODYuOTA0LS43OTYgMS41ODEtLjA5NC41NzktLjU1OSAxLjg0NC0yLjMyNiAxLjg0NGgtLjAxYy0xLjc1OS0uMDA1LTIuMjIyLTEuMjY2LTIuMzE2LTEuODQ0LS4xMS0uNjc3LjE2OC0xLjAyMS0uNzk2LTEuNTgxLS45NjctLjU1NS0xLjEyNy0uMTQyLTEuNzY4LjEwMS0uNTQ5LjIwOC0xLjg3Ni40MzgtMi43Ni0xLjA5MmwtLjAyLS4wMzZ6TTkuOTg0IDIuMTYySDEwYzEuMzU1IDAgMS4zNDIgMS4wMzkgMS4zNTMgMS40MjUuMDA4LjMxMi4wNCAxLjE2IDEuMjU5IDEuODcybC4wMTUuMDA4YzEuMjI1LjcgMS45NzYuMzA0IDIuMjUxLjE1NS4zMzctLjE4MyAxLjIyNi0uNzExIDEuOTAyLjQ0NWwuMDA4LjAxNGMuNjc4IDEuMTczLS4yMjkgMS42ODItLjU1OCAxLjg4NC0uMjY2LjE2My0uOTg0LjYxNS0uOTkxIDIuMDI3di4wMTZjLjAwNyAxLjQxMi43MjUgMS44NjQuOTkxIDIuMDI3LjMyOC4yMDEgMS4yMjkuNzA3LjU2NiAxLjg3bC0uMDA4LjAxNGMtLjY3NyAxLjE3NC0xLjU3MS42NDMtMS45MS40NTktLjI3NS0uMTQ5LTEuMDI2LS41NDUtMi4yNTEuMTU0bC0uMDE1LjAwOWMtMS4yMTkuNzEyLTEuMjUxIDEuNTYtMS4yNTkgMS44NzItLjAxMS4zODYuMDAyIDEuNDI1LTEuMzUzIDEuNDI1cy0xLjM0Mi0xLjAzOS0xLjM1My0xLjQyNWMtLjAwOC0uMzEyLS4wNC0xLjE2LTEuMjU5LTEuODcybC0uMDE1LS4wMDljLTEuMjI1LS42OTktMS45NzYtLjMwMy0yLjI1MS0uMTU0LS4zMzYuMTgzLTEuMjE5LjcwNi0xLjg5NC0uNDMybC0uMDE2LS4wMjdjLS42NzgtMS4xNzQuMjI5LTEuNjgyLjU1OC0xLjg4NC4yNjYtLjE2My45ODQtLjYxNS45OTEtMi4wMjd2LS4wMTZjLS4wMDctMS40MTItLjcyNS0xLjg2NC0uOTkxLTIuMDI3LS4zMjgtLjIwMS0xLjIyOS0uNzA3LS41NjYtMS44N2wuMDA4LS4wMTRjLjY3Ny0xLjE3NCAxLjU3MS0uNjQzIDEuOTEtLjQ1OS4yNzUuMTQ5IDEuMDI2LjU0NSAyLjI1MS0uMTU1bC4wMTUtLjAwOGMxLjIxOS0uNzEyIDEuMjUxLTEuNTYgMS4yNTktMS44NzIuMDEtLjM4NC0uMDAyLTEuNDE3IDEuMzM3LTEuNDI1Ii8+PC9zdmc+)}.ag-charts-icon-step-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzE4MUQxRiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiA0aDV2OGgzVjhoNXYxaC00djRoLTVWNUg3djEwSDJ2LTFoNHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-text-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDRIMTZWN0gxNVY1SDEwLjVWMTVIMTRWMTZINlYxNUg5LjVWNUg1VjdINFY0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-trend-line,.ag-charts-icon-trend-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS4zMTQgMTAuOTM4YTIuMjUgMi4yNSAwIDEgMSAuMDEtMWg5LjM1MmEyLjI1IDIuMjUgMCAxIDEgLjAxIDF6bS0yLjE4OS43MjlhMS4yNSAxLjI1IDAgMSAwIDAtMi41IDEuMjUgMS4yNSAwIDAgMCAwIDIuNW0xMy43NSAwYTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-unlock,.ag-charts-icon-unlocked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNjUxIDMuNWEyLjg5NCAyLjg5NCAwIDAgMC0yLjg5NCAyLjg5NFY5SDE0LjVhMi41IDIuNSAwIDAgMSAyLjUgMi41djNhMi41IDIuNSAwIDAgMS0yLjUgMi41aC04QTIuNSAyLjUgMCAwIDEgNCAxNC41di0zQTIuNSAyLjUgMCAwIDEgNi41IDloLjI1N1Y2LjM5NGEzLjg5NCAzLjg5NCAwIDEgMSA3Ljc4OSAwIC41LjUgMCAwIDEtMSAwQTIuODk0IDIuODk0IDAgMCAwIDEwLjY1IDMuNU02LjUgMTBBMS41IDEuNSAwIDAgMCA1IDExLjV2M0ExLjUgMS41IDAgMCAwIDYuNSAxNmg4YTEuNSAxLjUgMCAwIDAgMS41LTEuNXYtM2ExLjUgMS41IDAgMCAwLTEuNS0xLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-vertical-line,.ag-charts-icon-vertical-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNSA3LjgwNmEyLjI1IDIuMjUgMCAwIDEgMCA0LjM4OFYxOS41aC0xdi03LjMwNmEyLjI1IDIuMjUgMCAwIDEgMC00LjM4OFYuNWgxem0tLjUuOTQ0YTEuMjUgMS4yNSAwIDEgMSAwIDIuNSAxLjI1IDEuMjUgMCAwIDEgMC0yLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-zoom-in{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-zoom-out{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS41IDEwYS41LjUgMCAwIDEgLjUtLjVoOGEuNS41IDAgMCAxIDAgMUg2YS41LjUgMCAwIDEtLjUtLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-high-low-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyA0aDJ2MTJINFY0aDNNNSA1aDN2MTBINXpNMTEgMTRWNmg1djhoLTVtMS03aDN2NmgtM3oiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-hlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTYzIDEuODM3LTUuMzM0IDExLjYyMUw2Ljk1NyA4LjEybC00LjE5OSA5LjYyMi0uOTE2LS40IDQuNzU2LTEwLjlMMTIuNDkgMTEuOCAxNy4yNTQgMS40MnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTUuODI1IDIuNzA0LjU1IDEzLjc4NWwuOTAyLjQzIDQuNzI0LTkuOTE5IDYuMDM0IDUuMDI5IDMuMjU1LTguMTQtLjkyOC0uMzctMi43NDUgNi44NnptNy44NTIgMTQuNjM2IDUuNzgtMTMuMTM5LS45MTUtLjQwMi01LjIxOSAxMS44Ni02LjAwNS01LjUwNC0zLjI3OCA3LjY0OC45Mi4zOTQgMi43MjItNi4zNTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-zoom-in-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20taW4iPjxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiLz48bGluZSB4MT0iMjEiIHgyPSIxNi42NSIgeTE9IjIxIiB5Mj0iMTYuNjUiLz48bGluZSB4MT0iMTEiIHgyPSIxMSIgeTE9IjgiIHkyPSIxNCIvPjxsaW5lIHgxPSI4IiB4Mj0iMTQiIHkxPSIxMSIgeTI9IjExIi8+PC9zdmc+)}.ag-charts-icon-zoom-out-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20tb3V0Ij48Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4Ii8+PGxpbmUgeDE9IjIxIiB4Mj0iMTYuNjUiIHkxPSIyMSIgeTI9IjE2LjY1Ii8+PGxpbmUgeDE9IjgiIHgyPSIxNCIgeTE9IjExIiB5Mj0iMTEiLz48L3N2Zz4=)}.ag-charts-input{--input-layer-active: 1;--input-layer-focus: 2;--input-padding: calc(var(--ag-charts-spacing) * 2);--input-padding-large: calc(var(--ag-charts-spacing) * 2.5);color:var(--ag-charts-input-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);transition-duration:.25s;transition-property:none;transition-timing-function:ease-out}.ag-charts-input:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--input-layer-focus)}.ag-charts-button{background:var(--ag-charts-button-background-color);border:1px solid var(--ag-charts-border-color);border-radius:var(--ag-charts-button-border-radius);color:var(--ag-charts-button-text-color);cursor:pointer;padding:var(--input-padding);transition-property:background,border-color}.ag-charts-button:hover{background:var(--ag-charts-focus-color)}.ag-charts-button:has(.ag-charts-icon){padding:2px}.ag-charts-checkbox{--checkbox-transition-duration: .1s;appearance:none;background:var(--ag-charts-checkbox-background-color);border-radius:calc(var(--ag-charts-border-radius) * 9);cursor:pointer;height:18px;margin:0;transition-duration:var(--checkbox-transition-duration);transition-property:margin;width:29px}.ag-charts-checkbox:before{display:block;background:var(--ag-charts-input-background-color);border-radius:calc(var(--ag-charts-border-radius) * 7);content:" ";height:14px;margin:2px;transition-duration:var(--checkbox-transition-duration);transition-property:margin;transition-timing-function:var(--ag-charts-input-transition-easing);width:14px}.ag-charts-checkbox:checked{background:var(--ag-charts-checkbox-checked-background-color)}.ag-charts-checkbox:checked:before{margin-left:13px}.ag-charts-select{background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-input-border-color);border-radius:var(--ag-charts-input-border-radius);padding:3px 2px 4px;font-size:inherit}.ag-charts-textarea{--textarea-line-height: 1.38;background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-border-color);border-radius:var(--ag-charts-input-border-radius);line-height:var(--textarea-line-height);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);padding:var(--input-padding-large) var(--input-padding)}.ag-charts-textarea::placeholder{color:var(--ag-charts-input-placeholder-text-color)}.ag-charts-proxy-container{pointer-events:none;position:absolute}.ag-charts-proxy-elem{-webkit-appearance:none;appearance:none;background:none;border:none;color:#0000;overflow:hidden;pointer-events:auto;position:absolute}.ag-charts-proxy-elem::-moz-range-thumb,.ag-charts-proxy-elem::-moz-range-track{opacity:0}.ag-charts-proxy-elem::-webkit-slider-runnable-track,.ag-charts-proxy-elem::-webkit-slider-thumb{opacity:0}.ag-charts-proxy-elem:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-focus-indicator{position:absolute;display:block;pointer-events:none;user-select:none;-webkit-user-select:none;width:100%;height:100%}.ag-charts-focus-indicator>div{position:absolute;outline:solid 1px var(--ag-charts-chrome-background-color);box-shadow:var(--ag-charts-focus-shadow)}.ag-charts-focus-indicator>svg{width:100%;height:100%;fill:none;overflow:visible}.ag-charts-focus-svg-outer-path{stroke:var(--ag-charts-chrome-background-color);stroke-width:4px}.ag-charts-focus-svg-inner-path{stroke:var(--ag-charts-accent-color);stroke-width:2px}.ag-charts-overlay{color:#181d1f;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay{color:#fff}.ag-charts-overlay--loading{color:#8c8c8c}.ag-charts-overlay__loading-background{background:#fff;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay .ag-charts-overlay__loading-background{background:#192232}.ag-charts-tooltip{--tooltip-arrow-size: 8px;--tooltip-row-spacing: 8px;--tooltip-column-spacing: 16px;position:fixed;inset:unset;margin:0;padding:0;overflow:visible;top:var(--top, 0px);left:var(--left, 0px);width:max-content;max-width:100%;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);color:var(--ag-charts-chrome-text-color);background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);border-radius:var(--ag-charts-border-radius);box-shadow:var(--ag-charts-shadow)}.ag-charts-tooltip--compact .ag-charts-tooltip-content{--tooltip-row-spacing: 2px;--tooltip-column-spacing: 8px;padding:3px 6px}.ag-charts-tooltip--arrow-top:before,.ag-charts-tooltip--arrow-right:before,.ag-charts-tooltip--arrow-bottom:before,.ag-charts-tooltip--arrow-left:before{content:"";position:absolute;display:block;width:var(--tooltip-arrow-size);height:var(--tooltip-arrow-size);border:inherit;border-bottom-color:transparent;border-right-color:transparent;background:inherit;clip-path:polygon(0 0,100% 0,100% 1px,1px 100%,0 100%)}.ag-charts-tooltip--arrow-top:before{bottom:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * .5)) rotate(45deg)}.ag-charts-tooltip--arrow-bottom:before{top:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * -.5)) rotate(225deg)}.ag-charts-tooltip--arrow-left:before{right:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * .5)) rotate(315deg)}.ag-charts-tooltip--arrow-right:before{left:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * -.5)) rotate(135deg)}.ag-charts-tooltip--no-interaction{pointer-events:none;user-select:none;-webkit-user-select:none}.ag-charts-tooltip--wrap-always{overflow-wrap:break-word;word-break:break-word;hyphens:none}.ag-charts-tooltip--wrap-hyphenate{overflow-wrap:break-word;word-break:break-word;hyphens:auto}.ag-charts-tooltip--wrap-on-space{overflow-wrap:normal;word-break:normal}.ag-charts-tooltip--wrap-never{white-space:nowrap}.ag-charts-tooltip-heading,.ag-charts-tooltip-title,.ag-charts-tooltip-label,.ag-charts-tooltip-value{overflow:hidden;text-overflow:ellipsis}.ag-charts-tooltip-content{display:grid;grid:auto-flow minmax(1em,auto) / 1fr;padding:8px 12px;gap:var(--tooltip-row-spacing)}.ag-charts-tooltip-content:has(.ag-charts-tooltip-symbol){grid:auto-flow minmax(1em,auto) / auto 1fr}.ag-charts-tooltip-heading{grid-column:1 / -1}.ag-charts-tooltip-symbol{grid-column:1 / 2;place-self:center}.ag-charts-tooltip-symbol svg{display:block}.ag-charts-tooltip-title{grid-column:-2 / -1}.ag-charts-tooltip-row{grid-column:1 / -1;display:flex;gap:var(--tooltip-column-spacing);align-items:baseline;justify-content:space-between;overflow:hidden}.ag-charts-tooltip-row--inline{grid-column:-2 / -1}.ag-charts-tooltip-label{flex:1;min-width:0}.ag-charts-tooltip-value{min-width:0}.ag-charts-tooltip-footer{grid-column:1 / -1;color:var(--ag-charts-chrome-subtle-text-color);text-align:center}.ag-charts-popover{position:absolute;border:var(--ag-charts-border);border-radius:var(--ag-charts-border-radius);background:var(--ag-charts-chrome-background-color);color:var(--ag-charts-chrome-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);box-shadow:var(--ag-charts-shadow);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-menu{--item-padding: 6px 12px;--icon-color: var(--ag-charts-chrome-text-color);display:grid;grid:auto-flow auto / 1fr;column-gap:12px;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-menu:has(.ag-charts-menu__icon,.ag-charts-menu__row--stroke-width-visible){grid:auto-flow auto / auto 1fr}.ag-charts-menu__row--stroke-width-visible:before{content:"";height:var(--strokeWidth);width:12px;background:var(--icon-color)}.ag-charts-menu__row--stroke-width-visible[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-menu__row{display:grid;grid-column:1 / -1;grid-template-columns:subgrid;align-items:center;padding:var(--item-padding)}.ag-charts-menu__row:not(.ag-charts-menu__row--active){cursor:pointer}.ag-charts-menu__row:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.ag-charts-menu__row:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.ag-charts-menu__row:focus{background:var(--ag-charts-focus-color)}.ag-charts-menu__row:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--ag-charts-layer-menu)}.ag-charts-menu__row--active{--icon-color: var(--ag-charts-accent-color);background:var(--ag-charts-focus-color);color:var(--ag-charts-accent-color)}.ag-charts-menu__label{grid-column:-1 / span 1}.ag-charts-toolbar{--toolbar-gap: calc(var(--ag-charts-spacing) * 2);--toolbar-size: 34px;--toolbar-button-padding: 6px;align-items:center;display:flex;flex-wrap:nowrap;position:absolute}.ag-charts-toolbar__button{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);color:var(--ag-charts-chrome-text-color);cursor:pointer;display:flex;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-medium);font-weight:var(--ag-charts-chrome-font-weight);justify-content:center;min-height:var(--toolbar-size);min-width:var(--toolbar-size);padding:var(--toolbar-button-padding);position:relative;transition:background-color .25s ease-in-out,border-color .25s ease-in-out,color .25s ease-in-out;white-space:nowrap}.ag-charts-toolbar__button:hover{background:var(--ag-charts-focus-color);z-index:1}.ag-charts-toolbar__button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-toolbar__button--active{background:var(--ag-charts-focus-color);border-color:var(--ag-charts-accent-color);color:var(--ag-charts-accent-color);z-index:2}.ag-charts-toolbar__button[aria-disabled=true]{background:var(--ag-charts-button-disabled-background-color);color:var(--ag-charts-button-disabled-text-color);cursor:default}.ag-charts-toolbar--horizontal{flex-direction:row;.ag-charts-toolbar__button{margin:0 0 0 -1px}.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar--vertical{flex-direction:column;.ag-charts-toolbar__button{margin:-1px 0 0;max-width:100%}.ag-charts-toolbar__button--first{border-top-left-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-left-radius:var(--ag-charts-border-radius);border-bottom-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{margin-left:var(--toolbar-gap)}.ag-charts-toolbar__icon,.ag-charts-toolbar__label{pointer-events:none}.ag-charts-floating-toolbar{border:none;display:flex;.ag-charts-toolbar{align-items:unset;position:unset}}.ag-charts-floating-toolbar__drag-handle{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);cursor:grab;display:flex;justify-content:center;min-width:24px;padding-left:0;padding-right:0}.ag-charts-floating-toolbar__drag-handle--dragging{cursor:grabbing}
`,Nl=class{constructor(){this.registeredListeners=new Map}addListener(e,t){const i={symbol:Symbol(e),handler:t};return this.registeredListeners.has(e)?this.registeredListeners.get(e).push(i):this.registeredListeners.set(e,[i]),()=>this.removeListener(i.symbol)}removeListener(e){for(const[t,i]of this.registeredListeners.entries()){const s=i.findIndex(n=>n.symbol===e);if(s>=0){i.splice(s,1),i.length===0&&this.registeredListeners.delete(t);break}}}dispatch(e,...t){for(const i of this.getListenersByType(e))try{i.handler(...t)}catch(s){se.errorOnce(s)}}getListenersByType(e){var t;return(t=this.registeredListeners.get(e))!=null?t:[]}destroy(){this.registeredListeners.clear()}},wo=class{constructor(){this.listeners=new Nl,this.destroyFns=[],this.destroyed=!1}addListener(e,t){return this.listeners.addListener(e,t)}destroy(){this.listeners.destroy(),this.destroyFns.forEach(e=>e()),this.destroyed=!0}},Gee=class YC{constructor(t,i,s){this.element=t,this.topTabGuard=i,this.bottomTabGuard=s,this.destroyFns=[],this.guardTabIndex=0,this.hasFocus=!1,this.initTabGuard(this.topTabGuard,n=>this.onTab(n,!1)),this.initTabGuard(this.bottomTabGuard,n=>this.onTab(n,!0)),this.element.addEventListener("focus",()=>this.onFocus(),{capture:!0}),this.element.addEventListener("blur",n=>this.onBlur(n),{capture:!0})}set tabIndex(t){this.guardTabIndex=t,this.guardTabIndex===0?this.setGuardIndices(void 0):this.hasFocus||this.setGuardIndices(this.guardTabIndex)}destroy(){for(const t of this.destroyFns)t();this.destroyFns.length=0}initTabGuard(t,i){const s=()=>i(t);t.addEventListener("focus",s),this.destroyFns.push(()=>t.removeEventListener("focus",s))}setGuardIndices(t){const i=t;$e(this.topTabGuard,"tabindex",i),$e(this.bottomTabGuard,"tabindex",i)}onFocus(){this.hasFocus=!0,this.guardTabIndex!==0&&this.setGuardIndices(0)}onBlur({relatedTarget:t}){const{topTabGuard:i,bottomTabGuard:s}=this;this.hasFocus=!1,this.guardTabIndex!==0&&t!==i&&t!==s&&this.setGuardIndices(this.guardTabIndex)}onTab(t,i){if(this.guardTabIndex!==0){let s;t.tabIndex===0?(s=this.findExitTarget(!i),this.setGuardIndices(this.guardTabIndex)):s=this.findEnterTarget(i),s==null||s.focus()}}static queryFocusable(t,i){const s=Ct();return Array.from(t.querySelectorAll(i)).filter(n=>{if(n instanceof HTMLElement){const a=s.getComputedStyle(n);return a.display!=="none"&&a.visibility!=="none"}return!1})}findEnterTarget(t){const i=YC.queryFocusable(this.element,'[tabindex="0"]'),s=t?i.length-1:0;return i[s]}findExitTarget(t){const i=YC.queryFocusable(Sr(),"[tabindex]").filter(a=>a.tabIndex>0).sort((a,r)=>a.tabIndex-r.tabIndex),{before:s,after:n}=YC.findBeforeAndAfter(i,this.guardTabIndex);return t?s:n}static findBeforeAndAfter(t,i){let s=0,n=t.length-1,a,r;for(;s<=n;){const o=Math.floor((s+n)/2),l=t[o].tabIndex;if(l===i){a=t[o-1]||void 0,r=t[o+1]||void 0;break}else l<i?(a=t[o],s=o+1):(r=t[o],n=o-1)}return{before:a,after:r}}};function Nr(e,t,i,s,n){t.addEventListener(i,s);const a=()=>t.removeEventListener(i,s,n);return e.push(a),a}function Vy(e,t,i,s=["Escape"]){Nr(e,t,"keydown",n=>{jy(n,...s)&&i(n)})}function $0(e,t,i){const s=Nr(e,window,"mousedown",n=>{[0,2].includes(n.button)&&!CR(t,n)&&(i(),s())});return s}function Y0(e,t,i){const s=Nr(e,window,"touchstart",n=>{Array.from(n.targetTouches).some(r=>!CR(t,r))&&(i(),s())});return s}function CR(e,t){return t.target instanceof Node&&e.contains(t.target)}function X0(e,t,i,s){i.forEach(a=>$e(a,"data-focus-visible-override",s)),Nr(e,t,"keydown",()=>{i.forEach(a=>$e(a,"data-focus-visible-override",!0))},{once:!0})}function Dg(e){return!(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)}function jy(e,...t){return Dg(e)&&t.some(i=>e.key===i)}function SR(e,t,i,s){i&&Nr(e,t,"keydown",n=>{jy(n,s)&&i.focus()})}function zee(e,t,i,s,n,a){SR(e,t,n,a),SR(e,t,i,s),Nr(e,t,"keydown",r=>{jy(r,s,a)&&r.preventDefault()})}var ru={horizontal:{nextKey:"ArrowRight",prevKey:"ArrowLeft"},vertical:{nextKey:"ArrowDown",prevKey:"ArrowUp"}};function MR(e){const{orientation:t,buttons:i,wrapAround:s=!1,onEscape:n,onFocus:a,onBlur:r}=e,{nextKey:o,prevKey:l}=ru[t],c=p=>{p.target&&"tabIndex"in p.target&&(i.forEach(g=>g.tabIndex=-1),p.target.tabIndex=0)},[h,d]=s?[i.length,i.length]:[0,1/0],u=[];for(let p=0;p<i.length;p++){const g=i[(h+p-1)%d],f=i[p],y=i[(h+p+1)%d];Nr(u,f,"focus",c),a&&Nr(u,f,"focus",a),r&&Nr(u,f,"blur",r),n&&Vy(u,f,n),zee(u,f,y,o,g,l),f.tabIndex=p===0?0:-1}return u}var Vee=class{constructor(e,t,i){this.lastFocus=t,this.closeCallback=i,this.destroyFns=[],this.destroyFns.push($0(this.destroyFns,e,()=>this.close(!0))),this.destroyFns.push(Y0(this.destroyFns,e,()=>this.close(!0)))}close(e){this.destroyFns.forEach(t=>t()),this.destroyFns.length=0,this.closeCallback(),this.finishClosing(e)}finishClosing(e){var t;this.destroyFns.forEach(i=>i()),this.destroyFns.length=0,$e(this.lastFocus,"aria-expanded",!1),e||(t=this.lastFocus)==null||t.focus({preventScroll:!0}),this.lastFocus=void 0}};function DR(e){var p;const{sourceEvent:t,orientation:i,menu:s,buttons:n,closeCallback:a,overrideFocusVisible:r}=e,{nextKey:o,prevKey:l}=ru[i],c=Hy(t);$e(c,"aria-expanded",!0);const h=new Vee(s,c,a),d=()=>h.close(),{destroyFns:u}=h;return s.role="menu",s.ariaOrientation=i,u.push(...MR({orientation:i,buttons:n,onEscape:d,wrapAround:!0})),s.tabIndex=-1,Vy(u,s,d),Nr(u,s,"keydown",g=>{var f;g.target===s&&(g.key===o||g.key===l)&&(g.preventDefault(),(f=n[0])==null||f.focus())}),(p=n[0])==null||p.focus({preventScroll:!0}),r!==void 0&&X0(u,s,n,r),h}function jee(e,t){return i=>{if(e.ariaDisabled==="true")return i.preventDefault();t(i)}}function Z0(e){return"button"in e?e.button===0:Dg(e)&&(e.code==="Space"||e.key==="Enter")}function Hy(e){if((e==null?void 0:e.target)instanceof HTMLElement&&"tabindex"in e.target.attributes)return e.target}function wR(e){const t=i=>{if(i.defaultPrevented)return;Wd(i.target,"data-preventdefault",!0)&&jy(i,"ArrowRight","ArrowLeft","ArrowDown","ArrowUp")&&i.preventDefault()};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}var Hee=class{constructor(e){var t;this.callback=e,this.devicePixelRatio=(t=Ct("devicePixelRatio"))!=null?t:1,this.devicePixelRatioMediaQuery=void 0,this.devicePixelRatioListener=i=>{var s;i.matches||(this.devicePixelRatio=(s=Ct("devicePixelRatio"))!=null?s:1,this.unregisterDevicePixelRatioListener(),this.registerDevicePixelRatioListener(),this.callback(this.pixelRatio))}}get pixelRatio(){return this.devicePixelRatio}observe(){this.registerDevicePixelRatioListener()}disconnect(){this.unregisterDevicePixelRatioListener()}unregisterDevicePixelRatioListener(){var e;(e=this.devicePixelRatioMediaQuery)==null||e.removeEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=void 0}registerDevicePixelRatioListener(){var t;const e=(t=Ct("matchMedia"))==null?void 0:t(`(resolution: ${this.pixelRatio}dppx)`);e==null||e.addEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=e}},AR=class{constructor(){var t;this.elements=new Map,this.documentReady=!1,this.queuedObserveRequests=[],this.onLoad=()=>{this.documentReady=!0,this.queuedObserveRequests.forEach(([i,s])=>this.observe(i,s)),this.queuedObserveRequests=[],this.observeWindow()},typeof ResizeObserver!="undefined"&&(this.resizeObserver=new ResizeObserver(i=>{for(const{target:s,contentRect:{width:n,height:a}}of i){const r=this.elements.get(s);this.checkSize(r,s,n,a)}}));let e;this.pixelRatioObserver=new Hee(()=>{clearTimeout(e),e=setTimeout(()=>this.checkPixelRatio(),0)}),this.documentReady=Sr("readyState")==="complete",this.documentReady?this.observeWindow():(t=Ct())==null||t.addEventListener("load",this.onLoad)}destroy(){var e,t,i;(e=Ct())==null||e.removeEventListener("load",this.onLoad),(t=this.resizeObserver)==null||t.disconnect(),this.resizeObserver=void 0,(i=this.pixelRatioObserver)==null||i.disconnect(),this.pixelRatioObserver=void 0}observeWindow(){var e;(e=this.pixelRatioObserver)==null||e.observe()}checkPixelRatio(){var t,i;const e=(i=(t=this.pixelRatioObserver)==null?void 0:t.pixelRatio)!=null?i:1;for(const[s,n]of this.elements)if(n.size!=null&&n.size.pixelRatio!==e){const{width:a,height:r}=n.size;n.size={width:a,height:r,pixelRatio:e},n.cb(n.size,s)}}checkSize(e,t,i,s){var n,a,r,o;if(e&&(i!==((n=e.size)==null?void 0:n.width)||s!==((a=e.size)==null?void 0:a.height))){const l=(o=(r=this.pixelRatioObserver)==null?void 0:r.pixelRatio)!=null?o:1;e.size={width:i,height:s,pixelRatio:l},e.cb(e.size,t)}}observe(e,t){var s;if(!this.documentReady){this.queuedObserveRequests.push([e,t]);return}this.elements.has(e)?this.removeFromQueue(e):(s=this.resizeObserver)==null||s.observe(e);const i={cb:t};this.elements.set(e,i)}unobserve(e){var t;(t=this.resizeObserver)==null||t.unobserve(e),this.elements.delete(e),this.removeFromQueue(e),this.elements.size||this.destroy()}removeFromQueue(e){this.queuedObserveRequests=this.queuedObserveRequests.filter(([t])=>t!==e)}},ou=class extends Map{constructor(e,t){super(),this.defaultValue=e,this.defaultState=t}set(e,t){return this.delete(e),typeof t!="undefined"&&super.set(e,t),this}stateId(){var e;return(e=Array.from(this.keys()).pop())!=null?e:this.defaultState}stateValue(){var e;return(e=Array.from(this.values()).pop())!=null?e:this.defaultValue}},Wee='<div role="presentation" class="ag-charts-wrapper ag-charts-styles" data-ag-charts><div role="presentation" class="ag-charts-canvas-center"><div role="presentation" class="ag-charts-canvas-container"><div role="presentation" class="ag-charts-canvas" aria-hidden="true"></div><div role="figure" class="ag-charts-canvas-proxy"><div role="presentation" class="ag-charts-series-area"></div></div><div role="presentation" class="ag-charts-canvas-overlay ag-charts-tooltip-container"></div></div></div></div>',Uee=["styles","canvas","canvas-center","canvas-container","canvas-overlay","canvas-proxy","series-area","tooltip-container"],Kee=new Set(["canvas-container","canvas","tooltip-container"]),IR={safeHorizontal:"ag-charts-wrapper--safe-horizontal",safeVertical:"ag-charts-wrapper--safe-vertical"},$ee=new Map([["styles",{childElementType:"style"}],["canvas",{childElementType:"canvas"}],["canvas-proxy",{childElementType:"div"}],["canvas-overlay",{childElementType:"div"}],["canvas-center",{childElementType:"div"}],["series-area",{childElementType:"div"}],["tooltip-container",{childElementType:"div"}]]);function Yee(e,t){if(typeof IntersectionObserver=="undefined")return;const i=new IntersectionObserver(s=>{for(const n of s)n.target===e&&t(n.intersectionRatio)},{root:e});return i.observe(e),i}var TR={x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0,toJSON(){return TR}};function kR(e,t){const i=ke("div");return i.className="ag-charts-tab-guard",e.insertAdjacentElement(t,i),i}var q0=class kd extends wo{constructor(t,i,s,n="normal"){super(),this.chart=t,this.styleContainer=s,this.mode=n,this.anchorName=`--${Hs(this)}`,this.styles=new Map,this.pendingContainer=void 0,this.container=void 0,this.documentRoot=void 0,this.initiallyConnected=void 0,this.containerSize=void 0,this.sizeMonitor=new AR,this.cursorState=new ou("default"),this.minWidth=0,this.minHeight=0,this.element=this.initDOM(),this.rootElements=this.initRootElements(),this.rootElements.canvas.element.style.setProperty("anchor-name",this.anchorName);let a=!1;if(this.observer=Yee(this.element,r=>{r===0&&!a&&this.listeners.dispatch("hidden",{type:"hidden"}),a=r===0}),this.setSizeOptions(),this.updateContainerSize(),this.addStyles("ag-charts-community",_ee),this.setContainer(i),this.destroyFns.push(wR(this.element)),this.mode==="normal"){const r=this.rootElements["canvas-center"].element;if(r==null)throw new Error("Error initializing tab guards");const o=kR(r,"beforebegin"),l=kR(r,"afterend");this.tabGuards=new Gee(r,o,l)}}initDOM(){if(this.mode==="normal"){const s=ke("div");return s.innerHTML=Wee,s.firstChild}const t=ke("div");t.role="presentation",t.dataset.agCharts="",t.classList.add("ag-charts-wrapper");const i=ke("div");return t.appendChild(i),i.role="presentation",i.classList.add("ag-charts-series-area"),t}initRootElements(){var n;const{mode:t,element:i}=this,s={};for(const a of Uee){const r=`ag-charts-${a}`;let o;if(t==="normal"?o=i.classList.contains(r)?i:i.getElementsByClassName(r)[0]:Kee.has(a)?o=i:o=(n=i.getElementsByClassName(r)[0])!=null?n:ke("div"),o==null)throw new Error(`AG Charts - unable to find DOM element ${r}`);s[a]={element:o,children:new Map,listeners:[]}}return s}destroy(){var t;super.destroy(),(t=this.observer)==null||t.unobserve(this.element),this.container&&this.sizeMonitor.unobserve(this.container),this.pendingContainer=void 0,Object.values(this.rootElements).forEach(i=>{i.children.forEach(s=>s.remove()),i.element.remove()}),this.element.remove()}postRenderUpdate(){this.mode!=="minimal"&&(this.pendingContainer==null||this.pendingContainer===this.container||(kd.batchedUpdateContainer.length===0&&Ct().setTimeout(this.applyBatchedUpdateContainer.bind(this),0),kd.batchedUpdateContainer.push(this)))}applyBatchedUpdateContainer(){for(const t of kd.batchedUpdateContainer)t.destroyed||t.updateContainer();kd.batchedUpdateContainer.splice(0)}setSizeOptions(t=300,i=300,s,n){const{style:a}=this.element;a.width=`${s!=null?s:t}px`,a.height=`${n!=null?n:i}px`,this.minWidth=s!=null?s:t,this.minHeight=n!=null?n:i,this.updateContainerClassName()}updateContainerSize(){var i,s;const{style:t}=this.rootElements["canvas-center"].element;t.visibility=this.containerSize==null?"hidden":"",this.containerSize?(t.width=`${(i=this.containerSize.width)!=null?i:0}px`,t.height=`${(s=this.containerSize.height)!=null?s:0}px`):(t.width="",t.height=""),this.updateContainerClassName()}setTabGuardIndex(t){this.tabGuards&&(this.tabGuards.tabIndex=t)}setContainer(t){t!==this.container&&(this.pendingContainer=t,(this.mode==="minimal"||this.container==null)&&this.updateContainer())}updateContainer(){const{pendingContainer:t}=this;if(!(t==null||t===this.container)){if(this.container&&(this.container.removeChild(this.element),this.sizeMonitor.unobserve(this.container)),this.documentRoot!=null)for(const i of this.rootElements.styles.children.keys())this.removeChild("styles",i);this.container=t,this.pendingContainer=void 0,this.documentRoot=this.getShadowDocumentRoot(t),this.initiallyConnected=this.mode==="minimal"||t.isConnected;for(const[i,s]of this.styles)this.addStyles(i,s);t.appendChild(this.element),this.sizeMonitor.observe(t,i=>{this.containerSize=i,this.updateContainerSize(),this.listeners.dispatch("resize",{type:"resize"})}),this.listeners.dispatch("container-changed",{type:"container-changed"})}}setThemeClass(t){const i="ag-charts-theme-";this.element.classList.forEach(s=>{s.startsWith(i)&&s!==t&&this.element.classList.remove(s)}),this.element.classList.add(t)}setThemeParameters(t){const i={accentColor:"accent-color",axisColor:"axis-color",backgroundColor:"background-color",borderColor:"border-color",foregroundColor:"foreground-color",fontFamily:"font-family",fontSize:"font-size",fontWeight:"font-weight",gridLineColor:"grid-line-color",padding:"padding",subtleTextColor:"subtle-text-color",textColor:"text-color",chromeBackgroundColor:"chrome-background-color",chromeFontFamily:"chrome-font-family",chromeFontSize:"chrome-font-size",chromeFontWeight:"chrome-font-weight",chromeSubtleTextColor:"chrome-subtle-text-color",chromeTextColor:"chrome-text-color",inputBackgroundColor:"input-background-color",inputTextColor:"input-text-color",crosshairLabelBackgroundColor:"crosshair-label-background-color",crosshairLabelTextColor:"crosshair-label-text-color"},s=["fontSize","chromeFontSize"];for(const[n,a]of Zt(t)){let r=`${a}`;s.includes(n)&&(r=`${a}px`),this.element.style.setProperty(`--ag-charts-${i[n]}`,r)}}updateCanvasLabel(t){$e(this.rootElements["canvas-proxy"].element,"aria-label",t)}getEventElement(t,i){return["focus","blur","keydown","keyup"].includes(i)?this.rootElements["series-area"].element:t}addEventListener(t,i,s){this.getEventElement(this.element,t).addEventListener(t,i,s)}removeEventListener(t,i,s){this.getEventElement(this.element,t).removeEventListener(t,i,s)}getBoundingClientRect(){return this.rootElements.canvas.element.getBoundingClientRect()}getOverlayClientRect(){var n,a;const t=Ct(),i=new ve(0,0,t.innerWidth,t.innerHeight),s=this.getRawOverlayClientRect();return(a=(n=i.intersection(s))==null?void 0:n.toDOMRect())!=null?a:TR}getRawOverlayClientRect(){var a,r,o;let t=this.element;const i=(a=this.element.getRootNode())==null?void 0:a.fullscreenElement;for(;t!=null;){let l;if(i!=null&&t===i)l=!0;else{const c=(r=t.computedStyleMap)==null?void 0:r.call(t),h=(o=c==null?void 0:c.get("overflow-y"))==null?void 0:o.toString();l=h==="auto"||h==="scroll"}if(l)return ve.fromDOMRect(t.getBoundingClientRect());t=t.parentElement}if(this.documentRoot!=null)return ve.fromDOMRect(this.documentRoot.getBoundingClientRect());const{innerWidth:s,innerHeight:n}=Ct();return new ve(0,0,s,n)}getShadowDocumentRoot(t=this.container){var s,n;const i=(n=(s=t==null?void 0:t.ownerDocument)==null?void 0:s.body)!=null?n:Sr("body");for(;t!=null;){if(t===i)return;if(t.parentNode instanceof DocumentFragment)return t;t=t.parentNode}}getParent(t){return this.rootElements[t].element}getChildBoundingClientRect(t){const{children:i}=this.rootElements[t],s=[];for(const n of i.values())s.push(ve.fromDOMRect(n.getBoundingClientRect()));return ve.merge(s)}isManagedChildDOMElement(t,i,s){const{children:n}=this.rootElements[i],a=n==null?void 0:n.get(s);return a!=null&&t.contains(a)}contains(t,i){return i==null?this.element.contains(t):this.rootElements[i].element.contains(t)}addStyles(t,i){const s="data-ag-charts";if(this.styles.set(t,i),this.container==null)return;const n=o=>o.getAttribute(s)===t,a=o=>{const l=new Set(["TITLE","META"]);let c=!0,h;for(const u of o.children){if(c&&l.has(u.tagName)){h=u;continue}if(c=!1,n(u))return;u.hasAttribute(s)&&(h=u)}const d=ke("style");return this.chart.styleNonce!=null&&(d.nonce=this.chart.styleNonce),h==null?o.prepend(d):o.insertBefore(d,h.nextSibling),d};let r;this.styleContainer?r=a(this.styleContainer):this.initiallyConnected===!1?r=this.addChild("styles",t):this.documentRoot==null&&!kd.headStyles.has(t)?(r=a(Sr("head")),kd.headStyles.add(t)):this.documentRoot!=null&&(r=this.addChild("styles",t)),!(r==null||n(r))&&(r.setAttribute(s,t),r.innerHTML=i)}removeStyles(t){this.removeChild("styles",t)}updateCursor(t,i){this.cursorState.set(t,i),this.element.style.cursor=this.cursorState.stateValue()}getCursor(){return this.element.style.cursor}addChild(t,i,s,n){var h;const{element:a,children:r,listeners:o}=this.rootElements[t];if(!r)throw new Error("AG Charts - unable to create DOM elements after destroy()");if(r.has(i))return r.get(i);const{childElementType:l="div"}=(h=$ee.get(t))!=null?h:{};if(s&&s.tagName.toLowerCase()!==l.toLowerCase())throw new Error("AG Charts - mismatching DOM element type");const c=s!=null?s:ke(l);for(const[d,u,p]of o)c.addEventListener(d,u,p);if(r.set(i,c),l==="style"&&this.chart.styleNonce!=null&&(c.nonce=this.chart.styleNonce),n){const d=a.querySelector(n.query);if(d==null)throw new Error(`AG Charts - addChild query failed ${n.query}`);d.insertAdjacentElement(n.where,c)}else a==null||a.appendChild(c);return c}removeChild(t,i){var n;const{children:s}=this.rootElements[t];s&&((n=s.get(i))==null||n.remove(),s.delete(i))}incrementDataCounter(t){var s;const{dataset:i}=this.element;(s=i[t])!=null||(i[t]="0"),i[t]=String(Number(i[t])+1)}setDataBoolean(t,i){this.element.dataset[t]=String(i)}updateContainerClassName(){var a,r;const{element:t,containerSize:i,minWidth:s,minHeight:n}=this;t.classList.toggle(IR.safeHorizontal,s>=((a=i==null?void 0:i.width)!=null?a:1/0)),t.classList.toggle(IR.safeVertical,n>=((r=i==null?void 0:i.height)!=null?r:1/0))}};q0.batchedUpdateContainer=[],q0.headStyles=new Set;var LR=q0,Xee=class extends Er{constructor(){super(ke("div")),this.textElement=Ti("text"),this.textElement.role="presentation",this.svgElement=Ti("svg"),this.svgElement.appendChild(this.textElement),this.svgElement.style.width="100%",this.svgElement.style.opacity="0",this.svgElement.role="presentation",this.elem.appendChild(this.svgElement),this.elem.role="presentation"}set textContent(e){var s;this.textElement.textContent=e;const t=this.textElement,i=(s=t.getBBox)==null?void 0:s.call(t);i&&this.svgElement.setAttribute("viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`)}get textContent(){return this.textElement.textContent}destructor(){}},PR=class extends Er{constructor(e,t){super(e),$e(this.elem,"role",t),this.setEnabled(!0)}destructor(){}setEnabled(e){$e(this.elem,"aria-disabled",!e)}addListener(e,t){return super.addListener(e,(i,s)=>{(e==="click"||e==="dblclick")&&this.isDisabled()||t(i,s)})}},wg=class extends PR{constructor(){super(ke("button"))}},Zee=class extends Er{constructor(){super(ke("div")),$e(this.elem,"role","group")}destructor(){}},Q0=class extends Er{constructor(e,t){super(ke("div")),this.focusedChildIndex=0,this.onChildFocus=(i,s)=>{const n=this.children[this.focusedChildIndex];this.focusedChildIndex=s.index,n==null||n.setTabIndex(-1),s.setTabIndex(0)},this.onChildKeyDown=(i,s)=>{var l;const n=this.orientation,[a,r]=n==="both"?[ru.horizontal,ru.vertical]:[ru[n],void 0];let o=-1;if(Dg(i.sourceEvent)){const c=i.sourceEvent.key;c===a.nextKey||c===(r==null?void 0:r.nextKey)?o=s.index+1:(c===a.prevKey||c===(r==null?void 0:r.prevKey))&&(o=s.index-1)}(l=this.children[o])==null||l.focus()},$e(this.elem,"role",t),this.orientation=e}get orientation(){var e;return(e=Wd(this.elem,"aria-orientation"))!=null?e:"both"}set orientation(e){$e(this.elem,"aria-orientation",e!=="both"?e:void 0)}focus(){var e;(e=this.children[this.focusedChildIndex])==null||e.focus()}clear(){this.focusedChildIndex=0;for(const e of this.children)this.removeChildListeners(e),e.parent=void 0;this.elem.textContent="",this.children.length=0}addChildListeners(e){e.addListener("focus",this.onChildFocus),e.addListener("keydown",this.onChildKeyDown)}removeChildListeners(e){e.removeListener("focus",this.onChildFocus),e.removeListener("keydown",this.onChildKeyDown)}onChildAdded(e){this.addChildListeners(e),e.setTabIndex(this.children.length===1?0:-1)}onChildRemoved(e){var n;this.removeChildListeners(e);const{focusedChildIndex:t,children:i}=this,s=t===e.index;for(let a=0;a<i.length;a++){const r=i[a];r.index===t&&(this.focusedChildIndex=a),r.index=a}if(s){const a=(n=i[t])!=null?n:i[t-1];a?(this.focusedChildIndex=a.index,a.setTabIndex(0)):this.focusedChildIndex=0}}},qee=class extends Q0{constructor(){super("both","list"),this.setHidden(!0)}destructor(){this.children.forEach(e=>e.getElement().parentElement.remove())}addChildToDOM(e,t){const i=ke("div");$e(i,"role","listitem"),Tr(i,"position","absolute"),Er.setElementContainer(e,i),this.appendOrInsert(i,t),this.setHidden(!1)}removeChildFromDOM(e){e.getElement().parentElement.remove(),this.setHidden(this.children.length===0)}setHidden(e){this.children.length===0&&(e=!0),super.setHidden(e)}},lu=class extends Er{constructor(e){super(e)}destructor(){}},Qee=new Intl.NumberFormat("en-US",{style:"percent"});function Ao(e,t=2){return typeof e=="number"?NR(e,t):typeof e=="string"?e:String(e!=null?e:"")}function ER(e){return Qee.format(e)}var RR=new Map().set(2,new Intl.NumberFormat("en-US",{maximumFractionDigits:2,useGrouping:!1}));function NR(e,t){let i=RR.get(t);return i||(i=new Intl.NumberFormat("en-US",{maximumFractionDigits:t,useGrouping:!1}),RR.set(t,i)),i.format(e)}var J0=class Im extends Er{constructor(){super(ke("input")),this._step=Im.STEP_ONE,this.orientation="both"}get step(){return this._step}set step(t){this._step=t,this.getElement().step=t.attributeValue}get keyboardStep(){var t,i;return(i=(t=this._keyboardStep)==null?void 0:t.step)!=null?i:this._step}set keyboardStep(t){var i;if(t!==((i=this._keyboardStep)==null?void 0:i.step)&&(this._keyboardStep!==void 0&&(this.removeListener("keydown",this._keyboardStep.onKeyDown),this.removeListener("keyup",this._keyboardStep.onKeyUp),this.removeListener("blur",this._keyboardStep.onBlur),this._keyboardStep=void 0),t!==void 0)){const s=()=>this.getElement().step=t.attributeValue,n=()=>this.getElement().step=this._step.attributeValue;this._keyboardStep={step:t,onKeyDown:s,onKeyUp:n,onBlur:n},this.addListener("keydown",this._keyboardStep.onKeyDown),this.addListener("keyup",this._keyboardStep.onKeyUp),this.addListener("blur",this._keyboardStep.onBlur)}}get orientation(){var t;return(t=Wd(this.elem,"aria-orientation"))!=null?t:"both"}set orientation(t){$e(this.elem,"aria-orientation",t!=="both"?t:void 0),Im.registerDefaultPreventers(this,t)}destructor(){}clampValueRatio(t,i){const s=this.getValueRatio(),n=we(t,s,i);return n!==s&&this.setValueRatio(n),n}setValueRatio(t,i){const{divider:s}=this.step,n=Math.round(t*1e4)/s,{ariaValueText:a=ER(n/s)}=i!=null?i:{},r=this.getElement();r.value=`${n}`,r.ariaValueText=a}getValueRatio(){return parseFloat(this.getElement().value)/this.step.divider}static registerDefaultPreventers(t,i){i==="both"?t.removeListener("keydown",Im.onKeyDown):t.addListener("keydown",Im.onKeyDown)}static onKeyDown(t,i){let s=[];const{orientation:n}=i;n==="horizontal"?s=["ArrowUp","ArrowDown"]:n==="vertical"&&(s=["ArrowLeft","ArrowRight"]),s.includes(t.sourceEvent.code)&&t.sourceEvent.preventDefault()}};J0.STEP_ONE={attributeValue:"1",divider:1},J0.STEP_HUNDRETH={attributeValue:"0.01",divider:100};var eM=J0,Jee=class extends wg{constructor(){super(),$e(this.elem,"role","switch"),this.setChecked(!1)}setChecked(e){$e(this.elem,"aria-checked",e)}},Wy=class extends Q0{constructor(e="horizontal"){super(e,"toolbar")}destructor(){}};function cu(e,t){var i;return((i=t.params)==null?void 0:i.type)===e}function ete(e){if(e==="button")return new wg;if(e==="slider")return new eM;if(e==="toolbar")return new Wy;if(e==="group")return new Zee;if(e==="list")return new qee;if(e==="region")return new lu(ke("div"));if(e==="text")return new Xee;if(e==="listswitch")return new Jee;throw Error("AG Charts - error allocating meta")}function OR(e){const t={params:e,result:void 0};return t.result=ete(t.params.type),t}var FR=class{constructor(e,t){this.localeManager=e,this.domManager=t,this.destroyFns=[]}destroy(){this.destroyFns.forEach(e=>e())}addLocalisation(e){e(),this.destroyFns.push(this.localeManager.addListener("locale-changed",e))}createProxyContainer(e){const t=OR(e),{params:i,result:s}=t,n=s.getElement();return this.domManager.addChild("canvas-proxy",i.domManagerId,n),n.classList.add(...i.classList,"ag-charts-proxy-container"),n.role=i.type,"ariaOrientation"in i&&(n.ariaOrientation=i.ariaOrientation),cu("toolbar",t)&&(t.result.orientation=t.params.orientation),this.addLocalisation(()=>{n.ariaLabel=this.localeManager.t(i.ariaLabel.id,i.ariaLabel.params)}),s}createProxyElement(e){const t=OR(e);if(cu("button",t)){const{params:i,result:s}=t,n=s.getElement();if(this.initInteract(i,s),typeof i.textContent=="string")n.textContent=i.textContent;else{const{textContent:a}=i;this.addLocalisation(()=>{n.textContent=this.localeManager.t(a.id,a.params)})}this.setParent(t.params,t.result)}if(cu("slider",t)){const{params:i,result:s}=t,n=s.getElement();this.initInteract(i,s),n.type="range",n.role="presentation",n.style.margin="0px",this.addLocalisation(()=>{n.ariaLabel=this.localeManager.t(i.ariaLabel.id,i.ariaLabel.params)}),this.setParent(t.params,t.result)}if(cu("text",t)){const{params:i,result:s}=t;this.initElement(i,s),this.setParent(t.params,t.result)}if(cu("listswitch",t)){const{params:i,result:s}=t;this.initInteract(i,s),s.setTextContent(i.textContent),s.setChecked(i.ariaChecked),s.setAriaDescribedBy(i.ariaDescribedBy),this.setParent(t.params,t.result)}if(cu("region",t)){const{params:i,result:s}=t,n=s.getElement();this.initInteract(i,s),n.role="region",this.setParent(t.params,t.result)}return t.result}initElement(e,t){const i=t.getElement();return Tr(i,"cursor",e.cursor),i.classList.toggle("ag-charts-proxy-elem",!0),i}initInteract(e,t){const{tabIndex:i,domIndex:s}=e,n=this.initElement(e,t);i!==void 0&&(n.tabIndex=i),s!==void 0&&(t.domIndex=s)}setParent(e,t){var i;if("parent"in e)(i=e.parent)==null||i.addChild(t);else{const s={where:e.where,query:".ag-charts-series-area"};this.domManager.addChild("canvas-proxy",e.domManagerId,t.getElement(),s)}}},tte={ariaAnnounceHoverDatum:"${datum}",ariaAnnounceChart:"chart, ${seriesCount}[number] series",ariaAnnounceHierarchyChart:"hierarchy chart, ${caption}",ariaAnnounceGaugeChart:"gauge chart, ${caption}",ariaAnnounceHierarchyDatum:"level ${level}[number], ${count}[number] children, ${description}",ariaAnnounceFlowProportionLink:"link ${index} of ${count}, from ${from} to ${to}, ${sizeName} ${size}",ariaAnnounceFlowProportionNode:"node ${index} of ${count}, ${description}",ariaDescriptionLegendItem:"Press Space or Enter to toggle visibility",ariaLabelAddHorizontalLine:"Add Horizontal Line",ariaLabelAnnotationOptionsToolbar:"Annotation Options",ariaLabelAnnotationSettingsDialog:"Annotation Settings",ariaLabelColorPicker:"Color picker",ariaLabelFinancialCharts:"Financial Charts",ariaLabelLegend:"Legend",ariaLabelLegendPagination:"Legend Pagination",ariaLabelLegendPagePrevious:"Previous Legend Page",ariaLabelLegendPageNext:"Next Legend Page",ariaLabelLegendItem:"${label}, Legend item ${index}[number] of ${count}[number]",ariaLabelLegendItemUnknown:"Unknown legend item",ariaLabelNavigator:"Navigator",ariaLabelNavigatorRange:"Range",ariaLabelNavigatorMinimum:"Minimum",ariaLabelNavigatorMaximum:"Maximum",ariaLabelRangesToolbar:"Ranges",ariaLabelSettingsTabBar:"Settings",ariaLabelZoomToolbar:"Zoom",ariaValuePanRange:"${min}[percent0to2dp] to ${max}[percent0to2dp]",iconAltTextLineStyleSolid:"Solid",iconAltTextLineStyleDashed:"Long-dashed",iconAltTextLineStyleDotted:"Short-dashed",iconAltTextPositionTop:"Top",iconAltTextPositionCenter:"Center",iconAltTextPositionBottom:"Bottom",iconAltTextAlignLeft:"Left",iconAltTextAlignCenter:"Center",iconAltTextAlignRight:"Right",iconAltTextClose:"Close",overlayLoadingData:"Loading data...",overlayNoData:"No data to display",overlayNoVisibleSeries:"No visible series",overlayUnsupportedBrowser:"Incompatible browser version. Please upgrade your browser.",seriesHistogramTooltipFrequency:"Frequency",seriesHistogramTooltipSum:"${yName} (sum)",seriesHistogramTooltipCount:"${yName} (count)",seriesHistogramTooltipMean:"${yName} (mean)",toolbarSeriesTypeDropdown:"Chart Type",toolbarSeriesTypeOHLC:"OHLC",toolbarSeriesTypeHLC:"HLC",toolbarSeriesTypeHighLow:"High Low",toolbarSeriesTypeCandles:"Candles",toolbarSeriesTypeHollowCandles:"Hollow Candles",toolbarSeriesTypeLine:"Line",toolbarSeriesTypeLineWithMarkers:"Line with Markers",toolbarSeriesTypeStepLine:"Step Line",toolbarAnnotationsTrendLine:"Trend Line",toolbarAnnotationsFibonacciRetracement:"Fib Retracement",toolbarAnnotationsFibonacciRetracementTrendBased:"Fib Trend Based",toolbarAnnotationsHorizontalLine:"Horizontal Line",toolbarAnnotationsVerticalLine:"Vertical Line",toolbarAnnotationsParallelChannel:"Parallel Channel",toolbarAnnotationsDisjointChannel:"Disjoint Channel",toolbarAnnotationsClearAll:"Clear All",toolbarAnnotationsFillColor:"Fill Color",toolbarAnnotationsLineColor:"Line Color",toolbarAnnotationsLineStyle:"Line Style",toolbarAnnotationsLineStrokeWidth:"Line Stroke Width",toolbarAnnotationsSettings:"Settings",toolbarAnnotationsTextColor:"Text Color",toolbarAnnotationsTextSize:"Text Size",toolbarAnnotationsLock:"Lock",toolbarAnnotationsUnlock:"Unlock",toolbarAnnotationsDelete:"Delete",toolbarAnnotationsDragHandle:"Drag Toolbar",toolbarAnnotationsLineAnnotations:"Trend Lines",toolbarAnnotationsFibonacciAnnotations:"Fibonacci",toolbarAnnotationsTextAnnotations:"Text Annotations",toolbarAnnotationsShapeAnnotations:"Arrows",toolbarAnnotationsMeasurerAnnotations:"Measurers",toolbarAnnotationsCallout:"Callout",toolbarAnnotationsComment:"Comment",toolbarAnnotationsNote:"Note",toolbarAnnotationsText:"Text",toolbarAnnotationsArrow:"Arrow",toolbarAnnotationsArrowUp:"Arrow Up",toolbarAnnotationsArrowDown:"Arrow Down",toolbarAnnotationsDateRange:"Date Range",toolbarAnnotationsPriceRange:"Price Range",toolbarAnnotationsDatePriceRange:"Date and Price",toolbarAnnotationsQuickDatePriceRange:"Measure",toolbarRange1Month:"1M",toolbarRange1MonthAria:"1 month",toolbarRange3Months:"3M",toolbarRange3MonthsAria:"3 months",toolbarRange6Months:"6M",toolbarRange6MonthsAria:"6 months",toolbarRangeYearToDate:"YTD",toolbarRangeYearToDateAria:"Year to date",toolbarRange1Year:"1Y",toolbarRange1YearAria:"1 year",toolbarRangeAll:"All",toolbarRangeAllAria:"All",toolbarZoomZoomOut:"Zoom out",toolbarZoomZoomIn:"Zoom in",toolbarZoomPanLeft:"Pan left",toolbarZoomPanRight:"Pan right",toolbarZoomPanStart:"Pan to the start",toolbarZoomPanEnd:"Pan to the end",toolbarZoomReset:"Reset the zoom",contextMenuDownload:"Download",contextMenuToggleSeriesVisibility:"Toggle Visibility",contextMenuToggleOtherSeries:"Toggle Other Series",contextMenuZoomToCursor:"Zoom to here",contextMenuPanToCursor:"Pan to here",dialogHeaderChannel:"Channel",dialogHeaderLine:"Line",dialogHeaderFibonacciRange:"Fib Retracement",dialogHeaderDateRange:"Date Range",dialogHeaderPriceRange:"Price Range",dialogHeaderDatePriceRange:"Date and Price",dialogHeaderText:"Text",dialogInputAlign:"Align",dialogInputColorPicker:"Color",dialogInputColorPickerAltText:"Text Color",dialogInputFillColorPicker:"Fill",dialogInputFillColorPickerAltText:"Fill Color",dialogInputExtendChannelStart:"Extend channel start",dialogInputExtendChannelEnd:"Extend channel end",dialogInputExtendLineStart:"Extend line start",dialogInputExtendLineEnd:"Extend line end",dialogInputExtendAbove:"Extend above",dialogInputExtendBelow:"Extend below",dialogInputExtendLeft:"Extend left",dialogInputExtendRight:"Extend right",dialogInputReverse:"Reverse",dialogInputShowFill:"Show Fill",dialogInputFontSize:"Size",dialogInputFontSizeAltText:"Font Size",dialogInputLineStyle:"Dash",dialogInputPosition:"Position",dialogInputStrokeWidth:"Weight",dialogInputStrokeWidthAltText:"Line Weight",dialogInputFibonacciBands:"Bands",dialogInputFibonacciBandsAltText:"Fibonacci Bands",inputTextareaPlaceholder:"Add Text",measurerDateRangeBars:"${value}[number] bars",measurerPriceRangeValue:"${value}[number]",measurerPriceRangePercent:"${value}[percent]",measurerVolume:"Vol ${value}",tooltipPaginationStatus:"${index}[number] of ${count}[number]"},ite=/\$\{(\w+)}(?:\[(\w+)])?/gi,tM={number:new Intl.NumberFormat("en-US"),percent:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),percent0to2dp:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}),date:new Intl.DateTimeFormat("en-US",{dateStyle:"full"}),time:new Intl.DateTimeFormat("en-US",{timeStyle:"full"}),datetime:new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"full"})},ste=({defaultValue:e,variables:t})=>e==null?void 0:e.replaceAll(ite,(i,s,n)=>{const a=t[s],r=n!=null?tM[n]:null;return n!=null&&r==null&&se.warnOnce(`Format style [${n}] is not supported`),r!=null?r.format(a):typeof a=="number"?tM.number.format(a):a instanceof Date?tM.datetime.format(a):String(a)}),nte=class extends Nl{constructor(){super(...arguments),this.localeText=void 0,this.getLocaleText=void 0}setLocaleText(e){this.localeText!==e&&(this.localeText=e,this.dispatch("locale-changed"))}setLocaleTextFormatter(e){this.getLocaleText=e,this.getLocaleText!==e&&(this.getLocaleText=e,this.dispatch("locale-changed"))}t(e,t={}){var a,r;const{localeText:i=tte,getLocaleText:s}=this,n=i[e];return(r=(a=s==null?void 0:s({key:e,defaultValue:n,variables:t}))!=null?a:ste({key:e,defaultValue:n,variables:t}))!=null?r:e}},iM=class{constructor(e){var a,r;this.enabled=!0,this.width=600,this.height=300;const{width:t,height:i,canvasElement:s,willReadFrequently:n=!1}=e;this.pixelRatio=(r=(a=e.pixelRatio)!=null?a:Ct("devicePixelRatio"))!=null?r:1,this.element=s!=null?s:ke("canvas"),this.element.style.display="block",this.element.style.width=(t!=null?t:this.width)+"px",this.element.style.height=(i!=null?i:this.height)+"px",this.element.width=Math.round((t!=null?t:this.width)*this.pixelRatio),this.element.height=Math.round((i!=null?i:this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently:n}),this.onEnabledChange(),this.resize(t!=null?t:0,i!=null?i:0,this.pixelRatio),RE(this.context)}drawImage(e,t=0,i=0){return e.drawImage(this.context.canvas,t,i)}toDataURL(e){return this.element.toDataURL(e)}resize(e,t,i){if(!(e>0&&t>0))return;const{element:s,context:n}=this;s.width=Math.round(e*i),s.height=Math.round(t*i),n.setTransform(i,0,0,i,0,0),s.style.width=e+"px",s.style.height=t+"px",this.width=e,this.height=t,this.pixelRatio=i}clear(){EE(this)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}reset(){this.context.resetTransform()}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}};I([Rl(e=>e.onEnabledChange())],iM.prototype,"enabled",2);var ate=class extends ag{constructor(){super(...arguments),this.cache=new Map,this.imageLoadingCount=0}loadImage(e,t){const i=this.cache.get(e);if(i!=null&&i.image)return i.image;if(i!=null&&t){i.nodes.add(t);return}if(!t)return;const s={image:void 0,nodes:new Set([t])},n=new Image;return this.imageLoadingCount++,n.onload=()=>{s.image=n,s.nodes.forEach(a=>a.markDirty()),s.nodes.clear(),this.imageLoadingCount--,this.emit("image-loaded",{uri:e})},n.onerror=()=>{this.imageLoadingCount--,s.nodes.clear(),this.emit("image-error",{uri:e})},n.src=e,this.cache.set(e,s),s.image}waitingToLoad(){return this.imageLoadingCount>0}destroy(){this.cache.forEach(e=>{e.nodes.clear()}),this.cache.clear()}},rte=class{constructor(e){this.canvas=e,this.debug=ct.create(!0,"scene"),this.layersMap=new Map,this.nextLayerId=0}get size(){return this.layersMap.size}resize(e,t,i){this.canvas.resize(e,t,i),this.layersMap.forEach(({canvas:s})=>s.resize(e,t,i))}addLayer(e){const{width:t,height:i,pixelRatio:s}=this.canvas,{name:n}=e,a=new u0({width:t,height:i,pixelRatio:s});return this.layersMap.set(a,{id:this.nextLayerId++,name:n,canvas:a}),this.debug("Scene.addLayer() - layers",this.layersMap),a}removeLayer(e){this.layersMap.has(e)&&(this.layersMap.delete(e),e.destroy(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}clear(){for(const e of this.layersMap.values())e.canvas.destroy();this.layersMap.clear()}};function ote(e){for(const t of["B","KB","MB","GB"]){if(e<1536)return`${e.toFixed(1)}${t}`;e/=1024}return`${e.toFixed(1)}TB}`}function lte(){if(!("memory"in performance))return;const{totalJSHeapSize:e,usedJSHeapSize:t,jsHeapSizeLimit:i}=performance.memory,s=[];for(const n of[t,e,i])typeof n=="number"&&s.push(ote(n));return`Heap ${s.join(" / ")}`}function BR(e,t,i,s,n={},a=ve.zero){if(!ct.check("scene:stats","scene:stats:verbose"))return;const{layersRendered:r=0,layersSkipped:o=0,nodesRendered:l=0,nodesSkipped:c=0,opsPerformed:h=0,opsSkipped:d=0}=s!=null?s:{},u=performance.now(),N=t,{start:p}=N,g=We(N,["start"]),f=Object.entries(g).map(([O,L])=>GR(O,L)).filter(O=>O!=null).join(" + "),y=Object.entries(n).map(([O,L])=>`${O}: ${JSON.stringify(L)}`).join(" ; "),v=ct.check("scene:stats:verbose"),x=lte(),S=[`${GR("\u23F1\uFE0F",p,u)} (${f})`,`${y}`,`Layers: ${v?sM(r,o):e.size}`,v?`Nodes: ${sM(l,c)}`:null,v?`Ops: ${sM(h,d)}`:null,v&&x?x:null].filter(Ji),M=new j0(O=>i.measureText(O)),D=new Map(S.map(O=>[O,M.measureLines(O)])),A=Math.max(...Array.from(D.values(),O=>O.width)),w=gte(D.values(),O=>O.height),T=2+a.x;i.save(),i.fillStyle="white",i.fillRect(T,0,A,w),i.fillStyle="black";let k=0;for(const[O,L]of D.entries())k+=L.height,i.fillText(O,T,k);i.restore()}function cte(e){const t=yy(Ct("agChartsSceneDebug")),i=[];for(const s of t)s==="layout"?i.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):i.push(s);e.debugNodeSearch=i}function hte(e,t){e.save();for(const[i,s]of Object.entries(t)){const n=ai.toCanvas(s);if(!n){se.log(`Scene.render() - no bbox for debugged node [${i}].`);continue}e.globalAlpha=.8,e.strokeStyle="red",e.lineWidth=1,e.strokeRect(n.x,n.y,n.width,n.height),e.fillStyle="red",e.strokeStyle="white",e.font="16px sans-serif",e.textBaseline="top",e.textAlign="left",e.lineWidth=2,e.strokeText(i,n.x,n.y,n.width),e.fillText(i,n.x,n.y,n.width)}e.restore()}var dte=new Set,ute=new Set(["gradient","zIndex","clipRect","cachedBBox","childNodeCounts","path","__zIndex","name","__scalingCenterX","__scalingCenterY","__rotationCenterX","__rotationCenterY","_previousDatum","__fill","__lineDash","borderPath","borderClipPath","_clipPath"]);function pte(e){const t=We(e,[]);for(const i of Object.keys(t))ute.has(i)||typeof t[i]!="number"&&typeof t[i]!="string"&&typeof t[i]!="boolean"&&(dte.add(i),delete t[i]);return t}function Uy(e,t){var s;if(!ct.check(!0,"scene"))return{};let i=0;return b({node:t==="json"?pte(e):e,name:(s=e.name)!=null?s:e.id,dirty:e.dirty},Array.from(e.children(),n=>Uy(n,t)).reduce((n,a)=>{let{name:r}=a;const{node:{visible:o,opacity:l,zIndex:c,translationX:h,translationY:d,rotation:u,scalingX:p,scalingY:g},node:f}=a;(!o||l<=0)&&(r=`(${r})`),Ge.is(f)&&f.renderToOffscreenCanvas&&(r=`*${r}*`);const y=Array.isArray(c)?`(${c.join(", ")})`:c,v=[`${(i++).toString().padStart(3,"0")}|`,`${r!=null?r:"<unknown>"}`,`z: ${y}`,h&&`x: ${h}`,d&&`y: ${d}`,u&&`r: ${u}`,p!=null&&p!==1&&`sx: ${p}`,g!=null&&g!==1&&`sy: ${g}`].filter(M=>!!M).join(" ");let x=v,S=1;for(;n[x]!=null&&S<100;)x=`${v} (${S++})`;return n[x]=a,n},{}))}function _R(e){var n;if(!e.dirty)return{dirtyTree:{},paths:[]};const t=Array.from(e.children(),a=>_R(a)).filter(a=>a.paths.length>0),i=Ge.is(e)&&(n=e.name)!=null?n:e.id,s=t.length?t.flatMap(a=>a.paths).map(a=>`${i}.${a}`):[i];return{dirtyTree:b({name:i,node:e,dirty:e.dirty},t.map(a=>a.dirtyTree).filter(a=>a.dirty!=null).reduce((a,r)=>{var o;return a[(o=r.name)!=null?o:"<unknown>"]=r,a},{})),paths:s}}function sM(e,t){const i=e+t;return`${e} / ${i} (${Math.round(100*e/i)}%)`}function GR(e,t,i){const s=i!=null?i-t:t;return`${e}: ${Math.round(s*100)/100}ms`}function gte(e,t){let i=0;for(const s of e)i+=t(s);return i}var Ky=class extends ag{constructor(e){super(),this.debug=ct.create(!0,"scene"),this.id=Hs(this),this.imageLoader=new ate,this.root=null,this.pendingSize=null,this.isDirty=!1,this.destroyFns=[],this.updateDebugFlags(),this.canvas=new iM(e),this.layersManager=new rte(this.canvas),this.destroyFns.push(this.imageLoader.on("image-loaded",()=>{this.emit("scene-changed",{})}),this.imageLoader.on("image-error",({uri:t})=>{se.warnOnce(`Unable to load image ${t}`)}))}waitingForUpdate(){var e,t;return(t=(e=this.imageLoader)==null?void 0:e.waitingToLoad())!=null?t:!1}get width(){var e,t;return(t=(e=this.pendingSize)==null?void 0:e[0])!=null?t:this.canvas.width}get height(){var e,t;return(t=(e=this.pendingSize)==null?void 0:e[1])!=null?t:this.canvas.height}get pixelRatio(){var e,t;return(t=(e=this.pendingSize)==null?void 0:e[2])!=null?t:this.canvas.pixelRatio}setContainer(e){var i;const{element:t}=this.canvas;return(i=t.parentElement)==null||i.removeChild(t),e.appendChild(t),this}setRoot(e){var t;return this.root===e?this:(this.isDirty=!0,(t=this.root)==null||t.setScene(),this.root=e,e&&(e.visible=!0,e.setScene(this)),this)}updateDebugFlags(){ct.inDevelopmentMode(()=>xo._debugEnabled=!0)}clearCanvas(){this.canvas.clear()}attachNode(e){return this.appendChild(e),()=>this.removeChild(e)}appendChild(e){var t;return(t=this.root)==null||t.appendChild(e),this}removeChild(e){var t;return(t=this.root)==null||t.removeChild(e),this}download(e,t){var i;DQ(this.canvas.toDataURL(t),(i=e==null?void 0:e.trim())!=null?i:"image")}getDataURL(e){return this.canvas.toDataURL(e)}resize(e,t,i){return e=Math.round(e),t=Math.round(t),i!=null||(i=this.pixelRatio),e>0&&t>0&&(e!==this.width||t!==this.height||i!==this.pixelRatio)?(this.pendingSize=[e,t,i],this.isDirty=!0,!0):!1}render(e){var f;const{debugSplitTimes:t={start:performance.now()},extraDebugStats:i,seriesRect:s}=e!=null?e:{},{canvas:n,canvas:{context:a}={},root:r,pendingSize:o,width:l,height:c,pixelRatio:h}=this;if(!a)return;const d=performance.now();let u=!1;if(o&&(u=!0,this.layersManager.resize(...o),this.pendingSize=null),r&&!r.visible){this.isDirty=!1;return}if((r==null?void 0:r.dirty)===!1&&!this.isDirty){this.debug.check()&&this.debug("Scene.render() - no-op",{tree:Uy(r,"console")}),BR(this.layersManager,t,a,void 0,i,s);return}const p={ctx:a,width:l,height:c,devicePixelRatio:h,debugNodes:{}};ct.check("scene:stats:verbose")&&(p.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0,opsPerformed:0,opsSkipped:0}),cte(p);let g=!1;if(((r==null?void 0:r.dirty)!==!1||u)&&(g=!0,n.clear()),r&&ct.check("scene:dirtyTree")){const{dirtyTree:y,paths:v}=_R(r);ct.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree:y,paths:v})}if(r&&g){if(r.visible&&r.preRender(p),this.debug.check()){const y=Uy(r,"console");this.debug("Scene.render() - before",{canvasCleared:g,tree:y})}if(r.visible)try{a.save(),r.render(p),a.restore()}catch(y){throw this.canvas.reset(),y}}t["\u270D\uFE0F"]=performance.now()-d,(f=a.verifyDepthZero)==null||f.call(a),this.isDirty=!1,BR(this.layersManager,t,a,p.stats,i,s),hte(a,p.debugNodes),r&&this.debug.check()&&this.debug("Scene.render() - after",{tree:Uy(r,"console"),canvasCleared:g})}toSVG(){const{root:e,width:t,height:i}=this;if(e!=null)return xo.toSVG(e,t,i)}strip(){const{context:e,pixelRatio:t}=this.canvas;e.setTransform(t,0,0,t,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1,this.clear()}destroy(){this.strip(),this.canvas.destroy(),this.imageLoader.destroy(),this.destroyFns.forEach(e=>e()),Object.assign(this,{canvas:void 0})}};Ky.className="Scene";function fte(e,t){return"context"in e}function zR(e,t){return fte(e,t)&&t[0]!=null&&typeof t[0]=="object"?(t[0].context=e.context,!0):!1}function $y(e,t,i,s){return zR(e,s)||t&&zR(t,s),i(...s)}var VR=class{constructor(){this.cache=new WeakMap}call(e,t,i,...s){let n,a=this.cache.get(i);try{n=JSON.stringify(s)}catch(r){return this.invoke(e,t,i,s,a)}return a==null&&(a=new Map,this.cache.set(i,a)),a.has(n)?a.get(n):this.invoke(e,t,i,s,a,n)}invoke(e,t,i,s,n,a){try{const r=$y(e,t,i,s);return n&&a!=null&&n.set(a,r),r}catch(r){se.warnOnce("User callback errored, ignoring",r);return}}invalidateCache(){this.cache=new WeakMap}},mte=class extends wo{constructor(e,t){super(),this.annotationRoot=e,this.fireChartEvent=t,this.mementoOriginatorKey="annotations",this.annotations=[]}createMemento(){return this.annotations}guardMemento(e){return e==null||Ke(e)}restoreMemento(e,t,i){this.annotations=this.cleanData(i!=null?i:[]).map(s=>{const n=this.getAnnotationTypeStyles(s.type);return Je(s,n)}),this.listeners.dispatch("restore-annotations",{type:"restore-annotations",annotations:this.annotations})}updateData(e){this.annotations=this.cleanData(e!=null?e:[])}fireChangedEvent(){this.fireChartEvent({type:"annotations",annotations:Bt([...this.annotations])})}attachNode(e){return this.annotationRoot.append(e),()=>{var t;return(t=this.annotationRoot)==null||t.removeChild(e),this}}setAnnotationStyles(e){this.styles=e}getAnnotationTypeStyles(e){var t;return(t=this.styles)==null?void 0:t[e]}cleanData(e){for(const t of e)"textAlign"in t&&delete t.textAlign;return e}},jR=(e=>(e[e.CHART_BACKGROUND=0]="CHART_BACKGROUND",e[e.AXIS_GRID=1]="AXIS_GRID",e[e.AXIS=2]="AXIS",e[e.ZOOM_SELECTION=3]="ZOOM_SELECTION",e[e.SERIES_CROSSLINE_RANGE=4]="SERIES_CROSSLINE_RANGE",e[e.SERIES_LAYER=5]="SERIES_LAYER",e[e.AXIS_FOREGROUND=6]="AXIS_FOREGROUND",e[e.SERIES_CROSSHAIR=7]="SERIES_CROSSHAIR",e[e.SERIES_CROSSLINE_LINE=8]="SERIES_CROSSLINE_LINE",e[e.SERIES_ANNOTATION=9]="SERIES_ANNOTATION",e[e.CHART_ANNOTATION=10]="CHART_ANNOTATION",e[e.CHART_ANNOTATION_FOCUSED=11]="CHART_ANNOTATION_FOCUSED",e[e.STATUS_BAR=12]="STATUS_BAR",e[e.SERIES_LABEL=13]="SERIES_LABEL",e[e.LEGEND=14]="LEGEND",e[e.NAVIGATOR=15]="NAVIGATOR",e[e.FOREGROUND=16]="FOREGROUND",e))(jR||{}),yte=class{constructor(e){this.sceneRoot=e,this.axes=new Map,this.axisGridGroup=new Ge({name:"Axes-Grids",zIndex:1}),this.axisGroup=new Ge({name:"Axes",zIndex:2}),this.axisLabelGroup=new Ge({name:"Axes-Labels",zIndex:13}),this.axisCrosslineRangeGroup=new Ge({name:"Axes-Crosslines-Range",zIndex:4}),this.axisCrosslineLineGroup=new Ge({name:"Axes-Crosslines-Line",zIndex:8}),this.axisCrosslineLabelGroup=new Ge({name:"Axes-Crosslines-Label",zIndex:13}),this.sceneRoot.appendChild(this.axisGroup),this.sceneRoot.appendChild(this.axisGridGroup),this.sceneRoot.appendChild(this.axisLabelGroup),this.sceneRoot.appendChild(this.axisCrosslineRangeGroup),this.sceneRoot.appendChild(this.axisCrosslineLineGroup),this.sceneRoot.appendChild(this.axisCrosslineLabelGroup)}updateAxes(e,t){var s;const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const n of e)t.includes(n)||(n.detachAxis(i),n.destroy());for(const n of t)e!=null&&e.includes(n)||n.attachAxis(i);this.axes.clear();for(const n of t){const a=n.createAxisContext();this.axes.has(a.direction)?(s=this.axes.get(a.direction))==null||s.push(a):this.axes.set(a.direction,[a])}}getAxisContext(e){var t;return(t=this.axes.get(e))!=null?t:[]}destroy(){this.axes.clear(),this.sceneRoot.removeChild(this.axisGroup),this.sceneRoot.removeChild(this.axisGridGroup)}},Ag=(e=>(e[e.FULL=0]="FULL",e[e.UPDATE_DATA=1]="UPDATE_DATA",e[e.PROCESS_DATA=2]="PROCESS_DATA",e[e.PROCESS_DOMAIN=3]="PROCESS_DOMAIN",e[e.PERFORM_LAYOUT=4]="PERFORM_LAYOUT",e[e.SERIES_UPDATE=5]="SERIES_UPDATE",e[e.PRE_SCENE_RENDER=6]="PRE_SCENE_RENDER",e[e.SCENE_RENDER=7]="SCENE_RENDER",e[e.NONE=8]="NONE",e))(Ag||{}),Yy=class extends Nl{constructor(e){super(),this.animationManager=e,this.dispatchOnlyLatest=!0,this.dispatchThrottle=0,this.requestThrottle=300,this.isLoadingInitialData=!1,this.isLoadingData=!1,this.freshRequests=[],this.requestCounter=0,this.debug=ct.create(!0,"data-model","data-source"),this.throttledFetch=this.createThrottledFetch(this.requestThrottle),this.throttledDispatch=this.createThrottledDispatch(this.dispatchThrottle)}updateCallback(e){typeof e=="function"&&(this.debug("DataService - updated data source callback"),this.dataSourceCallback=e,this.isLoadingInitialData=!0,this.animationManager.skip(),this.dispatch("data-source-change"))}clearCallback(){this.dataSourceCallback=void 0}load(e){this.isLoadingData=!0,this.throttledFetch(e)}isLazy(){return this.dataSourceCallback!=null}isLoading(){return this.isLazy()&&(this.isLoadingInitialData||this.isLoadingData)}createThrottledFetch(e){return iE(t=>this.fetch(t).catch(i=>se.error("callback failed",i)),e,{leading:!1,trailing:!0})}createThrottledDispatch(e){return iE((t,i)=>{this.debug(`DataService - dispatching 'data-load' | ${t}`),this.dispatch("data-load",{type:"data-load",data:i})},e,{leading:!0,trailing:!0})}async fetch(e){if(!this.dataSourceCallback)throw new Error("DataService - [dataSource.getData] callback not initialised");const t=performance.now(),i=this.requestCounter++;this.debug(`DataService - requesting | ${i}`),this.freshRequests.push(i);let s;try{s=await this.dataSourceCallback(e),this.debug(`DataService - response | ${performance.now()-t}ms | ${i}`)}catch(a){this.debug(`DataService - request failed | ${i}`),se.errorOnce(`DataService - request failed | [${a}]`)}this.isLoadingInitialData=!1;const n=this.freshRequests.findIndex(a=>a===i);if(n===-1||this.dispatchOnlyLatest&&n!==this.freshRequests.length-1){this.debug(`DataService - discarding stale request | ${i}`);return}this.freshRequests=this.freshRequests.slice(n+1),this.freshRequests.length===0&&(this.isLoadingData=!1),Array.isArray(s)?this.throttledDispatch(i,s):this.dispatch("data-error")}};I([Dn({newValue(e){this.throttledDispatch=this.createThrottledDispatch(e)}})],Yy.prototype,"dispatchThrottle",2),I([Dn({newValue(e){this.throttledFetch=this.createThrottledFetch(e)}})],Yy.prototype,"requestThrottle",2);var vte=class{constructor(e,t){this.domManager=e,this.updateService=t,this.observers=[]}updateFonts(e){!e||e.size===0||(this.loadFonts(e),e.forEach(t=>{this.observeFontStatus(t)}))}destroy(){for(const e of this.observers)e.disconnect();this.observers=[]}loadFonts(e){const t=Array.from(e).map(a=>encodeURIComponent(a)),i=":wght@100;200;300;400;500;600;700;800;900",s=`${i}&family=`,n=`@import url('https://fonts.googleapis.com/css2?family=${t.join(s)}${i}&display=swap');
`;this.domManager.addStyles(`google-font-${t.join("-")}`,n)}observeFontStatus(e){const t=window.document.createElement("div");t.style.setProperty("position","absolute"),t.style.setProperty("top","0"),t.style.setProperty("margin","0"),t.style.setProperty("padding","0"),t.style.setProperty("overflow","hidden"),t.style.setProperty("visibility","hidden"),t.style.setProperty("width","auto"),t.style.setProperty("max-width","none"),t.style.setProperty("font-synthesis","none"),t.style.setProperty("font-family",e),t.style.setProperty("font-size","16px"),t.style.setProperty("white-space","nowrap"),t.textContent="UVWxyz",this.domManager.addChild("canvas-container",`font-check-${encodeURIComponent(e)}`,t);const i=new ResizeObserver(s=>{var a,r;const n=(r=(a=s==null?void 0:s.at(0))==null?void 0:a.contentBoxSize.at(0))==null?void 0:r.inlineSize;n!=null&&n>0&&(Rr.clear(),this.updateService.update(4))});i.observe(t),this.observers.push(i)}};function bte(e,t){return i=>Number(e)*(1-i)+Number(t)*i}function HR(e,t){if(typeof e=="string")try{e=yt.fromString(e)}catch(i){e=yt.fromArray([0,0,0])}if(typeof t=="string")try{t=yt.fromString(t)}catch(i){t=yt.fromArray([0,0,0])}return i=>yt.mix(e,t,i).toRgbaString()}var nM={};Ua(nM,{easeIn:()=>xte,easeInOut:()=>Cte,easeInOutQuad:()=>Dte,easeInQuad:()=>Ste,easeOut:()=>Ig,easeOutQuad:()=>Mte,inverseEaseOut:()=>UR,linear:()=>WR});var WR=e=>e,xte=e=>1-Math.cos(e*Math.PI/2),Ig=e=>Math.sin(e*Math.PI/2),Cte=e=>-(Math.cos(e*Math.PI)-1)/2,Ste=e=>e*e,Mte=e=>1-(1-e)**2,Dte=e=>e<.5?2*e*e:1-(-2*e+2)**2/2,UR=e=>2*Math.asin(e)/Math.PI,Xy=.2,hu=["initial","remove","update","add","trailing","end","none"],Tg={initial:{animationDuration:1,animationDelay:0},add:{animationDuration:.25,animationDelay:.75},remove:{animationDuration:.25,animationDelay:0},update:{animationDuration:.5,animationDelay:.25},trailing:{animationDuration:Xy,animationDelay:1,skipIfNoEarlierAnimations:!0},end:{animationDelay:1+Xy,animationDuration:0,skipIfNoEarlierAnimations:!0},none:{animationDuration:0,animationDelay:0}},KR=(e=>(e.Loop="loop",e.Reverse="reverse",e))(KR||{});function wte(e){return e.every(t=>t instanceof xo)}function Zy(e){return wte(e)?{nodes:e,selections:[]}:{nodes:[],selections:e}}function aM(e,t){return e===t?!0:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((i,s)=>aM(i,t[s])):My(e)&&My(t)?e.equals(t):Lt(e)&&Lt(t)?f0(e,t,aM):!1}var $R=class{constructor(e){var i,s,n,a,r,o,l;this.isComplete=!1,this.elapsed=0,this.iteration=0,this.isPlaying=!1,this.isReverse=!1,this.id=e.id,this.groupId=e.groupId,this.autoplay=(i=e.autoplay)!=null?i:!0,this.ease=(s=e.ease)!=null?s:WR,this.phase=e.phase;const t=(n=e.duration)!=null?n:Tg[this.phase].animationDuration;this.duration=t*e.defaultDuration,this.delay=((a=e.delay)!=null?a:0)*e.defaultDuration,this.onComplete=e.onComplete,this.onPlay=e.onPlay,this.onStop=e.onStop,this.onUpdate=e.onUpdate,this.interpolate=this.createInterpolator(e.from,e.to),this.from=e.from,e.skip===!0&&((r=this.onUpdate)==null||r.call(this,e.to,!1,this),(o=this.onStop)==null||o.call(this,this),(l=this.onComplete)==null||l.call(this,this),this.isComplete=!0),e.collapsable!==!1&&(this.duration=this.checkCollapse(e,this.duration))}checkCollapse(e,t){return aM(e.from,e.to)?0:t}play(e=!1){var t,i;this.isPlaying||this.isComplete||(this.isPlaying=!0,(t=this.onPlay)==null||t.call(this,this),this.autoplay&&(this.autoplay=!1,e&&((i=this.onUpdate)==null||i.call(this,this.from,!0,this))))}stop(){var e;this.isPlaying=!1,this.isComplete||(this.isComplete=!0,(e=this.onStop)==null||e.call(this,this))}update(e){var n,a;if(this.isComplete)return e;!this.isPlaying&&this.autoplay&&this.play(!0);const t=this.elapsed;if(this.elapsed+=e,this.delay>this.elapsed)return 0;const i=this.interpolate(this.isReverse?1-this.delta:this.delta);(n=this.onUpdate)==null||n.call(this,i,!1,this);const s=this.delay+this.duration;return this.elapsed>=s?(this.stop(),this.isComplete=!0,(a=this.onComplete)==null||a.call(this,this),e-(s-t)):0}get delta(){return this.ease(we(0,(this.elapsed-this.delay)/this.duration,1))}createInterpolator(e,t){if(typeof t!="object"||My(t))return this.interpolateValue(e,t);const i=[];for(const s of Object.keys(t)){const n=this.interpolateValue(e[s],t[s]);n!=null&&i.push([s,n])}return s=>{const n={};for(const[a,r]of i)n[a]=r(s);return n}}interpolateValue(e,t){if(!(e==null||t==null)){if(My(e))return i=>e[Sy](t,i);try{switch(typeof e){case"number":return bte(e,t);case"string":return HR(e,t);case"boolean":if(e===t)return()=>e;break;case"object":return()=>e;default:throw new Error(`Unable to interpolate values: ${e}, ${t}`)}}catch(i){}throw new Error(`Unable to interpolate values: ${e}, ${t}`)}}},YR=class{constructor(e){this.maxAnimationTime=e,this.debug=ct.create(!0,"animation"),this.controllers=new Map,this.stoppedCbs=new Set,this.currentPhase=0,this.phases=new Map(hu.map(t=>[t,[]])),this.skipAnimations=!1,this.animationTimeConsumed=0,this.isReady=!1}get size(){return this.controllers.size}get consumedTimeMs(){return this.animationTimeConsumed}isActive(){return this.controllers.size>0}getActiveControllers(){var e;return(e=this.phases.get(hu[this.currentPhase]))!=null?e:[]}checkOverlappingId(e){e!=null&&this.controllers.has(e)&&(this.controllers.get(e).stop(),this.debug(`Skipping animation batch due to update of existing animation: ${e}`),this.skip())}addAnimation(e){var i;if(e.isComplete)return;if(hu.indexOf(e.phase)<this.currentPhase){this.debug("Skipping animation due to being for an earlier phase",e.id),e.stop();return}this.controllers.set(e.id,e),(i=this.phases.get(e.phase))==null||i.push(e)}removeAnimation(e){this.controllers.delete(e.id);const t=this.phases.get(e.phase),i=t==null?void 0:t.indexOf(e);i!=null&&i>=0&&(t==null||t.splice(i,1))}progress(e){if(!this.isReady)return;let t=e===0?.01:e;const i=()=>{const c=hu[this.currentPhase];return{phaseControllers:[...this.getActiveControllers()],phase:c,phaseMeta:Tg[c]}};let{phase:s,phaseControllers:n,phaseMeta:a}=i();const r=()=>hu[this.currentPhase]==null,o=()=>{for({phase:s,phaseControllers:n,phaseMeta:a}=i();!r()&&n.length===0;)this.currentPhase++,{phase:s,phaseControllers:n,phaseMeta:a}=i(),this.debug(`AnimationBatch - phase changing to ${s}`,{unusedTime:t},n)},l=this.controllers.size;this.debug(`AnimationBatch - ${e}ms; phase ${s} with ${n==null?void 0:n.length} of ${l}`);do{const c=t,h=a.skipIfNoEarlierAnimations&&this.animationTimeConsumed===0;let d=0;for(const u of n)h?u.stop():t=Math.min(u.update(c),t),u.isComplete&&(d++,this.removeAnimation(u));this.animationTimeConsumed+=c-t,this.debug(`AnimationBatch - updated ${n.length} controllers; ${d} completed`),this.debug(`AnimationBatch - animationTimeConsumed: ${this.animationTimeConsumed}`),o()}while(t>0&&!r());this.animationTimeConsumed>this.maxAnimationTime&&(this.debug("Animation batch exceeded max animation time, skipping",[...this.controllers]),this.stop())}ready(){if(this.isReady)return;this.isReady=!0,this.debug(`AnimationBatch - ready; skipped: ${this.skipAnimations}`,[...this.controllers]);let e=!0;for(const[,t]of this.controllers)if(t.duration>0&&Tg[t.phase].skipIfNoEarlierAnimations!==!0){e=!1;break}if(!e)for(const[,t]of this.controllers)t.autoplay&&t.play(!0)}skip(e=!0){if(this.skipAnimations===!1&&e===!0){for(const t of this.controllers.values())t.stop();this.controllers.clear()}this.skipAnimations=e}play(){for(const e of this.controllers.values())e.play()}stop(){for(const e of this.controllers.values())try{e.stop(),this.removeAnimation(e)}catch(t){se.error("Error during animation stop",t)}this.dispatchStopped()}stopByAnimationId(e){if(e!=null&&this.controllers.has(e)){const t=this.controllers.get(e);t&&(t.stop(),this.removeAnimation(t))}}stopByAnimationGroupId(e){for(const t of this.controllers.values())t.groupId===e&&this.stopByAnimationId(t.id)}dispatchStopped(){this.stoppedCbs.forEach(e=>e()),this.stoppedCbs.clear()}isSkipped(){return this.skipAnimations}getRemainingTime(e){if(!this.isActive())return 0;let t=0;for(const[i,s]of this.phases)s.length!==0&&(e!=null&&e!==i||(t+=Math.max(...s.map(n=>{var a;return n.isComplete?0:n.delay+n.duration-((a=n.elapsed)!=null?a:0)}))));return t}destroy(){this.stop(),this.controllers.clear()}},XR=(e=>(e[e.Default=32]="Default",e[e.ZoomDrag=16]="ZoomDrag",e[e.Annotations=8]="Annotations",e[e.ContextMenu=4]="ContextMenu",e[e.Animation=2]="Animation",e[e.AnnotationsSelected=1]="AnnotationsSelected",e[e.Clickable=41]="Clickable",e[e.Focusable=34]="Focusable",e[e.Keyable=43]="Keyable",e[e.ContextMenuable=36]="ContextMenuable",e[e.AnnotationsMoveable=9]="AnnotationsMoveable",e[e.AnnotationsDraggable=57]="AnnotationsDraggable",e[e.ZoomDraggable=50]="ZoomDraggable",e[e.ZoomClickable=34]="ZoomClickable",e[e.ZoomWheelable=59]="ZoomWheelable",e[e.All=63]="All",e))(XR||{}),ZR=class{constructor(){this.stateQueue=34}pushState(e){this.stateQueue|=e}popState(e){this.stateQueue&=~e}isState(e){return!!(this.stateQueue&-this.stateQueue&e)}};function qR(e){return e==null?!0:!isNaN(e)&&e>=0&&e<=2}var QR=class{constructor(e,t){this.interactionManager=e,this.chartUpdateMutex=t,this.defaultDuration=1e3,this.batch=new YR(this.defaultDuration*1.5),this.debug=ct.create(!0,"animation"),this.events=new ag,this.rafAvailable=typeof requestAnimationFrame!="undefined",this.isPlaying=!0,this.requestId=null,this.skipAnimations=!0,this.currentAnonymousAnimationId=0}addListener(e,t){return this.events.on(e,t)}animate(e){const t=this.batch;try{t.checkOverlappingId(e.id)}catch(o){this.failsafeOnError(o);return}let{id:i}=e;i==null&&(i=`__${this.currentAnonymousAnimationId}`,this.currentAnonymousAnimationId+=1);const s=this.isSkipped()||e.phase==="none";s&&this.debug("AnimationManager - skipping animation");const{delay:n,duration:a}=e;if(!qR(n))throw new Error(`Animation delay of ${n} is unsupported (${i})`);if(!qR(a))throw new Error(`Animation duration of ${a} is unsupported (${i})`);const r=new $R(E(b({},e),{id:i,skip:s,autoplay:this.isPlaying?e.autoplay:!1,phase:e.phase,defaultDuration:this.defaultDuration}));if(!this.forceTimeJump(r,this.defaultDuration))return this.batch.addAnimation(r),r}play(){if(!this.isPlaying){this.isPlaying=!0,this.debug("AnimationManager.play()");try{this.batch.play()}catch(e){this.failsafeOnError(e)}this.requestAnimation()}}stop(){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.stop()"),this.batch.stop()}stopByAnimationId(e){try{this.batch.stopByAnimationId(e)}catch(t){this.failsafeOnError(t)}}stopByAnimationGroupId(e){try{this.batch.stopByAnimationGroupId(e)}catch(t){this.failsafeOnError(t)}}reset(){this.isPlaying?(this.stop(),this.play()):this.stop()}skip(e=!0){this.skipAnimations=e}isSkipped(){return!this.rafAvailable||this.skipAnimations||this.batch.isSkipped()}isActive(){return this.isPlaying&&this.batch.isActive()}getRemainingTime(e){return this.batch.getRemainingTime(e)}skipCurrentBatch(){this.debug.check()&&this.debug("AnimationManager - skipCurrentBatch()",{stack:new Error().stack}),this.batch.skip()}isSkippingFrames(){return!0}scheduleAnimationFrame(e){this.requestId=Ct().requestAnimationFrame(t=>{e(t).catch(i=>se.error(i))})}forceTimeJump(e,t){return!1}requestAnimation(){if(!this.rafAvailable||!this.batch.isActive()||this.requestId!==null)return;let e;const t=async i=>{const s=()=>{const n=i-(e!=null?e:i);e=i,this.debug("AnimationManager - onAnimationFrame()",{controllersCount:this.batch.size,deltaTime:n}),this.interactionManager.pushState(2);try{this.batch.progress(n)}catch(a){this.failsafeOnError(a)}this.events.emit("animation-frame",{type:"animation-frame",deltaMs:n})};this.isSkippingFrames()?await this.chartUpdateMutex.acquireImmediately(s):await this.chartUpdateMutex.acquire(s),this.batch.isActive()?this.scheduleAnimationFrame(t):(this.batch.stop(),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}))};this.events.emit("animation-start",{type:"animation-start",deltaMs:0}),this.scheduleAnimationFrame(t)}cancelAnimation(){this.requestId!==null&&(cancelAnimationFrame(this.requestId),this.requestId=null,this.startBatch())}failsafeOnError(e,t=!0){se.error("Error during animation, skipping animations",e),t&&this.cancelAnimation()}startBatch(e){this.debug(`AnimationManager - startBatch() with skipAnimations=${e}.`),this.reset(),this.batch.destroy(),this.batch=new YR(this.defaultDuration*1.5),e===!0&&this.batch.skip()}endBatch(){this.batch.isActive()?(this.batch.ready(),this.requestAnimation()):(this.interactionManager.popState(2),this.batch.isSkipped()&&this.batch.skip(!1))}onBatchStop(e){this.batch.stoppedCbs.add(e)}destroy(){this.stop(),this.events.clear()}},JR=class extends wo{seriesEvent(e){this.listeners.dispatch(e,{type:e})}seriesKeyNavZoom(e,t){const i={type:"series-keynav-zoom",delta:e,widgetEvent:t};this.listeners.dispatch("series-keynav-zoom",i)}legendItemClick(e,t,i,s,n){const a={type:"legend-item-click",legendType:e,series:t,itemId:i,enabled:s,legendItemName:n};this.listeners.dispatch("legend-item-click",a)}legendItemDoubleClick(e,t,i,s,n,a){const r={type:"legend-item-double-click",legendType:e,series:t,itemId:i,enabled:s,legendItemName:a,numVisibleItems:n};this.listeners.dispatch("legend-item-double-click",r)}},Ate=class{constructor(){this.download={type:"action",showOn:"always",label:"contextMenuDownload",enabled:!0,action:void 0,items:void 0},this["zoom-to-cursor"]={type:"action",showOn:"series-area",label:"contextMenuZoomToCursor",enabled:!0,action:void 0,items:void 0},this["pan-to-cursor"]={type:"action",showOn:"series-area",label:"contextMenuPanToCursor",enabled:!0,action:void 0,items:void 0},this["toggle-series-visibility"]={type:"action",showOn:"legend-item",label:"contextMenuToggleSeriesVisibility",enabled:!0,action:void 0,items:void 0},this["toggle-other-series"]={type:"action",showOn:"legend-item",label:"contextMenuToggleOtherSeries",enabled:!0,action:void 0,items:void 0},this.separator={type:"separator",showOn:"always",label:"separator",enabled:!0,action:void 0,items:void 0}}},Ite=class{constructor(){this.defaults=["download","zoom-to-cursor","pan-to-cursor","toggle-series-visibility","toggle-other-series"]}},eN=class{constructor(){this.items=new Ate,this.lists=new Ite}},tN=class extends wo{constructor(){super(),this.builtins=new eN,this.hiddenActions=new Set,this.setVisible("zoom-to-cursor",!1),this.setVisible("pan-to-cursor",!1)}static check(e,t){return t.showOn==e}static checkCallback(e,t,i){return e===t}dispatchContext(e,t,i,s){var l,c;const{widgetEvent:n}=t;if(n.sourceEvent.defaultPrevented)return;const a=(l=s==null?void 0:s.x)!=null?l:t.canvasX,r=(c=s==null?void 0:s.y)!=null?c:t.canvasY,o={type:"context-setup",showOn:e,x:a,y:r,context:i,widgetEvent:n};this.listeners.dispatch("context-setup",o),o.type="context-complete",this.listeners.dispatch("context-complete",o)}isVisible(e){return!this.hiddenActions.has(e)}setVisible(e,t){t?this.hiddenActions.delete(e):this.hiddenActions.add(e)}},iN=class extends wo{constructor(){super(...arguments),this.highlightStates=new ou}updateHighlight(e,t){const{activeHighlight:i}=this;this.highlightStates.set(e,t),this.activeHighlight=this.highlightStates.stateValue(),this.isEqual(this.activeHighlight,i)||this.listeners.dispatch("highlight-change",{type:"highlight-change",currentHighlight:this.activeHighlight,previousHighlight:i,callerId:e})}getActiveHighlight(){return this.activeHighlight}isEqual(e,t){return e===t||e!=null&&t!=null&&(e==null?void 0:e.series)===(t==null?void 0:t.series)&&(e==null?void 0:e.itemId)===(t==null?void 0:t.itemId)&&(e==null?void 0:e.datum)===(t==null?void 0:t.datum)}};function sN(e,t){if(e==null||t.length===0)return[!1,!1];const i=e.valueOf(),s=t[0],n=t[t.length-1];if(typeof s=="string")return[i===s,i===n];let a=s.valueOf(),r=n.valueOf();return a>r&&([a,r]=[r,a]),[i===a,i===r]}function Ol(e,t,i,s,n){const{xValue:a,yValue:r}=e,[o,l]=sN(r,n),[c,h]=sN(a,s);return{xKey:t,yKey:i,xValue:a,yValue:r,first:c,last:h,min:o,max:l}}function nN(e,[t,i],s){var r,o;const n=(r=hg(0,e-1,l=>{var h,d;const c=(d=(h=s(l))==null?void 0:h[1])!=null?d:NaN;return!Number.isFinite(c)||c>t}))!=null?r:0;let a=(o=kl(0,e-1,l=>{var h,d;const c=(d=(h=s(l))==null?void 0:h[0])!=null?d:NaN;return!Number.isFinite(c)||c<i}))!=null?o:e-1;return a=Math.min(a+1,e),[n,a]}function rM(e,t,i){var n,a,r,o;if(i){const{x:l,y:c,width:h,height:d}=i;return{canvasX:l+h/2,canvasY:c+d/2}}const s=(o=(a=(n=t.yBar)==null?void 0:n.upperPoint)!=null?a:t.midPoint)!=null?o:(r=e.datumMidPoint)==null?void 0:r.call(e,t);if(s){const{x:l,y:c}=ai.toCanvasPoint(e.contentGroup,s.x,s.y);return{canvasX:Math.round(l),canvasY:Math.round(c)}}}function aN(e,t,i,s,n){let a=-1,r=0,o=0,l=!1;for(;r<s&&a<=t-e;){a+=1;const c=i+o;if(l||(o*=-1),o>=0&&(o+=1),l&&o<0&&(o-=1),c<e||c>t){l=!0;continue}n(c)&&(r+=1)}return r}var qy=class{constructor(e,t,i){this.domManager=t,this.tooltip=i,this.stateTracker=new ou,this.suppressState=new ou(!1),this.appliedState=null,this.destroyFns=[],this.destroyFns.push(i.setup(e,t),t.addListener("hidden",()=>this.tooltip.hide()))}destroy(){this.destroyFns.forEach(e=>e())}updateTooltip(e,t,i,s){var n;i!=null||(i=(n=this.stateTracker.get(e))==null?void 0:n.content),this.stateTracker.set(e,{meta:t,content:i,pagination:s}),this.applyStates()}removeTooltip(e){this.stateTracker.delete(e),this.applyStates()}suppressTooltip(e){this.suppressState.set(e,!0)}unsuppressTooltip(e){this.suppressState.delete(e)}applyStates(){var n;const e=this.stateTracker.stateId(),t=e?this.stateTracker.get(e):void 0;if(this.suppressState.stateValue()||(t==null?void 0:t.meta)==null||(t==null?void 0:t.content)==null){this.appliedState=null,this.tooltip.hide();return}const i=this.domManager.getBoundingClientRect(),s=this.tooltip.bounds==="extended"?this.domManager.getOverlayClientRect():i;if(((n=this.appliedState)==null?void 0:n.content)===(t==null?void 0:t.content)){const a=this.tooltip.isVisible();this.tooltip.show(s,i,t==null?void 0:t.meta,null,void 0,a)}else this.tooltip.show(s,i,t==null?void 0:t.meta,t==null?void 0:t.content,t==null?void 0:t.pagination);this.appliedState=t}static makeTooltipMeta(e,t,i,s){var f,y,v,x;const{canvasX:n,canvasY:a}=e,r=t.properties.tooltip,{placement:o,defaultPlacement:l,anchorTo:c,defaultAnchorTo:h,xOffset:d,yOffset:u}=r.position,p=rM(t,i,s);return{canvasX:n,canvasY:a,nodeCanvasX:(f=p==null?void 0:p.canvasX)!=null?f:n,nodeCanvasY:(y=p==null?void 0:p.canvasY)!=null?y:a,enableInteraction:(x=(v=r.interaction)==null?void 0:v.enabled)!=null?x:!1,showArrow:r.showArrow,position:{placement:o,defaultPlacement:l,anchorTo:c,defaultAnchorTo:h,xOffset:d,yOffset:u}}}isEnteringInteractiveTooltip(e){const{tooltip:t}=this,i=e.relatedTarget;return t.interactive&&t.enabled&&t.isVisible()&&t.contains(i)}},rN=3,Tte=505,oN=30;function oM(e,t,i){const{offsetX:s,offsetY:n,clientX:a,clientY:r,currentX:o,currentY:l,sourceEvent:c}=i;return{type:t,device:e,offsetX:s,offsetY:n,clientX:a,clientY:r,currentX:o,currentY:l,sourceEvent:c}}function lN(e,t){const i=e*e+t*t,s=rN*rN;return i>=s}function kte(e,t){const i=e.clientX-t.clientX,s=e.clientY-t.clientY,n=i*i+s*s,a=oN*oN;return n<a}var cN=class{constructor(e){this.destroyFns=[],this.listeners=new Nl,this.isDragging=!1,this.touch={distanceTravelledX:0,distanceTravelledY:0,clientX:0,clientY:0},this.destroyFns.push(e.addListener("touchstart",this.onTouchStart.bind(this)),e.addListener("touchmove",this.onTouchMove.bind(this)),e.addListener("touchend",this.onTouchEnd.bind(this)),e.addListener("mousemove",this.onMouseMove.bind(this)),e.addListener("dblclick",this.onDblClick.bind(this)),e.addListener("drag-start",this.onDragStart.bind(this)),e.addListener("drag-move",this.onDragMove.bind(this)),e.addListener("drag-end",this.onDragEnd.bind(this)))}destroy(){this.destroyFns.forEach(e=>e()),this.listeners.destroy()}addListener(e,t){return this.listeners.addListener(e,t)}dispatch(e){this.listeners.dispatch(e.type,e)}onTouchStart(e){var s;const{clientX:t,clientY:i}=(s=e.sourceEvent.targetTouches[0])!=null?s:{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX=0,this.touch.distanceTravelledY=0,this.touch.clientX=t,this.touch.clientY=i}onTouchMove(e){var s;const{clientX:t,clientY:i}=(s=e.sourceEvent.targetTouches[0])!=null?s:{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX+=Math.abs(this.touch.clientX-t),this.touch.distanceTravelledY+=Math.abs(this.touch.clientY-i),this.touch.clientX=t,this.touch.clientY=i}onTouchEnd(e){e.sourceEvent.preventDefault()}onMouseMove(e){this.dispatch(e)}onDblClick(e){this.dispatch(b({device:"mouse"},e))}onDragStart(e){this.dragStartEvent=e}onDragMove(e){this.dragStartEvent!=null&&lN(e.originDeltaX,e.originDeltaY)&&(this.dispatch(this.dragStartEvent),this.dispatch(E(b({},this.dragStartEvent),{type:"drag-move"})),this.dragStartEvent=void 0,this.isDragging=!0),this.isDragging&&this.dispatch(e)}onDragEnd(e){if(this.isDragging){this.dispatch(e),this.isDragging=!1;return}if(e.device==="mouse"){const t=oM("mouse","click",e);this.dispatch(t)}else if(e.sourceEvent.type==="touchend"){if(lN(this.touch.distanceTravelledX,this.touch.distanceTravelledY))return;const t=oM("touch","click",e);this.dispatch(t);const i=Date.now();if(this.lastClick!==void 0&&i-this.lastClick.time<=Tte&&kte(this.lastClick,e)){const s=oM(e.device,"dblclick",e);this.dispatch(s),this.lastClick=void 0}else this.lastClick={time:i,clientX:e.clientX,clientY:e.clientY}}}},lM=class extends lu{constructor(e){super(e)}addChildToDOM(){}removeChildFromDOM(){}},Lte=class{constructor(e){this.seriesWidget=new lM(e.getParent("series-area")),this.chartWidget=new lM(e.getParent("canvas-proxy")),this.containerWidget=new lM(e.getParent("canvas-container")),this.containerWidget.addChild(this.chartWidget),this.chartWidget.addChild(this.seriesWidget),this.seriesDragInterpreter=new cN(this.seriesWidget)}destroy(){this.seriesDragInterpreter.destroy(),this.seriesWidget.destroy(),this.chartWidget.destroy(),this.containerWidget.destroy()}};function cM(e,t){const[i,s]=ss(t);return we(i,e,s)}function ss(e){if(e.length===0)return[];const t=[1/0,-1/0];for(const i of e)i<t[0]&&(t[0]=i),i>t[1]&&(t[1]=i);return t}function du(e){const[t,i]=ss(e);return i-t}var hN=class Sj extends ky{constructor(t=[],i=[]){super(),this.domain=t,this.range=i,this.defaultClamp=!1}static is(t){return t instanceof Sj}normalizeDomains(...t){return hM(...t)}transform(t){return t}transformInvert(t){return t}calcBandwidth(t=1,i=1){const{domain:s}=this,n=this.getPixelRange();if(s.length===0)return n;let r=Math.abs(s[1].valueOf()-s[0].valueOf())/t+1;if(i!==0){const o=Math.floor(n);r=Math.min(r,o)}return n/Math.max(1,r)}convert(t,i){var d;const{domain:s}=this;if(!s||s.length<2)return NaN;const n=(d=i==null?void 0:i.clamp)!=null?d:this.defaultClamp,a=Number(this.transform(s[0])),r=Number(this.transform(s[1])),o=Number(this.transform(t)),{range:l}=this,[c,h]=l;if(n){const[u,p]=ss([a,r]);if(o<u)return c;if(o>p)return h}return a===r?(c+h)/2:o===a?c:o===r?h:c+(o-a)/(r-a)*(h-c)}invert(t,i){const s=this.domain.map(h=>this.transform(h)),[n,a]=s,{range:r}=this,[o,l]=r;let c;return o===l?c=this.toDomain((Number(n)+Number(a))/2):c=this.toDomain(Number(n)+(t-o)/(l-o)*(Number(a)-Number(n))),this.transformInvert(c)}getPixelRange(){const[t,i]=this.range;return Math.abs(i-t)}};hN.defaultTickCount=5;var Mt=hN;function hM(...e){let t,i=1/0,s,n=-1/0;for(const a of e)for(const r of a){const o=r.valueOf();o<i&&(i=o,t=r),o>n&&(n=o,s=r)}return t!=null&&s!=null?{domain:[t,s],animatable:!0}:{domain:[],animatable:!1}}var dN={};Ua(dN,{TimeInterval:()=>ji,day:()=>To,friday:()=>Zte,hour:()=>fu,millisecond:()=>uN,minute:()=>gu,monday:()=>Kte,month:()=>Ya,saturday:()=>qte,second:()=>pu,sunday:()=>Or,thursday:()=>Xte,tuesday:()=>$te,utcDay:()=>dM,utcHour:()=>cie,utcMinute:()=>rie,utcMonth:()=>yN,utcYear:()=>mN,wednesday:()=>Yte,year:()=>dh});var Fl=1e3,Ms=Fl*60,un=Ms*60,ba=un*24,Io=ba*7,kg=ba*30,uu=ba*365,ji=class BT{constructor(t,i,s,n,a,r=1,o){this.unit=t,this.milliseconds=i,this.hierarchy=s,this._encode=n,this._decode=a,this.step=r,this._rangeCallback=o}static extent(t,i,s){if(t.getTime()>i.getTime()&&([t,i]=[i,t],s!=null&&(s=[1-s[1],1-s[0]])),s!=null){const n=i.getTime()-t.getTime(),a=t.getTime();t=new Date(a+s[0]*n),i=new Date(a+s[1]*n)}return[t,i]}getOffset(t,i){return Math.floor(this._encode(new Date(t)))%i}floor(t){const i=new Date(t),s=this._encode(i);return this._decode(s)}ceil(t){const i=new Date(Number(t)-1),s=this._encode(i);return this._decode(s+1)}rangeIndices(t,i,{extend:s=!1,visibleRange:n=[0,1],limit:a}){[t,i]=BT.extent(t,i,n);const r=this._encode(s?this.floor(t):this.ceil(t));let o=this._encode(s?this.ceil(i):this.floor(i));return a!=null&&o-r>a&&(o=r+a),[r,o]}range(t,i,s={}){var l,c;let n;t.getTime()>i.getTime()?n=(l=this._rangeCallback)==null?void 0:l.call(this,i,t):n=(c=this._rangeCallback)==null?void 0:c.call(this,t,i);const[a,r]=this.rangeIndices(t,i,s),o=[];for(let h=a;h<=r;h++){const d=this._decode(h);o.push(d)}return n==null||n(),o}previous(t){return this._decode(this._encode(this.ceil(t))-1)}next(t){return this._decode(this._encode(this.floor(t))+1)}rangeCount(t,i,s={}){const[n,a]=this.rangeIndices(t,i,s);return a-n}every(t,i){if(t===1&&(i==null?void 0:i.snapTo)!=null)return this;const{unit:s,milliseconds:n,hierarchy:a,step:r}=this;let o=0,l;const c=t;t=Math.max(1,Math.round(t)),c!==t&&se.warnOnce(`interval step of [${c}] rounded to [${t}].`);const{snapTo:h="start"}=i!=null?i:{};if(typeof h=="string"){const p=o;l=(g,f)=>{const y=h==="start"?g:f;return o=this.getOffset(y,t),()=>o=p}}else typeof h=="number"?o=this.getOffset(new Date(h),t):h instanceof Date&&(o=this.getOffset(h,t));const d=p=>Math.floor((this._encode(p)-o)/t),u=p=>this._decode(p*t+o);return new BT(s,n*t,a,d,u,r*t,l)}};function Pte(e){return e.getFullYear()}function Ete(e){const t=new Date;return t.setFullYear(e),t.setMonth(0,1),t.setHours(0,0,0,0),t}var Rte=(365+1/4-1/100+1/400)*24*60*60*1e3,dh=new ji("year",Rte,void 0,Pte,Ete);function Nte(e){return e.getFullYear()*12+e.getMonth()}function Ote(e){const t=Math.floor(e/12),i=e-t*12;return new Date(t,i,1)}var Ya=new ji("month",dh.milliseconds/12,dh,Nte,Ote);function Fte(e){const t=e.getTimezoneOffset()*Ms;return Math.floor((e.getTime()-t)/ba)}function Bte(e){const t=new Date(1970,0,1);return t.setDate(t.getDate()+e),t}var To=new ji("day",1440*60*1e3,Ya,Fte,Bte);function _te(e){return e.getTime()}function Gte(e){return new Date(e)}var uN=new ji("millisecond",1,To,_te,Gte),pN=new Date().getTimezoneOffset()*Ms;function zte(e){return Math.floor((e.getTime()-pN)/Fl)}function Vte(e){return new Date(pN+e*Fl)}var pu=new ji("second",1e3,To,zte,Vte),gN=new Date().getTimezoneOffset()*Ms;function jte(e){return Math.floor((e.getTime()-gN)/Ms)}function Hte(e){return new Date(gN+e*Ms)}var gu=new ji("minute",60*1e3,To,jte,Hte),fN=new Date().getTimezoneOffset()*Ms;function Wte(e){return Math.floor((e.getTime()-fN)/un)}function Ute(e){return new Date(fN+e*un)}var fu=new ji("hour",3600*1e3,To,Wte,Ute);function uh(e){const i=(7+e-4)%7;function s(a){const r=a.getTimezoneOffset()*Ms;return Math.floor((a.getTime()-r)/Io-i/7)}function n(a){const r=new Date(1970,0,1);return r.setDate(r.getDate()+a*7+i),r}return new ji("day",10080*60*1e3,Ya,s,n,7)}var Or=uh(0),Kte=uh(1),$te=uh(2),Yte=uh(3),Xte=uh(4),Zte=uh(5),qte=uh(6);function Qte(e){return e.getUTCFullYear()}function Jte(e){const t=new Date;return t.setUTCFullYear(e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0),t}var mN=new ji("year",dh.milliseconds,void 0,Qte,Jte);function eie(e){return e.getUTCFullYear()*12+e.getUTCMonth()}function tie(e){const t=Math.floor(e/12),i=e-t*12;return new Date(Date.UTC(t,i,1))}var yN=new ji("month",Ya.milliseconds,mN,eie,tie);function iie(e){return Math.floor(e.getTime()/ba)}function sie(e){const t=new Date(0);return t.setUTCDate(t.getUTCDate()+e),t.setUTCHours(0,0,0,0),t}var dM=new ji("day",1440*60*1e3,yN,iie,sie);function nie(e){return Math.floor(e.getTime()/Ms)}function aie(e){return new Date(e*Ms)}var rie=new ji("minute",60*1e3,dM,nie,aie);function oie(e){return Math.floor(e.getTime()/un)}function lie(e){return new Date(e*un)}var cie=new ji("hour",3600*1e3,dM,oie,lie),Qy={periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function uM(e,t=new Date(e.getFullYear(),0,1)){const i=e.getTimezoneOffset()-t.getTimezoneOffset(),s=e.getTime()-t.getTime()+i*6e4,n=36e5*24;return Math.floor(s/n)}function vN(e,t){const s=new Date(e.getFullYear(),0,1).getDay(),n=(t-s+7)%7,a=new Date(e.getFullYear(),0,n+1);return a<=e?Math.floor(uM(e,a)/7)+1:0}var hie=0,bN=1,xN=4;function CN(e,t=e.getFullYear()){const s=new Date(t,0,1).getDay(),n=(xN-s+7)%7,a=new Date(t,0,n-(xN-bN)+1);return a<=e?Math.floor(uM(e,a)/7)+1:CN(e,t-1)}function die(e){const t=e.getTimezoneOffset(),i=Math.abs(t);return`${t>0?"-":"+"}${Ds(Math.floor(i/60),2,"0")}${Ds(Math.floor(i%60),2,"0")}`}var uie={a:e=>Qy.shortDays[e.getDay()],A:e=>Qy.days[e.getDay()],b:e=>Qy.shortMonths[e.getMonth()],B:e=>Qy.months[e.getMonth()],c:"%x, %X",d:(e,t)=>Ds(e.getDate(),2,t!=null?t:"0"),e:"%_d",f:(e,t)=>Ds(e.getMilliseconds()*1e3,6,t!=null?t:"0"),H:(e,t)=>Ds(e.getHours(),2,t!=null?t:"0"),I:(e,t)=>{const i=e.getHours()%12;return i===0?"12":Ds(i,2,t!=null?t:"0")},j:(e,t)=>Ds(uM(e)+1,3,t!=null?t:"0"),m:(e,t)=>Ds(e.getMonth()+1,2,t!=null?t:"0"),M:(e,t)=>Ds(e.getMinutes(),2,t!=null?t:"0"),L:(e,t)=>Ds(e.getMilliseconds(),3,t!=null?t:"0"),p:e=>e.getHours()<12?"AM":"PM",Q:e=>String(e.getTime()),s:e=>String(Math.floor(e.getTime()/1e3)),S:(e,t)=>Ds(e.getSeconds(),2,t!=null?t:"0"),u:e=>{let t=e.getDay();return t<1&&(t+=7),String(t%7)},U:(e,t)=>Ds(vN(e,hie),2,t!=null?t:"0"),V:(e,t)=>Ds(CN(e),2,t!=null?t:"0"),w:(e,t)=>Ds(e.getDay(),2,t!=null?t:"0"),W:(e,t)=>Ds(vN(e,bN),2,t!=null?t:"0"),x:"%-m/%-d/%Y",X:"%-I:%M:%S %p",y:(e,t)=>Ds(e.getFullYear()%100,2,t!=null?t:"0"),Y:(e,t)=>Ds(e.getFullYear(),4,t!=null?t:"0"),Z:e=>die(e),"%":()=>"%"},pie={_:" ",0:"0","-":""};function Ds(e,t,i){const s=String(Math.floor(e));return s.length>=t?s:`${i.repeat(t-s.length)}${s}`}function Lg(e){const t=[];for(;e.length>0;){let i=e.indexOf("%");if(i!==0){const o=i>0?e.substring(0,i):e;t.push(o)}if(i<0)break;const s=e[i+1],n=pie[s];n!=null&&i++;const a=e[i+1],r=uie[a];if(typeof r=="function")t.push([r,n]);else if(typeof r=="string"){const o=Lg(r);t.push([o,n])}else t.push(`${n!=null?n:""}${a}`);e=e.substring(i+2)}return i=>{const s=typeof i=="number"?new Date(i):i;return t.map(n=>typeof n=="string"?n:n[0](s,n[1])).join("")}}function Us(e){return e instanceof Date?e.getTime():e}function pM(e,t,i){const s=SN(e,t,i),n=Lg(s);return a=>n(a)}function SN(e,t,i=0){let s=1/0;for(let h=1;h<e.length;h++)s=Math.min(s,Math.abs(e[h].valueOf()-e[h-1].valueOf()));const[n,a]=t.length===0?[0,0]:ss([t[0].valueOf(),t[t.length-1].valueOf()]),r=new Date(n).getFullYear(),l=new Date(a).getFullYear()-r>0,c=isFinite(s)?gie(s,e):fie(e[0]);return yie(Math.max(c-i,0),l,e)}function gie(e,t){return e<Fl?0:e<Ms?1:e<un?2:e<ba?3:e<Io?4:e<ba*28||e<ba*31&&mie(t)?5:e<uu?6:7}function fie(e){return pu.floor(e)<e?0:gu.floor(e)<e?1:fu.floor(e)<e?2:To.floor(e)<e?3:Ya.floor(e)<e?Or.floor(e)<e?4:5:dh.floor(e)<e?6:7}function mie(e){let t=new Date(e[0]).getMonth();for(let i=1;i<e.length;i++){const s=new Date(e[i]).getMonth();if(t===s)return!0;t=s}return!1}function yie(e,t,i){const s=Us(i[0]),n=Us(i.at(-1)),a=Math.abs(n-s),r=t||e===7,o=a===0,c=[["hour",6*un,14*ba,3,"%I %p"],["hour",Ms,6*un,3,"%I:%M"],["second",1e3,6*un,1,":%S"],["ms",0,6*un,0,".%L"],["am/pm",Ms,6*un,3,"%p"]," ",["day",ba,Io,4,"%a"],["month",o?0:Io,52*Io,5,"%b %d"],["month",5*Io,10*uu,6,"%B"]," ",["year",r?0:uu,1/0,7,"%Y"]].filter(u=>{if(typeof u=="string")return!0;const[p,g,f,y]=u;return y>=e&&g<=a&&a<f}).reduce((u,p)=>(typeof p=="string"?u.result.push(p):u.used.has(p[0])||(u.result.push(p),u.used.add(p[0])),u),{result:[],used:new Set}).result,h=c.findIndex(u=>typeof u!="string"),d=c.findLastIndex(u=>typeof u!="string");return c.slice(h,d+1).map(u=>typeof u=="string"?u:u[4]).join("").replaceAll(/\s+/g," ").trim()}var gM=class Mj extends ky{constructor(){super(...arguments),this.invalid=!0,this.range=[0,1],this.round=!1,this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(t){return t instanceof Mj}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(t){t=we(0,t,1),this._paddingInner=t,this._paddingOuter=t}get padding(){return this._paddingInner}set paddingInner(t){this.invalid=!0,this._paddingInner=we(0,t,1)}get paddingInner(){return this._paddingInner}set paddingOuter(t){this.invalid=!0,this._paddingOuter=we(0,t,1)}get paddingOuter(){return this._paddingOuter}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&se.warnOnce("Expected update to not invalidate scale"))}convert(t,i){this.refresh();const s=this.findIndex(t);return s==null||s<0||s>=this.bands.length?NaN:this.ordinalRange(s)}invertNearestIndex(t){this.refresh();const i=this.bands.length;if(i===0)return-1;let s=0,n=i-1,a=1/0,r=0;for(;s<=n;){const o=(n+s)/2|0,l=this.ordinalRange(o),c=Math.abs(l-t);if(c===0)return o;c<a&&(a=c,r=o),l<t?s=o+1:n=o-1}return r}update(){const[t,i]=this.range;let{_paddingInner:s}=this;const{_paddingOuter:n,round:a,bands:r}=this,o=r.length;if(o===0)return;const l=i-t;let c;o===1?(s=0,c=l*(1-n*2)):c=l/Math.max(1,o-s+n*2);const h=a?Math.floor(c):c;let d=t+(l-h*(o-s))/2,u=h*(1-s);a&&(d=Math.round(d),u=Math.round(u)),this._step=h,this._inset=d,this._bandwidth=u,this._rawBandwidth=c*(1-s)}ordinalRange(t){const{_inset:i,_step:s,range:n}=this,a=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return we(a,i+s*t,r)}};I([yg],gM.prototype,"range",2),I([yg],gM.prototype,"round",2);var Pg=gM,Xa=class Dj extends Pg{static is(t){return t instanceof Dj}toDomain(t){return new Date(t)}convert(t,i){var f,y,v;const{domain:s,bands:n}=this;if(s.length<=0)return NaN;const a=this.ordinalRange(0),r=this.ordinalRange(n.length-1),o=(f=i==null?void 0:i.interpolate)!=null?f:!1,l=s[0].valueOf()>s[s.length-1].valueOf();if(!o){const x=super.convert(t,i);return l?r-(x-a):x}if(n.length===0)return a;const c=t.valueOf();let h;l?h=((y=hg(0,s.length-1,x=>s[x].valueOf()<=c))!=null?y:s.length)-1:h=(v=kl(0,s.length-1,x=>s[x].valueOf()<=c))!=null?v:0,h=Math.min(Math.max(h,0),s.length-2);const d=s[h].valueOf(),u=s[h+1].valueOf(),p=(c-d)/(u-d);return(h+p)/(s.length-1)*(r-a)+a}invert(t,i=!1){this.refresh();const{domain:s,bands:n}=this,a=s[0].valueOf()>s[s.length-1].valueOf();let r;if(i)r=this.invertNearestIndex(t-this.bandwidth/2);else{const o=hg(0,n.length-1,l=>this.ordinalRange(l)>=t);r=o!=null?o:0}return n[a?n.length-1-r:r]}tickFormatter({domain:t,ticks:i,specifier:s},n){return s!=null?Lg(s):pM(i,t,n)}},Eg={bottomCenter:Sie,center:Cie,clone:Aie,collides:Iie,end:bie,from:Tie,height:Die,round:wie,start:vie,topCenter:xie,origin:kie,width:Mie};function vie(e){return{x:e.x1,y:e.y1}}function bie(e){return{x:e.x2,y:e.y2}}function xie(e){return{x:(e.x1+e.x2)/2,y:Math.min(e.y1,e.y2)}}function Cie(e){return{x:(e.x1+e.x2)/2,y:(e.y1+e.y2)/2}}function Sie(e){return{x:(e.x1+e.x2)/2,y:Math.max(e.y1,e.y2)}}function Mie(e){return Math.abs(e.x2-e.x1)}function Die(e){return Math.abs(e.y2-e.y1)}function wie(e){return{x1:Math.round(e.x1),y1:Math.round(e.y1),x2:Math.round(e.x2),y2:Math.round(e.y2)}}function Aie(e){return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}function Iie(e,t){const i=fM(e),s=fM(t);return i.x1<=s.x2&&i.x2>=s.x1&&i.y1<=s.y2&&i.y2>=s.y1}function fM(e){return{x1:Math.min(e.x1,e.x2),x2:Math.max(e.x1,e.x2),y1:Math.min(e.y1,e.y2),y2:Math.max(e.y1,e.y2)}}function Tie(e,t,i,s){if(typeof e=="number")return{x1:e,y1:t,x2:i,y2:s};if("width"in e)return fM({x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y+e.height});throw new Error(`Values can not be converted into a vector4: [${JSON.stringify(e)}] [${t}] [${i}] [${s}]`)}function kie(){return{x1:0,y1:0,x2:0,y2:0}}function Jy(e,t,i,s,n){return t+(s-t)*((n-e)/(i-e))}function MN(e,t,i,s,n){return e+(n-t)*((i-e)/(s-t))}function DN(e,t,i){return[MN(e,i.min,t,i.max,0),MN(e,i.min,t,i.max,1)]}function Lie(e,t,i){const[s,n]=DN(e.x1,e.x2,t),[a,r]=DN(e.y1,e.y2,i);return{x1:s,x2:n,y1:a,y2:r}}function wN(e,t,i,s,n,a){if(i<=n&&a<=s)return i;const r=n-i,o=a-s,l=Math.abs(r)<Math.abs(o)?r:o;return we(e,i+l,t)}function Pie(e,t,i){const{x:s={min:0,max:1},y:n={min:0,max:1}}=t,a=Eg.from(i),r=Eg.from(e),o=Lie(r,s,n),l=wN(o.x1,o.x2,r.x1,r.x2,a.x1,a.x2),c=wN(o.y1,o.y2,r.y1,r.y2,a.y1,a.y2),h={x:{min:Jy(r.x1,s.min,r.x2,s.max,l),max:Jy(r.x1,s.min,r.x2,s.max,l+e.width)},y:{min:Jy(r.y1,n.min,r.y2,n.max,c),max:Jy(r.y1,n.min,r.y2,n.max,c+e.height)}},d=h.x.max-h.x.min,u=h.y.max-h.y.min;return h.x.min=we(0,h.x.min,1-d),h.x.max=h.x.min+d,h.y.min=we(0,h.y.min,1-u),h.y.max=h.y.min+u,h}var Eie=["rangeX","rangeY","ratioX","ratioY","autoScaledAxes"],Rie=class{constructor(){this.enabled=!1,this.padding=0,this.manuallyAdjusted=!1}},AN=e=>st((t,{options:i})=>!Mt.is(e==null?void 0:e.scale)&&!Xa.is(e==null?void 0:e.scale)||t==null||i.end==null?!0:t<=i.end,"to be less than end"),IN=class extends wo{constructor(e,t){super(),this.fireChartEvent=e,this.mementoOriginatorKey="zoom",this.axisZoomManagers=new Map,this.state=new ou(void 0,"initial"),this.axes=[],this.didLayoutAxes=!1,this.autoScaleYAxis=new Rie,this.lastRestoredState=void 0,this.independentAxes=!1,this.navigatorModule=!1,this.zoomModule=!1,this.pendingMemento=void 0,this.destroyFns.push(t.addListener("layout:complete",()=>{const{pendingMemento:i}=this,s=!this.didLayoutAxes;this.didLayoutAxes=!0,i?this.restoreMemento(i.version,i.mementoVersion,i.memento):s&&this.autoScaleYZoom("zoom-manager")}))}createMemento(){return this.getMementoRanges()}guardMemento(e,t){if(e==null)return!0;if(!Ve(e))return!1;for(const r of Object.keys(e))if(!Eie.includes(r))return!1;const i=this.getPrimaryAxis("x"),s=this.getPrimaryAxis("y"),n={rangeX:{start:Pt(Ne(ne,wr),AN(i)),end:Ne(ne,wr)},rangeY:{start:Pt(Ne(ne,wr),AN(s)),end:Ne(ne,wr)},ratioX:{start:Pt(Me,Ar("end")),end:Me},ratioY:{start:Pt(Me,Ar("end")),end:Me},autoScaledAxes:Ie(ce("y"))},{invalid:a}=js(e,n);return a.length>0?(t.push(...a.map(String)),!1):!0}restoreMemento(e,t,i){var o,l,c,h,d,u,p;const{independentAxes:s}=this;if(!this.axes||!this.didLayoutAxes){this.pendingMemento={version:e,mementoVersion:t,memento:i};return}this.pendingMemento=void 0;const n=this.getDefinedZoom();if(i!=null&&i.rangeX?n.x=(o=this.rangeToRatio(i.rangeX,"x"))!=null?o:{min:0,max:1}:i!=null&&i.ratioX?n.x={min:(l=i.ratioX.start)!=null?l:0,max:(c=i.ratioX.end)!=null?c:1}:n.x={min:0,max:1},!this.navigatorModule||this.zoomModule){let g=(h=i==null?void 0:i.autoScaledAxes)==null?void 0:h.includes("y");i!=null&&i.rangeY?(n.y=(d=this.rangeToRatio(i.rangeY,"y"))!=null?d:{min:0,max:1},g!=null||(g=!1)):i!=null&&i.ratioY?(n.y={min:(u=i.ratioY.start)!=null?u:0,max:(p=i.ratioY.end)!=null?p:1},g!=null||(g=!1)):(n.y={min:0,max:1},g!=null||(g=!0)),n.autoScaleYAxis=g}if(this.lastRestoredState=n,s!==!0){this.updateZoom("zoom-manager",n);return}const a=this.getPrimaryAxis("x"),r=this.getPrimaryAxis("y");for(const g of[a,r])g&&this.updateAxisZoom("zoom-manager",g.id,n[g.direction])}updateAxes(e){var i;this.axes=e;const t=new Map(e.map(s=>[s.id,this.axisZoomManagers.get(s.id)]));this.axisZoomManagers.clear();for(const s of e)this.axisZoomManagers.set(s.id,(i=t.get(s.id))!=null?i:new Nie(s));this.state.size>0&&e.length>0&&this.updateZoom(this.state.stateId(),this.state.stateValue())}setIndependentAxes(e=!0){this.independentAxes=e}setAutoScaleYAxis(e,t){this.autoScaleYAxis.enabled=e,this.autoScaleYAxis.padding=t}setNavigatorEnabled(e=!0){this.navigatorModule=e}setZoomModuleEnabled(e=!0){this.zoomModule=e}isNavigatorEnabled(){return this.navigatorModule}isZoomEnabled(){return this.zoomModule}updateZoom(e,t){if(t!=null&&t.x&&(t.x.min<0||t.x.max>1)&&(se.warnOnce(`Attempted to update x-axis zoom to an invalid ratio of [{ min: ${t.x.min}, max: ${t.x.max} }], expecting a ratio of 0 to 1, ignoring.`),t.x=void 0),t!=null&&t.y&&(t.y.min<0||t.y.max>1)&&(se.warnOnce(`Attempted to update y-axis zoom to an invalid ratio of [{ min: ${t.y.min}, max: ${t.y.max} }], expecting a ratio of 0 to 1, ignoring.`),t.y=void 0),this.axisZoomManagers.size===0){const s=this.state.stateId();(s==="initial"||s===e)&&this.state.set(e,t);return}this.state.set(e,t);const i=t==null?void 0:t.autoScaleYAxis;i!=null&&(this.autoScaleYAxis.manuallyAdjusted=!i),this.axisZoomManagers.forEach(s=>{s.updateZoom(e,t==null?void 0:t[s.getDirection()])}),this.applyChanges(e)}updateAxisZoom(e,t,i){var s;(s=this.axisZoomManagers.get(t))==null||s.updateZoom(e,i),this.applyChanges(e)}resetZoom(e){var i,s,n,a,r,o,l,c,h;this.autoScaleYAxis.manuallyAdjusted=!1;const t=this.getRestoredZoom();this.updateZoom(e,{x:{min:(s=(i=t==null?void 0:t.x)==null?void 0:i.min)!=null?s:0,max:(a=(n=t==null?void 0:t.x)==null?void 0:n.max)!=null?a:1},y:{min:(o=(r=t==null?void 0:t.y)==null?void 0:r.min)!=null?o:0,max:(c=(l=t==null?void 0:t.y)==null?void 0:l.max)!=null?c:1},autoScaleYAxis:(h=t==null?void 0:t.autoScaleYAxis)!=null?h:!0})}resetAxisZoom(e,t){var a,r;const i=this.axisZoomManagers.get(t),s=i==null?void 0:i.getDirection();if(s==null)return;const n=this.getRestoredZoom();if(s==="y"){const o=(a=n==null?void 0:n.autoScaleYAxis)!=null?a:!0;this.autoScaleYAxis.manuallyAdjusted=!o}for(const o of this.axes)o.direction===s&&this.updateAxisZoom(e,o.id,(r=n==null?void 0:n[s])!=null?r:{min:0,max:1})}setAxisManuallyAdjusted(e,t){var s;((s=this.axisZoomManagers.get(t))==null?void 0:s.getDirection())==="y"&&(this.autoScaleYAxis.manuallyAdjusted=!0)}updatePrimaryAxisZoom(e,t,i){const s=this.getPrimaryAxis(t);s&&this.updateAxisZoom(e,s.id,i)}panToBBox(e,t,i){if(!this.isZoomEnabled()&&!this.isNavigatorEnabled())return!1;const s=this.getZoom();if(s===void 0||!s.x&&!s.y)return!1;if(!(t.width>0&&t.height>0&&Math.abs(i.width)<=Math.abs(t.width)&&Math.abs(i.height)<=Math.abs(t.height)))return se.warnOnce("cannot pan to target BBox - chart too small?"),!1;const a=Pie(t,s,i);return this.independentAxes?(this.updatePrimaryAxisZoom(e,"x",a.x),this.updatePrimaryAxisZoom(e,"y",a.y)):this.updateZoom(e,a),!0}fireZoomPanStartEvent(e){this.listeners.dispatch("zoom-pan-start",{type:"zoom-pan-start",callerId:e})}extendToEnd(e,t,i){return this.extendWith(e,t,s=>Number(s)-i)}extendWith(e,t,i){const s=this.getPrimaryAxis(t);if(!s)return;const n=this.getDomainExtents(s);if(!n)return;const[,a]=n,r=i(a),o=this.rangeToRatio({start:r,end:a},t);o&&this.updateZoom(e,{[t]:o})}updateWith(e,t,i){const s=this.getPrimaryAxis(t);if(!s)return;const n=this.getDomainExtents(s);if(!n)return;let[a,r]=n;[a,r]=i(a,r);const o=this.rangeToRatio({start:a,end:r},t);o&&this.updateZoom(e,{[t]:o})}getZoom(){let e,t;if(this.axisZoomManagers.forEach(i=>{i.getDirection()==="x"?e!=null||(e=i.getZoom()):i.getDirection()==="y"&&(t!=null||(t=i.getZoom()))}),e||t)return{x:e,y:t}}getAxisZoom(e){var t,i;return(i=(t=this.axisZoomManagers.get(e))==null?void 0:t.getZoom())!=null?i:{min:0,max:1}}getAxisZooms(){const e={};for(const[t,i]of this.axisZoomManagers.entries())e[t]={direction:i.getDirection(),zoom:i.getZoom()};return e}getRestoredZoom(){return this.lastRestoredState}getPrimaryAxisId(e){var t;return(t=this.getPrimaryAxis(e))==null?void 0:t.id}isVisibleItemsCountAtLeast(e,t){var l,c;const i=this.getPrimaryAxis("x"),s=this.getPrimaryAxis("y"),n=new Set;let a=0;const r=[e.x.min,e.x.max],o=[e.y.min,e.y.max];for(const h of(l=i==null?void 0:i.boundSeries)!=null?l:[]){n.add(h.id);const d=t-(a!=null?a:0),u=h.getVisibleItems(r,o,d);if(a+=u,a>=t)return!0}for(const h of(c=s==null?void 0:s.boundSeries)!=null?c:[]){if(n.has(h.id))continue;const d=t-(a!=null?a:0),u=h.getVisibleItems(r,o,d);if(a+=u,a>=t)return!0}return n.size===0}getMementoRanges(){const e=this.getDefinedZoom();let t;return this.autoScaleYAxis.enabled&&(t=this.autoScaleYAxis.manuallyAdjusted?[]:["y"]),{rangeX:this.getRangeDirection(e.x,"x"),rangeY:this.getRangeDirection(e.y,"y"),ratioX:{start:e.x.min,end:e.x.max},ratioY:{start:e.y.min,end:e.y.max},autoScaledAxes:t}}autoScaleYZoom(e,t=!0){var o,l;if(!this.isZoomEnabled())return;const{independentAxes:i,autoScaleYAxis:s}=this,n=this.getZoom();if((n==null?void 0:n.x)==null||!s.enabled||s.manuallyAdjusted)return;const{padding:a}=s;let r;if(((o=n.x)==null?void 0:o.min)===0&&((l=n.x)==null?void 0:l.max)===1?r={min:0,max:1}:i?r=this.primaryAxisZoom("y",n.x,{padding:a}):r=this.combinedAxisZoom("y",n.x,{padding:a}),r!=null){if(i){const c=this.getPrimaryAxis("y"),h=c==null?void 0:this.axisZoomManagers.get(c.id);h==null||h.updateZoom("zoom-manager",r)}else for(const c of this.axisZoomManagers.values())c.getDirection()==="y"&&c.updateZoom("zoom-manager",r);t&&this.applyChanges(e)}}applyChanges(e){if(this.autoScaleYZoom(e,!1),!Array.from(this.axisZoomManagers.values(),s=>s.applyChanges()).includes(!0))return;const i={};for(const[s,n]of this.axisZoomManagers.entries())i[s]=n.getZoom();this.listeners.dispatch("zoom-change",E(b({type:"zoom-change"},this.getZoom()),{axes:i,callerId:e})),this.fireChartEvent(b({type:"zoom"},this.getMementoRanges()))}getRangeDirection(e,t){const i=this.getPrimaryAxis(t);if(!i||!Mt.is(i.scale)&&!Xa.is(i.scale))return;const s=this.getDomainPixelExtents(i);if(!s)return;const[n,a]=s;let r,o;return n<=a?(r=i.scale.invert(0),o=i.scale.invert(n+(a-n)*e.max)):(r=i.scale.invert(n-(n-a)*e.min),o=i.scale.invert(0)),{start:r,end:o}}rangeToRatio(e,t){var p,g,f,y,v,x,S,M,D,A,w,T;const i=this.getPrimaryAxis(t);if(!i)return;const s=this.getDomainPixelExtents(i);if(!s)return;const[n,a]=s;let r=e.start==null?n:(g=(p=i.scale).convert)==null?void 0:g.call(p,e.start),o=e.end==null?a:(y=(f=i.scale).convert)==null?void 0:y.call(f,e.end);if(!Xe(r)||!Xe(o))return;const[l,c]=[Math.min(n,a),Math.max(n,a)];if(r<l||r>c){se.warnOnce(`Invalid range start [${e.start}], expecting a value between [${(x=(v=i.scale).invert)==null?void 0:x.call(v,n)}] and [${(M=(S=i.scale).invert)==null?void 0:M.call(S,a)}], ignoring.`);return}if(o<l||o>c){se.warnOnce(`Invalid range end [${e.end}], expecting a value between [${(A=(D=i.scale).invert)==null?void 0:A.call(D,n)}] and [${(T=(w=i.scale).invert)==null?void 0:T.call(w,a)}], ignoring.`);return}r=Math.min(c,Math.max(l,r)),o=Math.min(c,Math.max(l,o));const h=a-n,d=Math.abs((r-n)/h),u=Math.abs((o-n)/h);return{min:d,max:u}}getPrimaryAxis(e){var t;return(t=this.axes)==null?void 0:t.find(i=>i.direction===e)}getDomainExtents(e){const{domain:t}=e.scale,i=t.at(0),s=t.at(-1);if(!(i==null||s==null))return[i,s]}getDomainPixelExtents(e){var n,a,r,o;const{domain:t}=e.scale,i=(a=(n=e.scale).convert)==null?void 0:a.call(n,t.at(0)),s=(o=(r=e.scale).convert)==null?void 0:o.call(r,t.at(-1));if(!(!Xe(i)||!Xe(s)))return[i,s]}getDefinedZoom(){var t,i,s,n,a,r,o,l;const e=this.getZoom();return{x:{min:(i=(t=e==null?void 0:e.x)==null?void 0:t.min)!=null?i:0,max:(n=(s=e==null?void 0:e.x)==null?void 0:s.max)!=null?n:1},y:{min:(r=(a=e==null?void 0:e.y)==null?void 0:a.min)!=null?r:0,max:(l=(o=e==null?void 0:e.y)==null?void 0:o.max)!=null?l:1}}}zoomBounds(e,t,i,s){const n=e.scale,a=n.range;n.range=[0,1];const r=t.scale,o=r.range;r.range=[0,1];let l=1,c=!1,h=0,d=!1;for(const g of t.boundSeries){const{connectsToYAxis:f}=g,y=g.getRange("y",[i.min,i.max]);for(const v of y){const x=r.convert(v);Number.isFinite(x)&&(x<l&&(l=x,c=!f||v<0),x>h&&(h=x,d=!f||v>0))}}if(Xe(t.min)&&(l=0),Xe(t.max)&&(h=1),n.range=a,r.range=o,l>=h)return;const u=(c?s:0)+(d?s:0),p=Math.min((h-l)*(1+u),1);if(!(p<=0)){if(c&&d){const g=(h+l)/2;l=g-p/2,h=g+p/2}else!c&&d?h=l+p:c&&!d&&(l=h-p);return l<0?(h+=-l,l=0):h>1&&(l-=h-1,h=1),{min:l,max:h}}}primaryAxisZoom(e,t,{padding:i=0}={}){const s=e==="x"?"y":"x",n=this.getPrimaryAxis(s),a=this.getPrimaryAxis(e);if(!(n==null||a==null))return this.zoomBounds(n,a,t,i)}combinedAxisZoom(e,t,{padding:i=0}={}){const s=e==="x"?"y":"x",n=new Map;for(const l of this.axes)if(l.direction===s)for(const c of l.boundSeries)n.set(c,l);let a=1,r=0;for(const l of this.axes)if(l.direction===e)for(const c of l.boundSeries){const h=n.get(c);if(h==null)continue;const d=this.zoomBounds(h,l,t,i);if(d==null)return;a=Math.min(a,d.min),r=Math.max(r,d.max)}const o=1e-6;if(a<o&&(a=0),r>1-o&&(r=1),!(a>r))return{min:a,max:r}}},Nie=class{constructor(e){this.axis=e;const[t=0,i=1]=e.visibleRange;this.state=new ou({min:t,max:i}),this.currentZoom=this.state.stateValue()}getDirection(){return this.axis.direction}updateZoom(e,t){this.state.set(e,t)}getZoom(){return Bt(this.state.stateValue())}hasChanges(){const e=this.currentZoom,t=this.state.stateValue();return e.min!==t.min||e.max!==t.max}applyChanges(){const e=this.hasChanges();return this.currentZoom=this.state.stateValue(),e}};function Oie(e,t,i,s,n,a){if(e.size===0)return!1;let r=e.x,o=e.y;t!=null&&(r-=(t.x-.5)*e.size,o-=(t.y-.5)*e.size);let l=r;r<i?l=i:r>i+n&&(l=i+n);let c=o;o<s?c=s:o>s+a&&(c=s+a);const h=r-l,d=o-c;return Math.sqrt(h*h+d*d)<=e.size*.5}function TN(e,t,i,s,n){const a=e.x+e.width>t&&e.x<t+s,r=e.y+e.height>i&&e.y<i+n;return a&&r}function Fie(e,t,i,s,n){return t+s<e.x+e.width&&t>e.x&&i>e.y&&i+n<e.y+e.height}function Bie(e){return e!=null&&typeof e.point=="object"&&typeof e.label=="object"}var _ie={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},"top-left":{x:-1,y:-1},"top-right":{x:1,y:-1},"bottom-left":{x:-1,y:1},"bottom-right":{x:1,y:1}};function Gie(e,t,i=5){var o,l,c;const s=new Map,n=[],a=new Map([...e.entries()].map(([h,d])=>[h,d.toSorted((u,p)=>p.point.size-u.point.size)])),r=[...a.values()].flat();for(const[h,d]of a.entries()){const u=[];if((o=d[0])!=null&&o.label){for(let p=0,g=d.length;p<g;p++){const f=d[p],{point:y,label:v,anchor:x}=f,{text:S,width:M,height:D}=v,A=y.size*.5;let w=0,T=0;if(A>0&&f.placement!=null){const _=_ie[f.placement];w=(M*.5+A+i)*_.x,T=(D*.5+A+i)*_.y}const k=y.x-M*.5+w-(((l=x==null?void 0:x.x)!=null?l:.5)-.5)*y.size,N=y.y-D*.5+T-(((c=x==null?void 0:x.y)!=null?c:.5)-.5)*y.size;if(!(!t||Fie(t,k,N,M,D))||r.some(_=>Oie(_.point,_.anchor,k,N,M,D))||n.some(_=>TN(_,k,N,M,D)))continue;const B={index:p,text:S,x:k,y:N,width:M,height:D,datum:f};u.push(B),n.push(B)}s.set(h,u)}}return s}function kN(e,t=0){const i=[];for(let s=0;s<e.length;s++){const n=e[s],{point:{x:a,y:r},label:{text:o}}=n;let{width:l,height:c}=n.label;if(l+=t,c+=t,i.some(h=>TN(h,a,r,l,c)))return!0;i.push({index:s,text:o,x:a,y:r,width:l,height:c,datum:n})}return!1}var zie=class{constructor(){this.labelData=new Map}updateLabels(e,t,i=ve.zero){var r,o;const s={x:-t.left,y:-t.top,width:i.width+t.left+t.right,height:i.height+t.top+t.bottom},n=new Set(e.map(l=>l.id));for(const l of this.labelData.keys())n.has(l)||this.labelData.delete(l);for(const l of e){const c=l.getLabelData();c.every(Bie)&&this.labelData.set(l.id,c)}const a=Gie(this.labelData,s,5);for(const l of e)(o=l.updatePlacedLabelData)==null||o.call(l,(r=a.get(l.id))!=null?r:[])}},Vie=class extends wo{constructor(){super(...arguments),this.mementoOriginatorKey="legend",this.legendDataMap=new Map}createMemento(){return this.getData().filter(({hideInLegend:e,isFixed:t})=>!e&&!t).map(({enabled:e,seriesId:t,itemId:i,legendItemName:s})=>({visible:e,seriesId:t,itemId:i,legendItemName:s}))}guardMemento(e){return e==null||Ke(e)}restoreMemento(e,t,i){i==null||i.forEach(s=>{var r;const{seriesId:n,data:a}=(r=this.getRestoredData(s))!=null?r:{};!n||!a||this.updateData(n,a)}),this.update()}getRestoredData(e){var a,r;const{seriesId:t,itemId:i,legendItemName:s,visible:n}=e;if(t){const l=((a=this.legendDataMap.get(t))!=null?a:[]).map(c=>{const h=c.seriesId===t&&(!i||c.itemId===i);return h&&c.isFixed&&this.warnFixed(c.seriesId,c.itemId),!c.isFixed&&h?E(b({},c),{enabled:n}):c});return{seriesId:t,data:l}}if(!(i==null&&s==null))for(const o of this.getData()){if(i!=null&&o.itemId!==i||s!=null&&o.legendItemName!==s)continue;if(o.isFixed){this.warnFixed(o.seriesId,i);return}const l=((r=this.legendDataMap.get(o.seriesId))!=null?r:[]).map(c=>c.itemId===i||c.legendItemName===s?E(b({},c),{enabled:n}):c);return{seriesId:o.seriesId,data:l}}}warnFixed(e,t){se.warnOnce(`The legend item with seriesId [${e}] and itemId [${t}] is not configurable, this series item cannot be toggled through the legend.`)}update(e){this.listeners.dispatch("legend-change",{type:"legend-change",legendData:e!=null?e:this.getData()})}updateData(e,t=[]){this.legendDataMap.set(e,t)}clearData(){this.legendDataMap.clear()}toggleItem(e,t,i,s){if(s){this.getData().forEach(o=>{var c;const l=((c=this.legendDataMap.get(o.seriesId))!=null?c:[]).map(h=>h.legendItemName===s?E(b({},h),{enabled:e}):h);this.updateData(o.seriesId,l)});return}const n=this.getData(t),a=n.length===1,r=n.map(o=>i==null&&a||o.itemId===i?E(b({},o),{enabled:e}):o);this.updateData(t,r)}getData(e){var t;return e?(t=this.legendDataMap.get(e))!=null?t:[]:[...this.legendDataMap].reduce((i,[s,n])=>i.concat(n),[])}getDatum({seriesId:e,itemId:t}={}){return this.getData(e).find(i=>i.itemId===t)}getSeriesEnabled(e){const t=this.getData(e);if(t.length>0)return t.some(i=>i.enabled)}getItemEnabled({seriesId:e,itemId:t}={}){var i,s;return(s=(i=this.getDatum({seriesId:e,itemId:t}))==null?void 0:i.enabled)!=null?s:!0}},jie=class{constructor(){this.groups={}}registerSeries({internalId:e,seriesGrouping:t,visible:i,type:s}){var a;var n;t&&((a=(n=this.groups)[s])!=null||(n[s]={}),this.groups[s][e]={grouping:t,visible:i})}updateSeries({internalId:e,seriesGrouping:t,visible:i,type:s}){var a;if(!t)return;const n=(a=this.groups[s])==null?void 0:a[e];n&&(n.grouping=t,n.visible=i)}deregisterSeries({internalId:e,type:t}){this.groups[t]&&delete this.groups[t][e],this.groups[t]&&Object.keys(this.groups[t]).length===0&&delete this.groups[t]}getVisiblePeerGroupIndex({type:e,seriesGrouping:t,visible:i}){var r;if(!t)return{visibleGroupCount:i?1:0,visibleSameStackCount:i?1:0,index:0};const s=new Set,n=new Set;for(const o of Object.values((r=this.groups[e])!=null?r:{}))o.visible&&(s.add(o.grouping.groupIndex),o.grouping.groupIndex===t.groupIndex&&n.add(o.grouping.stackIndex));const a=Array.from(s);return a.sort((o,l)=>o-l),{visibleGroupCount:a.length,visibleSameStackCount:n.size,index:a.indexOf(t.groupIndex)}}},LN=class{constructor(e){this.updateCallback=e,this.events=new ag}addListener(e,t){return this.events.on(e,t)}removeListener(e,t){return this.events.on(e,t)}destroy(){this.events.clear()}update(e=0,t){this.updateCallback(e,t)}dispatchUpdateComplete(e){this.events.emit("update-complete",{type:"update-complete",apiUpdate:e})}dispatchPreDomUpdate(){this.events.emit("pre-dom-update",{type:"pre-dom-update"})}dispatchPreSceneRender(){this.events.emit("pre-scene-render",{type:"pre-scene-render"})}dispatchProcessData({series:e}){this.events.emit("process-data",{type:"process-data",series:e})}},Hie=class{constructor(e,t){this.callbackCache=new VR,this.chartEventManager=new JR,this.highlightManager=new iN,this.layoutManager=new vR,this.localeManager=new nte,this.seriesStateManager=new jie,this.stateManager=new Bee,this.seriesLabelLayoutManager=new zie,this.destroyFns=[],this.contextModules=[];const{scene:i,root:s,syncManager:n,container:a,fireEvent:r,updateCallback:o,updateMutex:l,styleContainer:c,chartType:h,domMode:d}=t;this.chartService=e,this.syncManager=n,this.domManager=new LR(this.chartService,a,c,d),this.widgets=new Lte(this.domManager);const u=this.domManager.addChild("canvas","scene-canvas",i==null?void 0:i.canvas.element);this.scene=i!=null?i:new Ky({canvasElement:u}),this.scene.setRoot(s),this.destroyFns.push(this.scene.on("scene-changed",()=>{this.updateService.update(7)})),this.axisManager=new yte(s),this.legendManager=new Vie,this.annotationManager=new mte(e.annotationRoot,r),this.chartTypeOriginator=new Oee(e),this.interactionManager=new ZR,this.contextMenuRegistry=new tN,this.updateService=new LN(o),this.proxyInteractionService=new FR(this.localeManager,this.domManager),this.fontManager=new vte(this.domManager,this.updateService),this.historyManager=new Fee(this.chartEventManager),this.animationManager=new QR(this.interactionManager,l),this.dataService=new Yy(this.animationManager),this.tooltipManager=new qy(this.localeManager,this.domManager,e.tooltip),this.zoomManager=new IN(r,this.layoutManager);for(const p of kr.byType("context")){if(!p.chartTypes.includes(h))continue;const g=p.moduleFactory(this);this.contextModules.push(g),this[p.contextKey]=g}}destroy(){this.animationManager.destroy(),this.highlightManager.destroy(),this.axisManager.destroy(),this.callbackCache.invalidateCache(),this.chartEventManager.destroy(),this.domManager.destroy(),this.fontManager.destroy(),this.highlightManager.destroy(),this.proxyInteractionService.destroy(),this.syncManager.destroy(),this.tooltipManager.destroy(),this.zoomManager.destroy(),this.widgets.destroy(),this.contextModules.forEach(e=>e.destroy()),this.destroyFns.forEach(e=>e())}},PN=class extends Be{constructor(){super(...arguments),this.range="tooltip"}};I([P],PN.prototype,"range",2);function Wie(e,t){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function Uie(e,t){if(e==null||t==null)return e===t;if(e.size!==t.size)return!1;for(const[i,s]of e){const n=t.get(i);if(n==null||!Wie(s,n))return!1}return!0}function Kie(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1){const i=e[n],{type:a,idsMap:r,scopes:o,data:l}=i,c=We(i,["type","idsMap","scopes","data"]),s=t[n],{type:h,idsMap:d,scopes:u,data:p}=s,g=We(s,["type","idsMap","scopes","data"]);if(a!==h||o&&u&&!fa(o,u)||l&&p&&l!==p||!dn(c,g)||!Uie(r,d))return!1}return!0}function $ie(e,t){const r=e,{props:i}=r,s=We(r,["props"]),o=t,{props:n}=o,a=We(o,["props"]);return dn(s,a)&&Kie(i,n)}function Yie(e,t,i,s){return t===e.data&&fa(i,e.ids)&&$ie(s,e.opts)}var EN=class wj{constructor(){this.domain=new Set}static is(t){return t instanceof wj}extend(t){this.domain.add(t)}getDomain(){return Array.from(this.domain)}},Bl=class Aj{constructor(){this.domain=[1/0,-1/0]}static is(t){return t instanceof Aj}static extendDomain(t,i=[1/0,-1/0]){for(const s of t)typeof s=="number"&&(i[0]>s&&(i[0]=s),i[1]<s&&(i[1]=s));return i}extend(t){this.domain[0]>t&&(this.domain[0]=t),this.domain[1]<t&&(this.domain[1]=t)}getDomain(){return[...this.domain]}},mu=0,yu=1,Fr=2,Xie=class{constructor(e){const t=e.reduce((a,r)=>Math.max(a,r.length),0);let s=1<<32-Math.clz32(t);t===s/2&&(s=s>>>1),this.maxLevelSize=s;const n=new Float64Array((s*2-1)*2).fill(NaN);for(const a of e)for(let r=0;r<a.length;r+=1){const o=Number(a[r]),l=s+r-1,c=(l*Fr|0)+mu,h=(l*Fr|0)+yu,d=n[c],u=n[h];(!Number.isFinite(d)||o<d)&&(n[c]=o),(!Number.isFinite(u)||o>u)&&(n[h]=o)}for(let a=s/2|0;a>=1;a=a/2|0){const r=a-1|0,o=r+a|0;for(let l=0;l<a;l+=1){const c=r+l,h=o+l*2,d=h+1,u=n[(h*Fr|0)+mu],p=n[(d*Fr|0)+mu];n[(c*Fr|0)+mu]=!Number.isFinite(p)||u<p?u:p;const g=n[(h*Fr|0)+yu],f=n[(d*Fr|0)+yu];n[(c*Fr|0)+yu]=!Number.isFinite(f)||g>f?g:f}}this.buffer=n}computeRangeInto(e,t,i,s,n,a,r){const o=n+a-1;if(o<t||n>=i)return r;if(n>=t&&o<i){const l=e[(s*Fr|0)+mu],c=e[(s*Fr|0)+yu];Number.isFinite(l)&&(r[0]=Math.min(r[0],l)),Number.isFinite(c)&&(r[1]=Math.max(r[1],c))}else a>1&&(s=s*2|0,a=a/2|0,this.computeRangeInto(e,t,i,s+1|0,n,a,r),this.computeRangeInto(e,t,i,s+2|0,n+a,a,r));return r}rangeBetween(e,t){if(e>t)return[NaN,NaN];const{maxLevelSize:i,buffer:s}=this,n=[1/0,-1/0];return this.computeRangeInto(s,e,t,0,0,i,n),n}get range(){const{buffer:e}=this;return[e[mu],e[yu]]}},RN=Symbol("domain-ranges");function Zie(e){return e.map(t=>Ve(t)?JSON.stringify(t):t).join("-")}function wn(e){const t=e==null?void 0:e.map(Number);return t!=null&&t.every(Number.isFinite)?t:[]}function mM(e,t){var i;return(i=t==null?void 0:t.get(e.id))!=null?i:0}function qie(e){return"scopes"in e&&Array.isArray(e.scopes)}function yM(e,t){const i=[];for(let s=0;s<e;s+=1)i[s]=t;return i}function ev(e,t,i){var n;const s=[];for(const a of e){const r=(n=a.get(t))==null?void 0:n[i];if(r==null)return;s.push(r)}return s}function NN(e){const t=[];let i=0,s;const n=new RegExp(`((?:(?:^|\\.)\\s*\\w+|\\[\\s*(?:'(?:[^']|(?<!\\\\)\\\\')*'|"(?:[^"]|(?<!\\\\)\\\\")*"|-?\\d+)\\s*\\])\\s*)`,"g");for(;s=n.exec(e);){if(s.index!==i)return;i=s.index+s[0].length;const a=s[1].trim();if(a.startsWith("."))t.push(a.slice(1).trim());else if(a.startsWith("[")){const r=a.slice(1,-1).trim();r.startsWith("'")?t.push(r.slice(1,-1).replace(new RegExp("(?<!\\\\)\\\\'","g"),"'")):r.startsWith('"')?t.push(r.slice(1,-1).replace(new RegExp('(?<!\\\\)\\\\"',"g"),'"')):t.push(r)}else t.push(a)}if(i===e.length)return t}function Qie(e){return t=>{let i=t;for(const s of e)i=i[s];return i}}var ON=class{constructor(e,t="standalone",i=!1){var o;this.opts=e,this.mode=t,this.suppressFieldDotNotation=i,this.debug=ct.create(!0,"data-model"),this.scopeCache=new Map,this.keys=[],this.values=[],this.aggregates=[],this.groupProcessors=[],this.propertyProcessors=[],this.reducers=[],this.processors=[],this.markScopeDatumInvalid=function(l,c,h,d){for(const u of l)d.has(u)||d.set(u,yM(c.length,!1)),d.get(u)[h]=!0};let s=!0;for(const l of e.props){if(l.type==="key"&&!s)throw new Error("AG Charts - internal config error: keys must come before values.");l.type==="value"&&s&&(s=!1)}const n=({matchGroupIds:l=[]})=>{for(const c of l)if(this.values.every(h=>h.groupId!==c))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${c}).`)},a=new Set,r=new Set;for(const l of e.props){const c=l.type==="key"?a:r;switch(qie(l)&&((o=l.scopes)==null||o.forEach(h=>c.add(h))),l.type){case"key":this.keys.push(E(b({},l),{index:this.keys.length,missing:new Map}));break;case"value":if(l.property==null)throw new Error(`AG Charts - internal config error: no properties specified for value definitions: ${JSON.stringify(l)}`);this.values.push(E(b({},l),{index:this.values.length,missing:new Map}));break;case"aggregate":n(l),this.aggregates.push(E(b({},l),{index:this.aggregates.length}));break;case"group-value-processor":n(l),this.groupProcessors.push(E(b({},l),{index:this.groupProcessors.length}));break;case"property-value-processor":this.propertyProcessors.push(E(b({},l),{index:this.propertyProcessors.length}));break;case"reducer":this.reducers.push(E(b({},l),{index:this.reducers.length}));break;case"processor":this.processors.push(E(b({},l),{index:this.processors.length}));break}}if(this.opts.groupByKeys||this.opts.groupByFn!=null){const l=new Set(r.values());if(a.forEach(c=>l.delete(c)),l.size>0)throw new Error(`AG Charts - scopes missing key for grouping, illegal configuration: ${[...l.values()]}`)}}resolveProcessedDataDefById(e,t){var s;const i=(s=this.scopeCache.get(e.id))==null?void 0:s.get(t);if(!i)throw new Error(`AG Charts - didn't find property definition for [${t}, ${e.id}]`);return{index:i.index,def:i}}resolveProcessedDataIndexById(e,t){return this.resolveProcessedDataDefById(e,t).index}resolveKeysById(e,t,i){const s=this.resolveProcessedDataIndexById(e,t),n=i.keys[s];if(n==null)throw new Error(`AG Charts - didn't find keys for [${t}, ${e.id}]`);return n.get(e.id)}hasColumnById(e,t){var i;return((i=this.scopeCache.get(e.id))==null?void 0:i.get(t))!=null}resolveColumnById(e,t,i){var a;const s=this.resolveProcessedDataIndexById(e,t),n=(a=i.columns)==null?void 0:a[s];if(n==null)throw new Error(`AG Charts - didn't find column for [${t}, ${e.id}]`);return n}*forEachDatum(e,t,i){var n;const s=t.columnScopes.findIndex(a=>a.has(e.id));for(const a of(n=i.datumIndices[s])!=null?n:[])yield t.columns[s][a]}*forEachGroupDatum(e,t){var a;const i=t.columnScopes.findIndex(r=>r.has(e.id)),s={groupIndex:0,columnIndex:i},n=[];for(const r of t.groups){s.group=r;let o=0;for(const l of(a=r.datumIndices[i])!=null?a:n)s.datumIndex=l,s.valueIndex=o++,yield s;s.groupIndex++}}*forEachGroupDatumTuple(e,t){const s={columnIndex:t.columnScopes.findIndex(n=>n.has(e.id)),datumIndexes:[void 0,void 0,void 0]};for(const n of this.forEachGroupDatum(e,t))s.group=s.nextGroup,s.groupIndex=s.nextGroupIndex,s.nextGroup=n.group,s.nextGroupIndex=n.groupIndex,s.datumIndexes[0]=s.datumIndexes[1],s.datumIndexes[1]=s.datumIndexes[2],s.datumIndexes[2]=n.datumIndex,s.group!=null&&s.datumIndexes[1]!=null&&(yield s);s.group=s.nextGroup,s.groupIndex=s.nextGroupIndex,s.nextGroup=void 0,s.nextGroupIndex=void 0,s.datumIndexes[0]=s.datumIndexes[1],s.datumIndexes[1]=s.datumIndexes[2],s.datumIndexes[2]=void 0,s.group!=null&&s.datumIndexes[1]!=null&&(yield s)}getDomain(e,t,i,s){var a;const n=this.getDomainsByType(i!=null?i:"value",s);return(a=n==null?void 0:n[this.resolveProcessedDataIndexById(e,t)])!=null?a:[]}getDomainBetweenRange(e,t,[i,s],n){const a=t.map(c=>this.resolveProcessedDataIndexById(e,c)),r=a.join(":"),o=n[RN];let l=o.get(r);if(l==null){const c=a.map(h=>n.columns[h]);l=new Xie(c),o.set(r,l)}return l.rangeBetween(i,s)}getDomainsByType(e,t){switch(e){case"key":return t.domain.keys;case"value":return t.domain.values;case"aggregate":return t.domain.aggValues;case"group-value-processor":return t.domain.groups;default:return null}}processData(e){const{opts:{groupByKeys:t,groupByFn:i},aggregates:s,groupProcessors:n,reducers:a,processors:r,propertyProcessors:o}=this,l=performance.now();if(t&&this.keys.length===0)return;let c=this.extractData(e);t?c=this.groupData(c):i&&(c=this.groupData(c,i(c))),n.length>0&&c.type==="grouped"&&this.postProcessGroups(c),s.length>0&&c.type==="ungrouped"?this.aggregateUngroupedData(c):s.length>0&&c.type==="grouped"&&this.aggregateGroupedData(c),o.length>0&&this.postProcessProperties(c),a.length>0&&this.reduceData(c),r.length>0&&this.postProcessData(c),this.warnDataMissingProperties(e);const h=performance.now();return c.time=h-l,this.debug.check()&&Jie(c),this.processScopeCache(),c}warnDataMissingProperties(e){var t,i;if(e.size!==0)for(const s of ih(this.keys,this.values))for(const[n,a]of s.missing){if(a<((i=(t=e.get(n))==null?void 0:t.length)!=null?i:1/0))continue;const r=n==null?"":` for ${n}`;se.warnOnce(`the key '${s.property}' was not found in any data element${r}.`)}}processScopeCache(){var e;this.scopeCache.clear();for(const t of ih(this.keys,this.values,this.aggregates))if(t.idsMap)for(const[i,s]of t.idsMap)for(const n of s)if(!this.scopeCache.has(i))this.scopeCache.set(i,new Map([[n,t]]));else{if((e=this.scopeCache.get(i))!=null&&e.has(n))throw new Error("duplicate definition ids on the same scope are not allowed.");this.scopeCache.get(i).set(n,t)}}valueGroupIdxLookup({matchGroupIds:e}){const t=[];for(const[i,s]of this.values.entries())(!e||s.groupId&&e.includes(s.groupId))&&t.push(i);return t}valueIdxLookup(e,t){const i=e==null||e.length===0,s=typeof t=="string"?t:t.id,n=r=>{if(r.idsMap){for(const[o,l]of r.idsMap)if(e!=null&&e.includes(o)&&l.has(s))return!0}return!1},a=this.values.reduce((r,o,l)=>((o.scopes==null||i&&!o.scopes.length||o.scopes.some(h=>e==null?void 0:e.includes(h)))&&(o.property===s||o.id===s||n(o))&&r.push(l),r),[]);if(a.length===0)throw new Error(`AG Charts - configuration error, unknown property ${JSON.stringify(t)} in scope(s) ${JSON.stringify(e)}`);return a}extractData(e){const{dataDomain:t,processValue:i,allScopesHaveSameDefs:s}=this.initDataDomainProcessor(),{keys:n,values:a}=this,{invalidData:r,invalidKeys:o,allKeyMappings:l}=this.extractKeys(n,e,i),{columns:c,columnScopes:h,partialValidDataCount:d,maxDataLength:u}=this.extractValues(r,a,e,o,i),p=g=>{const f=t.get(g),y=f.getDomain();return Bl.is(f)&&y[0]>y[1]?[]:y};return{type:"ungrouped",input:{count:u},scopes:new Set(e.keys()),dataSources:e,aggregation:void 0,keys:[...l.values()],columns:c,columnScopes:h,invalidKeys:o,invalidData:r,domain:{keys:n.map(p),values:a.map(p)},defs:{allScopesHaveSameDefs:s,keys:n,values:a},partialValidDataCount:d,time:0,[RN]:new Map}}extractKeys(e,t,i){var c;const s=new Map,n=new Map,a=new Map;let r,o;const l=(h,d)=>{const u=o.get(h);r.set(d,r.get(u)),s.has(u)&&(s.set(d,s.get(u)),n.set(d,n.get(u)))};for(const h of e){const{invalidValue:d,scopes:u}=h;r=new Map,o=new Map,a.set(h,r);for(const p of u!=null?u:[]){const g=(c=t.get(p))!=null?c:[];if(o.has(g)){l(g,p);continue}const f=[];r.set(p,f),o.set(g,p);let y,v;for(let x=0;x<g.length;x++){if(g[x]==null||typeof g[x]!="object")continue;const S=i(h,g[x],x,p);if(S.valid){f.push(S.value);continue}f.push(d),y!=null||(y=yM(g.length,!1)),v!=null||(v=yM(g.length,!1)),y[x]=!0,v[x]=!0}y&&v&&(s.set(p,y),n.set(p,v))}}return{invalidData:n,invalidKeys:s,allKeyMappings:a}}extractValues(e,t,i,s,n){var c;let a=0;const r=[],o=[];let l=0;for(const h of t){const{invalidValue:d}=h;if(new Set(h.scopes.map(v=>i.get(v))).size>1)throw new Error(`AG Charts - more than one data source for: ${JSON.stringify(h)}`);const p=new Set(h.scopes),g=cg(h.scopes),f=i.get(g),y=new Array;for(let v=0;v<f.length;v++){if(f[v]==null||typeof f[v]!="object")continue;const x=f[v],S=(c=s.get(g))==null?void 0:c[v],M=n(h,x,v,h.scopes);let D=M.value;(S||!M.valid)&&this.markScopeDatumInvalid(h.scopes,f,v,e),S?D=d:M.valid||(a+=1,D=d),y[v]=D}r.push(y),o.push(p),l=Math.max(l,y.length)}return{columns:r,columnScopes:o,partialValidDataCount:a,maxDataLength:l}}groupData(e,t){var p,g,f;var i;const s=new Map,{keys:n,columns:a,columnScopes:r,invalidKeys:o,invalidData:l}=e,c=e.scopes,h=new Set;for(const y of c){const v=a.map((w,T)=>T).filter(w=>!h.has(w)&&r[w].has(y));if(v.length===0)continue;for(const w of v)h.add(w);const x=new Set;for(const w of v)for(const T of r[w])x.add(T);const S=n.map(w=>w.get(y)).filter(w=>w!=null),M=a[cg(v)],D=l==null?void 0:l.get(y),A=o==null?void 0:o.get(y);for(let w=0;w<M.length;w++){if((A==null?void 0:A[w])===!0)continue;const T=S.map(L=>L[w]);if(T==null||T.length===0)throw new Error("AG Charts - no keys found for scope: "+y);const k=(p=t==null?void 0:t(T))!=null?p:T,N=Zie(k),O=(g=s.get(N))!=null?g:{keys:k,datumIndices:[],validScopes:c};if(s.has(N)||s.set(N,O),(D==null?void 0:D[w])===!0){O.validScopes===c&&(O.validScopes=new Set(c.values()));for(const L of x)O.validScopes.delete(L)}for(const L of v)(f=(i=O.datumIndices)[L])!=null||(i[L]=[]),O.datumIndices[L].push(w)}}const d=[],u=[];for(const{keys:y,datumIndices:v,validScopes:x}of s.values())d.push(y),u.push({datumIndices:v,keys:y,aggregation:[],validScopes:x});return E(b({},e),{type:"grouped",domain:E(b({},e.domain),{groups:d}),groups:u})}aggregateUngroupedData(e){const t=this.aggregates.map(()=>[1/0,-1/0]);e.domain.aggValues=t;const{keys:i,columns:s,dataSources:n}=e,a=cg(n.keys()),r=n.get(a);e.aggregation=r==null?void 0:r.map((o,l)=>{var h,d,u,p,g,f;const c=[];for(const[y,v]of this.aggregates.entries()){const x=this.valueGroupIdxLookup(v);let S=(d=(h=v.groupAggregateFunction)==null?void 0:h.call(v))!=null?d:[1/0,-1/0];const M=x.map(T=>s[T][l]),D=ev(i,a,l),A=D!=null?v.aggregateFunction(M,D):void 0;A&&(S=(p=(u=v.groupAggregateFunction)==null?void 0:u.call(v,A,S))!=null?p:Bl.extendDomain(A,S));const w=(f=(g=v.finalFunction)==null?void 0:g.call(v,S))!=null?f:S;c[y]=w,Bl.extendDomain(w,t[y])}return c})}aggregateGroupedData(e){var s,n,a,r,o,l,c;const t=this.aggregates.map(()=>[1/0,-1/0]);e.domain.aggValues=t;const{columns:i}=e;for(const[h,d]of this.aggregates.entries()){const u=this.valueGroupIdxLookup(d);for(const p of e.groups){(s=p.aggregation)!=null||(p.aggregation=[]);const g=p.keys;let f=(a=(n=d.groupAggregateFunction)==null?void 0:n.call(d))!=null?a:[1/0,-1/0];const y=Math.max(...u.map(x=>{var S,M;return(M=(S=p.datumIndices[x])==null?void 0:S.length)!=null?M:0}));for(let x=0;x<y;x++){const S=u.map(D=>{var A;return i[D][(A=p.datumIndices[D])==null?void 0:A[x]]}),M=d.aggregateFunction(S,g);M&&(f=(o=(r=d.groupAggregateFunction)==null?void 0:r.call(d,M,f))!=null?o:Bl.extendDomain(M,f))}const v=(c=(l=d.finalFunction)==null?void 0:l.call(d,f))!=null?c:f;p.aggregation[h]=v,Bl.extendDomain(v,t[h])}}}postProcessGroups(e){const{groupProcessors:t}=this,{columnScopes:i,columns:s,invalidData:n}=e;for(const a of t){const r=this.valueGroupIdxLookup(a),o=a.adjust()();for(const l of e.groups)o(s,r,l);for(const l of r){const h=this.values[l].valueType==="category",d=s[l],u=cg(i[l]),p=n==null?void 0:n.get(u),g=h?new EN:new Bl;for(let f=0;f<d.length;f+=1)(p==null?void 0:p[f])!==!0&&g.extend(d[f]);e.domain.values[l]=g.getDomain()}}}postProcessProperties(e){for(const{adjust:t,property:i,scopes:s}of this.propertyProcessors)for(const n of this.valueIdxLookup(s,i))t()(e,n)}reduceData(e){var s,n;(s=e.reduced)!=null||(e.reduced={});const{dataSources:t,keys:i}=e;for(const a of this.reducers){const r=a.reducer();let o=a.initialValue;if(e.type==="grouped")for(const l of e.groups)o=r(o,l.keys);else{const l=cg(t.keys()),c=i.map(u=>u.get(l)).filter(u=>u!=null),h=c.map(()=>{}),d=t.get(l);for(let u=0;u<d.length;u+=1){for(let p=0;p<h.length;p++)h[p]=(n=c[p])==null?void 0:n[u];o=r(o,h)}}e.reduced[a.property]=o}}postProcessData(e){var t;(t=e.reduced)!=null||(e.reduced={});for(const i of this.processors)e.reduced[i.property]=i.calculate(e,e.reduced[i.property])}initDataDomainProcessor(){const{keys:e,values:t}=this,i=new Set;for(const h of t)if(h.scopes)for(const d of h.scopes)i.add(d);const s=new Map,n=new Map;let a=!0;const r=()=>{var h;for(const d of ih(e,t))d.valueType==="category"?s.set(d,new EN):(s.set(d,new Bl),a&&(a=((h=d.scopes)!=null?h:[]).length===i.size))};r();const o=this.buildAccessors(ih(e,t)),l={value:void 0,missing:!1,valid:!1};return{dataDomain:s,processValue:(h,d,u,p)=>{var v,x,S,M;let g,f;if(o.has(h.property)){try{f=o.get(h.property)(d)}catch(D){}g=f!=null}else g=h.property in d,f=g?d[h.property]:h.missingValue;h.forceValue!=null&&(f=g&&c0(f)?-1*h.forceValue:h.forceValue,g=!0),l.missing=!g;const y="missingValue"in h;if(!g&&!y)if(typeof p=="string"){const D=(v=h.missing.get(p))!=null?v:0;h.missing.set(p,D+1)}else for(const D of p){const A=(x=h.missing.get(D))!=null?x:0;h.missing.set(D,A+1)}if(s.has(h)||r(),g&&((S=h.validation)==null?void 0:S.call(h,f,d,u))===!1)if(l.valid=!1,"invalidValue"in h)f=h.invalidValue;else return this.mode!=="integrated"&&se.warnOnce(`invalid value of type [${typeof f}] for [${h.scopes} / ${h.id}] ignored:`,`[${f}]`),l.value=void 0,l;else l.valid=!0;if(h.processor){let D=n.get(h);D==null&&(D=h.processor(),n.set(h,D)),f=D(f,u)}return(M=s.get(h))==null||M.extend(f),l.value=f,l},initDataDomain:r,scopes:i,allScopesHaveSameDefs:a}}buildAccessors(e){const t=new Map;if(this.suppressFieldDotNotation)return t;for(const i of e){if(!(i.property.includes(".")||i.property.includes("[")))continue;const n=NN(i.property);if(n==null){se.warnOnce("Invalid property path [%s]",i.property);continue}const a=Qie(n);t.set(i.property,a)}return t}};function Jie(e){var i,s;const t=(n,a)=>{a.length>0&&(se.log(`DataModel.processData() - ${n}`),se.table(a))};se.log("DataModel.processData() - processedData",e),t("Key Domains",e.domain.keys),t("Group Domains",(i=e.domain.groups)!=null?i:[]),t("Value Domains",e.domain.values),t("Aggregate Domains",(s=e.domain.aggValues)!=null?s:[])}var FN=class pl{constructor(t,i){this.mode=t,this.suppressFieldDotNotation=i,this.debug=ct.create(!0,"data-model"),this.requested=[],this.status="setup"}async request(t,i,s){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");return new Promise((n,a)=>{this.requested.push({id:t,opts:s,data:i,resolve:n,reject:a})})}execute(t){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");this.status="executed",this.debug("DataController.execute() - requested",this.requested);const i=this.validateRequests(this.requested);this.debug("DataController.execute() - validated",i);const s=this.mergeRequested(i);this.debug("DataController.execute() - merged",s),this.debug.check()&&(Ct().processedData=[]);const n=[];for(const{data:a,ids:r,opts:o,resolves:l,rejects:c}of s){const h=t==null?void 0:t.find(p=>Yie(p,a,r,o));let d,u;if(h==null)try{d=new ON(o,this.mode,this.suppressFieldDotNotation);const p=new Map(i.map(g=>[g.id,g.data]));u=d.processData(p)}catch(p){c.forEach(g=>g(p));continue}else({dataModel:d,processedData:u}=h);n.push({opts:o,data:a,ids:r,dataModel:d,processedData:u}),this.debug.check()&&Ct("processedData").push(u),(u==null?void 0:u.partialValidDataCount)===0?l.forEach(p=>p({dataModel:d,processedData:u})):u?this.splitResult(d,u,r,l):c.forEach(p=>p(new Error("AG Charts - no processed data generated")))}return n}validateRequests(t){const i=[];for(const[s,n]of t.entries())s>0&&n.data.length!==t[0].data.length&&n.opts.groupByData===!1&&n.opts.groupByKeys===!1?n.reject(new Error("all series[].data arrays must be of the same length and have matching keys.")):i.push(n);return i}mergeRequested(t){const i=[];for(const s of t){const n=i.find(pl.groupMatch(s));n?n.push(s):i.push([s])}return i.map(pl.mergeRequests)}splitResult(t,i,s,n){for(let a=0;a<s.length;a++){const r=n[a];r({dataModel:t,processedData:i})}}static groupMatch({data:t,opts:i}){function s(c){return c.filter(h=>h.type==="key").map(h=>h.property).join(";")}const{groupByData:n,groupByKeys:a=!1,groupByFn:r,props:o}=i,l=s(o);return([c])=>{var h;return(n===!1||c.data===t)&&((h=c.opts.groupByKeys)!=null?h:!1)===a&&c.opts.groupByFn===r&&s(c.opts.props)===l}}static mergeRequests(t){const i=new Set(["key","group-value-processor"]);return t.reduce((s,h)=>{var{id:n,data:a,resolve:r,reject:o,opts:d}=h,u=d,{props:l}=u,c=We(u,["props"]);var p,g,f,y,v;s.ids.push(n),s.rejects.push(o),s.resolves.push(r),(p=s.data)!=null||(s.data=a),(g=s.opts)!=null||(s.opts=E(b({},c),{props:[]}));for(const x of l){const S=E(b({},x),{scopes:[n],data:a});pl.createIdsMap(n,S);const M=s.opts.props.find(D=>D.type===S.type&&(i.has(D.type)||D.data===S.data)&&pl.deepEqual(D,S));if(!M){s.opts.props.push(S);continue}(f=M.scopes)!=null||(M.scopes=[]),M.scopes.push(...(y=S.scopes)!=null?y:[]),(M.type==="key"||M.type==="value")&&((v=S.idsMap)!=null&&v.size)&&pl.mergeIdsMap(S.idsMap,M.idsMap)}return s},{ids:[],rejects:[],resolves:[],data:null,opts:null})}static mergeIdsMap(t,i){for(const[s,n]of t){const a=i.get(s);if(a==null)i.set(s,new Set(n));else for(const r of n)a.add(r)}}static createIdsMap(t,i){var s;i.id!=null&&((s=i.idsMap)!=null||(i.idsMap=new Map),i.idsMap.has(t)?i.idsMap.get(t).add(i.id):i.idsMap.set(t,new Set([i.id])))}static deepEqual(t,i){if(t===i)return!0;if(t&&i&&typeof t=="object"&&typeof i=="object"){if(t.constructor!==i.constructor)return!1;let s,n;if(Array.isArray(t)){if(n=t.length,n!==i.length)return!1;for(s=n-1;s>=0;s--)if(!pl.deepEqual(t[s],i[s]))return!1;return!0}const a=Object.keys(t);if(n=a.length,n!==Object.keys(i).length)return!1;for(s=n-1;s>=0;s--){const r=a[s];if(!pl.skipKeys.has(r)&&(!Object.hasOwn(i,r)||!pl.deepEqual(t[r],i[r])))return!1}return!0}return!1}};FN.skipKeys=new Set(["id","idsMap","type","scopes","data"]);var BN=FN,ese=class{constructor(){this.axesMap=new Map,this.themeTemplates=new Map}register(e,t){this.axesMap.set(e,t.moduleFactory),t.themeTemplate&&this.setThemeTemplate(e,t.themeTemplate)}create(e,t){const i=this.axesMap.get(e);if(i)return i(t);throw new Error(`AG Charts - unknown axis type: ${e}`)}has(e){return this.axesMap.has(e)}keys(){return this.axesMap.keys()}setThemeTemplate(e,t){return this.themeTemplates.set(e,t),this}getThemeTemplate(e){return this.themeTemplates.get(e)}},ph=new ese,Rg=[{type:"root",optionsKey:"animation",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"]},{type:"root",optionsKey:"annotations",chartTypes:["cartesian"]},{type:"root",optionsKey:"background",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsInnerKey:"image"},{type:"root",optionsKey:"foreground",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsInnerKey:"image"},{type:"root",optionsKey:"chartToolbar",chartTypes:["cartesian"]},{type:"root",optionsKey:"contextMenu",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"]},{type:"root",optionsKey:"statusBar",chartTypes:["cartesian"],identifier:"status-bar"},{type:"root",optionsKey:"dataSource",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"]},{type:"root",optionsKey:"sync",chartTypes:["cartesian"]},{type:"root",optionsKey:"zoom",chartTypes:["cartesian","topology"]},{type:"root",optionsKey:"ranges",chartTypes:["cartesian"]},{type:"legend",optionsKey:"gradientLegend",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],identifier:"gradient"},{type:"root",optionsKey:"navigator",chartTypes:["cartesian"]},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-number"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"bar",community:!0},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"line",community:!0},{type:"axis",optionsKey:"axes[]",chartTypes:["cartesian"],identifier:"ordinal-time"},{type:"axis-option",optionsKey:"crosshair",chartTypes:["cartesian"]},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"box-plot"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"candlestick"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"cone-funnel"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"funnel"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"ohlc"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"heatmap"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-area"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-bar"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"waterfall"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"nightingale"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-area"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-line"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-bar"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-column"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"sunburst"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"treemap"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-marker"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape-background"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line-background"},{type:"series",optionsKey:"series[]",chartTypes:["flow-proportion"],identifier:"chord"},{type:"series",optionsKey:"series[]",chartTypes:["flow-proportion"],identifier:"sankey"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"pyramid"},{type:"series",optionsKey:"series[]",chartTypes:["gauge"],identifier:"linear-gauge"},{type:"series",optionsKey:"series[]",chartTypes:["gauge"],identifier:"radial-gauge"},{type:"series-option",optionsKey:"errorBar",chartTypes:["cartesian"],identifier:"error-bars"},{type:"context",contextKey:"sharedToolbar",chartTypes:["cartesian"]}];function gh(e){var t;return(t=Rg.find(i=>i.type==="series"&&i.identifier===e))==null?void 0:t.chartTypes}function tse(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="cartesian"))==="cartesian"}function ise(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="polar"))==="polar"}function sse(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="hierarchy"))==="hierarchy"}function nse(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="topology"))==="topology"}function ase(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="flow-proportion"))==="flow-proportion"}function rse(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="standalone"))==="standalone"}function ose(e){var i;return((i=gh(e))==null?void 0:i.find(s=>s==="gauge"))==="gauge"}function lse(e){return e.packageType==="enterprise"}function cse(e){var i;if(!lse(e))throw new Error("AG Charts - internal configuration error, only enterprise modules need verification.");const t=Rg.find(s=>s.type===e.type&&("optionsKey"in s&&"optionsKey"in e?s.optionsKey===e.optionsKey:!0)&&("contextKey"in s&&"contextKey"in e?s.contextKey===e.contextKey:!0)&&s.identifier===e.identifier&&e.chartTypes.every(n=>s.chartTypes.includes(n)));return t&&((i=t.useCount)!=null||(t.useCount=0),t.useCount++),t!=null}function hse(){return Rg.filter(({useCount:e})=>e==null||e===0)}var dse=class{constructor(){this.legendMap=new Map,this.themeTemplates=new Map}register(e,{optionsKey:t,moduleFactory:i,themeTemplate:s}){this.legendMap.set(e,{optionsKey:t,moduleFactory:i}),this.themeTemplates.set(t,s)}create(e,t){var s;const i=(s=this.legendMap.get(e))==null?void 0:s.moduleFactory;if(i)return i(t);throw new Error(`AG Charts - unknown legend type: ${e}`)}getThemeTemplates(){return Object.fromEntries(this.themeTemplates)}getKeys(){return Array.from(this.legendMap.entries()).reduce((e,[t,i])=>(e[t]=i.optionsKey,e),{})}},vM=new dse,_N=class extends Map{get(e){var t;return(t=super.get(e))!=null?t:"unknown"}isCartesian(e){return this.get(e)==="cartesian"}isPolar(e){return this.get(e)==="polar"}isHierarchy(e){return this.get(e)==="hierarchy"}isTopology(e){return this.get(e)==="topology"}isFlowProportion(e){return this.get(e)==="flow-proportion"}isStandalone(e){return this.get(e)==="standalone"}isGauge(e){return this.get(e)==="gauge"}get seriesTypes(){return Array.from(this.keys())}get cartesianTypes(){return this.seriesTypes.filter(e=>this.isCartesian(e))}get polarTypes(){return this.seriesTypes.filter(e=>this.isPolar(e))}get hierarchyTypes(){return this.seriesTypes.filter(e=>this.isHierarchy(e))}get topologyTypes(){return this.seriesTypes.filter(e=>this.isTopology(e))}get flowProportionTypes(){return this.seriesTypes.filter(e=>this.isFlowProportion(e))}get standaloneTypes(){return this.seriesTypes.filter(e=>this.isStandalone(e))}get gaugeTypes(){return this.seriesTypes.filter(e=>this.isGauge(e))}},use=class extends Map{set(e,t){return super.set(e,Je(t,this.get(e)))}},qt=new _N,pse=new _N,bM=new use,gse=class{constructor(){this.seriesMap=new Map,this.themeTemplates=new Map}register(e,{chartTypes:[t],moduleFactory:i,tooltipDefaults:s,defaultAxes:n,themeTemplate:a,solo:r,stackable:o,groupable:l,stackedByDefault:c,hidden:h}){this.setThemeTemplate(e,a),this.seriesMap.set(e,{moduleFactory:i,tooltipDefaults:s,defaultAxes:n,solo:r,stackable:o,groupable:l,stackedByDefault:c}),qt.set(e,t),h||pse.set(e,t)}create(e,t){var s;const i=(s=this.seriesMap.get(e))==null?void 0:s.moduleFactory;if(i)return i(t);throw new Error(`AG Charts - unknown series type: ${e}`)}cloneDefaultAxes(e){var i;const t=(i=this.seriesMap.get(e))==null?void 0:i.defaultAxes;return t==null?null:{axes:Bt(t)}}setThemeTemplate(e,t){const i=this.themeTemplates.get(e);this.themeTemplates.set(e,Je(t,i))}getThemeTemplate(e){return this.themeTemplates.get(e)}getTooltipDefauls(e){var t;return(t=this.seriesMap.get(e))==null?void 0:t.tooltipDefaults}isSolo(e){var t,i;return(i=(t=this.seriesMap.get(e))==null?void 0:t.solo)!=null?i:!1}isGroupable(e){var t,i;return(i=(t=this.seriesMap.get(e))==null?void 0:t.groupable)!=null?i:!1}isStackable(e){var t,i;return(i=(t=this.seriesMap.get(e))==null?void 0:t.stackable)!=null?i:!1}isStackedByDefault(e){var t,i;return(i=(t=this.seriesMap.get(e))==null?void 0:t.stackedByDefault)!=null?i:!1}},xa=new gse,xM=class gl extends wo{constructor(t){super(),this.chart=t}subscribe(t=gl.DEFAULT_GROUP){let i=this.get(t);return i||(i={members:new Set},gl.chartsGroups.set(t,i)),i.members.add(this.chart),this}unsubscribe(t=gl.DEFAULT_GROUP){var s,n,a,r,o,l;const i=this.get(t);return i==null||i.members.delete(this.chart),(a=(n=(s=i==null?void 0:i.domains)==null?void 0:s.x)==null?void 0:n.sources)==null||delete a[this.chart.id],(l=(o=(r=i==null?void 0:i.domains)==null?void 0:r.y)==null?void 0:o.sources)==null||delete l[this.chart.id],this}getChart(){return this.chart}getGroupState(t=gl.DEFAULT_GROUP){return this.get(t)}getGroupMembers(t=gl.DEFAULT_GROUP){const i=this.get(t);return i?Array.from(i.members):[]}getGroupSiblings(t=gl.DEFAULT_GROUP){return this.getGroupMembers(t).filter(i=>i!==this.chart)}getGroupSyncMode(t=gl.DEFAULT_GROUP){return this.getGroupMembers(t).some(i=>i.series.length>1)?"multi-series":"single-series"}get(t){return gl.chartsGroups.get(t)}};xM.chartsGroups=new Map,xM.DEFAULT_GROUP=Symbol("sync-group-default");var fse=xM,CM=class extends Be{constructor(){super(...arguments),this.enabled=!1}};I([P],CM.prototype,"enabled",2),I([P],CM.prototype,"tabIndex",2);var GN={};Ua(GN,{NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>Za,fromToMotion:()=>Qt,staticFromToMotion:()=>ko});var Za={added:"add",updated:"update",removed:"remove",unknown:"initial","no-op":"none"};function Qt(e,t,i,s,n,a,r){const{fromFn:o,toFn:l,applyFn:c=(g,f)=>g.setProperties(f)}=n,{nodes:h,selections:d}=Zy(s),u=(g,f)=>{var D;let y,v=0,x=0;for(const A of f){const w=g[v]===A,T={last:x>=f.length-1,lastLive:v>=g.length-1,prev:f[x-1],prevFromProps:y,prevLive:g[v-1],next:f[x+1],nextLive:g[v+(w?1:0)]},k=`${e}_${t}_${A.id}`;i.stopByAnimationId(k);let N="unknown";w?a&&r&&(N=mse(A,A.datum,a,r)):N="removed",A.transitionOut=N==="removed";const S=o(A,A.datum,N,T),{phase:O,start:L,finish:F,delay:B,duration:_}=S,G=We(S,["phase","start","finish","delay","duration"]),M=l(A,A.datum,N,T),{phase:V,start:j,finish:H,delay:U,duration:$}=M,W=We(M,["phase","start","finish","delay","duration"]),Y=F==null;i.animate({id:k,groupId:e,phase:(D=O!=null?O:V)!=null?D:"update",duration:_!=null?_:$,delay:B!=null?B:U,from:G,to:W,ease:Ig,collapsable:Y,onPlay:()=>{const K=b(b(b({},L),j),G);c(A,K,"start")},onUpdate(K){c(A,K,"update")},onStop:()=>{const K=b(b(b(b(b(b({},L),j),G),W),F),H);c(A,K,"end")}}),w&&v++,x++,y=G}};let p=0;for(const g of d){const f=g.nodes(),y=f.filter(v=>!g.isGarbage(v));u(y,f),i.animate({id:`${e}_${t}_selection_${p}`,groupId:e,phase:"end",from:0,to:1,ease:Ig,onStop(){g.cleanup()}}),p++}u(h,h)}function ko(e,t,i,s,n,a,r){const{nodes:o,selections:l}=Zy(s),{start:c,finish:h,phase:d}=r;i.animate({id:`${e}_${t}`,groupId:e,phase:d!=null?d:"update",from:n,to:a,ease:Ig,onPlay:()=>{if(c){for(const u of o)u.setProperties(c);for(const u of l)for(const p of u.nodes())p.setProperties(c)}},onUpdate(u){for(const p of o)p.setProperties(u);for(const p of l)for(const g of p.nodes())g.setProperties(u)},onStop:()=>{for(const u of o)u.setProperties(b(b({},a),h));for(const u of l){for(const p of u.nodes())p.setProperties(b(b({},a),h));u.cleanup()}}})}function mse(e,t,i,s){const n=i(e,t);return s.added.has(n)?"added":s.removed.has(n)?"removed":e.previousDatum==null&&e.datum!=null?"added":e.previousDatum!=null&&e.datum==null?"removed":"updated"}var zN={};Ua(zN,{resetMotion:()=>ns});function ns(e,t){const{nodes:i,selections:s}=Zy(e);for(const n of s){for(const a of n.nodes()){const r=t(a,a.datum);a.setProperties(r)}n.cleanup()}for(const n of i){const a=t(n,n.datum);n.setProperties(a)}}var Pi=class Ld{constructor(t,i,s=!0){this.parentNode=t,this.autoCleanup=s,this.garbageBin=new Set,this._nodesMap=new Map,this._nodes=[],this.data=[],this.debug=ct.create(!0,"scene","scene:selections"),this.nodeFactory=Object.prototype.isPrototypeOf.call(xo,i)?()=>new i:i}static select(t,i,s=!0){return new Ld(t,i,s)}static selectAll(t,i){const s=[],n=a=>{i(a)&&s.push(a);for(const r of a.children())n(r)};return n(t),s}static selectByClass(t,...i){return Ld.selectAll(t,s=>i.some(n=>s instanceof n))}static selectByTag(t,i){return Ld.selectAll(t,s=>s.tag===i)}createNode(t,i,s){const n=this.nodeFactory(t);return n.datum=t,i==null||i(n),s==null?this._nodes.push(n):this._nodes.splice(s,0,n),this.parentNode.appendChild(n),n}update(t,i,s){if(this.garbageBin.size>0&&this.debug("Selection - update() called with pending garbage",t),s){const n=new Map(t.map((a,r)=>[s(a),[a,r]]));for(const[a,r]of this._nodesMap.entries())if(n.has(r)){const[o]=n.get(r);a.datum=o,this.garbageBin.delete(a),n.delete(r)}else this.garbageBin.add(a);for(const[a,[r,o]]of n.entries())this._nodesMap.set(this.createNode(r,i,o),a)}else{const n=Math.max(t.length,this.data.length);for(let a=0;a<n;a++)a>=t.length?this.garbageBin.add(this._nodes[a]):a>=this._nodes.length?this.createNode(t[a],i):(this._nodes[a].datum=t[a],this.garbageBin.delete(this._nodes[a]))}return this.data=t.slice(),this.autoCleanup&&this.cleanup(),this}cleanup(){return this.garbageBin.size===0?this:(this._nodes=this._nodes.filter(t=>this.garbageBin.has(t)?(this._nodesMap.delete(t),this.garbageBin.delete(t),t.destroy(),!1):!0),this)}clear(){return this.update([]),this}isGarbage(t){return this.garbageBin.has(t)}each(t){for(const i of this._nodes.entries())t(i[1],i[1].datum,i[0]);return this}*[Symbol.iterator](){for(let t=0;t<this._nodes.length;t++){const i=this._nodes[t];yield{node:i,datum:i.datum,index:t}}}select(t){return Ld.selectAll(this.parentNode,t)}selectByClass(t){return Ld.selectByClass(this.parentNode,t)}selectByTag(t){return Ld.selectByTag(this.parentNode,t)}nodes(){return this._nodes}at(t){return this._nodes.at(t)}get length(){return this._nodes.length}},Ks=class extends va{constructor(e={}){super(e),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.restoreOwnStyles()}set x(e){this.x1=e,this.x2=e}set y(e){this.y1=e,this.y2=e}get midPoint(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}}computeBBox(){return new ve(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(e,t){return this.x1===this.x2||this.y1===this.y2?this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(e,t):!1}distanceSquared(e,t){const{x1:i,y1:s,x2:n,y2:a}=this;return xg(e,t,i,s,n,a,1/0)}render(e){var o;const{ctx:t,devicePixelRatio:i}=e;let{x1:s,y1:n,x2:a,y2:r}=this;if(s===a){const{strokeWidth:l}=this,c=Math.round(s*i)/i+Math.trunc(l*i)%2/(i*2);s=c,a=c}else if(n===r){const{strokeWidth:l}=this,c=Math.round(n*i)/i+Math.trunc(l*i)%2/(i*2);n=c,r=c}t.beginPath(),t.moveTo(s,n),t.lineTo(a,r),this.fillStroke(t),(o=this.fillShadow)==null||o.markClean(),super.render(e)}toSVG(){if(!this.visible)return;const e=Ti("line");return e.setAttribute("x1",String(this.x1)),e.setAttribute("y1",String(this.y1)),e.setAttribute("x2",String(this.x2)),e.setAttribute("y2",String(this.y2)),this.applySvgStrokeAttributes(e),{elements:[e]}}};Ks.className="Line",Ks.defaultStyles=E(b({},va.defaultStyles),{fill:void 0,strokeWidth:1}),I([he()],Ks.prototype,"x1",2),I([he()],Ks.prototype,"y1",2),I([he()],Ks.prototype,"x2",2),I([he()],Ks.prototype,"y2",2);var SM="color: green",MM="color: grey";function yse(){return OE(()=>{})}function DM(e,t){const i=rh(t);if(i.length===0)return;const s=FE(e);for(const n of i)n in s&&(t[n]=s[n])}var VN=class{transitionRoot(e,t){this.parent?this.parent.transitionRoot(e,t):this.transition(e,t)}},wM=class Hn extends VN{constructor(t,i,s){super(),this.defaultState=t,this.states=i,this.enterEach=s,this.debug=ct.create(!0,"animation"),this.state=t,this.debug(`%c${this.constructor.name} | init -> ${t}`,SM)}transition(t,i){var h,d,u,p;if(!this.transitionChild(t,i)||this.state===Hn.child||this.state===Hn.parent)return;const n=this.state,a=this.states[this.state];let r=a[t];const o=`%c${this.constructor.name} | ${this.state} -> ${t} ->`;if(Array.isArray(r))r=r.find(g=>{if(!g.guard)return!0;const f=g.guard(i);return f||this.debug(`${o} (guarded)`,g.target,MM),f});else if(typeof r=="object"&&!(r instanceof Hn)&&r.guard&&!r.guard(i)){this.debug(`${o} (guarded)`,r.target,MM);return}if(!r){this.debug(`${o} ${this.state}`,MM);return}const l=this.getDestinationState(r),c=l===this.state?void 0:a.onExit;this.debug(`${o} ${l}`,SM),this.state=l,typeof r=="function"?r(i):typeof r=="object"&&!(r instanceof Hn)&&((h=r.action)==null||h.call(r,i)),c==null||c(),(d=this.enterEach)==null||d.call(this,n,l),l!==n&&l!==Hn.child&&l!==Hn.parent&&((p=(u=this.states[l]).onEnter)==null||p.call(u,n,i))}transitionAsync(t,i){setTimeout(()=>{this.transition(t,i)},0)}is(t){return this.state===Hn.child&&this.childState?this.childState.is(t):this.state===t}resetHierarchy(){this.debug(`%c${this.constructor.name} | ${this.state} -> [resetHierarchy] -> ${this.defaultState}`,"color: green"),this.state=this.defaultState}transitionChild(t,i){var s,n;return this.state!==Hn.child||!this.childState||(DM(this,this.childState),this.childState.transition(t,i),!this.childState.is(Hn.parent))?!0:(this.debug(`%c${this.constructor.name} | ${this.state} -> ${t} -> ${this.defaultState}`,SM),this.state=this.defaultState,(n=(s=this.states[this.state]).onEnter)==null||n.call(s),this.childState.resetHierarchy(),!1)}getDestinationState(t){let i=this.state;return typeof t=="string"?i=t:t instanceof Hn?(this.childState=t,this.childState.parent=this,i=Hn.child):typeof t=="object"&&(t.target instanceof Hn?(this.childState=t.target,this.childState.parent=this,i=Hn.child):t.target!=null&&(i=t.target)),i}};wM.child="__child",wM.parent="__parent";var Ng=wM,vse=class extends VN{constructor(...e){super(),this.stateMachines=e;for(const t of e)t.parent=this}transition(e,t){for(const i of this.stateMachines)DM(this,i),i.transition(e,t)}transitionAsync(e,t){for(const i of this.stateMachines)DM(this,i),i.transitionAsync(e,t)}},AM=class{constructor(){this.moduleMap=new Map}*modules(){for(const e of this.moduleMap.values())yield e.moduleInstance}addModule(e,t){if(this.moduleMap.has(e.optionsKey))throw new Error(`AG Charts - module already initialised: ${e.optionsKey}`);this.moduleMap.set(e.optionsKey,{module:e,moduleInstance:t(e)})}removeModule(e){var i;const t=Ji(e)?e:e.optionsKey;(i=this.moduleMap.get(t))==null||i.moduleInstance.destroy(),this.moduleMap.delete(t)}getModule(e){var t;return(t=this.moduleMap.get(Ji(e)?e:e.optionsKey))==null?void 0:t.moduleInstance}isEnabled(e){return this.moduleMap.has(Ji(e)?e:e.optionsKey)}mapModules(e){return Array.from(this.moduleMap.values(),(t,i)=>e(t.moduleInstance,i))}destroy(){var e;for(const t of this.moduleMap.keys())(e=this.moduleMap.get(t))==null||e.moduleInstance.destroy();this.moduleMap.clear()}};function fh(e){return typeof e=="string"?dN[e]:e}function IM(e){return fh(e).unit}function bse(e){return fh(e).step}function TM(e){return fh(e).hierarchy}function vu(e){return fh(e).milliseconds}function tv(e,t,i,s){return fh(e).range(t,i,s)}function jN(e,t){return fh(e).floor(t)}var HN=class Ij extends Xa{constructor(){super(...arguments),this.type="unit-time",this._domain=[],this._bands=void 0}static is(t){return t instanceof Ij}set domain(t){t!==this._domain&&(this._domain=t,this._bands=void 0)}get domain(){return this._domain}get interval(){return this._interval}set interval(t){this._interval!==t&&(this._interval=t,this._bands=void 0)}get bands(){var t;return(t=this._bands)!=null||(this._bands=this.calculateBands(this._domain,[0,1])),this._bands}normalizeDomains(...t){return hM(...t)}convert(t,i){const{domain:s,interval:n}=this;if(s.length<2)return NaN;if(n!=null){const a=t.valueOf(),[r,o]=this.calculateBandRange(s,n),l=Math.min(r.valueOf(),o.valueOf()),c=Math.max(r.valueOf(),o.valueOf());if(a<l||a>=c+vu(n))return NaN}return super.convert(t,i)}calculateBandRange(t,i){const s=jN(i,t[0]),n=jN(i,t[1]);return[s,n]}calculateBands(t,i,s=!1){if(t===this.domain&&i[0]===0&&i[1]===1&&!s&&this._bands!=null)return this._bands;if(t.length<2)return[];const{interval:n}=this;if(n==null)return[];const[a,r]=this.calculateBandRange(t,n);return tv(n,a,r,{visibleRange:i,extend:s})}ticks({interval:t},i=this.domain,s=[0,1],n=!1){var x,S,M,D;if(i.length<2)return;const a=this.calculateBands(i,s,n),r=this.interval?vu(this.interval):1/0;if(t==null)return{ticks:a,count:void 0};const o=Math.min(i[0].valueOf(),i[1].valueOf()),l=Math.max(i[0].valueOf(),i[1].valueOf()),c=[];let h,d,u;t instanceof ji?(h=t.range(i[0],i[1],{extend:!0,visibleRange:s}),d=0,u=h.length-1):(h=a,d=(x=kl(0,a.length-1,A=>a[A].valueOf()<=o))!=null?x:0,u=(S=kl(0,a.length-1,A=>a[A].valueOf()<=l))!=null?S:a.length-1);let p;for(let A=d;A<=u;A++){const w=h[A].valueOf(),T=kl(0,a.length-1,N=>a[N].valueOf()<=w),k=T!=null&&T!=p?a[T]:void 0;p=T,k!=null&&w-k.getTime()<=r&&c.push(k)}let g,f;if(this.interval){const A=this.calculateBandRange([new Date(o),new Date(l)],this.interval);g=A[0].valueOf(),f=A[1].valueOf()}else g=o,f=l;let y=(M=hg(0,c.length-1,A=>c[A].valueOf()>=g))!=null?M:0,v=(D=kl(0,c.length-1,A=>c[A].valueOf()<=f))!=null?D:c.length-1;return n&&(y=Math.max(y-1,0),v=Math.min(v+1,c.length-1)),{ticks:c.slice(y,v+1),count:c.length}}findIndex(t){const{bands:i}=this,s=t.valueOf();return kl(0,i.length-1,n=>i[n].valueOf()<=s)}datumFormatter(t){const i=this.tickFormatter(t,1);return s=>{const n=this.findIndex(s);return n!=null?i(this.bands[n]):i(s)}}};HN.defaultTickCount=12;var Xn=HN;function iv(e,t){return e.valueOf()-t.valueOf()}function xse(e){let t=NaN;const i=[];for(const s of e){const n=s.valueOf();t!==n&&i.push(s),t=n}return i}function kM(e){const t=e.slice().sort(iv);return LM(t)==null?xse(t):t}function LM(e){if(e.length===0)return 1;const t=Number(e[e.length-1])>Number(e[0])?1:-1;let i=-1/0*t;for(const s of e){const n=s.valueOf();if(Math.sign(n-i)!==t)return;i=n}return t}var ri=(e,t,i)=>({duration:t*i,timeInterval:e,step:i}),PM=[ri(pu,Fl,1),ri(pu,Fl,5),ri(pu,Fl,15),ri(pu,Fl,30),ri(gu,Ms,1),ri(gu,Ms,5),ri(gu,Ms,15),ri(gu,Ms,30),ri(fu,un,1),ri(fu,un,3),ri(fu,un,6),ri(fu,un,12),ri(To,ba,1),ri(To,ba,2),ri(Or,Io,1),ri(Or,Io,2),ri(Or,Io,3),ri(Ya,kg,1),ri(Ya,kg,2),ri(Ya,kg,3),ri(Ya,kg,4),ri(Ya,kg,6),ri(dh,uu,1)],WN=[1,2,5,10];function UN(e,t){return Math.abs(Math.round(e)-e)<t}function KN(e,t,i){return Math.abs(t-e)>=i?Math.abs(t-e)/i+1:1}function Og(e,t,i,s,n,a){if(e===t)return{ticks:[e],count:1};if(i<2)return{ticks:[e,t],count:2};const r=Fg(e,t,i,s,n);if(!Number.isFinite(r))return{ticks:[],count:0};let o=e,l=t;if(UN(o/r,1e-12)||(o=Math.ceil(o/r)*r),UN(l/r,1e-12)||(l=Math.floor(l/r)*r),a!=null){const h=l-o,d=t-e,u=e+d*a[0],p=e+d*a[1];a=[(u-o)/h,(p-o)/h]}const{ticks:c}=sv(o,l,r,a);return{ticks:c,count:KN(e,t,r)}}var Cse=Math.floor(2*Or.milliseconds/Ya.milliseconds*10)/10;function $N({timeInterval:e,step:t}){var s,n;return e.milliseconds*t<=((n=(s=e.hierarchy)==null?void 0:s.milliseconds)!=null?n:1/0)*Cse}function EM(e,t,i,s,n,{weekStart:a,primaryOnly:r=!1,targetInterval:o}){var p;if(i<=0)return;const l=o!=null?o:Math.abs(t-e)/Math.max(i,1),c=PM.findLast(g=>(!r||$N(g))&&l>g.duration),h=PM.find(g=>(!r||$N(g))&&l<=g.duration);if(c==null){const g=Math.max(Fg(e,t,i,s,n),1);return uN.every(g)}else if(h==null){const g=o==null?Fg(e/uu,t/uu,i,s,n):1;return dh.every(g)}const{timeInterval:d,step:u}=l-c.duration<h.duration-l?c:h;return d===Or?(p=a==null?void 0:a.every(u))!=null?p:To.every(7*u):d.every(u)}function Fg(e,t,i,s=0,n=1/0){if(e===t)return we(1,s,n);if(i<1)return NaN;const a=Math.abs(t-e),r=10**Math.floor(Math.log10(a/i));let o=NaN,l=1/0,c=!1;for(const h of WN){const d=Math.ceil(a/(h*r)),u=d>=s&&d<=n;if(c&&!u)continue;const p=Math.abs(d-i);(l>p||c!==u)&&(c||(c=u),l=p,o=h)}return o*r}function YN(e){for(let t=e.length-1;t>=0;t-=1)if(e[t]!=="0")return t+1;return 0}function XN(e,t){const i=wE(t!=null?t:",f");(i.precision==null||isNaN(i.precision))&&(!i.type||"eEFgGnprs".includes(i.type)?i.precision=Math.max(...e.map(n=>{if(!Number.isFinite(n))return 0;const[a,r]=n.toExponential((i.type?6:12)-1).split(/[.e]/g);return(a!=="1"&&a!=="-1"?1:0)+YN(r)+1})):"f%".includes(i.type)&&(i.precision=Math.max(...e.map(n=>{if(!Number.isFinite(n)||n===0)return 0;const a=Math.floor(Math.log10(Math.abs(n))),r=i.type?6:12,o=n.toExponential(r-1).split(/[.e]/g)[1],l=YN(o);return Math.max(0,l-a)}))));const s=AE(i);return n=>s(Number(n))}function sv(e,t,i,s){if(!Number.isFinite(i)||i<=0)return{ticks:[],count:0};if(e===t)return{ticks:[e],count:1};const n=10**Ud(i),a=Math.min(e,t),r=Math.max(e,t);let o,l;if(s!=null&&(s[0]!==0||s[1]!==1)){const h=t-e,d=e+h*s[0],u=t-h*(1-s[1]);o=Math.min(d,u),l=Math.max(d,u)}else o=a,l=r;o=Math.floor(o*n)/n,l=Math.ceil(l*n)/n;const c=[];for(let h=0;;h+=1){const d=Math.round((a+i*h)*n)/n;if(d>r)break;d>=o&&d<=l&&c.push(d)}return{ticks:c,count:KN(a,r,i)}}function bu(e,t){return e>=t?(se.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}function ZN(e,t){const i=Math.abs(t-e),s=10**Math.floor(Math.log10(i));let n=1/0,a=[e,t];for(const r of WN){const o=r*s,l=Math.floor(e/o)*o,c=Math.ceil(t/o)*o,h=1-i/Math.abs(c-l);n>h&&(n=h,a=[l,c])}return a}function qN(e,t,i,s,n,a){if(e<=0)return{minTickCount:0,maxTickCount:0,tickCount:0};a=Math.max(a,e/(n+1)),i!=null||(i=a),s!=null||(s=e),i>s&&(i===a?i=s:s=i);const r=Math.max(1,Math.floor(e/(t*i))),o=Math.min(r,Math.ceil(e/(t*s))),l=we(o,Math.floor(n/t),r);return{minTickCount:o,maxTickCount:r,tickCount:l}}var Bg=class Tj extends Mt{constructor(){super([],[0,1]),this.type="time"}static is(t){return t instanceof Tj}toDomain(t){return new Date(t)}convert(t,i){return t instanceof Date||(t=new Date(t)),super.convert(t,i)}invert(t){return new Date(super.invert(t))}niceDomain(t,i=this.domain){if(i.length<2)return[];let[s,n]=i;const a=4,r=this.getPixelRange();for(let o=0;o<a;o++){const[l,c]=Sse(s,n,t,r);if(Us(s)===Us(l)&&Us(n)===Us(c))break;s=l,n=c}return[s,n]}ticks(t,i=this.domain,s=[0,1],n=!1){var p;const{nice:a,interval:r,tickCount:o=Mt.defaultTickCount,minTickCount:l,maxTickCount:c}=t;if(i.length<2)return;const h=i.map(Us),d=h[0],u=h[h.length-1];if(r!=null){const g=this.getPixelRange();return{ticks:(p=RM({start:d,stop:u,interval:r,availableRange:g,visibleRange:s,extend:n}))!=null?p:QN({start:d,stop:u,tickCount:o,minTickCount:l,maxTickCount:c,visibleRange:s,extend:n}),count:void 0}}else{if(a&&o===2)return{ticks:i,count:void 0};if(a&&o===1)return{ticks:i.slice(0,1),count:void 0}}return{ticks:QN({start:d,stop:u,tickCount:o,minTickCount:l,maxTickCount:c,visibleRange:s,extend:n}),count:void 0}}_tickFormatter({domain:t,ticks:i,specifier:s},n){return s!=null?Lg(s):pM(i,t,n)}tickFormatter(t){return this._tickFormatter(t)}datumFormatter(t){return this._tickFormatter(t,1)}};function QN({start:e,stop:t,tickCount:i,minTickCount:s,maxTickCount:n,visibleRange:a,extend:r}){const o=EM(e,t,i,s,n,{weekStart:Or});return o?o.range(new Date(e),new Date(t),{visibleRange:a,extend:r}):[]}function RM({start:e,stop:t,interval:i,availableRange:s,visibleRange:n,extend:a}){if(!i)return[];if(i instanceof ji||typeof i=="string"){const d=tv(i,new Date(e),new Date(t),{visibleRange:n,extend:a});return bu(d.length,s)?void 0:d}const r=Math.abs(i);if(bu(Math.abs(t-e)/r,s))return;const o=PM.findLast(d=>r%d.duration===0);if(o)return o.timeInterval.every(r/(o.duration/o.step)).range(new Date(e),new Date(t),{visibleRange:n,extend:a});let l=new Date(Math.min(e,t));const c=new Date(Math.max(e,t)),h=[];for(;l<=c;)h.push(l),l=new Date(l),l.setMilliseconds(l.getMilliseconds()+r);return h}function Sse(e,t,i,s){var d;const{interval:n}=i,a=Math.min(Us(e),Us(t)),r=Math.max(Us(e),Us(t));let o;if(n instanceof ji)o=n;else if(typeof n=="string")o=n;else{let u;typeof n=="number"&&(u=(r-a)/Math.max(n,1),bu(u,s)&&(u=void 0)),u!=null||(u=(d=i.tickCount)!=null?d:Mt.defaultTickCount),o=EM(a,r,u,i.minTickCount,i.maxTickCount,{weekStart:Or})}if(o==null)return[e,t];const l=tv(o,new Date(a),new Date(r),{extend:!0});if(l==null||l.length<2)return[e,t];const c=l[0],h=l[l.length-1];return e<=t?[c,h]:[h,c]}var nv=class kj extends Xa{constructor(){super(...arguments),this.type="ordinal-time",this._domain=[],this.isReversed=!1}static is(t){return t instanceof kj}set domain(t){t!==this._domain&&(this.invalid=!0,this._domain=t,this._bands=void 0,this.isReversed=t.length>0&&t[0]>t[t.length-1],this.sortedTimestamps=void 0,this.precomputedSteps=void 0)}get domain(){return this._domain}get bands(){var t;return(t=this._bands)!=null||(this._bands=this.isReversed?this.domain.slice().reverse():this.domain),this._bands}normalizeDomains(...t){const i=t.filter(s=>s.length>0);if(i.length===0)return{domain:[],animatable:!1};if(i.length===1){let s=i[0];const n=LM(s);return n===-1?s=s.slice().reverse():n==null&&(s=kM(s.slice())),{domain:s,animatable:!0}}return{domain:kM(i.flat()),animatable:!0}}ticks({interval:t,maxTickCount:i},s=this.domain,n=[0,1],a=!1){var g;if(!s.length)return;this.refresh();const{isReversed:r}=this;if(t==null)return{ticks:JN(s,i,r,n,a),count:void 0};const o=s[0].valueOf(),l=s[s.length-1].valueOf(),[c,h]=this.range,d=Math.abs(h-c);let u=(g=RM({start:o,stop:l,interval:t,availableRange:d,visibleRange:n,extend:a}))!=null?g:JN(s,i,r,n,a),p=-1;return u=u.filter(f=>{const y=this.findInterval(f.valueOf()),v=y===p;return p=y,!v}),{ticks:u,count:void 0}}getSortedTimestamps(){let{sortedTimestamps:t}=this;return t==null&&(t!=null||(t=this.bands.map(Us)),this.sortedTimestamps=t),t}getPrecomputedSteps(){const{domain:t}=this;let{precomputedSteps:i}=this;const s=t.length<1e4?t.length:Math.ceil(t.length/16);if(i!=null||s<=1)return i;const n=this.getSortedTimestamps();i=new Int32Array(s);const a=n[0],o=n[n.length-1]-a,l=0,c=n.length-1;for(let h=0;h<i.length;h+=1)i[h]=this.findIntervalInRange(a+h/s*o,l,c);this.precomputedSteps=i}findIntervalInRange(t,i,s){const n=this.getSortedTimestamps();for(;i<=s;){const a=(i+s)/2|0;if(n[a]===t)return a;n[a]<t?i=a+1:s=a-1}return i}findInterval(t){const i=this.getPrecomputedSteps();let s,n;if(i==null)s=0,n=this.domain.length-1;else{const a=this.getSortedTimestamps(),r=a[0],o=a[a.length-1],l=Math.min((t-r)/(o-r)*i.length|0,i.length-1|0);s=i[l],n=l<i.length-2?i[l+1]:a.length-1}return this.findIntervalInRange(t,s,n)}datumFormatter(t){return this.tickFormatter(t)}findIndex(t){const i=this.getSortedTimestamps(),s=Number(t);if(!(s<i[0]))return this.findInterval(s)}};function JN(e,t,i,s,n){const a=[],r=Math.ceil(e.length/t),o=Math.floor(r/2);let l=Math.floor(s[0]*e.length),c=Math.ceil(s[1]*e.length);n&&(l>r&&(l-=r),c<e.length-r&&(c+=r));for(let h=l;h<c;h+=1){const d=i?e.length-1-h:h;(r<=0||(d+o)%r===0)&&a.push(e[h])}return a}var qa=class extends va{constructor(e={}){super(e),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.startLine=!1,this.endLine=!1,this.horizontal=!1,this.restoreOwnStyles()}computeBBox(){return new ve(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1)}isPointInPath(e,t){return!1}render(e){var g;const{ctx:t}=e;let{x1:i,y1:s,x2:n,y2:a}=this;i=this.align(i),s=this.align(s),n=this.align(n),a=this.align(a);const{fill:r,horizontal:o}=this,{globalAlpha:l}=t;r!=null&&(this.applyFillAndAlpha(t),t.beginPath(),t.moveTo(i,s),t.lineTo(n,s),t.lineTo(n,a),t.lineTo(i,a),t.closePath(),t.fill(),t.globalAlpha=l);const{stroke:c,strokeWidth:h,startLine:d,endLine:u}=this;if(!!((d||u)&&c&&h)){const{lineDash:f,lineDashOffset:y,lineCap:v,lineJoin:x}=this;this.applyStrokeAndAlpha(t),t.lineWidth=h,f&&t.setLineDash([...f]),y&&(t.lineDashOffset=y),v&&(t.lineCap=v),x&&(t.lineJoin=x),t.beginPath(),d&&(t.moveTo(i,s),o?t.lineTo(i,a):t.lineTo(n,s)),u&&(t.moveTo(n,a),o?t.lineTo(n,s):t.lineTo(i,a)),t.stroke(),t.globalAlpha=l}(g=this.fillShadow)==null||g.markClean(),super.render(e)}};qa.className="Range",qa.defaultStyles=E(b({},va.defaultStyles),{strokeWidth:1}),I([he()],qa.prototype,"x1",2),I([he()],qa.prototype,"y1",2),I([he()],qa.prototype,"x2",2),I([he()],qa.prototype,"y2",2),I([he()],qa.prototype,"startLine",2),I([he()],qa.prototype,"endLine",2),I([he()],qa.prototype,"horizontal",2);function Mse(e){return e!=null&&Object.hasOwn(e,"toString")&&Ji(e.toString())}function Dse(e){return e!=null&&Object.hasOwn(e,"valueOf")&&Xe(e.valueOf())}function av(e){return Xe(e)||Vd(e)||Dse(e)}function wse(e,t){return e!=null&&(!t||av(e))}function NM(e){return Mse(e)&&Object.hasOwn(e,"id")?e.id:e}function e1(e){switch(e.type){case"line":return e.value;case"range":return e.range}}function t1(e,t){if(e==null)return!1;const i=Mt.is(t)||Xa.is(t),s=n=>wse(n,i)&&!isNaN(t.convert(n));if(Ke(e)){const[n,a]=e;return s(n)&&s(a)}else return s(e)}var Ase={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:1},"top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:-1},"bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},Ise={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:-1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:-1,labelV:-1},"inside-top-right":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},Tse={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},kse={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:-1,labelV:-1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},Ca=class extends Be{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};I([P],Ca.prototype,"enabled",2),I([P],Ca.prototype,"text",2),I([P],Ca.prototype,"fontStyle",2),I([P],Ca.prototype,"fontWeight",2),I([P],Ca.prototype,"fontSize",2),I([P],Ca.prototype,"fontFamily",2),I([P],Ca.prototype,"padding",2),I([P],Ca.prototype,"color",2),I([P],Ca.prototype,"position",2),I([P],Ca.prototype,"rotation",2),I([P],Ca.prototype,"parallel",2);var pn=class extends Be{constructor(){super(),this.id=Hs(this),this.defaultColorRange=[],this.fill="#c16068",this.label=new Ca,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.position="top",this.rangeGroup=new Ge({name:this.id}),this.lineGroup=new Ge({name:this.id}),this.labelGroup=new Ge({name:this.id}),this.crossLineRange=new qa,this.crossLineLabel=new nu,this.data=void 0,this.startLine=!1,this.endLine=!1,this._isRange=void 0,this.lineGroup.append(this.crossLineRange),this.labelGroup.append(this.crossLineLabel),this.crossLineRange.pointerEvents=1}get defaultLabelPosition(){return"top"}update(e){const{enabled:t,type:i,data:s,scale:n}=this;if(!n||!t||!e||!t1(e1(this),n)||s==null){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updateNodes();const a=i==="range";a!==this._isRange&&(a?this.rangeGroup.appendChild(this.crossLineRange):this.lineGroup.appendChild(this.crossLineRange)),this._isRange=a}calculateLayout(e,t){var y,v;if(this.data=void 0,!e)return;const{type:i,range:s,value:n,scale:a,clippedRange:r,strokeWidth:o=0}=this;if(!a)return;const l=(y=a.bandwidth)!=null?y:0,c=(v=a.step)!=null?v:0,h=(t?-1:1)*(a instanceof Pg?(c-l)/2:0);let d,u,p,g;if(i==="line"){const x=l/2;d=a.convert(n)+x,u=NaN,p=a.convert(n,{clamp:!0})+x,g=NaN}else if(s){const[x,S]=s,M=(x==null?void 0:x.valueOf())===(S==null?void 0:S.valueOf())&&nv.is(a)?l/2+h:0;d=a.convert(x)+M,u=a.convert(S)+l,p=a.convert(x,{clamp:!0})+M-h,g=a.convert(S,{clamp:!0})+l+h}else return;p=cM(p,r),g=cM(g,r);const f=(d===p||u===g||p!==g)&&Math.abs(g-p)>0;f&&p>g&&([p,g]=[g,p],[d,u]=[u,d]),d-h>=p&&(d-=h),u+h<=g&&(u+=h),this.startLine=o>0&&d>=p&&d<=p+h,this.endLine=o>0&&u>=g-l-h&&u<=g,!(i==="range"&&!f&&!this.startLine&&!this.endLine)&&(this.data=[p,g],this.label.enabled===!1||this.label.text)}updateNodes(){const{position:e,data:[t,i]=[0,0],gridLength:s}=this,n=Number.isFinite(i)?i-t:0;let a;switch(e){case"top":case"bottom":a=new ve(t,e==="top"?0:-s,n,s);break;case"left":case"right":a=new ve(e==="left"?0:-s,t,s,n)}this.updateRangeNode(a);const{label:r}=this;r.enabled!==!1&&r.text&&(this.updateLabel(),this.positionLabel(a))}updateRangeNode(e){const{type:t,position:i,crossLineRange:s,startLine:n,endLine:a,fill:r,fillOpacity:o,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d}=this;s.x1=e.x,s.x2=e.x+e.width,s.y1=e.y,s.y2=e.y+e.height,s.horizontal=i==="top"||i==="bottom",s.startLine=n,s.endLine=a,s.fill=t==="range"?r:void 0,s.fillOpacity=o!=null?o:1,s.stroke=l,s.strokeWidth=c!=null?c:1,s.strokeOpacity=h!=null?h:1,s.lineDash=d}updateLabel(){const{crossLineLabel:e,label:t}=this;t.text&&(e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.fontSize=t.fontSize,e.fontFamily=t.fontFamily,e.fill=t.color,e.text=t.text)}get anchor(){const e=this.position==="left"||this.position==="right",t=this.type==="range",{position:i=this.defaultLabelPosition}=this.label;return t?(e?Tse:kse)[i]:(e?Ase:Ise)[i]}positionLabel(e){var d;const{crossLineLabel:t,label:i,anchor:s}=this;t.rotation=Vi((d=i.rotation)!=null?d:0),t.textBaseline="middle",t.textAlign="center";const n=t.getBBox();if(!n)return;const{width:a,height:r}=n,o=i.padding+a/2,l=i.padding+r/2,c=e.x+e.width*(s.rangeH+1)/2-o*s.labelH,h=e.y+e.height*(s.rangeV+1)/2-l*s.labelV;t.x=c,t.y=h,t.rotationCenterX=c,t.rotationCenterY=h}computeLabelSize(){var a;const{label:e}=this;if(e.enabled===!1||!e.text)return;const t=new nu;t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=e.text,t.rotation=Vi((a=e.rotation)!=null?a:0),t.textBaseline="middle",t.textAlign="center";const i=t.getBBox();if(!i)return;const{width:s,height:n}=i;return{width:s,height:n}}calculatePadding(e){var c,h,d,u;const{label:t,anchor:i}=this,s=this.computeLabelSize();if(!s)return;const{width:n,height:a}=s,r=t.padding+n,o=t.padding+a,l=this.position==="left"||this.position==="right";l&&(i.rangeH===-1&&i.labelH===1?e.left=Math.max((c=e.left)!=null?c:0,r):i.rangeH===1&&i.labelH===-1&&(e.right=Math.max((h=e.right)!=null?h:0,r))),l||(i.rangeV===-1&&i.labelV===1?e.top=Math.max((d=e.top)!=null?d:0,o):i.rangeV===1&&i.labelV===-1&&(e.bottom=Math.max((u=e.bottom)!=null?u:0,o)))}};pn.className="CrossLine",I([P],pn.prototype,"enabled",2),I([P],pn.prototype,"type",2),I([P],pn.prototype,"range",2),I([P],pn.prototype,"value",2),I([P],pn.prototype,"defaultColorRange",2),I([P],pn.prototype,"fill",2),I([P],pn.prototype,"fillOpacity",2),I([P],pn.prototype,"stroke",2),I([P],pn.prototype,"strokeWidth",2),I([P],pn.prototype,"strokeOpacity",2),I([P],pn.prototype,"lineDash",2),I([P],pn.prototype,"label",2);var as=class extends Be{constructor(){super(...arguments),this.enabled=!0}getFont(){return _t.toFontString(this)}};I([P],as.prototype,"enabled",2),I([P],as.prototype,"color",2),I([P],as.prototype,"fontStyle",2),I([P],as.prototype,"fontWeight",2),I([P],as.prototype,"fontSize",2),I([P],as.prototype,"fontFamily",2),I([P],as.prototype,"formatter",2);function Lse(e,t,i=0,s=0){const n=Co(e),a=!n&&s>=0&&s<=Math.PI?-1:1,r=!n&&i>=0&&i<=Math.PI?-1:1;let o=0;return t?o=a*Math.PI/2:r===-1&&(o=Math.PI),{configuredRotation:n,defaultRotation:o,parallelFlipFlag:a,regularFlipFlag:r}}function Pse(e,t){return e!=null?e:t?0:10}function Ese(e,t,i,s,n){if(e&&!t){const a=n?"hanging":"top";return i*s===-1?a:"bottom"}return"middle"}function i1(e,t,i,s,n){const a=t>0&&t<=Math.PI,r=i>0&&i<=Math.PI,o=a||r?-1:1;if(e)if(t||i){if(s*o===-1)return"end"}else return"center";else if(s*n===-1)return"end";return"start"}function _g(e,t){if(e!=null){if(typeof e=="string")return e;if(Lt(e)&&t!=null)return e[IM(t)]}}function Rse(e,t,i,s,n,a,r){var x;const o=(x=_g(t.format,a))!=null?x:typeof t.format=="string"?t.format:void 0,l={domain:s,ticks:n,fractionDigits:0,specifier:o},c=e.tickFormatter(l),h=a?TM(a):void 0,d=_g(i==null?void 0:i.format,h),u=d?e.tickFormatter(E(b({},l),{specifier:d})):c,p=new Date(s[0]),g=new Date(s[s.length-1]),f=h==null?void 0:h.range(new Date(s[0]),new Date(s[s.length-1]),{extend:!0});let y=0,v=0;if(c!=null){let S,M;f!=null&&f.length>1?(S=f[0],M=f[1]):(S=p,M=g);const D=tv(a,S,M,{limit:50});for(const A of D){const w=c(A),{width:T,height:k}=r.measureLines(w);y=Math.max(y,T),v=Math.max(v,k)}}if(u!=null&&f!=null)for(const S of f){const M=u(S),{width:D,height:A}=r.measureLines(M);y=Math.max(y,D),v=Math.max(v,A)}return{width:Math.ceil(y),height:Math.ceil(v)}}function Nse(e,t,i,s){const n=[];for(const{tickLabel:a,translationY:r}of e){if(!a)continue;const{x:o,y:l}=i.transformBBox(new ve(t,r,0,0)),{width:c,height:h}=s.measureLines(a);n.push({point:{x:o,y:l},label:{text:a,width:c,height:h}})}return n}function Ose({width:e,height:t,spacing:i},s,n){const a=[];for(const r of[0,i]){const{x:o,y:l}=n.transformBBox(new ve(s,r,0,0));a.push({point:{x:o,y:l},label:{text:void 0,width:e,height:t}})}return a}var rv=class{constructor(){this.enabled=!0,this.width=1,this.style=[{stroke:void 0,lineDash:[]}]}};I([P],rv.prototype,"enabled",2),I([P],rv.prototype,"width",2),I([P],rv.prototype,"style",2);var mh=class extends Be{};I([P],mh.prototype,"step",2),I([P],mh.prototype,"values",2),I([P],mh.prototype,"minSpacing",2),I([P],mh.prototype,"maxSpacing",2);var Hi=class extends Be{constructor(){super(...arguments),this.enabled=!0,this.spacing=5,this.color="#575757",this.avoidCollisions=!0,this.mirrored=!1,this.parallel=!1}getSideFlag(){return this.mirrored?1:-1}getFont(){return _t.toFontString(this)}};I([P],Hi.prototype,"enabled",2),I([P],Hi.prototype,"fontStyle",2),I([P],Hi.prototype,"fontWeight",2),I([P],Hi.prototype,"fontSize",2),I([P],Hi.prototype,"fontFamily",2),I([P],Hi.prototype,"spacing",2),I([P],Hi.prototype,"minSpacing",2),I([P],Hi.prototype,"color",2),I([P],Hi.prototype,"rotation",2),I([P],Hi.prototype,"avoidCollisions",2),I([P],Hi.prototype,"mirrored",2),I([P],Hi.prototype,"parallel",2),I([P],Hi.prototype,"itemStyler",2),I([P],Hi.prototype,"formatter",2),I([P],Hi.prototype,"format",2);var ov=class{constructor(){this.enabled=!0,this.width=1,this.stroke=void 0}};I([P],ov.prototype,"enabled",2),I([P],ov.prototype,"width",2),I([P],ov.prototype,"stroke",2);var yh=class extends Be{constructor(){super(...arguments),this.enabled=!0,this.width=1,this.size=6}};I([P],yh.prototype,"enabled",2),I([P],yh.prototype,"width",2),I([P],yh.prototype,"size",2),I([P],yh.prototype,"stroke",2);var Qa=class extends Be{constructor(){super(...arguments),this.caption=new Ht,this.enabled=!1,this.spacing=Ht.SMALL_PADDING,this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always"}};I([P],Qa.prototype,"enabled",2),I([P],Qa.prototype,"text",2),I([P],Qa.prototype,"spacing",2),I([P],Qa.prototype,"fontStyle",2),I([P],Qa.prototype,"fontWeight",2),I([P],Qa.prototype,"fontSize",2),I([P],Qa.prototype,"fontFamily",2),I([P],Qa.prototype,"color",2),I([P],Qa.prototype,"wrapping",2),I([P],Qa.prototype,"formatter",2);var s1=(e=>(e[e.TickAndDomain=0]="TickAndDomain",e[e.TicksOnly=1]="TicksOnly",e[e.Off=2]="Off",e))(s1||{});function n1(e){const[t,i]=ss(e.range),s=Math.floor(t),n=Math.ceil(i);return{min:s,max:n,visible:s!==n}}var OM=Math.PI*2,Fse=OM/2;function Bse(e,t){return Math.abs(t-e)<Fse?t:e>t?t+OM:t-OM}function a1(e){const{min:t,max:i}=e,s=l=>l<t||l>i;return{tick:{fromFn(l,c,h){let{x1:d,x2:u,y1:p,y2:g}=l,f=l.opacity;return(h==="added"||s(c.offset))&&({x1:d,x2:u,y1:p,y2:g}=c,f=0),{x1:d,x2:u,y1:p,y2:g,opacity:f,phase:Za[h]}},toFn(l,c,h){const{x1:d,x2:u,y1:p,y2:g}=c;let f=1;return h==="removed"&&(f=0),{x1:d,x2:u,y1:p,y2:g,opacity:f}},applyFn(l,c){l.setProperties(c),l.visible=!s(l.y)}},line:{fromFn(l,c){var g;const{x1:h,x2:d,y1:u,y2:p}=(g=l.previousDatum)!=null?g:c;return{x1:h,x2:d,y1:u,y2:p,phase:Za.updated}},toFn(l,c){const{x1:h,x2:d,y1:u,y2:p}=c;return{x1:h,x2:d,y1:u,y2:p}}},label:{fromFn(l,c,h){var x;const d=(x=l.previousDatum)!=null?x:c;let{x:u,y:p,rotationCenterX:g,rotationCenterY:f,rotation:y}=d,v=l.opacity;return h==="removed"||s(d.y)?y=c.rotation:(h==="added"||s(l.datum.y))&&({x:u,y:p,rotationCenterX:g,rotationCenterY:f,rotation:y}=c,v=0),{x:u,y:p,rotationCenterX:g,rotationCenterY:f,rotation:y,opacity:v,phase:Za[h]}},toFn(l,c,h){var v,x;const{x:d,y:u,rotationCenterX:p,rotationCenterY:g}=c;let f=0,y=1;return h==="added"?f=c.rotation:h==="removed"?(y=0,f=c.rotation):f=Bse((x=(v=l.previousDatum)==null?void 0:v.rotation)!=null?x:c.rotation,c.rotation),{x:d,y:u,rotationCenterX:p,rotationCenterY:g,rotation:f,opacity:y,finish:{rotation:c.rotation}}}},group:{fromFn(l,c){const{translationX:h,translationY:d}=l;return{translationX:h,translationY:d,phase:Za.updated}},toFn(l,c){const{translationX:h,translationY:d}=c;return{translationX:h,translationY:d}}}}}function r1(){return(e,t)=>({translationX:t.translationX,translationY:t.translationY})}function lv(){return(e,t)=>({x:t.x,y:t.y,rotationCenterX:t.rotationCenterX,rotationCenterY:t.rotationCenterY,rotation:t.rotation})}function FM(){return(e,t)=>{const{x1:i,x2:s,y1:n,y2:a}=t;return{x1:i,x2:s,y1:n,y2:a}}}var _se={millisecond:"%Y %b %e %H:%M:%S.%L",second:"%Y %b %e %H:%M:%S",minute:"%Y %b %e %H:%M",hour:"%Y %b %e %H:%M",day:"%Y %b %e",month:"%Y %b",year:"%Y"},_l={year:0,month:1,day:2,hour:3,minute:4,second:5,millisecond:6},Gse=/%[-_0]?L/,zse=/%[-_0]?S/,Vse=/%[-_0]?M/,jse=/%[-_0]?[HI]/,Hse=/^%[-_0]?[de]$/,Wse=/^%[-_0]?[Bbm]$/,Use=/^%[-_0]?[Yy]$/;function Kse(e,t){if(!Lt(e))return e;const i=IM(t),{millisecond:s,second:n,minute:a,hour:r,day:o,month:l,year:c}=e,h=_l[i],d=_se[i];if(h>=_l.year&&!Use.test(c)||h>=_l.month&&!Wse.test(l)||h>=_l.day&&!Hse.test(o))return d;let u;switch(i){case"year":return c;case"month":return`${l} ${c}`;case"day":return`${l} ${o} ${c}`;case"hour":u=r;break;case"minute":u=a;break;case"second":u=n;break;case"millisecond":u=s;break;default:return d}return h>=_l.hour&&!jse.test(u)||h>=_l.minute&&!Vse.test(u)||h>=_l.second&&!zse.test(u)||h>=_l.millisecond&&!Gse.test(u)?d:`${u} ${l} ${o} ${c}`}var $se=class extends hh(Ks){},o1=(e=>(e[e.TickLines=0]="TickLines",e[e.AxisLine=1]="AxisLine",e[e.TickLabels=2]="TickLabels",e))(o1||{}),Lo=class Lj{constructor(t,i){this.moduleCtx=t,this.scale=i,this.id=Hs(this),this.nice=!0,this.reverse=!1,this.keys=[],this.interval=new mh,this.dataDomain={domain:[],clipped:!1},this.layoutConstraints={stacked:!0,align:"start",width:100,unit:"percent"},this.boundSeries=[],this.includeInvisibleDomains=!1,this.interactionEnabled=!0,this.axisGroup=new Ge({name:`${this.id}-axis`}),this.tickLineGroup=this.axisGroup.appendChild(new iu({name:`${this.id}-Axis-tick-lines`,zIndex:0})),this.tickLabelGroup=this.axisGroup.appendChild(new iu({name:`${this.id}-Axis-tick-labels`,zIndex:2})),this.labelGroup=new Ge({name:`${this.id}-Labels`,zIndex:9}),this.gridGroup=new ds({name:`${this.id}-Axis-grid`,zIndex:1}),this.gridLineGroup=this.gridGroup.appendChild(new Ge({name:`${this.id}-gridLines`})),this.crossLineRangeGroup=new iu({name:`${this.id}-CrossLines-Range`,zIndex:4}),this.crossLineLineGroup=new iu({name:`${this.id}-CrossLines-Line`,zIndex:8}),this.crossLineLabelGroup=new iu({name:`${this.id}-CrossLines-Label`,zIndex:13}),this.tickLabelGroupSelection=Pi.select(this.tickLabelGroup,nu,!1),this._crossLines=[],this.line=new ov,this.tick=new yh,this.gridLine=new rv,this.label=this.createLabel(),this.defaultTickMinSpacing=Lj.defaultTickMinSpacing,this.translation={x:0,y:0},this.layout={label:{fractionDigits:0,spacing:this.label.spacing,format:this.label.format}},this.axisContext=void 0,this.labelFormatter=void 0,this.datumFormatter=void 0,this.scaleFormatterParams=void 0,this.destroyFns=[],this.range=[0,1],this.visibleRange=[0,1],this.title=new Qa,this.gridLength=0,this.gridPadding=0,this.seriesAreaPadding=0,this.animatable=!0,this._cachedUnzoomedInputDomain=void 0,this._cachedUnzoomedRangeExtent=NaN,this._cachedUnzoomedTickCount=0,this.moduleMap=new AM,this.range=this.scale.range.slice(),this.crossLines.forEach(s=>this.initCrossLine(s))}get type(){var t;return(t=this.constructor.type)!=null?t:""}get labelNodes(){return this.tickLabelGroupSelection.nodes()}set crossLines(t){const{CrossLineConstructor:i}=this.constructor;this._crossLines.forEach(s=>this.detachCrossLine(s)),this._crossLines=t.map(s=>{const n=new i;return n.set(s),n}),this._crossLines.forEach(s=>{this.attachCrossLine(s),this.initCrossLine(s)})}get crossLines(){return this._crossLines}resetAnimation(t){}attachCrossLine(t){this.crossLineRangeGroup.appendChild(t.rangeGroup),this.crossLineLineGroup.appendChild(t.lineGroup),this.crossLineLabelGroup.appendChild(t.labelGroup)}detachCrossLine(t){this.crossLineRangeGroup.removeChild(t.rangeGroup),this.crossLineLineGroup.removeChild(t.lineGroup),this.crossLineLabelGroup.removeChild(t.labelGroup)}destroy(){this.moduleMap.destroy(),this.destroyFns.forEach(t=>t())}updateScale(){const{range:t,visibleRange:i,scale:s}=this,n=(t[1]-t[0])/(i[1]-i[0]),a=n*i[0],r=t[0]-a;s.range=[r,r+n],this.crossLines.forEach(o=>{o.clippedRange=[t[0],t[1]]})}setCrossLinesVisible(t){this.crossLineRangeGroup.visible=t,this.crossLineLineGroup.visible=t,this.crossLineLabelGroup.visible=t}attachAxis(t){t.gridNode.appendChild(this.gridGroup),t.axisNode.appendChild(this.axisGroup),t.labelNode.appendChild(this.labelGroup),t.crossLineRangeNode.appendChild(this.crossLineRangeGroup),t.crossLineLineNode.appendChild(this.crossLineLineGroup),t.crossLineLabelNode.appendChild(this.crossLineLabelGroup)}detachAxis(t){t.gridNode.removeChild(this.gridGroup),t.axisNode.removeChild(this.axisGroup),t.labelNode.removeChild(this.labelGroup),t.crossLineRangeNode.removeChild(this.crossLineRangeGroup),t.crossLineLineNode.removeChild(this.crossLineLineGroup),t.crossLineLabelNode.removeChild(this.crossLineLabelGroup)}attachLabel(t){this.labelGroup.append(t)}inRange(t,i=0){const[s,n]=ss(this.range);return t>=s-i&&t<=n+i}getRangeOverflow(t){const{range:i,visibleRange:s}=this,n=(i[1]-i[0])/(s[1]-s[0]),[a,r]=ss([i[0]-n*s[0],i[0]-n*s[0]+n]);return t<a?t-a:t>r?t-r:0}defaultDatumFormatter(t,i){return Ao(t,i+1)}defaultLabelFormatter(t,i){return Ao(t,i)}onGridLengthChange(t,i){i^t&&this.onGridVisibilityChange(),this.crossLines.forEach(s=>this.initCrossLine(s))}onGridVisibilityChange(){}createLabel(){return new Hi}update(){this.updatePosition(),this.updateSelections(),this.tickLineGroup.visible=this.tick.enabled,this.gridLineGroup.visible=this.gridLine.enabled,this.tickLabelGroup.visible=this.label.enabled,this.updateLabels(),this.updateCrossLines()}getLabelStyles(t,i,s=this.label){const n={color:s.color,spacing:s.spacing,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight};let a;s.itemStyler&&(a=this.callWithContext(s.itemStyler,b(b({},t),n)));const{color:r,fontFamily:o,fontSize:l,fontStyle:c,fontWeight:h,spacing:d}=Je(a,i,n);return{fill:r,fontFamily:o,fontSize:l,fontStyle:c,fontWeight:h,spacing:d}}getTickSize(t=this.tick){return t.enabled?t.size:0}processData(){const{includeInvisibleDomains:t,boundSeries:i,direction:s}=this,a=(t?i:i.filter(r=>r.isEnabled())).map(r=>r.getDomain(s));this.setDomains(...a)}setDomains(...t){let i,s;t.length>0?{domain:i,animatable:s}=this.scale.normalizeDomains(...t):(i=[],s=!0),this.dataDomain=this.normaliseDataDomain(i),this.reverse&&this.dataDomain.domain.reverse(),this.animatable=s}calculateLayout(t,i){var D,A,w;const{scale:s,label:n,visibleRange:a,nice:r}=this;this.chartPadding=i,this.updateScale();const o=du(this.range),l=this.dataDomain.domain;let c,h;if(a[0]===0&&a[1]===1)c=void 0,h=void 0;else if(this._cachedUnzoomedInputDomain===l&&this._cachedUnzoomedRangeExtent===o)c=this.scale.domain,h=this._cachedUnzoomedTickCount;else{const T=this.calculateTickLayout(l,r?0:2,[0,1]);c=T.niceDomain,h=(D=T.rawTickCount)!=null?D:0}let d;r?c==null?d=0:d=1:d=2;const{niceDomain:u,ticks:p,rawTickCount:g=0,tickDomain:f,fractionDigits:y,bbox:v}=this.calculateTickLayout(c!=null?c:l,d,a,t);h!=null||(h=g);const x=g!==0&&h!==0?{zoomed:g,unzoomed:h}:void 0,S=Xn.is(s)?s.interval:void 0;this.scale.domain=u,this._cachedUnzoomedInputDomain=l,this._cachedUnzoomedRangeExtent=o,this._cachedUnzoomedTickCount=h;const M=_g(S==null?n.format:Kse(n.format,S),S);return this.labelFormatter=(A=s.tickFormatter({domain:f,specifier:M,ticks:p,fractionDigits:y}))!=null?A:T=>this.defaultLabelFormatter(T,y),this.datumFormatter=(w=s.datumFormatter({domain:f,specifier:M,ticks:p,fractionDigits:y}))!=null?w:T=>this.defaultDatumFormatter(T,y),this.scaleFormatterParams={domain:f,ticks:p,fractionDigits:y},this.layout.label={fractionDigits:y,spacing:this.label.spacing,format:this.label.format},this.layoutCrossLines(),{primaryTickCount:x,bbox:v}}updateCrossLines(){const t=this.isAnySeriesActive();this.crossLines.forEach(i=>{i.update(t)})}updatePosition(){const{crossLineRangeGroup:t,crossLineLineGroup:i,crossLineLabelGroup:s,gridGroup:n,translation:a}=this,r=Math.floor(a.x),o=Math.floor(a.y);n.setProperties({translationX:r,translationY:o}),t.setProperties({translationX:r,translationY:o}),i.setProperties({translationX:r,translationY:o}),s.setProperties({translationX:r,translationY:o})}formatTick(t,i,s,n,a,r){const{labelFormatter:o,label:{formatter:l}}=this;let c;if(l){const h=this.getFormatterBoundSeries(),d=a?IM(a):void 0,u=a?bse(a):void 0;c=this.callWithContext(l,{value:t,index:i,domain:s,fractionDigits:n,unit:d,step:u,boundSeries:h})}else r?c=r(t):o&&(c=o(t));return String(c!=null?c:t)}formatDatum(t){const{label:{formatter:i},datumFormatter:s=this.labelFormatter}=this;let n;if(i){const{domain:a}=this.scale,r=this.getFormatterBoundSeries();n=this.callWithContext(i,{value:t,index:NaN,domain:a,boundSeries:r})}else s?n=this.callWithContext(s,t):Ke(t)&&(n=t.filter(Boolean).join(" - "));return String(n!=null?n:t)}getScaleValueFormatter(t){const{scaleFormatterParams:i}=this;let s;try{t!=null&&i!=null&&(s=this.scale.tickFormatter(E(b({},i),{specifier:t})))}catch(n){se.warnOnce(`the format string ${t} is invalid, ignoring.`)}return s!=null||(s=n=>this.formatDatum(n)),s}getBBox(){return this.axisGroup.getBBox()}initCrossLine(t){t.scale=this.scale,t.gridLength=this.gridLength}isAnySeriesActive(){return this.boundSeries.some(t=>this.includeInvisibleDomains||t.isEnabled())}clipTickLines(t,i,s,n){this.tickLineGroup.setClipRect(new ve(t,i,s,n))}clipGrid(t,i,s,n){this.gridGroup.setClipRect(new ve(t,i,s,n))}getFormatterBoundSeries(){const{direction:t}=this,i=[];for(const s of this.boundSeries){const n=s.getKeys(t),a=s.getNames(t);for(let r=0;r<n.length;r++)i.push({key:n[r],name:a[r]})}return i}getTitleFormatterParams(t){var n;const{direction:i}=this,s=this.getFormatterBoundSeries();return{domain:t,direction:i,boundSeries:s,defaultValue:(n=this.title)==null?void 0:n.text}}normaliseDataDomain(t){return{domain:[...t],clipped:!1}}getLayoutState(){return b({id:this.id,rect:this.getBBox(),gridPadding:this.gridPadding,seriesAreaPadding:this.seriesAreaPadding,tickSize:this.getTickSize(),direction:this.direction,domain:this.dataDomain.domain,scale:this.scale},this.layout)}getModuleMap(){return this.moduleMap}createModuleContext(){var t;return(t=this.axisContext)!=null||(this.axisContext=this.createAxisContext()),E(b({},this.moduleCtx),{parent:this.axisContext})}createAxisContext(){const{scale:t}=this;return{axisId:this.id,scale:this.scale,direction:this.direction,continuous:Mt.is(t)||Xa.is(t),getCanvasBounds:()=>ai.toCanvas(this.axisGroup),seriesKeyProperties:()=>this.boundSeries.reduce((i,s)=>(s.getKeyProperties(this.direction).forEach(a=>i.add(a)),i),new Set),seriesIds:()=>this.boundSeries.map(i=>i.id),scaleValueFormatter:i=>this.getScaleValueFormatter(i),scaleInvert:i=>t.invert(i,!0),scaleInvertNearest:i=>t.invert(i,!0),attachLabel:i=>this.attachLabel(i),inRange:(i,s)=>this.inRange(i,s),getRangeOverflow:i=>this.getRangeOverflow(i)}}isReversed(){return this.reverse}callWithContext(t,...i){const{callbackCache:s,chartService:n}=this.moduleCtx;return s.call(this,n,t,...i)}};Lo.defaultTickMinSpacing=50,Lo.CrossLineConstructor=pn,I([P],Lo.prototype,"nice",2),I([P],Lo.prototype,"reverse",2),I([P],Lo.prototype,"keys",2),I([P],Lo.prototype,"interval",2),I([P],Lo.prototype,"title",2),I([Rl((e,t,i)=>e.onGridLengthChange(t,i))],Lo.prototype,"gridLength",2);var BM=Lo;function Yse(e,t,i,s,n){let[a,r]=ss(t.map(Number));const o=Math.floor(i.unzoomed);if(o<=1){const[v,x]=Xse(a,r),S=5*Math.pow(2,-Math.ceil(Math.log2(n[1]-n[0]))),{ticks:M}=Og(v,x,S,void 0,void 0,n),D=[e.toDomain(v),e.toDomain(x)];return s&&D.reverse(),{domain:D,ticks:M}}if(a===r){const v=Math.floor(Math.log10(a)),x=Math.pow(10,v),S=Math.min(x,1),M=o-1;a-=S*Math.floor(M/2),r=a+S*M}let l=a,c=r;l=Zse(l,c,o);const h=Qse(l,c,o),d=o-1;c=l+d*h;const u=Math.floor(l/h)*h,p=Math.floor(c/h)*h;u<=a&&p>=r&&(l=u,c=p);const g=[e.toDomain(l),e.toDomain(c)];s&&g.reverse();const f=h*((i.unzoomed-1)/(i.zoomed-1)),y=qse(l,f,Math.floor(i.zoomed));return{domain:g,ticks:y}}function Xse(e,t){let i=e,s=t,n=0;do{[i,s]=ZN(i,s);const{ticks:a}=Og(i,s,5);if(a.length%2===1)return[i,s];i-=1,s+=1}while(n++<10);return[e,t]}function Zse(e,t,i){e=Math.floor(e);const s=Math.abs(t-e)/(i-1),n=Math.floor(Math.log10(s)),a=Math.pow(10,n);return Math.floor(e/a)*a}function qse(e,t,i){const s=Ud(t),n=Math.pow(10,s),a=[];for(let r=0;r<i;r++){const o=e+t*r;a.push(Math.round(o*n)/n)}return a}function Qse(e,t,i){const s=i-1,n=(t-e)/s;return Jse(n)}function Jse(e){const t=Math.floor(Math.log10(e)),i=Math.pow(10,t),s=e/i;return s>0&&s<=1?i:s>1&&s<=2?2*i:s>2&&s<=5?5*i:s>5&&s<=10?10*i:e}function _M(){const e=new Map;return t=>{const i=e.get(t);return i?(e.set(t,i+1),`${t}_${i}`):(e.set(t,1),t)}}function ene(e){if(e.length<2)return 1/0;let t=0,i=e[0].translationY;for(let s=1;s<e.length;s++){const n=e[s].translationY,a=Math.abs(n-i);t=Math.max(t,a),i=n}return t}var l1=class{constructor(e){this.axis=e}estimateTickCount(e,t,i){const{scale:s,range:n,defaultTickMinSpacing:a}=this.axis,r=Xn.is(s)?Xn.defaultTickCount:Mt.defaultTickCount;return qN(du(n),du(e),t,i,r,a)}filterTicks(e,t){const{minSpacing:i,maxSpacing:s}=this.axis.interval,a=i!=null||s!=null?Math.ceil(e.length/t):2,r=e.length%a?-1:0;return e.filter((o,l)=>(l+r)%a===0)}generateTicks({domain:e,primaryTickCount:t,visibleRange:i,niceMode:s,parallelFlipRotation:n,regularFlipRotation:a,labelX:r,sideFlag:o,removeOverflowLabels:l,removeOverflowThreshold:c=0}){const{scale:h,label:d,primaryLabel:u,interval:{minSpacing:p,maxSpacing:g}}=this.axis,{parallel:f,fontFamily:y,fontSize:v,fontStyle:x,fontWeight:S}=d,M=t!==void 0,{defaultRotation:D,configuredRotation:A,parallelFlipFlag:w,regularFlipFlag:T}=Lse(d.rotation,f,a,n),{maxTickCount:k}=this.estimateTickCount(i,p,g),O=!(Mt.is(h)||Xa.is(h))||isNaN(k)?10:k;let L=i1(f,A,0,o,T);const F=Ese(f,A,o,w,u==null),B=_t.toFontString({fontFamily:y,fontSize:v,fontStyle:x,fontWeight:S}),_=Rr.getMeasurer({font:B}),G={fontFamily:y,fontSize:v,fontStyle:x,fontWeight:S,textBaseline:F,textAlign:L},V=d.enabled&&d.avoidCollisions,j=A+D,H=new So,U=le=>{const de=j+le;So.updateTransformMatrix(H,1,1,de,0,0)},$=({ticks:le},de)=>(U(de),Nse(le,r,H,_)),W=(le,de)=>{const{niceDomain:ue,ticks:ie,rawTicks:re,timeInterval:te}=le;if(te==null)return[];U(de);const fe=ene(ie),{width:me,height:Le}=Rse(h,d,u,ue!=null?ue:e,re,te,_);return Ose({width:me,height:Le,spacing:fe},r,H)},Y=(le,de)=>{if(!V)return!1;const ue=A!==0||de!==0,ie=Pse(d.minSpacing,ue);return kN(W(le,de),ie)||kN($(le,de),ie)};let K={tickDomain:[],ticks:[],rawTicks:[],rawTickCount:void 0,timeInterval:void 0,fractionDigits:0,niceDomain:void 0},Q=0,Z=0,J=!0,ae=!1;for(;!ae&&J&&Q<=O;){Z=0;for(const le of this.getTickStrategies({domain:e,niceMode:s,secondaryAxis:M,index:Q}))({tickData:K,index:Q,autoRotation:Z,terminate:ae}=le({index:Q,tickData:K,textProps:G,terminate:ae,primaryTickCount:t,visibleRange:i,labelsOverlap(){return Y(K,Z)}}));J=Y(K,Z)}L=i1(f,A,Z,o,T);const oe=A+Z;if(l&&K.ticks.length>2){const le=$(K,Z),de=K.ticks.at(-1),ue=le.at(-1);if(de!=null&&ue!=null&&de.translationY+ue.label.width/2>this.axis.range[1]+c){de.tickLabel=void 0;const ie=K.ticks[0];ie.translationY===0&&i[0]===0&&i[1]===1&&(ie.tickLabel=void 0)}}return{tickData:K,rotation:oe,textBaseline:F,textAlign:L}}getTickStrategies({domain:e,niceMode:t,index:i,secondaryAxis:s}){const{scale:n,label:a,interval:r}=this.axis,{minSpacing:o}=r,l=Mt.is(n)||Xa.is(n),c=a.enabled&&a.avoidCollisions,h=!l&&i!==0&&c,d=a.autoRotate===!0&&a.rotation===void 0,u=[];let p;r.values?p=3:s?p=1:h?p=2:p=0;const g=({index:f,tickData:y,primaryTickCount:v,visibleRange:x,terminate:S})=>this.createTickData(e,t,x,v,p,f,y,S);if(u.push(g),!l&&o!=null){const f=({index:y,tickData:v,primaryTickCount:x,visibleRange:S,terminate:M})=>this.createTickData(e,t,S,x,2,y,v,M);u.push(f)}if(c&&d){const f=({index:y,tickData:v,labelsOverlap:x,terminate:S})=>({index:y,tickData:v,autoRotation:x()?Co(a.autoRotateAngle):0,terminate:S});u.push(f)}return u}ticksEqual(e,t){var i,s;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(((i=e[n])==null?void 0:i.valueOf())!==((s=t[n])==null?void 0:s.valueOf()))return!1;return!0}createTickData(e,t,i,s,n,a,r,o){const{scale:l,interval:c}=this.axis,{step:h,values:d,minSpacing:u,maxSpacing:p}=c,{maxTickCount:g,minTickCount:f,tickCount:y}=this.estimateTickCount(i,u,p),v=Mt.is(l)||Xa.is(l),x=!v||isNaN(g)?10:g,S=w=>v?Math.max(y-w,f):g,M=r.rawTicks,D=h==null&&d==null&&S(a)>f&&(v||n===2),A={domain:e,niceMode:t,visibleRange:i,primaryTickCount:s,tickGenerationType:n,previousTicks:M,minTickCount:f,maxTickCount:g,tickCount:0};if(A.tickCount=S(a),r=this.getTicks(A),D&&this.ticksEqual(r.rawTicks,M)){let w=a,T=x;for(;w<=T;)a=(w+T)/2|0,A.tickCount=S(a),r=this.getTicks(A),this.ticksEqual(r.rawTicks,M)?w=a+1:T=a-1}return a+=1,o||(o=h!=null||d!=null),{tickData:r,index:a,autoRotation:0,terminate:o}}getTimeIntervalTicks(e,t,i){var f,y,v,x;const s=TM(i);if(s==null)return;const{scale:n,reverse:a}=this.axis;if(!Bg.is(n)&&!Xa.is(n))return;a&&(e=[1-e[1],1-e[0]]);const r=Math.min(n.domain[0].valueOf(),n.domain[n.domain.length-1].valueOf()),o=Math.max(n.domain[0].valueOf(),n.domain[n.domain.length-1].valueOf());let[l,c]=ji.extent(new Date(r),new Date(o),e);l=s.floor(l),l.valueOf()>=r&&(l=s.previous(l)),c=s.ceil(c),c.valueOf()<=o&&(c=s.next(c));const h=s.range(l,c),d=vu(i),u=Xn.is(n)&&n.interval!=null&&vu(n.interval)<d;let p,g=new Set;if(Bg.is(n)||Xn.is(n)){p=[];const S=E(b({},t),{interval:i}),M=!Xn.is(n)||u;for(let D=0;D<h.length-1;D+=1){const A=h[D],w=h[D+1],T=D===h.length-2,k=w.valueOf()-A.valueOf(),N=[Math.max((r-A.valueOf())/k,0),Math.min((o-A.valueOf())/k,1)],O=M?this.timeScaleTicks(S,[A,w],N,!0):(y=(f=n.ticks(S,[A,w],N,!0))==null?void 0:f.ticks)!=null?y:[];if(zQ(O,_=>_.valueOf()<A.valueOf()),T||VQ(O,_=>M?_.valueOf()+d>w.valueOf():_.valueOf()>=w.valueOf()),O.length===0)continue;const L=O[0],F=iv(L,A);(M?F===0:F<=d)&&g.add(p.length),p.push(...O)}}else if(nv.is(n)){p=(x=(v=n.ticks(t,void 0,e,!0))==null?void 0:v.ticks)!=null?x:[];let S=0;for(let M=0;M<p.length;M++){const D=p[M];let A=!1;for(;S<h.length&&iv(h[S],D)<=0;)A=!0,S++;A&&g.add(M)}}else p=[];return(g.size===0||g.size===1&&g.has(0))&&(g=void 0),{ticks:p,tickCount:void 0,primaryTicksIndices:g,interpolate:u}}timeScaleTicks(e,t,i,s){const{interval:n}=e;if(n==null)return t;const a=t[0].valueOf(),r=t[1].valueOf();if(typeof n!="number")return fh(n).every(1,{snapTo:t[0]}).range(t[0],t[1],{visibleRange:i,extend:s});const o=[];for(let l=a;l<=r;l+=n){const c=new Date(l);o.push(c)}return o}getTicks({domain:e,niceMode:t,visibleRange:i,tickGenerationType:s,previousTicks:n,tickCount:a,minTickCount:r,maxTickCount:o,primaryTickCount:l}){var H,U,$,W,Y,K,Q;const{axis:c}=this,{label:h,primaryLabel:d,range:u,scale:p,interval:g}=c,f=_M(),y={nice:t===0,interval:g.step,tickCount:a,minTickCount:r,maxTickCount:o},v=E(b({},y),{nice:t===0||t===1});let x;s===1&&l!=null&&Mt.is(p)&&(x=Yse(p,e,l,c.reverse,i));const S=t===0?(H=x==null?void 0:x.domain)!=null?H:p.niceDomain(y,e):e;let M=S,D,A,w,T,k=!1;const N=p.domain;switch(p.domain=S,s){case 3:if(M=g.values,D=g.values,A=D.length,k=Xn.is(p),Mt.is(p)){const[Z,J]=ss(S.map(Number));D=D.filter(ae=>Number(ae)>=Z&&Number(ae)<=J).sort((ae,oe)=>Number(ae)-Number(oe))}break;case 1:if(x)D=x.ticks,A=x.ticks.length;else{const Z=p.ticks(v,S,i);D=(U=Z==null?void 0:Z.ticks)!=null?U:[],A=Z==null?void 0:Z.count}break;case 2:D=this.filterTicks(n,a),A=void 0;break;default:{if(S.length>0&&v.interval==null&&(Xn.is(p)||d!=null&&(Bg.is(p)||nv.is(p)))){const ae=S,oe=Math.min(ae[0].valueOf(),ae[ae.length-1].valueOf()),le=Math.max(ae[0].valueOf(),ae[ae.length-1].valueOf());w=EM(oe,le,a,r,o,{weekStart:d==null?Or:void 0,primaryOnly:Xn.is(p)})}const Z=Xn.is(p)?p.interval:void 0;Z!=null&&w!=null&&vu(Z)>vu(w)&&(w=Z);const J=w?this.getTimeIntervalTicks(i,v,w):void 0;if(J)({ticks:D,tickCount:A,primaryTicksIndices:T,interpolate:k}=J);else{const ae=Xn.is(p)&&w!=null?E(b({},v),{interval:($=v.interval)!=null?$:w}):v,oe=p.ticks(ae,S,i);D=(W=oe==null?void 0:oe.ticks)!=null?W:[],A=oe==null?void 0:oe.count}}}const O=D.reduce((Z,J)=>Math.max(Z,typeof J=="number"?Ud(J):0),0),L=(Y=_g(h.format,w))!=null?Y:typeof h.format=="string"?h.format:void 0,F={domain:M,ticks:D,fractionDigits:O,specifier:L},B=p.tickFormatter(F),_=_g(d==null?void 0:d.format,w?TM(w):void 0),G=_?p.tickFormatter(E(b({},F),{specifier:_})):B,V=((K=p.bandwidth)!=null?K:0)/2,j=[];for(let Z=0;Z<D.length;Z++){const J=D[Z],ae=p.convert(J,{interpolate:k})+V,oe=(Q=T==null?void 0:T.has(Z))!=null?Q:!1;if(u.length>0&&!c.inRange(ae,.001))continue;const le=oe&&(d==null?void 0:d.enabled)===!0?G:B,de=h.enabled?c.formatTick(J,Z,S,O,w,le):"";j.push({tick:J,tickId:f(de),tickLabel:de,translationY:Math.floor(ae),primary:oe})}return p.domain=N,{tickDomain:M,rawTicks:D,rawTickCount:A,fractionDigits:O,timeInterval:w,ticks:j,niceDomain:S}}},GM=class extends Hi{constructor(){super(...arguments),this.autoRotateAngle=335}};I([P],GM.prototype,"autoRotate",2),I([P],GM.prototype,"autoRotateAngle",2);var zM=class Pj extends BM{constructor(t,i){super(t,i),this.headingLabelGroup=this.axisGroup.appendChild(new ds({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new ds({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new Ks({zIndex:1})),this.tickLineGroupSelection=Pi.select(this.tickLineGroup,Ks,!1),this.gridLineGroupSelection=Pi.select(this.gridLineGroup,Ks,!1),this.tempText=new nu({debugDirty:!1}),this.tempCaption=new Ht,this.tickGenerator=new l1(this),this.generatedTicks=void 0,this.animationManager=t.animationManager,this.animationState=new Ng("empty",{empty:{update:{target:"ready",action:()=>this.resetSelectionNodes()},reset:"empty"},ready:{update:n=>this.animateReadyUpdate(n),resize:()=>this.resetSelectionNodes(),reset:"empty"}}),this.headingLabelGroup.appendChild(this.title.caption.node);let s;this.destroyFns.push(t.layoutManager.addListener("layout:complete",n=>{const a=[n.chart.width,n.chart.height];s!=null&&!fa(a,s)&&this.animationState.transition("resize"),s=a}),this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}static is(t){return t instanceof Pj}get primaryLabel(){}get primaryTick(){}get horizontal(){return this.position==="top"||this.position==="bottom"}onGridVisibilityChange(){this.gridLineGroupSelection.clear()}resetAnimation(t){t==="initial"&&this.animationState.transition("reset")}get direction(){return this.position==="top"||this.position==="bottom"?"x":"y"}createAxisContext(){return E(b({},super.createAxisContext()),{position:this.position})}createLabel(){return new GM}updateDirection(){switch(this.position){case"top":this.label.mirrored=!0,this.label.parallel=!0;break;case"right":this.label.mirrored=!0,this.label.parallel=!1;break;case"bottom":this.label.mirrored=!1,this.label.parallel=!0;break;case"left":this.label.mirrored=!1,this.label.parallel=!1;break}this.axisContext&&(this.axisContext.position=this.position,this.axisContext.direction=this.direction)}calculateLayout(t,i){return this.updateDirection(),super.calculateLayout(t,i)}layoutCrossLines(){const t=this.isAnySeriesActive();this.crossLines.forEach(i=>{var s;(s=i.calculateLayout)==null||s.call(i,t,this.reverse)})}calculateTickLayout(t,i,s,n){var H;const a=this.label.getSideFlag(),r=this.horizontal?-.5*Math.PI:0,o=bi(r),l=bi(r-Math.PI/2),c=a*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding);if(i===2&&this.label.enabled===!1&&this.tick.enabled===!1&&this.gridLine.enabled===!1){const{bbox:U,spacing:$}=this.tickBBox(t,[],[]);return this.generatedTicks={ticks:[],tickLines:[],gridLines:[],labels:[],spacing:$},{ticks:[],rawTickCount:0,tickDomain:t,niceDomain:t,fractionDigits:0,timeInterval:void 0,bbox:U}}const h=this.horizontal&&Mt.is(this.scale),d=this.tickGenerator.generateTicks({domain:t,niceMode:i,visibleRange:s,primaryTickCount:n,parallelFlipRotation:o,regularFlipRotation:l,labelX:c,sideFlag:a,removeOverflowLabels:h,removeOverflowThreshold:(H=this.chartPadding)==null?void 0:H.right}),{tickData:u}=d,{ticks:p,tickDomain:g,rawTicks:f,rawTickCount:y,fractionDigits:v,timeInterval:x,niceDomain:S=t}=u,M=p.map(U=>this.getTickLabelProps(U,d)),{position:D,horizontal:A,gridPadding:w,gridLength:T}=this,k=D==="bottom"||D==="right"?-1:1,N=w,O=k*T-w,{gridLine:L}=this,F=p.map(({tickId:U,translationY:$},W)=>{var de;const[Y,K,Q,Z]=A?[$,N,$,O]:[N,$,O,$],{style:J,width:ae}=L,{stroke:oe,lineDash:le}=(de=J[W%J.length])!=null?de:{};return{tickId:U,offset:$,x1:Y,y1:K,x2:Q,y2:Z,stroke:oe,strokeWidth:ae,lineDash:le}}),{tick:B,primaryTick:_}=this,G=p.map(({primary:U,tickId:$,translationY:W})=>{const Y=U&&(_!=null&&_.enabled)?_:B,K=-k*this.getTickSize(Y),[Q,Z,J,ae]=A?[W,0,W,K]:[0,W,K,W],{stroke:oe,width:le}=Y;return{tickId:$,offset:W,x1:Q,y1:Z,x2:J,y2:ae,stroke:oe,strokeWidth:le,lineDash:void 0}}),{bbox:V,spacing:j}=this.tickBBox(g,p,M);return this.generatedTicks={ticks:p,gridLines:F,tickLines:G,labels:M,spacing:j},{ticks:f,rawTickCount:y,tickDomain:g,niceDomain:S,fractionDigits:v,timeInterval:x,bbox:V}}update(){var r,o,l,c,h;this.updateDirection();const t=Array.from(this.tickLabelGroupSelection.nodes(),d=>d.datum.tickId);super.update(),this.tickLineGroup.visible=this.tick.enabled||((o=(r=this.primaryTick)==null?void 0:r.enabled)!=null?o:!1),this.tickLabelGroup.visible=this.label.enabled||((c=(l=this.primaryTick)==null?void 0:l.enabled)!=null?c:!1);const{generatedTicks:i}=this;if(this.updateTitle(this.scale.domain,(h=i==null?void 0:i.spacing)!=null?h:0),this.animatable||this.moduleCtx.animationManager.skipCurrentBatch(),this.generatedTicks){const{ticks:d}=this.generatedTicks;if(this.animationManager.isSkipped())this.resetSelectionNodes();else{const u=d.map(g=>g.tickId),p=UQ(t,u);this.animationState.transition("update",p)}}const{enabled:s,stroke:n,width:a}=this.line;this.lineNode.setProperties({stroke:n,strokeWidth:s?a:0}),this.updateTickLines(),this.updateGridLines()}getAxisTransform(){return{translationX:Math.floor(this.translation.x),translationY:Math.floor(this.translation.y)}}updatePosition(){super.updatePosition();const t=this.getAxisTransform();this.tickLineGroup.datum=t,this.tickLabelGroup.datum=t,this.lineNodeGroup.datum=t,this.headingLabelGroup.datum=t}getAxisLineCoordinates(){const{horizontal:t}=this,[i,s]=ss(this.range);return t?{x1:i,x2:s,y1:0,y2:0}:{x1:0,x2:0,y1:i,y2:s}}getTickLineBBox(t){const{position:i,primaryTick:s}=this,n=Math.max(this.getTickSize(),s!=null&&s.enabled?this.getTickSize(s):0),{translationY:a}=t;switch(i){case"top":return new ve(a,-n,a,n);case"bottom":return new ve(a,0,a,n);case"left":return new ve(-n,a,n,a);case"right":return new ve(0,a,n,a)}}lineNodeBBox(){const{position:t,seriesAreaPadding:i}=this,{y1:s,y2:n}=this.getAxisLineCoordinates(),a=n-s;switch(t){case"top":return new ve(s,-i,a,i);case"bottom":return new ve(s,0,a,i);case"left":return new ve(-i,s,i,a);case"right":return new ve(0,s,i,a)}}titleBBox(t,i){const{tempCaption:s}=this;return s.node.setProperties(this.titleProps(s,t,i)),s.node.getBBox()}tickBBox(t,i,s){const{tick:n,primaryTick:a,label:r,primaryLabel:o,title:l,position:c,horizontal:h,seriesAreaPadding:d}=this,u=[];if(u.push(this.lineNodeBBox()),n.enabled||a!=null&&a.enabled)for(const y of i)u.push(this.getTickLineBBox(y));const{tempText:p}=this;if(r.enabled)for(const y of s){if(!y.visible)continue;p.setProperties(y);const v=p.getBBox();v&&u.push(v)}if(o!=null&&o.enabled&&o.format!=null&&c==="bottom"){const{fontSize:y,format:v}=o,S=(Lt(v)?Object.values(v):[v]).reduce((w,T)=>Math.max(w,EQ(T)),0),M=this.getTickSize(a!=null?a:n)+o.spacing+d,A=S*_t.getLineHeight(y)+2;u.push(new ve(0,M,1,A))}let g=0;if(l.enabled){const y=ve.merge(u);g=h?y.height:y.width,u.push(this.titleBBox(t,g))}return{bbox:ve.merge(u),spacing:g}}titleProps(t,i,s){var g;const{title:n}=this;if(!n.enabled)return t.enabled=!1,{visible:!1,text:"",textBaseline:"bottom",x:0,y:0,rotationCenterX:0,rotationCenterY:0,rotation:0};t.enabled=!0,t.color=n.color,t.fontFamily=n.fontFamily,t.fontSize=n.fontSize,t.fontStyle=n.fontStyle,t.fontWeight=n.fontWeight,t.wrapping=n.wrapping;const a=((g=n.spacing)!=null?g:0)+s,{range:r}=this,o=(r[0]+r[1])/2;let l,c,h,d;switch(this.position){case"top":l=o,c=-a,h=0,d="bottom";break;case"bottom":l=o,c=a,h=0,d="top";break;case"left":l=-a,c=o,h=-.5*Math.PI,d="bottom";break;case"right":l=a,c=o,h=.5*Math.PI,d="bottom";break}const{formatter:u=f=>f.defaultValue}=n,p=this.callWithContext(u,this.getTitleFormatterParams(i));return t.text=p,{visible:!0,text:p,textBaseline:d,x:l,y:c,rotationCenterX:l,rotationCenterY:c,rotation:h}}getTickLabelProps(t,i){const{horizontal:s,primaryLabel:n,primaryTick:a,seriesAreaPadding:r,scale:o}=this,{tickId:l,tickLabel:c="",translationY:h,primary:d}=t,u=d&&(n!=null&&n.enabled)?n:this.label,p=d&&(a!=null&&a.enabled)?a:this.tick,{rotation:g,textBaseline:f,textAlign:y}=i,{range:v}=o,S=this.label.getSideFlag()*(this.getTickSize(p)+u.spacing+r),M=c!=="",D=s?h:S,A=s?-S:h;return E(b({},this.getLabelStyles({value:c},void 0,u)),{tickId:l,rotation:g,text:c,textAlign:y,textBaseline:f,visible:M,x:D,y:A,rotationCenterX:D,rotationCenterY:A,range:v})}updateSelections(){if(!this.generatedTicks)return;const t=this.getAxisLineCoordinates(),{tickLines:i,gridLines:s,labels:n}=this.generatedTicks,a=r=>r.tickId;this.lineNode.datum=t,this.gridLineGroupSelection.update(this.gridLine.enabled?s:[],void 0,a),this.tickLineGroupSelection.update(i,void 0,a),this.tickLabelGroupSelection.update(n,void 0,a)}updateGridLines(){this.gridLineGroupSelection.each((t,i)=>{t.stroke=i.stroke,t.strokeWidth=i.strokeWidth,t.lineDash=i.lineDash})}updateTickLines(){this.tickLineGroupSelection.each((t,i)=>{t.stroke=i.stroke,t.strokeWidth=i.strokeWidth,t.lineDash=i.lineDash})}updateTitle(t,i){const{caption:s}=this.title,n=this.titleProps(s,t,i);s.node.visible=n.visible,s.node.text=n.text,s.node.textBaseline=n.textBaseline,s.node.datum=n}updateLabels(){this.label.enabled&&this.tickLabelGroupSelection.each((t,i)=>{var s;t.fill=i.fill,t.fontFamily=i.fontFamily,t.fontSize=i.fontSize,t.fontStyle=i.fontStyle,t.fontWeight=i.fontWeight,t.text=i.text,t.textBaseline=i.textBaseline,t.textAlign=(s=i.textAlign)!=null?s:"center"})}animateReadyUpdate(t){const{animationManager:i}=this.moduleCtx,s=n1(this),n=a1(s);Qt(this.id,"axis-group",i,[this.lineNodeGroup,this.tickLabelGroup,this.tickLineGroup,this.headingLabelGroup],n.group),Qt(this.id,"line",i,[this.lineNode],n.line),Qt(this.id,"line-paths",i,[this.gridLineGroupSelection,this.tickLineGroupSelection],n.tick,(a,r)=>r.tickId,t),Qt(this.id,"tick-labels",i,[this.tickLabelGroupSelection],n.label,(a,r)=>r.tickId,t),Qt(this.id,"title",i,[this.title.caption.node],n.label,(a,r)=>r.tickId,t)}resetSelectionNodes(){ns([this.lineNodeGroup,this.tickLabelGroup,this.tickLineGroup,this.headingLabelGroup],r1()),ns([this.gridLineGroupSelection,this.tickLineGroupSelection],FM()),ns([this.tickLabelGroupSelection],lv()),ns([this.title.caption.node],lv()),ns([this.lineNode],FM())}};I([P],zM.prototype,"thickness",2),I([P],zM.prototype,"position",2);var Gg=zM,c1=["top","right","bottom","left"];function tne(e){return typeof e=="string"&&c1.includes(e)}function ine(e){const t=[],i=[],s=[...c1];for(const n of e)n instanceof Gg&&(tne(n.position)?i.push(n.position):t.push(n));for(const n of t){let a;do a=s.pop();while(a&&i.includes(a));if(a==null)break;n.position=a}}var sne=["direction","xKey","yKey","sizeKey","angleKey","radiusKey","normalizedTo"];function nne(e,t,i){var c,h,d,u;const s=(p,g,f)=>{const y=[p];for(const v of sne)v in g&&g[v]!=null&&y.push(`${v}=${g[v]}`);return f!=null&&f.seriesGrouping&&y.push(`seriesGrouping.groupId=${f==null?void 0:f.seriesGrouping.groupId}`),y.join(";")},n=new Map;let a=0;for(const p of e){const g=s(p.type,p.properties,i==null?void 0:i[a]);n.has(g)||n.set(g,[]),(c=n.get(g))==null||c.push([p,a++])}const r=new Map;a=0;for(const p of t){const g=s(p.type,p,p);r.has(g)||r.set(g,[]),(h=r.get(g))==null||h.push([p,a++])}if(![...n.keys()].some(p=>r.has(p)))return{status:"no-overlap",oldKeys:n.keys(),newKeys:r.keys()};const l=[];for(const[p,g]of r.entries())for(const[f,y]of g){const v=n.get(p);if(v==null||v.length<1){l.push({opts:f,targetIdx:y,idx:y,status:"add"}),n.delete(p);continue}const[x,S]=v.shift(),M=(d=i==null?void 0:i[S])!=null?d:{},D=Lr(M,f!=null?f:{}),{groupIndex:A,stackIndex:w}=(u=D==null?void 0:D.seriesGrouping)!=null?u:{};A!=null||w!=null?l.push({opts:f,series:x,diff:D,targetIdx:y,idx:S,status:"series-grouping"}):D?l.push({opts:f,series:x,diff:D,targetIdx:y,idx:S,status:"update"}):l.push({opts:f,series:x,targetIdx:y,idx:S,status:"no-op"}),v.length===0&&n.delete(p)}for(const p of n.values())for(const[g,f]of p)l.push({series:g,idx:f,targetIdx:-1,status:"remove"});return{status:"overlap",changes:l}}function Po(e){var i,s;const{series:t}=e;return(s=(i=t==null?void 0:t[0])==null?void 0:i.type)!=null?s:"line"}function VM(e){const t=Po(e);return qt.isCartesian(t)||tse(t)}function h1(e){const t=Po(e);return qt.isPolar(t)||ise(t)}function d1(e){const t=Po(e);return qt.isHierarchy(t)||sse(t)}function u1(e){const t=Po(e);return qt.isTopology(t)||nse(t)}function p1(e){const t=Po(e);return qt.isFlowProportion(t)||ase(t)}function jM(e){const t=Po(e);return qt.isStandalone(t)||rse(t)}function HM(e){const t=Po(e);return qt.isGauge(t)||ose(t)}function ane(e){const t=Po(e);return h1(e)&&t!=="pie"&&t!=="donut"}var rne=class extends AM{applyOptions(e){for(const t of this.moduleMap.values())t.module.optionsKey in e&&qd(t.moduleInstance)&&t.moduleInstance.set(e[t.module.optionsKey])}*legends(){for(const{module:e,moduleInstance:t}of this.moduleMap.values())e.type==="legend"&&(yield{legendType:e.identifier,legend:t})}},WM="ag-charts-overlay",g1="ag-charts-dark-overlay",vh=class extends Be{constructor(e,t){super(),this.className=e,this.defaultMessageId=t,this.enabled=!0}getText(e){var t;return e.t((t=this.text)!=null?t:this.defaultMessageId)}getElement(e,t,i){var s;if((s=this.content)==null||s.remove(),this.focusBox=i,this.renderer){const n=this.renderer();if(n instanceof HTMLElement)this.content=n;else{const a=ke("div");a.innerHTML=n;const{firstElementChild:r}=a;r instanceof HTMLElement&&a.childElementCount===1?this.content=r:this.content=a}}else{const n=ke("div",{display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",height:"100%",margin:"8px",fontFamily:"var(--ag-charts-font-family)",fontSize:"var(--ag-charts-font-size)",fontWeight:"var(--ag-charts-font-weight)"});n.innerText=this.getText(t),this.content=n,e==null||e.animate({from:0,to:1,id:"overlay",phase:"add",groupId:"opacity",onUpdate(a){n.style.opacity=String(a)},onStop(){n.style.opacity="1"}})}return this.content}removeElement(e=()=>{var i;return(i=this.content)==null?void 0:i.remove()},t){if(this.content){if(t){const{content:i}=this;t.animate({from:1,to:0,phase:"remove",id:"overlay",groupId:"opacity",onUpdate(s){i.style.opacity=String(s)},onStop(){e==null||e()}})}else e==null||e();this.content=void 0,this.focusBox=void 0}}};I([P],vh.prototype,"enabled",2),I([P],vh.prototype,"text",2),I([P],vh.prototype,"renderer",2);var xu=class extends Be{constructor(){super(...arguments),this.darkTheme=!1,this.loading=new vh("ag-charts-loading-overlay","overlayLoadingData"),this.noData=new vh("ag-charts-no-data-overlay","overlayNoData"),this.noVisibleSeries=new vh("ag-charts-no-visible-series","overlayNoVisibleSeries"),this.unsupportedBrowser=new vh("ag-charts-unsupported-browser","overlayUnsupportedBrowser")}getFocusInfo(e){for(const t of[this.loading,this.noData,this.noVisibleSeries,this.unsupportedBrowser])if(t.focusBox!==void 0)return{text:t.getText(e),rect:t.focusBox}}destroy(){this.loading.removeElement(),this.noData.removeElement(),this.noVisibleSeries.removeElement(),this.unsupportedBrowser.removeElement()}};I([P],xu.prototype,"darkTheme",2),I([P],xu.prototype,"loading",2),I([P],xu.prototype,"noData",2),I([P],xu.prototype,"noVisibleSeries",2),I([P],xu.prototype,"unsupportedBrowser",2);function one(e,t){const{animationDuration:i}=Tg.add,s=i*t,n=ke("div",`${WM}--loading`,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",boxSizing:"border-box",font:"13px Verdana, sans-serif",userSelect:"none",animation:`ag-charts-loading ${s}ms linear 50ms both`}),a=ke("span",{width:"45px",height:"40px",backgroundImage:["linear-gradient(#0000 calc(1 * 100% / 6), #ccc 0 calc(3 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(2 * 100% / 6), #ccc 0 calc(4 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(3 * 100% / 6), #ccc 0 calc(5 * 100% / 6), #0000 0)"].join(""),backgroundSize:"10px 400%",backgroundRepeat:"no-repeat",animation:"ag-charts-loading-matrix 1s infinite linear"}),r=ke("p",{marginTop:"1em"});r.innerText=e;const o=ke("div",`${WM}__loading-background`,{position:"absolute",inset:"0",opacity:"0.5",zIndex:"-1"}),l=ke("style");return l.innerText=["@keyframes ag-charts-loading { from { opacity: 0 } to { opacity: 1 } }","@keyframes ag-charts-loading-matrix {","0% { background-position: 0% 0%, 50% 0%, 100% 0%; }","100% { background-position: 0% 100%, 50% 100%, 100% 100%; }","}"].join(" "),n.replaceChildren(l,a,r,o),n}var f1=(e=>(e[e.BACKGROUND=0]="BACKGROUND",e[e.ANY_CONTENT=1]="ANY_CONTENT",e))(f1||{}),m1=(e=>(e[e.FOREGROUND=0]="FOREGROUND",e[e.HIGHLIGHT=1]="HIGHLIGHT",e[e.LABEL=2]="LABEL",e))(m1||{});function bh(e,t,i,s){var n,a,r,o,l,c,h,d,u,p,g,f,y,v,x,S,M,D,A,w,T,k,N,O;if(Ka(e))return{type:"gradient",gradient:(n=e.gradient)!=null?n:t.gradient,colorStops:(a=e.colorStops)!=null?a:t.colorStops,bounds:(r=e.bounds)!=null?r:t.bounds,rotation:(o=e.rotation)!=null?o:t.rotation,reverse:(l=e.reverse)!=null?l:t.reverse};if(ch(e)){const L=(c=e.pattern)!=null?c:i.pattern;let F=e.strokeWidth;L==="backward-slanted-lines"||L==="forward-slanted-lines"||L==="horizontal-lines"||L==="vertical-lines"?F!=null||(F=i.strokeWidth):F!=null||(F=0);const B=(d=(h=e.width)!=null?h:e.height)!=null?d:i.width,_=(p=(u=e.height)!=null?u:e.width)!=null?p:i.height;return{type:"pattern",pattern:L,width:B,height:_,path:e.path,padding:(g=e.padding)!=null?g:i.padding,fill:(f=e.fill)!=null?f:i.fill,fillOpacity:(y=e.fillOpacity)!=null?y:i.fillOpacity,backgroundFill:(v=e.backgroundFill)!=null?v:i.backgroundFill,backgroundFillOpacity:(x=e.backgroundFillOpacity)!=null?x:i.backgroundFillOpacity,stroke:(S=e.stroke)!=null?S:i.stroke,strokeOpacity:(M=e.strokeOpacity)!=null?M:i.strokeOpacity,strokeWidth:F,rotation:(D=e.rotation)!=null?D:i.rotation,scale:(A=e.scale)!=null?A:i.scale}}return eu(e)?{type:"image",url:e.url,width:e.width,height:e.height,backgroundFill:(w=e.backgroundFill)!=null?w:s.backgroundFill,backgroundFillOpacity:(T=e.backgroundFillOpacity)!=null?T:s.backgroundFillOpacity,rotation:(k=e.rotation)!=null?k:s.rotation,repeat:(N=e.repeat)!=null?N:s.repeat,fit:(O=e.fit)!=null?O:s.fit}:e}function Br(e,t,i,s){return!Ka(e==null?void 0:e.fill)&&!ch(e==null?void 0:e.fill)&&!eu(e==null?void 0:e.fill)?e:E(b({},e),{fill:bh(e.fill,t,i,s)})}function cv(e,t,i,s){i==null||!Ka(t)||t.bounds==null||t.bounds==="item"?e.fillBBox=void 0:e.fillBBox=i[t.bounds],e.fillParams=s}function xh(e,t,i,s,n){var r,o,l,c,h,d,u,p,g,f,y,v;const a=(r=i==null?void 0:i.fill)!=null?r:t.fill;e.fill=a,cv(e,(o=i==null?void 0:i.fill)!=null?o:t.fill,s,n),e.fillOpacity=(c=(l=i==null?void 0:i.fillOpacity)!=null?l:t.fillOpacity)!=null?c:1,e.stroke=(h=i==null?void 0:i.stroke)!=null?h:t.stroke,e.strokeOpacity=(u=(d=i==null?void 0:i.strokeOpacity)!=null?d:t.strokeOpacity)!=null?u:1,e.strokeWidth=(g=(p=i==null?void 0:i.strokeWidth)!=null?p:t.strokeWidth)!=null?g:0,e.lineDash=(f=i==null?void 0:i.lineDash)!=null?f:t.lineDash,e.lineDashOffset=(v=(y=i==null?void 0:i.lineDashOffset)!=null?y:t.lineDashOffset)!=null?v:0}var y1=(e=>(e[e.EXACT_SHAPE_MATCH=0]="EXACT_SHAPE_MATCH",e[e.NEAREST_NODE=1]="NEAREST_NODE",e[e.AXIS_ALIGNED=2]="AXIS_ALIGNED",e))(y1||{}),lne=.25,cne=.125,zg=class{constructor(e,t,i,s){this.type=e,this.event=t,this.defaultPrevented=!1,this.datum=i.datum,this.seriesId=s.id}preventDefault(){this.defaultPrevented=!0}},UM=class{constructor(e,t,i){this.series=e,this.seriesGrouping=t,this.oldGrouping=i,this.type="groupingChanged"}},hv=class extends uR{constructor(e){super(),this.destroyFns=[],this.usesPlacedLabels=!1,this.seriesGrouping=void 0,this.NodeEvent=zg,this.internalId=Hs(this),this.contentGroup=new ds({name:`${this.internalId}-content`,zIndex:1}),this.highlightGroup=new ds({name:`${this.internalId}-highlight`,zIndex:1}),this.annotationGroup=new ds({name:`${this.internalId}-annotation`}),this.labelGroup=new ds({name:`${this.internalId}-series-labels`}),this.axes={},this.directions=["x","y"],this.nodeDataRefresh=!0,this.moduleMap=new AM,this.datumCallbackCache=new Map,this.connectsToYAxis=!1,this._declarationOrder=-1,this.seriesListeners=new Nl,this._pickNodeCache=new V0;const{moduleCtx:t,pickModes:i,directionKeys:s={},directionNames:n={},canHaveAxes:a=!1,usesPlacedLabels:r=!1}=e;this.ctx=t,this.directionKeys=s,this.directionNames=n,this.canHaveAxes=a,this.usesPlacedLabels=r,this.highlightGroup=new ds({name:`${this.internalId}-highlight`}),this.highlightNode=this.highlightGroup.appendChild(new Ge({name:"highlightNode",zIndex:0})),this.highlightLabel=this.highlightGroup.appendChild(new Ge({name:"highlightLabel",zIndex:10})),this.pickModes=i}get pickModeAxis(){return"main"}get id(){var e,t;return(t=(e=this.properties)==null?void 0:e.id)!=null?t:this.internalId}get type(){var e;return(e=this.constructor.type)!=null?e:""}get focusable(){return!0}get data(){var e;return(e=this._data)!=null?e:this._chartData}set visible(e){this.properties.visible=e,this.ctx.legendManager.toggleItem(e,this.id),this.ctx.legendManager.update(),this.visibleMaybeChanged()}get visible(){var e;return(e=this.ctx.legendManager.getSeriesEnabled(this.id))!=null?e:this.properties.visible}get hasData(){return this.data!=null&&this.data.length>0}get tooltipEnabled(){var e;return(e=this.properties.tooltip)==null?void 0:e.enabled}onDataChange(){this.nodeDataRefresh=!0,this._pickNodeCache.clear()}setOptionsData(e){this._data=e,this.onDataChange()}setChartData(e){this._chartData=e,this.data===e&&this.onDataChange()}onSeriesGroupingChange(e,t){const{internalId:i,type:s,visible:n}=this;e&&this.ctx.seriesStateManager.deregisterSeries(this),t&&this.ctx.seriesStateManager.registerSeries({internalId:i,type:s,visible:n,seriesGrouping:t}),this.fireEvent(new UM(this,t,e))}getBandScalePadding(){return{inner:1,outer:0}}attachSeries(e,t,i){e.appendChild(this.contentGroup),t.appendChild(this.highlightGroup),t.appendChild(this.labelGroup),i==null||i.appendChild(this.annotationGroup)}detachSeries(e,t,i){e==null||e.removeChild(this.contentGroup),t.removeChild(this.highlightGroup),t.removeChild(this.labelGroup),i==null||i.removeChild(this.annotationGroup)}setSeriesIndex(e){return e===this._declarationOrder?!1:(this._declarationOrder=e,this.contentGroup.zIndex=[1,e,0],this.highlightGroup.zIndex=[1,e,1],this.labelGroup.zIndex=[1,e,2],this.annotationGroup.zIndex=e,!0)}renderToOffscreenCanvas(){return!1}addEventListener(e,t){return super.addEventListener(e,t)}removeEventListener(e,t){return super.removeEventListener(e,t)}hasEventListener(e){return super.hasEventListener(e)}addListener(e,t){return this.seriesListeners.addListener(e,t)}dispatch(e,t){this.seriesListeners.dispatch(e,t)}addChartEventListeners(){}updatedDomains(){}destroy(){this.destroyFns.forEach(e=>e()),this.destroyFns=[],this.resetDatumCallbackCache(),this.ctx.seriesStateManager.deregisterSeries(this)}getDirectionValues(e,t){const i=this.resolveKeyDirection(e),s=t==null?void 0:t[i],n=[];if(!s)return n;const a=(...r)=>{for(const o of r)Array.isArray(o)?a(...o):typeof o=="object"?a(...Object.values(o)):n.push(o)};return a(...s.map(r=>this.properties[r])),n}getKeys(e){return this.getDirectionValues(e,this.directionKeys)}getKeyProperties(e){var t;return(t=this.directionKeys[this.resolveKeyDirection(e)])!=null?t:[]}getNames(e){return this.getDirectionValues(e,this.directionNames)}resolveKeyDirection(e){return e}getDomain(e){const t=this.getSeriesDomain(e),i=this.moduleMap.mapModules(s=>s.getDomain(e)).flat();return i.length!==0?t.concat(i):t}getRange(e,t){return this.getSeriesRange(e,t)}getVisibleItems(e,t,i){return 1/0}markNodeDataDirty(){this.nodeDataRefresh=!0,this._pickNodeCache.clear(),this.visibleMaybeChanged()}visibleMaybeChanged(){this.ctx.seriesStateManager.updateSeries(this)}getOpacity(){const{dimOpacity:t=1,enabled:i=!0}=this.properties.highlightStyle.series;if(!i||t===1)return 1;switch(this.isItemIdHighlighted()){case 0:case 1:return 1;case 2:default:return t}}getStrokeWidth(e){const{strokeWidth:t,enabled:i=!0}=this.properties.highlightStyle.series;if(!i||t===void 0)return e;switch(this.isItemIdHighlighted()){case 1:return t;case 0:case 2:return e}}isItemIdHighlighted(){var t,i;const e=(i=(t=this.ctx.highlightManager)==null?void 0:t.getActiveHighlight())==null?void 0:i.series;return e==null?0:e!==this?2:1}getModuleTooltipParams(){return this.moduleMap.mapModules(e=>e.getTooltipParams()).reduce((e,t)=>Object.assign(e,t),{})}pickNodes(e,t,i=!1){const{pickModes:s,pickModeAxis:n,visible:a,contentGroup:r}=this;if(!a||!r.visible||t==="highlight"&&!this.properties.highlight.enabled||t==="highlight-tooltip"&&!this.properties.highlight.enabled)return;let o=1/0;if(t==="tooltip"||t==="highlight-tooltip"){const{tooltip:u}=this.properties;o=typeof u.range=="number"?u.range:1/0,i||(i=u.range==="exact")}else if(t==="event"||t==="context-menu"){const{nodeClickRange:u}=this.properties;o=typeof u=="number"?u:1/0,i||(i=u==="exact")}const l=s.filter(u=>!i||u===0),{x:c,y:h}=e,d=JSON.stringify({x:c,y:h,maxDistance:o,selectedPickModes:l});if(this._pickNodeCache.has(d))return this._pickNodeCache.get(d);for(const u of l){let p;switch(u){case 0:{const g=this.pickNodesExactShape(e);p=g.length===0?void 0:{datums:g,distance:0};break}case 1:{const g=this.pickNodeClosestDatum(e),f=(g==null?void 0:g.distance)===0?this.pickNodesExactShape(e):void 0;f!=null&&f.length!==0?p={datums:f,distance:0}:g?p={datums:[g.datum],distance:g.distance}:p=void 0;break}case 2:{const g=n!=null?this.pickNodeMainAxisFirst(e,n==="main-category"):void 0;p=g!=null?{datums:[g.datum],distance:g.distance}:void 0;break}}if(p&&p.distance<=o)return this._pickNodeCache.set(d,{pickMode:u,datums:p.datums,distance:p.distance})}return this._pickNodeCache.set(d,void 0)}pickNodesExactShape(e){const t=[];for(const i of this.contentGroup.pickNodes(e.x,e.y)){const s=i.closestDatum();s!=null&&s.missing!==!0&&t.push(s)}return t}pickNodeClosestDatum(e){throw new Error("AG Charts - Series.pickNodeClosestDatum() not implemented")}pickNodeNearestDistantObject(e,t){var n;const i=Dy(e.x,e.y,t),s=(n=i.nearest)==null?void 0:n.closestDatum();if(s!=null&&s.missing!==!0)return{datum:s,distance:Math.sqrt(i.distanceSquared)}}pickNodeMainAxisFirst(e,t){throw new Error("AG Charts - Series.pickNodeMainAxisFirst() not implemented")}getLabelData(){return[]}updatePlacedLabelData(e){}fireNodeClickEvent(e,t){const i=new this.NodeEvent("seriesNodeClick",e,t,this);return this.fireEvent(i),!i.defaultPrevented}fireNodeDoubleClickEvent(e,t){const i=new this.NodeEvent("seriesNodeDoubleClick",e,t,this);return this.fireEvent(i),!i.defaultPrevented}createNodeContextMenuActionEvent(e,t){return new this.NodeEvent("nodeContextMenuAction",e,t,this)}onLegendInitialState(e,t){const{visible:i=!0,itemId:s,legendItemName:n}=t!=null?t:{};this.toggleSeriesItem(i,e,s,n)}onLegendItemClick(e){const{enabled:t,itemId:i,series:s,legendType:n}=e,a="legendItemName"in this.properties?this.properties.legendItemName:void 0,r="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,o=a!=null&&a===e.legendItemName;(s.id===this.id||o||r!=null)&&this.toggleSeriesItem(t,n,i,a,e)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:s,numVisibleItems:n,legendType:a}=e,r="legendItemName"in this.properties?this.properties.legendItemName:void 0,o="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,l=r!=null&&r===e.legendItemName;s.id===this.id||l||o!=null?this.toggleSeriesItem(!0,a,i,r,e):t&&n===1?this.toggleSeriesItem(!0,a,void 0,r):this.toggleSeriesItem(!1,a,void 0,r)}toggleSeriesItem(e,t,i,s,n){var o;const a=this.id;(e||t!=="category")&&(this.visible=e),this.nodeDataRefresh=!0,this._pickNodeCache.clear();const r={type:"seriesVisibilityChange",seriesId:a,itemId:i,legendItemName:(o=n==null?void 0:n.legendItemName)!=null?o:s,visible:e};this.fireEvent(r),this.ctx.legendManager.toggleItem(e,a,i,s)}isEnabled(){return this.visible}getModuleMap(){return this.moduleMap}createModuleContext(){return E(b({},this.ctx),{series:this})}getLabelText(e,t,i=Ao){var s;return e.formatter?(s=this.cachedCallWithContext(e.formatter,b({seriesId:this.id},t)))!=null?s:this.callWithContext(i,t.value):this.callWithContext(i,t.value)}getMarkerStyle(e,t,i,s=!1,n=(r=>(r=e.size)!=null?r:0)(),a){const{itemStyler:o,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=e;let u=Br(Je({size:n},a,e.getStyle()),l,c,h);if(o&&i){const p=this.cachedCallWithContext(o,E(b(b({seriesId:this.id},u),i),{highlighted:s,datum:t}));u=Br(Je(p,u),l,c,h)}return u}updateMarkerStyle(e,t,i,s,n,a,r,o,{applyTranslation:l=!0,selected:c=!0}={}){const h=this.getMarkerStyle(e,i,n,a,s==null?void 0:s.size,r),{shape:d,size:u}=h,p=this.visible&&u>0&&s&&!isNaN(s.x)&&!isNaN(s.y);if(xh(t,h,void 0,o),l?t.setProperties({visible:p,shape:d,size:u,x:s==null?void 0:s.x,y:s==null?void 0:s.y,scalingCenterX:s==null?void 0:s.x,scalingCenterY:s==null?void 0:s.y}):t.setProperties({visible:p,shape:d,size:u}),c||(t.fillOpacity*=lne,t.strokeOpacity*=cne),typeof e.shape=="function"&&!t.dirtyPath){t.path.clear(!0),t.updatePath(),t.checkPathDirty();const g=t.getBBox();if(s!==void 0&&g.isFinite()){const f=g.computeCenter(),[y,v]=["x","y"].map(x=>{var S;return((S=h.strokeWidth)!=null?S:0)+Math.abs(f[x]-s[x])});s.focusSize=Math.max(g.width+y,g.height+v)}}}get nodeDataDependencies(){var e;return(e=this._nodeDataDependencies)!=null?e:{seriesRectWidth:NaN,seriesRectHeight:NaN}}checkResize(e){const{width:t,height:i}=e!=null?e:{width:NaN,height:NaN},s=e?{seriesRectWidth:t,seriesRectHeight:i}:void 0,n=Lr(this.nodeDataDependencies,s)!=null;return n&&(this._nodeDataDependencies=s,this.markNodeDataDirty()),n}pickFocus(e){}resetDatumCallbackCache(){this.datumCallbackCache.clear()}cachedDatumCallback(e,t){const{datumCallbackCache:i}=this,s=i.get(e);if(s!=null)return s;try{const n=t();return i.set(e,n),n}catch(n){se.error(String(n))}}cachedCallWithContext(e,...t){return this.ctx.callbackCache.call(this.properties,this.ctx.chartService,e,...t)}callWithContext(e,...t){return $y(this.properties,this.ctx.chartService,e,t)}formatTooltipWithContext(e,t,i){return e.formatTooltip(this.properties,this.ctx.chartService,t,i)}};I([Dn({changeValue:function(e,t){this.onSeriesGroupingChange(t,e)}})],hv.prototype,"seriesGrouping",2);var gn=class extends va{constructor(){super(...arguments),this.path=new Jd,this._clipX=NaN,this._clipY=NaN,this.clip=!1,this._dirtyPath=!0,this.lastPixelRatio=NaN}set clipX(e){this._clipX=e,this.dirtyPath=!0}set clipY(e){this._clipY=e,this.dirtyPath=!0}set dirtyPath(e){this._dirtyPath!==e&&(this._dirtyPath=e,e&&this.markDirty("path"))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){var e,t,i,s;this._dirtyPath||(this.dirtyPath=this.path.isDirty()||((t=(e=this.fillShadow)==null?void 0:e.isDirty())!=null?t:!1)||((s=(i=this._clipPath)==null?void 0:i.isDirty())!=null?s:!1))}onChangeDetection(e){this._dirtyPath||(this._dirtyPath=!0,super.onChangeDetection(e))}computeBBox(){return this.updatePathIfDirty(),this.path.computeBBox()}isPointInPath(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)}distanceSquared(e,t){return this.distanceSquaredTransformedPoint(e,t)}svgPathData(e){return this.updatePathIfDirty(),this.path.toSVG(e)}distanceSquaredTransformedPoint(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)?0:this.path.distanceSquared(e,t)}isDirtyPath(){return!1}updatePath(){}updatePathIfDirty(){(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1)}preRender(e){return e.devicePixelRatio!==this.lastPixelRatio&&(this.dirtyPath=!0),this.lastPixelRatio=e.devicePixelRatio,this.updatePathIfDirty(),super.preRender(e,this.path.commands.length)}render(e){var i,s,n;const{ctx:t}=e;if(this.clip&&!isNaN(this._clipX)&&!isNaN(this._clipY)){t.save();const a=this.strokeWidth/2;(i=this._clipPath)!=null||(this._clipPath=new Jd),this._clipPath.clear(),this._clipPath.rect(-a,-a,this._clipX+a,this._clipY+a+a),t.clip((s=this._clipPath)==null?void 0:s.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(t),t.restore()}else this._clipPath=void 0,this.drawPath(t);(n=this.fillShadow)==null||n.markClean(),super.render(e)}drawPath(e){this.fillStroke(e,this.path.getPath2D())}toSVG(){if(!this.visible)return;const e=Ti("path");e.setAttribute("d",this.svgPathData());const t=this.applySvgFillAttributes(e,[]);return this.applySvgStrokeAttributes(e),{elements:[e],defs:t}}};gn.className="Path",I([he()],gn.prototype,"clip",2),I([he()],gn.prototype,"clipX",1),I([he()],gn.prototype,"clipY",1);var hne=class{constructor(e){this.swapChain=e,this.hasBeenActivated=!1,this.div=ke("div"),this.svg=Ti("svg"),this.outerPath=Ti("path"),this.innerPath=Ti("path"),this.svg.append(this.outerPath),this.svg.append(this.innerPath),this.outerPath.classList.add("ag-charts-focus-svg-outer-path"),this.innerPath.classList.add("ag-charts-focus-svg-inner-path"),this.element=ke("div","ag-charts-focus-indicator"),this.element.ariaHidden="true",this.element.append(this.svg),this.swapChain.addListener("swap",t=>this.onSwap(t))}clear(){}update(e,t,i){if(t!=null)if(e instanceof gn){const s=(a,r)=>{var c,h;let{x:o,y:l}=ai.toCanvasPoint(e,a,r);return o-=(c=t.x)!=null?c:0,l-=(h=t.y)!=null?h:0,{x:o,y:l}},n=e.svgPathData(s);this.outerPath.setAttribute("d",n),this.innerPath.setAttribute("d",n),this.show(this.svg)}else{let s;if(i){const n=Math.max(e.x-t.x,0),a=Math.max(e.y-t.y,0),r=Math.min(e.x+e.width-t.x,t.width),o=Math.min(e.y+e.height-t.y,t.height);s=new ve(n,a,r-n,o-a)}else s=new ve(e.x-t.x,e.y-t.y,e.width,e.height);Ny(this.div,s),this.show(this.div)}}onSwap(e){e!==this.element.parentElement&&(this.element.remove(),e.appendChild(this.element),this.overrideFocusVisible(this.focusVisible))}show(e){this.hasBeenActivated=!0,this.element.innerHTML="",this.element.append(e)}overrideFocusVisible(e){this.focusVisible=e;const t={true:"1",false:"0",undefined:""},i=this.element.parentElement;i==null||i.style.setProperty("opacity",t[`${e}`])}isFocusVisible(e=!1){if(!e&&!this.hasBeenActivated)return!1;const t=this.element.parentElement;return t!=null&&Ct().getComputedStyle(t).opacity==="1"}},dne=class{constructor(e,t,i){this.label1=e,this.label2=t,this.hasFocus=!1,this.skipDispatch=!1,this.listeners={blur:[],focus:[],swap:[]},this.onBlur=s=>(Tr(s.target,"pointer-events",void 0),!this.skipDispatch&&this.dispatch("blur",s)),this.onFocus=s=>(Tr(s.target,"pointer-events","auto"),!this.skipDispatch&&this.dispatch("focus",s)),$e(this.label1,"id",sh()),$e(this.label2,"id",sh()),Tr(this.label1,"display","none"),Tr(this.label2,"display","none"),this.activeAnnouncer=this.createAnnouncer(i),this.inactiveAnnouncer=this.createAnnouncer(i),$e(this.activeAnnouncer,"tabindex",0),this.label2.insertAdjacentElement("afterend",this.activeAnnouncer),this.label2.insertAdjacentElement("afterend",this.inactiveAnnouncer),this.swap("")}createAnnouncer(e){const t=ke("div");return t.role=e,t.className="ag-charts-swapchain",t.addEventListener("blur",this.onBlur),t.addEventListener("focus",this.onFocus),t}destroy(){for(const e of[this.activeAnnouncer,this.inactiveAnnouncer])e.removeEventListener("blur",this.onBlur),e.removeEventListener("focus",this.onFocus),e.remove()}focus(e){this.focusOptions=e,this.activeAnnouncer.focus(e),this.focusOptions=void 0}update(e){this.skipDispatch=!0,this.swap(e),this.hasFocus&&this.activeAnnouncer.focus(this.focusOptions),this.skipDispatch=!1}addListener(e,t){this.listeners[e].push(t),e==="swap"&&t(this.activeAnnouncer)}dispatch(e,t){e==="focus"?this.hasFocus=!0:e==="blur"&&(this.hasFocus=!1),this.listeners[e].forEach(i=>i(t))}swap(e){const t=this.activeAnnouncer.tabIndex;this.label2.textContent=e,[this.inactiveAnnouncer,this.activeAnnouncer]=[this.activeAnnouncer,this.inactiveAnnouncer],[this.label1,this.label2]=[this.label2,this.label1],bo(this.inactiveAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!0,tabindex:void 0}),bo(this.activeAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!1,tabindex:t}),this.dispatch("swap",this.activeAnnouncer)}},une={arrowdown:{bindings:[{code:"ArrowDown"}]},arrowleft:{bindings:[{code:"ArrowLeft"}]},arrowright:{bindings:[{code:"ArrowRight"}]},arrowup:{bindings:[{code:"ArrowUp"}]},delete:{bindings:[{key:"Backspace"},{key:"Delete"}],activatesFocusIndicator:!1},redo:{bindings:[{key:"y",ctrlOrMeta:!0},{key:"z",ctrlOrMeta:!0,shift:!0}],activatesFocusIndicator:!1},undo:{bindings:[{key:"z",ctrlOrMeta:!0}],activatesFocusIndicator:!1},submit:{bindings:[{key:"Enter"},{code:"Enter"},{code:"Space"}]},zoomin:{bindings:[{key:"+"},{code:"ZoomIn"},{code:"Add"}],activatesFocusIndicator:!1},zoomout:{bindings:[{key:"-"},{code:"ZoomOut"},{code:"Substract"}],activatesFocusIndicator:!1}};function pne(e,t){for(const i of t)if("code"in i){if(i.code===e.code)return!0}else if(i.key===e.key&&(i.shift===void 0||i.shift===e.shiftKey)&&(i.ctrlOrMeta===void 0||i.ctrlOrMeta===e.ctrlKey||i.ctrlOrMeta===e.metaKey))return!0;return!1}function gne(e){for(const[t,{activatesFocusIndicator:i=!0,bindings:s}]of Zt(une))if(pne(e,s))return{name:t,activatesFocusIndicator:i}}function fne(e,t,i){const s=rM(e,i.datum,i.movedBounds);if(s!=null)return{x:s.canvasX,y:s.canvasY};const n=i.bounds;if(n!=null){if(n instanceof ve){const{x:a,y:r}=n.computeCenter();return{x:t.x+a,y:t.y+r}}return ai.toCanvas(n).computeCenter()}}function mne({bounds:e}){return e instanceof ve?e:e!=null?ai.toCanvas(e):ve.NaN}function yne(e,t,i){var a;const{x:s,y:n}=(a=fne(e,t,i))!=null?a:{};if(s!==void 0&&n!==void 0)return{type:"keyboard",canvasX:s,canvasY:n}}function KM(){return(e,t)=>{const i=[`Property [${e}] is deprecated.`,t].filter(Boolean).join(" ");se.warnOnce(i)}}function v1(e,t){const i=KM(),s=t==null?void 0:t.default;return ah((n,a,r)=>(r!==s&&i(a.toString(),e),r))}function vne(e,t){const i=KM();return ah((s,n,a)=>(a!==s[e]&&(i(n.toString(),`Use [${e}] instead.`),y0(s,e,t?t(a):a)),p0),(s,n)=>(i(n.toString(),`Use [${e}] instead.`),Yd(s,e)))}function b1(e,t,i,s){let{top:n,right:a,bottom:r,left:o,width:l,height:c}=s;return o!=null?l!=null?a=i.width-o+l:a!=null&&(l=i.width-o-a):a!=null&&l!=null&&(o=i.width-a-l),n!=null?c!=null?r=i.height-n-c:r!=null&&(c=i.height-r-n):r!=null&&c!=null&&(n=i.height-r-c),l==null?c==null?(l=e,c=t):l=Math.ceil(e*c/t):c==null&&(c=Math.ceil(t*l/e)),o==null&&(a==null?o=Math.floor((i.width-l)/2):o=i.width-a-l),n==null&&(r==null?n=Math.floor((i.height-c)/2):n=i.height-c-r),{x:o,y:n,width:l,height:c}}var x1=.1,C1=200,S1=12,bne=.5,xne=class extends Nl{constructor(){super(...arguments),this.x1=NaN,this.y1=NaN,this.x=NaN,this.y=NaN,this.vx=0,this.vy=0,this.t0=NaN,this.animationFrameHandle=void 0}reset(){this.x=NaN,this.y=NaN,this.animationFrameHandle!=null&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0)}update(e,t){if(Number.isNaN(this.x)||Number.isNaN(this.y)){this.x=e,this.y=t,this.vx=0,this.vy=0,this.emitUpdate(),this.animationFrameHandle!=null&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0);return}this.x1=e,this.y1=t,this.t0=Date.now(),this.animationFrameHandle==null&&(this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this)))}onFrame(){this.animationFrameHandle=void 0;const{x1:e,y1:t,t0:i}=this,s=Date.now(),n=s-i;this.t0=s;const a=.001,r=Math.ceil(n/(a*1e3))|0;let{x:o,y:l,vx:c,vy:h}=this;for(let d=0;d<r;d+=1){const u=o-e,p=l-t,g=-(C1*u+S1*c)/x1,f=-(C1*p+S1*h)/x1;c+=g*a,h+=f*a,o+=c*a,l+=h*a}Math.hypot(o-e,l-t)<bne?(this.x=this.x1,this.y=this.y1,this.vx=0,this.vy=0):(this.x=o,this.y=l,this.vx=c,this.vy=h,this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this))),this.emitUpdate()}emitUpdate(){this.dispatch("update",{type:"update",x:this.x,y:this.y})}},Cu=null;function Vg(e){return e===""?"":(Cu!=null||(Cu=ke("div")),Cu.textContent=String(e),Cu.innerHTML.replace(/\n/g,"<br>"))}function jg(e,t){const{path:i,size:s}=e,{x:n,y:a}=e;i.clear();let r=!1;for(const[o,l]of t){const c=n+(o-.5)*s,h=a+(l-.5)*s;r?i.lineTo(c,h):i.moveTo(c,h),r=!0}i.closePath()}var Cne={circle({path:e,x:t,y:i,size:s}){const n=s/2;e.arc(t,i,n,0,Math.PI*2),e.closePath()},cross(e){jg(e,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},diamond(e){jg(e,[[.5,0],[1,.5],[.5,1],[0,.5]])},heart({path:e,x:t,y:i,size:s}){const n=s/4;i=i+n/2,e.arc(t-n,i-n,n,Vi(130),Vi(330)),e.arc(t+n,i-n,n,Vi(220),Vi(50)),e.lineTo(t,i+n),e.closePath()},pin({path:e,x:t,y:i,size:s}){e.moveTo(t+(.15625-.5)*s,i+(.34375-.5)*s),e.cubicCurveTo(t+(.15625-.5)*s,i+(.151491-.5)*s,t+(.307741-.5)*s,i+(0-.5)*s,t+(.5-.5)*s,i+(0-.5)*s),e.cubicCurveTo(t+(.692259-.5)*s,i+(0-.5)*s,t+(.84375-.5)*s,i+(.151491-.5)*s,t+(.84375-.5)*s,i+(.34375-.5)*s),e.cubicCurveTo(t+(.84375-.5)*s,i+(.493824-.5)*s,t+(.784625-.5)*s,i+(.600181-.5)*s,t+(.716461-.5)*s,i+(.695393-.5)*s),e.cubicCurveTo(t+(.699009-.5)*s,i+(.719769-.5)*s,t+(.681271-.5)*s,i+(.743104-.5)*s,t+(.663785-.5)*s,i+(.766105-.5)*s),e.cubicCurveTo(t+(.611893-.5)*s,i+(.834367-.5)*s,t+(.562228-.5)*s,i+(.899699-.5)*s,t+(.528896-.5)*s,i+(.980648-.5)*s),e.cubicCurveTo(t+(.524075-.5)*s,i+(.992358-.5)*s,t+(.512663-.5)*s,i+(1-.5)*s,t+(.5-.5)*s,i+(1-.5)*s),e.cubicCurveTo(t+(.487337-.5)*s,i+(1-.5)*s,t+(.475925-.5)*s,i+(.992358-.5)*s,t+(.471104-.5)*s,i+(.980648-.5)*s),e.cubicCurveTo(t+(.487337-.5)*s,i+(1-.5)*s,t+(.475925-.5)*s,i+(.992358-.5)*s,t+(.471104-.5)*s,i+(.980648-.5)*s),e.cubicCurveTo(t+(.437772-.5)*s,i+(.899699-.5)*s,t+(.388107-.5)*s,i+(.834367-.5)*s,t+(.336215-.5)*s,i+(.766105-.5)*s),e.cubicCurveTo(t+(.318729-.5)*s,i+(.743104-.5)*s,t+(.300991-.5)*s,i+(.719769-.5)*s,t+(.283539-.5)*s,i+(.695393-.5)*s),e.cubicCurveTo(t+(.215375-.5)*s,i+(.600181-.5)*s,t+(.15625-.5)*s,i+(.493824-.5)*s,t+(.15625-.5)*s,i+(.34375-.5)*s),e.closePath()},plus(e){jg(e,[[1/3,0],[2/3,0],[2/3,1/3],[1,1/3],[1,2/3],[2/3,2/3],[2/3,1],[1/3,1],[1/3,2/3],[0,2/3],[0,1/3],[1/3,1/3]])},square({path:e,x:t,y:i,size:s,pixelRatio:n}){const a=s/2;e.moveTo(ts(n,t-a),ts(n,i-a)),e.lineTo(ts(n,t+a),ts(n,i-a)),e.lineTo(ts(n,t+a),ts(n,i+a)),e.lineTo(ts(n,t-a),ts(n,i+a)),e.closePath()},star({path:e,x:t,y:i,size:s}){const a=s/2,r=a/2,o=Math.PI/2;for(let l=0;l<10;l++){const c=l%2===0?a:r,h=l*Math.PI/5-o,d=t+Math.cos(h)*c,u=i+Math.sin(h)*c;e.lineTo(d,u)}e.closePath()},triangle(e){jg(e,[[.5,0],[1,.87],[0,.87]])}},Hg=class extends gn{constructor(){super(...arguments),this.shape="square",this.x=0,this.y=0,this.size=12}updatePath(){var l,c,h;const{path:e,shape:t,x:i,y:s,size:n}=this,a=(h=(c=(l=this.layerManager)==null?void 0:l.canvas)==null?void 0:c.pixelRatio)!=null?h:1,r=rs.anchor(t),o={path:e,x:i-(r.x-.5)*n,y:s-(r.y-.5)*n,size:n,pixelRatio:a};e.clear(),typeof t=="string"?Cne[t](o):typeof t=="function"&&t(o)}computeBBox(){const{x:e,y:t,size:i}=this,s=rs.anchor(this.shape);return new ve(e-i*s.x,t-i*s.y,i,i)}executeFill(e,t){if(t)return super.executeFill(e,t)}executeStroke(e,t){if(t)return super.executeStroke(e,t)}};I([$n({equals:Xd})],Hg.prototype,"shape",2),I([he()],Hg.prototype,"x",2),I([he()],Hg.prototype,"y",2),I([he({convertor:Math.abs})],Hg.prototype,"size",2);var rs=class extends tu(T0(hh(Hg))){static anchor(e){return e==="pin"?{x:.5,y:1}:typeof e=="function"&&"anchor"in e?e.anchor:{x:.5,y:.5}}constructor(e){super(e),(e==null?void 0:e.shape)!=null&&(this.shape=e.shape)}};function M1(e,t,i=t*(5/3)){var l,c,h;const s=new Ge,n=Math.min((l=e.marker.strokeWidth)!=null?l:1,2),a=Math.min((h=(c=e.line)==null?void 0:c.strokeWidth)!=null?h:0,2),r=Math.max(e.marker.enabled===!1?0:t,e.line==null?0:i),o=Math.max(e.marker.enabled===!1?0:t,a);if(e.line!=null){const{stroke:d,strokeOpacity:u,lineDash:p}=e.line,g=new Ks;g.x1=0,g.y1=o/2,g.x2=r,g.y2=o/2,g.stroke=d,g.strokeOpacity=u,g.strokeWidth=a,g.lineDash=p,s.append(g)}if(e.marker.enabled!==!1){const{shape:d,fill:u,fillOpacity:p,stroke:g,strokeOpacity:f,lineDash:y,lineDashOffset:v}=e.marker,x=new rs;x.shape=d!=null?d:"square",x.size=t,x.fill=u,x.fillOpacity=p!=null?p:1,x.stroke=g,x.strokeOpacity=f!=null?f:1,x.strokeWidth=n,x.lineDash=y,x.lineDashOffset=v!=null?v:0;const S=rs.anchor(d),M=r/2+(S.x-.5)*t,D=o/2+(S.y-.5)*t,A=t/(t+n);x.x=M,x.y=D,x.scalingCenterX=M,x.scalingCenterY=D,x.scalingX=A,x.scalingY=A,s.append(x)}return Ge.toSVG(s,r,o)}var ps="ag-charts-tooltip",D1="ag-charts-tooltip--dark";function w1(e){const t=[],i=new Map;for(const s of e)if(s.type==="structured"){const{heading:n}=s,a=n!=null?i.get(n):void 0,r={type:"structured",heading:n,items:[s]};a==null?(i.set(n,r),t.push(r)):a.items.push(s)}else t.push(s);return t}function A1(e){const t=w1(e),i=[];return t.forEach(s=>{if(s.type==="raw")return"";s.heading!=null&&i.push(s.heading),s.items.forEach(n=>{var a;n.title!=null&&i.push(n.title),(a=n.data)==null||a.forEach(r=>{var o;i.push((o=r.label)!=null?o:r.fallbackLabel,r.value)})})}),i.join("; ")}function $M(e,t,i){let s="";e==null?s+=`<span class="${ps}-label">${Vg(t)}</span>`:(s+=`<span class="${ps}-label">${Vg(e)}</span>`,s+=" ",s+=`<span class="${ps}-value">${Vg(t)}</span>`);const n=[`${ps}-row`];return i&&n.push(`${ps}-row--inline`),s=`<div class="${n.join(" ")}">${s}</div>`,s}function Sne(e){var n,a,r,o;let t="";if((n=e.data)!=null&&n.length&&e.data.every(l=>l.value==null||l.value===""))return t;const i=e.title==null&&((a=e.data)==null?void 0:a.length)===1,s=e.symbol==null?void 0:M1(e.symbol,12);return s!=null&&(e.title!=null||(r=e.data)!=null&&r.length)&&(t+=`<span class="${ps}-symbol">${s}</span>`),e.title!=null&&(t+=`<span class="${ps}-title">${Vg(e.title)}</span>`,t+=" "),(o=e.data)==null||o.forEach(l=>{var c;t+=$M((c=l.label)!=null?c:l.fallbackLabel,l.value,i),t+=" "}),t}function I1(e,t){if(e==null||t.length===1)return;const i=e==null?void 0:e.t("tooltipPaginationStatus",{index:t.index+1,count:t.length});return`<div class="${ps}-footer">${i}</div>`}function T1(e,t,i,s){var h,d,u;const n=t.items.length===1?t.items[0]:void 0;let a,r,o;switch(i){case"compact":a=!0,r=n==null?void 0:n.title;break;case"single":a=n!=null&&(t.heading==null||n.title==null)&&((h=n.data)==null?void 0:h.length)===1&&n.data[0].label==null&&n.data[0].value!=null,o=(d=t.heading)!=null?d:n==null?void 0:n.title;break;case"shared":a=!1}let l="";if(a&&n!=null?(r!=null&&(l+=$M(void 0,r,!1)),(u=n.data)==null||u.forEach(p=>{var g;l+=$M((g=p.label)!=null?g:o,p.value,!1),l+=" "})):(t.heading!=null&&(l+=`<span class="${ps}-heading">${Vg(t.heading)}</span>`,l+=" "),t.items.forEach(p=>{l+=Sne(p)})),l.length===0)return;const c=i!=="compact"&&s!=null?I1(e,s):void 0;return c+null&&(l+=c),l=`<div class="${ps}-content">${l.trimEnd()}</div>`,l}function Mne(e,t){const i=t==null?void 0:I1(e,t);return i==null?"":`<div class="${ps}-content">${i}</div>`}function k1(e,t,i,s){var a;const n=w1(t);if(n.length!==0){if(n.length===1&&n[0].type==="structured")return T1(e,n[0],i,s);{const r=n.map(o=>o.type==="structured"?T1(e,o,i):o.rawHtmlString);return s!=null&&r.push((a=Mne(e,s))!=null?a:""),r.join("")}}}var Dne={left:-1,"top-left":-1,"bottom-left":-1,top:0,center:0,bottom:0,right:1,"top-right":1,"bottom-right":1},wne={"top-left":-1,top:-1,"top-right":-1,left:0,center:0,right:0,"bottom-left":1,bottom:1,"bottom-right":1},Ane={left:3,"top-left":void 0,"bottom-left":void 0,top:2,center:void 0,bottom:1,right:0,"top-right":void 0,"bottom-right":void 0},L1={top:2,bottom:2,left:1,right:1,"top-right":3,"top-left":3,"bottom-right":3,"bottom-left":3,center:0},Eo=class extends Be{constructor(){super(...arguments),this.xOffset=0,this.yOffset=0}get defaultAnchorTo(){var s;const{type:e,_seriesOverrideType:t}=this,i=(s=e!=null?e:t)!=null?s:"pointer";return i==="node"||i==="pointer"?i:"chart"}get defaultPlacement(){var s;const{type:e,_seriesOverrideType:t}=this,i=(s=e!=null?e:t)!=null?s:"pointer";return i==="node"||i==="pointer"?"top":i}};I([P,v1("Use `anchorTo` and/or `placement` options instead.")],Eo.prototype,"type",2),I([P],Eo.prototype,"_seriesOverrideType",2),I([P],Eo.prototype,"xOffset",2),I([P],Eo.prototype,"yOffset",2),I([P],Eo.prototype,"anchorTo",2),I([P],Eo.prototype,"placement",2);var Sa=class extends Be{constructor(){super(),this.enabled=!0,this.mode="single",this.delay=0,this.range=void 0,this.wrapping="hyphenate",this.position=new Eo,this.pagination=!1,this.darkTheme=!1,this.bounds="extended",this.destroyFns=[],this.springAnimation=new xne,this.enableInteraction=!1,this.wrapTypes=["always","hyphenate","on-space","never"],this.sizeMonitor=new AR,this._elementSize=void 0,this._showTimeout=void 0,this.arrowPosition=void 0,this._visible=!1,this.positionParams=void 0,this.localeManager=void 0,this.destroyFns.push(this.springAnimation.addListener("update",this.updateTooltipPosition.bind(this)))}get interactive(){return this.enableInteraction}setup(e,t){return"togglePopover"in Ct().HTMLElement.prototype&&(this.element=t.addChild("tooltip-container",ps),this.element.setAttribute("popover","manual"),this.element.className=ps,this.element.style.positionAnchor=t.anchorName,this.sizeMonitor.observe(this.element,i=>{this._elementSize=i,this.updateTooltipPosition()})),this.localeManager=e,()=>{t.removeChild("tooltip-container",ps),this.destroyFns.forEach(i=>i()),this.element&&this.sizeMonitor.unobserve(this.element)}}isVisible(){return this._visible}contains(e){var t,i;return(i=(t=this.element)==null?void 0:t.contains(e))!=null?i:!1}updateTooltipPosition(){var T,k,N,O,L,F,B,_,G,V,j,H,U,$,W,Y;const{element:e,_elementSize:t,positionParams:i}=this;if(e==null||t==null||i==null)return;const{canvasRect:s,relativeRect:n,meta:a}=i,{x:r,y:o}=this.springAnimation;let l=(L=(O=(k=(T=a.position)==null?void 0:T.placement)!=null?k:this.position.placement)!=null?O:(N=a.position)==null?void 0:N.defaultPlacement)!=null?L:this.position.defaultPlacement;Array.isArray(l)||(l=[l]);const c=(V=(G=(B=(F=a.position)==null?void 0:F.anchorTo)!=null?B:this.position.anchorTo)!=null?G:(_=a.position)==null?void 0:_.defaultAnchorTo)!=null?V:this.position.defaultAnchorTo,h=(H=(j=a.position)==null?void 0:j.xOffset)!=null?H:0,d=($=(U=a.position)==null?void 0:U.yOffset)!=null?$:0,u=n.x,p=n.y,g=n.width-t.width-1+u,f=n.height-t.height+p;let y=0,v,x,S=!1;do{v=l[y],y+=1;const K=this.getTooltipBounds({elementSize:t,placement:v,anchorTo:c,canvasX:r,canvasY:o,yOffset:d,xOffset:h,canvasRect:s});x=b1(t.width,t.height,n,K),S=!1,L1[v]&1&&(S||(S=x.x<u||x.x>g)),L1[v]&2&&(S||(S=x.y<p||x.y>f))}while(y<l.length&&S);const M=we(u,x.x,g),D=we(p,x.y,f);S||(S=M!==x.x||D!==x.y);const A=c!=="chart"&&!S&&!h&&!d,w=(Y=(W=a.showArrow)!=null?W:this.showArrow)!=null?Y:A;this.arrowPosition=w?Ane[v]:void 0,this.updateClassModifiers(),e.style.translate=`${M}px ${D}px`}show(e,t,i,s,n,a=!1){var c,h,d,u,p,g,f;const{element:r}=this;if(r!=null&&s!=null&&s.length!==0){const y=k1(this.localeManager,s,this.mode,this.pagination?n:void 0);if(y==null){this.toggle(!1);return}r.innerHTML=y}else if(r==null||r.innerHTML===""){this.toggle(!1);return}const o={x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height};switch(this.positionParams={canvasRect:t,relativeRect:o,meta:i},(p=(u=(h=(c=i.position)==null?void 0:c.anchorTo)!=null?h:this.position.anchorTo)!=null?u:(d=i.position)==null?void 0:d.defaultAnchorTo)!=null?p:this.position.defaultAnchorTo){case"node":this.springAnimation.update((g=i.nodeCanvasX)!=null?g:i.canvasX,(f=i.nodeCanvasY)!=null?f:i.canvasY);break;case"pointer":this.springAnimation.update(i.canvasX,i.canvasY);break;case"chart":this.springAnimation.reset()}i.enableInteraction?(this.enableInteraction=!0,r.style.pointerEvents="auto",r.removeAttribute("aria-hidden"),r.tabIndex=-1):(this.enableInteraction=!1,r.style.pointerEvents="none",r.setAttribute("aria-hidden","true"),r.removeAttribute("tabindex")),r.style.setProperty("--top",`${t.top}px`),r.style.setProperty("--left",`${t.left}px`),this.updateClassModifiers(),this.toggle(!0,a)}hide(){this.toggle(!1)}toggle(e,t=!1){var s;const{delay:i}=this;e&&i>0&&!t?(s=this._showTimeout)!=null||(this._showTimeout=setTimeout(()=>{this._showTimeout=void 0,this.toggleCallback(!0)},i)):(clearTimeout(this._showTimeout),this._showTimeout=void 0,this.toggleCallback(e))}toggleCallback(e){var t;(t=this.element)!=null&&t.isConnected&&this._visible!==e&&(this._visible=e,this.element.togglePopover(e),e?this.updateTooltipPosition():this.springAnimation.reset())}updateClassModifiers(){var i;if(!((i=this.element)!=null&&i.isConnected))return;const{classList:e}=this.element,t=(s,n)=>e.toggle(`${ps}--${s}`,n);t("no-interaction",!this.enableInteraction),t("arrow-top",this.arrowPosition===1),t("arrow-right",this.arrowPosition===3),t("arrow-bottom",this.arrowPosition===2),t("arrow-left",this.arrowPosition===0),t("compact",this.mode==="compact"),e.toggle(D1,this.darkTheme);for(const s of this.wrapTypes)e.toggle(`${ps}--wrap-${s}`,s===this.wrapping)}getTooltipBounds(e){const{elementSize:t,anchorTo:i,placement:s,canvasX:n,canvasY:a,yOffset:r,xOffset:o,canvasRect:l}=e,{width:c,height:h}=t,d={width:c,height:h};if(i==="node"||i==="pointer"){const u=Dne[s],p=wne[s];return d.top=a+r+h*(p-1)/2+8*p,d.left=n+o+c*(u-1)/2+8*u,d}switch(s){case"top":return d.top=r,d.left=l.width/2-c/2+o,d;case"right":return d.top=l.height/2-h/2+r,d.left=l.width-c/2+o,d;case"left":return d.top=l.height/2-h/2+r,d.left=o,d;case"bottom":return d.top=l.height-h+r,d.left=l.width/2-c/2+o,d;case"top-left":return d.top=r,d.left=o,d;case"top-right":return d.top=r,d.left=l.width-c+o,d;case"bottom-right":return d.top=l.height-h+r,d.left=l.width-c+o,d;case"bottom-left":return d.top=l.height-h+r,d.left=o,d}return d}};I([P],Sa.prototype,"enabled",2),I([P],Sa.prototype,"mode",2),I([P],Sa.prototype,"showArrow",2),I([P],Sa.prototype,"delay",2),I([P],Sa.prototype,"range",2),I([P],Sa.prototype,"wrapping",2),I([P],Sa.prototype,"position",2),I([P],Sa.prototype,"pagination",2),I([P],Sa.prototype,"darkTheme",2),I([P],Sa.prototype,"bounds",2);function YM(e,t){return e.series===t.series&&dn(e.datumIndex,t.datumIndex)}var Ine=class{constructor(){this.candidates=[]}get current(){return this.active}reset(){this.candidates.length=0,this.active=void 0}update(e,t){this.candidates=e;let i=t!=null?e.findIndex(s=>YM(s,t)):-1;return i===-1&&(i=0),this.active=e[i],{current:this.active,index:i,length:e.length}}next(){const{candidates:e,active:t}=this,i=t==null?-1:e.findIndex(n=>YM(n,t));if(i===-1)return;let s=i+1;return s>=e.length&&(s=0),this.active=e[s],{current:this.active,index:s,length:this.candidates.length}}},Tne=class extends wo{constructor(e){super(),this.chart=e,this.id=Hs(this),this.series=[],this.highlight={pendingHoverEvent:void 0,appliedHoverEvent:void 0,stashedHoverEvent:void 0},this.tooltip={lastHover:void 0},this.hoverDevice="pointer",this.previousInputDevice="keyboard",this.focus={sortedSeries:[],series:void 0,seriesIndex:0,datumIndex:0,datum:void 0},this.hoverScheduler=vee(()=>{if(!(!this.tooltip.lastHover&&!this.highlight.pendingHoverEvent)){if(this.chart.getUpdateType()<=5){this.hoverScheduler.schedule();return}this.highlight.pendingHoverEvent&&this.handleHoverHighlight(!1),this.tooltip.lastHover&&this.handleHoverTooltip(this.tooltip.lastHover,!1)}}),this.tooltipCandidates=new Ine;const t=e.ctx.domManager.addChild("series-area","series-area-aria-label1"),i=e.ctx.domManager.addChild("series-area","series-area-aria-label2");this.swapChain=new dne(t,i,"img"),this.swapChain.addListener("blur",r=>this.onBlur(r)),this.swapChain.addListener("focus",()=>this.onFocus()),e.ctx.domManager.mode==="normal"&&(this.focusIndicator=new hne(this.swapChain),this.focusIndicator.overrideFocusVisible(e.mode==="integrated"?!1:void 0));const{seriesDragInterpreter:s,seriesWidget:n,containerWidget:a}=e.ctx.widgets;n.setTabIndex(-1),this.destroyFns.push(()=>e.ctx.domManager.removeChild("series-area","series-area-aria-label1"),()=>e.ctx.domManager.removeChild("series-area","series-area-aria-label2"),n.addListener("focus",()=>this.swapChain.focus()),n.addListener("mousemove",r=>this.onHover(r)),n.addListener("wheel",r=>this.onWheel(r)),n.addListener("mouseleave",r=>this.onLeave(r)),n.addListener("keydown",r=>this.onKeyDown(r)),n.addListener("contextmenu",(r,o)=>this.onContextMenu(r,o)),s.addListener("drag-move",r=>this.onDragMove(r)),s.addListener("click",r=>this.onClick(r,n)),s.addListener("dblclick",r=>this.onClick(r,n)),a.addListener("contextmenu",(r,o)=>this.onContextMenu(r,o)),a.addListener("click",(r,o)=>this.onClick(r,o)),a.addListener("dblclick",(r,o)=>this.onClick(r,o)),e.ctx.animationManager.addListener("animation-start",()=>this.clearAll()),e.ctx.domManager.addListener("resize",()=>this.clearAll()),e.ctx.highlightManager.addListener("highlight-change",r=>this.changeHighlightDatum(r)),e.ctx.layoutManager.addListener("layout:complete",r=>this.layoutComplete(r)),e.ctx.updateService.addListener("pre-scene-render",()=>this.preSceneRender()),e.ctx.updateService.addListener("update-complete",()=>this.updateComplete()),e.ctx.zoomManager.addListener("zoom-change",()=>this.clearAll()),e.ctx.zoomManager.addListener("zoom-pan-start",()=>this.clearAll()))}get bbox(){var e;return((e=this.seriesRect)!=null?e:ve.zero).clone()}isState(e){return this.chart.ctx.interactionManager.isState(e)}isIgnoredTouch(e){return!(e.device!=="touch"||e.type==="click"||this.chart.ctx.chartService.touch.dragAction==="hover"||this.chart.ctx.chartService.touch.dragAction==="drag"&&this.isState(9))}dataChanged(){var t,i;var e;(t=(e=this.highlight).stashedHoverEvent)!=null||(e.stashedHoverEvent=this.highlight.appliedHoverEvent),this.chart.ctx.tooltipManager.removeTooltip(this.id),(i=this.focusIndicator)==null||i.clear(),this.clearHighlight()}preSceneRender(){this.highlight.stashedHoverEvent!=null&&(this.highlight.pendingHoverEvent=this.highlight.stashedHoverEvent,this.highlight.stashedHoverEvent=void 0,this.handleHoverHighlight(!0)),this.tooltip.lastHover!=null&&this.handleHoverTooltip(this.tooltip.lastHover,!0)}updateComplete(){var e;this.isState(34)&&((e=this.focusIndicator)!=null&&e.isFocusVisible())&&this.handleSeriesFocus(0,0,!0)}update(e,t){this.chart.ctx.updateService.update(e,t)}seriesChanged(e){this.focus.sortedSeries=[...e].sort((t,i)=>{var a,r;let s=(a=t.properties.focusPriority)!=null?a:1/0,n=(r=i.properties.focusPriority)!=null?r:1/0;return s===n&&([s,n]=[t._declarationOrder,i._declarationOrder]),s<n?-1:s>n?1:0}),this.series=e}layoutComplete(e){this.seriesRect=e.series.rect,this.hoverRect=e.series.paddedRect,this.chart.ctx.widgets.seriesWidget.setBounds(e.series.paddedRect),this.chart.ctx.domManager.mode==="normal"&&this.chart.ctx.widgets.chartWidget.setBounds(e.chart)}onContextMenu(e,t){var l;const{sourceEvent:i}=e;if(i.currentTarget!=t.getElement())return;if(i.target==this.chart.ctx.widgets.containerWidget.getElement()){if(this.isState(36)){const{currentX:c,currentY:h}=e;this.chart.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:e,canvasX:c,canvasY:h},void 0)}return}let s,n;if((l=this.focusIndicator)!=null&&l.isFocusVisible())s=this.chart.ctx.highlightManager.getActiveHighlight(),s&&this.seriesRect&&s.midPoint&&(n=ai.toCanvasPoint(s.series.contentGroup,s.midPoint.x,s.midPoint.y));else if(this.isState(36)){const c=this.pickNodes({x:e.currentX,y:e.currentY},"context-menu");c&&(this.chart.ctx.highlightManager.updateHighlight(this.id),s=c.matches[0].datum)}const a=s==null?void 0:s.series;this.clearAll();const r=e.currentX+t.cssLeft(),o=e.currentY+t.cssTop();a&&s?this.chart.ctx.contextMenuRegistry.dispatchContext("series-node",{widgetEvent:e,canvasX:r,canvasY:o},{pickedSeries:a,pickedNode:s},n):this.chart.ctx.contextMenuRegistry.dispatchContext("series-area",{widgetEvent:e,canvasX:r,canvasY:o},void 0,n)}onLeave(e){if(!this.isState(41))return;const t=e.sourceEvent.relatedTarget;(t==null?void 0:t.className)!=="ag-charts-text-input__textarea"&&(this.chart.ctx.tooltipManager.isEnteringInteractiveTooltip(e.sourceEvent)||(this.chart.ctx.domManager.updateCursor(this.id),this.hoverDevice!=="keyboard"&&this.clearAll()))}onWheel(e){var t;this.isState(41)&&((t=this.focusIndicator)==null||t.overrideFocusVisible(!1),this.previousInputDevice="pointer")}onDragMove(e){var t;this.isState(41)&&((t=this.focusIndicator)==null||t.overrideFocusVisible(!1),this.onHoverLikeEvent(e))}onHover(e){this.isState(41)&&this.onHoverLikeEvent(e)}onHoverLikeEvent(e){var t;if(!this.isIgnoredTouch(e)&&((e.device==="touch"||kne(e,"drag-move"))&&(this.tooltip.lastHover=e),e.device==="touch"&&this.chart.ctx.chartService.touch.dragAction==="hover"&&e.sourceEvent.preventDefault(),this.hoverDevice="pointer",this.previousInputDevice="pointer",this.highlight.pendingHoverEvent=e,this.hoverScheduler.schedule(),this.isState(32))){const{currentX:i,currentY:s}=e,n=(t=this.pickNodes({x:i,y:s},"event"))==null?void 0:t.matches,a=n==null?void 0:n[0];a!=null&&a.series.hasEventListener("seriesNodeClick")||a!=null&&a.series.hasEventListener("seriesNodeDoubleClick")||n!=null&&n.length>1&&this.chart.tooltip.pagination?this.chart.ctx.domManager.updateCursor(this.id,"pointer"):this.chart.ctx.domManager.updateCursor(this.id)}}onClick(e,t){var s;if(t===this.chart.ctx.widgets.seriesWidget&&this.chart.ctx.animationManager.isActive()&&this.chart.ctx.animationManager.skipCurrentBatch(),e.device==="touch"&&t===this.chart.ctx.widgets.seriesWidget&&this.swapChain.focus({preventScroll:!0}),!this.isState(41))return;if(t===this.chart.ctx.widgets.seriesWidget){if(!t.getElement().contains(e.sourceEvent.target))return}else if(e.sourceEvent.target!=t.getElement())return;if((s=this.focusIndicator)==null||s.overrideFocusVisible(!1),this.onHoverLikeEvent(e),!this.isState(32))return;if(t==this.chart.ctx.widgets.seriesWidget&&this.checkSeriesNodeClick(e)){this.update(5),e.sourceEvent.preventDefault();return}const i={type:e.type==="click"?"click":"doubleClick",event:e.sourceEvent};this.chart.fireEvent(i)}onFocus(){var e;this.isState(34)&&(this.hoverDevice=(e=this.focusIndicator)!=null&&e.isFocusVisible(!0)?"keyboard":"pointer",this.handleFocus(0,0))}onBlur(e){var t;this.isState(34)&&(this.hoverDevice="pointer",this.chart.ctx.tooltipManager.isEnteringInteractiveTooltip(e)||this.clearAll(),(t=this.focusIndicator)==null||t.overrideFocusVisible(void 0))}onKeyDown(e){var i;if(!this.isState(43))return;const t=gne(e.sourceEvent);switch((t==null?void 0:t.activatesFocusIndicator)===!1&&((i=this.focusIndicator)==null||i.overrideFocusVisible(this.previousInputDevice==="keyboard")),t==null?void 0:t.name){case"redo":return this.chart.ctx.chartEventManager.seriesEvent("series-redo");case"undo":return this.chart.ctx.chartEventManager.seriesEvent("series-undo");case"zoomin":return this.chart.ctx.chartEventManager.seriesKeyNavZoom(1,e);case"zoomout":return this.chart.ctx.chartEventManager.seriesKeyNavZoom(-1,e);case"arrowup":return this.onArrow(-1,0,e);case"arrowdown":return this.onArrow(1,0,e);case"arrowleft":return this.onArrow(0,-1,e);case"arrowright":return this.onArrow(0,1,e);case"submit":return this.onSubmit(e)}}onArrow(e,t,i){var s;this.isState(34)&&(this.hoverDevice="keyboard",this.previousInputDevice="keyboard",(s=this.focusIndicator)==null||s.overrideFocusVisible(!0),this.focus.seriesIndex+=e,this.focus.datumIndex+=t,this.handleFocus(e,t),i.sourceEvent.preventDefault(),this.chart.ctx.chartEventManager.seriesEvent("series-focus-change"))}onSubmit(e){if(!this.isState(34))return;const{series:t,datum:i}=this.focus,s=e.sourceEvent;t!==void 0&&i!==void 0?t.fireNodeClickEvent(s,i):this.chart.fireEvent({type:"click",event:s}),s.preventDefault()}checkSeriesNodeClick(e){var o,l,c,h,d,u;var t;const i=this.pickNodes({x:e.currentX,y:e.currentY},"event");if(i==null||i.matches.length===0)return;const s=this.chart.tooltip.pagination?(o=this.tooltipCandidates.update(i.matches,this.tooltipCandidates.current))==null?void 0:o.current:void 0,{series:n,datum:a}=s!=null?s:i.matches[0],r=s==null?i.distance:0;if(e.type==="click"){const g=n.fireNodeClickEvent(e.sourceEvent,a)&&this.chart.tooltip.pagination?this.tooltipCandidates.next():void 0;if(g!=null){e.sourceEvent.preventDefault();const{currentX:f,currentY:y}=e,v=f+((c=(l=this.hoverRect)==null?void 0:l.x)!=null?c:0),x=y+((d=(h=this.hoverRect)==null?void 0:h.y)!=null?d:0);(u=(t=this.highlight).pendingHoverEvent)!=null||(t.pendingHoverEvent=this.highlight.appliedHoverEvent),this.handleHoverHighlight(!1),this.showTooltip(g.current,v,x,{index:g.index,length:g.length})}return!0}return e.type==="dblclick"?(e.preventZoomDblClick=r===0,n.fireNodeDoubleClickEvent(e.sourceEvent,a),!0):!1}handleFocus(e,t){var s;const i=this.chart.overlays.getFocusInfo(this.chart.ctx.localeManager);i==null?this.handleSeriesFocus(e,t):(s=this.focusIndicator)==null||s.update(i.rect,this.seriesRect,!1)}handleSeriesFocus(e,t,i=!1){if(this.chart.chartType==="hierarchy"||this.chart.chartType==="gauge"){this.handleSoloSeriesFocus(e,t,i);return}const{focus:s}=this,n=s.sortedSeries.filter(c=>c.visible&&c.focusable);if(n.length===0)return;const a=s.datumIndex-t,r=s.seriesIndex-e;s.seriesIndex=we(0,s.seriesIndex,n.length-1),s.series=n[s.seriesIndex];const o=this.focus.datumIndex,l=this.focus.seriesIndex;this.updatePickedFocus(o,t,a,l,e,r,i)}handleSoloSeriesFocus(e,t,i){this.focus.series=this.focus.sortedSeries[0];const s=this.focus.datumIndex,n=this.focus.seriesIndex,a=this.focus.datumIndex-t,r=this.focus.seriesIndex-e;this.updatePickedFocus(s,t,a,n,e,r,i)}updatePickedFocus(e,t,i,s,n,a,r){var p,g,f,y,v,x,S;const{focus:o,hoverRect:l,seriesRect:c}=this;if(o.series===void 0||l===void 0)return;const h=(p=o==null?void 0:o.series)==null?void 0:p.pickFocus({datumIndex:e,datumIndexDelta:t,otherIndex:s,otherIndexDelta:n,seriesRect:c});if(!h)return;const{datum:d}=h;if(h.otherIndex!==void 0&&(o.seriesIndex=h.otherIndex),o.datumIndex=h.datumIndex,o.datum=d,(g=this.focusIndicator)!=null&&g.isFocusVisible()&&this.chart.ctx.animationManager.reset(),(f=this.focusIndicator)!=null&&f.isFocusVisible()){const M=mne(h),{x:D,y:A}=M.computeCenter();if(!l.containsPoint(D,A)&&this.chart.ctx.zoomManager.panToBBox(this.id,l,M))return;const{x1:w,x2:T,y1:k,y2:N}=Eg.from(M),O=l.containsPoint(w,k),L=l.containsPoint(T,k),F=l.containsPoint(w,N),B=l.containsPoint(T,N);if(!(O||L||F||B)){const _=Eg.from(l);h.movedBounds=M.clone(),w<_.x1&&T<_.x1?(h.movedBounds.x=_.x1-2,h.movedBounds.width=4):w>_.x2&&T>_.x2&&(h.movedBounds.x=_.x2-2,h.movedBounds.width=4),k<_.y1&&N<_.y1?(h.movedBounds.y=_.y1-2,h.movedBounds.height=4):k>_.y2&&N>_.y2&&(h.movedBounds.y=_.y2-2,h.movedBounds.height=4)}}(v=this.focusIndicator)==null||v.update((y=h.movedBounds)!=null?y:h.bounds,this.seriesRect,h.clipFocusBox);const u=yne(o.series,l,h);if(u!==void 0&&this.hoverDevice==="keyboard"){this.tooltip.lastHover=void 0,this.highlight.appliedHoverEvent=void 0,this.highlight.pendingHoverEvent=void 0,this.highlight.stashedHoverEvent=void 0;const M=this.chart.getTooltipContent(o.series,d.datumIndex,d),D=qy.makeTooltipMeta(u,o.series,d,h.movedBounds);this.chart.ctx.highlightManager.updateHighlight(this.id,d),((x=o.series.tooltipEnabled)!=null?x:this.chart.tooltip.enabled)?this.chart.ctx.tooltipManager.updateTooltip(this.id,D,M):this.chart.ctx.tooltipManager.removeTooltip(this.id),r||(t===0&&n===0||i!==h.datumIndex||a!==((S=h.otherIndex)!=null?S:o.seriesIndex))&&this.swapChain.update(this.getDatumAriaText(d,M))}}getDatumAriaText(e,t){var s,n,a;const i=t==null?"":A1(t);return this.chart.ctx.localeManager.t("ariaAnnounceHoverDatum",{datum:(a=(n=(s=e.series).getDatumAriaText)==null?void 0:n.call(s,e,i))!=null?a:i})}clearHighlight(){this.highlight.pendingHoverEvent=void 0,this.highlight.appliedHoverEvent=void 0,this.chart.ctx.highlightManager.updateHighlight(this.id)}clearTooltip(){this.chart.ctx.tooltipManager.removeTooltip(this.id),this.tooltip.lastHover=void 0}clearAll(){var e;this.clearHighlight(),this.clearTooltip(),(e=this.focusIndicator)==null||e.clear()}handleHoverHighlight(e){var u,p,g,f,y,v;this.highlight.appliedHoverEvent=this.highlight.pendingHoverEvent,this.highlight.pendingHoverEvent=void 0;const t=this.highlight.appliedHoverEvent;if(!t||!this.isState(41))return;const{currentX:i,currentY:s}=t,n=t.currentX+((p=(u=this.hoverRect)==null?void 0:u.x)!=null?p:0),a=t.currentY+((f=(g=this.hoverRect)==null?void 0:g.y)!=null?f:0);if(e?this.chart.ctx.animationManager.isActive():!((y=this.hoverRect)!=null&&y.containsPoint(n,a))){this.clearHighlight();return}const{range:r}=this.chart.highlight,o=r==="tooltip"?"highlight-tooltip":"highlight",l=this.pickNodes({x:i,y:s},o);if(!l||l.matches.length===0){this.chart.ctx.highlightManager.updateHighlight(this.id);return}const{current:c}=this.tooltipCandidates,h=c==null?void 0:l.matches.find(x=>YM(x,c)),d=(v=h==null?void 0:h.datum)!=null?v:l.matches[0].datum;this.chart.ctx.highlightManager.updateHighlight(this.id,d),this.hoverDevice="pointer"}handleHoverTooltip(e,t){var c,h,d,u,p;const{current:i}=this.tooltipCandidates;if(this.tooltipCandidates.reset(),!this.isState(41))return;const{currentX:s,currentY:n}=e,a=s+((h=(c=this.hoverRect)==null?void 0:c.x)!=null?h:0),r=n+((u=(d=this.hoverRect)==null?void 0:d.y)!=null?u:0),o=e.sourceEvent.target;if(t?this.chart.ctx.animationManager.isActive():!((p=this.hoverRect)!=null&&p.containsPoint(a,r))){this.hoverDevice=="pointer"&&this.clearTooltip();return}if(o&&this.chart.tooltip.interactive&&this.chart.ctx.domManager.isManagedChildDOMElement(o,"canvas-overlay",ps))return;const l=this.pickNodes({x:e.currentX,y:e.currentY},"tooltip");if(!l||l.matches.length===0){this.hoverDevice=="pointer"&&this.clearTooltip();return}if(this.hoverDevice="pointer",l.distance===0){const{current:g,index:f,length:y}=this.tooltipCandidates.update(l.matches,this.chart.tooltip.pagination?i:void 0);this.showTooltip(g,a,r,{index:f,length:y})}else this.showTooltip(l.matches[0],a,r)}showTooltip({series:e,datum:t,datumIndex:i},s,n,a){var c;const r=this.chart.getTooltipContent(e,i,t);if(((c=e.tooltipEnabled)!=null?c:this.chart.tooltip.enabled)&&r!=null){const h=qy.makeTooltipMeta({type:"pointermove",canvasX:s,canvasY:n},e,t,void 0);this.chart.ctx.tooltipManager.updateTooltip(this.id,h,r,a)}else this.chart.ctx.tooltipManager.removeTooltip(this.id)}changeHighlightDatum(e){var o,l;const t=new Set,{series:i=void 0,datum:s}=(o=e.currentHighlight)!=null?o:{},{series:n=void 0,datum:a}=(l=e.previousHighlight)!=null?l:{};n&&t.add(n),i&&t.add(i),n!=null&&n.properties.cursor&&a&&this.chart.ctx.domManager.updateCursor(n.id),i!=null&&i.properties.cursor&&(i==null?void 0:i.properties.cursor)!=="default"&&s&&this.chart.ctx.domManager.updateCursor(i.id,i.properties.cursor),i==null||n==null?this.update(5):this.update(5,{seriesToUpdate:t})}pickNodes(e,t,i){const s=[...this.series].reverse();let n;for(const a of s){if(!a.visible||!a.contentGroup.visible)continue;const r=a.pickNodes(e,t,i);if(r==null||r.datums.length===0)continue;const{datums:o,distance:l}=r;if(r.datums.length!==0){if(l===0){(n==null?void 0:n.distance)!==0&&(n={matches:[],distance:0});for(const c of o){const{datumIndex:h}=c;n.matches.push({series:a,datum:c,datumIndex:h})}}else if(n==null||n.distance>l){const[c]=o,{datumIndex:h}=c;n={matches:[{series:a,datum:c,datumIndex:h}],distance:l}}}}return n}};function kne(e,t){return e.type!==t}var P1=30,Lne=class{constructor(e){this.seriesRoot=e,this.groups=new Map,this.series=new Map,this.expectedSeriesCount=1,this.mode="normal"}setSeriesCount(e){this.expectedSeriesCount=e}requestGroup(e){var h;const{internalId:t,type:i,contentGroup:s,seriesGrouping:n}=e,{groupIndex:a=t}=n!=null?n:{},r=this.series.get(t);if(r!=null)throw new Error(`AG Charts - series already has an allocated layer: ${JSON.stringify(r)}`);this.series.size===0&&(this.mode=this.expectedSeriesCount>=P1?"aggressive-grouping":"normal");let o=this.groups.get(i);o==null&&(o=new Map,this.groups.set(i,o));const l=this.lookupIdx(a);let c=o.get(l);return c==null&&(c={type:i,id:l,seriesIds:[],group:this.seriesRoot.appendChild(new Ge({name:`${(h=e.contentGroup.name)!=null?h:i}-managed-layer`,zIndex:e.contentGroup.zIndex,renderToOffscreenCanvas:!1}))},o.set(l,c)),this.series.set(t,{layerState:c,seriesConfig:e}),c.seriesIds.push(t),c.group.appendChild(s),c.group}changeGroup(e){var o,l;const{internalId:t,seriesGrouping:i,type:s,contentGroup:n,oldGrouping:a}=e,{groupIndex:r=t}=i!=null?i:{};(l=(o=this.groups.get(s))==null?void 0:o.get(r))!=null&&l.seriesIds.includes(t)||(this.series.has(t)&&this.releaseGroup({internalId:t,seriesGrouping:a,type:s,contentGroup:n}),this.requestGroup(e))}releaseGroup(e){var a,r,o;const{internalId:t,contentGroup:i,type:s}=e;if(!this.series.has(t))throw new Error(`AG Charts - series doesn't have an allocated layer: ${t}`);const n=(a=this.series.get(t))==null?void 0:a.layerState;n&&(n.seriesIds=n.seriesIds.filter(l=>l!==t),n.group.removeChild(i)),(n==null?void 0:n.seriesIds.length)===0?(this.seriesRoot.removeChild(n.group),(r=this.groups.get(n.type))==null||r.delete(n.id),(o=this.groups.get(s))==null||o.delete(t)):n!=null&&n.seriesIds.length>0&&(n.group.zIndex=this.getLowestSeriesZIndex(n.seriesIds)),this.series.delete(t)}updateLayerCompositing(){this.groups.forEach(e=>{e.forEach(t=>{const{group:i,seriesIds:s}=t;let n;if(s.length===0)n=!1;else if(s.length>1)n=!0;else{const a=this.series.get(s[0]);n=(a==null?void 0:a.seriesConfig.renderToOffscreenCanvas())===!0}i.renderToOffscreenCanvas=n,i.zIndex=this.getLowestSeriesZIndex(s)})})}lookupIdx(e){return this.mode==="normal"?e:typeof e=="string"&&(e=Number(e.split("-").at(-1)),!e)?0:Math.floor(we(0,e/this.expectedSeriesCount,1)*P1)}destroy(){this.groups.forEach(e=>{e.forEach(t=>{this.seriesRoot.removeChild(t.group)})}),this.groups.clear(),this.series.clear()}getLowestSeriesZIndex(e){const t=e.reduce((i,s)=>{const n=this.series.get(s),a=n==null?void 0:n.seriesConfig.contentGroup.zIndex;return i==null||a==null?a:nR(i,a)<=0?i:a},void 0);return t!=null?t:1}},E1=class extends Be{constructor(){super(...arguments),this.dragAction="drag"}};I([P],E1.prototype,"dragAction",2);var Pne=class{constructor(e,t,i,s,n){this.chart=e,this.dataService=t,this.updateService=i,this.zoomManager=s,this.animationManager=n,this.dirtyZoom=!1,this.dirtyDataSource=!1,this.lastAxisZooms=new Map,this.destroyFns=[],this.destroyFns.push(this.dataService.addListener("data-source-change",()=>this.onDataSourceChange()),this.dataService.addListener("data-load",()=>this.onDataLoad()),this.dataService.addListener("data-error",()=>this.onDataError()),this.updateService.addListener("update-complete",a=>this.onUpdateComplete(a)),this.zoomManager.addListener("zoom-change",()=>this.onZoomChange()))}destroy(){this.destroyFns.forEach(e=>e())}onDataLoad(){this.animationManager.skip(),this.updateService.update(1)}onDataError(){this.updateService.update(4)}onDataSourceChange(){this.dirtyDataSource=!0}onUpdateComplete(e){!e.apiUpdate&&!this.dirtyZoom&&!this.dirtyDataSource||this.updateWindow(e)}onZoomChange(){this.dirtyZoom=!0}updateWindow(e){if(!this.dataService.isLazy())return;const t=this.getValidAxis();let i,s=!0;if(t){const n=this.zoomManager.getAxisZoom(t.id);i=this.getAxisWindow(t,n),s=this.shouldRefresh(e,t,n)}this.dirtyZoom=!1,this.dirtyDataSource=!1,s&&this.dataService.load({windowStart:i==null?void 0:i.min,windowEnd:i==null?void 0:i.max})}getValidAxis(){return this.chart.axes.find(e=>e.type==="time")}shouldRefresh(e,t,i){if(e.apiUpdate||this.dirtyDataSource)return!0;if(!this.dirtyZoom)return!1;const s=this.lastAxisZooms.get(t.id);return s&&i.min===s.min&&i.max===s.max?!1:(this.lastAxisZooms.set(t.id,i),!0)}getAxisWindow(e,t){const{domain:i}=e.scale;if(!t||i.length===0||isNaN(Number(i[0])))return;const s=Number(i[1])-Number(i[0]),n=new Date(Number(i[0])+s*t.min),a=new Date(Number(i[0])+s*t.max);return{min:n,max:a}}},Ene=/^((?!chrome|android).)*safari/i,Rne=/Version\/(\d+(\.\d+)?)/,Nne=/Chrome/,One=/Chrome\/(\d+)/,Fne=/Edg/,Bne=/OPR/;function _ne(){const{userAgent:e}=Ct("navigator");if(Ene.test(e)){const t=Rne.exec(e);if(t==null)return!1;const i=parseFloat(t[1]),s=Math.floor(i)>16;return s||se.warnOnce(`Unsupported Safari version: ${i}; ${e}`),!s}else if(Nne.test(e)&&!Fne.test(e)&&!Bne.test(e)){const t=One.exec(e);if(t==null)return!1;const i=parseInt(t[1],10),s=i>126;return s||se.warnOnce(`Unsupported Chrome version: ${i}; ${e}`),!s}return!1}var Gne=new Set(["map-shape-background","map-line-background"]),zne=class{constructor(e,t,i,s,n,a,r){this.chartLike=e,this.overlays=t,this.dataService=i,this.layoutManager=s,this.localeManager=n,this.animationManager=a,this.domManager=r,this.destroyFns=[],this.overlayElem=this.domManager.addChild("canvas-overlay","overlay"),this.overlayElem.role="status",this.overlayElem.ariaAtomic="false",this.overlayElem.ariaLive="polite",this.overlayElem.classList.toggle(WM),this.destroyFns.push(this.layoutManager.addListener("layout:complete",o=>this.onLayoutComplete(o)))}destroy(){this.destroyFns.forEach(e=>e()),this.domManager.removeChild("canvas-overlay","overlay")}onLayoutComplete({series:{rect:e}}){const t=this.dataService.isLoading(),i=this.chartLike.series.some(c=>c.hasData),s=this.chartLike.series.some(c=>c.visible&&!Gne.has(c.type));this.overlays.darkTheme?this.overlayElem.classList.add(g1):this.overlayElem.classList.remove(g1),this.overlayElem.style.left=`${e.x}px`,this.overlayElem.style.top=`${e.y}px`,this.overlayElem.style.width=`${e.width}px`,this.overlayElem.style.height=`${e.height}px`;const n=t,a=!t&&!i,r=i&&!s,o=this.overlays.unsupportedBrowser.enabled&&_ne();n?this.showOverlay(this.overlays.loading,e):this.hideOverlay(this.overlays.loading),a?this.showOverlay(this.overlays.noData,e):this.hideOverlay(this.overlays.noData),r?this.showOverlay(this.overlays.noVisibleSeries,e):this.hideOverlay(this.overlays.noVisibleSeries),o?this.showOverlay(this.overlays.unsupportedBrowser,e):this.hideOverlay(this.overlays.unsupportedBrowser);const l=n||a||r||o;$e(this.overlayElem,"aria-hidden",!l)}showOverlay(e,t){if(!e.enabled)return;const i=e.getElement(this.animationManager,this.localeManager,t);this.overlayElem.appendChild(i)}hideOverlay(e){e.removeElement(()=>{this.overlayElem.innerText="\xA0"},this.animationManager)}},Ja=ct.create(!0,"opts"),XM=class extends Be{constructor(){super(...arguments),this.padding=new El(0)}};I([P],XM.prototype,"clip",2),I([P],XM.prototype,"padding",2);var oi=class Ej extends uR{constructor(t,i){var h,d,u,p,g;var s;super(),this.id=Hs(this),this.seriesRoot=new ds({name:`${this.id}-series-root`,zIndex:5}),this.annotationRoot=new ds({name:`${this.id}-annotation-root`,zIndex:9}),this.titleGroup=new Ge({name:"titles",zIndex:13}),this.debug=ct.create(),this.extraDebugStats={},this.data=[],this._firstAutoSize=!0,this._autoSizeNotify=new o0,this.padding=new El(20),this.seriesArea=new XM,this.keyboard=new CM,this.touch=new E1,this.mode="standalone",this.chartCaptions=new zy,this.suppressFieldDotNotation=!1,this.loadGoogleFonts=!1,this.destroyed=!1,this._destroyFns=[],this.chartAnimationPhase="initial",this.modulesManager=new rne,this.processors=[],this.queuedUserOptions=[],this.queuedChartOptions=[],this.firstApply=!0,this.syncStatus="init",this.apiUpdate=!1,this._pendingFactoryUpdatesCount=0,this._performUpdateSkipAnimations=!1,this._performUpdateNotify=new o0,this.performUpdateType=8,this.runningUpdateType=8,this.updateShortcutCount=0,this.seriesToUpdate=new Set,this.updateMutex=new mee,this.updateRequestors={},this.performUpdateTrigger=bee(({count:f})=>{this.destroyed||this.updateMutex.acquire(async()=>{try{await this.performUpdate(f)}catch(y){se.error("update error",y)}}).catch(y=>se.errorOnce(y))}),this._performUpdateSplits={},this.axes=[],this.series=[],this._cachedData=void 0,this.onSeriesNodeClick=f=>{this.fireEvent(f)},this.onSeriesNodeDoubleClick=f=>{this.fireEvent(f)},this.onSeriesVisibilityChange=f=>{this.fireEvent(f)},this.seriesGroupingChanged=f=>{if(!(f instanceof UM))return;const{series:y,seriesGrouping:v,oldGrouping:x}=f;y.contentGroup.isRoot()||this.seriesLayerManager.changeGroup({internalId:y.internalId,type:y.type,contentGroup:y.contentGroup,renderToOffscreenCanvas:()=>y.renderToOffscreenCanvas(),seriesGrouping:v,oldGrouping:x})},this.chartOptions=t;const n=i==null?void 0:i.scene,a=(d=(h=i==null?void 0:i.container)!=null?h:t.processedOptions.container)!=null?d:void 0,r=(u=i==null?void 0:i.styleContainer)!=null?u:t.specialOverrides.styleContainer;n&&(this._firstAutoSize=!1,this._lastAutoSize=[n.width,n.height,n.pixelRatio]);const o=new Ge({name:"root"});o.visible=!1,o.append(this.seriesRoot),o.append(this.annotationRoot),o.append(this.titleGroup),this.titleGroup.append(this.title.node),this.titleGroup.append(this.subtitle.node),this.titleGroup.append(this.footnote.node),this.tooltip=new Sa,this.seriesLayerManager=new Lne(this.seriesRoot),this.mode=(p=t.userOptions.mode)!=null?p:this.mode,this.styleNonce=t.processedOptions.styleNonce;const l=this.ctx=new Hie(this,{chartType:this.getChartType(),scene:n,root:o,container:a,styleContainer:r,domMode:t.optionMetadata.domMode,syncManager:new fse(this),fireEvent:f=>this.fireEvent(f),updateCallback:(f,y)=>this.update(f,y),updateMutex:this.updateMutex});this._destroyFns.push(l.domManager.addListener("resize",()=>this.parentResize(l.domManager.containerSize))),this.overlays=new xu,(g=(s=this.overlays.loading).renderer)!=null||(s.renderer=()=>one(this.overlays.loading.getText(l.localeManager),l.animationManager.defaultDuration)),this.processors=[new Pne(this,l.dataService,l.updateService,l.zoomManager,l.animationManager),new zne(this,this.overlays,l.dataService,l.layoutManager,l.localeManager,l.animationManager,l.domManager)],this.highlight=new PN,this.container=a;const c=this.getModuleContext();l.domManager.setDataBoolean("animating",!1),this.seriesAreaManager=new Tne(this.initSeriesAreaDependencies()),this._destroyFns.push(l.layoutManager.registerElement(0,f=>{f.layoutBox.shrink(this.padding.toJson()),this.chartCaptions.positionCaptions(f)}),l.layoutManager.addListener("layout:complete",f=>this.chartCaptions.positionAbsoluteCaptions(f)),l.dataService.addListener("data-load",f=>{this.data=f.data}),this.title.registerInteraction(c,"beforebegin"),this.subtitle.registerInteraction(c,"beforebegin"),this.footnote.registerInteraction(c,"afterend"),Er.addWindowEvent("page-left",()=>this.destroy()),l.animationManager.addListener("animation-frame",()=>{this.update(7)}),l.animationManager.addListener("animation-start",()=>l.domManager.setDataBoolean("animating",!0)),l.animationManager.addListener("animation-stop",()=>l.domManager.setDataBoolean("animating",!1)),l.zoomManager.addListener("zoom-change",()=>{this.series.forEach(y=>{var v;return(v=y.animationState)==null?void 0:v.transition("updateData")});const f=this.chartAnimationPhase!=="initial";this.update(4,{forceNodeDataRefresh:!0,skipAnimations:f})})),this.parentResize(l.domManager.containerSize)}static getInstance(t){return Ej.chartsInstances.get(t)}get canvasElement(){return this.ctx.scene.canvas.element}download(t,i){this.ctx.scene.download(t,i)}getCanvasDataURL(t){return this.ctx.scene.getDataURL(t)}toSVG(){return this.ctx.scene.toSVG()}get seriesAreaBoundingBox(){return this.seriesAreaManager.bbox}getOptions(){var t;return(t=this.queuedUserOptions.at(-1))!=null?t:this.chartOptions.userOptions}getChartOptions(){var t;return(t=this.queuedChartOptions.at(-1))!=null?t:this.chartOptions}overrideFocusVisible(t){var i;(i=this.seriesAreaManager.focusIndicator)==null||i.overrideFocusVisible(t)}initSeriesAreaDependencies(){const{ctx:t,tooltip:i,highlight:s,overlays:n,seriesRoot:a,mode:r}=this,o=this.getChartType();return{fireEvent:this.fireEvent.bind(this),getUpdateType:()=>this.performUpdateType,getTooltipContent:(d,u,p)=>this.getTooltipContent(d,u,p),chartType:o,ctx:t,tooltip:i,highlight:s,overlays:n,seriesRoot:a,mode:r}}getModuleContext(){return this.ctx}getTooltipContent(t,i,s){const n=t.properties.tooltip.enabled!==!1?t.getTooltipContent(i,s):void 0,a=n==null?[]:[n];if(this.tooltip.mode!=="shared"||this.series.length===1)return a;const r=t.getCategoryValue(i);return r==null?a:this.series.flatMap(o=>{if(o===t)return a;if(!o.isEnabled()||o.properties.tooltip.enabled===!1)return[];const l=o.datumIndexForCategoryValue(r),c=l==null?void 0:o.getTooltipContent(l,void 0);return c==null?[]:[c]})}getCaptionText(){return[this.title,this.subtitle,this.footnote].filter(t=>t.enabled&&t.text).map(t=>t.text).join(". ")}getAriaLabel(){return this.ctx.localeManager.t("ariaAnnounceChart",{seriesCount:this.series.length})}resetAnimations(){this.chartAnimationPhase="initial";for(const t of this.series)t.resetAnimation(this.chartAnimationPhase);for(const t of this.axes)t.resetAnimation(this.chartAnimationPhase);this.animationRect=void 0,this.ctx.animationManager.reset()}skipAnimations(){this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0}detachAndClear(){this.container=void 0,this.ctx.scene.clearCanvas()}destroy(t){if(this.destroyed)return;const i=t==null?void 0:t.keepTransferableResources;let s;return this.performUpdateType=8,this._destroyFns.forEach(n=>n()),this.processors.forEach(n=>n.destroy()),this.overlays.destroy(),this.modulesManager.destroy(),i?(this.ctx.scene.strip(),s={container:this.container,scene:this.ctx.scene}):(this.ctx.scene.destroy(),this.container=void 0),this.destroySeries(this.series),this.seriesLayerManager.destroy(),this.axes.forEach(n=>n.destroy()),this.axes=[],this.animationRect=void 0,this.ctx.destroy(),this.destroyed=!0,Object.freeze(this),s}requestFactoryUpdate(t){this.destroyed||(this._pendingFactoryUpdatesCount++,this.updateMutex.acquire(async()=>{if(!this.destroyed)try{await t(this)}finally{this.destroyed||this._pendingFactoryUpdatesCount--}}).catch(i=>se.errorOnce(i)))}clearCallbackCache(){this.ctx.callbackCache.invalidateCache();for(const t of this.series)t.resetDatumCallbackCache()}update(t=0,i){var l;if(this.destroyed)return;const{forceNodeDataRefresh:s=!1,skipAnimations:n,seriesToUpdate:a=this.series,newAnimationBatch:r,apiUpdate:o=!1}=i!=null?i:{};this.apiUpdate=o,this.ctx.widgets.seriesWidget.setDragTouchEnabled(this.touch.dragAction!=="none"),s&&this.series.forEach(c=>c.markNodeDataDirty());for(const c of a)this.seriesToUpdate.add(c);if(n&&(this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0),r&&this.ctx.animationManager.isActive()&&(this._performUpdateSkipAnimations=!0),this.debug.check()){let c=(l=new Error().stack)!=null?l:"<unknown>";c=c.replace(/\([^)]*/g,""),this.updateRequestors[c]=t}t<this.performUpdateType&&(this.performUpdateType=t,this.ctx.domManager.setDataBoolean("updatePending",!0),this.performUpdateTrigger.schedule(i==null?void 0:i.backOffMs))}async performUpdate(t){var h;const{performUpdateType:i,extraDebugStats:s,_performUpdateSplits:n,ctx:a}=this,r=[...this.seriesToUpdate];this.clearCallbackCache(),this.performUpdateType=8,this.seriesToUpdate.clear(),this.runningUpdateType=i,this.updateShortcutCount===0&&i<7&&(a.animationManager.startBatch(this._performUpdateSkipAnimations),a.animationManager.onBatchStop(()=>this.chartAnimationPhase="ready")),this.ctx.scene.updateDebugFlags(),this.debug("Chart.performUpdate() - start",Ag[i]);let o=performance.now();(h=n.start)!=null||(n.start=o);const l=d=>{var u;(u=n[d])!=null||(n[d]=0),n[d]+=performance.now()-o,o=performance.now()};switch(i){case 0:if(this.checkUpdateShortcut(0))break;this.ctx.updateService.dispatchPreDomUpdate(),this.updateDOM();case 1:if(this.checkUpdateShortcut(1))break;await this.updateData(),l("\u2B07\uFE0F");case 2:if(this.checkUpdateShortcut(2))break;await this.processData(),this.seriesAreaManager.dataChanged(),l("\u{1F3ED}");case 3:if(this.checkUpdateShortcut(3))break;await this.processDomains(),l("\u26F0\uFE0F");case 4:if(await this.checkFirstAutoSize(),this.checkUpdateShortcut(4))break;await this.processLayout(),l("\u2316");case 5:{if(this.checkUpdateShortcut(5))break;await this.updateSeries(r),l("\u{1F914}"),this.updateAriaLabels(),this.seriesLayerManager.updateLayerCompositing()}case 6:if(this.checkUpdateShortcut(6))break;a.updateService.dispatchPreSceneRender(),l("\u2196");case 7:if(this.checkUpdateShortcut(7))break;a.animationManager.endBatch(),s.updateShortcutCount=this.updateShortcutCount,a.scene.render({debugSplitTimes:n,extraDebugStats:s,seriesRect:this.seriesRect}),this.extraDebugStats={};for(const d of Object.keys(n))delete n[d];this.ctx.domManager.incrementDataCounter("sceneRenders"),this.ctx.domManager.postRenderUpdate();case 8:this.updateShortcutCount=0,this.updateRequestors={},this._performUpdateSkipAnimations=!1,a.animationManager.endBatch()}this.destroyed||(a.updateService.dispatchUpdateComplete(this.apiUpdate),this.apiUpdate=!1,this.ctx.domManager.setDataBoolean("updatePending",!1),this.runningUpdateType=8,this.syncStatus="ready"),this._performUpdateNotify.notify();const c=performance.now();this.debug("Chart.performUpdate() - end",{chart:this,durationMs:Math.round((c-n.start)*100)/100,count:t,performUpdateType:Ag[i]})}updateThemeClassName(){const t="ag-charts-theme-",i=[`${t}default`,`${t}default-dark`];let s=i[0],n=!1,{theme:a}=this.chartOptions.processedOptions;for(;typeof a!="string"&&a!=null;)a=a.baseTheme;typeof a=="string"&&(s=a.replace("ag-",t),n=a.includes("-dark")),i.includes(s)||(s=n?i[1]:i[0]),this.ctx.domManager.setThemeClass(s)}updateDOM(){this.updateThemeClassName();const{enabled:t,tabIndex:i}=this.keyboard;this.ctx.domManager.setTabGuardIndex(t?i!=null?i:0:-1),this.ctx.domManager.setThemeParameters(this.chartOptions.themeParameters)}updateAriaLabels(){this.ctx.domManager.updateCanvasLabel(this.getAriaLabel())}checkUpdateShortcut(t){return this.destroyed?!0:this.updateShortcutCount>3?(se.warn("exceeded the maximum number of simultaneous updates (4), discarding changes and rendering",this.updateRequestors),!1):this.performUpdateType<=t?(this.updateShortcutCount++,!0):!1}async checkFirstAutoSize(){this.width!=null&&this.height!=null||this._lastAutoSize||await this._autoSizeNotify.await(500)||this.debug("Chart.checkFirstAutoSize() - timeout for first size update.")}onAxisChange(t,i){i==null&&t.length===0||this.ctx.axisManager.updateAxes(i!=null?i:[],t)}onSeriesChange(t,i){var n,a,r;const s=(n=i==null?void 0:i.filter(o=>!t.includes(o)))!=null?n:[];this.destroySeries(s),(a=this.seriesLayerManager)==null||a.setSeriesCount(t.length);for(const o of t){if(i!=null&&i.includes(o))continue;const l=this.seriesLayerManager.requestGroup(o);o.attachSeries(l,this.seriesRoot,this.annotationRoot);const c=this;o.chart={get mode(){return c.mode},get isMiniChart(){return!1},get seriesRect(){return c.seriesRect}},o.resetAnimation(this.chartAnimationPhase),this.addSeriesListeners(o),o.addChartEventListeners()}(r=this.seriesAreaManager)==null||r.seriesChanged(t)}destroySeries(t){t==null||t.forEach(i=>{i.removeEventListener("seriesNodeClick",this.onSeriesNodeClick),i.removeEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),i.removeEventListener("groupingChanged",this.seriesGroupingChanged),i.destroy(),this.seriesLayerManager.releaseGroup(i),i.detachSeries(void 0,this.seriesRoot,this.annotationRoot),i.chart=void 0})}addSeriesListeners(t){this.hasEventListener("seriesNodeClick")&&t.addEventListener("seriesNodeClick",this.onSeriesNodeClick),this.hasEventListener("seriesNodeDoubleClick")&&t.addEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),this.hasEventListener("seriesVisibilityChange")&&t.addEventListener("seriesVisibilityChange",this.onSeriesVisibilityChange),t.addEventListener("groupingChanged",this.seriesGroupingChanged)}assignSeriesToAxes(){for(const t of this.axes)t.boundSeries=this.series.filter(i=>i.axes[t.direction]===t)}assignAxesToSeries(){const t=r0(this.axes,i=>i.direction);for(const i of this.series)for(const s of i.directions){const n=t[s];if(!n){se.warnOnce(`no available axis for direction [${s}]; check series and axes configuration.`);return}const a=i.getKeys(s),r=n.find(o=>!o.keys.length||a.some(l=>o.keys.includes(l)));if(!r){se.warnOnce(`no matching axis for direction [${s}] and keys [${a}]; check series and axes configuration.`);return}i.axes[s]=r}}parentResize(t){var l;if(t==null||this.width!=null&&this.height!=null)return;let{width:i,height:s}=t;const{pixelRatio:n}=t;if(i=Math.floor(i),s=Math.floor(s),i===0&&s===0)return;const[a=0,r=0,o=1]=(l=this._lastAutoSize)!=null?l:[];a===i&&r===s&&o===n||(this._lastAutoSize=[i,s,n],this.resize("SizeMonitor",{}))}resize(t,i){var p,g,f,y,v,x;const{scene:s,animationManager:n}=this.ctx,{inWidth:a,inHeight:r,inMinWidth:o,inMinHeight:l,inOverrideDevicePixelRatio:c}=i;this.ctx.domManager.setSizeOptions(o!=null?o:this.minWidth,l!=null?l:this.minHeight,a!=null?a:this.width,r!=null?r:this.height);const h=(g=a!=null?a:this.width)!=null?g:(p=this._lastAutoSize)==null?void 0:p[0],d=(y=r!=null?r:this.height)!=null?y:(f=this._lastAutoSize)==null?void 0:f[1],u=(x=c!=null?c:this.overrideDevicePixelRatio)!=null?x:(v=this._lastAutoSize)==null?void 0:v[2];if(this.debug(`Chart.resize() from ${t}`,{width:h,height:d,pixelRatio:u,stack:new Error().stack}),!(h==null||d==null||!Xe(h)||!Xe(d))&&s.resize(h,d,u)){n.reset();let S=!0;(this.width==null||this.height==null)&&this._firstAutoSize&&(S=!1,this._firstAutoSize=!1),this.update(4,{forceNodeDataRefresh:!0,skipAnimations:S}),this._autoSizeNotify.notify()}}async updateData(){this.series.forEach(i=>i.setChartData(this.data));const t=this.modulesManager.mapModules(i=>{var s;return(s=i.updateData)==null?void 0:s.call(i,this.data)});await Promise.all(t)}async processData(){this.series.some(n=>n.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes());const t=new BN(this.mode,this.suppressFieldDotNotation),i=this.series.map(n=>n.processData(t)),s=this.modulesManager.mapModules(n=>{var a;return(a=n.processData)==null?void 0:a.call(n,t)});this._cachedData=t.execute(this._cachedData),await Promise.all([...i,...s]),this.updateLegends()}async processDomains(){for(const t of this.axes)t.processData();for(const t of this.series)t.updatedDomains()}updateLegends(t){for(const{legend:i,legendType:s}of this.modulesManager.legends())s==="category"?this.setCategoryLegendData(t):this.setLegendData(s,i)}setCategoryLegendData(t){var r,o;var i;const{ctx:{legendManager:s,stateManager:n}}=this;t&&this.series.forEach(l=>{const c=t.find(h=>h.seriesId===l.id);l.onLegendInitialState("category",c)});const a=this.series.flatMap(l=>{const c=l.getLegendData("category");return s.updateData(l.id,c),c});if(t){n.setStateAndRestore(s,t);return}if(this.mode!=="integrated"){const l={},c=new Map(this.series.map(h=>[h.id,h.type]));for(const{seriesId:h,symbol:{marker:d},label:u}of a.filter(p=>!p.hideInLegend)){if(d.fill==null)continue;const p=c.get(h),g=(r=l[p])!=null?r:l[p]={};(o=g[i=u.text])!=null||(g[i]=d.fill),g[u.text]!==d.fill&&se.warnOnce(`legend item '${u.text}' has multiple fill colors, this may cause unexpected behaviour.`)}}s.update()}setLegendData(t,i){i.data=this.series.filter(s=>s.properties.showInLegend).flatMap(s=>s.getLegendData(t))}async processLayout(){var a;const t=this.animationRect,{width:i,height:s}=this.ctx.scene,n=this.ctx.layoutManager.createContext(i,s);await this.performLayout(n),t&&!((a=this.animationRect)!=null&&a.equals(t))&&this.ctx.animationManager.skipCurrentBatch(),this.debug("Chart.performUpdate() - seriesRect",this.seriesRect)}async updateSeries(t){const{seriesRect:i}=this;await Promise.all(t.map(s=>s.update({seriesRect:i}))),this.ctx.seriesLabelLayoutManager.updateLabels(this.series.filter(s=>s.visible&&s.usesPlacedLabels),this.padding,this.seriesRect)}async waitForUpdate(t=1e4,i=!1){const s=performance.now();for(;(this._pendingFactoryUpdatesCount>0||this.performUpdateType!==8||this.runningUpdateType!==8||this.ctx.scene.waitingForUpdate())&&!this.destroyed;){if(this._pendingFactoryUpdatesCount>0&&await this.updateMutex.waitForClearAcquireQueue(),(this.performUpdateType!==8||this.runningUpdateType!==8)&&await this._performUpdateNotify.await(),performance.now()-s>t){const n=`Chart.waitForUpdate() timeout of ${t} reached - first chart update taking too long.`;if(i)throw new Error(n);se.warnOnce(n)}rR()&&await fE(),this.ctx.scene.waitingForUpdate()&&await fE(50)}}filterMiniChartSeries(t){return t==null?void 0:t.filter(i=>i.showInMiniChart!==!1)}applyOptions(t){var f,y,v,x,S,M;const i=this.firstApply?t.processedOptions:t.diffOptions(this.chartOptions);if(i==null||Object.keys(i).length===0)return;const s=this.firstApply?{}:this.chartOptions.processedOptions,n=t.processedOptions;Ja("Chart.applyOptions() - applying delta",i);const a=this.applyModules(n),r=["type","data","series","listeners","preset","theme","legend.listeners","navigator.miniChart.series","navigator.miniChart.label","locale.localeText","axes","topology","nodes","initialState","styleContainer"];i.listeners&&this.registerListeners(this,i.listeners),Sg(this,i,{skip:r});let o=!1,l="no-op";i.series!=null&&(l=this.applySeries(this,i.series,s==null?void 0:s.series),o=!0),l==="replaced"&&this.resetAnimations(),this.applyAxes(this,n,s,l,[])&&(o=!0),i.data&&(this.data=i.data),(f=i.legend)!=null&&f.listeners&&this.modulesManager.isEnabled("legend")&&Object.assign(this.legend.listeners,i.legend.listeners),(y=i.locale)!=null&&y.localeText&&(this.modulesManager.getModule("locale").localeText=(v=i.locale)==null?void 0:v.localeText),this.chartOptions=t;const c=this.modulesManager.getModule("navigator"),h=this.modulesManager.getModule("zoom");!(c!=null&&c.enabled)&&!(h!=null&&h.enabled)&&this.ctx.zoomManager.updateZoom("chart");const d=c==null?void 0:c.miniChart,u=(M=(S=(x=n.navigator)==null?void 0:x.miniChart)==null?void 0:S.series)!=null?M:n.series;(d==null?void 0:d.enabled)===!0&&u!=null?this.applyMiniChartOptions(d,u,n,s):(d==null?void 0:d.enabled)===!1&&(d.series=[],d.axes=[]),this.ctx.annotationManager.setAnnotationStyles(t.annotationThemes),o||(o=this.shouldForceNodeDataRefresh(i,l));const g=o||a?0:4;this.maybeResetAnimations(l),this.shouldClearLegendData(n,s,l)&&this.ctx.legendManager.clearData(),this.applyInitialState(n),Ja("Chart.applyOptions() - update type",Ag[g],{seriesStatus:l,forceNodeDataRefresh:o}),this.update(g,{apiUpdate:!0,forceNodeDataRefresh:o,newAnimationBatch:!0}),this.firstApply=!1}applyInitialState(t){var l,c,h;const{annotationManager:i,chartTypeOriginator:s,historyManager:n,stateManager:a,zoomManager:r}=this.ctx,{initialState:o}=t;if("annotations"in t&&((l=t.annotations)!=null&&l.enabled)&&(o==null?void 0:o.annotations)!=null){const d=o.annotations.map(u=>{const p=i.getAnnotationTypeStyles(u.type);return Je(u,p)});a.setState(i,d)}(o==null?void 0:o.chartType)!=null&&a.setState(s,o.chartType),((c=t.navigator)!=null&&c.enabled||(h=t.zoom)!=null&&h.enabled)&&(o==null?void 0:o.zoom)!=null&&a.setState(r,o.zoom),(o==null?void 0:o.legend)!=null&&this.updateLegends(o.legend),o!=null&&n.clear()}maybeResetAnimations(t){if(this.mode==="standalone")switch(t){case"series-grouping-change":case"replaced":this.resetAnimations();break;default:}}shouldForceNodeDataRefresh(t,i){const s=!!t.data||i==="data-change"||i==="replaced",n=vM.getKeys(),a=Object.values(n).some(o=>t[o]!=null),r=t.title!=null&&t.subtitle!=null;return s||a||r}shouldClearLegendData(t,i,s){var r,o,l;const n=s==="replaced"||s==="series-grouping-change"||s==="updated"&&(((r=t.series)==null?void 0:r.length)!==((o=i.series)==null?void 0:o.length)||!((l=t.series)!=null&&l.every((c,h)=>{var d;return c.type===((d=i.series)==null?void 0:d[h].type)}))),a=i.legend!=null&&t.legend==null;return n||a}applyMiniChartOptions(t,i,s,n){var h,d,u,p,g;const a=(u=(d=(h=n==null?void 0:n.navigator)==null?void 0:h.miniChart)==null?void 0:d.series)!=null?u:n==null?void 0:n.series,r=this.applySeries(t,this.filterMiniChartSeries(i),this.filterMiniChartSeries(a));this.applyAxes(t,s,n,r,["axes[].tick","axes[].thickness","axes[].title","axes[].crosshair","axes[].gridLine","axes[].label"]);const o=t.series;for(const f of o)f.properties.id=void 0;const l=t.axes,c=l.find(f=>f.direction==="x");for(const f of l)f.nice=!1,f.gridLine.enabled=!1,f.label.enabled=f===c,f.tick.enabled=!1,f.interactionEnabled=!1;if(c!=null){const f=(p=s.navigator)==null?void 0:p.miniChart,y=f==null?void 0:f.label,v=(g=f==null?void 0:f.label)==null?void 0:g.interval;if(c.line.enabled=!1,c.label.set(be(y,["interval","rotation","minSpacing","autoRotate","autoRotateAngle"])),c.tick.set(be(v,["enabled","width","size","color","interval","step"])),c.type==="grouped-category"){c.label.enabled=!1,c.label.rotation=0;const{depthOptions:S}=c;if(S.length===0)S.set([{label:{enabled:!0}}]);else for(let M=1;M<S.length;M++)S[M].label.enabled=!1}else(c.type==="time"||c.type==="unit-time"||c.type==="ordinal-time")&&(c.parentLevel.enabled=!1);const x=v==null?void 0:v.step;x!=null&&(c.interval.step=x)}}applyModules(t){var n;const{type:i}=this.constructor;let s=!1;for(const a of kr.byType("root","legend")){const o=t[a.optionsKey]!=null&&a.chartTypes.includes(i);o!==this.modulesManager.isEnabled(a)&&(o?(this.modulesManager.addModule(a,l=>l.moduleFactory(this.getModuleContext())),a.type==="legend"&&((n=this.modulesManager.getModule(a))==null||n.attachLegend(this.ctx.scene)),this[a.optionsKey]=this.modulesManager.getModule(a)):(this.modulesManager.removeModule(a),delete this[a.optionsKey]),s=!0)}return s}initSeriesDeclarationOrder(t){for(let i=0;i<t.length;i++)t[i].setSeriesIndex(i)}applySeries(t,i,s){var h;if(!i)return"no-change";const n=nne(t.series,i,s);if(n.status==="no-overlap"){Ja(`Chart.applySeries() - creating new series instances, status: ${n.status}`,n);const d=i.map(u=>this.createSeries(u));return this.initSeriesDeclarationOrder(d),t.series=d,"replaced"}Ja("Chart.applySeries() - matchResult",n);const a=[];let r=!1,o=!1,l=!1;const c=n.changes.toSorted((d,u)=>d.targetIdx-u.targetIdx);for(const d of c)switch(o||(o=d.status==="series-grouping"),r||(r=((h=d.diff)==null?void 0:h.data)!=null),l||(l=d.status!=="no-op"),d.status){case"add":{const u=this.createSeries(d.opts);a.push(u),Ja("Chart.applySeries() - created new series",u);break}case"remove":Ja(`Chart.applySeries() - removing series at previous idx ${d.idx}`,d.series);break;case"no-op":a.push(d.series),Ja(`Chart.applySeries() - no change to series at previous idx ${d.idx}`,d.series);break;case"series-grouping":case"update":default:{const{series:u,diff:p,idx:g}=d;Ja(`Chart.applySeries() - applying series diff previous idx ${g}`,p,u),this.applySeriesValues(u,p),u.markNodeDataDirty(),a.push(u)}}return this.initSeriesDeclarationOrder(a),Ja("Chart.applySeries() - final series instances",a),t.series=a,o?"series-grouping-change":r?"data-change":l?"updated":"no-op"}applyAxes(t,i,s,n,a=[]){if(!("axes"in i)||!i.axes)return!1;a=["axes[].type",...a];const r=i.axes.map(c=>c.type==="time"&&c.unit!=null?E(b({},c),{type:"unit-time"}):c);return!(n==="replaced")&&t.axes.length===r.length&&t.axes.every((c,h)=>c.type===r[h].type)&&VM(s)?(t.axes.forEach((c,h)=>{var g,f;const d=(f=(g=s.axes)==null?void 0:g[h])!=null?f:{},u=Lr(d,r[h]);Ja(`Chart.applyAxes() - applying axis diff idx ${h}`,u);const p=`axes[${h}]`;Sg(c,u,{path:p,skip:a})}),!0):(Ja(`Chart.applyAxes() - creating new axes instances; seriesStatus: ${n}`),t.axes=this.createAxis(r,a),!0)}createSeries(t){const i=xa.create(t.type,this.getModuleContext());return this.applySeriesOptionModules(i,t),this.applySeriesValues(i,t),i}applySeriesOptionModules(t,i){const s=t.createModuleContext(),n=t.getModuleMap();for(const a of kr.byType("series-option"))a.optionsKey in i&&a.seriesTypes.includes(t.type)&&n.addModule(a,r=>r.moduleFactory(s))}applySeriesValues(t,i){const s=t.getModuleMap(),h=i,{type:n,data:a,listeners:r,seriesGrouping:o,showInMiniChart:l}=h,c=We(h,["type","data","listeners","seriesGrouping","showInMiniChart"]);for(const d of Rg)if(d.type==="series-option"&&d.optionsKey in c){const u=s.getModule(d.optionsKey);if(u){const p=c[d.optionsKey];delete c[d.optionsKey],u.properties.set(p)}}c.visible!=null&&(t.visible=c.visible),t.properties.set(c),"data"in i&&t.setOptionsData(a),r&&this.registerListeners(t,r,{nodeClick:"seriesNodeClick",nodeDoubleClick:"seriesNodeDoubleClick"}),"seriesGrouping"in i&&(o==null?t.seriesGrouping=void 0:t.seriesGrouping=b(b({},t.seriesGrouping),o))}createAxis(t,i){const s=[],n=this.getModuleContext();for(let a=0;a<t.length;a++){const r=t[a],o=ph.create(r.type,n);this.applyAxisModules(o,r),Sg(o,r,{path:`axes[${a}]`,skip:i}),s.push(o)}return ine(s),s}applyAxisModules(t,i){const s=t.createModuleContext(),n=t.getModuleMap();for(const a of kr.byType("axis-option")){const r=i[a.optionsKey]!=null;r!==n.isEnabled(a)&&(r?(n.addModule(a,o=>o.moduleFactory(s)),t[a.optionsKey]=n.getModule(a)):(n.removeModule(a),delete t[a.optionsKey]))}}registerListeners(t,i,s){t.clearEventListeners();for(const[n,a]of Zt(i))if(Dr(a)){const r=s==null?void 0:s[n];r==null?t.addEventListener(n,a):t.addEventListener(r,o=>{if((o==null?void 0:o.type)===r){const l=new Proxy(o,{get(c,h,d){return h==="type"?n:Reflect.get(c,h,d)}});a(l)}else a(o)})}}};oi.chartsInstances=new WeakMap,I([Dn({newValue(e){this.destroyed||(this.ctx.domManager.setContainer(e),oi.chartsInstances.set(e,this))},oldValue(e){oi.chartsInstances.delete(e)}})],oi.prototype,"container",2),I([Dn({newValue(e){this.resize("width option",{inWidth:e})}})],oi.prototype,"width",2),I([Dn({newValue(e){this.resize("height option",{inHeight:e})}})],oi.prototype,"height",2),I([Dn({newValue(e){this.resize("minWidth option",{inMinWidth:e})}})],oi.prototype,"minWidth",2),I([Dn({newValue(e){this.resize("minHeight option",{inMinHeight:e})}})],oi.prototype,"minHeight",2),I([Dn({newValue(e){this.resize("overrideDevicePixelRatio option",{inOverrideDevicePixelRatio:e})}})],oi.prototype,"overrideDevicePixelRatio",2),I([P],oi.prototype,"padding",2),I([P],oi.prototype,"seriesArea",2),I([P],oi.prototype,"keyboard",2),I([P],oi.prototype,"touch",2),I([P],oi.prototype,"mode",2),I([P],oi.prototype,"styleNonce",2),I([vt("chartCaptions.title")],oi.prototype,"title",2),I([vt("chartCaptions.subtitle")],oi.prototype,"subtitle",2),I([vt("chartCaptions.footnote")],oi.prototype,"footnote",2),I([P],oi.prototype,"suppressFieldDotNotation",2),I([P],oi.prototype,"loadGoogleFonts",2),I([Dn({changeValue(e,t){this.onAxisChange(e,t)}})],oi.prototype,"axes",2),I([Dn({changeValue(e,t){this.onSeriesChange(e,t)}})],oi.prototype,"series",2);var dv=oi,R1=ct.create(!0,"opts"),Ch="AG Charts - Chart was destroyed, cannot perform request.",Wg=class{constructor(t,i,s){this.factoryApi=i,this.licenseManager=s,this.chart=t}async update(t){if(!this.chart)throw new Error(Ch);return R1.group("AgChartInstance.update()",async()=>{var i;this.factoryApi.update(t,this),await((i=this.chart)==null?void 0:i.waitForUpdate())})}async updateDelta(t){if(!this.chart)throw new Error(Ch);return R1.group("AgChartInstance.updateDelta()",async()=>{var i;this.factoryApi.updateUserDelta(this,t),await((i=this.chart)==null?void 0:i.waitForUpdate())})}getOptions(){if(!this.chart)throw new Error(Ch);const t=Bt(this.chart.getOptions());for(const i of Object.keys(t))i.startsWith("_")&&delete t[i];return t}waitForUpdate(){if(!this.chart)throw new Error(Ch);return this.chart.waitForUpdate()}async download(t){var s;if(!this.chart)throw new Error(Ch);const i=await this.prepareResizedChart(this,this.chart,t);try{(s=i.chart)==null||s.download(t==null?void 0:t.fileName,t==null?void 0:t.fileFormat)}finally{i.destroy()}}async __toSVG(t){var s;if(!this.chart)throw new Error(Ch);const i=await this.prepareResizedChart(this,this.chart,b({width:600,height:300},t));try{return(s=i==null?void 0:i.chart)==null?void 0:s.toSVG()}finally{i==null||i.destroy()}}async getImageDataURL(t){if(!this.chart)throw new Error(Ch);const i=await this.prepareResizedChart(this,this.chart,t);try{return i.chart.getCanvasDataURL(t==null?void 0:t.fileFormat)}finally{i.destroy()}}getState(){return this.factoryApi.caretaker.save(...this.getEnabledOriginators())}async setState(t){const{chart:i}=this;if(!i)return;const s=this.getEnabledOriginators();if(!s.includes(i.ctx.legendManager)){await this.setStateOriginators(t,s);return}await this.setStateOriginators(t,s.filter(n=>n!==i.ctx.zoomManager)),await this.setStateOriginators(t,[i.ctx.zoomManager])}resetAnimations(){var t;(t=this.chart)==null||t.resetAnimations()}skipAnimations(){var t;(t=this.chart)==null||t.skipAnimations()}destroy(){this.releaseChart?(this.releaseChart(),this.releaseChart=void 0):this.chart&&(this.chart.publicApi=void 0,this.chart.destroy()),this.chart=void 0}async prepareResizedChart(t,i,s={}){var g,f,y,v,x,S,M,D,A,w,T,k;const n=(f=(g=s.width)!=null?g:i.width)!=null?f:i.ctx.scene.canvas.width,a=(v=(y=s.height)!=null?y:i.height)!=null?v:i.ctx.scene.canvas.height,r=t.getState(),o=kr.hasEnterpriseModules(),l=E(b({},i.chartOptions.processedOverrides),{container:document.createElement("div"),width:n,height:a});s.width!=null&&s.height!=null&&(l.overrideDevicePixelRatio=1);const c=i.getOptions();o&&(l.animation={enabled:!1},(x=this.licenseManager)!=null&&x.isDisplayWatermark()&&(l.foreground={text:this.licenseManager.getWatermarkMessage(),image:{url:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=",width:170,height:25,right:25,bottom:50,opacity:.7}}));const h=b({},i.chartOptions.specialOverrides),d=b({},i.chartOptions.optionMetadata),u=this.factoryApi.create(c,l,h,d);await u.setState(r),(S=u.chart)==null||S.ctx.zoomManager.updateZoom("chartProxy",i.ctx.zoomManager.getZoom()),(M=u.chart)==null||M.ctx.legendManager.clearData(),(D=u.chart)==null||D.ctx.legendManager.update(i.ctx.legendManager.getData()),i.series.forEach((N,O)=>{u.chart.series[O].visible=N.visible});const p=[];for(const N of i.modulesManager.legends())p.push((w=(A=N.legend.pagination)==null?void 0:A.currentPage)!=null?w:0);for(const N of u.chart.modulesManager.legends()){const O=(T=p.shift())!=null?T:0;N.legend.pagination&&N.legend.pagination.setPage(O)}return(k=u.chart)==null||k.update(0,{forceNodeDataRefresh:!0}),await u.waitForUpdate(),u}getEnabledOriginators(){var c,h,d;if(!this.chart)return[];const{chartOptions:{processedOptions:t,optionMetadata:i},ctx:{annotationManager:s,chartTypeOriginator:n,zoomManager:a,legendManager:r}}=this.chart,o=[];return"annotations"in t&&((c=t.annotations)!=null&&c.enabled)&&o.push(s),i.presetType==="price-volume"&&o.push(n),((h=t.navigator)!=null&&h.enabled||(d=t.zoom)!=null&&d.enabled)&&o.push(a),"legend"in this.chart&&o.push(r),o}async setStateOriginators(t,i){var s,n;this.factoryApi.caretaker.restore(t,...i),(s=this.chart)==null||s.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),await((n=this.chart)==null?void 0:n.waitForUpdate())}};Wg.chartInstances=new WeakMap,I([Dn({oldValue(e){e.destroyed||(e.publicApi=void 0),Wg.chartInstances.delete(e)},newValue(e){e&&(e.publicApi=this,Wg.chartInstances.set(e,this))}})],Wg.prototype,"chart",2);var N1=Wg,ZM=class extends Cy{constructor(e){super(),this.ctx=e,this.localeText=void 0}};I([Rl(e=>{e.ctx.localeManager.setLocaleText(e.localeText)}),P],ZM.prototype,"localeText",2),I([Rl(e=>{e.ctx.localeManager.setLocaleTextFormatter(e.getLocaleText)}),P],ZM.prototype,"getLocaleText",2);var Vne={type:"root",optionsKey:"locale",packageType:"community",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new ZM(e)};function O1(e,t,i){if(i==null||i[0]===0&&i[1]===1)return{ticks:e,count:e.length};const s=we(0,Math.floor(i[0]*e.length),e.length),n=we(0,Math.ceil(i[1]*e.length),e.length),a=t?e.length-n:s,r=t?e.length-s:n;return{ticks:e.slice(a,r),count:e.length}}var Ug=class Rj extends Pg{constructor(){super(...arguments),this.type="band",this.index=void 0,this._domain=[]}static is(t){return t instanceof Rj}set domain(t){this._domain!==t&&(this.invalid=!0,this._domain=t,this.index=void 0)}get domain(){return this._domain}get bands(){return this._domain}normalizeDomains(...t){let i;const s=new Set;let n=!0;for(const a of t)s.has(a)||(s.add(a),i==null?i=F1(a):(n&&(n=jne(a,i)),i=F1([...i,...a])));return i!=null||(i=[]),{domain:i,animatable:n}}toDomain(t){}invert(t,i=!1){this.refresh();const s=i?this.bandwidth/2:0,n=this.invertNearestIndex(Math.max(0,t-s));return i||t===this.ordinalRange(n)?this.domain[n]:void 0}ticks(t,i=this.domain,s){return O1(i,!1,s)}findIndex(t){let{index:i}=this;if(i==null){const{domain:s}=this;i=new Map;for(let n=0;n<s.length;n++)i.set(Us(s[n]),n);this.index=i}return i.get(Us(t))}};function F1(e){let t;const i=new Set;for(const s of e){const n=Us(s),a=i.size;i.add(n),i.size!==a?t==null||t.push(s):t!=null||(t=e.slice(0,i.size))}return t!=null?t:e}function jne(e,t){let i=-1;for(const s of e){const n=t.indexOf(s);if(n===-1)i=1/0;else{if(n<=i)return!1;i=n}}return!0}var Su=class Nj extends Gg{constructor(t,i=new Ug){super(t,i),this.groupPaddingInner=.1,this.includeInvisibleDomains=!0,this.nice=!1}static is(t){return t instanceof Nj}normaliseDataDomain(t){return{domain:t,clipped:!1}}updateScale(){super.updateScale();let{paddingInner:t,paddingOuter:i}=this;if(!Xe(t)||!Xe(i)){const s=this.reduceBandScalePadding();t!=null||(t=s.inner),i!=null||(i=s.outer)}this.scale.paddingInner=t!=null?t:0,this.scale.paddingOuter=i!=null?i:0}reduceBandScalePadding(){return this.boundSeries.reduce((t,i)=>{var n;const s=(n=i.getBandScalePadding)==null?void 0:n.call(i);return s&&(t.inner>s.inner&&(t.inner=s.inner),t.outer<s.outer&&(t.outer=s.outer)),t},{inner:1/0,outer:-1/0})}};Su.className="CategoryAxis",Su.type="category",I([P],Su.prototype,"groupPaddingInner",2),I([P],Su.prototype,"paddingInner",2),I([P],Su.prototype,"paddingOuter",2);var Gl=Su,B1=class Oj extends Ug{static is(t){return t instanceof Oj}normalizeDomains(...t){const{domain:i}=super.normalizeDomains(...t);return{domain:i,animatable:!1}}findIndex(t){var i;return(i=super.findIndex(t))!=null?i:this.getMatchIndex(t)}getMatchIndex(t){const i=JSON.stringify(t),s=this._domain.find(n=>JSON.stringify(n)===i);if(s!=null)return super.findIndex(s)}};function Ro(e){if(e.length===0)return null;let t=1/0,i=-1/0;for(const n of e){const a=n instanceof Date?n.getTime():n;typeof a=="number"&&(a<t&&(t=a),a>i&&(i=a))}const s=[t,i];return s.every(isFinite)?s:null}function qM(e,t,i){var n;let s=!1;return e.length>2&&(e=(n=Ro(e))!=null?n:[NaN,NaN]),t!=null&&(s||(s=t>e[0]),e=[t,e[1]]),i!=null&&(s||(s=i<e[1]),e=[e[0],i]),e[0]>e[1]&&(e=[]),{extent:e,clipped:s}}var Kg=new WeakMap;function uv(e,t){var s,n,a;const i=JSON.stringify(e,null,0);return Kg.has(t)||Kg.set(t,new Map),(s=Kg.get(t))!=null&&s.has(i)||(n=Kg.get(t))==null||n.set(i,t(e)),(a=Kg.get(t))==null?void 0:a.get(i)}function fn(e,t){const i=new Map,s=(...r)=>r.map(o=>typeof o=="object"||typeof o=="symbol"?o:(i.has(o)||i.set(o,{v:o}),i.get(o))),n={},a=new WeakMap;return(...r)=>{const o=r.length===0?[n]:s(...r);let l=a;for(const d of o.slice(0,-1))l.has(d)||l.set(d,new WeakMap),l=l.get(d);const c=o.at(-1);let h=l.get(c);return h?t==null||t("hit",e,r):(h=e(...r),l.set(c,h),t==null||t("miss",e,r)),h}}function pv(e,t=[0,0]){for(const i of e)typeof i=="number"&&(i<0&&(t[0]+=i),i>0&&(t[1]+=i));return t}function Hne(e,t){return{id:e,matchGroupIds:[t],type:"aggregate",aggregateFunction:s=>pv(s)}}function _1(e,t){return{id:e,type:"aggregate",matchGroupIds:t?[t]:void 0,aggregateFunction:i=>pv(i),groupAggregateFunction:(i,s=[0,0])=>{var n,a;return s[0]+=(n=i==null?void 0:i[0])!=null?n:0,s[1]+=(a=i==null?void 0:i[1])!=null?a:0,s}}}function Wne(e,t){return{id:e,matchGroupIds:[t],type:"aggregate",aggregateFunction:s=>Bl.extendDomain(s)}}function QM(e){return{id:e,type:"aggregate",aggregateFunction:()=>[0,1],groupAggregateFunction:(t,i=[0,0])=>{var s,n;return i[0]+=(s=t==null?void 0:t[0])!=null?s:0,i[1]+=(n=t==null?void 0:t[1])!=null?n:0,i}}}function G1(e,t){return{id:e,matchGroupIds:t?[t]:void 0,type:"aggregate",aggregateFunction:s=>pv(s),groupAggregateFunction:(s,n=[0,0,-1])=>{var a,r;return n[0]+=(a=s==null?void 0:s[0])!=null?a:0,n[1]+=(r=s==null?void 0:s[1])!=null?r:0,n[2]++,n},finalFunction:(s=[0,0,0])=>{const n=s[0]+s[1];return n>=0?[0,n/s[2]]:[n/s[2],0]}}}function JM(e,t,i){const s={id:e,matchGroupIds:i?[i]:void 0,type:"aggregate",aggregateFunction:(n,a=[])=>{const r=a[1]-a[0];return t.aggregateFunction(n).map(o=>o/r)}};return t.groupAggregateFunction&&(s.groupAggregateFunction=t.groupAggregateFunction),s}function z1(e){return()=>{let t=0;return i=>Xe(i)?(t+=e?Math.max(0,i):i,t):i}}function V1(){return()=>{let e=0;return t=>{if(!Xe(t))return t;const i=e;return e+=t,i}}}function j1(e){return e!=null&&av(e)}function Une(e){return e!=null}function H1(e){switch(e){case"number":case"log":case"ordinal-time":case"unit-time":case"time":case"color":return j1;default:return Une}}function W1(e){switch(e){case"number":case"log":case"time":case"color":return"range";default:return"category"}}function er(e,t,i={}){return b({property:e,type:"key",valueType:W1(t),validation:H1(t)},i)}function et(e,t,i={}){return b({property:e,type:"value",valueType:W1(t),validation:H1(t)},i)}function U1(e,t={}){return b({property:e,type:"value",valueType:"range",missingValue:1,processor:()=>()=>1},t)}var Kne=function(e){return e};function K1(...e){const t=e.filter(i=>i!=null);return t.length===0?()=>Kne:t.length===1?t[0]:()=>{const i=t.map(s=>s());return(s,n)=>i.reduce((a,r)=>r(a,n),s)}}function eD(e,t={}){const r=t,{min:i=-1/0,max:s=1/0,processor:n}=r,a=We(r,["min","max","processor"]);return b({type:"value",property:e,valueType:"range",validation:j1,processor:K1(n,()=>o=>Xe(o)?we(i,o,s):o)},a)}function $g(e,t,i={}){const o=i,{onlyPositive:s,processor:n}=o,a=We(o,["onlyPositive","processor"]);return E(b({},et(e,t,a)),{processor:K1(n,z1(s))})}function $ne(e,t,i={}){return E(b({},et(e,t,i)),{processor:V1()})}function zl(e,t,i,s,n){return[et(e,n,s),Q1(s.groupId,t,i,s.separateNegative),...s.rangeId!=null?[Wne(s.rangeId,s.groupId)]:[]]}function $1(e,t,i){return[et(e,t,i),J1(i.groupId)]}var Y1={type:"reducer",property:"smallestKeyInterval",initialValue:1/0,reducer:()=>{let e=NaN;return(t=1/0,i)=>{const s=typeof i[0]=="number"?i[0]:Number(i[0]),n=Math.abs(s-e);return e=s,!isNaN(n)&&n>0&&n<t?n:t}}},X1={type:"reducer",property:"largestKeyInterval",initialValue:-1/0,reducer:()=>{let e=NaN;return(t=-1/0,i)=>{const s=typeof i[0]=="number"?i[0]:Number(i[0]),n=Math.abs(s-e);return e=s,!isNaN(n)&&n>0&&n>t?n:t}}},Z1={type:"processor",property:"sortedGroupDomain",calculate:({domain:{groups:e}})=>e==null?void 0:e.slice().sort((t,i)=>{for(let s=0;s<t.length;s++){const n=t[s]-i[s];if(n!==0)return n}return 0})};function Yne({normaliseTo:e}){const t=(i,s)=>{if(s===0)return null;const n=(i!=null?i:0)*e/s;return n>=0?Math.min(e,n):Math.max(-e,n)};return()=>()=>(i,s,n)=>{var r;const a=Xne(i,s,n);for(const o of s)for(const l of(r=n.datumIndices[o])!=null?r:[]){const c=i[o],h=c[l];if(h==null){c[l]=void 0;continue}c[l]=typeof h=="number"?t(h,a):h.map(d=>t(d,a))}}}function Xne(e,t,i){var n;const s=[0,0];for(const a of t){const r=e[a];for(const o of(n=i.datumIndices[a])!=null?n:[]){const l=r[o];if(l==null)continue;const c=typeof l=="number"?l:Math.max(...l.map(d=>d!=null?d:0)),h=c<0?0:1;h===0?s[h]=Math.min(s[h],c):s[h]=Math.max(s[h],c)}}return Math.max(Math.abs(s[0]),s[1])}function gv(e,t){return{type:"group-value-processor",matchGroupIds:e,adjust:uv({normaliseTo:t},Yne)}}function Zne({normaliseTo:e,zeroDomain:t,rangeMin:i,rangeMax:s}){const n=e[1]-e[0],a=(r,o,l)=>{const c=e[0]+(r-o)/l*n;return l===0?t:c>=e[1]?e[1]:c<e[0]?e[0]:c};return()=>(r,o)=>{let[l,c]=r.domain.values[o];i!=null&&(l=i),s!=null&&(c=s);const h=c-l;r.domain.values[o]=[e[0],e[1]];const d=r.columns[o];for(let u=0;u<d.length;u+=1)d[u]=a(d[u],l,h)}}function Sh(e,t,i,s,n){return{type:"property-value-processor",property:e,adjust:uv({normaliseTo:t,rangeMin:s,rangeMax:n,zeroDomain:i},Zne)}}var Yg=1,fv=2;function q1(e,t,i,s){var r,o;let n=Yg|fv;if(t.valueType==="category")return i.length<e&&(n&=~Yg),n;let a=(r=s[0])==null?void 0:r.valueOf();for(let l=1;n!==0&&l<s.length;l++){const c=(o=s[l])==null?void 0:o.valueOf();(!Number.isFinite(c)||a>c)&&(n&=~fv),Number.isFinite(c)&&a===c&&(n&=~Yg),a=c}return n}function Mu(e){return{type:"processor",property:"animationValidation",calculate(t){const{keys:i,values:s}=t.defs,{input:{count:n},domain:{keys:a,values:r},keys:o,columns:l}=t;let c=Yg|fv;if(n!==0){for(let h=0;c!==0&&h<i.length;h++)for(const d of i[h].scopes)c&=q1(n,i[h],a[h],o[h].get(d));for(let h=0;c!==0&&h<s.length;h++){const d=s[h];e!=null&&e.includes(d.id)&&(c&=q1(n,d,r[h],l[h]))}}return{uniqueKeys:(c&Yg)!==0,orderedKeys:(c&fv)!==0}}}}function qne({mode:e,separateNegative:t}){return()=>()=>(i,s,n)=>{var r;const a=[0,0];for(const o of s)for(const l of(r=n.datumIndices[o])!=null?r:[]){const c=i[o],h=c[l],d=c0(h)&&t?0:1;Xe(h)&&(e==="normal"&&(a[d]+=h),c[l]=a[d],e==="trailing"&&(a[d]+=h))}}}function Qne({mode:e,sum:t}){return()=>{const i=[];let s=!0;return()=>(n,a,r)=>{var l;let o=0;for(const c of a){const h=n[c];for(const d of(l=r.datumIndices[c])!=null?l:[]){const u=h[d],p=s&&t==="current"?0:i[c];i[c]=u;const g=t==="current"?u:p;if(!Xe(u)||!Xe(p)){h[d]=o;continue}e==="normal"&&(o+=g),h[d]=o,e==="trailing"&&(o+=g)}}s=!1}}}function Q1(e,t,i,s=!1){let n;if(t.startsWith("window")){const a=t.endsWith("-trailing")?"trailing":"normal";n=uv({mode:a,sum:i},Qne)}else n=uv({mode:t,separateNegative:s},qne);return{type:"group-value-processor",matchGroupIds:[e],adjust:n}}function Jne(){return()=>(e,t,i)=>{var a;const s=new Float64Array(t.length);let n=0;for(const r of t){const o=e[r];for(const l of(a=i.datumIndices[r])!=null?a:[]){const c=o[l];s[n]=Number.isFinite(c)?c:NaN,n+=1,o[l]=s.subarray(0,n)}}}}function J1(e){return{type:"group-value-processor",matchGroupIds:[e],adjust:Jne}}function eO(e){var t;return(t=e.id)!=null?t:e.property}function eae(e,t,i){var o,l;const s=new Map,n=t.defs.values;for(let c=0;c<n.length;c+=1){const h=n[c];if(((o=h.scopes)==null?void 0:o.includes(e))===!1)continue;const d=eO(h);if(s.has(d))return;s.set(d,c)}const a=[],r=i.defs.values;for(let c=0;c<r.length;c+=1){const h=r[c];if(((l=h.scopes)==null?void 0:l.includes(e))===!1)continue;const d=eO(h),u=s.get(d);if(u==null)return;s.delete(d),a.push({previousIndex:u,nextIndex:c})}if(s.size===0)return a}function tD(e,t,i,s,n){for(const{previousIndex:a,nextIndex:r}of i){const o=e[a],l=t[r],c=o[s],h=l[n];if(c!==h)return!1}return!0}function Du(e,t,i=!0){return{type:"processor",property:"diff",calculate(s,n){const a=new Map,r=new Map,o=new Map,l=new Map,c=t.keys,h=s.keys,d=t.columns,u=s.columns,p=eae(e,t,s);if(p==null)return n;const g=Math.max(t.input.count,s.input.count);for(let v=0;v<g;v++){const x=v<t.input.count,S=v<s.input.count,M=x?ev(c,e,v):void 0,D=M!=null?Zn(M):"",A=S?ev(h,e,v):void 0,w=A!=null?Zn(A):"";if(S&&x&&D===w){tD(d,u,p,v,v)||o.set(w,v);continue}const T=l.get(w);T!=null?((i||!tD(d,u,p,T,v))&&(o.set(w,v),a.set(w,v)),l.delete(w)):S&&r.set(w,v);const k=r.get(D);k!=null?((i||!tD(d,u,p,k,v))&&(o.set(D,v),a.set(D,v)),r.delete(D)):x&&(o.delete(D),l.set(D,v))}const y={changed:r.size>0||o.size>0||l.size>0,added:new Set(r.keys()),updated:new Set(o.keys()),removed:new Set(l.keys()),moved:new Set(a.keys())};return E(b({},n),{[e]:y})}}}function Zn(e,...t){let i;return Ke(e)?i=e.map(n=>NM(n)).join("___"):i=NM(e),(typeof i=="string"||typeof i=="number"||typeof i=="boolean"||i instanceof Date)&&t.length>0&&(i+=`___${t.join("___")}`),i}var tae=class{constructor(){this.top=1/0,this.right=-1/0,this.bottom=-1/0,this.left=1/0}update(e,t){e>this.right&&(this.right=e),e<this.left&&(this.left=e),t>this.bottom&&(this.bottom=t),t<this.top&&(this.top=t)}},iae=class Fj{constructor(t="",i,s){this.label=t,this.parent=i,this.refId=s,this.position=0,this.subtreeLeft=NaN,this.subtreeRight=NaN,this.children=[],this.leafCount=0,this.prelim=0,this.mod=0,this.ancestor=this,this.change=0,this.shift=0,this.index=0,this.screen=0,this.depth=i?i.depth+1:0}insertTick(t,i){let s=this;for(let n=0;n<t.length;n++){const a=t[n],r=n!==t.length-1,{children:o}=s,l=o.find(c=>c.label===a);if(l&&r)s=l;else{const c=new Fj(a,s,i);c.index=o.length,o.push(c),r&&(s=c)}}}getLeftSibling(){var t;return this.index>0?(t=this.parent)==null?void 0:t.children[this.index-1]:void 0}getLeftmostSibling(){var t;return this.index>0?(t=this.parent)==null?void 0:t.children[0]:void 0}nextLeft(){return this.children[0]}nextRight(){return this.children.at(-1)}getSiblings(){var t,i;return(i=(t=this.parent)==null?void 0:t.children.filter((s,n)=>n!==this.index))!=null?i:[]}};function sae(e){const t=e.reduce((s,n)=>s<n.length?n.length:s,0),i=new iae;for(let s=0;s<e.length;s++){const n=e[s];for(;n.length<t;)n.push("");i.insertTick(n,s)}return i}function nae(e,t,i){const s=t.index-e.index,n=i/s;t.change-=n,t.shift+=i,e.change+=n,t.prelim+=i,t.mod+=i}function aae(e,t,i){return t.getSiblings().indexOf(e.ancestor)>=0?e.ancestor:i}function rae({children:e}){let t=0,i=0;for(let s=e.length-1;s>=0;s--){const n=e[s];n.prelim+=t,n.mod+=t,i+=n.change,t+=n.shift+i}}function oae(e,t){const i=e.getLeftSibling();if(i){let s=e,n=e,a=i,r=n.getLeftmostSibling(),o=n.mod,l=s.mod,c=a.mod,h=r.mod;for(;a.nextRight()&&n.nextLeft();){a=a.nextRight(),n=n.nextLeft(),r=r.nextLeft(),s=s.nextRight(),s.ancestor=e;const d=a.prelim+c-(n.prelim+o)+1;d>0&&(nae(aae(a,e,t),e,d),o+=d,l+=d),c+=a.mod,o+=n.mod,h+=r.mod,l+=s.mod}a.nextRight()&&!s.nextRight()?s.mod+=c-l:(n.nextLeft()&&!r.nextLeft()&&(r.mod+=o-h),t=e)}return t}function tO(e){const{children:t}=e;if(t.length){let[i]=t;for(const a of t)tO(a),i=oae(a,i);rae(e);const s=(t[0].prelim+t.at(-1).prelim)/2,n=e.getLeftSibling();n?(e.prelim=n.prelim+1,e.mod=e.prelim-s):e.prelim=s}else{const i=e.getLeftSibling();e.prelim=i?i.prelim+1:0}}function iO(e,t,i){e.position=e.prelim+t,i.insertNode(e);for(const s of e.children)iO(s,t+e.mod,i)}function sO(e){const{children:t}=e;let i=0;for(const s of t)sO(s),s.children.length?i+=s.leafCount:i++;e.leafCount=i,t.length?(e.subtreeLeft=t[0].subtreeLeft,e.subtreeRight=t[t.length-1].subtreeRight,e.position=(e.subtreeLeft+e.subtreeRight)/2):(e.subtreeLeft=e.position,e.subtreeRight=e.position)}function lae(e){const t=new cae,i=sae(e);return tO(i),iO(i,-i.prelim,t),sO(i),t}var cae=class{constructor(){this.dimensions=new tae,this.nodes=[],this.depth=0}insertNode(e){this.depth<e.depth&&(this.depth=e.depth),this.dimensions.update(e.position,e.depth),this.nodes.push(e)}scaling(e,t){let i=1;if(e>0){const{left:s,right:n}=this.dimensions;n!==s&&(i=e/(n-s))}return t&&(i*=-1),i}},_r=class extends Be{constructor(){super(...arguments),this.enabled=!0}};I([P],_r.prototype,"enabled",2),I([P],_r.prototype,"avoidCollisions",2),I([P],_r.prototype,"color",2),I([P],_r.prototype,"spacing",2),I([P],_r.prototype,"rotation",2),I([P],_r.prototype,"fontStyle",2),I([P],_r.prototype,"fontWeight",2),I([P],_r.prototype,"fontSize",2),I([P],_r.prototype,"fontFamily",2);var mv=class extends Be{constructor(){super(...arguments),this.enabled=!0}};I([P],mv.prototype,"enabled",2),I([P],mv.prototype,"width",2),I([P],mv.prototype,"stroke",2);var iD=class extends Be{constructor(){super(...arguments),this.label=new _r,this.tick=new mv}};I([P],iD.prototype,"label",2),I([P],iD.prototype,"tick",2);var Mh=class extends Gl{constructor(e){super(e,new B1),this.tickScale=new B1,this.depthOptions=new vg(iD),this.includeInvisibleDomains=!0,this.tickScale.paddingInner=1,this.tickScale.paddingOuter=0}resizeTickTree(){if(!this.tickTreeLayout)return;const{nodes:e}=this.tickTreeLayout,{range:t,step:i,inset:s,bandwidth:n}=this.scale,a=Math.abs(t[1]-t[0])-i,r=this.tickTreeLayout.scaling(a,t[0]>t[1]),o=s+n/2;let l=0;for(const c of e){const h=c.position*r;l>h&&(l=h),c.screen=h+o}for(const c of e)c.screen-=l}getDepthOptionsMap(e){var a,r,o,l,c,h,d,u;const t=[],{depthOptions:i,label:s}=this,n=this.horizontal?0:-90;for(let p=0;p<e;p++)t.push(((r=(a=i[p])==null?void 0:a.label.enabled)!=null?r:s.enabled)?{enabled:!0,spacing:(l=(o=i[p])==null?void 0:o.label.spacing)!=null?l:s.spacing,rotation:(h=(c=i[p])==null?void 0:c.label.rotation)!=null?h:p?n:s.rotation,avoidCollisions:(u=(d=i[p])==null?void 0:d.label.avoidCollisions)!=null?u:s.avoidCollisions}:{enabled:!1,spacing:0,rotation:0,avoidCollisions:!1});return t}updateCategoryLabels(){this.computedLayout&&this.tickLabelGroupSelection.update(this.computedLayout.tickLabelLayout).each((e,t)=>e.setProperties(t))}updateAxisLine(){this.computedLayout&&(this.lineNode.visible=this.line.enabled,this.lineNode.stroke=this.line.stroke,this.lineNode.strokeWidth=this.line.width)}computeLayout(){var O;if(this.updateDirection(),this.updateScale(),this.resizeTickTree(),!((O=this.tickTreeLayout)!=null&&O.depth))return{bbox:ve.zero,spacing:0,separatorLayout:[],tickLabelLayout:[]};const{step:e}=this.scale,{title:t,label:i,range:s,depthOptions:n,horizontal:a}=this,{depth:r,nodes:o}=this.tickTreeLayout,l=Math.ceil(i.fontSize/e),c=a?-i.getSideFlag():i.getSideFlag(),h=[],d=new Map,u=new nu,p=this.getDepthOptionsMap(r),g=c*p[0].spacing,f=(L,F)=>{var V,j;const B=r-L.depth;if(!((V=p[B])!=null&&V.enabled)||F%l!==0||!KQ(L.screen,s))return!1;const _=this.formatTick(L.label,F-1,this.scale.domain),G=this.getLabelStyles({value:_,depth:B},(j=n[B])==null?void 0:j.label);return u.setProperties(E(b({},G),{text:_,textAlign:"center",textBaseline:i.parallel?"hanging":"bottom",lineHeight:_t.getLineHeight(G.fontSize),x:a?L.screen:g,y:a?g:L.screen,rotation:0})),!0},y={};o.forEach((L,F)=>{var H,U;const B=r-L.depth;if(!f(L,F)||!u.getBBox())return;d.set(F,u.getBBox()),u.rotation=Co((H=p[B])==null?void 0:H.rotation);const{width:G,height:V}=u.getBBox(),j=a?V:G;(U=y[B])!=null||(y[B]=0),y[B]<j&&(y[B]=j)});const v=_M(),x=new Map,S=L=>{if(L===0)return 0;let F=y[0];for(let B=1;B<=L;B++)F+=p[B].spacing,B!==L&&(F+=y[B]);return F};o.forEach((L,F)=>{var W;if(F===0)return;const B=f(L,F),_=!L.children.length,G=r-L.depth;if(L.parent){const Y=_?L.position:L.position-(L.leafCount-1)/2;if(!x.has(Y)){const K=(W=this.depthOptions[G])==null?void 0:W.tick;let Q=y[0];for(let Z=0;Z<=G;Z++)Q+=p[Z].spacing,Z!==0&&(Q+=y[Z]);x.set(Y,{tickSize:Q,tickStroke:K==null?void 0:K.stroke,tickWidth:(K==null?void 0:K.enabled)!==!1?K==null?void 0:K.width:0})}}if(!B)return;const V=Co(p[G].rotation),{width:j,height:H}=d.get(F),U=S(G);if(u.textAlign="end",u.textBaseline="middle",u.rotation=V,a?(u.x+=j/2,u.y+=(U+x0(j/2,H/2,V))*c,u.rotationCenterX=L.screen,u.rotationCenterY=u.y):(u.x+=U*c+x0((p[G].spacing*c+j)/2,i.mirrored?j:0,V),u.rotationCenterX=u.x-j/2,u.rotationCenterY=L.screen),p[G].avoidCollisions){const{width:Y,height:K}=u.getBBox(),Q=a?Y:K,Z=_?e:L.leafCount*e;if(Q>Z){d.delete(F);return}}const{text:$=""}=u;h.push({text:$,visible:!0,range:this.scale.range,tickId:v($),fill:u.fill,fontFamily:u.fontFamily,fontSize:u.fontSize,fontStyle:u.fontStyle,fontWeight:u.fontWeight,rotation:u.rotation,rotationCenterX:u.rotationCenterX,rotationCenterY:u.rotationCenterY,textAlign:u.textAlign,textBaseline:u.textBaseline,x:u.x,y:u.y}),d.set(F,ai.toCanvas(u))});const{enabled:M,stroke:D,width:A}=this.line;this.lineNode.datum=a?{x1:s[0],x2:s[1],y1:0,y2:0}:{x1:0,x2:0,y1:s[0],y2:s[1]},this.lineNode.setProperties({stroke:D,strokeWidth:M?A:0});const w=[...x.values()];w.push(w[0]);const T=[this.lineNodeBBox(),ve.merge(d.values()),new ve(0,0,w[0].tickSize*c,0)];let k=0;if(t.enabled){const L=ve.merge(T);k=a?L.height:L.width,T.push(this.titleBBox(this.scale.domain,k))}return{bbox:ve.merge(T),spacing:k,separatorLayout:w,tickLabelLayout:h}}update(){if(!this.computedLayout)return;this.moduleCtx.animationManager.skipCurrentBatch();const{tickScale:e,tick:t,gridLine:i,gridLength:s}=this,{separatorLayout:n,spacing:a}=this.computedLayout,{position:r,horizontal:o,gridPadding:l}=this,c=r==="bottom"||r==="right"?-1:1,h=l,d=c*s-l,u=e.ticks({nice:!1,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}).ticks.map((p,g)=>({tickId:Zn(p,g),offset:Math.round(e.convert(p))}));this.gridLineGroupSelection.update(i.enabled&&s?u.map(({tickId:p,offset:g},f)=>{var T;const[y,v,x,S]=o?[g,g,h,d]:[h,d,g,g],{style:M,width:D}=i,{stroke:A,lineDash:w}=(T=M[f%M.length])!=null?T:{};return{tickId:p,offset:g,x1:y,y1:x,x2:v,y2:S,stroke:A,strokeWidth:D,lineDash:w}}):[]),this.tickLineGroupSelection.update(t.enabled?u.map(({tickId:p,offset:g},f)=>{var k;const{tickSize:y=this.getTickSize(),tickStroke:v=t.stroke,tickWidth:x=t.width}=(k=n[f])!=null?k:{},S=-c*y,[M,D,A,w]=o?[g,g,0,S]:[0,S,g,g];return{tickId:p,offset:g,x1:M,y1:A,x2:D,y2:w,stroke:v,strokeWidth:x,lineDash:void 0}}):[]),this.updatePosition(),this.updateCategoryLabels(),this.updateAxisLine(),this.updateGridLines(),this.updateTickLines(),this.updateTitle(this.scale.domain,a),this.resetSelectionNodes()}calculateLayout(){const{separatorLayout:e,tickLabelLayout:t,spacing:i,bbox:s}=this.computeLayout();return this.computedLayout={separatorLayout:e,tickLabelLayout:t,spacing:i},{bbox:s,niceDomain:this.scale.domain}}onGridVisibilityChange(){this.gridLineGroupSelection.clear(),this.tickLabelGroupSelection.clear()}updateScale(){super.updateScale(),this.tickScale.range=this.scale.range,this.scale.paddingOuter=this.scale.paddingInner/2}processData(){var n;const{direction:e}=this,t=this.boundSeries.filter(a=>a.visible).flatMap(a=>a.getDomain(e));this.dataDomain={domain:(n=Ro(t))!=null?n:this.filterDuplicateArrays(t),clipped:!1},this.isReversed()&&this.dataDomain.domain.reverse();const i=this.dataDomain.domain.map(a=>yy(Ve(a)&&"value"in a?a.value:a));this.tickTreeLayout=lae(i);const s=[];for(const a of this.tickTreeLayout.nodes)a.leafCount||a.refId==null||s.push(this.dataDomain.domain[a.refId]);this.scale.domain=GQ(this.dataDomain.domain,s),this.tickScale.domain=i.concat([[""]])}filterDuplicateArrays(e){const t=new Set;return e.filter(i=>{const s=Ke(i)?JSON.stringify(i):i;return t.has(s)?!1:(t.add(s),!0)})}};Mh.className="GroupedCategoryAxis",Mh.type="grouped-category",I([P],Mh.prototype,"depthOptions",2);var hae={2:(e,t)=>Math.log2(t),[Math.E]:(e,t)=>Math.log(t),10:(e,t)=>Math.log10(t)},dae=(e,t)=>Math.log(t)/Math.log(e);function sD(e,t,i){var a;const s=Math.min(...t),n=(a=hae[e])!=null?a:dae;return s>=0?n(e,i):-n(e,-i)}var uae={[Math.E]:(e,t)=>Math.exp(t),10:(e,t)=>t>=0?10**t:1/10**-t},pae=(e,t)=>e**t;function nD(e,t,i){var a;const s=Math.min(...t),n=(a=uae[e])!=null?a:pae;return s>=0?n(e,i):-n(e,-i)}var aD=class Bj extends Mt{constructor(t=[1,10],i=[0,1]){super(t,i),this.type="log",this.defaultClamp=!0,this.base=10,this.log=s=>sD(this.base,this.domain,s),this.pow=s=>nD(this.base,this.domain,s)}static is(t){return t instanceof Bj}toDomain(t){return t}transform(t){const[i,s]=ss(this.domain);return i>=0!=s>=0?NaN:i>=0?Math.log(t):-Math.log(-t)}transformInvert(t){const[i,s]=ss(this.domain);return i>=0!=s>=0?NaN:i>=0?Math.exp(t):-Math.exp(-t)}niceDomain(t,i=this.domain){if(i.length<2)return[];const{base:s}=this,[n,a]=i,r=n>a?Math.ceil:Math.floor,o=n>a?Math.floor:Math.ceil,l=nD(s,i,r(sD(s,i,n))),c=nD(s,i,o(sD(s,i,a)));return[l,c]}ticks({interval:t,tickCount:i=Mt.defaultTickCount},s=this.domain,n){if(!s||s.length<2||i<1)return;const a=this.base,[r,o]=s,l=Math.min(r,o),c=Math.max(r,o);let h=this.log(l),d=this.log(c);if(t){const y=D=>D>=l&&D<=c,v=Math.min(Math.abs(t),Math.abs(d-h)),{ticks:x,count:S}=sv(h,d,v,n),M=x.map(this.pow).filter(y);if(!bu(M.length,this.getPixelRange()))return{ticks:M,count:S}}if(!yE(a)||d-h>=i){const y=Math.min(d-h,i),{ticks:v,count:x}=Og(h,d,y,void 0,void 0,n);return{ticks:v.map(this.pow),count:x}}const u=[],p=l>0;h=Math.floor(h)-1,d=Math.round(d)+1;const g=du(this.range)/i;let f=1/0;for(let y=h;y<=d;y++){const v=this.convert(this.pow(y+1));for(let x=1;x<a;x++){const S=p?x:a-x+1,M=this.pow(y)*S,D=this.convert(M),A=Math.abs(f-D),w=Math.abs(D-v),T=A>=g&&w>=g;M>=l&&M<=c&&(x===1||T||u.length===0)&&(u.push(M),f=D)}}return O1(u,p,n)}tickFormatter({specifier:t}){return t!=null?AE(t):String}datumFormatter(t){return this.tickFormatter(t)}},tr=class _T extends Mt{constructor(){super([0,1],[0,1]),this.type="number"}static is(t){return t instanceof _T}static getTickStep(t,i,s){const{interval:n,tickCount:a=Mt.defaultTickCount,minTickCount:r,maxTickCount:o}=s;return n!=null?n:Fg(t,i,a,r,o)}toDomain(t){return t}ticks({interval:t,tickCount:i=Mt.defaultTickCount,minTickCount:s,maxTickCount:n},a=this.domain,r){if(!a||a.length<2||i<1||!a.every(isFinite))return{ticks:[],count:0};const[o,l]=a;if(t){const c=Math.abs(t);if(!bu((l-o)/c,this.getPixelRange()))return sv(o,l,c,r)}return Og(o,l,i,s,n,r)}niceDomain(t,i=this.domain){if(i.length<2)return[];const{tickCount:s=Mt.defaultTickCount}=t;let[n,a]=i;if(s===1)[n,a]=ZN(n,a);else if(s>1){const r=n>a?Math.ceil:Math.floor,o=n>a?Math.floor:Math.ceil,l=4;for(let c=0;c<l;c++){const h=n,d=a,u=_T.getTickStep(n,a,t),[p,g]=i;if(n=r(p/u)*u,a=o(g/u)*u,n===h&&a===d)break}}return[n,a]}tickFormatter({ticks:t,fractionDigits:i,specifier:s}){return s!=null?XN(t,s):n=>Ao(n,i)}datumFormatter({ticks:t,fractionDigits:i,specifier:s}){return s!=null?XN(t,s):n=>Ao(n,i+1)}},No=class extends Gg{constructor(e,t=new tr){super(e,t)}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:s,clipped:n}=qM(e,t,i);return{domain:s,clipped:n}}};No.className="NumberAxis",No.type="number",I([P],No.prototype,"min",2),I([P],No.prototype,"max",2);var wu=class extends No{normaliseDataDomain(e){const{min:t,max:i}=this,{extent:s,clipped:n}=qM(e,t,i);return s[0]<0&&s[1]>0||e[0]<0&&e[1]>0?(se.warn("The log axis domain crosses zero, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped:n}):s[0]===0||s[1]===0||e[0]===0||e[1]===0?(se.warn("The log axis domain contains a value of 0, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped:n}):{domain:s,clipped:n}}set base(e){this.scale.base=e}get base(){return this.scale.base}constructor(e){super(e,new aD)}defaultDatumFormatter(e,t){return String(e)}defaultLabelFormatter(e,t){return String(e)}};wu.className="LogAxis",wu.type="log";var Au=class extends Be{constructor(){super(...arguments),this.enabled=!1,this.label=new Hi,this.tick=new yh}};I([P],Au.prototype,"enabled",2),I([P],Au.prototype,"label",2),I([P],Au.prototype,"tick",2);var Ma=class extends Gg{constructor(e){super(e,new Bg),this.parentLevel=new Au,this.min=void 0,this.max=void 0,this.groupPaddingInner=.1}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}normaliseDataDomain(e){return nO(e,this.min,this.max)}};Ma.className="TimeAxis",Ma.type="time",I([P],Ma.prototype,"parentLevel",2),I([P],Ma.prototype,"min",2),I([P],Ma.prototype,"max",2),I([P],Ma.prototype,"groupPaddingInner",2),I([P],Ma.prototype,"paddingInner",2),I([P],Ma.prototype,"paddingOuter",2);function nO(e,t,i){var n,a;let s=!1;return typeof t=="number"&&(t=new Date(t)),typeof i=="number"&&(i=new Date(i)),e.length>2&&(e=(a=(n=Ro(e))==null?void 0:n.map(r=>new Date(r)))!=null?a:[]),t instanceof Date&&(s||(s=t>e[0]),e=[t,e[1]]),i instanceof Date&&(s||(s=i<e[1]),e=[e[0],i]),e[0]>e[1]&&(e=[]),{domain:e,clipped:s}}var Vl=class extends Gl{constructor(e){super(e,new Xn),this.parentLevel=new Au,this.min=void 0,this.max=void 0}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}updateScale(){super.updateScale(),this.scale.interval=this.unit}normaliseDataDomain(e){return nO(e,this.min,this.max)}};Vl.className="UnitTimeAxis",Vl.type="unit-time",I([P],Vl.prototype,"parentLevel",2),I([P],Vl.prototype,"min",2),I([P],Vl.prototype,"max",2),I([P],Vl.prototype,"unit",2);var Xg=(e,{x0:t,y0:i,x1:s,y1:n,cx:a,cy:r},o,l)=>{if(l&&e.moveTo(t,i),t!==s||i!==n){const c=Math.atan2(i-r,t-a),h=Math.atan2(n-r,s-a);e.arc(a,r,o,c,h)}else e.lineTo(t,i)},aO=1e-6,yv=(e,t,i,s,n)=>{let a=!1,r=!1,o=s-Math.sqrt(Math.max(n**2-i**2,0)),l=0,c=0,h=i-Math.sqrt(Math.max(n**2-s**2,0));return o>e?(a=!0,o=e,l=i-Math.sqrt(Math.max(n**2-(s-e)**2))):o<aO&&(o=0),h>t?(r=!0,c=s-Math.sqrt(Math.max(n**2-(i-t)**2)),h=t):h<aO&&(h=0),{leading0:o,leading1:l,trailing0:c,trailing1:h,leadingClipped:a,trailingClipped:r}},vv=(e,t,i,s,n,a,r)=>{let{topLeft:o,topRight:l,bottomRight:c,bottomLeft:h}=a;const d=Math.max(o+h,l+c),u=Math.max(o+l,h+c);if(d<=0&&u<=0){r==null?e.rect(t,i,s,n):e.rect(r.x,r.y,r.width,r.height);return}else if(r==null&&o===l&&o===c&&o===h){e.roundRect(t,i,s,n,o);return}if(s<0&&(t+=s,s=Math.abs(s)),n<0&&(i+=n,n=Math.abs(n)),s<=0||n<=0)return;if(r==null)r=new ve(t,i,s,n);else{const w=Math.max(t,r.x),T=Math.min(t+s,r.x+r.width),k=Math.max(i,r.y),N=Math.min(i+n,r.y+r.height);r=new ve(w,k,T-w,N-k)}const p=Math.max(d/n,u/s,1);p>1&&(o/=p,l/=p,c/=p,h/=p);let g=!0,f=!0,y=!0,v=!0,x,S,M,D;if(g){const w=yv(r.height,r.width,Math.max(t+o-r.x,0),Math.max(i+o-r.y,0),o);w.leadingClipped&&(v=!1),w.trailingClipped&&(f=!1);const T=Math.max(r.x+w.leading1,r.x),k=Math.max(r.y+w.leading0,r.y),N=Math.max(r.x+w.trailing1,r.x),O=Math.max(r.y+w.trailing0,r.y),L=t+o,F=i+o;x={x0:T,y0:k,x1:N,y1:O,cx:L,cy:F}}if(f){const w=yv(r.width,r.height,Math.max(i+l-r.y,0),Math.max(r.x+r.width-(t+s-l),0),l);w.leadingClipped&&(g=!1),w.trailingClipped&&(y=!1);const T=Math.min(r.x+r.width-w.leading0,r.x+r.width),k=Math.max(r.y+w.leading1,r.y),N=Math.min(r.x+r.width-w.trailing0,r.x+r.width),O=Math.max(r.y+w.trailing1,r.y),L=t+s-l,F=i+l;S={x0:T,y0:k,x1:N,y1:O,cx:L,cy:F}}if(y){const w=yv(r.height,r.width,Math.max(r.x+r.width-(t+s-c),0),Math.max(r.y+r.height-(i+n-c),0),c);w.leadingClipped&&(f=!1),w.trailingClipped&&(v=!1);const T=Math.min(r.x+r.width-w.leading1,r.x+r.width),k=Math.min(r.y+r.height-w.leading0,r.y+r.height),N=Math.min(r.x+r.width-w.trailing1,r.x+r.width),O=Math.min(r.y+r.height-w.trailing0,r.y+r.height),L=t+s-c,F=i+n-c;M={x0:T,y0:k,x1:N,y1:O,cx:L,cy:F}}if(v){const w=yv(r.width,r.height,Math.max(r.y+r.height-(i+n-h),0),Math.max(t+h-r.x,0),h);w.leadingClipped&&(y=!1),w.trailingClipped&&(g=!1);const T=Math.max(r.x+w.leading0,r.x),k=Math.min(r.y+r.height-w.leading1,r.y+r.height),N=Math.max(r.x+w.trailing0,r.x),O=Math.min(r.y+r.height-w.trailing1,r.y+r.height),L=t+h,F=i+n-h;D={x0:T,y0:k,x1:N,y1:O,cx:L,cy:F}}let A=!1;g&&x!=null&&(Xg(e,x,o,!A),A||(A=!0)),f&&S!=null&&(Xg(e,S,l,!A),A||(A=!0)),y&&M!=null&&(Xg(e,M,c,!A),A||(A=!0)),v&&D!=null&&Xg(e,D,h,!A),e.closePath()},$s=class extends gn{constructor(){super(...arguments),this.borderPath=new Jd,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=va.defaultStyles.strokeWidth,this.effectiveStrokeWidth=va.defaultStyles.strokeWidth,this.hittester=super.isPointInPath.bind(this),this.distanceCalculator=super.distanceSquaredTransformedPoint.bind(this),this.microPixelEffectOpacity=1}set cornerRadius(e){this.topLeftCornerRadius=e,this.topRightCornerRadius=e,this.bottomRightCornerRadius=e,this.bottomLeftCornerRadius=e}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth||!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){var y,v,x;const{path:e,borderPath:t,crisp:i,topLeftCornerRadius:s,topRightCornerRadius:n,bottomRightCornerRadius:a,bottomLeftCornerRadius:r}=this;let{x:o,y:l,width:c,height:h,strokeWidth:d,clipBBox:u}=this;const g=1/((v=(y=this.layerManager)==null?void 0:y.canvas.pixelRatio)!=null?v:1);let f=1;if(e.clear(!0),t.clear(!0),i&&(c<=g&&(f*=c/g),h<=g&&(f*=h/g),c=this.align(o,c),h=this.align(l,h),o=this.align(o),l=this.align(l),u=u!=null?new ve(this.align(u.x),this.align(u.y),this.align(u.x,u.width),this.align(u.y,u.height)):void 0),d)if(c<g){const S=o+g/2;t.moveTo(S,l),t.lineTo(S,l+h),d=g,this.borderClipPath=void 0}else if(h<g){const S=l+g/2;t.moveTo(o,S),t.lineTo(o+c,S),d=g,this.borderClipPath=void 0}else if(d<c&&d<h){const S=d/2;o+=S,l+=S,c-=d,h-=d;const M=u==null?void 0:u.clone().shrink(S),D={topLeft:s>0?s-d:0,topRight:n>0?n-d:0,bottomRight:a>0?a-d:0,bottomLeft:r>0?r-d:0};this.borderClipPath=void 0,c>0&&h>0&&(M==null||(M==null?void 0:M.width)>0&&(M==null?void 0:M.height)>0)&&(vv(e,o,l,c,h,D,M),vv(t,o,l,c,h,D,M))}else this.borderClipPath=(x=this.borderClipPath)!=null?x:new Jd,this.borderClipPath.clear(!0),this.borderClipPath.rect(o,l,c,h),t.rect(o,l,c,h);else{const S={topLeft:s,topRight:n,bottomRight:a,bottomLeft:r};this.borderClipPath=void 0,vv(e,o,l,c,h,S,u)}if([s,n,a,r].every(S=>S===0)){const S=this.getBBox();this.hittester=S.containsPoint.bind(S),this.distanceSquared=(M,D)=>this.getBBox().distanceSquared(M,D)}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=d,this.lastUpdatePathStrokeWidth=d,this.microPixelEffectOpacity=f}computeBBox(){var a;const{x:e,y:t,width:i,height:s,clipBBox:n}=this;return(a=n==null?void 0:n.clone())!=null?a:new ve(e,t,i,s)}isPointInPath(e,t){return this.hittester(e,t)}get midPoint(){return{x:this.x+this.width/2,y:this.y+this.height/2}}distanceSquared(e,t){return this.distanceCalculator(e,t)}applyFillAndAlpha(e){super.applyFillAndAlpha(e),e.globalAlpha*=this.microPixelEffectOpacity}applyStrokeAndAlpha(e){super.applyStrokeAndAlpha(e),e.globalAlpha*=this.microPixelEffectOpacity}renderStroke(e){const{stroke:t,effectiveStrokeWidth:i}=this;if(t&&i){const{globalAlpha:s}=e,{lineDash:n,lineDashOffset:a,lineCap:r,lineJoin:o,borderPath:l,borderClipPath:c}=this;c&&e.clip(c.getPath2D()),this.applyStrokeAndAlpha(e),e.lineWidth=i,n&&e.setLineDash(n),a&&(e.lineDashOffset=a),r&&(e.lineCap=r),o&&(e.lineJoin=o),e.stroke(l.getPath2D()),e.globalAlpha=s}}};$s.className="Rect",I([he()],$s.prototype,"x",2),I([he()],$s.prototype,"y",2),I([he()],$s.prototype,"width",2),I([he()],$s.prototype,"height",2),I([he()],$s.prototype,"topLeftCornerRadius",2),I([he()],$s.prototype,"topRightCornerRadius",2),I([he()],$s.prototype,"bottomRightCornerRadius",2),I([he()],$s.prototype,"bottomLeftCornerRadius",2),I([$n({equals:nh.equals})],$s.prototype,"clipBBox",2),I([he()],$s.prototype,"crisp",2);var Iu=class extends Cy{constructor(e){super(),this.ctx=e,this.rectNode=new $s,this.textNode=new is,this.fill="white",this.node=this.createNode(),this.node.append([this.rectNode,this.textNode]),this.visible=!0,this.destroyFns.push(e.scene.attachNode(this.node),e.layoutManager.addListener("layout:complete",t=>this.onLayoutComplete(t)))}createNode(){return new Ge({name:"background",zIndex:0})}onLayoutComplete(e){const{width:t,height:i}=e.chart;this.rectNode.width=t,this.rectNode.height=i}};I([P,us("node","visible")],Iu.prototype,"visible",2),I([P,us("rectNode","fill")],Iu.prototype,"fill",2),I([P],Iu.prototype,"image",2),I([P,us("textNode")],Iu.prototype,"text",2);var rO={type:"root",optionsKey:"background",packageType:"community",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new Iu(e)};function gae({orientation:e,bboxes:t,maxHeight:i,maxWidth:s,itemPaddingY:n=0,itemPaddingX:a=0,forceResult:r=!1}){const o=e==="horizontal",l={max:o?s:i,fn:o?u=>u.width:u=>u.height,padding:o?a:n},c={max:o?i:s,fn:o?u=>u.height:u=>u.width,padding:o?n:a};let h=0;const d=[];for(;h<t.length;){const u=t.slice(h),p=fae(u,h,l,c,r);if(!p)return;h+=p.processedBBoxCount,d.push(p.pageIndices)}return yae(d,e,t,n,a)}function fae(e,t,i,s,n){let r=bae(e,i);if(r<1){if(!n)return;r=1}let o=r;for(;o>=1;){const l=mae(e,t,o,i,s,n);if(l==null&&o<=1)return;if(l==null){o--;continue}if(typeof l=="number"){if(l<=1)return;o=l<o&&l>1?l:o,o--;continue}return{processedBBoxCount:l.length*l[0].length,pageIndices:l}}}function mae(e,t,i,s,n,a){var d;const r=[];let o=0,l=0,c=[];const h=[];for(let u=0;u<e.length;u++){const p=(u+i)%i;p===0&&(o+=l,l=0,c.length>0&&r.push(c),c=[]);const g=s.fn(e[u])+s.padding;h[p]=Math.max((d=h[p])!=null?d:0,g),l=Math.max(l,n.fn(e[u])+n.padding);const f=o+l,y=!a||r.length>0;if(f>n.max&&y){c=[];break}if(h.reduce((x,S)=>x+S,0)>s.max&&!a)return h.length<i?h.length:void 0;c.push(u+t)}return c.length>0&&r.push(c),r.length>0?r:void 0}function yae(e,t,i,s,n){let a=0,r=0;return{pages:e.map(l=>{t==="horizontal"&&(l=vae(l));let c=0;const h=l.map(p=>{const g=p.map(v=>(c=Math.max(v,c),i[v]));let f=0,y=0;return g.forEach(v=>{f+=v.height+s,y=Math.max(y,v.width+n)}),{indices:p,bboxes:g,columnHeight:Math.ceil(f),columnWidth:Math.ceil(y)}});let d=0,u=0;return h.forEach(p=>{d+=p.columnWidth,u=Math.max(u,p.columnHeight)}),a=Math.max(d,a),r=Math.max(u,r),{columns:h,startIndex:l[0][0],endIndex:c,pageWidth:d,pageHeight:u}}),maxPageWidth:a,maxPageHeight:r}}function vae(e){const t=[];for(const i of e[0])t.push([]);return e.forEach((i,s)=>{i.forEach((n,a)=>{t[a][s]=n})}),t}function bae(e,t){const i=e.length;let s=0;for(let n=0;n<i;n++)if(s+=t.fn(e[n])+t.padding,s>t.max)return i/n<2?Math.ceil(i/2):n;return i}var Tu=class extends Be{constructor(){super(...arguments),this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}};I([P],Tu.prototype,"color",2),I([P],Tu.prototype,"fontStyle",2),I([P],Tu.prototype,"fontWeight",2),I([P],Tu.prototype,"fontSize",2),I([P],Tu.prototype,"fontFamily",2);var Oo=class extends Be{constructor(){super(...arguments),this.size=15,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=1,this.strokeOpacity=1}};I([P],Oo.prototype,"size",2),I([P],Oo.prototype,"fill",2),I([P],Oo.prototype,"fillOpacity",2),I([P],Oo.prototype,"stroke",2),I([P],Oo.prototype,"strokeWidth",2),I([P],Oo.prototype,"strokeOpacity",2);var bv=class extends Be{constructor(e){super(),this.parent=e,this.shape="triangle",this.size=15,this.padding=8}};I([Dn({changeValue(){this.parent.marker===this&&this.parent.onMarkerShapeChange()}})],bv.prototype,"shape",2),I([P],bv.prototype,"size",2),I([P],bv.prototype,"padding",2);var Dh=class extends Be{constructor(e,t){super(),this.chartUpdateCallback=e,this.pageUpdateCallback=t,this.id=Hs(this),this.marker=new bv(this),this.activeStyle=new Oo,this.inactiveStyle=new Oo,this.highlightStyle=new Oo,this.label=new Tu,this.group=new ds({name:"pagination"}),this.labelNode=new is,this.totalPages=0,this.currentPage=0,this.translationX=0,this.translationY=0,this.nextButtonDisabled=!1,this.previousButtonDisabled=!1,this._visible=!0,this._enabled=!0,this._orientation="vertical",this.nextButton=new rs,this.previousButton=new rs,this.labelNode.setProperties({textBaseline:"middle",fontSize:12,fontFamily:"Verdana, sans-serif",fill:"black",y:1}),this.group.append([this.nextButton,this.previousButton,this.labelNode]),this.update(),this.updateMarkers()}set visible(e){this._visible=e,this.updateGroupVisibility()}get visible(){return this._visible}set enabled(e){this._enabled=e,this.updateGroupVisibility()}get enabled(){return this._enabled}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible}set orientation(e){switch(this._orientation=e,e){case"horizontal":{this.previousButton.rotation=-Math.PI/2,this.nextButton.rotation=Math.PI/2;break}case"vertical":default:this.previousButton.rotation=0,this.nextButton.rotation=Math.PI}}get orientation(){return this._orientation}update(){this.updateLabel(),this.updatePositions(),this.enableOrDisableButtons()}updatePositions(){this.group.translationX=this.translationX,this.group.translationY=this.translationY,this.updateLabelPosition(),this.updateNextButtonPosition()}updateLabelPosition(){const{size:e,padding:t}=this.marker;this.nextButton.size=e,this.previousButton.size=e,this.labelNode.x=e/2+t}updateNextButtonPosition(){const e=this.labelNode.getBBox();this.nextButton.translationX=e.width+(this.marker.size/2+this.marker.padding)*2}updateLabel(){const{currentPage:e,totalPages:t,labelNode:i,label:{color:s,fontStyle:n,fontWeight:a,fontSize:r,fontFamily:o}}=this;i.text=`${e+1} / ${t}`,i.fill=s,i.fontStyle=n,i.fontWeight=a,i.fontSize=r,i.fontFamily=o}updateMarkers(){const{nextButton:e,previousButton:t,nextButtonDisabled:i,previousButtonDisabled:s,activeStyle:n,inactiveStyle:a,highlightStyle:r,highlightActive:o}=this,l=(c,h)=>h?a:c===o?r:n;this.updateMarker(e,l("next",i)),this.updateMarker(t,l("previous",s))}updateMarker(e,t){var n;const{shape:i,size:s}=this.marker;e.shape=i,e.size=s,e.fill=t.fill,e.fillOpacity=(n=t.fillOpacity)!=null?n:1,e.stroke=t.stroke,e.strokeWidth=t.strokeWidth,e.strokeOpacity=t.strokeOpacity}enableOrDisableButtons(){const{currentPage:e,totalPages:t}=this,i=t===0,s=e===t-1,n=e===0;this.nextButtonDisabled=s||i,this.previousButtonDisabled=n||i}setPage(e){e=we(0,e,Math.max(0,this.totalPages-1)),this.currentPage!==e&&(this.currentPage=e,this.onPaginationChanged())}getCursor(e){return{previous:this.previousButtonDisabled,next:this.nextButtonDisabled}[e]?void 0:"pointer"}onClick(e,t){e.preventDefault(),t==="next"&&!this.nextButtonDisabled?(this.incrementPage(),this.onPaginationChanged()):t==="previous"&&!this.previousButtonDisabled&&(this.decrementPage(),this.onPaginationChanged())}onMouseHover(e){this.highlightActive=e,this.updateMarkers(),this.chartUpdateCallback(7)}onPaginationChanged(){this.pageUpdateCallback(this.currentPage)}incrementPage(){this.currentPage=Math.min(this.currentPage+1,this.totalPages-1)}decrementPage(){this.currentPage=Math.max(this.currentPage-1,0)}onMarkerShapeChange(){this.updatePositions(),this.updateMarkers(),this.chartUpdateCallback(7)}attachPagination(e){e.append(this.group)}getBBox(){return this.group.getBBox()}computeCSSBounds(){const e=ai.toCanvas(this.previousButton),t=ai.toCanvas(this.nextButton);return{prev:e,next:t}}};Dh.className="Pagination",I([P],Dh.prototype,"marker",2),I([P],Dh.prototype,"activeStyle",2),I([P],Dh.prototype,"inactiveStyle",2),I([P],Dh.prototype,"highlightStyle",2),I([P],Dh.prototype,"label",2);var xae=class{constructor(e,t){this.dirty=!0,this.destroyFns=new K0,this.itemList=e.proxyInteractionService.createProxyContainer({type:"list",domManagerId:`${t}-toolbar`,classList:["ag-charts-proxy-legend-toolbar"],ariaLabel:{id:"ariaLabelLegend"}}),this.paginationGroup=e.proxyInteractionService.createProxyContainer({type:"group",domManagerId:`${t}-pagination`,classList:["ag-charts-proxy-legend-pagination"],ariaLabel:{id:"ariaLabelLegendPagination"},ariaOrientation:"horizontal"}),this.itemDescription=ke("p"),this.itemDescription.style.display="none",this.itemDescription.id=sh(),this.itemDescription.textContent=this.getItemAriaDescription(e.localeManager),this.itemList.getElement().append(this.itemDescription)}destroy(){this.destroyFns.destroy()}initLegendList(e){if(!this.dirty)return;const{ctx:t,itemSelection:i,datumReader:s,itemListener:n}=e,a=t.localeManager,r=i.length;i.each((o,l,c)=>{var d;(d=o.proxyButton)==null||d.destroy(),o.proxyButton=t.proxyInteractionService.createProxyElement({type:"listswitch",textContent:this.getItemAriaText(a,s.getItemLabel(l),c,r),ariaChecked:!!o.datum.enabled,ariaDescribedBy:this.itemDescription.id,parent:this.itemList});const h=o.proxyButton;h.addListener("click",u=>n.onClick(u.sourceEvent,o.datum,h)),h.addListener("dblclick",u=>n.onDoubleClick(u.sourceEvent,o.datum)),h.addListener("mouseenter",u=>n.onHover(u.sourceEvent,o)),h.addListener("mouseleave",()=>n.onLeave()),h.addListener("contextmenu",u=>n.onContextClick(u,o)),h.addListener("blur",()=>n.onLeave()),h.addListener("focus",u=>n.onHover(u.sourceEvent,o)),h.addListener("drag-start",()=>{})}),this.dirty=!1}update(e){e.visible&&(this.initLegendList(e),this.updateItemProxyButtons(e),this.updatePaginationProxyButtons(e,!0)),this.updateVisibility(e.visible)}updateVisibility(e){this.itemList.setHidden(!e),this.paginationGroup.setHidden(!e)}updateItemProxyButtons({itemSelection:e,group:t,pagination:i,interactive:s}){const n=ai.toCanvas(t);this.itemList.setBounds(n);const a=Math.max(...e.nodes().map(r=>r.getBBox().height));e.each((r,o)=>{if(r.proxyButton){const l=r.pageIndex===i.currentPage,{x:c,y:h,height:d,width:u}=ai.toCanvas(r),p=(a-d)/2,g={x:c-n.x,y:h-p-n.y,height:a,width:u},f=s&&l;r.proxyButton.setCursor("pointer"),r.proxyButton.setEnabled(f),r.proxyButton.setPointerEvents(f?void 0:"none"),r.proxyButton.setBounds(g)}})}updatePaginationProxyButtons(e,t){var a,r,o,l,c,h,d,u,p,g;const{pagination:i}=e;if(this.paginationGroup.setHidden(!i.visible),t&&"ctx"in e){const{ctx:f,oldPages:y,newPages:v}=e,x=((a=y==null?void 0:y.length)!=null?a:v.length)>1,S=v.length>1;x!==S&&(S?(this.prevButton=f.proxyInteractionService.createProxyElement({type:"button",textContent:{id:"ariaLabelLegendPagePrevious"},tabIndex:0,parent:this.paginationGroup}),this.prevButton.addListener("click",M=>this.onPageButton(e,M,"previous")),this.prevButton.addListener("mouseenter",()=>i.onMouseHover("previous")),this.prevButton.addListener("mouseleave",()=>i.onMouseHover(void 0)),(r=this.nextButton)!=null||(this.nextButton=f.proxyInteractionService.createProxyElement({type:"button",textContent:{id:"ariaLabelLegendPageNext"},tabIndex:0,parent:this.paginationGroup})),this.nextButton.addListener("click",M=>this.onPageButton(e,M,"next")),this.nextButton.addListener("mouseenter",()=>i.onMouseHover("next")),this.nextButton.addListener("mouseleave",()=>i.onMouseHover(void 0))):((o=this.nextButton)==null||o.destroy(),(l=this.prevButton)==null||l.destroy(),this.nextButton=void 0,this.prevButton=void 0))}const{prev:s,next:n}=i.computeCSSBounds();(c=this.prevButton)==null||c.setBounds(s),(h=this.nextButton)==null||h.setBounds(n),(d=this.prevButton)==null||d.setEnabled(i.currentPage!==0),(u=this.nextButton)==null||u.setEnabled(i.currentPage!==i.totalPages-1),(p=this.nextButton)==null||p.setCursor(i.getCursor("next")),(g=this.prevButton)==null||g.setCursor(i.getCursor("previous"))}onPageButton(e,t,i){e.pagination.onClick(t.sourceEvent,i),this.updatePaginationProxyButtons(e,!1)}onDataUpdate(e,t){this.dirty=e.length!==t.length||e.some((i,s,n)=>{const[a,r]=[t[s],e[s]];return a.id!==r.id})}onLocaleChanged(e,t,i){const s=t.length;t.each(({proxyButton:n},a,r)=>{const o=n==null?void 0:n.getElement();if(o!=null){const l=i.getItemLabel(a);o.textContent=this.getItemAriaText(e,l,r,s)}}),this.itemDescription.textContent=this.getItemAriaDescription(e)}onPageChange(e){this.updateItemProxyButtons(e),this.updatePaginationProxyButtons(e,!1)}getItemAriaText(e,t,i,s){return i>=0&&t?(i++,e.t("ariaLabelLegendItem",{label:t,index:i,count:s})):e.t("ariaLabelLegendItemUnknown")}getItemAriaDescription(e){return e.t("ariaDescriptionLegendItem")}};function oO(e,t,i,s){const n={defaultPrevented:!1,apiEvent:{type:e,itemId:t,seriesId:i,event:s,preventDefault:()=>n.defaultPrevented=!0}};return n}var Da=class extends hh(Ge){constructor(){super({name:"markerLabelGroup"}),this.symbolsGroup=this.appendChild(new Ge({name:"legend-markerLabel-symbols"})),this.label=this.appendChild(new is),this.enabled=!0,this.pageIndex=NaN,this.spacing=0,this.length=0,this.isCustomMarker=!1,this.marker=this.symbolsGroup.appendChild(new rs({zIndex:1})),this.line=this.symbolsGroup.appendChild(new Ks({zIndex:0}));const{label:e,line:t,symbolsGroup:i}=this;t.visible=!1,i.renderToOffscreenCanvas=!0,i.optimizeForInfrequentRedraws=!0,e.textBaseline="middle",e.fontSize=12,e.fontFamily="Verdana, sans-serif",e.fill="black",e.y=1}destroy(){var e;super.destroy(),(e=this.proxyButton)==null||e.destroy()}setEnabled(e){this.enabled=e,this.refreshVisibilities()}getTextMeasureBBox(){return this.layout(),ve.merge([this.symbolsGroup.getBBox(),this.label.getTextMeasureBBox()])}refreshVisibilities(){const e=this.enabled?1:.5;this.label.opacity=e,this.opacity=e}layout(){const{marker:e,line:t,length:i,isCustomMarker:s}=this;let n=0,a=0;if(e.visible){const{size:r}=e,o=rs.anchor(e.shape);n=(o.x-.5)*r+i/2,a=(o.y-.5)*r,s?(e.x=0,e.y=0,e.translationX=n,e.translationY=a):(e.x=n,e.y=a,e.translationX=0,e.translationY=0)}t.visible&&(t.x1=0,t.x2=i,t.y1=0,t.y2=0)}preRender(e){const t=super.preRender(e);return this.layout(),t}layoutLabel(){const{length:e,spacing:t}=this;this.label.x=e+t}computeBBox(){return this.layout(),super.computeBBox()}};Da.className="MarkerLabel",I([us("label")],Da.prototype,"text",2),I([us("label")],Da.prototype,"fontStyle",2),I([us("label")],Da.prototype,"fontWeight",2),I([us("label")],Da.prototype,"fontSize",2),I([us("label")],Da.prototype,"fontFamily",2),I([us("label","fill")],Da.prototype,"color",2),I([Rl(e=>e.layoutLabel())],Da.prototype,"spacing",2),I([Rl(e=>e.layoutLabel())],Da.prototype,"length",2),I([he()],Da.prototype,"isCustomMarker",2);var jl=class extends Be{constructor(){super(...arguments),this.maxLength=void 0,this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}};I([P],jl.prototype,"maxLength",2),I([P],jl.prototype,"color",2),I([P],jl.prototype,"fontStyle",2),I([P],jl.prototype,"fontWeight",2),I([P],jl.prototype,"fontSize",2),I([P],jl.prototype,"fontFamily",2),I([P],jl.prototype,"formatter",2);var ku=class extends Be{constructor(){super(...arguments),this.shape=void 0,this.size=15,this.padding=8}};I([P],ku.prototype,"shape",2),I([P],ku.prototype,"size",2),I([P],ku.prototype,"padding",2),I([P],ku.prototype,"strokeWidth",2),I([P],ku.prototype,"enabled",2);var rD=class extends Be{};I([P],rD.prototype,"strokeWidth",2),I([P],rD.prototype,"length",2);var Hl=class extends Be{constructor(){super(...arguments),this.paddingX=16,this.paddingY=8,this.showSeriesStroke=!1,this.marker=new ku,this.label=new jl,this.line=new rD}};I([P],Hl.prototype,"maxWidth",2),I([P],Hl.prototype,"paddingX",2),I([P],Hl.prototype,"paddingY",2),I([P],Hl.prototype,"showSeriesStroke",2),I([P],Hl.prototype,"marker",2),I([P],Hl.prototype,"label",2),I([P],Hl.prototype,"line",2);var oD=class extends Be{};I([P],oD.prototype,"legendItemClick",2),I([P],oD.prototype,"legendItemDoubleClick",2);var Cae={type:"gradient",bounds:"item",gradient:"linear",colorStops:[{color:"black"}],rotation:0,reverse:!1},Sae={type:"pattern",pattern:"forward-slanted-lines",width:8,height:8,padding:1,fill:"black",fillOpacity:1,backgroundFill:"white",backgroundFillOpacity:1,stroke:"black",strokeOpacity:1,strokeWidth:0,rotation:0,scale:1},Mae={type:"image",backgroundFill:"black",backgroundFillOpacity:1,rotation:0,repeat:"no-repeat",fit:"contain",width:8,height:8},An=class extends Be{constructor(e){super(),this.ctx=e,this.id=Hs(this),this.group=new ds({name:"legend",zIndex:14}),this.itemSelection=Pi.select(this.group,Da),this.oldSize=[0,0],this.pages=[],this.maxPageSize=[0,0],this.paginationTrackingIndex=0,this.truncatedItems=new Set,this._data=[],this.toggleSeries=!0,this.item=new Hl,this.listeners=new oD,this.enabled=!0,this.position="bottom",this.spacing=20,this.destroyFns=[],this.size=[0,0],this._visible=!0,this.pagination=new Dh(i=>e.updateService.update(i),i=>this.updatePageNumber(i)),this.pagination.attachPagination(this.group);const{items:t}=e.contextMenuRegistry.builtins;t["toggle-series-visibility"].action=i=>this.contextToggleVisibility(i),t["toggle-other-series"].action=i=>this.contextToggleOtherSeries(i),this.destroyFns.push(e.legendManager.addListener("legend-change",this.onLegendDataChange.bind(this))),this.destroyFns.push(()=>delete t["toggle-series-visibility"].action,()=>delete t["toggle-other-series"].action,e.layoutManager.registerElement(1,i=>this.positionLegend(i)),e.localeManager.addListener("locale-changed",()=>this.onLocaleChanged()),()=>this.group.remove()),this.domProxy=new xae(this.ctx,this.id),this.ctx.historyManager.addMementoOriginator(e.legendManager)}set data(e){dn(e,this._data)||(this.domProxy.onDataUpdate(this._data,e),this._data=e,this.updateGroupVisibility())}get data(){return this._data}onLegendDataChange({legendData:e=[]}){this.enabled&&(this.data=e.filter(t=>!t.hideInLegend))}destroy(){this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-toolbar`),this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-pagination`),this.destroyFns.forEach(e=>e()),this.itemSelection.clear(),this.domProxy.destroy()}getOrientation(){var e;return(e=this.orientation)!=null?e:"horizontal"}set visible(e){this._visible=e,this.updateGroupVisibility()}get visible(){return this._visible}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible&&this.data.length>0}attachLegend(e){e.appendChild(this.group)}getItemLabel(e){const{formatter:t}=this.item.label;if(t){const i=e.datum;return this.cachedCallWithContext(t,b({itemId:e.itemId,value:e.label.text,seriesId:e.seriesId},i&&{datum:i}))}return e.label.text}calcLayout(e,t){const{paddingX:i,paddingY:s,label:n,maxWidth:a,label:{maxLength:r=1/0,fontStyle:o,fontWeight:l,fontSize:c,fontFamily:h}}=this.item,d=[...this.data];this.reverseOrder&&d.reverse(),this.itemSelection.update(d);const u=[],p=_t.toFontString(n),f=a!=null?a:e*.8,{markerWidth:y,anyLineEnabled:v}=this.calculateMarkerWidth();if(this.itemSelection.each((N,O)=>{var G;N.fontStyle=o,N.fontWeight=l,N.fontSize=c,N.fontFamily=h;const L=this.updateMarkerLabel(N,O,y,v),F=(G=O.itemId)!=null?G:O.id,B=this.getItemLabel(O),_=(B!=null?B:"<unknown>").replace(/\r?\n/g," ");N.text=this.truncate(_,r,f,L,p,F),u.push(N.getTextMeasureBBox())}),e=Math.max(1,e),t=Math.max(1,t),!isFinite(e))return{};const x=this.size,S=this.oldSize;x[0]=e,x[1]=t,(x[0]!==S[0]||x[1]!==S[1])&&(S[0]=x[0],S[1]=x[1]);const{pages:M,maxPageHeight:D,maxPageWidth:A}=this.updatePagination(u,e,t),w=this.pages;this.pages=M,this.maxPageSize=[A-i,D-s];const T=this.pagination.currentPage,k=this.pages[T];return this.pages.length<1||!k?(this.visible=!1,{oldPages:w}):(this.visible=!0,this.updatePositions(T),this.update(),{oldPages:w})}isCustomMarker(e,t){return e&&t!==void 0&&typeof t!="string"}calcSymbolsEnabled(e){var r;const{showSeriesStroke:t,marker:i}=this.item,s=!!i.enabled||!t||((r=e.marker.enabled)!=null?r:!0),n=!!(e.line&&t),a=this.isCustomMarker(s,e.marker.shape);return{markerEnabled:s,lineEnabled:n,isCustomMarker:a}}calcSymbolsLengths(e,t,i){var c;const{marker:s,line:n}=this.item;let a;const{shape:r}=e.marker;if(this.isCustomMarker(t,r)){const h=new rs;h.shape=r,h.updatePath();const d=h.getBBox();a=Math.max(d.width,d.height)}const o=t?s.size:0,l=i?(c=n.length)!=null?c:25:0;return{markerLength:o,lineLength:l,customMarkerSize:a}}calculateMarkerWidth(){let e=0,t=!1;return this.itemSelection.each((i,s)=>{const{symbol:n}=s,{lineEnabled:a,markerEnabled:r}=this.calcSymbolsEnabled(n),{markerLength:o,lineLength:l,customMarkerSize:c=-1/0}=this.calcSymbolsLengths(n,r,a);e=Math.max(e,l,c,o),t||(t=a)}),{markerWidth:e,anyLineEnabled:t}}updateMarkerLabel(e,t,i,s){var p,g;const{marker:n,paddingX:a}=this.item,{symbol:r}=t;let o=a;const{markerEnabled:l,isCustomMarker:c}=this.calcSymbolsEnabled(r),h=n.padding;(l||s)&&(o+=h+i);const{marker:d,line:u}=e;return d.visible=l,d.visible&&(d.shape=(g=(p=n.shape)!=null?p:r.marker.shape)!=null?g:"square",d.size=n.size,xh(d,this.getMarkerStyles(r))),u.visible=s,u.visible&&xh(u,this.getLineStyles(r)),e.length=i,e.spacing=h,e.isCustomMarker=c,o}truncate(e,t,i,s,n,a){let r=!1;e.length>t&&(e=e.substring(0,t),r=!0);const o=Rr.getMeasurer({font:n}),l=H0.truncateLine(e,o,i-s,r);return l.endsWith(_t.EllipsisChar)?this.truncatedItems.add(a):this.truncatedItems.delete(a),l}updatePagination(e,t,i){const s=this.getOrientation(),n=Math.min(this.paginationTrackingIndex,e.length);this.pagination.orientation=s,this.pagination.translationX=0,this.pagination.translationY=0;const{pages:a,maxPageHeight:r,maxPageWidth:o,paginationBBox:l,paginationVertical:c}=this.calculatePagination(e,t,i),h=a.findIndex(S=>S.endIndex>=n);this.pagination.currentPage=we(0,h,a.length-1);const{paddingX:d,paddingY:u}=this.item,p=8,g=o-d,f=r-u;let y=0,v=-l.y-this.item.marker.size/2;c?v+=f+p:(y+=-l.x+g+p,v+=(f-l.height)/2),this.pagination.translationX=y,this.pagination.translationY=v,this.pagination.update(),this.pagination.updateMarkers();let x=0;return this.itemSelection.each((S,M,D)=>{var A,w;D>((w=(A=a[x])==null?void 0:A.endIndex)!=null?w:1/0)&&x++,S.pageIndex=x}),{maxPageHeight:r,maxPageWidth:o,pages:a}}calculatePagination(e,t,i){var f,y,v;const{paddingX:s,paddingY:n}=this.item,a=this.getOrientation(),r=["left","right"].includes(this.position);let o=this.pagination.getBBox(),l=new ve(0,0,0,0),c=[],h=0,d=0,u=0;const p=x=>x.width===o.width&&x.height===o.height,g=this.maxWidth!==void 0&&this.maxHeight!==void 0;do{if(u++>10){se.warn("unable to find stable legend layout.");break}o=l;const x=t-(r?0:o.width),S=i-(r?o.height:0),M=gae({orientation:a,bboxes:e,maxHeight:S,maxWidth:x,itemPaddingY:n,itemPaddingX:s,forceResult:g});c=(f=M==null?void 0:M.pages)!=null?f:[],h=(y=M==null?void 0:M.maxPageWidth)!=null?y:0,d=(v=M==null?void 0:M.maxPageHeight)!=null?v:0;const D=c.length;if(this.pagination.visible=D>1,this.pagination.totalPages=D,this.pagination.update(),this.pagination.updateMarkers(),l=this.pagination.getBBox(),!this.pagination.visible)break}while(!p(l));return{maxPageWidth:h,maxPageHeight:d,pages:c,paginationBBox:l,paginationVertical:r}}updatePositions(e=0){const{item:{paddingY:t},itemSelection:i,pages:s}=this;if(s.length<1||!s[e])return;const{columns:n,startIndex:a,endIndex:r}=s[e];let o=0,l=0;const c=n.length,h=n[0].indices.length,d=this.getOrientation()==="horizontal",u=n[0].bboxes[0].height+t,p=[];i.each((g,f,y)=>{var D,A;if(y<a||y>r){g.visible=!1;return}const v=y-a;let x,S;d?(x=v%c,S=Math.floor(v/c)):(x=Math.floor(v/h),S=v%h),g.visible=!0;const M=n[x];M&&(l=Math.floor(u*S),o=Math.floor((D=p[S])!=null?D:0),p[S]=((A=p[S])!=null?A:0)+M.columnWidth,g.translationX=o,g.translationY=l)})}updatePageNumber(e){const{itemSelection:t,group:i,pagination:s,pages:n,toggleSeries:a}=this,{startIndex:r,endIndex:o}=n[e];r===0?this.paginationTrackingIndex=0:e===n.length-1?this.paginationTrackingIndex=o:this.paginationTrackingIndex=Math.floor((r+o)/2),this.pagination.update(),this.pagination.updateMarkers(),this.updatePositions(e),this.domProxy.onPageChange({itemSelection:t,group:i,pagination:s,interactive:a}),this.ctx.updateService.update(7)}update(){const{label:{color:e}}=this.item;this.itemSelection.each((t,i)=>{t.setEnabled(i.enabled),t.color=e}),this.updateContextMenu()}updateContextMenu(){this.ctx.contextMenuRegistry.setVisible("toggle-series-visibility",this.toggleSeries),this.ctx.contextMenuRegistry.setVisible("toggle-other-series",this.toggleSeries)}getLineStyles(e){var r,o;const{stroke:t,strokeOpacity:i=1,strokeWidth:s,lineDash:n}=(r=e.line)!=null?r:{},a=Math.min(2,s!=null?s:1);return{stroke:t,strokeOpacity:i,strokeWidth:(o=this.item.line.strokeWidth)!=null?o:a,lineDash:n}}getMarkerStyles({marker:e}){var c,h;const{fill:t,stroke:i,strokeOpacity:s=1,fillOpacity:n=1,strokeWidth:a,lineDash:r,lineDashOffset:o}=e,l=Math.min(2,a!=null?a:1);return ch(t)&&(t.width=8,t.height=8,t.padding=1,t.strokeWidth=Math.min(2,(c=t.strokeWidth)!=null?c:2)),eu(t)&&(t.fit="contain",t.width=void 0,t.height=void 0,t.repeat="no-repeat"),Br({fill:t,stroke:i,strokeOpacity:s,fillOpacity:n,strokeWidth:(h=this.item.marker.strokeWidth)!=null?h:l,lineDash:r,lineDashOffset:o},Cae,Sae,Mae)}computePagedBBox(){const e=Ge.computeChildrenBBox(this.group.children());if(this.pages.length>1){const[t,i]=this.maxPageSize;e.height=Math.max(i,e.height),e.width=Math.max(t,e.width)}return e}findNode(e){var s;const{datum:t,proxyButton:i}=(s=this.itemSelection.select(n=>{var a;return((a=n.datum)==null?void 0:a.itemId)===e.itemId})[0])!=null?s:{};if(t===void 0||i===void 0)throw new Error(`AG Charts - Missing required properties { datum: ${t}, proxyButton: ${JSON.stringify(i)} }`);return{datum:t,proxyButton:i}}contextToggleVisibility(e){const{datum:t,proxyButton:i}=this.findNode(e);this.doClick(e.event,t,i)}contextToggleOtherSeries(e){this.doDoubleClick(e.event,this.findNode(e).datum)}onContextClick(e,t){var c,h,d;const{sourceEvent:i}=e,s=t.datum;this.preventHidingAll&&((c=this.contextMenuDatum)!=null&&c.enabled)&&this.getVisibleItemCount()<=1?this.ctx.contextMenuRegistry.builtins.items["toggle-series-visibility"].enabled=!1:this.ctx.contextMenuRegistry.builtins.items["toggle-series-visibility"].enabled=!0;const n=this.ctx.chartService.series.length>1&&((d=(h=this.ctx.chartService.series[0])==null?void 0:h.getLegendData("category")[0])==null?void 0:d.hideToggleOtherSeries)!==!0;this.ctx.contextMenuRegistry.setVisible("toggle-other-series",n);const{offsetX:a,offsetY:r}=i,{x:o,y:l}=ai.toCanvasPoint(t,a,r);this.ctx.contextMenuRegistry.dispatchContext("legend-item",{widgetEvent:e,canvasX:o,canvasY:l},{legendItem:s})}onClick(e,t,i){this.doClick(e,t,i)&&e.preventDefault()}getVisibleItemCount(){return this.ctx.chartService.series.flatMap(e=>e.getLegendData("category")).filter(e=>e.enabled).length}doClick(e,t,i){var f;const{listeners:{legendItemClick:s},ctx:{chartService:n,highlightManager:a},preventHidingAll:r,toggleSeries:o}=this;if(!t)return!1;const{legendType:l,seriesId:c,itemId:h,enabled:d}=t,u=n.series.find(y=>y.id===c);if(!u)return!1;let p=d;const g=oO("click",h,u.id,e);return s==null||s(g.apiEvent),g.defaultPrevented||(o&&(p=!d,r&&!p&&this.getVisibleItemCount()<2&&(p=!0),i.setChecked(p),this.ctx.chartEventManager.legendItemClick(l,u,h,p,t.legendItemName)),p?a.updateHighlight(this.id,{series:u,itemId:h,datum:void 0,datumIndex:void 0}):a.updateHighlight(this.id),this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0,skipAnimations:(f=t.skipAnimations)!=null?f:!1})),!0}onDoubleClick(e,t){this.doDoubleClick(e,t)&&e.preventDefault()}doDoubleClick(e,t){var d;const{listeners:{legendItemDoubleClick:i},ctx:{chartService:s},toggleSeries:n}=this;if(!t)return!1;const{legendType:a,id:r,itemId:o,seriesId:l}=t,c=s.series.find(u=>u.id===r);if(!c)return!1;const h=oO("dblclick",o,c.id,e);if(i==null||i(h.apiEvent),h.defaultPrevented)return!0;if(n){const u=s.series.flatMap(y=>y.getLegendData("category"));let p=0;const g=new Set;for(const y of u)y.enabled&&(p+=1,y.legendItemName!=null&&g.add(y.legendItemName));g.size>0&&(p=g.size);const f=u.find(y=>y.itemId===o&&y.seriesId===l);this.ctx.chartEventManager.legendItemDoubleClick(a,c,o,(d=f==null?void 0:f.enabled)!=null?d:!1,p,f==null?void 0:f.legendItemName)}return this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),!0}toTooltipMeta(e,t){let i;return e instanceof FocusEvent?i=ai.toCanvas(t).computeCenter():(e.preventDefault(),i=ai.toCanvasPoint(t,e.offsetX,e.offsetY)),{canvasX:i.x,canvasY:i.y,showArrow:!1}}onHover(e,t){var n;if(!this.enabled)throw new Error("AG Charts - onHover handler called on disabled legend");this.pagination.setPage(t.pageIndex);const i=t.datum,s=i?this.ctx.chartService.series.find(a=>a.id===(i==null?void 0:i.id)):void 0;if(i&&this.truncatedItems.has((n=i.itemId)!=null?n:i.id)){const a=this.toTooltipMeta(e,t);this.ctx.tooltipManager.updateTooltip(this.id,a,[{type:"structured",title:this.getItemLabel(i)}])}else this.ctx.tooltipManager.removeTooltip(this.id);i!=null&&i.enabled&&s?this.updateHighlight({series:s,itemId:i==null?void 0:i.itemId,datum:void 0,datumIndex:void 0}):this.updateHighlight()}onLeave(){this.ctx.tooltipManager.removeTooltip(this.id),this.updateHighlight()}updateHighlight(e){this.ctx.interactionManager.isState(32)?this.ctx.highlightManager.updateHighlight(this.id,e):this.ctx.interactionManager.isState(2)&&(this.pendingHighlightDatum=e,this.ctx.animationManager.onBatchStop(()=>{this.ctx.highlightManager.updateHighlight(this.id,this.pendingHighlightDatum)}))}onLocaleChanged(){this.domProxy.onLocaleChanged(this.ctx.localeManager,this.itemSelection,this)}positionLegend(e){const t=this.positionLegendScene(e);this.positionLegendDOM(t)}positionLegendScene(e){if(!this.enabled||!this.data.length)return;const{layoutBox:t}=e,{x:i,y:s,width:n,height:a}=t,[r,o]=this.calculateLegendDimensions(t),{oldPages:l}=this.calcLayout(r,o),c=this.computePagedBBox(),h=()=>{switch(this.position){case"top":case"left":return 0;case"bottom":return a-c.height;case"right":default:return n-c.width}};if(this.visible){const d=this.spacing;let u,p;switch(this.position){case"top":case"bottom":u=(n-c.width)/2,p=h(),t.shrink(c.height+d,this.position);break;case"left":case"right":default:u=h(),p=(a-c.height)/2,t.shrink(c.width+d,this.position)}this.group.translationX=Math.floor(i+u-c.x),this.group.translationY=Math.floor(s+p-c.y)}return l}positionLegendDOM(e){const{ctx:t,itemSelection:i,pagination:s,pages:n,toggleSeries:a,group:r,listeners:{legendItemClick:o,legendItemDoubleClick:l}}=this,c=this.visible&&this.enabled,h=a||l!=null||o!=null;this.domProxy.update({visible:c,interactive:h,ctx:t,itemSelection:i,group:r,pagination:s,oldPages:e,newPages:n,datumReader:this,itemListener:this})}calculateLegendDimensions(e){const{width:t,height:i}=e,s=t/i,n=.5,a=.2,r=.25;let o,l;switch(this.position){case"top":case"bottom":{const c=s<1?Math.min(n,a*(1/s)):a;o=this.maxWidth?Math.min(this.maxWidth,t):t,l=this.maxHeight?Math.min(this.maxHeight,i):Math.round(i*c);break}case"left":case"right":default:{const c=s>1?Math.min(n,r*s):r;o=this.maxWidth?Math.min(this.maxWidth,t):Math.round(t*c),l=this.maxHeight?Math.min(this.maxHeight,i):i}}return[o,l]}cachedCallWithContext(e,...t){const{callbackCache:i,chartService:s}=this.ctx;return i.call(this,s,e,...t)}};An.className="Legend",I([P],An.prototype,"toggleSeries",2),I([P],An.prototype,"pagination",2),I([P],An.prototype,"item",2),I([P],An.prototype,"listeners",2),I([Rl((e,t,i)=>{if(e.updateGroupVisibility(),t===i)return;const{ctx:{legendManager:s,stateManager:n}}=e;i===!1&&t===!0&&n.restoreState(s)}),P],An.prototype,"enabled",2),I([P],An.prototype,"position",2),I([P],An.prototype,"maxWidth",2),I([P],An.prototype,"maxHeight",2),I([P],An.prototype,"reverseOrder",2),I([P],An.prototype,"orientation",2),I([P],An.prototype,"preventHidingAll",2),I([P],An.prototype,"spacing",2);var Dae={type:"legend",optionsKey:"legend",identifier:"category",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new An(e),packageType:"community",removable:"standalone-only"},lO={};Ua(lO,{CARTESIAN_AXIS_TYPE:()=>dO,CARTESIAN_POSITION:()=>hO,FONT_SIZE:()=>cO,FONT_SIZE_RATIO:()=>lD,POLAR_AXIS_SHAPE:()=>pO,POLAR_AXIS_TYPE:()=>uO});var cO=(e=>(e[e.SMALLEST=8]="SMALLEST",e[e.SMALLER=10]="SMALLER",e[e.SMALL=12]="SMALL",e[e.MEDIUM=13]="MEDIUM",e[e.LARGE=14]="LARGE",e[e.LARGEST=17]="LARGEST",e))(cO||{}),lD=(e=>(e[e.SMALLEST=.6666666666666666]="SMALLEST",e[e.SMALLER=.8333333333333334]="SMALLER",e[e.SMALL=1]="SMALL",e[e.MEDIUM=1.0833333333333333]="MEDIUM",e[e.LARGE=1.1666666666666667]="LARGE",e[e.LARGEST=1.4166666666666667]="LARGEST",e))(lD||{}),hO=(e=>(e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.LEFT="left",e))(hO||{}),dO=(e=>(e.CATEGORY="category",e.GROUPED_CATEGORY="grouped-category",e.ORDINAL_TIME="ordinal-time",e.UNIT_TIME="unit-time",e.NUMBER="number",e.TIME="time",e.LOG="log",e))(dO||{}),uO=(e=>(e.ANGLE_CATEGORY="angle-category",e.ANGLE_NUMBER="angle-number",e.RADIUS_CATEGORY="radius-category",e.RADIUS_NUMBER="radius-number",e))(uO||{}),pO=(e=>(e.CIRCLE="circle",e.POLYGON="polygon",e))(pO||{}),cD={};Ua(cD,{DEFAULT_ANNOTATION_HANDLE_FILL:()=>Jg,DEFAULT_ANNOTATION_STATISTICS_COLOR:()=>sf,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:()=>nf,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:()=>af,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:()=>rf,DEFAULT_ANNOTATION_STATISTICS_FILL:()=>ef,DEFAULT_ANNOTATION_STATISTICS_STROKE:()=>tf,DEFAULT_CAPTION_ALIGNMENT:()=>Kl,DEFAULT_CAPTION_LAYOUT_STYLE:()=>Ul,DEFAULT_FIBONACCI_STROKES:()=>qg,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:()=>Wi,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:()=>li,DEFAULT_GRIDLINE_ENABLED:()=>ir,DEFAULT_POLAR_SERIES_STROKE:()=>Av,DEFAULT_SEPARATION_LINES_COLOUR:()=>Zg,DEFAULT_SHADOW_COLOUR:()=>Wl,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:()=>Iv,DEFAULT_TEXTBOX_COLOR:()=>cf,DEFAULT_TEXTBOX_FILL:()=>of,DEFAULT_TEXTBOX_STROKE:()=>lf,DEFAULT_TEXT_ANNOTATION_COLOR:()=>Qg,DEFAULT_TOOLBAR_POSITION:()=>hf,IS_DARK_THEME:()=>Lu,PALETTE_ALT_DOWN_FILL:()=>pD,PALETTE_ALT_DOWN_STROKE:()=>dD,PALETTE_ALT_NEUTRAL_FILL:()=>gD,PALETTE_ALT_NEUTRAL_STROKE:()=>fD,PALETTE_ALT_UP_FILL:()=>uD,PALETTE_ALT_UP_STROKE:()=>hD,PALETTE_DOWN_FILL:()=>Mv,PALETTE_DOWN_STROKE:()=>Cv,PALETTE_NEUTRAL_FILL:()=>wv,PALETTE_NEUTRAL_STROKE:()=>Dv,PALETTE_UP_FILL:()=>Sv,PALETTE_UP_STROKE:()=>xv});var Lu=Symbol("is-dark-theme"),Zg=Symbol("default-separation-lines-colour"),Wl=Symbol("default-shadow-colour"),Ul=Symbol("default-caption-layout-style"),Kl=Symbol("default-caption-alignment"),xv=Symbol("palette-up-stroke"),Cv=Symbol("palette-down-stroke"),Sv=Symbol("palette-up-fill"),Mv=Symbol("palette-down-fill"),Dv=Symbol("palette-neutral-stroke"),wv=Symbol("palette-neutral-fill"),hD=Symbol("palette-alt-up-stroke"),dD=Symbol("palette-alt-down-stroke"),uD=Symbol("palette-alt-up-fill"),pD=Symbol("palette-alt-down-fill"),gD=Symbol("palette-gray-fill"),fD=Symbol("palette-gray-stroke"),Av=Symbol("default-polar-series-stroke"),Iv=Symbol("default-sparkline-crosshair-stroke"),li=Symbol("default-financial-charts-annotation-stroke"),qg=Symbol("default-hierarchy-strokes"),Qg=Symbol("default-text-annotation-color"),Wi=Symbol("default-financial-charts-annotation-background-fill"),Jg=Symbol("default-annotation-handle-fill"),ef=Symbol("default-annotation-statistics-fill"),tf=Symbol("default-annotation-statistics-stroke"),sf=Symbol("default-annotation-statistics-color"),nf=Symbol("default-annotation-statistics-divider-stroke"),af=Symbol("default-annotation-statistics-fill"),rf=Symbol("default-annotation-statistics-stroke"),of=Symbol("default-textbox-fill"),lf=Symbol("default-textbox-stroke"),cf=Symbol("default-textbox-color"),hf=Symbol("default-toolbar-position"),ir=Symbol("default-gridline-enabled"),gO=[{type:"number",position:{$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},"bottom","left"]}},{type:"category",position:{$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},"left","bottom"]}}],wae={$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]},{$isImage:[{$value:"$1"}]}]},{$palette:"fillFallback"},{$palette:"fill"}]},mD={$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]},{$isImage:[{$value:"$1"}]}]},{$palette:"fillsFallback"},{$palette:"fills"}]},Tv={$if:[{$isGradient:[{$palette:"fill"}]},{$palette:"fillFallback"},{$if:[{$isPattern:[{$palette:"fill"}]},{$path:["./stroke",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},Aae={$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]},{$isImage:[{$value:"$1"}]}]},[{$palette:"fillFallback"},{$palette:"fillFallback"}],{$palette:"range2"}]},$l={type:"pattern",pattern:"forward-slanted-lines",width:10,height:10,padding:2,fill:{$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isImage:[{$palette:"fill"}]}]},{$palette:"fillFallback"},{$if:[{$isPattern:[{$palette:"fill"}]},{$path:["./fill",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},fillOpacity:1,stroke:Tv,strokeOpacity:1,strokeWidth:4,backgroundFill:"none",backgroundFillOpacity:1,rotation:0,scale:1},wh={type:"image",backgroundFill:{$palette:"fillFallback"},backgroundFillOpacity:1,repeat:"no-repeat",fit:"contain",rotation:0};function qn(e){return BE(e,t=>{const i=yt.fromString(t);return[yt.darken(i,.15).toString(),t,yt.lighten(i,.15).toString()]})}function kv(e,t,i,s,n){const{addPhaseFn:a,updatePhaseFn:r,removePhaseFn:o}=n,l=(c,h,d)=>{i.animate({id:`${e}_${t}_${h.id}_${c}`,groupId:e,from:0,to:1,ease:Ig,collapsable:!1,onUpdate(u,p){p&&c!=="removed"||(h.path.clear(!0),d(u,h),h.checkPathDirty())},onStop(){c==="added"&&(h.path.clear(!0),d(1,h),h.checkPathDirty())},phase:Za[c]})};for(const c of s)i.isSkipped()||(l("removed",c,o),l("updated",c,r)),l("added",c,a)}function dt({id:e},t,i,...s){for(const n of s)n.cleanup();ko(e,t,i,s,{opacity:0},{opacity:1},{phase:"trailing"})}function Yl({id:e},t,i,...s){ko(e,t,i,s,{opacity:1},{opacity:0},{phase:"remove"})}function Fo(e){return{opacity:1}}var yD=class extends Be{constructor(){super(...arguments),this._dirty=!0}markDirty(){this._dirty=!0}markClean(e){this._dirty=!1}isDirty(){return this._dirty}onChangeDetection(e){this.markDirty()}},sr=class extends yD{constructor(){super(...arguments),this.enabled=!0,this.color="rgba(0, 0, 0, 0.5)",this.xOffset=0,this.yOffset=0,this.blur=5}};I([P,he()],sr.prototype,"enabled",2),I([P,he()],sr.prototype,"color",2),I([P,he()],sr.prototype,"xOffset",2),I([P,he()],sr.prototype,"yOffset",2),I([P,he()],sr.prototype,"blur",2);var Bo=class extends Be{constructor(){super(...arguments),this.fill="rgba(255,255,255, 0.33)",this.stroke="rgba(0, 0, 0, 0.4)",this.strokeWidth=2}};I([P],Bo.prototype,"fill",2),I([P],Bo.prototype,"fillOpacity",2),I([P],Bo.prototype,"stroke",2),I([P],Bo.prototype,"strokeWidth",2),I([P],Bo.prototype,"strokeOpacity",2),I([P],Bo.prototype,"lineDash",2),I([P],Bo.prototype,"lineDashOffset",2);var Lv=class extends Be{};I([P],Lv.prototype,"strokeWidth",2),I([P],Lv.prototype,"dimOpacity",2),I([P],Lv.prototype,"enabled",2);var fO=class extends Be{constructor(){super(...arguments),this.color="black"}};I([P],fO.prototype,"color",2);var vD=class extends Be{constructor(){super(...arguments),this.enabled=!0}};I([P],vD.prototype,"enabled",2);var wa=class extends Be{constructor(){super(...arguments),this.type="gradient",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.reverse=!1}};I([P],wa.prototype,"type",2),I([P],wa.prototype,"colorStops",2),I([P],wa.prototype,"bounds",2),I([P],wa.prototype,"gradient",2),I([P],wa.prototype,"rotation",2),I([P],wa.prototype,"reverse",2);var Wt=class extends Be{constructor(){super(...arguments),this.type="pattern",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.scale=1,this.reverse=!1,this.pattern="forward-slanted-lines",this.width=26,this.height=26,this.padding=6,this.fill="black",this.fillOpacity=1,this.backgroundFill="white",this.backgroundFillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0}};I([P],Wt.prototype,"type",2),I([P],Wt.prototype,"colorStops",2),I([P],Wt.prototype,"bounds",2),I([P],Wt.prototype,"gradient",2),I([P],Wt.prototype,"rotation",2),I([P],Wt.prototype,"scale",2),I([P],Wt.prototype,"reverse",2),I([P],Wt.prototype,"path",2),I([P],Wt.prototype,"pattern",2),I([P],Wt.prototype,"width",2),I([P],Wt.prototype,"height",2),I([P],Wt.prototype,"padding",2),I([P],Wt.prototype,"fill",2),I([P],Wt.prototype,"fillOpacity",2),I([P],Wt.prototype,"backgroundFill",2),I([P],Wt.prototype,"backgroundFillOpacity",2),I([P],Wt.prototype,"stroke",2),I([P],Wt.prototype,"strokeOpacity",2),I([P],Wt.prototype,"strokeWidth",2);var In=class extends Be{constructor(){super(...arguments),this.type="image",this.url="",this.rotation=0,this.scale=1,this.backgroundFill="black",this.backgroundFillOpacity=1,this.repeat="no-repeat",this.fit="contain"}};I([P],In.prototype,"type",2),I([P],In.prototype,"url",2),I([P],In.prototype,"rotation",2),I([P],In.prototype,"scale",2),I([P],In.prototype,"backgroundFill",2),I([P],In.prototype,"backgroundFillOpacity",2),I([P],In.prototype,"repeat",2),I([P],In.prototype,"fit",2);var df=class extends Be{constructor(){super(...arguments),this.item=new Bo,this.series=new Lv,this.text=new fO}};I([P],df.prototype,"item",2),I([P],df.prototype,"series",2),I([P],df.prototype,"text",2);var Qn=class extends Be{constructor(){super(...arguments),this.visible=!0,this.focusPriority=1/0,this.showInLegend=!0,this.cursor="default",this.nodeClickRange="exact",this.highlight=new vD,this.highlightStyle=new df}handleUnknownProperties(e,t){"context"in t&&(this.context=t.context,e.delete("context"))}};I([P],Qn.prototype,"id",2),I([P],Qn.prototype,"visible",2),I([P],Qn.prototype,"focusPriority",2),I([P],Qn.prototype,"showInLegend",2),I([P],Qn.prototype,"cursor",2),I([P],Qn.prototype,"nodeClickRange",2),I([P],Qn.prototype,"highlight",2),I([P],Qn.prototype,"highlightStyle",2);var os=class extends yD{constructor(){super(...arguments),this.enabled=!0,this.shape="circle",this.size=6,this.fillGradientDefaults=new wa,this.fillPatternDefaults=new Wt,this.fillImageDefaults=new In,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{size:e,shape:t,fill:i,fillOpacity:s,stroke:n,strokeWidth:a,strokeOpacity:r,lineDash:o,lineDashOffset:l}=this;return{size:e,shape:t,fill:i,fillOpacity:s,stroke:n,strokeWidth:a,strokeOpacity:r,lineDash:o,lineDashOffset:l}}getDiameter(){return this.size+this.strokeWidth}};I([P,he()],os.prototype,"enabled",2),I([P,$n({equals:Xd})],os.prototype,"shape",2),I([P,he()],os.prototype,"size",2),I([P,$n({equals:dn})],os.prototype,"fill",2),I([P],os.prototype,"fillGradientDefaults",2),I([P],os.prototype,"fillPatternDefaults",2),I([P],os.prototype,"fillImageDefaults",2),I([P,he()],os.prototype,"fillOpacity",2),I([P,he()],os.prototype,"stroke",2),I([P,he()],os.prototype,"strokeWidth",2),I([P,he()],os.prototype,"strokeOpacity",2),I([P],os.prototype,"lineDash",2),I([P],os.prototype,"lineDashOffset",2),I([P,$n({equals:Xd})],os.prototype,"itemStyler",2);var mO=class extends Be{constructor(){super(...arguments),this.enabled=!1}};I([P],mO.prototype,"enabled",2);var Ys=class extends Be{constructor(){super(...arguments),this.interaction=new mO,this.position=new Eo,this.range=void 0,this.class=void 0}formatTooltip(e,t,i,s){const n=this.renderer==null?void 0:$y(e,t,this.renderer,[s]);return typeof n=="string"?{type:"raw",rawHtmlString:n}:n!=null?b(b({type:"structured"},i),n):b({type:"structured"},i)}};I([P],Ys.prototype,"enabled",2),I([P],Ys.prototype,"showArrow",2),I([P],Ys.prototype,"renderer",2),I([P],Ys.prototype,"interaction",2),I([P],Ys.prototype,"position",2),I([P],Ys.prototype,"range",2),I([P],Ys.prototype,"class",2);var Iae=class{constructor(e,t,i){this.root=new Lae(e,t,i)}clear(e){this.root.clear(e)}addValue(e,t){const i={hitTester:e,value:t,distanceSquared:(s,n)=>e.distanceSquared(s,n)};this.root.addElem(i)}find(e,t){const i={best:{nearest:void 0,distanceSquared:1/0}};return this.root.find(e,t,i),i.best}},Tae=class{constructor(e,t,i,s){this.nw=e,this.ne=t,this.sw=i,this.se=s}addElem(e){this.nw.addElem(e),this.ne.addElem(e),this.sw.addElem(e),this.se.addElem(e)}find(e,t,i){this.nw.find(e,t,i),this.ne.find(e,t,i),this.sw.find(e,t,i),this.se.find(e,t,i)}},kae=class{constructor(e,t,i){this.capacity=e,this.maxdepth=t,this.boundary=i!=null?i:ve.NaN,this.elems=[],this.subdivisions=void 0}clear(e){this.elems.length=0,this.boundary=e,this.subdivisions=void 0}addElem(e){this.addCondition(e)&&(this.subdivisions===void 0?this.maxdepth===0||this.elems.length<this.capacity?this.elems.push(e):this.subdivide(e):this.subdivisions.addElem(e))}find(e,t,i){this.findCondition(e,t,i)&&(this.subdivisions===void 0?this.findAction(e,t,i):this.subdivisions.find(e,t,i))}subdivide(e){this.subdivisions=this.makeSubdivisions();for(const t of this.elems)this.subdivisions.addElem(t);this.subdivisions.addElem(e),this.elems.length=0}makeSubdivisions(){const{x:e,y:t,width:i,height:s}=this.boundary,{capacity:n}=this,a=this.maxdepth-1,r=i/2,o=s/2,l=new ve(e,t,r,o),c=new ve(e+r,t,r,o),h=new ve(e,t+o,r,o),d=new ve(e+r,t+o,r,o);return new Tae(this.child(n,a,l),this.child(n,a,c),this.child(n,a,h),this.child(n,a,d))}},Lae=class _j extends kae{addCondition(t){const{x:i,y:s}=t.hitTester.midPoint;return this.boundary.containsPoint(i,s)}findCondition(t,i,s){const{best:n}=s;return n.distanceSquared!==0&&this.boundary.distanceSquared(t,i)<n.distanceSquared}findAction(t,i,s){const n=Dy(t,i,this.elems,s.best.distanceSquared);n.nearest!==void 0&&n.distanceSquared<s.best.distanceSquared&&(s.best=n)}child(t,i,s){return new _j(t,i,s)}},bD=class extends hv{constructor(s){var n=s,{clipFocusBox:e,categoryKey:t}=n,i=We(n,["clipFocusBox","categoryKey"]);super(i),this.categoryKey=t,this.clipFocusBox=e!=null?e:!0}getScaleInformation({xScale:e,yScale:t}){const i=Mt.is(e),s=Mt.is(t);return{isContinuousX:i,isContinuousY:s,xScaleType:e==null?void 0:e.type,yScaleType:t==null?void 0:t.type}}getModulePropertyDefinitions(){var i,s;const e=(i=this.axes.x)==null?void 0:i.scale,t=(s=this.axes.y)==null?void 0:s.scale;return this.moduleMap.mapModules(n=>n.getPropertyDefinitions(this.getScaleInformation({xScale:e,yScale:t}))).flat()}async requestDataModel(e,t,i){i.props.push(...this.getModulePropertyDefinitions());const{dataModel:s,processedData:n}=await e.request(this.id,t!=null?t:[],i);return this.dataModel=s,this.processedData=n,this.dispatch("data-processed",{dataModel:s,processedData:n}),{dataModel:s,processedData:n}}isProcessedDataAnimatable(){var s,n;const e=(n=(s=this.processedData)==null?void 0:s.reduced)==null?void 0:n.animationValidation;if(!e)return!0;const{orderedKeys:t,uniqueKeys:i}=e;return t&&i}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}pickFocus(e){const t=this.getNodeData();if(t===void 0||t.length===0)return;const i=this.computeFocusDatumIndex(e,t);if(i===void 0)return;const{clipFocusBox:s}=this,n=t[i],a=E(b({},e),{datumIndex:i}),r=this.computeFocusBounds(a);if(r!==void 0)return{bounds:r,clipFocusBox:s,datum:n,datumIndex:i}}isDatumEnabled(e,t){const{missing:i=!1,enabled:s=!0,focusable:n=!0}=e[t];return!i&&s&&n}computeFocusDatumIndex(e,t){var r;const i=(o,l)=>{for(;o>=0&&!this.isDatumEnabled(t,o);)o+=l;return o===-1?void 0:o},s=(o,l)=>{for(;o<t.length&&!this.isDatumEnabled(t,o);)o+=l;return o===t.length?void 0:o};let n;const a=we(0,e.datumIndex,t.length-1);return e.datumIndexDelta<0?n=i(a,e.datumIndexDelta):e.datumIndexDelta>0?n=s(a,e.datumIndexDelta):n=(r=s(a,1))!=null?r:i(a,-1),n===void 0?e.datumIndexDelta===0?void 0:e.datumIndex-e.datumIndexDelta:n}keysOrValues(e){var i,s,n,a,r;const t=this.dataModel.resolveProcessedDataIndexById(this,e);return(r=(a=(s=(i=this.processedData)==null?void 0:i.keys[t])==null?void 0:s.get(this.id))!=null?a:(n=this.processedData)==null?void 0:n.columns[t])!=null?r:[]}getCategoryKey(){return this.categoryKey}getCategoryValue(e){var a,r,o;const{processedData:t,dataModel:i}=this,s=this.getCategoryKey();return!t||!i||!s||((o=(r=(a=t.invalidData)==null?void 0:a.get(this.id))==null?void 0:r[e])!=null?o:!1)?void 0:this.keysOrValues(s)[e]}datumIndexForCategoryValue(e){var r,o;const{processedData:t,dataModel:i}=this,s=this.getCategoryKey();if(!t||!i||!s)return;e=e.valueOf();const n=(r=t.invalidData)==null?void 0:r.get(this.id),a=this.keysOrValues(s);for(let l=0;l<a.length;l+=1){if((n==null?void 0:n[l])===!0)continue;const c=(o=a[l])==null?void 0:o.valueOf();if(dn(e,c))return l}}},Ah={x:["xKey"],y:["yKey"]},Ih={x:["xName"],y:["yName"]},xD=class extends zg{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.yKey=s.properties.yKey}},_o=class extends Qn{constructor(){super(...arguments),this.pickOutsideVisibleMinorAxis=!1}};I([P],_o.prototype,"legendItemName",2),I([P],_o.prototype,"pickOutsideVisibleMinorAxis",2);var Pv=100,Xl=class extends bD{constructor(d){var u=d,{pathsPerSeries:e=["path"],hasMarkers:t=!1,hasHighlightedLabels:i=!1,pathsZIndexSubOrderOffset:s=[],datumSelectionGarbageCollection:n=!0,markerSelectionGarbageCollection:a=!0,animationAlwaysUpdateSelections:r=!1,animationResetFns:o,directionKeys:l,directionNames:c}=u,h=We(u,["pathsPerSeries","hasMarkers","hasHighlightedLabels","pathsZIndexSubOrderOffset","datumSelectionGarbageCollection","markerSelectionGarbageCollection","animationAlwaysUpdateSelections","animationResetFns","directionKeys","directionNames"]);if(super(b({directionKeys:l,directionNames:c,canHaveAxes:!0},h)),this.NodeEvent=xD,this.dataNodeGroup=this.contentGroup.appendChild(new Ge({name:`${this.id}-series-dataNodes`,zIndex:0})),this.markerGroup=this.contentGroup.appendChild(new Ge({name:`${this.id}-series-markers`,zIndex:1})),this.labelGroup=this.contentGroup.appendChild(new ds({name:`${this.id}-series-labels`})),this.labelSelection=Pi.select(this.labelGroup,is),this.highlightSelection=Pi.select(this.highlightNode,()=>this.opts.hasMarkers?new rs:this.nodeFactory()),this.highlightLabelSelection=Pi.select(this.highlightLabel,is),this.annotationSelections=new Set,this.debug=ct.create(),!l||!c)throw new Error(`Unable to initialise series type ${this.type}`);this.opts={pathsPerSeries:e,hasMarkers:t,hasHighlightedLabels:i,pathsZIndexSubOrderOffset:s,directionKeys:l,directionNames:c,animationResetFns:o,animationAlwaysUpdateSelections:r,datumSelectionGarbageCollection:n,markerSelectionGarbageCollection:a},this.paths=e.map(p=>new gn({name:`${this.id}-${p}`})),this.datumSelection=Pi.select(this.dataNodeGroup,()=>this.nodeFactory(),n),this.markerSelection=Pi.select(this.markerGroup,rs,a),this.animationState=new Ng("empty",{empty:{update:{target:"ready",action:p=>this.animateEmptyUpdateReady(p)},reset:"empty",skip:"ready",disable:"disabled"},ready:{updateData:"waiting",clear:"clearing",highlight:p=>this.animateReadyHighlight(p),highlightMarkers:p=>this.animateReadyHighlightMarkers(p),resize:p=>this.animateReadyResize(p),reset:"empty",skip:"ready",disable:"disabled"},waiting:{update:{target:"ready",action:p=>{this.ctx.animationManager.isSkipped()?this.resetAllAnimation(p):this.animateWaitingUpdateReady(p)}},reset:"empty",skip:"ready",disable:"disabled"},disabled:{update:p=>this.resetAllAnimation(p),reset:"empty"},clearing:{update:{target:"empty",action:p=>this.animateClearingUpdateEmpty(p)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}get contextNodeData(){return this._contextNodeData}getNodeData(){var e;return(e=this.contextNodeData)==null?void 0:e.nodeData}attachSeries(e,t,i){super.attachSeries(e,t,i),this.attachPaths(this.paths,t,i)}detachSeries(e,t,i){super.detachSeries(e,t,i),this.detachPaths(this.paths,t,i)}updatedDomains(){this.animationState.transition("updateData")}attachPaths(e,t,i){for(const s of e)this.contentGroup.appendChild(s)}detachPaths(e,t,i){for(const s of e)this.contentGroup.removeChild(s)}renderToOffscreenCanvas(){const e=this.getNodeData();return e!=null&&e.length>Pv}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"?this.animationState.transition("skip"):e==="disabled"&&this.animationState.transition("disable")}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",e=>this.onLegendItemClick(e)),this.ctx.chartEventManager.addListener("legend-item-double-click",e=>this.onLegendItemDoubleClick(e)))}destroy(){super.destroy(),this._contextNodeData=void 0}update({seriesRect:e}){var l,c;const{visible:t,_contextNodeData:i}=this,n=((c=(l=this.ctx.highlightManager)==null?void 0:l.getActiveHighlight())==null?void 0:c.series)===this,a=this.checkResize(e),r=this.updateHighlightSelection(n);this.updateSelections(t),this.updateNodes(r,n,t);const o=this.getAnimationData(e,i);o&&(a&&this.animationState.transition("resize",o),this.animationState.transition("update",o))}updateSelections(e){var s;var t;const i=!this.opts.animationAlwaysUpdateSelections&&this.ctx.animationManager.isSkipped();if(!(!e&&i)&&!(!this.nodeDataRefresh&&!this.isPathOrSelectionDirty())){if(this.nodeDataRefresh){this.nodeDataRefresh=!1,this.debug("CartesianSeries.updateSelections() - calling createNodeData() for",this.id),this.markQuadtreeDirty(),this._contextNodeData=this.createNodeData();const n=this.isProcessedDataAnimatable();this._contextNodeData&&((s=(t=this._contextNodeData).animationValid)!=null||(t.animationValid=n));const{dataModel:a,processedData:r}=this;a!==void 0&&r!==void 0&&this.dispatch("data-update",{dataModel:a,processedData:r})}this.updateSeriesSelections()}}updateSeriesSelections(e){var c;const{datumSelection:t,labelSelection:i,markerSelection:s,paths:n}=this,a=this._contextNodeData;if(!a)return;const{nodeData:r,labelData:o,itemId:l}=a;this.updatePaths({seriesHighlighted:e,itemId:l,contextData:a,paths:n}),this.datumSelection=this.updateDatumSelection({nodeData:r,datumSelection:t}),this.labelSelection=(c=this.updateLabelSelection({labelData:o,labelSelection:i}))!=null?c:i,this.opts.hasMarkers&&(this.markerSelection=this.updateMarkerSelection({nodeData:r,markerSelection:s}))}getShapeFillBBox(){var f,y;const{axes:e}=this,t=e.x,i=e.y,[s,n]=ss((f=t==null?void 0:t.range)!=null?f:[0,1]),[a,r]=ss((y=i==null?void 0:i.range)!=null?y:[0,1]),o=this.getSeriesDomain("x"),l=[t==null?void 0:t.scale.convert(o.at(0)),t==null?void 0:t.scale.convert(o.at(-1))],c=this.getSeriesDomain("y"),h=[i==null?void 0:i.scale.convert(c.at(0)),i==null?void 0:i.scale.convert(c.at(-1))],[d,u]=ss(l),[p,g]=ss(h);return{axis:new ve(s,a,n-s,r-a),series:new ve(d,p,u-d,g-p)}}updateNodes(e,t,i){var x;const{highlightSelection:s,highlightLabelSelection:n,opts:{hasMarkers:a,hasHighlightedLabels:r}}=this,o=!this.ctx.animationManager.isSkipped(),l=this.visible&&this._contextNodeData!=null&&i;this.contentGroup.visible=o||l,this.highlightGroup.visible=(o||l)&&t;const c=this.getOpacity();a?(this.updateMarkerNodes({markerSelection:s,isHighlight:!0}),this.animationState.transition("highlightMarkers",s)):(this.updateDatumNodes({datumSelection:s,isHighlight:!0}),this.animationState.transition("highlight",s)),r&&this.updateLabelNodes({labelSelection:n});const{dataNodeGroup:h,markerGroup:d,datumSelection:u,labelSelection:p,markerSelection:g,paths:f,labelGroup:y}=this,{itemId:v}=(x=this.contextNodeData)!=null?x:{};h.opacity=c,h.visible=o||l,y.visible=l,a&&(d.opacity=c,d.visible=l),y&&(y.opacity=c),this.updatePathNodes({seriesHighlighted:t,itemId:v,paths:f,opacity:c,visible:l,animationEnabled:o}),h.visible&&(this.updateDatumNodes({datumSelection:u,highlightedItems:e,isHighlight:!1}),this.usesPlacedLabels||this.updateLabelNodes({labelSelection:p}),a&&this.updateMarkerNodes({markerSelection:g,isHighlight:!1}))}getHighlightLabelData(e,t){const i=e.filter(s=>s.datum===t.datum&&s.itemId===t.itemId);return i.length===0?void 0:i}getHighlightData(e,t){return t?[t]:void 0}updateHighlightSelection(e){var l;const{highlightSelection:t,highlightLabelSelection:i,_contextNodeData:s}=this;if(!s)return;const n=(l=this.ctx.highlightManager)==null?void 0:l.getActiveHighlight(),a=e&&(n!=null&&n.datum)?n:void 0;let r,o;if(a!=null){const c=this.isLabelEnabled(),{labelData:h,nodeData:d}=s;o=this.getHighlightData(d,a),r=c?this.getHighlightLabelData(h,a):void 0}return this.highlightSelection=this.updateHighlightSelectionItem({items:o,highlightSelection:t}),this.highlightLabelSelection=this.updateHighlightSelectionLabel({items:r,highlightLabelSelection:i}),o}markQuadtreeDirty(){this.quadtree=void 0}*datumNodesIter(){for(const{node:e}of this.datumSelection)e.datum.missing!==!0&&(yield e)}getQuadTree(){if(this.quadtree===void 0){const{width:e,height:t}=this.ctx.scene.canvas,i=new ve(0,0,e,t);this.quadtree=new Iae(100,10,i),this.initQuadTree(this.quadtree)}return this.quadtree}initQuadTree(e){}pickNodesExactShape(e){var l;const t=super.pickNodesExactShape(e);if(t.length!==0)return t;const{x:i,y:s}=e,{opts:{hasMarkers:n}}=this,{dataNodeGroup:a,markerGroup:r}=this;let o=a.pickNodes(i,s).filter(c=>c.datum.missing!==!0);if(o.length===0&&n&&(o=r==null?void 0:r.pickNodes(i,s).filter(c=>c.datum.missing!==!0)),o.length!==0)return o.map(h=>h.datum);for(const c of this.moduleMap.modules()){const{datum:h}=(l=c.pickNodeExact(e))!=null?l:{};if(h!=null&&(h==null?void 0:h.missing)!==!0)return[h]}return[]}pickNodeClosestDatum(e){var h,d;const{x:t,y:i}=e,{axes:s,_contextNodeData:n}=this;if(!n)return;const a=s.x,r=s.y,o={x:t,y:i};let l=1/0,c;for(const u of n.nodeData){const{point:{x:p=NaN,y:g=NaN}={}}=u;if(isNaN(p)||isNaN(g)||!((a==null?void 0:a.inRange(p))&&(r==null?void 0:r.inRange(g))))continue;const y=Math.max((o.x-p)**2+(o.y-g)**2,0);y<l&&(l=y,c=u)}for(const u of this.moduleMap.modules()){const p=u.pickNodeNearest(e);if(p!==void 0&&p.distanceSquared<l){l=p.distanceSquared,c=p.datum;break}}if(c){const u=Math.max(Math.sqrt(l)-((d=(h=c.point)==null?void 0:h.size)!=null?d:0)/2,0);return{datum:c,distance:u}}}pickNodeMainAxisFirst(e,t){var g,f,y,v;const{x:i,y:s}=e,{axes:n,_contextNodeData:a}=this,{pickOutsideVisibleMinorAxis:r}=this.properties;if(!a)return;const o=n.x,l=n.y,c=[o,l].filter(Gl.is).map(x=>x.direction);if(t&&c.length===0)return;const[h="x"]=c,d=[i,s];h!=="x"&&d.reverse();const u=[1/0,1/0];let p;for(const x of a.nodeData){const{x:S=NaN,y:M=NaN}=(f=(g=x.point)!=null?g:x.midPoint)!=null?f:{};if(isNaN(S)||isNaN(M)||x.missing===!0)continue;const D=[o==null?void 0:o.inRange(S),l==null?void 0:l.inRange(M)];if(h!=="x"&&D.reverse(),!D[0]||!r&&!D[1])continue;const A=[S,M];h!=="x"&&A.reverse();let w=!0;for(let T=0;T<A.length;T++){const k=Math.abs(A[T]-d[T]);if(k>u[T]){w=!1;break}else k<u[T]&&(u[T]=k,u.fill(1/0,T+1,u.length))}w&&(p=x)}if(p){let x=Math.max(u[0]**2+u[1]**2-((v=(y=p.point)==null?void 0:y.size)!=null?v:0),0);for(const S of this.moduleMap.modules()){const M=S.pickNodeMainAxisFirst(e);if(M!==void 0&&M.distanceSquared<x){p=M.datum,x=M.distanceSquared;break}}return{datum:p,distance:Math.sqrt(x)}}}isPathOrSelectionDirty(){return!1}shouldFlipXY(){return!1}visibleRange(e,t,i){var a;const s=this.keysOrValues(e),n=0;return nN((a=i==null?void 0:i.length)!=null?a:s.length,t,r=>{var l;const o=(l=i==null?void 0:i[r])!=null?l:r;return this.xCoordinateRange(s[o],n,o)})}domainForVisibleRange(e,t,i,s,n,a){const{processedData:r,dataModel:o}=this,[l,c]=s,h=this.keysOrValues(i);if(n){const g=this.visibleRange(i,s,a);return o.getDomainBetweenRange(this,t,g,r)}const d=t.map(g=>this.keysOrValues(g));let u=1/0,p=-1/0;return h.forEach((g,f)=>{const[y,v]=this.xCoordinateRange(g,0,f);if(!(v<l||y>c))for(let x=0;x<t.length;x++){const S=d[x][f];u=Math.min(u,S),p=Math.max(p,S)}}),u>p?[NaN,NaN]:[u,p]}domainForClippedRange(e,t,i,s){const{processedData:n,dataModel:a,axes:r}=this,l=Pae(r[e==="x"?"y":"x"]);if(!l)return t.flatMap(g=>a.getDomain(this,g,"value",n));const c=this.keysOrValues(i);if(s){const g=Eae(c.length,l,f=>c[f]);return a.getDomainBetweenRange(this,t,g,n)}const h=t.map(g=>this.keysOrValues(g)),d=l[0].valueOf(),u=l[1].valueOf(),p=[];return c.forEach((g,f)=>{const y=g.valueOf();if(y<d||y>u)return;const v=h.map(x=>x[f]);y>=d&&p.push(...v),y<=u&&p.push(...v)}),p}countVisibleItems(e,t,i,s,n){const{dataModel:a,processedData:r}=this;if(!a||!r)return 1/0;const o=this.keysOrValues(e),l=t.map(D=>a.resolveColumnById(this,D,r)),c=this.axes.x,h=this.axes.y,d=this.shouldFlipXY(),u=c.range,p=h.range,g=(D,A,w)=>D[0]+(w-A[0])/(A[1]-A[0])*(D[1]-D[0]),f=g(u,c.visibleRange,i[0]),y=g(u,c.visibleRange,i[1]),v=g(p,h.visibleRange,d?s[0]:s[1]),x=g(p,h.visibleRange,d?s[1]:s[0]),S=Math.round((i[0]+(i[1]-i[0])/2)*o.length),M=0;return aN(0,o.length-1,S,n,D=>{let[A,w]=this.xCoordinateRange(o[D],M,D),[T,k]=this.yCoordinateRange(l.map(N=>N[D]),M,D);return!Xe(A)||!Xe(w)||!Xe(T)||!Xe(k)?!1:(d&&([A,w,T,k]=[T,k,A,w]),A>=f&&w<=y&&T>=v&&k<=x)})}updateHighlightSelectionItem(e){const{opts:{hasMarkers:t}}=this,{items:i,highlightSelection:s}=e,n=i!=null?i:[];if(t){const a=s;return this.updateMarkerSelection({nodeData:n,markerSelection:a})}else return this.updateDatumSelection({nodeData:n,datumSelection:s})}updateHighlightSelectionLabel(e){var t;return this.updateLabelSelection({labelData:(t=e.items)!=null?t:[],labelSelection:e.highlightLabelSelection})}updateDatumSelection(e){return e.datumSelection}updateDatumNodes(e){}updateMarkerSelection(e){return e.markerSelection}updateMarkerNodes(e){}updatePaths(e){e.paths.forEach(t=>t.visible=!1)}updatePathNodes(e){const{paths:t,opacity:i,visible:s}=e;for(const n of t)n.opacity=i,n.visible=s}resetPathAnimation(e){var i,s;const{path:t}=(s=(i=this.opts)==null?void 0:i.animationResetFns)!=null?s:{};t&&e.paths.forEach(n=>{ns([n],t)})}resetDatumAnimation(e){var i,s;const{datum:t}=(s=(i=this.opts)==null?void 0:i.animationResetFns)!=null?s:{};t&&ns([e.datumSelection],t)}resetLabelAnimation(e){var i,s;const{label:t}=(s=(i=this.opts)==null?void 0:i.animationResetFns)!=null?s:{};t&&ns([e.labelSelection],t)}resetMarkerAnimation(e){var i,s;const{marker:t}=(s=(i=this.opts)==null?void 0:i.animationResetFns)!=null?s:{};t&&this.opts.hasMarkers&&ns([e.markerSelection],t)}resetAllAnimation(e){var t;this.ctx.animationManager.stopByAnimationGroupId(this.id),this.resetPathAnimation(e),this.resetDatumAnimation(e),this.resetLabelAnimation(e),this.resetMarkerAnimation(e),((t=e.contextData)==null?void 0:t.animationValid)===!1&&this.ctx.animationManager.skipCurrentBatch()}animateEmptyUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateWaitingUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateReadyHighlight(e){var i,s;const{datum:t}=(s=(i=this.opts)==null?void 0:i.animationResetFns)!=null?s:{};t&&ns([e],t)}animateReadyHighlightMarkers(e){var i,s;const{marker:t}=(s=(i=this.opts)==null?void 0:i.animationResetFns)!=null?s:{};t&&ns([e],t)}animateReadyResize(e){this.resetAllAnimation(e)}animateClearingUpdateEmpty(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}getAnimationData(e,t){const{_contextNodeData:i}=this;return i?{datumSelection:this.datumSelection,markerSelection:this.markerSelection,labelSelection:this.labelSelection,annotationSelections:[...this.annotationSelections],contextData:i,previousContextData:t,paths:this.paths,seriesRect:e}:void 0}updateLabelSelection(e){return e.labelSelection}getScaling(e){if(e instanceof aD){const{range:t,domain:i}=e;return{type:"log",convert:s=>e.convert(s),domain:[i[0],i[1]],range:[t[0],t[1]]}}else if(e instanceof Mt){const{range:t,domain:i}=e;return{type:"continuous",domain:[i[0],i[1]],range:[t[0],t[1]]}}else if(e instanceof Pg){const{domain:t}=e;return{type:"category",domain:t,inset:e.inset,step:e.step}}}calculateScaling(){const e={};for(const t of Object.values(W0)){const i=this.axes[t];if(!i)continue;const s=this.getScaling(i.scale);s!=null&&(e[t]=s)}return e}};function Pae(e){let t,i;if((e instanceof No||e instanceof Ma)&&({min:t,max:i}=e),!(t==null&&i==null))return t!=null||(t=-1/0),i!=null||(i=1/0),[t,i]}function Eae(e,t,i){const s=t[0].valueOf(),n=t[1].valueOf(),a=hg(0,e-1,o=>{var c;const l=(c=i(o))==null?void 0:c.valueOf();return!Number.isFinite(l)||l>=s});let r=kl(0,e-1,o=>{var c;const l=(c=i(o))==null?void 0:c.valueOf();return!Number.isFinite(l)||l<=n});return a==null||r==null?[0,0]:(r=Math.min(r+1,e),[a,r])}var Pu=class extends Be{constructor(){super(...arguments),this.type="linear",this.tension=1,this.position="end"}};I([P],Pu.prototype,"type",2),I([P],Pu.prototype,"tension",2),I([P],Pu.prototype,"position",2);var ci=class extends _o{constructor(){super(...arguments),this.xName=void 0,this.fill="#c16068",this.fillGradientDefaults=new wa,this.fillPatternDefaults=new Wt,this.fillImageDefaults=new In,this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new Pu,this.shadow=new sr,this.marker=new os,this.label=new as,this.tooltip=new Ys,this.connectMissingData=!1}};I([P],ci.prototype,"xKey",2),I([P],ci.prototype,"xName",2),I([P],ci.prototype,"yKey",2),I([P],ci.prototype,"yName",2),I([P],ci.prototype,"yFilterKey",2),I([P],ci.prototype,"normalizedTo",2),I([P],ci.prototype,"fill",2),I([P],ci.prototype,"fillGradientDefaults",2),I([P],ci.prototype,"fillPatternDefaults",2),I([P],ci.prototype,"fillImageDefaults",2),I([P],ci.prototype,"fillOpacity",2),I([P],ci.prototype,"stroke",2),I([P],ci.prototype,"strokeWidth",2),I([P],ci.prototype,"strokeOpacity",2),I([P],ci.prototype,"lineDash",2),I([P],ci.prototype,"lineDashOffset",2),I([P],ci.prototype,"interpolation",2),I([P],ci.prototype,"shadow",2),I([P],ci.prototype,"marker",2),I([P],ci.prototype,"label",2),I([P],ci.prototype,"tooltip",2),I([P],ci.prototype,"connectMissingData",2);function Gr(e){switch(e.type){case"linear":case"step":return[{x:e.x0,y:e.y0},{x:e.x1,y:e.y1}];case"cubic":return[{x:e.cp0x,y:e.cp0y},{x:e.cp3x,y:e.cp3y}]}}function Rae(e){const t=Gr(e);return t[0].x>t[1].x&&t.reverse(),t}function Nae(e,t){const{x:i,y:s}=t;switch(e.type){case"linear":return{type:"linear",moveTo:e.moveTo,x0:i,y0:s,x1:i,y1:s};case"step":return{type:"step",moveTo:e.moveTo,x0:i,y0:s,x1:i,y1:s,stepX:i};case"cubic":return{type:"cubic",moveTo:e.moveTo,cp0x:i,cp0y:s,cp1x:i,cp1y:s,cp2x:i,cp2y:s,cp3x:i,cp3y:s}}}function uf(e,t,i){const[s,n]=Gr(e),a=n.x!==s.x?(i.x-t.x)/(n.x-s.x):0,r=n.y!==s.y?(i.y-t.y)/(n.y-s.y):0;switch(e.type){case"linear":return{type:"linear",moveTo:e.moveTo,x0:t.x,y0:t.y,x1:i.x,y1:i.y};case"cubic":return{type:"cubic",moveTo:e.moveTo,cp0x:t.x,cp0y:t.y,cp1x:i.x-(e.cp2x-s.x)*a,cp1y:i.y-(e.cp2y-s.y)*r,cp2x:i.x-(e.cp1x-s.x)*a,cp2y:i.y-(e.cp1y-s.y)*r,cp3x:i.x,cp3y:i.y};case"step":return{type:"step",moveTo:e.moveTo,x0:t.x,y0:t.y,x1:i.x,y1:i.y,stepX:i.x-(e.stepX-s.x)*a}}}function yO(e,t,i){const{moveTo:s}=e,[n,a]=Rae(e),{x:r,y:o}=n,{x:l,y:c}=a;if(i<r)return uf(e,n,n);if(t>l)return uf(e,a,a);switch(e.type){case"linear":{const h=o===c?void 0:(c-o)/(l-r),d=h==null?o:h*(t-r)+o,u=h==null?o:h*(i-r)+o;return{type:"linear",moveTo:s,x0:t,y0:d,x1:i,y1:u}}case"step":if(i<=e.stepX){const h=e.y0;return{type:"step",moveTo:s,x0:t,y0:h,x1:i,y1:h,stepX:i}}else if(t>=e.stepX){const h=e.y1;return{type:"step",moveTo:s,x0:t,y0:h,x1:i,y1:h,stepX:t}}else{const{y0:h,y1:d,stepX:u}=e;return{type:"step",moveTo:s,x0:t,y0:h,x1:i,y1:d,stepX:u}}case"cubic":{const h=Ey(e.cp0x,e.cp1x,e.cp2x,e.cp3x,t);let[d,u]=Ry(e.cp0x,e.cp0y,e.cp1x,e.cp1y,e.cp2x,e.cp2y,e.cp3x,e.cp3y,h);const p=Ey(u[0].x,u[1].x,u[2].x,u[3].x,i);return[u,d]=Ry(u[0].x,u[0].y,u[1].x,u[1].y,u[2].x,u[2].y,u[3].x,u[3].y,p),{type:"cubic",moveTo:s,cp0x:u[0].x,cp0y:u[0].y,cp1x:u[1].x,cp1y:u[1].y,cp2x:u[2].x,cp2y:u[2].y,cp3x:u[3].x,cp3y:u[3].y}}}}function Oae(e){const t=[];let i=0,s=NaN,n=NaN;for(const{x:a,y:r}of e){if(i>0){const o=i===1;t.push({type:"linear",moveTo:o,x0:s,y0:n,x1:a,y1:r})}i+=1,s=a,n=r}return t}var Fae={start:0,middle:.5,end:1};function Bae(e,t){const i=[];let s=0,n=NaN,a=NaN;const r=typeof t=="number"?t:Fae[t];for(const{x:o,y:l}of e){if(s>0){const c=s===1,h=n+(o-n)*r;i.push({type:"step",moveTo:c,x0:n,y0:a,x1:o,y1:l,stepX:h})}s+=1,n=o,a=l}return i}var Ev=.05;function _ae(e,t){const i=Array.isArray(e)?e:Array.from(e);if(i.length<=1)return[];const s=i.map((a,r)=>{const o=r===0?a:i[r-1],l=r===i.length-1?a:i[r+1],c=r===0||r===i.length-1;if(Math.sign(o.y-a.y)===Math.sign(l.y-a.y))return 0;if(!c){const h=Math.abs(o.y-l.y),d=Math.abs(a.y-o.y)/h,u=Math.abs(a.y-l.y)/h;if(d<=Ev||1-d<=Ev||u<=Ev||1-u<=Ev)return 0}return(l.y-o.y)/(l.x-o.x)});s[1]===0&&(s[0]*=2),s[s.length-2]===0&&(s[s.length-1]*=2);const n=[];for(let a=1;a<i.length;a+=1){const r=i[a-1],o=s[a-1],l=i[a],c=s[a],h=l.x-r.x,d=l.y-r.y;let u=h*t/3,p=h*o*t/3,g=h*t/3,f=h*c*t/3;c===0&&Math.abs(p)>Math.abs(d)&&(u*=Math.abs(d/p),p=Math.sign(p)*Math.abs(d)),o===0&&Math.abs(f)>Math.abs(d)&&(g*=Math.abs(d/f),f=Math.sign(f)*Math.abs(d)),n.push({type:"cubic",moveTo:a===1,cp0x:r.x,cp0y:r.y,cp1x:r.x+u,cp1y:r.y+p,cp2x:l.x-g,cp2y:l.y-f,cp3x:l.x,cp3y:l.y})}return n}function Ui(e,t,i){return(t-e)*i+e}function Gae(e,t){const{x0:i,y0:s,x1:n,y1:a}=e,o=(a-s)/(n-i)*(t-i)+s;return{leftCp1x:i,leftCp1y:s,leftCp2x:t,leftCp2y:o,stepX:t,stepY0:o,stepY1:o,rightCp1x:t,rightCp1y:o,rightCp2x:n,rightCp2y:a}}function zae(e,t){const{cp0x:i,cp0y:s,cp1x:n,cp1y:a,cp2x:r,cp2y:o,cp3x:l,cp3y:c}=e,h=Ey(i,n,r,l,t),[d,u]=Ry(i,s,n,a,r,o,l,c,h),p=d[3].y;return{leftCp1x:d[1].x,leftCp1y:d[1].y,leftCp2x:d[2].x,leftCp2y:d[2].y,stepX:t,stepY0:p,stepY1:p,rightCp1x:u[1].x,rightCp1y:u[1].y,rightCp2x:u[2].x,rightCp2y:u[2].y}}function Vae(e){const{x0:t,y0:i,x1:s,y1:n,stepX:a}=e;return{leftCp1x:(t+a)/2,leftCp1y:i,leftCp2x:(t+a)/2,leftCp2y:i,stepX:a,stepY0:i,stepY1:n,rightCp1x:(a+s)/2,rightCp1y:n,rightCp2x:(a+s)/2,rightCp2y:n}}function vO(e,t){return e.type==="linear"?Gae(e,t):e.type==="cubic"?zae(e,t):Vae(e)}function bO(e,t,i,s,n,a,r){switch(t){case 0:r?e.moveTo(n,a):e.moveTo(i,s);break;case 1:r?e.lineTo(n,a):e.lineTo(i,s);break}}function xO(e,t,i,s,n,a){a?e.lineTo(t,i):e.lineTo(s,n)}function CO(e,t,i,s,n,a,r,o,l,c){c?e.cubicCurveTo(a,r,s,n,t,i):e.cubicCurveTo(s,n,a,r,o,l)}function SO(e,t,i,s,n,a,r){r?(e.lineTo(a,n),e.lineTo(a,i),e.lineTo(t,i)):(e.lineTo(a,i),e.lineTo(a,n),e.lineTo(s,n))}function CD(e,t,i,s){const[n,a]=Gr(t);switch(bO(e,i,n.x,n.y,a.x,a.y,s),t.type){case"linear":xO(e,t.x0,t.y0,t.x1,t.y1,s);break;case"cubic":CO(e,t.cp0x,t.cp0y,t.cp1x,t.cp1y,t.cp2x,t.cp2y,t.cp3x,t.cp3y,s);break;case"step":SO(e,t.x0,t.y0,t.x1,t.y1,t.stepX,s);break}}function MO(e,t,i){const[s,n]=Gr(e),[a,r]=Gr(t),o=Ui(s.x,a.x,i),l=Ui(s.y,a.y,i),c=Ui(n.x,r.x,i),h=Ui(n.y,r.y,i);return[{x:o,y:l},{x:c,y:h}]}function SD(e,t,i,s,n,a){const[{x:r,y:o},{x:l,y:c}]=MO(t,i,s);if(bO(e,n,r,o,l,c,a),t.type==="cubic"&&i.type==="cubic"){const h=Ui(t.cp1x,i.cp1x,s),d=Ui(t.cp1y,i.cp1y,s),u=Ui(t.cp2x,i.cp2x,s),p=Ui(t.cp2y,i.cp2y,s);CO(e,r,o,h,d,u,p,l,c,a)}else if(t.type==="step"&&i.type==="step"){const h=Ui(t.stepX,i.stepX,s);SO(e,r,o,l,c,h,a)}else if(t.type==="linear"&&i.type==="linear")xO(e,r,o,l,c,a);else{let h;t.type==="step"?h=t.stepX:i.type==="step"?h=i.stepX:h=(r+l)/2;const d=vO(t,h),u=vO(i,h),p=Ui(d.leftCp1x,u.leftCp1x,s),g=Ui(d.leftCp1y,u.leftCp1y,s),f=Ui(d.leftCp2x,u.leftCp2x,s),y=Ui(d.leftCp2y,u.leftCp2y,s),v=Ui(d.stepX,u.stepX,s),x=Ui(d.stepY0,u.stepY0,s),S=Ui(d.stepY1,u.stepY1,s),M=Ui(d.rightCp1x,u.rightCp1x,s),D=Ui(d.rightCp1y,u.rightCp1y,s),A=Ui(d.rightCp2x,u.rightCp2x,s),w=Ui(d.rightCp2y,u.rightCp2y,s);a?(e.cubicCurveTo(A,w,M,D,v,S),e.lineTo(v,x),e.cubicCurveTo(f,y,p,g,r,o)):(e.cubicCurveTo(p,g,f,y,v,x),e.lineTo(v,S),e.cubicCurveTo(M,D,A,w,l,c))}}var DO=(e=>(e[e.Zero=0]="Zero",e[e.Split=1]="Split",e))(DO||{});function jae(e,t){return e==null||t==null||typeof e!="object"||typeof t!="object"?!1:"id"in e&&"id"in t?e.id===t.id:e.toString()===t.toString()}function Xs(e,t){if(!t)return NaN;if(e instanceof Date&&(e=e.getTime()),t.type==="continuous"&&typeof e=="number")return(e-t.domain[0])/(t.domain[1]-t.domain[0])*(t.range[1]-t.range[0])+t.range[0];if(t.type==="log"&&typeof e=="number")return t.convert(e);if(t.type!=="category")return NaN;let i=t.domain.findIndex(s=>s===e);return i===-1&&(i=t.domain.findIndex(s=>jae(e,s))),i>=0?t.inset+t.step*i:NaN}function Aa(e){return NM(e).valueOf()}function wO({data:e},t){return e.map((i,s)=>({xValue0Index:t.indexOf(Aa(i.xValue0)),xValue1Index:t.indexOf(Aa(i.xValue1)),datumIndex:s}))}function Hae(e,t){const i=t.scales.x,s=e.scales.x;if((i==null?void 0:i.type)!=="category"||(s==null?void 0:s.type)!=="category")return!0;let n=-1/0;for(const a of i.domain){const r=Xs(a,s);if(Number.isFinite(r)){if(r<n)return!1;n=r}}return!0}function Wae(e,t){let i=-1/0;for(const s of e){const n=Xs(s.value,t.scales.x);if(Number.isFinite(n)){if(n<i)return!1;i=n}}return!0}function Uae(e,t){const i=new Map;for(const{xValue0:h,xValue1:d}of e.data){const u=Aa(h),p=Aa(d);i.set(u,h).set(p,d)}const s=Array.from(i,([h,d])=>({axisValue:h,value:d}));s.sort((h,d)=>Xs(h.value,e.scales.x)-Xs(d.value,e.scales.x));const n=[];for(const{xValue0:h,xValue1:d}of t.data){const u=Aa(h),p=Aa(d);i.has(u)||(i.set(u,h),n.push({axisValue:u,value:h})),i.has(p)||(i.set(p,d),n.push({axisValue:p,value:d}))}n.sort((h,d)=>Xs(h.value,t.scales.x)-Xs(d.value,t.scales.x));const a=s;let r=0;for(const h of n){for(let d=a.length-1;d>r;d-=1){const u=Xs(h.value,t.scales.x),p=Xs(a[d].value,t.scales.x);if(u>p){r=d+1;break}}a.splice(r,0,h),r+=1}if(!Wae(a,t))return;const o=a.map(h=>h.axisValue),l=wO(t,o),c=wO(e,o);return{axisValues:o,oldDataAxisIndices:l,newDataAxisIndices:c}}function AO(e,t,i){if(i.xValue1Index===i.xValue0Index+1)return e;const s=Gr(e),n=(s[1].x-s[0].x)/(i.xValue1Index-i.xValue0Index),a=s[0].x+(t-i.xValue0Index)*n,r=a+n;return yO(e,a,r)}function IO(e,t){const[i,s]=Gr(e),n=Xs(0,t.scales.y);return uf(e,{x:i.x,y:n},{x:s.x,y:n})}function TO(e){const[t,i]=Gr(e);return Nae(e,{x:(t.x+i.x)/2,y:(t.y+i.y)/2})}function kO(e,t,i,s,n,a){var d,u;let r,o;if(n.xValue0Index>=a.xValue1Index){const p=(d=s.findLast(f=>f.xValue1Index<=a.xValue1Index))==null?void 0:d.datumIndex,g=p!=null?i.data[p]:void 0;r=g==null?void 0:g.xValue1,o=g==null?void 0:g.yValue1}else if(n.xValue0Index<=a.xValue0Index){const p=(u=s.find(f=>f.xValue0Index>=a.xValue0Index))==null?void 0:u.datumIndex,g=p!=null?i.data[p]:void 0;r=g==null?void 0:g.xValue0,o=g==null?void 0:g.yValue0}if(r==null||o==null)switch(t){case 0:return IO(e,i);case 1:return TO(e)}const l=Xs(r,i.scales.x),c=Xs(o,i.scales.y),h={x:l,y:c};return uf(e,h,h)}function MD(e,t){var n;if(t==null)return;const i=Aa(e.xValue0),s=Aa(e.xValue1);return(n=t.find(a=>Aa(a.xValue0)===i&&Aa(a.xValue1)===s))==null?void 0:n.span}function LO(e,t,i,s,n,a,r){const o=e.data[s.datumIndex],l=o.span,c=MD(o,n);if(c!=null)r.removed.push({from:c,to:c}),r.moved.push({from:c,to:l}),r.added.push({from:l,to:l});else{const h=kO(l,t,e,i,s,a);r.added.push({from:h,to:l})}}function PO(e,t,i,s,n,a,r){const o=e.data[s.datumIndex],l=o.span,c=MD(o,n);if(c!=null)r.removed.push({from:l,to:l}),r.moved.push({from:l,to:c}),r.added.push({from:c,to:c});else{const h=kO(l,t,e,i,s,a);r.removed.push({from:l,to:h})}}function EO(e,t,i,s,n){const a=t[n.xValue0Index],r=i.data.find(y=>Aa(y.xValue0)===a),o=t[n.xValue1Index],l=i.data.find(y=>Aa(y.xValue1)===o);if(r==null||l==null)return;const[{x:c},{x:h}]=Gr(e),d=Xs(r.xValue0,i.scales.x),u=Xs(r.yValue0,i.scales.y),p=Xs(l.xValue1,i.scales.x),g=Xs(l.yValue1,i.scales.y);let f=s.data[n.datumIndex].span;return f=uf(f,{x:d,y:u},{x:p,y:g}),f=yO(f,c,h),f}function Kae(e,t,i,s,n,a,r,o,l){const c=n+1,h=r.find(S=>S.xValue0Index<=n&&S.xValue1Index>=c),d=a.find(S=>S.xValue0Index<=n&&S.xValue1Index>=c),u=t.zeroData,p=e.zeroData;if(h==null&&d!=null){LO(e,i,a,d,u,o,l);return}else if(h!=null&&d==null){PO(t,i,r,h,p,o,l);return}else if(h==null||d==null)return;let g;h.xValue0Index===d.xValue0Index&&h.xValue1Index===d.xValue1Index?g=0:h.xValue0Index<=d.xValue0Index&&h.xValue1Index>=d.xValue1Index?g=-1:h.xValue0Index>=d.xValue0Index&&h.xValue1Index<=d.xValue1Index?g=1:g=0;const f=t.data[h.datumIndex],y=AO(f.span,n,h),v=e.data[d.datumIndex],x=AO(v.span,n,d);if(g===1){const S=EO(y,s,t,e,d);S!=null?(l.removed.push({from:y,to:S}),l.moved.push({from:S,to:x}),l.added.push({from:x,to:x})):PO(t,i,r,h,p,o,l)}else if(g===-1){const S=EO(x,s,e,t,h);S!=null?(l.removed.push({from:y,to:y}),l.moved.push({from:y,to:S}),l.added.push({from:S,to:x})):LO(e,i,a,d,u,o,l)}else l.removed.push({from:y,to:y}),l.moved.push({from:y,to:x}),l.added.push({from:x,to:x})}function $ae(e,t,i,s){var c,h,d,u,p,g,f,y;const n={removed:[],moved:[],added:[]},{axisValues:a,oldDataAxisIndices:r,newDataAxisIndices:o}=e,l={xValue0Index:Math.max((h=(c=r.at(0))==null?void 0:c.xValue0Index)!=null?h:-1/0,(u=(d=o.at(0))==null?void 0:d.xValue0Index)!=null?u:-1/0),xValue1Index:Math.min((g=(p=r.at(-1))==null?void 0:p.xValue1Index)!=null?g:1/0,(y=(f=o.at(-1))==null?void 0:f.xValue1Index)!=null?y:1/0)};for(let v=0;v<a.length-1;v+=1)Kae(t,i,s,a,v,o,r,l,n);return n}function RO(e,t,i){var n;const{span:s}=t;switch(i){case 0:return(n=MD(t,e.zeroData))!=null?n:IO(s,e);case 1:return TO(s)}}function Yae(e,t,i){const s=[],n=[];for(const a of t.data){const r=a.span,o=RO(t,a,i);n.push({from:r,to:o})}for(const a of e.data){const r=a.span,o=RO(e,a,i);s.push({from:o,to:r})}return{removed:n,moved:[],added:s}}function pf(e,t,i){if(!Hae(e,t))return;const s=Uae(e,t);return s==null?Yae(e,t,i):$ae(s,e,t,i)}function NO(e){return e.type==="continuous"||e.type==="log"}function OO(e){return e.type==="category"}function Th(e,t){return e===void 0||t===void 0?e!==void 0||t!==void 0:NO(e)&&NO(t)?e.type===t.type&&fa(e.domain,t.domain)&&fa(e.range,t.range):OO(e)&&OO(t)?e.inset===t.inset&&e.step===t.step&&fa(e.domain,t.domain):!1}function gf(e){return e==null?!1:e.type==="category"?e.domain.every(t=>t!=null):e.domain.every(t=>Number.isFinite(t)||t instanceof Date)&&e.range.every(t=>Number.isFinite(t))}function Rv(e,t){let i;const s=e.map(n=>n.point);switch(t.type){case"linear":i=Oae(s);break;case"smooth":i=_ae(s,t.tension);break;case"step":i=Bae(s,t.position);break}return i.map((n,a)=>({span:n,xValue0:e[a].xDatum,yValue0:e[a].yDatum,xValue1:e[a+1].xDatum,yValue1:e[a+1].yDatum}))}function FO(e,t,i=.001){return Math.abs(e.x-t.x)<i&&Math.abs(e.y-t.y)<i}function DD({path:e},t){let i;for(const{span:s}of t){const[n,a]=Gr(s),r=i!=null&&FO(i,n)?1:0;CD(e,s,r,!1),i=a}}function Nv(e,t,i){let s;for(const n of i){const[a,r]=MO(n.from,n.to,e),o=s!=null&&FO(s,a)?1:0;SD(t.path,n.from,n.to,e,o,!1),s=r}}function wD(e,t,i){const s=(o,l)=>Nv(o,l,t.removed),n=(o,l)=>Nv(o,l,t.moved),a=(o,l)=>Nv(o,l,t.added),r=AD(e,i);return{status:e,path:{addPhaseFn:a,updatePhaseFn:n,removePhaseFn:s},pathProperties:r}}function AD(e,t){const i=t==="none"?"updated":e,s={fromFn:n=>{let a;return e==="removed"?a={finish:{visible:!1}}:e==="added"?a={start:{visible:!0}}:a={},b({phase:Za[i]},a)},toFn:n=>({phase:Za[i]})};return t==="fade"?{fromFn:n=>{const a=e==="added"?0:n.opacity;return b({opacity:a},s.fromFn(n))},toFn:n=>b({opacity:e==="removed"?0:1},s.toFn(n))}:s}function BO(e,t,i){var c,h,d;const s=((c=e.scales.x)==null?void 0:c.type)==="category",n=((h=t.scales.x)==null?void 0:h.type)==="category";if(s!==n||!gf(e.scales.x)||!gf(t.scales.x)||e.strokeData==null||t.strokeData==null)return;let a="updated";t.visible&&!e.visible?a="removed":!t.visible&&e.visible&&(a="added");const r=pf({scales:e.scales,data:e.strokeData.spans},{scales:t.scales,data:t.strokeData.spans},1);if(r==null)return;const o=wD(a,r,"fade"),l=((d=i==null?void 0:i.changed)!=null?d:!0)||!Th(e.scales.x,t.scales.x)||!Th(e.scales.y,t.scales.y)||a!=="updated";return{status:a,stroke:o,hasMotion:l}}function _O({path:e},{spans:t,phantomSpans:i}){for(let s=0;s<t.length;s+=1){const{span:n}=t[s],a=i[s].span;CD(e,n,0,!1),CD(e,a,1,!0),e.closePath()}}function Ov(e,{path:t},i,s){for(let n=0;n<i.length;n+=1){const a=i[n],r=s[n];SD(t,a.from,a.to,e,0,!1),SD(t,r.from,r.to,e,1,!0),t.closePath()}}function GO(e,t,i,s){const n=(l,c)=>Ov(l,c,t.removed,i.removed),a=(l,c)=>Ov(l,c,t.moved,i.moved),r=(l,c)=>Ov(l,c,t.added,i.added),o=AD(e,s);return{status:e,path:{addPhaseFn:r,updatePhaseFn:a,removePhaseFn:n},pathProperties:o}}function zO(e,t){var d,u;const i=((d=e.scales.x)==null?void 0:d.type)==="category",s=((u=t.scales.x)==null?void 0:u.type)==="category";if(i!==s||!gf(e.scales.x)||!gf(t.scales.x))return;let n="updated";t.visible&&!e.visible?n="removed":!t.visible&&e.visible&&(n="added");const a=pf({scales:e.scales,data:e.fillData.spans},{scales:t.scales,data:t.fillData.spans},0);if(a==null)return;const r=pf({scales:e.scales,data:e.fillData.phantomSpans},{scales:t.scales,data:t.fillData.phantomSpans},0);if(r==null)return;const o=pf({scales:e.scales,data:e.strokeData.spans,zeroData:e.fillData.phantomSpans},{scales:t.scales,data:t.strokeData.spans,zeroData:t.fillData.phantomSpans},0);if(o==null)return;const l="none",c=GO(n,a,r,l),h=wD(n,o,l);return{status:n,fill:c,stroke:h}}function ff({id:e},t,i,...s){const n={phase:i?Za[i]:"trailing"};ko(e,"markers",t,s,{opacity:0},{opacity:1},n),s.forEach(a=>a.cleanup())}function ID({id:e},t,...i){ko(e,"markers",t,i,{scalingX:0,scalingY:0},{scalingX:1,scalingY:1},{phase:"initial"}),i.forEach(s=>s.cleanup())}function TD({id:e,nodeDataDependencies:t},i,...s){const n=t.seriesRectWidth;Qt(e,"markers",i,s,{fromFn:(o,l)=>{var d,u;const c=(u=(d=l.midPoint)==null?void 0:d.x)!=null?u:n;let h=we(0,UR(c/n),1);return isNaN(h)&&(h=0),{scalingX:0,scalingY:0,delay:h,duration:Xy,phase:"initial"}},toFn:()=>({scalingX:1,scalingY:1})})}function mf(e){return{opacity:1,scalingX:1,scalingY:1}}function yf(e,t){var i,s,n,a,r,o,l,c;return{x:(s=(i=t.point)==null?void 0:i.x)!=null?s:NaN,y:(a=(n=t.point)==null?void 0:n.y)!=null?a:NaN,scalingCenterX:(o=(r=t.point)==null?void 0:r.x)!=null?o:NaN,scalingCenterY:(c=(l=t.point)==null?void 0:l.y)!=null?c:NaN}}function vf(e,{datumIndex:t}){var c;const i=e.getNodeData();if(i===void 0)return;const s=i[t],{point:n}=s!=null?s:{};if(s==null||n==null)return;const a=4+((c=n.focusSize)!=null?c:e.getFormattedMarkerStyle(s).size),r=a/2,o=s.point.x-r,l=s.point.y-r;return ai.toCanvas(e.contentGroup,new ve(o,l,a,a))}function kD({id:e,visible:t,nodeDataDependencies:i},s,...n){const{seriesRectWidth:a,seriesRectHeight:r}=i;ko(e,"path_properties",s,n,{clipX:0},{clipX:a},{phase:"initial",start:{clip:!0,clipY:r,visible:t},finish:{clip:!1,visible:t}})}function Fv({id:e},t,i,s="add",...n){ko(e,t,i,n,{opacity:0},{opacity:1},{phase:s})}function LD(e){return t=>({visible:e.getVisible(),opacity:e.getOpacity(),clipScalingX:1,clip:!1})}function Bv({nodeDataDependencies:e},t){const i=s=>isFinite(s)?s:0;t.clipX=i(e.seriesRectWidth),t.clipY=i(e.seriesRectHeight)}var Xae=.125,Zae=.25,_v=class extends Xl{constructor(e){super({moduleCtx:e,directionKeys:Ah,directionNames:Ih,categoryKey:"xValue",pathsPerSeries:["fill","stroke"],pathsZIndexSubOrderOffset:[0,1e3],hasMarkers:!0,markerSelectionGarbageCollection:!1,pickModes:[2,0],animationResetFns:{path:LD({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:Fo,marker:(t,i)=>b(b({},mf(t)),yf(t,i))},clipFocusBox:!1}),this.properties=new ci,this.connectsToYAxis=!0,this.backgroundGroup=new Ge({name:`${this.id}-background`,zIndex:0}),this._isStacked=void 0}get pickModeAxis(){return"main"}renderToOffscreenCanvas(){return super.renderToOffscreenCanvas()||this.contextNodeData!=null&&(this.contextNodeData.fillData.spans.length>Pv||this.contextNodeData.strokeData.spans.length>Pv)}attachSeries(e,t,i){super.attachSeries(e,t,i),e.appendChild(this.backgroundGroup)}detachSeries(e,t,i){super.detachSeries(e,t,i),e==null||e.removeChild(this.backgroundGroup)}attachPaths([e,t]){this.backgroundGroup.appendChild(e),this.contentGroup.appendChild(t),t.zIndex=-1}detachPaths([e,t]){this.backgroundGroup.removeChild(e),this.contentGroup.removeChild(t)}isStacked(){var t,i;return((i=(t=this.seriesGrouping)==null?void 0:t.stackCount)!=null?i:1)>1}setSeriesIndex(e){const t=this.isStacked();return!super.setSeriesIndex(e)&&this._isStacked===t?!1:(this._isStacked=t,t?(this.backgroundGroup.zIndex=[0,e],this.contentGroup.zIndex=[1,e,0]):(this.backgroundGroup.zIndex=[1,e,0,0],this.contentGroup.zIndex=[1,e,0,1]),!0)}async processData(e){var x,S;if(this.data==null)return;const{data:t,visible:i,seriesGrouping:{groupIndex:s=this.id,stackCount:n=1}={}}=this,{xKey:a,yKey:r,yFilterKey:o,connectMissingData:l,normalizedTo:c}=this.properties,h=!this.ctx.animationManager.isSkipped(),d=(x=this.axes.x)==null?void 0:x.scale,u=(S=this.axes.y)==null?void 0:S.scale,{xScaleType:p,yScaleType:g}=this.getScaleInformation({xScale:d,yScale:u}),f={value:`area-stack-${s}-yValue`,values:`area-stack-${s}-yValues`,stack:`area-stack-${s}-yValue-stack`,marker:`area-stack-${s}-yValues-marker`},y=[];ni(c)&&y.push(gv(Object.values(f),c)),h&&y.push(Mu());const v={invalidValue:null};(ni(c)||l)&&n>1&&(v.invalidValue=0),i||(v.forceValue=0),await this.requestDataModel(e,t,{props:[er(a,p,{id:"xValue"}),et(r,g,b({id:"yValueRaw"},v)),...o!=null?[et(o,g,{id:"yFilterRaw"})]:[],...$1(r,g,E(b({id:"yValueStack"},v),{groupId:f.stack})),et(r,g,E(b({id:"yValue"},v),{groupId:f.value})),...zl(r,"window","current",E(b({id:"yValueEnd"},v),{groupId:f.values}),g),...zl(r,"normal","current",E(b({id:"yValueCumulative"},v),{groupId:f.marker}),g),...y],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}xCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.x.scale.convert(e),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}yCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.y.scale.convert(e[0]),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}getSeriesDomain(e){const{processedData:t,dataModel:i,axes:s}=this;if(!t||!i)return[];const n=s.y;if(e==="x"){const r=i.resolveProcessedDataDefById(this,"xValue"),o=i.getDomain(this,"xValue","key",t);return(r==null?void 0:r.def.type)==="key"&&r.def.valueType==="category"?o:wn(Ro(o))}const a=this.domainForClippedRange("y",["yValueCumulative"],"xValue",!0);if(n instanceof wu||n instanceof Ma)return wn(a);{const r=Number.isFinite(a[1]-a[0])?[a[0]>0?0:a[0],a[1]<0?0:a[1]]:[];return wn(r)}}getSeriesRange(e,t){const[i,s]=this.domainForVisibleRange("y",["yValueCumulative"],"xValue",t,!0);return[Math.min(i,0),Math.max(s,0)]}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["yValueCumulative"],e,t,i)}createNodeData(){var Z,J,ae,oe,le,de,ue;const{axes:e,data:t,processedData:i,dataModel:s}=this,n=e.x,a=e.y;if(!n||!a||!t||!s||(i==null?void 0:i.type)!=="grouped")return;const{yKey:r,xKey:o,yFilterKey:l,marker:c,label:h,fill:d,stroke:u,connectMissingData:p,interpolation:g}=this.properties,{scale:f}=n,{scale:y}=a,{isContinuousY:v}=this.getScaleInformation({xScale:f,yScale:y}),x=((Z=f.bandwidth)!=null?Z:0)/2,S=s.resolveKeysById(this,"xValue",i),M=s.resolveColumnById(this,"yValueEnd",i),D=s.resolveColumnById(this,"yValueRaw",i),A=s.resolveColumnById(this,"yValueCumulative",i),w=l!=null?s.resolveColumnById(this,"yFilterRaw",i):void 0,T=s.resolveColumnById(this,"yValueStack",i),k=(ie,re,te)=>{let fe;return(ni(this.properties.normalizedTo)?v&&av(te):!isNaN(te))&&(fe=re),{x:f.convert(ie)+x,y:y.convert(fe),size:c.size}},N=[],O=[],{visibleSameStackCount:L}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);let F=!1;const{dataSources:B}=i,_=(J=B.get(this.id))!=null?J:[];for(const{datumIndex:ie}of s.forEachGroupDatum(this,i)){const re=S[ie];if(re==null)return;const te=_[ie],fe=D[ie],me=A[ie],Le=M[ie],Ee=Number.isFinite(fe),He=k(re,+me,fe),Ue=w!=null?w[ie]===fe:void 0;if(Ue===!1&&(F=!0),Ee&&c&&O.push({series:this,itemId:r,datum:te,datumIndex:ie,midPoint:{x:He.x,y:He.y},cumulativeValue:Le,yValue:fe,xValue:re,yKey:r,xKey:o,point:He,fill:(ae=c.fill)!=null?ae:d,stroke:(oe=c.stroke)!=null?oe:u,strokeWidth:(le=c.strokeWidth)!=null?le:this.getStrokeWidth(this.properties.strokeWidth),selected:Ue}),Ee&&h){const je=this.getLabelText(h,{value:fe,datum:te,xKey:o,yKey:r,xName:this.properties.xName,yName:this.properties.yName});N.push({series:this,itemId:r,datum:te,datumIndex:ie,x:He.x,y:He.y,labelText:je})}}const G=ie=>ie.flatMap(re=>Array.isArray(re)?Rv(re,g):new Array(re.skip).fill(null)),V=(ie,re)=>({point:{x:f.convert(ie)+x,y:y.convert(re)},xDatum:ie,yDatum:re}),j=ie=>{const re=[];for(const{datumIndexes:[te,fe,me]}of s.forEachGroupDatumTuple(this,i)){const Le=S[fe],Ee=T[fe],He=Ee[ie],Ue=Number.isFinite(He);if(p&&!Ue)continue;const je=te!=null?T[te]:void 0,Te=me!=null?T[me]:void 0;let Fe=0,lt=0;for(let Ai=0;Ai<=ie;Ai+=1){const vi=Ee[Ai];if(Number.isFinite(vi)){const Bc=je==null||Number.isFinite(je[Ai]),yr=Te==null||Number.isFinite(Te[Ai]);Bc&&(Fe+=vi),yr&&(lt+=vi)}}const wt=re[re.length-1];if(!p&&(Fe!==lt||!Ue))if(!Ue&&Array.isArray(wt)&&wt.length===1)re[re.length-1]={skip:1};else{const Ai=V(Le,Fe),vi=V(Le,lt);Array.isArray(wt)?wt.push(Ai):wt!=null&&(wt.skip+=1),re.push(Ue?[vi]:{skip:0})}else{const Ai=p?He:Math.max(Fe,lt),vi=V(Le,Ai);Array.isArray(wt)?wt.push(vi):wt!=null?(wt.skip+=1,re.push([vi])):re.push([vi])}}return G(re)},H=(ue=(de=this.seriesGrouping)==null?void 0:de.stackIndex)!=null?ue:0,U=()=>{const ie=Array.from(s.forEachGroupDatum(this,i),({datumIndex:re})=>{const te=S[re],me=T[re][H];if(!(p&&!Number.isFinite(me)))return V(te,0)}).filter(re=>re!=null);return Rv(ie,g)},$=j(H),W=$.map(()=>null);for(let ie=H-1;ie>=-1;ie-=1){let re;for(let te=0;te<W.length;te+=1)W[te]==null&&(re!=null||(re=ie!==-1?j(ie):U()),W[te]=re[te])}const Y=$.map((ie,re)=>ie!=null?ie:W[re]),K=$.filter(ie=>ie!=null);return{itemId:r,fillData:{itemId:r,spans:Y,phantomSpans:W},strokeData:{itemId:r,spans:K},labelData:N,nodeData:O,scales:this.calculateScaling(),visible:this.visible,stackVisible:L>0,crossFiltering:F}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(e){var c;const{opacity:t,visible:i,animationEnabled:s}=e,[n,a]=e.paths,r=((c=this.contextNodeData)==null?void 0:c.crossFiltering)===!0,o=this.getStrokeWidth(this.properties.strokeWidth);a.setProperties({fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:1,stroke:this.properties.stroke,strokeWidth:o,strokeOpacity:this.properties.strokeOpacity*(r?Zae:1),lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:t,visible:i||s});const l=bh(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults);xh(n,{fill:l,stroke:void 0,fillOpacity:this.properties.fillOpacity*(r?Xae:1)},void 0,this.getShapeFillBBox()),n.setProperties({lineJoin:"round",pointerEvents:1,fillShadow:this.properties.shadow,opacity:t,visible:i||s}),Bv(this,a),Bv(this,n)}updatePaths(e){this.updateAreaPaths(e.paths,e.contextData)}updateAreaPaths(e,t){for(const i of e)i.visible=t.visible;if(t.visible)this.updateFillPath(e,t),this.updateStrokePath(e,t);else for(const i of e)i.path.clear(),i.markDirty("AreaSeries")}updateFillPath(e,t){const[i]=e;i.path.clear(),_O(i,t.fillData),i.markDirty("AreaSeries")}updateStrokePath(e,t){const{spans:i}=t.strokeData,[,s]=e;s.path.clear(),DD(s,i),s.markDirty("AreaSeries")}updateMarkerSelection(e){var n;const{nodeData:t,markerSelection:i}=e,s=this.properties.marker.enabled||((n=this.contextNodeData)==null?void 0:n.crossFiltering)===!0;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(s?t:[])}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i}=e,{xKey:s,yKey:n,marker:a,fill:r,stroke:o,strokeWidth:l,fillOpacity:c,strokeOpacity:h,highlightStyle:d}=this.properties,u=this.getSeriesDomain("x"),p=this.getSeriesDomain("y"),g=Je(i&&d.item,a.getStyle(),{fill:r,stroke:o,strokeWidth:l,fillOpacity:c,strokeOpacity:h}),f=this.getShapeFillBBox();t.each((y,v)=>{this.updateMarkerStyle(a,y,v.datum,v.point,Ol(v,s,n,u,p),i,g,f,{selected:v.selected})}),i||this.properties.marker.markClean()}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{enabled:i,fontStyle:s,fontWeight:n,fontSize:a,fontFamily:r,color:o}=this.properties.label;t.each((l,c)=>{const{x:h,y:d,labelText:u}=c;u&&i&&this.visible?(l.fontStyle=s,l.fontWeight=n,l.fontSize=a,l.fontFamily=r,l.textAlign="center",l.textBaseline="bottom",l.text=u,l.x=h,l.y=d-10,l.fill=o,l.visible=!0):l.visible=!1})}getTooltipContent(e){var A;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{xKey:r,xName:o,yKey:l,yName:c,tooltip:h,marker:d}=a,u=n.x,p=n.y;if(!i||!s||!u||!p)return;const g=(A=s.dataSources.get(this.id))==null?void 0:A[e],f=i.resolveKeysById(this,"xValue",s)[e],y=i.resolveColumnById(this,"yValueRaw",s)[e],{xDomain:v,yDomain:x}=this.cachedDatumCallback("domain",()=>({xDomain:this.getSeriesDomain("x"),yDomain:this.getSeriesDomain("y")}));if(f==null)return;const S=d.getStyle(),M={datum:g,xValue:f,yValue:y},D=this.getMarkerStyle(d,g,Ol(M,r,l,v,x),!1,void 0,S);return this.formatTooltipWithContext(h,{heading:u.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:p.formatDatum(y)}]},b(b({seriesId:t,datum:g,title:c,xKey:r,xName:o,yKey:l,yName:c},D),this.getModuleTooltipParams()))}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:a,marker:r,fillGradientDefaults:o,fillPatternDefaults:l,fillImageDefaults:c}=this.properties,h=!r.enabled||r.fill===void 0,d=h?bh(e,o,l,c):bh(r.fill,r.fillGradientDefaults,r.fillPatternDefaults,r.fillImageDefaults),u=this.getMarkerStyle(r,void 0,void 0,!1,void 0,{fill:d,fillOpacity:h?i:r.fillOpacity});return{marker:E(b({},u),{enabled:r.enabled||n<=0}),line:{stroke:t,strokeOpacity:s,strokeWidth:n,lineDash:a}}}getLegendData(e){var l;if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{yKey:n,yName:a,legendItemName:r,showInLegend:o}=this.properties;return[{legendType:e,id:t,itemId:n,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:(l=r!=null?r:a)!=null?l:n},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!o}]}animateEmptyUpdateReady(e){const{markerSelection:t,labelSelection:i,contextData:s,paths:n}=e,{animationManager:a}=this.ctx;this.updateAreaPaths(n,s),kD(this,a,...n),ns([t],yf),TD(this,a,t),dt(this,"labels",a,i)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{animationManager:t}=this.ctx,{markerSelection:i,labelSelection:s,contextData:n,paths:a,previousContextData:r}=e,[o,l]=a;if(o==null&&l==null)return;this.resetMarkerAnimation(e),this.resetLabelAnimation(e);const c=()=>{this.resetPathAnimation(e),this.updateAreaPaths(a,n)},h=()=>{t.skipCurrentBatch(),c()};if(n==null||r==null){c(),ff(this,t,"added",i),Fv(this,"fill_path_properties",t,"add",o),Fv(this,"stroke_path_properties",t,"add",l),dt(this,"labels",t,s);return}if(n.crossFiltering!==r.crossFiltering){h();return}const d=zO(n,r);if(d===void 0){h();return}else if(d.status==="no-op")return;ff(this,t,void 0,i),Qt(this.id,"fill_path_properties",t,[o],d.fill.pathProperties),kv(this.id,"fill_path_update",t,[o],d.fill.path),Qt(this.id,"stroke_path_properties",t,[l],d.stroke.pathProperties),kv(this.id,"stroke_path_update",t,[l],d.stroke.path),dt(this,"labels",t,s),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,n)})}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Ge}getFormattedMarkerStyle(e){const{xKey:t,yKey:i}=e,s=this.getSeriesDomain("x"),n=this.getSeriesDomain("y");return this.getMarkerStyle(this.properties.marker,e.datum,Ol(e,t,i,s,n),!0)}computeFocusBounds(e){return vf(this,e)}};_v.className="AreaSeries",_v.type="area";var PD=ce("millisecond","second","minute","hour","day","month","year"),Zl=st(qQ,"a valid number format string"),kh=b({enabled:q,text:z,padding:ne},It),zr=st(b(b({enabled:q,type:ee(ce("line","range")),range:Pt(st((e,{options:t})=>t.type==="range","crossLine type to be 'range'"),Ie(_e),jd(2,2)),value:Pt(st((e,{options:t})=>t.type==="line","crossLine type to be 'line'"),_e),label:kh,fill:z,fillOpacity:Me},ge),De),"cross-line options"),Go=E(b({},zr),{label:E(b({},kh),{position:ce("top","left","right","bottom","top-left","top-right","bottom-left","bottom-right","inside","inside-left","inside-right","inside-top","inside-bottom","inside-top-left","inside-bottom-left","inside-top-right","inside-bottom-right"),rotation:ne})}),Lh=b({enabled:q,rotation:ne,avoidCollisions:q,minSpacing:X,spacing:X,formatter:ft,itemStyler:Ft(E(b({},It),{spacing:ne}))},It),bf=b({autoRotate:q,autoRotateAngle:ne},Lh),ED=b({format:Zl},bf),xf=b({format:Ne(z,dy)},bf),VO={enabled:q,width:X,size:X,stroke:ye},Gv={enabled:q,label:xf,tick:VO},ql={reverse:q,gridLine:{enabled:q,width:X,style:Li({stroke:Ne(ye,py),lineDash:Ie(X)},"a grid-line style object array")},interval:{values:Ie(_e),minSpacing:X},label:Lh,line:{enabled:q,width:X,stroke:ye},tick:VO};ql.context=Ce(()=>!0),ql.layoutConstraints=Ce({stacked:ee(q),align:ee(ce("start","end")),unit:ee(ce("percent","px")),width:ee(X)});var zo=E(b({},ql),{keys:Ie(z),crossLines:Li(Go,"a cross-line options array"),position:ce("top","right","bottom","left"),thickness:X,title:b({enabled:q,text:z,spacing:X,formatter:ft},It)});zo.title._enabledFromTheme=Ce(q);function Ql(e){const t={enabled:q,xOffset:ne,yOffset:ne,renderer:uy(Ne(z,es({text:z,color:ye,backgroundColor:ye,opacity:Me},"crosshair label renderer result object")))};return e&&(t.format=z),b(b({enabled:q,snap:q,label:t},ge),De)}function Jl(e,t){return{min:Pt(e,Ar("max")),max:Pt(e,Il("min")),nice:q,interval:{step:t?Ne(e0,PD,dE(ji)):e0,values:Ie(e),minSpacing:Pt(X,Ar("maxSpacing")),maxSpacing:Pt(X,Il("minSpacing"))}}}var zv=Ne(ce("circle","cross","diamond","heart","plus","pin","square","star","triangle"),ft),jO=ce("never","always","hyphenate","on-space"),Vv=ce("top","right","bottom","left","top-right","bottom-right","bottom-left","top-left","center"),RD=ce("pointer","node","top","right","bottom","left","top-left","top-right","bottom-left","bottom-right"),jv=Ne(X,ce("exact","nearest")),HO=ce("pointer","start","middle","end"),Hv=b({enabled:q,text:z,textAlign:ce("left","center","right"),wrapping:ce("never","always","hyphenate","on-space"),spacing:X,maxWidth:X,maxHeight:X},It);Hv.padding=Ce(X);var Wv={enabled:q,text:z,renderer:uy(Ne(z,oE))},ND=["defaults","download","zoom-to-cursor","pan-to-cursor","toggle-series-visibility","toggle-other-series","separator"],WO={type:ce("action","separator"),showOn:ce("always","series-area","series-node","legend-item"),label:ee(z),enabled:q,action:ft,items:(e,t)=>UO(e,t)};WO.iconUrl=Ce(z);var qae=es(WO),Qae=st((e,t)=>{let i;return typeof e=="string"?ND.includes(e)?i=!0:(i={valid:!1,invalid:[],cleared:null},i.invalid.push(new eh(rE.Invalid,`a context menu item string alias: ["${ND.join('", "')}"]`,e,t.path))):i=qae(e,t),i},`a context menu item object or string alias: [${ND.join(", ")}]`),UO=Ie(Qae,"a menu items array",!1),Uv=Li({label:ee(z),action:ee(ft)},"a context menu actions array"),Ph={label:z,ariaLabel:z,tooltip:z,icon:ce("align-center","align-left","align-right","arrow-drawing","arrow-down-drawing","arrow-up-drawing","callout-annotation","candlestick-series","close","comment-annotation","date-range-drawing","date-price-range-drawing","delete","disjoint-channel-drawing","drag-handle","fill-color","line-style-solid","line-style-dashed","line-style-dotted","high-low-series","hlc-series","hollow-candlestick-series","horizontal-line-drawing","line-color","line-series","line-with-markers-series","locked","measurer-drawing","note-annotation","ohlc-series","pan-end","pan-left","pan-right","pan-start","parallel-channel-drawing","position-bottom","position-center","position-top","price-label-annotation","price-range-drawing","reset","settings","step-line-series","text-annotation","trend-line-drawing","fibonacci-retracement-drawing","fibonacci-retracement-trend-based-drawing","unlocked","vertical-line-drawing","zoom-in","zoom-out")},Pe={width:X,height:X,minWidth:X,minHeight:X,suppressFieldDotNotation:q,title:Hv,subtitle:Hv,footnote:Hv,padding:{top:X,right:X,bottom:X,left:X},seriesArea:{clip:q,padding:{top:X,right:X,bottom:X,left:X}},legend:{enabled:q,position:ce("top","right","bottom","left"),orientation:ce("horizontal","vertical"),maxWidth:X,maxHeight:X,spacing:X,preventHidingAll:q,reverseOrder:q,toggleSeries:q,item:{marker:{size:X,shape:zv,padding:X,strokeWidth:X},line:{length:X,strokeWidth:X},label:b({maxLength:X,formatter:ft},It),maxWidth:X,paddingX:X,paddingY:X,showSeriesStroke:q},pagination:{marker:{size:X,shape:zv,padding:X},activeStyle:b(b({},xe),ge),inactiveStyle:b(b({},xe),ge),highlightStyle:b(b({},xe),ge),label:It},listeners:{legendItemClick:ft,legendItemDoubleClick:ft}},gradientLegend:{enabled:q,position:ce("top","right","bottom","left"),spacing:X,reverseOrder:q,gradient:{preferredLength:X,thickness:X},scale:{label:E(b({},It),{format:Zl,formatter:ft}),padding:X,interval:{step:ne,values:hn,minSpacing:Pt(X,Ar("maxSpacing")),maxSpacing:Pt(X,Il("minSpacing"))}}},listeners:{seriesNodeClick:ft,seriesNodeDoubleClick:ft,seriesVisibilityChange:ft,click:ft,doubleClick:ft,annotations:ft,zoom:ft},loadGoogleFonts:q,highlight:{range:ce("tooltip","node")},overlays:{loading:Wv,noData:Wv,noVisibleSeries:Wv,unsupportedBrowser:Wv},tooltip:{enabled:q,showArrow:q,pagination:q,delay:X,range:jv,wrapping:jO,mode:ce("single","shared","compact"),position:{type:RD,anchorTo:ce("pointer","node","chart"),placement:Ne(Vv,Ie(Vv)),xOffset:ne,yOffset:ne}},animation:{enabled:q,duration:X},contextMenu:{enabled:q,items:UO,extraActions:Uv,extraSeriesAreaActions:Uv,extraNodeActions:Uv,extraLegendItemActions:Uv},dataSource:{getData:ft},keyboard:{enabled:q,tabIndex:ne},touch:{dragAction:ce("none","drag","hover")},ranges:{enabled:q,buttons:Li(E(b({},Ph),{value:Ne(ne,Pt(Ie(Ne(ne,wr)),jd(2,2)),ft)}),"range button options array")},locale:{localeText:dy,getLocaleText:uy(z)},background:{visible:q,fill:ye,image:{url:ee(z),top:ne,right:ne,bottom:ne,left:ne,width:X,height:X,opacity:Me}},styleNonce:z,sync:{enabled:q,groupId:z,axes:ce("x","y","xy"),nodeInteraction:q,zoom:q},zoom:{enabled:q,enableAxisDragging:q,enableDoubleClickToReset:q,enablePanning:q,enableScrolling:q,enableSelecting:q,enableTwoFingerZoom:q,keepAspectRatio:q,anchorPointX:HO,anchorPointY:HO,axes:ce("x","y","xy"),deceleration:Ne(ce("off","short","long"),Me),minVisibleItems:X,minVisibleItemsX:X,minVisibleItemsY:X,panKey:ce("alt","ctrl","meta","shift"),scrollingStep:Me,autoScaling:{enabled:q,padding:Me},buttons:{enabled:q,buttons:Li(E(b({},Ph),{value:ce("reset","zoom-in","zoom-out","pan-left","pan-right","pan-start","pan-end"),section:z}),"zoom button options array"),visible:ce("always","zoomed","hover")}}};Pe.dataSource.requestThrottle=Ce(X),Pe.dataSource.updateThrottle=Ce(X),Pe.dataSource.updateDuringInteraction=Ce(q),Pe.zoom.enableIndependentAxes=Ce(q),Pe.statusBar=Ce(_e),Pe.foreground=Ce(b({visible:q,text:z,image:{url:z,top:ne,right:ne,bottom:ne,left:ne,width:X,height:X,opacity:Me}},xe)),Pe.context=Ce(()=>!0),Pe.overrideDevicePixelRatio=Ce(ne),Pe.sync.domainMode=Ce(ce("direction","position","key"));var it={cursor:z,showInLegend:q,nodeClickRange:jv,listeners:{nodeClick:ft,nodeDoubleClick:ft},highlightStyle:{item:b(b({},xe),ge),series:{enabled:q,dimOpacity:Me,strokeWidth:X}}},Jn=E(b({},it),{id:z,visible:q,data:hn});Jn.context=Ce(()=>!0),Jn.seriesGrouping=Ce(_e),Jn.highlight=Ce({enabled:q});var Vo=b(b(b({enabled:q,shape:zv,size:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{shape:zv,size:X}))},xe),ge),De),bt=b({enabled:q,formatter:ft},It),ec=E(b({},bt),{lineHeight:X,minimumFontSize:X,wrapping:jO,overflowStrategy:ce("ellipsis","hide")}),Cf=b(b({visible:q,cap:b(b({visible:q,length:X,lengthRatio:Me},ge),De)},ge),De),Kv=E(b({},Cf),{xLowerKey:z,xUpperKey:z,yLowerKey:z,yUpperKey:z,xLowerName:z,xUpperName:z,yLowerName:z,yUpperName:z,itemStyler:Ft(E(b(b({visible:q},ge),De),{cap:b(b({visible:q,length:X,lengthRatio:Me},ge),De)}))}),nt={enabled:q,showArrow:q,range:jv,renderer:uy(Ne(z,es({heading:z,title:z,data:Li({label:ee(z),value:ee(z)})},"tooltip renderer result object"))),position:{type:RD,anchorTo:ce("node","pointer","chart"),placement:Ne(Vv,Ie(Vv)),xOffset:ne,yOffset:ne},interaction:{enabled:q}};nt.position._seriesOverrideType=Ce(RD);var Vr={enabled:q,xOffset:ne,yOffset:ne,blur:X,color:ye},$v=th({linear:{},smooth:{tension:Me},step:{position:ce("start","middle","end")}},"interpolation line options"),KO=b(b(b(b({showInMiniChart:q,connectMissingData:q,interpolation:$v,label:bt,marker:Vo,tooltip:nt,shadow:Vr},it),xe),ge),De),$O=E(b(b({},KO),Jn),{type:ee(Oe("area")),xKey:ee(z),yKey:ee(z),xName:z,yName:z,stacked:q,stackGroup:z,normalizedTo:ne}),Jae={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"area",moduleFactory:e=>new _v(e),stackable:!0,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{nodeClickRange:"nearest",tooltip:{position:{_seriesOverrideType:"node"}},fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:$l,fillImageDefaults:wh,stroke:{$palette:"stroke"},fillOpacity:.8,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,shadow:{enabled:!1,color:Wl,xOffset:3,yOffset:3,blur:5},interpolation:{type:"linear"},marker:{enabled:!1,shape:"circle",size:7,strokeWidth:0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:$l},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}}}},YO={type:"series",name:"area",chartType:"cartesian",options:$O,create:e=>new _v(e)};function OD(e,t){for(const i of t){const s=i.datum;s===void 0?se.error("undefined datum"):e.addValue(i,s)}}function FD(e,t){const{x:i,y:s}=t,{nearest:n,distanceSquared:a}=e.getQuadTree().find(i,s);if(n!==void 0)return{datum:n.value,distance:Math.sqrt(a)}}var BD=class extends _o{constructor(){super(...arguments),this.direction="vertical"}};I([P],BD.prototype,"direction",2);var XO=class extends Xl{constructor(){super(...arguments),this.groupScale=new Ug,this.smallestDataInterval=void 0,this.largestDataInterval=void 0}padBandExtent(e,t){var a;const i=typeof t=="boolean"?1:.5,s=Xe(this.smallestDataInterval)?this.smallestDataInterval*i:0,n=(a=Ro(e))!=null?a:[NaN,NaN];return typeof t=="boolean"?n[t?0:1]-=(t?1:-1)*s:(n[0]-=s,n[1]+=s),wn(n)}getBandScalePadding(){return{inner:.3,outer:.15}}shouldFlipXY(){return!this.isVertical()}isVertical(){return this.properties.direction==="vertical"}getBarDirection(){return this.shouldFlipXY()?"x":"y"}getCategoryDirection(){return this.shouldFlipXY()?"y":"x"}getValueAxis(){const e=this.getBarDirection();return this.axes[e]}getCategoryAxis(){const e=this.getCategoryDirection();return this.axes[e]}getBandwidth(e,t){return Mt.is(e.scale)?e.scale.calcBandwidth(this.smallestDataInterval,t):e.scale.bandwidth}xCoordinateRange(e){var r;const t=this.axes[this.getCategoryDirection()],i=t.scale,s=(r=this.getBandwidth(t,0))!=null?r:0,n=Mt.is(i)?s*-.5:0,a=i.convert(e)+n;return[a,a+s]}yCoordinateRange(e){const i=this.axes[this.getBarDirection()].scale,s=e.map(n=>i.convert(n));if(s.length===1){const n=i.convert(0);return[Math.min(s[0],n),Math.max(s[0],n)]}return[Math.min(...s),Math.max(...s)]}updateGroupScale(e){const t=[],{groupScale:i}=this,s=this.getBandwidth(e),{index:n,visibleGroupCount:a}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);for(let o=0;o<a;o++)t.push(String(o));return i.domain=t,i.range=[0,s!=null?s:0],e instanceof Mh?i.paddingInner=e.groupPaddingInner:e instanceof Gl?(i.paddingInner=e.groupPaddingInner,i.round=i.padding!==0):i.padding=0,{barWidth:i.bandwidth>=1?i.bandwidth:i.rawBandwidth,groupIndex:n}}resolveKeyDirection(e){return this.getBarDirection()==="x"?e==="x"?"y":"x":e}initQuadTree(e){OD(e,this.datumNodesIter())}pickNodeClosestDatum(e){return FD(this,e)}},_D=class extends as{constructor(){super(...arguments),this.placement="inside-center",this.padding=0}};I([P],_D.prototype,"placement",2),I([P],_D.prototype,"padding",2);var Gt=class extends BD{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new wa,this.fillPatternDefaults=new Wt,this.fillImageDefaults=new In,this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.crisp=void 0,this.shadow=new sr,this.label=new _D,this.tooltip=new Ys,this.sparklineMode=!1,this.fastDataProcessing=!1}};I([P],Gt.prototype,"xKey",2),I([P],Gt.prototype,"xName",2),I([P],Gt.prototype,"yKey",2),I([P],Gt.prototype,"yName",2),I([P],Gt.prototype,"yFilterKey",2),I([P],Gt.prototype,"stackGroup",2),I([P],Gt.prototype,"normalizedTo",2),I([P],Gt.prototype,"fill",2),I([P],Gt.prototype,"fillGradientDefaults",2),I([P],Gt.prototype,"fillPatternDefaults",2),I([P],Gt.prototype,"fillImageDefaults",2),I([P],Gt.prototype,"fillOpacity",2),I([P],Gt.prototype,"stroke",2),I([P],Gt.prototype,"strokeWidth",2),I([P],Gt.prototype,"strokeOpacity",2),I([P],Gt.prototype,"lineDash",2),I([P],Gt.prototype,"lineDashOffset",2),I([P],Gt.prototype,"cornerRadius",2),I([P],Gt.prototype,"crisp",2),I([P],Gt.prototype,"itemStyler",2),I([P],Gt.prototype,"shadow",2),I([P],Gt.prototype,"label",2),I([P],Gt.prototype,"tooltip",2),I([P],Gt.prototype,"sparklineMode",2),I([P],Gt.prototype,"fastDataProcessing",2);function ZO(e,t,i,s){if(t!=null){const[n,a]=t;if(n!==0||a!==1)return!1}if(Mt.is(e)){const n=e.calcBandwidth(s)-e.calcBandwidth(i);if(n>0&&n<1)return!1}return!0}var GD=e=>{var t;return c0((t=e.yValue)!=null?t:0)};function Sf(e,t,i){const{startingX:s,startingY:n}=tre(e,t);return{isVertical:e,calculate:(r,o)=>{let l=e?r.x:s,c=e?n:r.y,h=e?r.width:0,d=e?0:r.height;const{opacity:u=1}=r;o&&(isNaN(l)||isNaN(c))&&({x:l,y:c}=o,h=e?o.width:0,d=e?0:o.height,e&&!GD(o)?c+=o.height:!e&&GD(o)&&(l+=o.width));let p;return r.clipBBox==null?p=void 0:GD(r)?p=e?new ve(l,c-d,h,d):new ve(l-h,c,h,d):p=new ve(l,c,h,d),{x:l,y:c,width:h,height:d,clipBBox:p,opacity:u}},mode:i}}function ere(e,t){return{isVertical:e,calculate:i=>{var s;return{x:e?i.x:i.x+i.width/2,y:e?i.y+i.height/2:i.y,width:e?i.width:0,height:e?0:i.height,clipBBox:i.clipBBox,opacity:(s=i.opacity)!=null?s:1}},mode:t}}function Mf(e){const t=a=>a==null||isNaN(a.x)||isNaN(a.y);return{toFn:(a,r,o)=>{var l;return o==="removed"&&a.datum==null&&e.mode==="fade"?E(b({},Df(a,r)),{opacity:0}):o==="removed"||t(r)?e.calculate(r,a.previousDatum):{x:r.x,y:r.y,width:r.width,height:r.height,clipBBox:r.clipBBox,opacity:(l=r.opacity)!=null?l:1}},fromFn:(a,r,o)=>{var h;o==="updated"&&t(r)?o="removed":o==="updated"&&t(a.previousDatum)&&(o="added");let l;o==="added"&&a.previousDatum==null&&e.mode==="fade"?l=E(b({},Df(a,r)),{opacity:0}):o==="unknown"||o==="added"?l=e.calculate(r,a.previousDatum):l={x:a.x,y:a.y,width:a.width,height:a.height,clipBBox:a.clipBBox,opacity:(h=a.opacity)!=null?h:1};const c=Za[o];return E(b({},l),{phase:c})},applyFn:(a,r,o)=>{var l,c;a.setProperties(r),a.crisp=o==="end"&&((c=(l=a.datum)==null?void 0:l.crisp)!=null?c:!1)}}}function tre(e,t){const i=t[e?"y":"x"];let s=1/0,n=0;return i?(e?n=i.scale.convert(Mt.is(i.scale)?0:Math.max(...i.range)):s=i.scale.convert(Mt.is(i.scale)?0:Math.min(...i.range)),{startingX:s,startingY:n}):{startingX:s,startingY:n}}function Df(e,{x:t,y:i,width:s,height:n,clipBBox:a,opacity:r=1}){var o,l;return{x:t,y:i,width:s,height:n,clipBBox:a,opacity:r,crisp:(l=(o=e.datum)==null?void 0:o.crisp)!=null?l:!1}}function zD(e,t){if(t===void 0)return;const{x:i,y:s,width:n,height:a}=t;return ai.toCanvas(e.contentGroup,new ve(i,s,n,a))}function VD(e,t,i,s,n,a){var l,c,h;let r=(c=(l=a==null?void 0:a.reduced)==null?void 0:l.diff)==null?void 0:c[e];if(r!=null&&r.changed)return r;const o=ire(s,n);return r==null&&((h=a==null?void 0:a.reduced)==null?void 0:h.diff)!=null?(r={changed:!0,added:new Set,updated:new Set,removed:new Set,moved:new Set},o?r.updated=new Set(Array.from(t,({datum:d})=>i(d))):r.added=new Set(Array.from(t,({datum:d})=>i(d)))):o&&(r={changed:!0,added:new Set,updated:new Set(Array.from(t,({datum:d})=>i(d))),removed:new Set,moved:new Set}),r}function qO(e){return typeof e=="object"&&e!==null&&"groupScale"in e}function ire(e,t){if(!t)return!1;const i=e.scales,s=t.scales;if(!Th(i.x,s.x)||!Th(i.y,s.y))return!0;if(!qO(e)||!qO(t))return!1;const n=e.groupScale,a=t.groupScale;return!Th(n,a)}function QO(e,t,i){if(t.enabled&&i){const{x:s,y:n,text:a,textAlign:r,textBaseline:o}=i,{color:l,fontStyle:c,fontWeight:h,fontSize:d,fontFamily:u}=t;e.setProperties({visible:!0,x:s,y:n,text:a,fill:l,fontStyle:c,fontWeight:h,fontSize:d,fontFamily:u,textAlign:r,textBaseline:o})}else e.visible=!1}var sre={"inside-start":{inside:!0,direction:-1,textAlignment:1},"inside-end":{inside:!0,direction:1,textAlignment:-1},"outside-start":{inside:!1,direction:-1,textAlignment:-1},"outside-end":{inside:!1,direction:1,textAlignment:1}};function JO({isUpward:e,isVertical:t,placement:i,padding:s=0,rect:n}){let a=n.x+n.width/2,r=n.y+n.height/2,o="center",l="middle";if(i!=="inside-center"){const c=(e?1:-1)*(t?-1:1),{direction:h,textAlignment:d}=sre[i],u=(h+1)*.5;if(t){const p=e?n.y+n.height:n.y,g=n.height*c;r=p+g*u+s*d*c,l=d===c?"top":"bottom"}else{const p=e?n.x:n.x+n.width,g=n.width*c;a=p+g*u+s*d*c,o=d===c?"left":"right"}}return{x:a,y:r,textAlign:o,textBaseline:l}}var nre=0,are=1,rre=2,ore=3,lre=4,wf=class extends XO{constructor(e){super({moduleCtx:e,directionKeys:Ah,directionNames:Ih,categoryKey:"xValue",pickModes:[2,1,0],pathsPerSeries:[],hasHighlightedLabels:!0,datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:Df,label:Fo}}),this.properties=new Gt,this.connectsToYAxis=!0,this.dataAggregationFilters=void 0}get pickModeAxis(){return this.properties.sparklineMode?"main":void 0}crossFilteringEnabled(){return this.properties.yFilterKey!=null&&(this.seriesGrouping==null||this.seriesGrouping.stackIndex===0)}async processData(e){var T,k,N,O,L,F,B,_;if(!this.data)return;const{xKey:t,yKey:i,yFilterKey:s,normalizedTo:n,fastDataProcessing:a}=this.properties,{seriesGrouping:{groupIndex:r=this.id}={},data:o}=this,l=(k=(T=this.seriesGrouping)==null?void 0:T.groupCount)!=null?k:0,h=((O=(N=this.seriesGrouping)==null?void 0:N.stackCount)!=null?O:0)>=1||n!=null,d=!a||l>1||h,u=!this.ctx.animationManager.isSkipped(),p=(L=this.getCategoryAxis())==null?void 0:L.scale,g=(F=this.getValueAxis())==null?void 0:F.scale,{isContinuousX:f,xScaleType:y,yScaleType:v}=this.getScaleInformation({xScale:p,yScale:g}),x=`bar-stack-${r}-yValues`,S=`${x}-trailing`,M=this.visible?{}:{forceValue:0},D=[er(t,y,{id:"xValue"}),et(i,v,b({id:"yValue-raw",invalidValue:null},M))];this.crossFilteringEnabled()&&D.push(et(s,v,b({id:"yFilterValue",invalidValue:null},M))),h&&D.push(...zl(i,"normal","current",b({id:"yValue-end",rangeId:"yValue-range",invalidValue:null,missingValue:0,groupId:x,separateNegative:!0},M),v),...zl(i,"trailing","current",b({id:"yValue-start",invalidValue:null,missingValue:0,groupId:S,separateNegative:!0},M),v)),f&&D.push(Y1,X1),Xe(n)&&D.push(gv([x,S],Math.abs(n))),u&&this.processedData&&D.push(Du(this.id,this.processedData)),(u||!d)&&D.push(Mu());const{dataModel:A,processedData:w}=await this.requestDataModel(e,o,{props:D,groupByKeys:d,groupByData:!d});this.dataAggregationFilters=this.aggregateData(A,w),this.smallestDataInterval=(B=w.reduced)==null?void 0:B.smallestKeyInterval,this.largestDataInterval=(_=w.reduced)==null?void 0:_.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){var r;const{processedData:t,dataModel:i}=this;if(i==null||t==null)return[];if(e===this.getCategoryDirection()){const o=i.resolveProcessedDataDefById(this,"xValue"),l=i.getDomain(this,"xValue","key",t);return(o==null?void 0:o.def.type)==="key"&&o.def.valueType==="category"?l:this.padBandExtent(l)}const s=(r=this.dataModel)!=null&&r.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw";let n=this.domainForClippedRange(e,[s],"xValue",!0);const a=this.crossFilteringEnabled()?i.getDomain(this,"yFilterValue","value",t):void 0;if(a!=null&&(n=[Math.min(n[0],a[0]),Math.max(n[1],a[1])]),this.getValueAxis()instanceof wu)return wn(n);{const o=Number.isFinite(n[1]-n[0])?[Math.min(0,n[0]),Math.max(0,n[1])]:[];return wn(o)}}getSeriesRange(e,t){var a;const i=(a=this.dataModel)!=null&&a.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw",[s,n]=this.domainForVisibleRange("y",[i],"xValue",t,!0);return[Math.min(s,0),Math.max(n,0)]}getVisibleItems(e,t,i){var n;const s=(n=this.dataModel)!=null&&n.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw";return this.countVisibleItems("xValue",[s],e,t,i)}aggregateData(e,t){}createNodeData(){var U,$;const{dataModel:e,processedData:t,groupScale:i,dataAggregationFilters:s}=this,n=this.getCategoryAxis(),a=this.getValueAxis();if(!e||!t||!n||!a)return;const r=(U=t.dataSources)==null?void 0:U.get(this.id);if(r==null)return;const o=n.scale,l=a.scale,{xKey:c,yKey:h,xName:d,yName:u,legendItemName:p,label:g}=this.properties,f=a.isReversed(),{barWidth:y,groupIndex:v}=this.updateGroupScale(n),x=i.convert(String(v)),S=Mt.is(o)?y*-.5:0,M=e.resolveKeysById(this,"xValue",t),D=e.resolveColumnById(this,"yValue-raw",t),A=this.crossFilteringEnabled()?e.resolveColumnById(this,"yFilterValue",t):void 0,w=!this.ctx.animationManager.isSkipped(),T=W=>o.convert(M[W])+x+S,k=($=this.properties.crisp)!=null?$:ZO(n==null?void 0:n.scale,n==null?void 0:n.visibleRange,this.smallestDataInterval,this.largestDataInterval),N=l.convert(0),O=({datum:W,datumIndex:Y,valueIndex:K,xValue:Q,yValue:Z,cumulativeValue:J,phantom:ae,currY:oe,prevY:le,x:de,width:ue,isPositive:ie,yRange:re,labelText:te,opacity:fe,crossScale:me=1})=>{const Le=ie!==f,Ee=l.convert(oe),He=l.convert(le),Ue=l.convert(re),je=this.getBarDirection()==="x",Te=ue*.5*(1-me),Fe={x:je?Math.min(Ee,He):de+Te,y:je?de+Te:Math.min(Ee,He),width:je?Math.abs(He-Ee):ue*me,height:je?ue*me:Math.abs(He-Ee)},lt=new ve(Fe.x,Fe.y,Fe.width,Fe.height),wt={x:je?Math.min(N,Ue):de+Te,y:je?de+Te:Math.min(N,Ue),width:je?Math.abs(N-Ue):ue*me,height:je?ue*me:Math.abs(N-Ue)},Ai=this.shouldFlipXY()?Fe.height:Fe.width;return{series:this,itemId:ae?Zn(h,ae):h,datum:W,datumIndex:Y,valueIndex:K,cumulativeValue:J,phantom:ae,xValue:Q,yValue:Z,yKey:h,xKey:c,capDefaults:{lengthRatioMultiplier:Ai,lengthMax:Ai},x:wt.x,y:wt.y,width:wt.width,height:wt.height,midPoint:{x:Fe.x+Fe.width/2,y:Fe.y+Fe.height/2},opacity:fe,topLeftCornerRadius:je!==Le,topRightCornerRadius:Le,bottomRightCornerRadius:je===Le,bottomLeftCornerRadius:!Le,clipBBox:lt,crisp:k,label:te!=null?b({text:te},JO({isUpward:Le,isVertical:!je,placement:g.placement,padding:g.padding,rect:Fe})):void 0,missing:Z==null,focusable:!ae}},L=[],F=[],B=[],_=(W,Y,K,Q,Z,J,ae,oe)=>{const le=M[W];if(le==null)return;const de=D[W],ue=A!=null?Number(A[W]):void 0,ie=de>=0&&!Object.is(de,-0);if(!Number.isFinite(J)||ue!=null&&!Number.isFinite(ue))return;const re=de!=null?this.getLabelText(this.properties.label,{datum:r[W],value:ue!=null?ue:de,xKey:c,yKey:h,xName:d,yName:u,legendItemName:p}):void 0,te=ue!=null&&ue>de,fe=O({datum:r[W],datumIndex:W,valueIndex:Y,xValue:le,yValue:ue!=null?ue:de,cumulativeValue:ue!=null?ue:J,phantom:!1,currY:ue!=null?Z+ue:J,prevY:Z,x:K,width:Q,isPositive:ie,yRange:Math.max(Z+(ue!=null?ue:-1/0),ae),labelText:re,opacity:oe,crossScale:te?.6:void 0});if(F.push(fe),B.push(fe),ue!=null){const me=O({datum:r[W],datumIndex:W,valueIndex:Y,xValue:le,yValue:ue,cumulativeValue:ue,phantom:!0,currY:J,prevY:Z,x:K,width:Q,isPositive:ie,yRange:ae,labelText:void 0,opacity:oe,crossScale:void 0});L.push(me)}},[G,V]=o.range,j=V-G,H=s==null?void 0:s.find(W=>W.maxRange>j);if(t.type==="grouped"){const W=y,Y=e.hasColumnById(this,"yValue-start"),K=Y?e.resolveColumnById(this,"yValue-start",t):void 0,Q=Y?e.resolveColumnById(this,"yValue-end",t):void 0,Z=Y?e.resolveProcessedDataIndexById(this,"yValue-range"):-1;for(const{datumIndex:J,valueIndex:ae,group:{aggregation:oe}}of e.forEachGroupDatum(this,t)){const le=T(J),de=D[J],ue=de>=0&&!Object.is(de,-0),ie=Y?Number(K==null?void 0:K[J]):0,re=Y?Number(Q==null?void 0:Q[J]):de;let te=re;Y&&(te=oe[Z][ue?1:0]),_(J,ae,le,W,ie,re,te,1)}}else if(H==null){const W=y;let[Y,K]=this.visibleRange("xValue",n.range);t.input.count<1e3&&(Y=0,K=t.input.count);for(let Q=Y;Q<K;Q+=1){const Z=T(Q),J=Number(D[Q]);_(Q,0,Z,W,0,J,J,1)}}else{const{indexData:W,indices:Y}=H,[K,Q]=this.visibleRange("xValue",n.range,Y);for(let Z=K;Z<Q;Z+=1){const J=Z*lre,ae=W[J+nre],oe=W[J+are],le=W[J+rre],de=W[J+ore];if(ae===-1)continue;const ue=T((ae+oe)/2|0),ie=Math.abs(T(oe)-T(ae))+y,re=M[de]!=null?Number(D[de]):NaN,te=M[le]!=null?Number(D[le]):NaN;if(re>0){const fe=te>=0?te/re:1;_(de,0,ue,ie,0,re,re,fe)}if(te<0){const fe=re<=0?re/te:1;_(le,1,ue,ie,0,te,te,fe)}}}return{itemId:h,nodeData:L.length>0?[...L,...F]:F,labelData:B,scales:this.calculateScaling(),visible:this.visible||w,groupScale:this.getScaling(this.groupScale)}}nodeFactory(){return new $s}getHighlightData(e,t){const i=e.find(s=>s.datum===t.datum&&!s.phantom);return i!=null?[i]:void 0}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>this.getDatumId(t))}getItemBaseStyle(e){var o,l,c,h,d,u,p,g;const{properties:t}=this,{cornerRadius:i,fillGradientDefaults:s,fillPatternDefaults:n,fillImageDefaults:a}=t,r=e?t.highlightStyle.item:void 0;return Br({fill:(o=r==null?void 0:r.fill)!=null?o:t.fill,fillOpacity:(l=r==null?void 0:r.fillOpacity)!=null?l:t.fillOpacity,stroke:(c=r==null?void 0:r.stroke)!=null?c:t.stroke,strokeWidth:(h=r==null?void 0:r.strokeWidth)!=null?h:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(d=r==null?void 0:r.strokeOpacity)!=null?d:t.strokeOpacity,lineDash:(p=(u=r==null?void 0:r.lineDash)!=null?u:t.lineDash)!=null?p:[],lineDashOffset:(g=r==null?void 0:r.lineDashOffset)!=null?g:t.lineDashOffset,cornerRadius:i},s,n,a)}getItemStyleOverrides(e,t,i,s,n,a){const{id:r,properties:o}=this,{xKey:l,yKey:c,itemStyler:h,fillGradientDefaults:d,fillPatternDefaults:u,fillImageDefaults:p}=o;if(h==null)return;const{xDomain:g,yDomain:f}=this.cachedDatumCallback("domain",()=>({xDomain:this.getSeriesDomain("x"),yDomain:this.getSeriesDomain("y")})),y=this.cachedDatumCallback(Zn(e,a?"highlight":"node"),()=>this.callWithContext(h,b(E(b({seriesId:r},Ol(t,l,c,g,f)),{datum:t,xValue:i,yValue:s,highlighted:a}),n)));return Br(y,d,u,p)}updateDatumNodes(e){const{shadow:t}=this.properties,i=this.getCategoryDirection()==="x",s=this.getItemBaseStyle(e.isHighlight),n=this.getShapeFillBBox();e.datumSelection.each((a,r)=>{var c,h,d,u,p,g;const o=this.getItemStyleOverrides(String(r.datumIndex),r.datum,r.xValue,r.yValue,s,e.isHighlight);a.opacity=(c=r.opacity)!=null?c:0,xh(a,s,o,n);const l=(h=o==null?void 0:o.cornerRadius)!=null?h:s.cornerRadius;a.topLeftCornerRadius=r.topLeftCornerRadius?l:0,a.topRightCornerRadius=r.topRightCornerRadius?l:0,a.bottomRightCornerRadius=r.bottomRightCornerRadius?l:0,a.bottomLeftCornerRadius=r.bottomLeftCornerRadius?l:0,a.visible=i?((u=(d=r.clipBBox)==null?void 0:d.width)!=null?u:r.width)>0:((g=(p=r.clipBBox)==null?void 0:p.height)!=null?g:r.height)>0,a.crisp=r.crisp,a.fillShadow=t})}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=1})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{QO(t,this.properties.label,i.label)})}getTooltipContent(e){var x;const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:a,xName:r,yKey:o,yName:l,legendItemName:c,stackGroup:h,tooltip:d}=n,u=this.getCategoryAxis(),p=this.getValueAxis();if(!i||!s||!u||!p)return;const g=(x=s.dataSources.get(this.id))==null?void 0:x[e],f=i.resolveKeysById(this,"xValue",s)[e],y=i.resolveColumnById(this,"yValue-raw",s)[e];if(f==null)return;const v=this.getItemBaseStyle(!1);return Object.assign(v,this.getItemStyleOverrides(String(e),g,f,y,v,!1)),this.formatTooltipWithContext(d,{heading:u.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:l,fallbackLabel:o,value:p.formatDatum(y)}]},b(b({seriesId:t,datum:g,title:l,xKey:a,xName:r,yKey:o,yName:l,legendItemName:c,stackGroup:h},v),this.getModuleTooltipParams()))}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,fillGradientDefaults:o,fillPatternDefaults:l,fillImageDefaults:c}=this.properties;return{marker:Br({fill:e!=null?e:"rgba(0, 0, 0, 0)",stroke:t!=null?t:"rgba(0, 0, 0, 0)",fillOpacity:s,strokeOpacity:n,strokeWidth:i,lineDash:a,lineDashOffset:r},o,l,c)}}getLegendData(e){var l;const{showInLegend:t}=this.properties;if(e!=="category")return[];const{id:i,ctx:{legendManager:s},visible:n}=this,{yKey:a,yName:r,legendItemName:o}=this.properties;return[{legendType:"category",id:i,itemId:a,seriesId:i,enabled:n&&s.getItemEnabled({seriesId:i,itemId:a}),label:{text:(l=o!=null?o:r)!=null?l:a},symbol:this.legendItemSymbol(),legendItemName:o,hideInLegend:!t}]}animateEmptyUpdateReady({datumSelection:e,labelSelection:t,annotationSelections:i}){const s=Mf(Sf(this.isVertical(),this.axes,"normal"));Qt(this.id,"nodes",this.ctx.animationManager,[e],s),dt(this,"labels",this.ctx.animationManager,t),dt(this,"annotations",this.ctx.animationManager,...i)}animateWaitingUpdateReady(e){const{datumSelection:t,labelSelection:i,annotationSelections:s,contextData:n,previousContextData:a}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id);const r=VD(this.id,t,this.getDatumId.bind(this),e.contextData,a,this.processedData),o=a==null?"fade":"normal",l=Mf(Sf(this.isVertical(),this.axes,o));Qt(this.id,"nodes",this.ctx.animationManager,[t],l,(c,h)=>this.getDatumId(h),r),(r!=null&&r.changed||!Th(n.groupScale,a==null?void 0:a.groupScale))&&(dt(this,"labels",this.ctx.animationManager,i),dt(this,"annotations",this.ctx.animationManager,...s))}getDatumId(e){return Zn(e.xValue,e.valueIndex,e.phantom)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){var i;const t=(i=this.contextNodeData)==null?void 0:i.nodeData[e].clipBBox;return zD(this,t)}};wf.className="BarSeries",wf.type="bar";var jD=b(b(b(b({direction:ce("horizontal","vertical"),showInMiniChart:q,cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),crisp:q,label:E(b({},bt),{placement:ce("inside-center","inside-start","inside-end","outside-start","outside-end"),padding:X}),errorBar:Cf,shadow:Vr,tooltip:nt},it),xe),ge),De);jD.sparklineMode=Ce(q);var Af=E(b(b({},jD),Jn),{type:ee(Oe("bar")),xKey:ee(z),yKey:ee(z),xName:z,yName:z,direction:ce("horizontal","vertical"),grouped:q,stacked:q,stackGroup:z,normalizedTo:ne,legendItemName:z,errorBar:Kv});Af.pickOutsideVisibleMinorAxis=Ce(q),Af.fastDataProcessing=Ce(q),Af.focusPriority=Ce(ne);var eF={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bar",moduleFactory:e=>new wf(e),stackable:!0,groupable:!0,tooltipDefaults:{range:"exact"},defaultAxes:gO,themeTemplate:{series:{direction:"vertical",fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:$l,fillImageDefaults:wh,fillOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$if:[{$or:[{$eq:[{$path:"./placement"},"outside-start"]},{$eq:[{$path:"./placement"},"outside-end"]}]},{$ref:"textColor"},{$ref:"backgroundColor"}]},placement:"inside-center"},shadow:{enabled:!1,color:Wl,xOffset:3,yOffset:3,blur:5},errorBar:{cap:{lengthRatio:.3}}}}},tF={type:"series",name:"bar",chartType:"cartesian",options:Af,create:e=>new wf(e)},HD=class extends os{constructor(){super(...arguments),this.maxSize=30}};I([P,he()],HD.prototype,"maxSize",2),I([P,b0()],HD.prototype,"domain",2);var iF=class extends as{constructor(){super(...arguments),this.placement="top"}};I([P],iF.prototype,"placement",2);var Dt=class extends _o{constructor(){super(...arguments),this.label=new iF,this.tooltip=new Ys,this.marker=new HD}};I([P],Dt.prototype,"xKey",2),I([P],Dt.prototype,"yKey",2),I([P],Dt.prototype,"sizeKey",2),I([P],Dt.prototype,"labelKey",2),I([P],Dt.prototype,"xFilterKey",2),I([P],Dt.prototype,"yFilterKey",2),I([P],Dt.prototype,"sizeFilterKey",2),I([P],Dt.prototype,"xName",2),I([P],Dt.prototype,"yName",2),I([P],Dt.prototype,"sizeName",2),I([P],Dt.prototype,"labelName",2),I([P],Dt.prototype,"title",2),I([vt("marker.shape")],Dt.prototype,"shape",2),I([vt("marker.size")],Dt.prototype,"size",2),I([vt("marker.maxSize")],Dt.prototype,"maxSize",2),I([vt("marker.domain")],Dt.prototype,"domain",2),I([vt("marker.fillGradientDefaults")],Dt.prototype,"fillGradientDefaults",2),I([vt("marker.fillPatternDefaults")],Dt.prototype,"fillPatternDefaults",2),I([vt("marker.fillImageDefaults")],Dt.prototype,"fillImageDefaults",2),I([vt("marker.fill")],Dt.prototype,"fill",2),I([vt("marker.fillOpacity")],Dt.prototype,"fillOpacity",2),I([vt("marker.stroke")],Dt.prototype,"stroke",2),I([vt("marker.strokeWidth")],Dt.prototype,"strokeWidth",2),I([vt("marker.strokeOpacity")],Dt.prototype,"strokeOpacity",2),I([vt("marker.lineDash")],Dt.prototype,"lineDash",2),I([vt("marker.lineDashOffset")],Dt.prototype,"lineDashOffset",2),I([vt("marker.itemStyler")],Dt.prototype,"itemStyler",2),I([P],Dt.prototype,"label",2),I([P],Dt.prototype,"tooltip",2);var cre=class extends xD{constructor(e,t,i,s){super(e,t,i,s),this.sizeKey=s.properties.sizeKey}},Yv=class extends Xl{constructor(e){super({moduleCtx:e,directionKeys:Ah,directionNames:Ih,categoryKey:void 0,pickModes:[2,1,0],pathsPerSeries:[],hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{label:Fo,marker:mf},usesPlacedLabels:!0,clipFocusBox:!1}),this.NodeEvent=cre,this.properties=new Dt,this.sizeScale=new tr}get pickModeAxis(){return"main-category"}async processData(e){var x,S,M;if(this.data==null||!this.visible)return;const t=(x=this.axes.x)==null?void 0:x.scale,i=(S=this.axes.y)==null?void 0:S.scale,{xScaleType:s,yScaleType:n}=this.getScaleInformation({xScale:t,yScale:i}),a=this.sizeScale.type,{xKey:r,yKey:o,sizeKey:l,xFilterKey:c,yFilterKey:h,sizeFilterKey:d,labelKey:u,marker:p}=this.properties,{dataModel:g,processedData:f}=await this.requestDataModel(e,this.data,{props:[et(r,s,{id:"xValue"}),et(o,n,{id:"yValue"}),...c!=null?[et(c,s,{id:"xFilterValue"})]:[],...h!=null?[et(h,n,{id:"yFilterValue"})]:[],...d!=null?[et(d,a,{id:"sizeFilterValue"})]:[],et(l,a,{id:"sizeValue"}),...u?[et(u,"band",{id:"labelValue"})]:[]]}),y=g.resolveProcessedDataIndexById(this,"sizeValue"),v=p.domain?[p.domain[0],p.domain[1]]:void 0;this.sizeScale.domain=(M=v!=null?v:f.domain.values[y])!=null?M:[],this.animationState.transition("updateData")}xCoordinateRange(e,t,i){const{properties:s,sizeScale:n}=this,{size:a,sizeKey:r}=s,o=this.axes.x.scale.convert(e),l=r!=null?this.dataModel.resolveColumnById(this,"sizeValue",this.processedData):void 0,h=.5*(l!=null?n.convert(l[i]):a)*t;return[o-h,o+h]}yCoordinateRange(e,t,i){const{properties:s,sizeScale:n}=this,{size:a,sizeKey:r}=s,o=this.axes.y.scale.convert(e[0]),l=r!=null?this.dataModel.resolveColumnById(this,"sizeValue",this.processedData):void 0,h=.5*(l!=null?n.convert(l[i]):a)*t;return[o-h,o+h]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];const s={x:"xValue",y:"yValue"},n=s[e],a=t.resolveProcessedDataDefById(this,n),r=t.getDomain(this,n,"value",i);if((a==null?void 0:a.def.type)==="value"&&(a==null?void 0:a.def.valueType)==="category")return r;const l=s[e==="x"?"y":"x"],c=this.domainForClippedRange(e,[n],l,!1);return wn(Ro(c))}getSeriesRange(e,t){return this.domainForVisibleRange("y",["yValue"],"xValue",t,!1)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["yValue"],e,t,i)}createNodeData(){var U,$,W;const{axes:e,dataModel:t,processedData:i,sizeScale:s,visible:n}=this,{xKey:a,yKey:r,sizeKey:o,xFilterKey:l,yFilterKey:c,sizeFilterKey:h,labelKey:d,xName:u,yName:p,sizeName:g,labelName:f,label:y,marker:v}=this.properties,{placement:x}=y,S=rs.anchor(v.shape),M=e.x,D=e.y;if(!(t&&i&&n&&M&&D))return;const A=t.resolveColumnById(this,"xValue",i),w=t.resolveColumnById(this,"yValue",i),T=o!=null?t.resolveColumnById(this,"sizeValue",i):void 0,k=d!=null?t.resolveColumnById(this,"labelValue",i):void 0,N=l!=null?t.resolveColumnById(this,"xFilterValue",i):void 0,O=c!=null?t.resolveColumnById(this,"yFilterValue",i):void 0,L=h!=null?t.resolveColumnById(this,"sizeFilterValue",i):void 0,F=M.scale,B=D.scale,_=((U=F.bandwidth)!=null?U:0)/2,G=(($=B.bandwidth)!=null?$:0)/2,V=[];s.range=[v.size,v.maxSize];const j=y.getFont(),H=Rr.getMeasurer({font:j});return(W=i.dataSources.get(this.id))==null||W.forEach((Y,K)=>{const Q=A[K],Z=w[K],J=T==null?void 0:T[K],ae=F.convert(Q)+_,oe=B.convert(Z)+G;let le;N!=null&&O!=null&&(le=N[K]===Q&&O[K]===Z,L!=null&&le&&(le=L[K]===J));const de=this.getLabelText(y,{value:k!=null?k[K]:Z,datum:Y,xKey:a,yKey:r,sizeKey:o,labelKey:d,xName:u,yName:p,sizeName:g,labelName:f}),ue=H.measureText(String(de)),ie=J!=null?s.convert(J):v.size;V.push({series:this,itemId:r,yKey:r,xKey:a,datum:Y,datumIndex:K,xValue:Q,yValue:Z,sizeValue:J,point:{x:ae,y:oe,size:ie},midPoint:{x:ae,y:oe},label:b({text:de},ue),anchor:S,placement:x,selected:le})}),{itemId:r,nodeData:V,labelData:V,scales:this.calculateScaling(),visible:this.visible}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var e,t;return this.isLabelEnabled()?(t=(e=this.contextNodeData)==null?void 0:e.labelData)!=null?t:[]:[]}updateMarkerSelection(e){const{nodeData:t,markerSelection:i}=e;this.properties.marker.isDirty()&&(i.clear(),i.cleanup());const s=this.properties.marker.enabled?t:[];return i.update(s,void 0,n=>Zn([n.xValue,n.yValue,n.sizeValue,n.label.text]))}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i}=e,{xKey:s,yKey:n,sizeKey:a,labelKey:r,marker:o}=this.properties,l=Je(i&&this.properties.highlightStyle.item,o.getStyle());this.sizeScale.range=[o.size,o.maxSize];const c=this.getShapeFillBBox();t.each((h,d)=>{this.updateMarkerStyle(o,h,d.datum,d.point,{xKey:s,yKey:n,sizeKey:a,labelKey:r},i,l,c,{selected:d.selected})}),i||this.properties.marker.markClean()}updatePlacedLabelData(e){this.labelSelection.update(e.map(t=>E(b({},t.datum),{point:{x:t.x,y:t.y,size:t.datum.point.size}})),t=>{t.pointerEvents=1}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(e){const{label:t}=this.properties;e.labelSelection.each((i,s)=>{var n,a,r,o;i.text=s.label.text,i.fill=t.color,i.x=(a=(n=s.point)==null?void 0:n.x)!=null?a:0,i.y=(o=(r=s.point)==null?void 0:r.y)!=null?o:0,i.fontStyle=t.fontStyle,i.fontWeight=t.fontWeight,i.fontSize=t.fontSize,i.fontFamily=t.fontFamily,i.textAlign="left",i.textBaseline="top"})}getTooltipContent(e){var N,O;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{xKey:r,xName:o,yKey:l,yName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:p,title:g,tooltip:f,marker:y}=a,v=n.x,x=n.y;if(!i||!s||!v||!x)return;const S=(N=s.dataSources.get(this.id))==null?void 0:N[e],M=i.resolveColumnById(this,"xValue",s)[e],D=i.resolveColumnById(this,"yValue",s)[e],A=(O=this.contextNodeData)==null?void 0:O.nodeData[e];if(M==null||A==null)return;const w=[{label:o,fallbackLabel:r,value:v.formatDatum(M)},{label:c,fallbackLabel:l,value:x.formatDatum(D)}];if(h!=null){const L=i.resolveColumnById(this,"sizeValue",s)[e];w.push({label:d,fallbackLabel:h,value:String(L)})}const T=y.getStyle(),k=this.getMarkerStyle(y,S,{xKey:r,yKey:l,sizeKey:h,labelKey:u,highlighted:!0},!1,void 0,T);return this.formatTooltipWithContext(f,{title:g,symbol:this.legendItemSymbol(),data:w},b(b({seriesId:t,datum:S,title:l,xKey:r,xName:o,yKey:l,yName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:p},k),this.getModuleTooltipParams()))}legendItemSymbol(){return{marker:this.getMarkerStyle(this.properties.marker)}}getLegendData(){var r;const{id:e,ctx:{legendManager:t},visible:i}=this,{yKey:s,yName:n,title:a}=this.properties;return[{legendType:"category",id:e,itemId:s,seriesId:e,enabled:i&&t.getItemEnabled({seriesId:e,itemId:s}),label:{text:(r=a!=null?a:n)!=null?r:s},symbol:this.legendItemSymbol()}]}animateEmptyUpdateReady({markerSelection:e,labelSelection:t}){ID(this,this.ctx.animationManager,e),dt(this,"labels",this.ctx.animationManager,t)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Ge}getFormattedMarkerStyle(e){const{xKey:t,yKey:i,sizeKey:s,labelKey:n,marker:a}=this.properties;return this.getMarkerStyle(a,e,{xKey:t,yKey:i,sizeKey:s,labelKey:n},!1,e.point.size)}computeFocusBounds(e){return vf(this,e)}};Yv.className="BubbleSeries",Yv.type="bubble";var sF=b(b({title:z,domain:Ie(ne),maxSize:X,showInMiniChart:q,label:b({placement:ce("top","right","bottom","left")},bt),tooltip:nt},it),be(Vo,["enabled"])),hre=E(b(b({},sF),Jn),{type:ee(Oe("bubble")),xKey:ee(z),yKey:ee(z),sizeKey:ee(z),labelKey:z,xName:z,yName:z,sizeName:z,labelName:z}),dre={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bubble",moduleFactory:e=>new Yv(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,maxSize:30,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:$l,fillImageDefaults:wh,fillOpacity:.8,tooltip:{position:{_seriesOverrideType:"node"}},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}}}},nF={type:"series",name:"bubble",chartType:"cartesian",options:hre,create:e=>new Yv(e)},hi=class extends _o{constructor(){super(...arguments),this.fillGradientDefaults=new wa,this.fillPatternDefaults=new Wt,this.fillImageDefaults=new In,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.areaPlot=!1,this.aggregation="sum",this.shadow=new sr,this.label=new as,this.tooltip=new Ys}};I([P],hi.prototype,"xKey",2),I([P],hi.prototype,"yKey",2),I([P],hi.prototype,"xName",2),I([P],hi.prototype,"yName",2),I([P],hi.prototype,"fill",2),I([P],hi.prototype,"fillGradientDefaults",2),I([P],hi.prototype,"fillPatternDefaults",2),I([P],hi.prototype,"fillImageDefaults",2),I([P],hi.prototype,"fillOpacity",2),I([P],hi.prototype,"stroke",2),I([P],hi.prototype,"strokeWidth",2),I([P],hi.prototype,"strokeOpacity",2),I([P],hi.prototype,"lineDash",2),I([P],hi.prototype,"lineDashOffset",2),I([P],hi.prototype,"cornerRadius",2),I([P],hi.prototype,"areaPlot",2),I([P],hi.prototype,"bins",2),I([P],hi.prototype,"aggregation",2),I([P],hi.prototype,"binCount",2),I([P],hi.prototype,"shadow",2),I([P],hi.prototype,"label",2),I([P],hi.prototype,"tooltip",2);var aF=10,Xv=class extends Xl{constructor(e){super({moduleCtx:e,directionKeys:Ah,directionNames:Ih,categoryKey:void 0,pickModes:[1,0],datumSelectionGarbageCollection:!1,animationResetFns:{datum:Df,label:Fo}}),this.properties=new hi,this.calculatedBins=[]}deriveBins(e){const t=Og(e[0],e[1],aF).ticks,i=Fg(e[0],e[1],aF),[s]=t,n=a=>[a,a+i];return[[s-i,s],...t.map(n)]}calculateNiceBins(e,t){const i=Math.floor(e[0]),s=e[1],n=t||1,{start:a,binSize:r}=this.calculateNiceStart(i,s,n);return this.getBins(a,s,r,n)}getBins(e,t,i,s){const n=[],a=this.calculatePrecision(i);for(let r=0;r<s;r++){const o=Math.round((e+r*i)*a)/a;let l=Math.round((e+(r+1)*i)*a)/a;r===s-1&&(l=Math.max(l,t)),n[r]=[o,l]}return n}calculatePrecision(e){let t=10;if(isFinite(e)&&e>0)for(;e<1;)t*=10,e*=10;return t}calculateNiceStart(e,t,i){const s=Math.abs(t-e)/i,n=Math.floor(Math.log10(s)),a=Math.pow(10,n);return{start:Math.floor(e/a)*a,binSize:s}}async processData(e){var d,u;this.visible||(this.processedData=void 0,this.animationState.transition("updateData"));const{xKey:t,yKey:i,areaPlot:s,aggregation:n}=this.properties,a=(d=this.axes.x)==null?void 0:d.scale,r=(u=this.axes.y)==null?void 0:u.scale,{xScaleType:o,yScaleType:l}=this.getScaleInformation({yScale:r,xScale:a}),c=[er(t,o),Z1];if(i){let p=QM("groupAgg");n==="count"||(n==="sum"?p=_1("groupAgg"):n==="mean"&&(p=G1("groupAgg"))),s&&(p=JM("groupAgg",p)),c.push(et(i,l,{invalidValue:void 0}),p)}else{c.push(U1("count"));let p=QM("groupAgg");s&&(p=JM("groupAgg",p)),c.push(p)}const h=p=>{var v;const g=wn(p.domain.keys[0]);if(g.length===0)return p.domain.groups=[],()=>[];const f=ki(this.properties.binCount)?this.calculateNiceBins(g,this.properties.binCount):(v=this.properties.bins)!=null?v:this.deriveBins(g),y=f.length;return this.calculatedBins=[...f],x=>{let S=x[0];if(Mr(S)&&(S=S.getTime()),!ki(S))return[];for(let M=0;M<y;M++){const D=f[M];if(S>=D[0]&&S<D[1]||M===y-1&&S<=D[1])return D}return[]}};!this.ctx.animationManager.isSkipped()&&this.processedData&&c.push(Du(this.id,this.processedData,!1)),await this.requestDataModel(e,this.data,{props:c,groupByFn:h}),this.animationState.transition("updateData")}xCoordinateRange(){return[NaN,NaN]}yCoordinateRange(){return[NaN,NaN]}getSeriesDomain(e){var r,o,l,c;const{processedData:t,dataModel:i}=this;if(!t||!i||!this.calculatedBins.length)return[];const s=i.getDomain(this,"groupAgg","aggregate",t),n=(r=this.calculatedBins)==null?void 0:r[0][0],a=(c=this.calculatedBins)==null?void 0:c[((l=(o=this.calculatedBins)==null?void 0:o.length)!=null?l:0)-1][1];return wn(e==="x"?[n,a]:s)}getSeriesRange(e,[t,i]){const{dataModel:s,processedData:n}=this;if(!s||(n==null?void 0:n.type)!=="grouped")return[NaN,NaN];const a=this.axes.x.scale,r=0;let o=-1/0;return n.groups.forEach(({keys:l,aggregation:c})=>{const[[h,d]=[0,0]]=c,[u,p]=l,[g,f]=ss([a.convert(u),a.convert(p)]);if(f>=t&&g<=i){const y=h+d;o=Math.max(o,y)}}),r>o?[NaN,NaN]:[r,o]}frequency(e){return e.datumIndices.reduce((t,i)=>t+i.length,0)}createNodeData(){var f;const{id:e,axes:t,processedData:i,dataModel:s}=this,n=t.x,a=t.y;if(!n||!a||!s)return;const{scale:r}=n,{scale:o}=a,{xKey:l,yKey:c,xName:h,yName:d}=this.properties,u=this.properties.label.formatter,p=[],g={itemId:(f=this.properties.yKey)!=null?f:this.id,nodeData:p,labelData:p,scales:this.calculateScaling(),animationValid:!0,visible:this.visible};return!this.visible||i==null||i.type!=="grouped"||(i.groups.forEach((y,v)=>{var Y;const{keys:x,aggregation:S}=y,[[M,D]=[0,0]]=S,A=this.frequency(y),w=x,[T,k]=w,N=[...s.forEachDatum(this,i,y)],O=r.convert(T),L=r.convert(k),F=M+D,B=o.convert(0),_=o.convert(F),G=Math.abs(L-O),V=Math.abs(_-B),j=Math.min(O,L),H=Math.min(B,_);let U;F!==0&&(U={x:j+G/2,y:H+V/2,text:(Y=this.cachedDatumCallback(Zn(v,"label"),()=>u==null?void 0:u({value:F,datum:N,seriesId:e,xKey:l,yKey:c,xName:h,yName:d})))!=null?Y:a.formatDatum(F)});const $={x:j+G/2,y:H+V/2},W=a.isReversed();p.push({series:this,datumIndex:v,datum:N,aggregatedValue:F,frequency:A,domain:w,yKey:c,xKey:l,x:j,y:H,xValue:O,yValue:_,width:G,height:V,midPoint:$,topLeftCornerRadius:!W,topRightCornerRadius:!W,bottomRightCornerRadius:W,bottomLeftCornerRadius:W,label:U,crisp:!0})}),p.sort((y,v)=>y.x-v.x)),g}nodeFactory(){return new $s}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e;return i.update(t,void 0,s=>s.domain.join("_"))}getItemBaseStyle(e){var s,n,a,r,o,l,c;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return Br({fill:(s=i==null?void 0:i.fill)!=null?s:t.fill,fillOpacity:(n=i==null?void 0:i.fillOpacity)!=null?n:t.fillOpacity,stroke:(a=i==null?void 0:i.stroke)!=null?a:t.stroke,strokeWidth:(r=i==null?void 0:i.strokeWidth)!=null?r:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(o=i==null?void 0:i.strokeOpacity)!=null?o:t.strokeOpacity,lineDash:(l=i==null?void 0:i.lineDash)!=null?l:t.lineDash,lineDashOffset:(c=i==null?void 0:i.lineDashOffset)!=null?c:t.lineDashOffset,cornerRadius:t.cornerRadius},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}updateDatumNodes(e){const{isHighlight:t}=e,{shadow:i}=this.properties,s=this.getItemBaseStyle(t),n=this.getShapeFillBBox();e.datumSelection.each((a,r)=>{const{cornerRadius:o}=s,{topLeftCornerRadius:l,topRightCornerRadius:c,bottomRightCornerRadius:h,bottomLeftCornerRadius:d}=r;xh(a,s,void 0,n),a.topLeftCornerRadius=l?o:0,a.topRightCornerRadius=c?o:0,a.bottomRightCornerRadius=h?o:0,a.bottomLeftCornerRadius=d?o:0,a.crisp=r.crisp,a.fillShadow=i,a.visible=r.height>0})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,s=>{s.pointerEvents=1,s.textAlign="center",s.textBaseline="middle"})}updateLabelNodes(e){const{fontStyle:t,fontWeight:i,fontFamily:s,fontSize:n,color:a}=this.properties.label,r=this.isLabelEnabled();e.labelSelection.each((o,l)=>{r&&(l!=null&&l.label)?(o.text=l.label.text,o.x=l.label.x,o.y=l.label.y,o.fontStyle=t,o.fontWeight=i,o.fontFamily=s,o.fontSize=n,o.fill=a,o.visible=!0):o.visible=!1})}initQuadTree(e){const{value:t}=this.contentGroup.children().next();t&&OD(e,t.children())}pickNodeClosestDatum(e){return FD(this,e)}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:a,ctx:{localeManager:r}}=this,{xKey:o,xName:l,yKey:c,yName:h,tooltip:d}=a,u=n.x,p=n.y;if(!i||(s==null?void 0:s.type)!=="grouped"||!u||!p)return;const g=s.groups[e],{aggregation:f,keys:y}=g,[[v,x]=[0,0]]=f,S=this.frequency(g),M=y,[D,A]=M,w=v+x,T={data:[...i.forEachDatum(this,s,g)],aggregatedValue:w,frequency:S,domain:M},k=[{label:l,fallbackLabel:o,value:`${u.formatDatum(D)} - ${u.formatDatum(A)}`},{label:r.t("seriesHistogramTooltipFrequency"),value:p.formatDatum(S)}];if(c!=null){let N;switch(a.aggregation){case"sum":N=r.t("seriesHistogramTooltipSum",{yName:h!=null?h:c});break;case"mean":N=r.t("seriesHistogramTooltipMean",{yName:h!=null?h:c});break;case"count":N=r.t("seriesHistogramTooltipCount",{yName:h!=null?h:c});break}k.push({label:N,value:p.formatDatum(w)})}return this.formatTooltipWithContext(d,{symbol:this.legendItemSymbol(),data:k},b({seriesId:t,datum:T,title:h,xKey:o,xName:l,yKey:c,yName:h,xRange:[D,A],frequency:S},this.getItemBaseStyle(!1)))}legendItemSymbol(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,fillGradientDefaults:o,fillPatternDefaults:l,fillImageDefaults:c}=this.properties;return{marker:Br({fill:e!=null?e:"rgba(0, 0, 0, 0)",stroke:i!=null?i:"rgba(0, 0, 0, 0)",fillOpacity:t,strokeOpacity:n,strokeWidth:s,lineDash:a,lineDashOffset:r},o,l,c)}}getLegendData(e){var o;if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{xKey:n,yName:a,showInLegend:r}=this.properties;return[{legendType:"category",id:t,itemId:n,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:(o=a!=null?a:n)!=null?o:"Frequency"},symbol:this.legendItemSymbol(),hideInLegend:!r}]}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){const i=Mf(Sf(!0,this.axes,"normal"));Qt(this.id,"datums",this.ctx.animationManager,[e],i),dt(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(e){const t=Mf(Sf(!0,this.axes,"normal")),i=VD(this.id,e.datumSelection,s=>Zn(s.domain),e.contextData,e.previousContextData,this.processedData);Qt(this.id,"datums",this.ctx.animationManager,[e.datumSelection],t,(s,n)=>Zn(n.domain),i),i!=null&&i.changed&&dt(this,"labels",this.ctx.animationManager,e.labelSelection)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){var t;return zD(this,(t=this.contextNodeData)==null?void 0:t.nodeData[e])}};Xv.className="HistogramSeries",Xv.type="histogram";var rF=b(b(b(b({showInMiniChart:q,cornerRadius:X,label:bt,tooltip:nt,shadow:Vr},it),xe),ge),De),ure=E(b(b({},rF),Jn),{type:ee(Oe("histogram")),xKey:ee(z),yKey:z,xName:z,yName:z,areaPlot:q,aggregation:ce("count","sum","mean"),bins:Ie(Ie(ne)),binCount:X}),pre={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"histogram",moduleFactory:e=>new Xv(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:$l,fillImageDefaults:wh,strokeWidth:1,fillOpacity:1,strokeOpacity:1,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},shadow:{enabled:!1,color:Wl,xOffset:3,yOffset:3,blur:5}}}},oF={type:"series",name:"histogram",chartType:"cartesian",enterprise:!0,options:ure,create:e=>new Xv(e)},Ki=class extends _o{constructor(){super(...arguments),this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new Pu,this.marker=new os,this.label=new as,this.tooltip=new Ys,this.connectMissingData=!1,this.sparklineMode=!1}};I([P],Ki.prototype,"xKey",2),I([P],Ki.prototype,"yKey",2),I([P],Ki.prototype,"xName",2),I([P],Ki.prototype,"yName",2),I([P],Ki.prototype,"yFilterKey",2),I([P],Ki.prototype,"stackGroup",2),I([P],Ki.prototype,"normalizedTo",2),I([P],Ki.prototype,"title",2),I([P],Ki.prototype,"stroke",2),I([P],Ki.prototype,"strokeWidth",2),I([P],Ki.prototype,"strokeOpacity",2),I([P],Ki.prototype,"lineDash",2),I([P],Ki.prototype,"lineDashOffset",2),I([P],Ki.prototype,"interpolation",2),I([P],Ki.prototype,"marker",2),I([P],Ki.prototype,"label",2),I([P],Ki.prototype,"tooltip",2),I([P],Ki.prototype,"connectMissingData",2),I([P],Ki.prototype,"sparklineMode",2);var gre=.25,If=class extends Xl{constructor(e){super({moduleCtx:e,directionKeys:Ah,directionNames:Ih,categoryKey:"xValue",hasMarkers:!0,pickModes:[2,1,0],markerSelectionGarbageCollection:!1,animationResetFns:{path:LD({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:Fo,marker:(t,i)=>b(b({},mf(t)),yf(t,i))},clipFocusBox:!1}),this.properties=new Ki,this.dataAggregationFilters=void 0}get pickModeAxis(){return this.properties.sparklineMode?"main":"main-category"}async processData(e){var D,A;if(this.data==null)return;const{data:t,visible:i,seriesGrouping:{groupIndex:s=this.id,stackCount:n=0}={}}=this,{xKey:a,yKey:r,yFilterKey:o,connectMissingData:l,normalizedTo:c}=this.properties,h=!this.ctx.animationManager.isSkipped(),d=(D=this.axes.x)==null?void 0:D.scale,u=(A=this.axes.y)==null?void 0:A.scale,{isContinuousX:p,xScaleType:g,yScaleType:f}=this.getScaleInformation({xScale:d,yScale:u}),y=n>=1||c!=null,v={invalidValue:null};l&&y&&(v.invalidValue=0),y&&!i&&(v.forceValue=0);const x=[];if((!p||y)&&x.push(er(a,g,{id:"xKey"})),x.push(et(a,g,{id:"xValue"}),et(r,f,E(b({id:"yValueRaw"},v),{invalidValue:void 0}))),o!=null&&x.push(et(o,f,{id:"yFilterRaw"})),y){const w=[`line-stack-${s}-yValues`,`line-stack-${s}-yValues-trailing`,`line-stack-${s}-yValues-marker`];x.push(...zl(r,"window","current",E(b({id:"yValueEnd"},v),{groupId:w[0]}),f),...zl(r,"window-trailing","current",E(b({id:"yValueStart"},v),{groupId:w[1]}),f),...zl(r,"normal","current",E(b({id:"yValueCumulative"},v),{groupId:w[2]}),f)),ni(c)&&x.push(gv([w[0],w[1],w[2]],c))}h&&(x.push(Mu(p?["xValue"]:void 0)),this.processedData&&x.push(Du(this.id,this.processedData)));const{dataModel:S,processedData:M}=await this.requestDataModel(e,t,{props:x,groupByKeys:y,groupByData:!y});this.dataAggregationFilters=this.aggregateData(S,M),this.animationState.transition("updateData")}xCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.x.scale.convert(e),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}yCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.y.scale.convert(e[0]),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}getSeriesDomain(e){var a;const{dataModel:t,processedData:i}=this;if(!t||!i)return[];if(e==="x"){const r=t.resolveProcessedDataDefById(this,"xValue"),o=t.getDomain(this,"xValue","value",i);return(r==null?void 0:r.def.type)==="value"&&r.def.valueType==="category"?o:wn(Ro(o))}const s=(a=this.dataModel)!=null&&a.hasColumnById(this,"yValueEnd")?"yValueEnd":"yValueRaw",n=this.domainForClippedRange("y",[s],"xValue",!0);return wn(n)}getSeriesRange(e,t){var s;const i=(s=this.dataModel)!=null&&s.hasColumnById(this,"yValueEnd")?"yValueEnd":"yValueRaw";return this.domainForVisibleRange("y",[i],"xValue",t,!0)}getVisibleItems(e,t,i){var n;const s=(n=this.dataModel)!=null&&n.hasColumnById(this,"yValueEnd")?"yValueEnd":"yValueRaw";return this.countVisibleItems("xValue",[s],e,t,i)}aggregateData(e,t){}createNodeData(){var ae,oe,le,de,ue,ie,re;const{dataModel:e,processedData:t,axes:i,dataAggregationFilters:s}=this,n=i.x,a=i.y;if(!e||!t||!n||!a)return;const{xKey:r,yKey:o,yFilterKey:l,xName:c,yName:h,marker:d,label:u,connectMissingData:p,interpolation:g,legendItemName:f}=this.properties,y=(ae=this.dataModel)==null?void 0:ae.hasColumnById(this,"yValueEnd"),v=n.scale,x=a.scale,S=((oe=v.bandwidth)!=null?oe:0)/2,M=((le=x.bandwidth)!=null?le:0)/2,D=d.enabled?d.size:0,A=(de=t.dataSources.get(this.id))!=null?de:[],w=e.resolveColumnById(this,"xValue",t),T=e.resolveColumnById(this,"yValueRaw",t),k=y?e.resolveColumnById(this,"yValueEnd",t):void 0,N=y?e.resolveColumnById(this,"yValueCumulative",t):T,O=l!=null?e.resolveColumnById(this,"yFilterRaw",t):void 0,L=te=>v.convert(w[te])+S,F=te=>x.convert(N[te])+M,B={lengthRatioMultiplier:this.properties.marker.getDiameter(),lengthMax:1/0},_=[];let G;const V=te=>{const fe=A[te],me=w[te],Le=T[te],Ee=k==null?void 0:k[te],He=O==null?void 0:O[te],Ue=L(te),je=F(te);if(!Number.isFinite(Ue))return;if(Le!=null){const Fe=u.enabled?this.getLabelText(u,{value:Le,datum:fe,xKey:r,yKey:o,xName:c,yName:h,legendItemName:f}):void 0;_.push({series:this,datum:fe,datumIndex:te,yKey:o,xKey:r,point:{x:Ue,y:je,size:D},midPoint:{x:Ue,y:je},cumulativeValue:Ee,yValue:Le,xValue:me,capDefaults:B,labelText:Fe,selected:He})}if(G==null)return;const Te=G[G.length-1];if(Le!=null){const Fe={point:{x:Ue,y:je},xDatum:me,yDatum:Le};Array.isArray(Te)?Te.push(Fe):Te!=null?(Te.skip+=1,G.push([Fe])):G.push([Fe])}else p||(Array.isArray(Te)||Te==null?G.push({skip:0}):Te.skip+=1)},[j,H]=v.range,U=H-j,$=s==null?void 0:s.find(te=>te.maxRange>U),W=$==null?void 0:$.indices;let[Y,K]=this.visibleRange("xValue",n.range,W);Y=Math.max(Y-1,0),K=Math.min(K+1,(ue=W==null?void 0:W.length)!=null?ue:w.length),t.input.count<1e3&&(Y=0,K=t.input.count),W==null&&(G=[]);for(let te=Y;te<K;te+=1)V((ie=W==null?void 0:W[te])!=null?ie:te);const Q=G==null?void 0:G.flatMap(te=>Array.isArray(te)?Rv(te,g):[]),Z=Q!=null?{itemId:o,spans:Q}:void 0,J=(re=O==null?void 0:O.some((te,fe)=>te===T[fe]))!=null?re:!1;return{itemId:o,nodeData:_,labelData:_,strokeData:Z,scales:this.calculateScaling(),visible:this.visible,crossFiltering:J}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(e){var r;const{paths:[t],opacity:i,visible:s,animationEnabled:n}=e,a=((r=this.contextNodeData)==null?void 0:r.crossFiltering)===!0;t.setProperties({fill:void 0,lineJoin:"round",pointerEvents:1,opacity:i,stroke:this.properties.stroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.properties.strokeOpacity*(a?gre:1),lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset}),n||(t.visible=s),Bv(this,t)}getMarkerItemBaseStyle(e){var n,a,r,o,l,c,h;const{properties:t}=this,{marker:i}=t,s=e?t.highlightStyle.item:void 0;return Br({size:i.size,shape:i.shape,fill:(n=s==null?void 0:s.fill)!=null?n:i.fill,fillOpacity:(a=s==null?void 0:s.fillOpacity)!=null?a:i.fillOpacity,stroke:(r=s==null?void 0:s.stroke)!=null?r:i.stroke,strokeWidth:(o=s==null?void 0:s.strokeWidth)!=null?o:i.strokeWidth,strokeOpacity:(l=s==null?void 0:s.strokeOpacity)!=null?l:i.strokeOpacity,lineDash:(c=s==null?void 0:s.lineDash)!=null?c:i.lineDash,lineDashOffset:(h=s==null?void 0:s.lineDashOffset)!=null?h:i.lineDashOffset},i.fillGradientDefaults,i.fillPatternDefaults,i.fillImageDefaults)}getMarkerItemStyleOverrides(e,t,i,s){const{id:n,properties:a}=this,{xKey:r,yKey:o,marker:l}=a,{itemStyler:c}=l;if(c!=null)return this.cachedDatumCallback(Zn(e,s?"highlight":"node"),()=>{const h=this.getSeriesDomain("x"),d=this.getSeriesDomain("y");return this.callWithContext(c,b(E(b({seriesId:n},Ol(t,r,o,h,d)),{datum:t,highlighted:s}),i))})}updateMarkerSelection(e){var n;let{nodeData:t}=e;const{markerSelection:i}=e;return t=this.properties.marker.enabled||((n=this.contextNodeData)==null?void 0:n.crossFiltering)===!0?t:[],this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(t,void 0,a=>Zn(a.xValue))}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i}=e,{xKey:s,yKey:n,stroke:a,strokeWidth:r,strokeOpacity:o,marker:l,highlightStyle:c}=this.properties,h=this.getSeriesDomain("x"),d=this.getSeriesDomain("y"),u=Je(i&&c.item,l.getStyle(),{stroke:a,strokeWidth:r,strokeOpacity:o}),p=this.ctx.animationManager.isSkipped(),g=this.getShapeFillBBox();t.each((f,y)=>{this.updateMarkerStyle(l,f,y.datum,y.point,Ol(y,s,n,h,d),i,u,g,{applyTranslation:p,selected:y.selected})}),i||l.markClean()}updateLabelSelection(e){return e.labelSelection.update(this.isLabelEnabled()?e.labelData:[])}updateLabelNodes(e){const{enabled:t,fontStyle:i,fontWeight:s,fontSize:n,fontFamily:a,color:r}=this.properties.label;e.labelSelection.each((o,l)=>{t&&(l!=null&&l.labelText)?(o.fontStyle=i,o.fontWeight=s,o.fontSize=n,o.fontFamily=a,o.textAlign="center",o.textBaseline="bottom",o.text=l.labelText,o.x=l.point.x,o.y=l.point.y-10,o.fill=r,o.visible=!0):o.visible=!1})}getTooltipContent(e){var v;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{xKey:r,xName:o,yKey:l,yName:c,tooltip:h}=a,d=n.x,u=n.y;if(!i||!s||!d||!u)return;const p=(v=s.dataSources.get(this.id))==null?void 0:v[e],g=i.resolveColumnById(this,"xValue",s)[e],f=i.resolveColumnById(this,"yValueRaw",s)[e];if(g==null)return;const y=this.getMarkerItemBaseStyle(!1);return Object.assign(y,this.getMarkerItemStyleOverrides(String(e),p,y,!1)),this.formatTooltipWithContext(h,{heading:d.formatDatum(g),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:u.formatDatum(f)}]},b(b({seriesId:t,datum:p,title:c,xKey:r,xName:o,yKey:l,yName:c},y),this.getModuleTooltipParams()))}legendItemSymbol(){var o,l,c;const e="rgba(0, 0, 0, 0)",{stroke:t,strokeOpacity:i,strokeWidth:s,lineDash:n,marker:a}=this.properties,r=this.getMarkerStyle(a,void 0,void 0,!1,void 0,{fill:(o=a.fill)!=null?o:e,stroke:(c=(l=a.stroke)!=null?l:t)!=null?c:e});return{marker:E(b({},r),{enabled:a.enabled}),line:{stroke:t!=null?t:e,strokeOpacity:i,strokeWidth:s,lineDash:n}}}getLegendData(e){var c,h;if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{yKey:n,yName:a,title:r,legendItemName:o,showInLegend:l}=this.properties;return[{legendType:"category",id:t,itemId:n,legendItemName:o,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:(h=(c=o!=null?o:r)!=null?c:a)!=null?h:n},symbol:this.legendItemSymbol(),hideInLegend:!l}]}updatePaths(e){this.updateLinePaths(e.paths,e.contextData)}plotNodeDataPoints(e,t){if(t.length===0)return;const i=t[0].point;e.moveTo(i.x,i.y);for(let s=1;s<t.length;s+=1){const{x:n,y:a}=t[s].point;e.lineTo(n,a)}}updateLinePaths(e,t){var n;const i=(n=t.strokeData)==null?void 0:n.spans,[s]=e;s.path.clear(),i!=null?DD(s,i):this.plotNodeDataPoints(s.path,t.nodeData),s.markDirty("LineSeries")}animateEmptyUpdateReady(e){const{markerSelection:t,labelSelection:i,annotationSelections:s,contextData:n,paths:a}=e,{animationManager:r}=this.ctx;this.updateLinePaths(a,n),kD(this,r,...a),ns([t],yf),TD(this,r,t),dt(this,"labels",r,i),dt(this,"annotations",r,...s)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateLinePaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){var u,p,g;const{animationManager:t}=this.ctx,{markerSelection:i,labelSelection:s,annotationSelections:n,contextData:a,paths:r,previousContextData:o}=e,[l]=r;this.resetMarkerAnimation(e),this.resetLabelAnimation(e);const c=()=>{this.resetPathAnimation(e),this.updateLinePaths(r,a)},h=()=>{t.skipCurrentBatch(),c()};if(a==null||o==null){c(),ff(this,t,"added",i),Fv(this,"path_properties",t,"add",l),dt(this,"labels",t,s),dt(this,"annotations",t,...n);return}if(a.crossFiltering!==o.crossFiltering){h();return}const d=BO(a,o,(g=(p=(u=this.processedData)==null?void 0:u.reduced)==null?void 0:p.diff)==null?void 0:g[this.id]);if(d===void 0){h();return}else if(d.status==="no-op")return;Qt(this.id,"path_properties",t,[l],d.stroke.pathProperties),d.status==="added"?this.updateLinePaths(r,a):d.status==="removed"?this.updateLinePaths(r,o):kv(this.id,"path_update",t,[l],d.stroke.path),d.hasMotion&&(ff(this,t,void 0,i),dt(this,"labels",t,s),dt(this,"annotations",t,...n))}isLabelEnabled(){return this.properties.label.enabled}getBandScalePadding(){return{inner:1,outer:.1}}nodeFactory(){return new Ge}getFormattedMarkerStyle(e){const{xKey:t,yKey:i}=this.properties,s=this.getSeriesDomain("x"),n=this.getSeriesDomain("y");return this.getMarkerStyle(this.properties.marker,e.datum,Ol(e,t,i,s,n),!0)}computeFocusBounds(e){return vf(this,e)}};If.className="LineSeries",If.type="line";var WD=b(b(b({title:z,showInMiniChart:q,connectMissingData:q,interpolation:$v,label:bt,marker:Vo,tooltip:nt,errorBar:Cf},it),ge),De);WD.sparklineMode=Ce(q);var Zv=E(b(b({},WD),Jn),{type:Oe("line"),xKey:ee(z),yKey:ee(z),xName:z,yName:z,stacked:q,stackGroup:z,normalizedTo:ne,legendItemName:z,errorBar:Kv});Zv.pickOutsideVisibleMinorAxis=Ce(q),Zv.focusPriority=Ce(ne);var lF={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"line",moduleFactory:e=>new If(e),stackable:!0,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{tooltip:{position:{_seriesOverrideType:"node"}},stroke:Tv,strokeWidth:2,strokeOpacity:1,lineDash:[0],lineDashOffset:0,interpolation:{type:"linear"},marker:{shape:"circle",size:7,strokeWidth:0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:$l,fillImageDefaults:wh},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},errorBar:{cap:{lengthRatio:1}}}}},cF={type:"series",name:"line",chartType:"cartesian",options:Zv,create:e=>new If(e)},hF=class extends as{constructor(){super(...arguments),this.placement="top"}};I([P],hF.prototype,"placement",2);var Ut=class extends _o{constructor(){super(...arguments),this.label=new hF,this.tooltip=new Ys,this.marker=new os}};I([P],Ut.prototype,"xKey",2),I([P],Ut.prototype,"yKey",2),I([P],Ut.prototype,"labelKey",2),I([P],Ut.prototype,"xFilterKey",2),I([P],Ut.prototype,"yFilterKey",2),I([P],Ut.prototype,"xName",2),I([P],Ut.prototype,"yName",2),I([P],Ut.prototype,"labelName",2),I([P],Ut.prototype,"title",2),I([vt("marker.shape")],Ut.prototype,"shape",2),I([vt("marker.size")],Ut.prototype,"size",2),I([vt("marker.fill")],Ut.prototype,"fill",2),I([vt("marker.fillGradientDefaults")],Ut.prototype,"fillGradientDefaults",2),I([vt("marker.fillPatternDefaults")],Ut.prototype,"fillPatternDefaults",2),I([vt("marker.fillImageDefaults")],Ut.prototype,"fillImageDefaults",2),I([vt("marker.fillOpacity")],Ut.prototype,"fillOpacity",2),I([vt("marker.stroke")],Ut.prototype,"stroke",2),I([vt("marker.strokeWidth")],Ut.prototype,"strokeWidth",2),I([vt("marker.strokeOpacity")],Ut.prototype,"strokeOpacity",2),I([vt("marker.lineDash")],Ut.prototype,"lineDash",2),I([vt("marker.lineDashOffset")],Ut.prototype,"lineDashOffset",2),I([vt("marker.itemStyler")],Ut.prototype,"itemStyler",2),I([P],Ut.prototype,"label",2),I([P],Ut.prototype,"tooltip",2);var qv=class extends Xl{constructor(e){super({moduleCtx:e,directionKeys:Ah,directionNames:Ih,categoryKey:void 0,pickModes:[2,1,0],pathsPerSeries:[],hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{marker:mf,label:Fo},usesPlacedLabels:!0,clipFocusBox:!1}),this.properties=new Ut}get pickModeAxis(){return"main-category"}async processData(e){var h,d;if(this.data==null||!this.visible)return;const t=(h=this.axes.x)==null?void 0:h.scale,i=(d=this.axes.y)==null?void 0:d.scale,{xScaleType:s,yScaleType:n}=this.getScaleInformation({xScale:t,yScale:i}),{xKey:a,yKey:r,xFilterKey:o,yFilterKey:l,labelKey:c}=this.properties;await this.requestDataModel(e,this.data,{props:[et(a,s,{id:"xValue"}),et(r,n,{id:"yValue"}),...o!=null?[et(o,s,{id:"xFilterValue"})]:[],...l!=null?[et(l,n,{id:"yFilterValue"})]:[],...c?[et(c,"band",{id:"labelValue"})]:[]]}),this.animationState.transition("updateData")}xCoordinateRange(e,t){const i=this.axes.x.scale.convert(e),s=.5*this.properties.size*t;return[i-s,i+s]}yCoordinateRange(e,t){const i=this.axes.y.scale.convert(e[0]),s=.5*this.properties.size*t;return[i-s,i+s]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];const s={x:"xValue",y:"yValue"},n=s[e],a=t.resolveProcessedDataDefById(this,n),r=t.getDomain(this,n,"value",i);if((a==null?void 0:a.def.type)==="value"&&(a==null?void 0:a.def.valueType)==="category")return r;const l=s[e==="x"?"y":"x"],c=this.domainForClippedRange(e,[n],l,!1);return wn(Ro(c))}getSeriesRange(e,t){return this.domainForVisibleRange("y",["yValue"],"xValue",t,!1)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["yValue"],e,t,i)}createNodeData(){var _,G,V;const{axes:e,dataModel:t,processedData:i,visible:s}=this,{xKey:n,yKey:a,xFilterKey:r,yFilterKey:o,labelKey:l,xName:c,yName:h,labelName:d,marker:u,label:p}=this.properties,{placement:g}=p,f=rs.anchor(u.shape),y=e.x,v=e.y;if(!(t&&i&&s&&y&&v))return;const x=t.resolveColumnById(this,"xValue",i),S=t.resolveColumnById(this,"yValue",i),M=l!=null?t.resolveColumnById(this,"labelValue",i):void 0,D=r!=null?t.resolveColumnById(this,"xFilterValue",i):void 0,A=o!=null?t.resolveColumnById(this,"yFilterValue",i):void 0,w=y.scale,T=v.scale,k=((_=w.bandwidth)!=null?_:0)/2,N=((G=T.bandwidth)!=null?G:0)/2,O=[],L=p.getFont(),F=Rr.getMeasurer({font:L});return((V=i.dataSources.get(this.id))!=null?V:[]).forEach((j,H)=>{const U=x[H],$=S[H],W=w.convert(U)+k,Y=T.convert($)+N,K=D!=null&&A!=null?D[H]===U&&A[H]===$:void 0,Q=this.getLabelText(p,{value:M!=null?M==null?void 0:M[H]:$,datum:j,xKey:n,yKey:a,labelKey:l,xName:c,yName:h,labelName:d}),Z=F.measureText(Q);O.push({series:this,itemId:a,yKey:a,xKey:n,datum:j,datumIndex:H,xValue:U,yValue:$,capDefaults:{lengthRatioMultiplier:u.getDiameter(),lengthMax:1/0},point:{x:W,y:Y,size:u.size},midPoint:{x:W,y:Y},label:b({text:Q},Z),anchor:f,placement:g,selected:K})}),{itemId:a,nodeData:O,labelData:O,scales:this.calculateScaling(),visible:this.visible}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var e,t;return this.isLabelEnabled()?(t=(e=this.contextNodeData)==null?void 0:e.labelData)!=null?t:[]:[]}updateMarkerSelection(e){const{nodeData:t,markerSelection:i}=e;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?t:[])}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i}=e,{xKey:s,yKey:n,labelKey:a,marker:r,highlightStyle:o}=this.properties,l=Je(i&&o.item,r.getStyle()),c=this.getShapeFillBBox();t.each((h,d)=>{this.updateMarkerStyle(r,h,d.datum,d.point,{xKey:s,yKey:n,labelKey:a},i,l,c,{selected:d.selected})}),i||r.markClean()}updatePlacedLabelData(e){this.labelSelection.update(e.map(t=>E(b({},t.datum),{point:{x:t.x,y:t.y,size:t.datum.point.size}})),t=>{t.pointerEvents=1}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(e){const{label:t}=this.properties;e.labelSelection.each((i,s)=>{var n,a,r,o;i.text=s.label.text,i.fill=t.color,i.x=(a=(n=s.point)==null?void 0:n.x)!=null?a:0,i.y=(o=(r=s.point)==null?void 0:r.y)!=null?o:0,i.fontStyle=t.fontStyle,i.fontWeight=t.fontWeight,i.fontSize=t.fontSize,i.fontFamily=t.fontFamily,i.textAlign="left",i.textBaseline="top"})}getTooltipContent(e){var A,w;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{xKey:r,xName:o,yKey:l,yName:c,labelKey:h,labelName:d,title:u,tooltip:p,marker:g}=a,f=n.x,y=n.y;if(!i||!s||!f||!y)return;const v=(A=s.dataSources.get(this.id))==null?void 0:A[e],x=i.resolveColumnById(this,"xValue",s)[e],S=i.resolveColumnById(this,"yValue",s)[e],M=(w=this.contextNodeData)==null?void 0:w.nodeData[e];if(x==null||M==null)return;const D=this.getMarkerStyle(g,M.datum,{xKey:r,yKey:l,labelKey:h,highlighted:!0});return this.formatTooltipWithContext(p,{symbol:this.legendItemSymbol(),title:u,data:[{label:o,fallbackLabel:r,value:f.formatDatum(x)},{label:c,fallbackLabel:l,value:y.formatDatum(S)}]},b(b({seriesId:t,datum:v,title:c,xKey:r,xName:o,yKey:l,yName:c,labelKey:h,labelName:d},D),this.getModuleTooltipParams()))}legendItemSymbol(){return{marker:this.getMarkerStyle(this.properties.marker)}}getLegendData(e){var l;if(e!=="category")return[];const{yKey:t,yName:i,title:s,showInLegend:n}=this.properties,{id:a,ctx:{legendManager:r},visible:o}=this;return[{legendType:"category",id:a,itemId:t,seriesId:a,enabled:o&&r.getItemEnabled({seriesId:a,itemId:t}),label:{text:(l=s!=null?s:i)!=null?l:t},symbol:this.legendItemSymbol(),hideInLegend:!n}]}animateEmptyUpdateReady(e){const{markerSelection:t,labelSelection:i,annotationSelections:s}=e;ID(this,this.ctx.animationManager,t),dt(this,"labels",this.ctx.animationManager,i),dt(this,"annotations",this.ctx.animationManager,...s)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Ge}getFormattedMarkerStyle(e){const{xKey:t,yKey:i,labelKey:s}=this.properties;return this.getMarkerStyle(this.properties.marker,e.datum,{xKey:t,yKey:i,labelKey:s},!0)}computeFocusBounds(e){return vf(this,e)}};qv.className="ScatterSeries",qv.type="scatter";var dF=b(b({title:z,showInMiniChart:q,label:b({placement:ce("top","right","bottom","left")},bt),tooltip:nt,errorBar:Cf},it),be(Vo,["enabled"])),fre=E(b(b({},dF),Jn),{type:ee(Oe("scatter")),xKey:ee(z),yKey:ee(z),labelKey:z,xName:z,yName:z,labelName:z,errorBar:Kv}),mre={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"scatter",moduleFactory:e=>new qv(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:$l,fillImageDefaults:wh,fillOpacity:.8,tooltip:{position:{_seriesOverrideType:"node"}},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},errorBar:{cap:{lengthRatio:1}}}}},uF={type:"series",name:"scatter",chartType:"cartesian",options:fre,create:e=>new qv(e)},pF=class GT{constructor(t,i,s,n){this.startAngle=t,this.endAngle=i,this.innerRadius=s,this.outerRadius=n}clone(){const{startAngle:t,endAngle:i,innerRadius:s,outerRadius:n}=this;return new GT(t,i,s,n)}equals(t){return this.startAngle===t.startAngle&&this.endAngle===t.endAngle&&this.innerRadius===t.innerRadius&&this.outerRadius===t.outerRadius}[Sy](t,i){return new GT(this.startAngle*(1-i)+t.startAngle*i,this.endAngle*(1-i)+t.endAngle*i,this.innerRadius*(1-i)+t.innerRadius*i,this.outerRadius*(1-i)+t.outerRadius*i)}};function gF({startAngle:e,endAngle:t,innerRadius:i,outerRadius:s}){let n=1/0,a=1/0,r=-1/0,o=-1/0;const l=(c,h)=>{n=Math.min(c,n),a=Math.min(h,a),r=Math.max(c,r),o=Math.max(h,o)};return l(i*Math.cos(e),i*Math.sin(e)),l(i*Math.cos(t),i*Math.sin(t)),l(s*Math.cos(e),s*Math.sin(e)),l(s*Math.cos(t),s*Math.sin(t)),Ll(0,e,t)&&l(s,0),Ll(Math.PI*.5,e,t)&&l(0,s),Ll(Math.PI,e,t)&&l(-s,0),Ll(Math.PI*1.5,e,t)&&l(0,-s),new ve(n,a,r-n,o-a)}function Qv(e,t,i){const s=Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),{innerRadius:n,outerRadius:a}=i;if(i.startAngle===i.endAngle||s<Math.min(n,a)||s>Math.max(n,a))return!1;const r=mg(i.startAngle),o=mg(i.endAngle),l=Math.atan2(t,e);return r<o?l<=o&&l>=r:l<=o&&l>=-Math.PI||l>=r&&l<=Math.PI}function fF(e,t){const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:a}=t,r={x:a*Math.cos(i),y:a*Math.sin(i)},o={x:a*Math.cos(s),y:a*Math.sin(s)},l=n===0?{x:0,y:0}:{x:n*Math.cos(i),y:n*Math.sin(i)},c=n===0?{x:0,y:0}:{x:n*Math.cos(s),y:n*Math.sin(s)};return Qd(e.start.x,e.start.y,e.end.x,e.end.y,r.x,r.y,l.x,l.y)||Qd(e.start.x,e.start.y,e.end.x,e.end.y,o.x,o.y,c.x,c.y)||qE(0,0,a,i,s,!0,e.start.x,e.start.y,e.end.x,e.end.y)}function mF(e,t){const i={x:e.x,y:e.y},s={x:e.x+e.width,y:e.y},n={x:e.x,y:e.y+e.height},a={x:e.x+e.width,y:e.y+e.height};return fF({start:i,end:s},t)||fF({start:n,end:a},t)}function yF(e,t,i,s){if(i===0&&s===0)return 0;if(Math.asin(Math.abs(1*i)/(e+1*i))+Math.asin(Math.abs(1*s)/(e+1*s))-t<0)return 1;let a=0,r=1;for(let o=0;o<8;o+=1){const l=(a+r)/2;Math.asin(Math.abs(l*i)/(e+l*i))+Math.asin(Math.abs(l*s)/(e+l*s))-t<0?a=l:r=l}return a}var yre=1e-6;function tc(e,t){return Ty(e,t)<yre?t:bi(e-t)+t}function Jv(e,t,i=0){const n=Math.abs(t-e)>=2*Math.PI?2*Math.PI:bi(t-e);return e=tc(e,i),t=e+n,{startAngle:e,endAngle:t}}function eb(e,t,i,s,n,a){const r=Math.sin(a),o=Math.cos(a),l=e**2+t**2-i**2;let c,h,d,u;if(o>.5){const S=r/o,M=1+S**2,D=-2*(e+t*S),A=D**2-4*M*l;if(A<0)return;const w=(-D+Math.sqrt(A))/(2*M),T=(-D-Math.sqrt(A))/(2*M);c=w,h=w*S,d=T,u=T*S}else{const S=o/r,M=1+S**2,D=-2*(t+e*S),A=D**2-4*M*l;if(A<0)return;const w=(-D+Math.sqrt(A))/(2*M),T=(-D-Math.sqrt(A))/(2*M);c=w*S,h=w,d=T*S,u=T}const p=o,g=r,f=c*p+h*g,y=d*p+u*g,v=f>0?tc(Math.atan2(h-t,c-e),s):NaN,x=y>0?tc(Math.atan2(u-t,d-e),s):NaN;if(v>=s&&v<=n)return v;if(x>=s&&x<=n)return x}function tb(e,t,i,s,n,a){const r=Math.hypot(e,t),o=(r**2-i**2+a**2)/(2*r),l=r-o,c=Math.atan2(t,e),h=Math.acos(-l/i),d=tc(c+h,s),u=tc(c-h,s);if(d>=s&&d<=n)return d;if(u>=s&&u<=n)return u}var UD=class{constructor(e,t,i,s,n){this.cx=e,this.cy=t,this.r=i,this.a0=s,this.a1=n,this.a0>=this.a1&&(this.a0=NaN,this.a1=NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(e){return{x:this.cx+this.r*Math.cos(e),y:this.cy+this.r*Math.sin(e)}}clipStart(e){e==null||!this.isValid()||e<this.a0||(this.a0=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}clipEnd(e){e==null||!this.isValid()||e>this.a1||(this.a1=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}},gs=class extends gn{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(e){this.concentricEdgeInset=e,this.radialEdgeInset=e}set cornerRadius(e){this.startOuterCornerRadius=e,this.endOuterCornerRadius=e,this.startInnerCornerRadius=e,this.endInnerCornerRadius=e}computeBBox(){return gF(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset:e}=this;let{innerRadius:t,outerRadius:i}=this;return t=t>0?t+e:0,i=Math.max(i-e,0),{innerRadius:t,outerRadius:i}}normalizedClipSector(){const{clipSector:e}=this;if(e==null)return;const{startAngle:t,endAngle:i}=Jv(this.startAngle,this.endAngle),{innerRadius:s,outerRadius:n}=this.normalizedRadii(),a=Jv(e.startAngle,e.endAngle,t);return new pF(Math.max(t,a.startAngle),Math.min(i,a.endAngle),Math.max(s,e.innerRadius),Math.min(n,e.outerRadius))}getAngleOffset(e){return e>0?this.radialEdgeInset/e:0}arc(e,t,i,s,n,a,r,o){if(e<=0)return;const{startAngle:l,endAngle:c}=Jv(this.startAngle,this.endAngle),{innerRadius:h,outerRadius:d}=this.normalizedRadii(),u=this.normalizedClipSector();if(o&&h<=0)return;const p=o?this.getAngleOffset(h+e):this.getAngleOffset(d-e),g=r?l+p+t:c-p-t,f=o?h+e:d-e,y=f*Math.cos(g),v=f*Math.sin(g);if(u!=null&&(!r&&!(g>=l-1e-6&&g<=u.endAngle-1e-6)||r&&!(g>=u.startAngle+1e-6&&g<=c-1e-6)||o&&f<u.innerRadius-1e-6||!o&&f>u.outerRadius+1e-6))return;const x=new UD(y,v,e,i,s);if(u!=null){o?(x.clipStart(eb(y,v,e,i,s,u.endAngle)),x.clipEnd(eb(y,v,e,i,s,u.startAngle))):(x.clipStart(eb(y,v,e,i,s,u.startAngle)),x.clipEnd(eb(y,v,e,i,s,u.endAngle)));let w,T;if(r?(w=tb(y,v,e,i,s,u.innerRadius),T=tb(y,v,e,i,s,u.outerRadius)):(w=tb(y,v,e,i,s,u.outerRadius),T=tb(y,v,e,i,s,u.innerRadius)),x.clipStart(w),x.clipEnd(T),w!=null){const{x:k,y:N}=x.pointAt(w),O=tc(Math.atan2(N,k),l);r?a==null||a.clipStart(O):n.clipEnd(O)}if(T!=null){const{x:k,y:N}=x.pointAt(T),O=tc(Math.atan2(N,k),l);r?n.clipStart(O):a==null||a.clipEnd(O)}}if(u!=null){const{x:w,y:T}=x.pointAt((x.a0+x.a1)/2);if(!Qv(w,T,u))return}const{x:S,y:M}=x.pointAt(r===o?x.a0:x.a1),D=tc(Math.atan2(M,S),l),A=o?a:n;return r?A==null||A.clipStart(D):A==null||A.clipEnd(D),x}updatePath(){var ae,oe,le,de,ue;const{path:t,centerX:i,centerY:s,concentricEdgeInset:n,radialEdgeInset:a}=this;let{startOuterCornerRadius:r,endOuterCornerRadius:o,startInnerCornerRadius:l,endInnerCornerRadius:c}=this;const{startAngle:h,endAngle:d}=Jv(this.startAngle,this.endAngle),{innerRadius:u,outerRadius:p}=this.normalizedRadii(),g=this.normalizedClipSector(),f=d-h,y=f>=2*Math.PI-1e-6;if(t.clear(),u===0&&p===0||u>p)return;if(((ae=g==null?void 0:g.startAngle)!=null?ae:h)===((oe=g==null?void 0:g.endAngle)!=null?oe:d))return;if(y&&this.clipSector==null&&r===0&&o===0&&l===0&&c===0){t.moveTo(i+p*Math.cos(h),s+p*Math.sin(h)),t.arc(i,s,p,h,d),u>n&&(t.moveTo(i+u*Math.cos(d),s+u*Math.sin(d)),t.arc(i,s,u,d,h,!0)),t.closePath();return}else if(this.clipSector==null&&Math.abs(u-p)<1e-6){t.arc(i,s,p,h,d,!1),t.arc(i,s,p,d,h,!0),t.closePath();return}const v=this.getAngleOffset(u),x=this.getAngleOffset(p);if(f<2*x)return;const M=((le=g==null?void 0:g.innerRadius)!=null?le:u)>n,D=u<n||f<2*v,A=p-u,w=Math.max(r,l,o,c),T=w>0?Math.min(A/w,1):1;r*=T,o*=T,l*=T,c*=T;const k=yF(p,f-2*x,-r,-o);if(r*=k,o*=k,!D&&M){const ie=yF(u,f-2*v,l,c);l*=ie,c*=ie}else l=0,c=0;const N=Math.max(r+l,o+c),O=N>0?Math.min(A/N,1):1;r*=O,o*=O,l*=O,c*=O;let L=0,F=0;const B=r/(p-r),_=o/(p-o);if(B>=0&&B<1-1e-6)L=Math.asin(B);else{L=f/2;const ie=p/(1/Math.sin(L)+1);r=Math.min(ie,r)}if(_>=0&&_<1-1e-6)F=Math.asin(_);else{F=f/2;const ie=p/(1/Math.sin(F)+1);o=Math.min(ie,o)}const G=Math.asin(l/(u+l)),V=Math.asin(c/(u+c)),j=(de=g==null?void 0:g.outerRadius)!=null?de:p,H=this.getAngleOffset(j),U=new UD(0,0,j,h+H,d-H),$=(ue=g==null?void 0:g.innerRadius)!=null?ue:u,W=this.getAngleOffset($),Y=M?new UD(0,0,$,h+W,d-W):void 0;g!=null&&(U.clipStart(g.startAngle),U.clipEnd(g.endAngle),Y==null||Y.clipStart(g.startAngle),Y==null||Y.clipEnd(g.endAngle));const K=this.arc(r,L,h-Math.PI*.5,h+L,U,Y,!0,!1),Q=this.arc(o,F,d-F,d+Math.PI*.5,U,Y,!1,!1),Z=this.arc(c,V,d+Math.PI*.5,d+Math.PI-V,U,Y,!1,!0),J=this.arc(l,G,h+Math.PI+G,h+Math.PI*1.5,U,Y,!0,!0);if(D){const ie=f<Math.PI*.5?a*(1+Math.cos(f))/Math.sin(f):NaN;let re;ie>0&&ie<p?re=Math.max(Math.hypot(a,ie),u):re=a,re=Math.max(re,u);const te=h+f*.5;t.moveTo(i+re*Math.cos(te),s+re*Math.sin(te))}else if(!((J==null?void 0:J.isValid())===!0||(Y==null?void 0:Y.isValid())===!0)){const ie=h+f/2,re=u*Math.cos(ie),te=u*Math.sin(ie);t.moveTo(i+re,s+te)}if((K==null?void 0:K.isValid())===!0){const{cx:ie,cy:re,r:te,a0:fe,a1:me}=K;t.arc(i+ie,s+re,te,fe,me)}if(U.isValid()){const{r:ie,a0:re,a1:te}=U;t.arc(i,s,ie,re,te)}if((Q==null?void 0:Q.isValid())===!0){const{cx:ie,cy:re,r:te,a0:fe,a1:me}=Q;t.arc(i+ie,s+re,te,fe,me)}if(!D){if((Z==null?void 0:Z.isValid())===!0){const{cx:ie,cy:re,r:te,a0:fe,a1:me}=Z;t.arc(i+ie,s+re,te,fe,me)}if((Y==null?void 0:Y.isValid())===!0){const{r:ie,a0:re,a1:te}=Y;t.arc(i,s,ie,te,re,!0)}if((J==null?void 0:J.isValid())===!0){const{cx:ie,cy:re,r:te,a0:fe,a1:me}=J;t.arc(i+ie,s+re,te,fe,me)}}t.closePath()}isPointInPath(e,t){var r;const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:a}=(r=this.clipSector)!=null?r:this;return Qv(e-this.centerX,t-this.centerY,{startAngle:i,endAngle:s,innerRadius:Math.min(n,a),outerRadius:Math.max(n,a)})}};gs.className="Sector",I([he()],gs.prototype,"centerX",2),I([he()],gs.prototype,"centerY",2),I([he()],gs.prototype,"innerRadius",2),I([he()],gs.prototype,"outerRadius",2),I([he()],gs.prototype,"startAngle",2),I([he()],gs.prototype,"endAngle",2),I([$n({equals:(e,t)=>e.equals(t)})],gs.prototype,"clipSector",2),I([he()],gs.prototype,"concentricEdgeInset",2),I([he()],gs.prototype,"radialEdgeInset",2),I([he()],gs.prototype,"startOuterCornerRadius",2),I([he()],gs.prototype,"endOuterCornerRadius",2),I([he()],gs.prototype,"startInnerCornerRadius",2),I([he()],gs.prototype,"endInnerCornerRadius",2);var xi={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},jr={BLUE:"#2b5c95",ORANGE:"#cc6f10",GREEN:"#1e652e",CYAN:"#18859e",YELLOW:"#a69400",VIOLET:"#603c88",GRAY:"#575757",MAGENTA:"#7d2f6d",BROWN:"#4f3508",RED:"#a82529"},vF=class extends Ht{constructor(){super(...arguments),this.showInLegend=!1}};I([P],vF.prototype,"showInLegend",2);var KD=class extends as{constructor(){super(...arguments),this.spacing=2}set(e,t){return super.set(e)}};I([P],KD.prototype,"text",2),I([P],KD.prototype,"spacing",2);var $D=class extends Be{constructor(){super(...arguments),this.fill="transparent",this.fillOpacity=1}};I([P],$D.prototype,"fill",2),I([P],$D.prototype,"fillOpacity",2);var Eu=class extends as{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}};I([P],Eu.prototype,"offset",2),I([P],Eu.prototype,"minAngle",2),I([P],Eu.prototype,"minSpacing",2),I([P],Eu.prototype,"maxCollisionOffset",2),I([P],Eu.prototype,"avoidCollisions",2);var YD=class extends as{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}};I([P],YD.prototype,"positionOffset",2),I([P],YD.prototype,"positionRatio",2);var ib=class extends Be{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}};I([P],ib.prototype,"colors",2),I([P],ib.prototype,"length",2),I([P],ib.prototype,"strokeWidth",2);var Ze=class extends Qn{constructor(){super(...arguments),this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=Object.values(xi),this.strokes=Object.values(jr),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.hideZeroValueSectorsInLegend=!1,this.innerLabels=new vg(KD),this.title=new vF,this.innerCircle=new $D,this.shadow=new sr,this.calloutLabel=new Eu,this.sectorLabel=new YD,this.calloutLine=new ib,this.tooltip=new Ys}};I([P],Ze.prototype,"angleKey",2),I([P],Ze.prototype,"angleName",2),I([P],Ze.prototype,"angleFilterKey",2),I([P],Ze.prototype,"radiusKey",2),I([P],Ze.prototype,"radiusName",2),I([P],Ze.prototype,"radiusMin",2),I([P],Ze.prototype,"radiusMax",2),I([P],Ze.prototype,"calloutLabelKey",2),I([P],Ze.prototype,"calloutLabelName",2),I([P],Ze.prototype,"sectorLabelKey",2),I([P],Ze.prototype,"sectorLabelName",2),I([P],Ze.prototype,"legendItemKey",2),I([P],Ze.prototype,"defaultColorRange",2),I([P],Ze.prototype,"defaultPatternFills",2),I([P],Ze.prototype,"fills",2),I([P],Ze.prototype,"strokes",2),I([P],Ze.prototype,"fillOpacity",2),I([P],Ze.prototype,"strokeOpacity",2),I([P],Ze.prototype,"lineDash",2),I([P],Ze.prototype,"lineDashOffset",2),I([P],Ze.prototype,"cornerRadius",2),I([P],Ze.prototype,"itemStyler",2),I([P],Ze.prototype,"rotation",2),I([P],Ze.prototype,"outerRadiusOffset",2),I([P],Ze.prototype,"outerRadiusRatio",2),I([P],Ze.prototype,"innerRadiusOffset",2),I([P],Ze.prototype,"innerRadiusRatio",2),I([P],Ze.prototype,"strokeWidth",2),I([P],Ze.prototype,"sectorSpacing",2),I([P],Ze.prototype,"hideZeroValueSectorsInLegend",2),I([P],Ze.prototype,"innerLabels",2),I([P],Ze.prototype,"title",2),I([P],Ze.prototype,"innerCircle",2),I([P],Ze.prototype,"shadow",2),I([P],Ze.prototype,"calloutLabel",2),I([P],Ze.prototype,"sectorLabel",2),I([P],Ze.prototype,"calloutLine",2),I([P],Ze.prototype,"tooltip",2);function Eh(e,t,i,s){const n=[i.convert(0),i.convert(1)],a=[s.convert(0),s.convert(1)],r=Math.PI/-2+Vi(t),o=e?"initial":"update",l=({radius:g})=>({innerRadius:n[0],outerRadius:n[0]+(n[1]-n[0])*g}),c=({radius:g})=>({innerRadius:a[0],outerRadius:a[0]+(a[1]-a[0])*g});return{nodes:{toFn:(g,f,y,{prevLive:v})=>{var T,k;let{startAngle:x,endAngle:S,innerRadius:M,outerRadius:D}=f;const{stroke:A,fill:w}=f.sectorFormat;if(y==="removed"&&v?(x=(T=v.datum)==null?void 0:T.endAngle,S=(k=v.datum)==null?void 0:k.endAngle):y==="removed"&&!v&&(x=r,S=r),y==="removed"){const N=l(f);M=N.innerRadius,D=N.outerRadius}return{startAngle:x,endAngle:S,outerRadius:D,innerRadius:M,stroke:A,fill:w}},fromFn:(g,f,y,{prevFromProps:v})=>{var T,k,N,O,L,F;let{startAngle:x,endAngle:S,innerRadius:M,outerRadius:D}=g,{fill:A,stroke:w}=f.sectorFormat;if(y==="updated"&&g.previousDatum==null&&(y="added"),y==="unknown"||y==="added"&&!v?(x=r,S=r,M=f.innerRadius,D=f.outerRadius):y==="added"&&v&&(x=(T=v.endAngle)!=null?T:r,S=(k=v.endAngle)!=null?k:r,M=(N=v.innerRadius)!=null?N:f.innerRadius,D=(O=v.outerRadius)!=null?O:f.outerRadius),y==="added"&&!e){const B=c(f);M=B.innerRadius,D=B.outerRadius}return y==="updated"&&(A=(L=g.fill)!=null?L:A,w=(F=typeof g.stroke=="string"?g.stroke:void 0)!=null?F:w),{startAngle:x,endAngle:S,innerRadius:M,outerRadius:D,fill:A,stroke:w,phase:o}}},innerCircle:{fromFn:(g,f)=>{var y,v,x;return{size:(x=(v=(y=g.previousDatum)==null?void 0:y.radius)!=null?v:g.size)!=null?x:0,phase:o}},toFn:(g,f)=>{var y;return{size:(y=f.radius)!=null?y:0}}}}}function XD(e,t){return{startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,stroke:t.sectorFormat.stroke}}function ZD(e,t){const i=t.y-e.centerY,s=t.x-e.centerX,n=Math.atan2(i,s),a=e.getItemNodes();for(const r of a)if(r.datum.missing!==!0&&Ll(n,r.startAngle,r.endAngle)){const o=Math.sqrt(s*s+i*i);let l=0;return o<r.innerRadius?l=r.innerRadius-o:o>r.outerRadius&&(l=o-r.outerRadius),{datum:r.datum,distance:l}}}var bF=(e=>(e[e.BACKGROUND=0]="BACKGROUND",e[e.FOREGROUND=1]="FOREGROUND",e[e.HIGHLIGHT=2]="HIGHLIGHT",e[e.LABEL=3]="LABEL",e))(bF||{}),sb=class extends bD{constructor(r){var o=r,{categoryKey:e,useLabelLayer:t=!1,pickModes:i=[1,0],canHaveAxes:s=!1,animationResetFns:n}=o,a=We(o,["categoryKey","useLabelLayer","pickModes","canHaveAxes","animationResetFns"]);super(E(b({},a),{categoryKey:e,useLabelLayer:t,pickModes:i,directionKeys:{angle:["angleKey"],radius:["radiusKey"]},directionNames:{angle:["angleName"],radius:["radiusName"]},canHaveAxes:s})),this.directions=["angle","radius"],this.itemGroup=this.contentGroup.appendChild(new Ge),this.nodeData=[],this.itemSelection=Pi.select(this.itemGroup,()=>this.nodeFactory(),!1),this.labelSelection=Pi.select(this.labelGroup,()=>this.labelFactory(),!1),this.highlightSelection=Pi.select(this.highlightGroup,()=>this.nodeFactory()),this.highlightLabelSelection=Pi.select(this.highlightLabel,()=>this.labelFactory()),this.centerX=0,this.centerY=0,this.radius=0,this.animationResetFns=n,this.animationState=new Ng("empty",{empty:{update:{target:"ready",action:l=>this.animateEmptyUpdateReady(l)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:l=>this.animateReadyHighlight(l),highlightMarkers:l=>this.animateReadyHighlightMarkers(l),resize:l=>this.animateReadyResize(l),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:l=>this.animateWaitingUpdateReady(l)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:l=>this.animateClearingUpdateEmpty(l)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getItemNodes(){return[...this.itemGroup.children()]}getNodeData(){return this.nodeData}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[e,1],this.highlightGroup.zIndex=[e,2],this.labelGroup.zIndex=[e,3],!0):!1}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}labelFactory(){const e=new is;return e.pointerEvents=1,e}addChartEventListeners(){var e,t;this.destroyFns.push((e=this.ctx.chartEventManager)==null?void 0:e.addListener("legend-item-click",i=>this.onLegendItemClick(i)),(t=this.ctx.chartEventManager)==null?void 0:t.addListener("legend-item-double-click",i=>this.onLegendItemDoubleClick(i)))}getInnerRadius(){return 0}computeLabelsBBox(e,t){return null}getShapeFillBBox(){const e=this.radius;return{series:new ve(-e,-e,e*2,e*2),axis:new ve(-e,-e,e*2,e*2)}}resetAllAnimation(){var i;const{item:e,label:t}=(i=this.animationResetFns)!=null?i:{};this.ctx.animationManager.stopByAnimationGroupId(this.id),e&&ns([this.itemSelection,this.highlightSelection],e),t&&ns([this.labelSelection,this.highlightLabelSelection],t),this.itemSelection.cleanup(),this.labelSelection.cleanup(),this.highlightSelection.cleanup(),this.highlightLabelSelection.cleanup()}animateEmptyUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateWaitingUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateReadyHighlight(e){var s;const{item:t,label:i}=(s=this.animationResetFns)!=null?s:{};t&&ns([this.highlightSelection],t),i&&ns([this.highlightLabelSelection],i)}animateReadyHighlightMarkers(e){}animateReadyResize(e){this.resetAllAnimation()}animateClearingUpdateEmpty(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}computeFocusBounds(e){var i;const t=(i=this.getNodeData())==null?void 0:i[e.datumIndex];if(t!==void 0)return this.itemSelection.select(s=>s instanceof gn&&s.datum===t)[0]}getSeriesRange(e,t){return[NaN,NaN]}},vre=class extends zg{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey,this.calloutLabelKey=s.properties.calloutLabelKey,this.sectorLabelKey=s.properties.sectorLabelKey}},nb=class extends sb{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[1,0],useLabelLayer:!0,animationResetFns:{item:XD,label:Fo}}),this.properties=new Ze,this.phantomNodeData=void 0,this.backgroundGroup=new ds({name:`${this.id}-background`,zIndex:0}),this.noVisibleData=!1,this.previousRadiusScale=new tr,this.radiusScale=new tr,this.phantomGroup=this.backgroundGroup.appendChild(new Ge({name:"phantom"})),this.phantomSelection=Pi.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Ge({name:"pieCalloutLabels"})),this.calloutLabelSelection=new Pi(this.calloutLabelGroup,Ge),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Ge({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new rs({shape:"circle"})),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new rs({shape:"circle"})),this.innerLabelsGroup=this.contentGroup.appendChild(new Ge({name:"innerLabels"})),this.innerCircleGroup=this.backgroundGroup.appendChild(new Ge({name:`${this.id}-innerCircle`})),this.innerLabelsSelection=Pi.select(this.innerLabelsGroup,is),this.innerCircleSelection=Pi.select(this.innerCircleGroup,()=>new rs({shape:"circle"})),this.surroundingRadius=void 0,this.NodeEvent=vre,this.angleScale=new tr,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(t=>t+Math.PI/2),this.phantomGroup.opacity=.2}get calloutNodeData(){var e;return(e=this.phantomNodeData)!=null?e:this.nodeData}attachSeries(e,t,i){super.attachSeries(e,t,i),e==null||e.appendChild(this.backgroundGroup)}detachSeries(e,t,i){super.detachSeries(e,t,i),e==null||e.removeChild(this.backgroundGroup)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.backgroundGroup.zIndex=[0,e],!0):!1}nodeFactory(){return new gs}getSeriesDomain(e){return e==="angle"?this.angleScale.domain:this.radiusScale.domain}async processData(e){var y,v,x,S,M,D;if(this.data==null)return;const{visible:t,id:i,ctx:{legendManager:s}}=this,{angleKey:n,angleFilterKey:a,radiusKey:r,calloutLabelKey:o,sectorLabelKey:l,legendItemKey:c}=this.properties,h=()=>(A,w)=>t&&s.getItemEnabled({seriesId:i,itemId:w})?A:0,d=!this.ctx.animationManager.isSkipped(),u=[],p=[];c?u.push(er(c,"band",{id:"legendItemKey"})):o?u.push(er(o,"band",{id:"calloutLabelKey"})):l&&u.push(er(l,"band",{id:"sectorLabelKey"}));const g=this.radiusScale.type,f=this.angleScale.type;r&&p.push(eD(r,{id:"radiusValue",min:(y=this.properties.radiusMin)!=null?y:0,max:this.properties.radiusMax,missingValue:(v=this.properties.radiusMax)!=null?v:1,processor:h}),et(r,g,{id:"radiusRaw",processor:h}),Sh("radiusValue",[0,1],1,(x=this.properties.radiusMin)!=null?x:0,this.properties.radiusMax)),o&&p.push(et(o,"band",{id:"calloutLabelValue"})),l&&p.push(et(l,"band",{id:"sectorLabelValue"})),c&&p.push(et(c,"band",{id:"legendItemValue"})),a&&p.push($g(a,f,{id:"angleFilterValue",onlyPositive:!0,invalidValue:0,processor:h}),et(a,f,{id:"angleFilterRaw"}),Sh("angleFilterValue",[0,1],0,0)),d&&this.processedData&&u.length>0&&p.push(Du(this.id,this.processedData)),p.push(Mu()),await this.requestDataModel(e,this.data,{props:[...u,$g(n,f,{id:"angleValue",onlyPositive:!0,invalidValue:0,processor:h}),et(n,f,{id:"angleRaw"}),Sh("angleValue",[0,1],0,0),...p]});for(const A of(D=(M=(S=this.processedData)==null?void 0:S.defs)==null?void 0:M.values)!=null?D:[]){const{id:w,missing:T,property:k}=A,N=mM(this,T);w!=="angleRaw"&&N>0&&se.warnOnce(`no value was found for the key '${String(k)}' on ${N} data element${N>1?"s":""}`)}this.animationState.transition("updateData")}maybeRefreshNodeData(){var i;if(!this.nodeDataRefresh)return;const{nodeData:e=[],phantomNodeData:t}=(i=this.createNodeData())!=null?i:{};this.nodeData=e,this.phantomNodeData=t,this.nodeDataRefresh=!1}getProcessedDataValues(e,t){const i=e.resolveColumnById(this,"angleValue",t),s=e.resolveColumnById(this,"angleRaw",t),n=this.properties.angleFilterKey!=null?e.resolveColumnById(this,"angleFilterValue",t):void 0,a=this.properties.angleFilterKey!=null?e.resolveColumnById(this,"angleFilterRaw",t):void 0,r=this.properties.radiusKey?e.resolveColumnById(this,"radiusValue",t):void 0,o=this.properties.radiusKey?e.resolveColumnById(this,"radiusRaw",t):void 0,l=this.properties.calloutLabelKey?e.resolveColumnById(this,"calloutLabelValue",t):void 0,c=this.properties.sectorLabelKey?e.resolveColumnById(this,"sectorLabelValue",t):void 0,h=this.properties.legendItemKey?e.resolveColumnById(this,"legendItemValue",t):void 0;return{angleValues:i,angleRawValues:s,angleFilterValues:n,angleFilterRawValues:a,radiusValues:r,radiusRawValues:o,calloutLabelValues:l,sectorLabelValues:c,legendItemValues:h}}createNodeData(){var T,k,N;const{id:e,processedData:t,dataModel:i,angleScale:s,ctx:{legendManager:n},visible:a}=this,{rotation:r,innerRadiusRatio:o}=this.properties;if(!i||(t==null?void 0:t.type)!=="ungrouped")return;const{angleValues:l,angleRawValues:c,angleFilterValues:h,angleFilterRawValues:d,radiusValues:u,radiusRawValues:p,calloutLabelValues:g,sectorLabelValues:f,legendItemValues:y}=this.getProcessedDataValues(i,t),v=(T=d==null?void 0:d.some((O,L)=>O>c[L]))!=null?T:!1;let x=0,S=0;const M=[],D=d!=null?[]:void 0,A=(k=t.dataSources.get(this.id))!=null?k:[],w=(N=t.invalidData)==null?void 0:N.get(this.id);return A.forEach((O,L)=>{var J;if((w==null?void 0:w[L])===!0)return;const F=v?h[L]:l[L],B=d!=null&&!v?Math.sqrt(d[L]/c[L]):1,_=s.convert(x)+Vi(r);x=F,S+=F;const G=s.convert(x)+Vi(r),V=Math.abs(G-_),j=_+V/2,H=c[L],$=((J=u==null?void 0:u[L])!=null?J:1)*B,W=p==null?void 0:p[L],Y=y==null?void 0:y[L],K=this.getLabels(O,j,V,!0,g==null?void 0:g[L],f==null?void 0:f[L],Y),Q=this.getSectorFormat(O,L,!1),Z=b({itemId:L,series:this,datum:O,datumIndex:L,angleValue:H,midAngle:j,midCos:Math.cos(j),midSin:Math.sin(j),startAngle:_,endAngle:G,radius:$,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert($),0),sectorFormat:Q,radiusValue:W,legendItemValue:Y,enabled:a&&n.getItemEnabled({seriesId:e,itemId:L}),focusable:!0},K);M.push(Z),D!=null&&D.push(E(b({},Z),{radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0),focusable:!1}))}),this.zerosumOuterRing.visible=S===0,this.zerosumInnerRing.visible=S===0&&o!=null&&o!==1&&o>0,{itemId:e,nodeData:M,labelData:M,phantomNodeData:D}}getLabels(e,t,i,s,n,a,r){const{calloutLabel:o,sectorLabel:l,legendItemKey:c}=this.properties,h=!s||o.enabled?this.properties.calloutLabelKey:void 0,d=!s||l.enabled?this.properties.sectorLabelKey:void 0;if(!h&&!d&&!c)return{};const u={datum:e,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},p={};return h&&i>=Vi(o.minAngle)&&(p.calloutLabel=E(b({},this.getTextAlignment(t)),{text:this.getLabelText(o,E(b({},u),{value:n})),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0})),d&&(p.sectorLabel={text:this.getLabelText(l,E(b({},u),{value:a}))}),c!=null&&r!=null&&(p.legendItem={key:c,text:r}),p}getTextAlignment(e){const t=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],i=mg(e),s=-.75*Math.PI,n=i-s,a=Math.floor(n/(Math.PI/2)),r=vE(a,t.length);return t[r]}getNodeFill(e,t,i){return bh(e,{type:"gradient",bounds:"series",colorStops:t.map(s=>({color:s})),gradient:"radial",rotation:0,reverse:!0},{type:"pattern",pattern:"forward-slanted-lines",fill:i,fillOpacity:1,backgroundFill:"none",backgroundFillOpacity:1,stroke:i,strokeOpacity:1,strokeWidth:4,rotation:0},{type:"image",backgroundFill:i,backgroundFillOpacity:1,fit:"contain",repeat:"no-repeat",rotation:0})}getFillParams(e,t,i){if(!(!Ka(e)||e.bounds==="item"))return{centerX:0,centerY:0,innerRadius:t,outerRadius:i}}getSectorFormat(e,t,i){var N,O,L,F,B,_,G,V;const{angleKey:s,radiusKey:n,calloutLabelKey:a,sectorLabelKey:r,legendItemKey:o,fills:l,strokes:c,defaultColorRange:h,defaultPatternFills:d,itemStyler:u}=this.properties,p=c[t%c.length],{fill:g,fillOpacity:f,stroke:y,strokeWidth:v,strokeOpacity:x,lineDash:S,lineDashOffset:M,cornerRadius:D}=Je(i&&this.properties.highlightStyle.item,{fill:l.length>0?l[t%l.length]:void 0,stroke:p,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()},this.properties),A=h[t%h.length],w=d[t%d.length],T=g!=null?g:"black";let k;return u&&(k=this.cachedDatumCallback(this.getDatumId(t)+(i?"-highlight":"-hide"),()=>this.callWithContext(u,{datum:e,angleKey:s,radiusKey:n,calloutLabelKey:a,sectorLabelKey:r,legendItemKey:o,fill:this.getNodeFill(T,A,w),fillOpacity:f,stroke:y,strokeWidth:v,strokeOpacity:x,lineDash:S,lineDashOffset:M,cornerRadius:D,highlighted:i,seriesId:this.id}))),{fill:this.getNodeFill((N=k==null?void 0:k.fill)!=null?N:T,A,w),fillOpacity:(O=k==null?void 0:k.fillOpacity)!=null?O:f,stroke:(L=k==null?void 0:k.stroke)!=null?L:y,strokeWidth:(F=k==null?void 0:k.strokeWidth)!=null?F:v,strokeOpacity:(B=k==null?void 0:k.strokeOpacity)!=null?B:x,lineDash:(_=k==null?void 0:k.lineDash)!=null?_:S,lineDashOffset:(G=k==null?void 0:k.lineDashOffset)!=null?G:M,cornerRadius:(V=k==null?void 0:k.cornerRadius)!=null?V:D}}getInnerRadius(){const{radius:e}=this,{innerRadiusRatio:t=1,innerRadiusOffset:i=0}=this.properties,s=e*t+i;return s===e||s<0?0:s}getOuterRadius(){const{outerRadiusRatio:e,outerRadiusOffset:t}=this.properties;return Math.max(this.radius*e+t,0)}updateRadiusScale(e){var s;const t=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=t,e&&(this.previousRadiusScale.range=t);const i=n=>E(b({},n),{innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(n.radius),0)});this.nodeData=this.nodeData.map(i),this.phantomNodeData=(s=this.phantomNodeData)==null?void 0:s.map(i)}getTitleTranslationY(){var n,a;const e=Math.max(0,this.radiusScale.range[1]);if(e===0)return NaN;const i=2+((a=(n=this.properties.title)==null?void 0:n.spacing)!=null?a:0),s=Math.max(0,-e);return-e-i-s}update({seriesRect:e}){const{title:t}=this.properties,i={seriesRectWidth:e==null?void 0:e.width,seriesRectHeight:e==null?void 0:e.height},s=Lr(this.nodeDataDependencies,i)!=null;if(s&&(this._nodeDataDependencies=i),this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(s),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),t){const n=this.getTitleTranslationY();t.node.y=isFinite(n)?n:0;const a=t.node.getBBox();t.node.visible=t.enabled&&isFinite(n)&&!this.bboxIntersectsSurroundingSeries(a)}for(const n of[this.zerosumInnerRing,this.zerosumOuterRing])n.fillOpacity=0,n.stroke=this.properties.calloutLabel.color,n.strokeWidth=1,n.strokeOpacity=1;this.updateNodeMidPoint(),this.updateSelections(),this.updateNodes(e)}updateTitleNodes(){var i,s;const{oldTitle:e}=this,{title:t}=this.properties;e!==t&&(e&&((i=this.labelGroup)==null||i.removeChild(e.node)),t&&(t.node.textBaseline="bottom",(s=this.labelGroup)==null||s.appendChild(t.node)),this.oldTitle=t)}updateNodeMidPoint(){var t;const e=i=>{const s=i.innerRadius+(i.outerRadius-i.innerRadius)/2;i.midPoint={x:i.midCos*Math.max(0,s),y:i.midSin*Math.max(0,s)}};this.nodeData.forEach(e),(t=this.phantomNodeData)==null||t.forEach(e)}updateSelections(){this.updateGroupSelection(),this.updateInnerCircleSelection()}updateGroupSelection(){var c;const{itemSelection:e,highlightSelection:t,phantomSelection:i,highlightLabelSelection:s,calloutLabelSelection:n,labelSelection:a,innerLabelsSelection:r}=this,o=this.nodeData.map(h=>E(b({},h),{sectorFormat:b({},h.sectorFormat)})),l=(h,d)=>{h.update(d,void 0,u=>this.getDatumId(u.datumIndex)),this.ctx.animationManager.isSkipped()&&h.cleanup()};l(e,this.nodeData),l(t,o),l(i,(c=this.phantomNodeData)!=null?c:[]),n.update(this.calloutNodeData,h=>{const d=new Ks;d.tag=0,d.pointerEvents=1,h.appendChild(d);const u=new is;u.tag=1,u.pointerEvents=1,h.appendChild(u)}),a.update(this.nodeData),s.update(o),r.update(this.properties.innerLabels,h=>{h.pointerEvents=1})}updateInnerCircleSelection(){const{innerCircle:e}=this.properties;let t=0;const i=this.getInnerRadius();if(i>0){const n=Math.min(i,this.getOuterRadius());t=Math.ceil(n*2+1)}const s=e?[{radius:t}]:[];this.innerCircleSelection.update(s)}updateNodes(e){const t=this.ctx.highlightManager.getActiveHighlight(),{visible:i}=this;this.backgroundGroup.visible=i,this.contentGroup.visible=i,this.highlightGroup.visible=i&&(t==null?void 0:t.series)===this,this.highlightLabel.visible=i&&(t==null?void 0:t.series)===this,this.labelGroup.visible=i,this.contentGroup.opacity=this.getOpacity(),this.innerCircleSelection.each((l,{radius:c})=>{var h,d;l.setProperties({fill:this.getNodeFill((h=this.properties.innerCircle)==null?void 0:h.fill,["black"],"black"),opacity:(d=this.properties.innerCircle)==null?void 0:d.fillOpacity,size:c})});const s=this.radiusScale.range[0],n=this.radiusScale.range[1],a=this.getShapeFillBBox(),r=this.ctx.animationManager.isSkipped(),o=(l,c,h,d)=>{const u=this.getSectorFormat(c.datum,c.itemId,d);c.sectorFormat.fill=u.fill,c.sectorFormat.stroke=u.stroke,r&&(l.startAngle=c.startAngle,l.endAngle=c.endAngle,l.innerRadius=c.innerRadius,l.outerRadius=c.outerRadius),(d||r)&&(l.fill=u.fill,l.stroke=u.stroke);const p=this.getFillParams(u.fill,s,n);cv(l,u.fill,a,p),l.strokeWidth=u.strokeWidth,l.fillOpacity=u.fillOpacity,l.strokeOpacity=u.strokeOpacity,l.lineDash=u.lineDash,l.lineDashOffset=u.lineDashOffset,l.cornerRadius=u.cornerRadius,l.fillShadow=this.properties.shadow;const g=Math.max((this.properties.sectorSpacing+(u.stroke!=null?u.strokeWidth:0))/2,0);l.inset=g,l.lineJoin=this.properties.sectorSpacing>=0||g>0?"miter":"round"};this.itemSelection.each((l,c,h)=>o(l,c,h,!1)),this.highlightSelection.each((l,c,h)=>{o(l,c,h,!0),l.visible=c.itemId===(t==null?void 0:t.itemId)}),this.phantomSelection.each((l,c,h)=>o(l,c,h,!1)),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(e),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{calloutLine:{length:e,strokeWidth:t,colors:i},strokes:s}=this.properties,n=t,a=eR(i)?i!=null?i:this.properties.strokes:s,{offset:r}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(0).forEach(o=>{var u;const l=o.closestDatum(),{calloutLabel:c,outerRadius:h,datumIndex:d}=l;if(c!=null&&c.text&&!c.hidden&&h!==0){o.visible=!0,o.strokeWidth=n,o.stroke=a[d%a.length],o.fill=void 0;const p=l.midCos*h,g=l.midSin*h;let f=l.midCos*(h+e),y=l.midSin*(h+e);if(((u=c.collisionTextAlign)!=null?u:c.collisionOffsetY!==0)&&c.box!=null){const x=c.box;let S=f,M=y;f<x.x?S=x.x:f>x.x+x.width&&(S=x.x+x.width),y<x.y?M=x.y:y>x.y+x.height&&(M=x.y+x.height);const D=S-f,A=M-y,w=Math.sqrt(Math.pow(D,2)+Math.pow(A,2)),T=w-r;T>0&&(f=f+D*T/w,y=y+A*T/w)}o.x1=p,o.y1=g,o.x2=f,o.y2=y}else o.visible=!1})}getLabelOverflow(e,t,i){const s=-this.centerX,n=s+i.width,a=-this.centerY,r=a+i.height,o=1;let l=1;t.x+o<s?l=(t.x+t.width-s)/t.width:t.x+t.width-o>n&&(l=(n-t.x)/t.width);const c=t.y+o<a||t.y+t.height-o>r,h=l===1?e.length:Math.floor(e.length*l)-1,d=this.bboxIntersectsSurroundingSeries(t);return{textLength:h,hasVerticalOverflow:c,hasSurroundingSeriesOverflow:d}}bboxIntersectsSurroundingSeries(e){const{surroundingRadius:t}=this;if(t==null)return!1;const i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],s=t**2;return i.some(n=>n.x**2+n.y**2>s)}computeCalloutLabelCollisionOffsets(){const{radiusScale:e}=this,{calloutLabel:t,calloutLine:i}=this.properties,{offset:s,minSpacing:n}=t,a=e.convert(0),r=v=>!v.calloutLabel||v.outerRadius===0,o=this.calloutNodeData,l=o.filter(v=>!r(v));if(l.forEach(v=>{const x=v.calloutLabel;x!=null&&(x.hidden=!1,x.collisionTextAlign=void 0,x.collisionOffsetY=0)}),l.length<=1)return;const c=l.filter(v=>v.midCos<0).sort((v,x)=>v.midSin-x.midSin),h=l.filter(v=>v.midCos>=0).sort((v,x)=>v.midSin-x.midSin),d=l.filter(v=>{var x;return v.midSin<0&&((x=v.calloutLabel)==null?void 0:x.textAlign)==="center"}).sort((v,x)=>v.midCos-x.midCos),u=l.filter(v=>{var x;return v.midSin>=0&&((x=v.calloutLabel)==null?void 0:x.textAlign)==="center"}).sort((v,x)=>v.midCos-x.midCos),p=v=>{var T;const x=v.calloutLabel;if(x==null)return ve.zero.clone();const S=v.outerRadius+i.length+s,M=v.midCos*S,D=v.midSin*S+x.collisionOffsetY,A=(T=x.collisionTextAlign)!=null?T:x.textAlign,w=x.textBaseline;return is.computeBBox(x.text,M,D,{font:this.properties.calloutLabel,textAlign:A,textBaseline:w})},g=(v,x,S)=>{const M=p(v).grow(n/2),D=p(x).grow(n/2);M.x<D.x+D.width&&M.x+M.width>D.x&&(S==="to-top"?M.y<D.y+D.height:M.y+M.height>D.y)&&(x.calloutLabel.collisionOffsetY=S==="to-top"?M.y-D.y-D.height:M.y+M.height-D.y)},f=v=>{const x=v.slice().sort((M,D)=>Math.abs(M.midSin)-Math.abs(D.midSin))[0],S=v.indexOf(x);for(let M=S-1;M>=0;M--){const D=v[M+1],A=v[M];g(D,A,"to-top")}for(let M=S+1;M<v.length;M++){const D=v[M-1],A=v[M];g(D,A,"to-bottom")}},y=v=>{const x=l.some(T=>T.calloutLabel.collisionOffsetY!==0),S=v.map(T=>p(T)),M=S.map(T=>T.clone().grow(n/2));let D=!1;for(let T=0;T<M.length&&!D;T++){const k=M[T];for(let N=T+1;N<v.length;N++){const O=M[N];if(k.collidesBBox(O)){D=!0;break}}}const A=o.map(T=>{const{startAngle:k,endAngle:N,outerRadius:O}=T;return{startAngle:k,endAngle:N,innerRadius:a,outerRadius:O}}),w=S.some(T=>A.some(k=>mF(T,k)));!D&&!x&&!w||v.filter(T=>T.calloutLabel.textAlign==="center").forEach(T=>{const k=T.calloutLabel;T.midCos<0?k.collisionTextAlign="right":T.midCos>0?k.collisionTextAlign="left":k.collisionTextAlign="center"})};f(c),f(h),y(d),y(u)}updateCalloutLabelNodes(e){const{radiusScale:t}=this,{calloutLabel:i,calloutLine:s}=this.properties,n=s.length,{offset:a,color:r}=i,o=new is;this.calloutLabelSelection.selectByTag(1).forEach(l=>{var M;const c=l.closestDatum(),h=c.calloutLabel,d=t.convert(c.radius),u=Math.max(0,d);if(!(h!=null&&h.text)||u===0||h.hidden){l.visible=!1;return}const p=u+n+a,g=c.midCos*p,f=c.midSin*p+h.collisionOffsetY,y={textAlign:(M=h.collisionTextAlign)!=null?M:h.textAlign,textBaseline:h.textBaseline};o.text=h.text,o.x=g,o.y=f,o.setFont(this.properties.calloutLabel),o.setAlign(y);const v=o.getBBox();let x=h.text,S=!0;if(i.avoidCollisions){const{textLength:D,hasVerticalOverflow:A}=this.getLabelOverflow(h.text,v,e);x=h.text.length===D?h.text:`${h.text.substring(0,D)}\u2026`,S=!A}l.text=x,l.x=g,l.y=f,l.setFont(this.properties.calloutLabel),l.setAlign(y),l.fill=r,l.visible=S})}computeLabelsBBox(e,t){const{calloutLabel:i,calloutLine:s}=this.properties,n=s.length,{offset:a,maxCollisionOffset:r,minSpacing:o}=i;if(!i.avoidCollisions)return null;this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const l=[],c=new is;let h;const{title:d}=this.properties;if(d!=null&&d.text&&d.enabled){const u=this.getTitleTranslationY();isFinite(u)&&(c.text=d.text,c.x=0,c.y=u,c.setFont(d),c.setAlign({textBaseline:"bottom",textAlign:"center"}),h=c.getBBox(),l.push(h))}return this.calloutNodeData.forEach(u=>{var x;const p=u.calloutLabel;if(!p||u.outerRadius===0)return null;const g=u.outerRadius+n+a,f=u.midCos*g,y=u.midSin*g+p.collisionOffsetY;c.text=p.text,c.x=f,c.y=y,c.setFont(this.properties.calloutLabel),c.setAlign({textAlign:(x=p.collisionTextAlign)!=null?x:p.textAlign,textBaseline:p.textBaseline});const v=c.getBBox();if(p.box=v,Math.abs(p.collisionOffsetY)>r){p.hidden=!0;return}if(h){const S=-this.centerY,M=new ve(h.x-o,S,h.width+2*o,h.y+h.height+o-S);if(v.collidesBBox(M)){p.hidden=!0;return}}if(e.hideWhenNecessary){const{textLength:S,hasVerticalOverflow:M,hasSurroundingSeriesOverflow:D}=this.getLabelOverflow(p.text,v,t),A=p.text.length>2&&S<2;if(M||A||D){p.hidden=!0;return}}p.hidden=!1,l.push(v)}),l.length===0?null:ve.merge(l)}updateSectorLabelNodes(){const{radiusScale:e}=this,t=e.convert(0),{fontSize:i,fontStyle:s,fontWeight:n,fontFamily:a,positionOffset:r,positionRatio:o,color:l}=this.properties.sectorLabel,c=(h,d)=>{const{sectorLabel:u,outerRadius:p}=d;let g=!1;if(u&&p!==0){const f=t*(1-o)+p*o+r;h.fill=l,h.fontStyle=s,h.fontWeight=n,h.fontSize=i,h.fontFamily=a,h.text=u.text,h.x=d.midCos*f,h.y=d.midSin*f,h.textAlign="center",h.textBaseline="middle";const y=h.getBBox(),v=[[y.x,y.y],[y.x+y.width,y.y],[y.x+y.width,y.y+y.height],[y.x,y.y+y.height]],{startAngle:x,endAngle:S}=d,M={startAngle:x,endAngle:S,innerRadius:t,outerRadius:p};v.every(([D,A])=>Qv(D,A,M))&&(g=!0)}h.visible=g};this.labelSelection.each(c),this.highlightLabelSelection.each(c)}updateInnerLabelNodes(){const e=[],t=[];this.innerLabelsSelection.each((h,d)=>{const{fontStyle:u,fontWeight:p,fontSize:g,fontFamily:f,color:y}=d;h.fontStyle=u,h.fontWeight=p,h.fontSize=g,h.fontFamily=f,h.text=d.text,h.x=0,h.y=0,h.fill=y,h.textAlign="center",h.textBaseline="alphabetic",e.push(h.getBBox()),t.push(d.spacing)});const i=h=>h===0?0:t[h],s=h=>h===t.length-1?0:t[h],n=e.reduce((h,d,u)=>h+d.height+i(u)+s(u),0),a=Math.max(...e.map(h=>h.width)),r=this.getInnerRadius(),l=Math.sqrt(Math.pow(a/2,2)+Math.pow(n/2,2))<=(r>0?r:this.getOuterRadius()),c=[];for(let h=0,d=-n/2;h<e.length;h++){const p=e[h].height+d+i(h);c.push(p),d=p+s(h)}this.innerLabelsSelection.each((h,d,u)=>{h.y=c[u],h.visible=l})}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2,this.zerosumInnerRing.size=this.getInnerRadius()*2}pickNodeClosestDatum(e){return ZD(this,e)}getTooltipContent(e){var w,T,k,N;const{id:t,dataModel:i,processedData:s,properties:n}=this,{legendItemKey:a,calloutLabelKey:r,calloutLabelName:o,sectorLabelKey:l,sectorLabelName:c,angleKey:h,angleName:d,radiusKey:u,radiusName:p,tooltip:g}=n,f=this.properties.title.text;if(!i||!s)return;const y=(w=s.dataSources.get(this.id))==null?void 0:w[e],{angleRawValues:v,legendItemValues:x,calloutLabelValues:S,sectorLabelValues:M}=this.getProcessedDataValues(i,s),D=v[e],A=(N=(k=(T=x==null?void 0:x[e])!=null?T:r===h||S==null?void 0:S[e])!=null?k:l===h||M==null?void 0:M[e])!=null?N:d;return this.formatTooltipWithContext(g,{title:f,symbol:this.legendItemSymbol(e),data:[{label:A,fallbackLabel:h,value:Ao(D,3)}]},b({seriesId:t,datum:y,title:d,legendItemKey:a,calloutLabelKey:r,calloutLabelName:o,sectorLabelKey:l,sectorLabelName:c,angleKey:h,angleName:d,radiusKey:u,radiusName:p},this.getSectorFormat(y,e,!1)))}legendItemSymbol(e){var h,d;const t=(d=(h=this.processedData)==null?void 0:h.dataSources.get(this.id))==null?void 0:d[e],i=this.getSectorFormat(t,e,!1),{fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:r,lineDashOffset:o}=this.properties;let{fill:l}=i;const{stroke:c}=i;return Ka(l)&&(l=E(b({},l),{gradient:"linear",rotation:0,reverse:!1})),{marker:{fill:l,stroke:c,fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:r,lineDashOffset:o}}}getLegendData(e){var M,D,A,w,T,k;const{visible:t,processedData:i,dataModel:s,id:n,ctx:{legendManager:a}}=this;if(!s||!i||e!=="category")return[];const{angleKey:r,calloutLabelKey:o,sectorLabelKey:l,legendItemKey:c,showInLegend:h}=this.properties;if(!c&&(!o||o===r)&&(!l||l===r))return[];const{angleRawValues:d,calloutLabelValues:u,sectorLabelValues:p,legendItemValues:g}=this.getProcessedDataValues(s,i),f=((M=this.properties.title)==null?void 0:M.showInLegend)&&this.properties.title.text,y=[],v=this.properties.hideZeroValueSectorsInLegend,x=i.dataSources.get(this.id),S=(D=i.invalidData)==null?void 0:D.get(this.id);for(let N=0;N<i.input.count;N++){const O=x==null?void 0:x[N],L=d[N];if((S==null?void 0:S[N])===!0||v&&L===0)continue;const F=[];f&&F.push(f);const B=this.getLabels(O,2*Math.PI,2*Math.PI,!1,u==null?void 0:u[N],p==null?void 0:p[N],g==null?void 0:g[N]);c&&B.legendItem!==void 0?F.push(B.legendItem.text):o&&o!==r&&((A=B.calloutLabel)==null?void 0:A.text)!==void 0?F.push((w=B.calloutLabel)==null?void 0:w.text):l&&l!==r&&((T=B.sectorLabel)==null?void 0:T.text)!==void 0&&F.push((k=B.sectorLabel)==null?void 0:k.text),F.length!==0&&y.push({legendType:"category",id:n,datum:O,itemId:N,seriesId:n,hideToggleOtherSeries:!0,enabled:t&&a.getItemEnabled({seriesId:n,itemId:N}),label:{text:F.join(" - ")},symbol:this.legendItemSymbol(N),legendItemName:c!=null?O[c]:void 0,hideInLegend:!h})}return y}setLegendState(e){const{id:t,ctx:{legendManager:i,updateService:s}}=this;e.forEach((n,a)=>i.toggleItem(n,t,a)),i.update(),s.update(5)}animateEmptyUpdateReady(e){const{animationManager:t}=this.ctx,i=Eh(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);Qt(this.id,"nodes",t,[this.itemSelection,this.highlightSelection,this.phantomSelection],i.nodes,(s,n)=>this.getDatumId(n.datumIndex)),Qt(this.id,"innerCircle",t,[this.innerCircleSelection],i.innerCircle),dt(this,"callout",t,this.calloutLabelSelection),dt(this,"sector",t,this.labelSelection),dt(this,"highlight",t,this.highlightLabelSelection),dt(this,"inner",t,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var p,g,f,y,v,x,S;const{itemSelection:e,highlightSelection:t,phantomSelection:i,processedData:s,radiusScale:n,previousRadiusScale:a}=this,{animationManager:r}=this.ctx,o=(g=(p=s==null?void 0:s.reduced)==null?void 0:p.diff)==null?void 0:g[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const l=((f=o==null?void 0:o.moved.size)!=null?f:0)===0,c=((y=s==null?void 0:s.defs.keys.length)!=null?y:0)>0,h=(S=(x=(v=s==null?void 0:s.reduced)==null?void 0:v.animationValidation)==null?void 0:x.uniqueKeys)!=null?S:!0;(!l||!c||!h)&&this.ctx.animationManager.skipCurrentBatch();const d=!this.nodeData.some(M=>M.enabled),u=Eh(!1,this.properties.rotation,n,a);Qt(this.id,"nodes",r,[e,t,i],u.nodes,(M,D)=>this.getDatumId(D.datumIndex),o),Qt(this.id,"innerCircle",r,[this.innerCircleSelection],u.innerCircle),dt(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),dt(this,"sector",this.ctx.animationManager,this.labelSelection),dt(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.noVisibleData!==d&&(this.noVisibleData=d,dt(this,"inner",this.ctx.animationManager,this.innerLabelsSelection)),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection:e,highlightSelection:t,phantomSelection:i,radiusScale:s,previousRadiusScale:n}=this,{animationManager:a}=this.ctx,r=Eh(!1,this.properties.rotation,s,n);Qt(this.id,"nodes",a,[e,t,i],r.nodes,(o,l)=>this.getDatumId(l.datumIndex)),Qt(this.id,"innerCircle",a,[this.innerCircleSelection],r.innerCircle),Yl(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),Yl(this,"sector",this.ctx.animationManager,this.labelSelection),Yl(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),Yl(this,"inner",this.ctx.animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumId(e){return`${e}`}};nb.className="DonutSeries",nb.type="donut";var qD=b(b(b(b({radiusMin:X,radiusMax:X,rotation:ne,outerRadiusOffset:ne,outerRadiusRatio:Me,hideZeroValueSectorsInLegend:q,sectorSpacing:X,cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),title:b({enabled:q,text:z,showInLegend:q,spacing:X},It),calloutLabel:b({enabled:q,offset:ne,minAngle:X,avoidCollisions:q,formatter:ft},It),sectorLabel:b({enabled:q,positionOffset:ne,positionRatio:Me,formatter:ft},It),calloutLine:{colors:Ie(ye),length:X,strokeWidth:X},fills:Ie(Ir),strokes:Ie(ye),tooltip:nt,shadow:Vr},it),De),be(xe,["fill"])),be(ge,["stroke"])),Rh=E(b(b({},qD),Jn),{type:ee(Oe("pie")),angleKey:ee(z),radiusKey:z,calloutLabelKey:z,sectorLabelKey:z,legendItemKey:z,angleName:z,radiusName:z,calloutLabelName:z,sectorLabelName:z});Rh.defaultColorRange=Ce(Ie(Ie(ye))),Rh.defaultPatternFills=Ce(Ie(ye)),Rh.title._enabledFromTheme=Ce(q),Rh.calloutLabel._enabledFromTheme=Ce(q),Rh.sectorLabel._enabledFromTheme=Ce(q);var xF=E(b({},qD),{innerRadiusOffset:ne,innerRadiusRatio:Me,innerCircle:{fill:z,fillOpacity:Me},innerLabels:b({spacing:X},It)}),bre=E(b(b({},xF),Rh),{type:ee(Oe("donut")),innerLabels:Li(b({text:ee(z),spacing:X},It),"inner label options array")}),xre={series:{title:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.1666666666666667]},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},spacing:5},calloutLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},offset:3,minAngle:.001},sectorLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"backgroundColor"},positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2,colors:{$map:[{$if:[{$or:[{$isGradient:[{$value:"$1"}]},{$isPattern:[{$value:"$1"}]},{$isImage:[{$value:"$1"}]}]},{$path:["../../strokes/$index",{$ref:"foregroundColor"}]},{$value:"$1"}]},{$if:[{$eq:[{$path:"../strokeWidth"},0]},{$path:"../fills"},{$path:"../strokes"}]}]}},fills:{$palette:"fills"},strokes:{$palette:"strokes"},defaultColorRange:{$palette:"gradients"},defaultPatternFills:mD,fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,innerRadiusRatio:{$if:[{$eq:[{$path:["./innerRadiusOffset",void 0]},void 0]},.7,void 0]},shadow:{enabled:!1,color:Wl,xOffset:3,yOffset:3,blur:5},innerLabels:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:2}},legend:{enabled:!0}},Cre={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"donut",moduleFactory:e=>new nb(e),tooltipDefaults:{range:"exact"},themeTemplate:xre},Sre={type:"series",name:"donut",chartType:"polar",options:bre,create:e=>new nb(e)},CF=class extends Ht{constructor(){super(...arguments),this.showInLegend=!1}};I([P],CF.prototype,"showInLegend",2);var Ru=class extends as{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}};I([P],Ru.prototype,"offset",2),I([P],Ru.prototype,"minAngle",2),I([P],Ru.prototype,"minSpacing",2),I([P],Ru.prototype,"maxCollisionOffset",2),I([P],Ru.prototype,"avoidCollisions",2);var QD=class extends as{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}};I([P],QD.prototype,"positionOffset",2),I([P],QD.prototype,"positionRatio",2);var ab=class extends Be{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}};I([P],ab.prototype,"colors",2),I([P],ab.prototype,"length",2),I([P],ab.prototype,"strokeWidth",2);var at=class extends Qn{constructor(){super(...arguments),this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=Object.values(xi),this.strokes=Object.values(jr),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.hideZeroValueSectorsInLegend=!1,this.title=new CF,this.shadow=new sr,this.calloutLabel=new Ru,this.sectorLabel=new QD,this.calloutLine=new ab,this.tooltip=new Ys}};I([P],at.prototype,"angleKey",2),I([P],at.prototype,"angleName",2),I([P],at.prototype,"angleFilterKey",2),I([P],at.prototype,"radiusKey",2),I([P],at.prototype,"radiusName",2),I([P],at.prototype,"radiusMin",2),I([P],at.prototype,"radiusMax",2),I([P],at.prototype,"calloutLabelKey",2),I([P],at.prototype,"calloutLabelName",2),I([P],at.prototype,"sectorLabelKey",2),I([P],at.prototype,"sectorLabelName",2),I([P],at.prototype,"legendItemKey",2),I([P],at.prototype,"defaultColorRange",2),I([P],at.prototype,"defaultPatternFills",2),I([P],at.prototype,"fills",2),I([P],at.prototype,"strokes",2),I([P],at.prototype,"fillOpacity",2),I([P],at.prototype,"strokeOpacity",2),I([P],at.prototype,"lineDash",2),I([P],at.prototype,"lineDashOffset",2),I([P],at.prototype,"cornerRadius",2),I([P],at.prototype,"itemStyler",2),I([P],at.prototype,"rotation",2),I([P],at.prototype,"outerRadiusOffset",2),I([P],at.prototype,"outerRadiusRatio",2),I([P],at.prototype,"strokeWidth",2),I([P],at.prototype,"sectorSpacing",2),I([P],at.prototype,"hideZeroValueSectorsInLegend",2),I([P],at.prototype,"title",2),I([P],at.prototype,"shadow",2),I([P],at.prototype,"calloutLabel",2),I([P],at.prototype,"sectorLabel",2),I([P],at.prototype,"calloutLine",2),I([P],at.prototype,"tooltip",2);var Mre=class extends zg{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey,this.calloutLabelKey=s.properties.calloutLabelKey,this.sectorLabelKey=s.properties.sectorLabelKey}},rb=class extends sb{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[1,0],useLabelLayer:!0,animationResetFns:{item:XD,label:Fo}}),this.properties=new at,this.phantomNodeData=void 0,this.backgroundGroup=new ds({name:`${this.id}-background`,zIndex:0}),this.previousRadiusScale=new tr,this.radiusScale=new tr,this.phantomGroup=this.backgroundGroup.appendChild(new Ge({name:"phantom"})),this.phantomSelection=Pi.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Ge({name:"pieCalloutLabels"})),this.calloutLabelSelection=new Pi(this.calloutLabelGroup,Ge),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Ge({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new rs({shape:"circle"})),this.surroundingRadius=void 0,this.NodeEvent=Mre,this.angleScale=new tr,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(t=>t+Math.PI/2),this.phantomGroup.opacity=.2}get calloutNodeData(){var e;return(e=this.phantomNodeData)!=null?e:this.nodeData}attachSeries(e,t,i){super.attachSeries(e,t,i),e.appendChild(this.backgroundGroup)}detachSeries(e,t,i){super.detachSeries(e,t,i),e==null||e.removeChild(this.backgroundGroup)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.backgroundGroup.zIndex=[0,e],!0):!1}nodeFactory(){const e=new gs;return e.miterLimit=1e9,e}getSeriesDomain(e){return e==="angle"?this.angleScale.domain:this.radiusScale.domain}async processData(e){var y,v,x,S,M,D,A,w,T;if(this.data==null)return;const{visible:t,id:i,ctx:{legendManager:s}}=this,{angleKey:n,angleFilterKey:a,radiusKey:r,calloutLabelKey:o,sectorLabelKey:l,legendItemKey:c}=this.properties,h=()=>(k,N)=>t&&s.getItemEnabled({seriesId:i,itemId:N})?k:0,d=!this.ctx.animationManager.isSkipped(),u=[],p=[];c?u.push(er(c,"band",{id:"legendItemKey"})):o?u.push(er(o,"band",{id:"calloutLabelKey"})):l&&u.push(er(l,"band",{id:"sectorLabelKey"}));const g=this.radiusScale.type,f=this.angleScale.type;r&&p.push(eD(r,{id:"radiusValue",min:(y=this.properties.radiusMin)!=null?y:0,max:this.properties.radiusMax,missingValue:(v=this.properties.radiusMax)!=null?v:1,processor:h}),et(r,g,{id:"radiusRaw",processor:h}),Sh("radiusValue",[0,1],1,(x=this.properties.radiusMin)!=null?x:0,this.properties.radiusMax)),o&&p.push(et(o,"band",{id:"calloutLabelValue"})),l&&p.push(et(l,"band",{id:"sectorLabelValue"})),c&&p.push(et(c,"band",{id:"legendItemValue"})),a&&p.push($g(a,f,{id:"angleFilterValue",onlyPositive:!0,invalidValue:0,processor:h}),et(a,f,{id:"angleFilterRaw"}),Sh("angleFilterValue",[0,1],0,0)),d&&((D=(M=(S=this.processedData)==null?void 0:S.reduced)==null?void 0:M.animationValidation)!=null&&D.uniqueKeys)&&u.length>0&&p.push(Du(this.id,this.processedData)),p.push(Mu()),await this.requestDataModel(e,this.data,{props:[...u,$g(n,f,{id:"angleValue",onlyPositive:!0,invalidValue:0,processor:h}),et(n,f,{id:"angleRaw"}),Sh("angleValue",[0,1],0,0),...p]});for(const k of(T=(w=(A=this.processedData)==null?void 0:A.defs)==null?void 0:w.values)!=null?T:[]){const{id:N,missing:O,property:L}=k,F=mM(this,O);N!=="angleRaw"&&F>0&&se.warnOnce(`no value was found for the key '${String(L)}' on ${F} data element${F>1?"s":""}`)}this.animationState.transition("updateData")}maybeRefreshNodeData(){var i;if(!this.nodeDataRefresh)return;const{nodeData:e=[],phantomNodeData:t}=(i=this.createNodeData())!=null?i:{};this.nodeData=e,this.phantomNodeData=t,this.nodeDataRefresh=!1}getProcessedDataValues(e,t){const i=e.resolveColumnById(this,"angleValue",t),s=e.resolveColumnById(this,"angleRaw",t),n=this.properties.angleFilterKey!=null?e.resolveColumnById(this,"angleFilterValue",t):void 0,a=this.properties.angleFilterKey!=null?e.resolveColumnById(this,"angleFilterRaw",t):void 0,r=this.properties.radiusKey?e.resolveColumnById(this,"radiusValue",t):void 0,o=this.properties.radiusKey?e.resolveColumnById(this,"radiusRaw",t):void 0,l=this.properties.calloutLabelKey?e.resolveColumnById(this,"calloutLabelValue",t):void 0,c=this.properties.sectorLabelKey?e.resolveColumnById(this,"sectorLabelValue",t):void 0,h=this.properties.legendItemKey?e.resolveColumnById(this,"legendItemValue",t):void 0;return{angleValues:i,angleRawValues:s,angleFilterValues:n,angleFilterRawValues:a,radiusValues:r,radiusRawValues:o,calloutLabelValues:l,sectorLabelValues:c,legendItemValues:h}}createNodeData(){var w,T,k;const{id:e,processedData:t,dataModel:i,angleScale:s,ctx:{legendManager:n},visible:a}=this,{rotation:r}=this.properties;if(!i||(t==null?void 0:t.type)!=="ungrouped")return;const{angleValues:o,angleRawValues:l,angleFilterValues:c,angleFilterRawValues:h,radiusValues:d,radiusRawValues:u,calloutLabelValues:p,sectorLabelValues:g,legendItemValues:f}=this.getProcessedDataValues(i,t),y=(w=h==null?void 0:h.some((N,O)=>N>l[O]))!=null?w:!1;let v=0,x=0;const S=[],M=h!=null?[]:void 0,D=(T=t.dataSources.get(this.id))!=null?T:[],A=(k=t.invalidData)==null?void 0:k.get(this.id);return D.forEach((N,O)=>{var Z;if((A==null?void 0:A[O])===!0)return;const L=y?c[O]:o[O],F=h!=null&&!y?Math.sqrt(h[O]/l[O]):1,B=s.convert(v)+Vi(r);v=L,x+=L;const _=s.convert(v)+Vi(r),G=Math.abs(_-B),V=B+G/2,j=l[O],U=((Z=d==null?void 0:d[O])!=null?Z:1)*F,$=u==null?void 0:u[O],W=f==null?void 0:f[O],Y=this.getLabels(N,V,G,!0,p==null?void 0:p[O],g==null?void 0:g[O],W),K=this.getSectorFormat(N,O,!1),Q=b({itemId:O,series:this,datum:N,datumIndex:O,angleValue:j,midAngle:V,midCos:Math.cos(V),midSin:Math.sin(V),startAngle:B,endAngle:_,radius:U,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(U),0),sectorFormat:K,radiusValue:$,legendItemValue:W,enabled:a&&n.getItemEnabled({seriesId:e,itemId:O})},Y);S.push(Q),M!=null&&M.push(E(b({},Q),{radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0)}))}),this.zerosumOuterRing.visible=x===0,{itemId:e,nodeData:S,labelData:S,phantomNodeData:M}}getLabels(e,t,i,s,n,a,r){const{calloutLabel:o,sectorLabel:l,legendItemKey:c}=this.properties,h=!s||o.enabled?this.properties.calloutLabelKey:void 0,d=!s||l.enabled?this.properties.sectorLabelKey:void 0;if(!h&&!d&&!c)return{};const u={datum:e,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},p={};return h&&i>=Vi(o.minAngle)&&(p.calloutLabel=E(b({},this.getTextAlignment(t)),{text:this.getLabelText(o,E(b({},u),{value:n})),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0})),d&&(p.sectorLabel={text:this.getLabelText(l,E(b({},u),{value:a}))}),c!=null&&r!=null&&(p.legendItem={key:c,text:r}),p}getTextAlignment(e){const t=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],i=mg(e),s=-.75*Math.PI,n=i-s,a=Math.floor(n/(Math.PI/2)),r=vE(a,t.length);return t[r]}getNodeFill(e,t,i){return bh(e,{type:"gradient",bounds:"series",colorStops:t.map(s=>({color:s})),gradient:"radial",rotation:0,reverse:!0},{type:"pattern",pattern:"forward-slanted-lines",fill:i,fillOpacity:1,backgroundFill:"none",backgroundFillOpacity:1,stroke:i,strokeOpacity:1,strokeWidth:4,rotation:0},{type:"image",backgroundFill:i,backgroundFillOpacity:1,fit:"contain",repeat:"no-repeat",rotation:0})}getFillParams(e,t,i){if(!(!Ka(e)||e.bounds==="item"))return{centerX:0,centerY:0,innerRadius:t,outerRadius:i}}getSectorFormat(e,t,i){var N,O,L,F,B,_,G,V;const{angleKey:s,radiusKey:n,calloutLabelKey:a,sectorLabelKey:r,legendItemKey:o,fills:l,strokes:c,defaultColorRange:h,defaultPatternFills:d,itemStyler:u}=this.properties,p=c[t%c.length],{fill:g,fillOpacity:f,stroke:y,strokeWidth:v,strokeOpacity:x,lineDash:S,lineDashOffset:M,cornerRadius:D}=Je(i&&this.properties.highlightStyle.item,{fill:l.length>0?l[t%l.length]:void 0,stroke:p,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()},this.properties),A=h[t%h.length],w=d[t%d.length],T=g!=null?g:"black";let k;return u&&(k=this.cachedDatumCallback(this.getDatumId(t)+(i?"-highlight":"-hide"),()=>this.callWithContext(u,{datum:e,angleKey:s,radiusKey:n,calloutLabelKey:a,sectorLabelKey:r,legendItemKey:o,fill:this.getNodeFill(T,A,w),strokeOpacity:x,stroke:y,strokeWidth:v,fillOpacity:f,lineDash:S,lineDashOffset:M,cornerRadius:D,highlighted:i,seriesId:this.id}))),{fill:this.getNodeFill((N=k==null?void 0:k.fill)!=null?N:T,A,w),fillOpacity:(O=k==null?void 0:k.fillOpacity)!=null?O:f,stroke:(L=k==null?void 0:k.stroke)!=null?L:y,strokeWidth:(F=k==null?void 0:k.strokeWidth)!=null?F:v,strokeOpacity:(B=k==null?void 0:k.strokeOpacity)!=null?B:x,lineDash:(_=k==null?void 0:k.lineDash)!=null?_:S,lineDashOffset:(G=k==null?void 0:k.lineDashOffset)!=null?G:M,cornerRadius:(V=k==null?void 0:k.cornerRadius)!=null?V:D}}getOuterRadius(){return Math.max(this.radius*this.properties.outerRadiusRatio+this.properties.outerRadiusOffset,0)}updateRadiusScale(e){var s;const t=[0,this.getOuterRadius()];this.radiusScale.range=t,e&&(this.previousRadiusScale.range=t);const i=n=>E(b({},n),{innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(n.radius),0)});this.nodeData=this.nodeData.map(i),this.phantomNodeData=(s=this.phantomNodeData)==null?void 0:s.map(i)}getTitleTranslationY(){var n,a;const e=Math.max(0,this.radiusScale.range[1]);if(e===0)return NaN;const i=2+((a=(n=this.properties.title)==null?void 0:n.spacing)!=null?a:0),s=Math.max(0,-e);return-e-i-s}update({seriesRect:e}){const{title:t}=this.properties,i={seriesRectWidth:e==null?void 0:e.width,seriesRectHeight:e==null?void 0:e.height},s=Lr(this.nodeDataDependencies,i)!=null;if(s&&(this._nodeDataDependencies=i),this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(s),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),t){const n=this.getTitleTranslationY();t.node.y=isFinite(n)?n:0;const a=t.node.getBBox();t.node.visible=t.enabled&&isFinite(n)&&!this.bboxIntersectsSurroundingSeries(a)}this.zerosumOuterRing.fillOpacity=0,this.zerosumOuterRing.stroke=this.properties.calloutLabel.color,this.zerosumOuterRing.strokeWidth=1,this.zerosumOuterRing.strokeOpacity=1,this.updateNodeMidPoint(),this.updateSelections(),this.updateNodes(e)}updateTitleNodes(){var i,s;const{oldTitle:e}=this,{title:t}=this.properties;e!==t&&(e&&((i=this.labelGroup)==null||i.removeChild(e.node)),t&&(t.node.textBaseline="bottom",(s=this.labelGroup)==null||s.appendChild(t.node)),this.oldTitle=t)}updateNodeMidPoint(){var t;const e=i=>{const s=i.innerRadius+(i.outerRadius-i.innerRadius)/2;i.midPoint={x:i.midCos*Math.max(0,s),y:i.midSin*Math.max(0,s)}};this.nodeData.forEach(e),(t=this.phantomNodeData)==null||t.forEach(e)}updateSelections(){var l;const{itemSelection:e,highlightSelection:t,phantomSelection:i,highlightLabelSelection:s,calloutLabelSelection:n,labelSelection:a}=this,r=this.nodeData.map(c=>E(b({},c),{sectorFormat:b({},c.sectorFormat)})),o=(c,h)=>{c.update(h,void 0,d=>this.getDatumId(d.datumIndex)),this.ctx.animationManager.isSkipped()&&c.cleanup()};o(e,this.nodeData),o(t,r),o(i,(l=this.phantomNodeData)!=null?l:[]),n.update(this.calloutNodeData,c=>{const h=new Ks;h.tag=0,h.pointerEvents=1,c.appendChild(h);const d=new is;d.tag=1,d.pointerEvents=1,c.appendChild(d)}),a.update(this.nodeData),s.update(r)}updateNodes(e){const t=this.ctx.highlightManager.getActiveHighlight(),{visible:i}=this;this.backgroundGroup.visible=i,this.contentGroup.visible=i,this.highlightGroup.visible=i&&(t==null?void 0:t.series)===this,this.highlightLabel.visible=i&&(t==null?void 0:t.series)===this,this.labelGroup&&(this.labelGroup.visible=i),this.contentGroup.opacity=this.getOpacity();const s=this.radiusScale.range[0],n=this.radiusScale.range[1],a=this.getShapeFillBBox(),r=this.ctx.animationManager.isSkipped(),o=(l,c,h,d)=>{const u=this.getSectorFormat(c.datum,c.itemId,d);c.sectorFormat.fill=u.fill,c.sectorFormat.stroke=u.stroke,r&&(l.startAngle=c.startAngle,l.endAngle=c.endAngle,l.innerRadius=c.innerRadius,l.outerRadius=c.outerRadius),(d||r)&&(l.fill=u.fill,l.stroke=u.stroke);const p=this.getFillParams(u.fill,s,n);cv(l,u.fill,a,p),l.strokeWidth=u.strokeWidth,l.fillOpacity=u.fillOpacity,l.strokeOpacity=u.strokeOpacity,l.lineDash=u.lineDash,l.lineDashOffset=u.lineDashOffset,l.cornerRadius=u.cornerRadius,l.fillShadow=this.properties.shadow;const g=Math.max((this.properties.sectorSpacing+(u.stroke!=null?u.strokeWidth:0))/2,0);l.inset=g,l.lineJoin=this.properties.sectorSpacing>=0||g>0?"miter":"round"};this.itemSelection.each((l,c,h)=>o(l,c,h,!1)),this.highlightSelection.each((l,c,h)=>{o(l,c,h,!0),l.visible=c.itemId===(t==null?void 0:t.itemId)}),this.phantomSelection.each((l,c,h)=>o(l,c,h,!1)),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(e),this.updateSectorLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{calloutLine:{length:e,strokeWidth:t,colors:i},strokes:s}=this.properties,n=t,a=eR(i)?i:s,{offset:r}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(0).forEach(o=>{var u;const l=o.closestDatum(),{calloutLabel:c,outerRadius:h,datumIndex:d}=l;if(c!=null&&c.text&&!c.hidden&&h!==0){o.visible=!0,o.strokeWidth=n,o.stroke=a[d%a.length],o.fill=void 0;const p=l.midCos*h,g=l.midSin*h;let f=l.midCos*(h+e),y=l.midSin*(h+e);if(((u=c.collisionTextAlign)!=null?u:c.collisionOffsetY!==0)&&c.box!=null){const x=c.box;let S=f,M=y;f<x.x?S=x.x:f>x.x+x.width&&(S=x.x+x.width),y<x.y?M=x.y:y>x.y+x.height&&(M=x.y+x.height);const D=S-f,A=M-y,w=Math.sqrt(Math.pow(D,2)+Math.pow(A,2)),T=w-r;T>0&&(f=f+D*T/w,y=y+A*T/w)}o.x1=p,o.y1=g,o.x2=f,o.y2=y}else o.visible=!1})}getLabelOverflow(e,t,i){const s=-this.centerX,n=s+i.width,a=-this.centerY,r=a+i.height,o=1;let l=1;t.x+o<s?l=(t.x+t.width-s)/t.width:t.x+t.width-o>n&&(l=(n-t.x)/t.width);const c=t.y+o<a||t.y+t.height-o>r,h=l===1?e.length:Math.floor(e.length*l)-1,d=this.bboxIntersectsSurroundingSeries(t);return{textLength:h,hasVerticalOverflow:c,hasSurroundingSeriesOverflow:d}}bboxIntersectsSurroundingSeries(e){const{surroundingRadius:t}=this;if(t==null)return!1;const i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],s=t**2;return i.some(n=>n.x**2+n.y**2>s)}computeCalloutLabelCollisionOffsets(){const{radiusScale:e}=this,{calloutLabel:t,calloutLine:i}=this.properties,{offset:s,minSpacing:n}=t,a=e.convert(0),r=v=>!v.calloutLabel||v.outerRadius===0,o=this.calloutNodeData,l=o.filter(v=>!r(v));if(l.forEach(v=>{const x=v.calloutLabel;x!=null&&(x.hidden=!1,x.collisionTextAlign=void 0,x.collisionOffsetY=0)}),l.length<=1)return;const c=l.filter(v=>v.midCos<0).sort((v,x)=>v.midSin-x.midSin),h=l.filter(v=>v.midCos>=0).sort((v,x)=>v.midSin-x.midSin),d=l.filter(v=>{var x;return v.midSin<0&&((x=v.calloutLabel)==null?void 0:x.textAlign)==="center"}).sort((v,x)=>v.midCos-x.midCos),u=l.filter(v=>{var x;return v.midSin>=0&&((x=v.calloutLabel)==null?void 0:x.textAlign)==="center"}).sort((v,x)=>v.midCos-x.midCos),p=v=>{var T;const x=v.calloutLabel;if(x==null)return ve.zero.clone();const S=v.outerRadius+i.length+s,M=v.midCos*S,D=v.midSin*S+x.collisionOffsetY,A=(T=x.collisionTextAlign)!=null?T:x.textAlign,w=x.textBaseline;return is.computeBBox(x.text,M,D,{font:this.properties.calloutLabel,textAlign:A,textBaseline:w})},g=(v,x,S)=>{const M=p(v).grow(n/2),D=p(x).grow(n/2);M.x<D.x+D.width&&M.x+M.width>D.x&&(S==="to-top"?M.y<D.y+D.height:M.y+M.height>D.y)&&(x.calloutLabel.collisionOffsetY=S==="to-top"?M.y-D.y-D.height:M.y+M.height-D.y)},f=v=>{const x=v.slice().sort((M,D)=>Math.abs(M.midSin)-Math.abs(D.midSin))[0],S=v.indexOf(x);for(let M=S-1;M>=0;M--){const D=v[M+1],A=v[M];g(D,A,"to-top")}for(let M=S+1;M<v.length;M++){const D=v[M-1],A=v[M];g(D,A,"to-bottom")}},y=v=>{const x=l.some(T=>T.calloutLabel.collisionOffsetY!==0),S=v.map(T=>p(T)),M=S.map(T=>T.clone().grow(n/2));let D=!1;for(let T=0;T<M.length&&!D;T++){const k=M[T];for(let N=T+1;N<v.length;N++){const O=M[N];if(k.collidesBBox(O)){D=!0;break}}}const A=o.map(T=>{const{startAngle:k,endAngle:N,outerRadius:O}=T;return{startAngle:k,endAngle:N,innerRadius:a,outerRadius:O}}),w=S.some(T=>A.some(k=>mF(T,k)));!D&&!x&&!w||v.filter(T=>T.calloutLabel.textAlign==="center").forEach(T=>{const k=T.calloutLabel;T.midCos<0?k.collisionTextAlign="right":T.midCos>0?k.collisionTextAlign="left":k.collisionTextAlign="center"})};f(c),f(h),y(d),y(u)}updateCalloutLabelNodes(e){const{radiusScale:t}=this,{calloutLabel:i,calloutLine:s}=this.properties,n=s.length,{offset:a,color:r}=i,o=new is;this.calloutLabelSelection.selectByTag(1).forEach(l=>{var M;const c=l.closestDatum(),h=c.calloutLabel,d=t.convert(c.radius),u=Math.max(0,d);if(!(h!=null&&h.text)||u===0||h.hidden){l.visible=!1;return}const p=u+n+a,g=c.midCos*p,f=c.midSin*p+h.collisionOffsetY,y={textAlign:(M=h.collisionTextAlign)!=null?M:h.textAlign,textBaseline:h.textBaseline};o.text=h.text,o.x=g,o.y=f,o.setFont(this.properties.calloutLabel),o.setAlign(y);const v=o.getBBox();let x=h.text,S=!0;if(i.avoidCollisions){const{textLength:D,hasVerticalOverflow:A}=this.getLabelOverflow(h.text,v,e);x=h.text.length===D?h.text:`${h.text.substring(0,D)}\u2026`,S=!A}l.text=x,l.x=g,l.y=f,l.setFont(this.properties.calloutLabel),l.setAlign(y),l.fill=r,l.visible=S})}computeLabelsBBox(e,t){const{calloutLabel:i,calloutLine:s}=this.properties,n=s.length,{offset:a,maxCollisionOffset:r,minSpacing:o}=i;if(!i.avoidCollisions)return null;this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const l=[],c=new is;let h;const{title:d}=this.properties;if(d!=null&&d.text&&d.enabled){const u=this.getTitleTranslationY();isFinite(u)&&(c.text=d.text,c.x=0,c.y=u,c.setFont(d),c.setAlign({textBaseline:"bottom",textAlign:"center"}),h=c.getBBox(),l.push(h))}return this.calloutNodeData.forEach(u=>{var x;const p=u.calloutLabel;if(!p||u.outerRadius===0)return null;const g=u.outerRadius+n+a,f=u.midCos*g,y=u.midSin*g+p.collisionOffsetY;c.text=p.text,c.x=f,c.y=y,c.setFont(this.properties.calloutLabel),c.setAlign({textAlign:(x=p.collisionTextAlign)!=null?x:p.textAlign,textBaseline:p.textBaseline});const v=c.getBBox();if(p.box=v,Math.abs(p.collisionOffsetY)>r){p.hidden=!0;return}if(h){const S=-this.centerY,M=new ve(h.x-o,S,h.width+2*o,h.y+h.height+o-S);if(v.collidesBBox(M)){p.hidden=!0;return}}if(e.hideWhenNecessary){const{textLength:S,hasVerticalOverflow:M,hasSurroundingSeriesOverflow:D}=this.getLabelOverflow(p.text,v,t),A=p.text.length>2&&S<2;if(M||A||D){p.hidden=!0;return}}p.hidden=!1,l.push(v)}),l.length===0?null:ve.merge(l)}updateSectorLabelNodes(){var u;const{radiusScale:e}=this,t=e.convert(0),{fontSize:i,fontStyle:s,fontWeight:n,fontFamily:a,positionOffset:r,positionRatio:o,color:l}=this.properties.sectorLabel,c=t>0,h=((u=this.ctx.legendManager.getData(this.id))==null?void 0:u.filter(p=>p.enabled).length)===1,d=(p,g)=>{const{sectorLabel:f,outerRadius:y,startAngle:v,endAngle:x}=g;let S=!1;if(f&&y!==0){const M=t*(1-o)+y*o+r;p.fill=l,p.fontStyle=s,p.fontWeight=n,p.fontSize=i,p.fontFamily=a,p.text=f.text,!c&&h?(p.x=0,p.y=0):(p.x=g.midCos*M,p.y=g.midSin*M),p.textAlign="center",p.textBaseline="middle";const A=p.getBBox(),w=[[A.x,A.y],[A.x+A.width,A.y],[A.x+A.width,A.y+A.height],[A.x,A.y+A.height]],T={startAngle:v,endAngle:x,innerRadius:t,outerRadius:y};w.every(([k,N])=>Qv(k,N,T))&&(S=!0)}p.visible=S};this.labelSelection.each(d),this.highlightLabelSelection.each(d)}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2}pickNodeClosestDatum(e){return ZD(this,e)}getTooltipContent(e){var w,T,k,N;const{id:t,dataModel:i,processedData:s,properties:n}=this,{legendItemKey:a,calloutLabelKey:r,calloutLabelName:o,sectorLabelKey:l,sectorLabelName:c,angleKey:h,angleName:d,radiusKey:u,radiusName:p,tooltip:g}=n,f=this.properties.title.text;if(!i||!s)return;const y=(w=s.dataSources.get(this.id))==null?void 0:w[e],{angleRawValues:v,legendItemValues:x,calloutLabelValues:S,sectorLabelValues:M}=this.getProcessedDataValues(i,s),D=v[e],A=(N=(k=(T=x==null?void 0:x[e])!=null?T:r===h||S==null?void 0:S[e])!=null?k:l===h||M==null?void 0:M[e])!=null?N:d;return this.formatTooltipWithContext(g,{title:f,symbol:this.legendItemSymbol(e),data:[{label:A,fallbackLabel:h,value:Ao(D,3)}]},b({seriesId:t,datum:y,title:d,legendItemKey:a,calloutLabelKey:r,calloutLabelName:o,sectorLabelKey:l,sectorLabelName:c,angleKey:h,angleName:d,radiusKey:u,radiusName:p},this.getSectorFormat(y,e,!1)))}legendItemSymbol(e){var h,d;const t=(d=(h=this.processedData)==null?void 0:h.dataSources.get(this.id))==null?void 0:d[e],i=this.getSectorFormat(t,e,!1),{fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:r,lineDashOffset:o}=this.properties;let{fill:l}=i;const{stroke:c}=i;return Ka(l)&&(l=E(b({},l),{gradient:"linear",rotation:0,reverse:!1})),{marker:{fill:l,stroke:c,fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:r,lineDashOffset:o}}}getLegendData(e){var M,D,A,w,T,k;const{id:t,visible:i,processedData:s,dataModel:n,ctx:{legendManager:a}}=this;if(!n||!s||e!=="category")return[];const{angleKey:r,calloutLabelKey:o,sectorLabelKey:l,legendItemKey:c,showInLegend:h}=this.properties;if(!c&&(!o||o===r)&&(!l||l===r))return[];const{calloutLabelValues:d,sectorLabelValues:u,legendItemValues:p,angleRawValues:g}=this.getProcessedDataValues(n,s),f=((M=this.properties.title)==null?void 0:M.showInLegend)&&this.properties.title.text,y=[],v=this.properties.hideZeroValueSectorsInLegend,x=s.dataSources.get(this.id),S=(D=s.invalidData)==null?void 0:D.get(this.id);for(let N=0;N<s.input.count;N++){const O=x==null?void 0:x[N],L=g[N];if((S==null?void 0:S[N])===!0||v&&L===0)continue;const F=[];f&&F.push(f);const B=this.getLabels(O,2*Math.PI,2*Math.PI,!1,d==null?void 0:d[N],u==null?void 0:u[N],p==null?void 0:p[N]);c&&B.legendItem!==void 0?F.push(B.legendItem.text):o&&o!==r&&((A=B.calloutLabel)==null?void 0:A.text)!==void 0?F.push((w=B.calloutLabel)==null?void 0:w.text):l&&l!==r&&((T=B.sectorLabel)==null?void 0:T.text)!==void 0&&F.push((k=B.sectorLabel)==null?void 0:k.text),F.length!==0&&y.push({legendType:"category",id:t,datum:O,itemId:N,seriesId:t,hideToggleOtherSeries:!0,enabled:i&&a.getItemEnabled({seriesId:t,itemId:N}),label:{text:F.join(" - ")},symbol:this.legendItemSymbol(N),legendItemName:c!=null?O[c]:void 0,hideInLegend:!h})}return y}setLegendState(e){const{id:t,ctx:{legendManager:i,updateService:s}}=this;e.forEach((n,a)=>i.toggleItem(n,t,a)),i.update(),s.update(5)}animateEmptyUpdateReady(e){const{animationManager:t}=this.ctx,i=Eh(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);Qt(this.id,"nodes",t,[this.itemSelection,this.highlightSelection,this.phantomSelection],i.nodes,(s,n)=>this.getDatumId(n.datumIndex)),dt(this,"callout",t,this.calloutLabelSelection),dt(this,"sector",t,this.labelSelection),dt(this,"highlight",t,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var u,p,g,f,y,v,x;const{itemSelection:e,highlightSelection:t,phantomSelection:i,processedData:s,radiusScale:n,previousRadiusScale:a}=this,{animationManager:r}=this.ctx,o=(p=(u=s==null?void 0:s.reduced)==null?void 0:u.diff)==null?void 0:p[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const l=((g=o==null?void 0:o.moved.size)!=null?g:0)===0,c=((f=s==null?void 0:s.defs.keys.length)!=null?f:0)>0,h=(x=(v=(y=s==null?void 0:s.reduced)==null?void 0:y.animationValidation)==null?void 0:v.uniqueKeys)!=null?x:!0;(!l||!c||!h)&&this.ctx.animationManager.skipCurrentBatch();const d=Eh(!1,this.properties.rotation,n,a);Qt(this.id,"nodes",r,[e,t,i],d.nodes,(S,M)=>this.getDatumId(M.datumIndex),o),dt(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),dt(this,"sector",this.ctx.animationManager,this.labelSelection),dt(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection:e,highlightSelection:t,phantomSelection:i,radiusScale:s,previousRadiusScale:n}=this,{animationManager:a}=this.ctx,r=Eh(!1,this.properties.rotation,s,n);Qt(this.id,"nodes",a,[e,t,i],r.nodes,(o,l)=>this.getDatumId(l.datumIndex)),Yl(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),Yl(this,"sector",this.ctx.animationManager,this.labelSelection),Yl(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumId(e){return`${e}`}};rb.className="PieSeries",rb.type="pie";var Dre={series:{title:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.1666666666666667]},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},spacing:5},calloutLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},offset:3,minAngle:.001},sectorLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"backgroundColor"},positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2,colors:{$map:[{$if:[{$or:[{$isGradient:[{$value:"$1"}]},{$isPattern:[{$value:"$1"}]},{$isImage:[{$value:"$1"}]}]},{$path:["../../strokes/$index",{$ref:"foregroundColor"}]},{$value:"$1"}]},{$if:[{$eq:[{$path:"../strokeWidth"},0]},{$path:"../fills"},{$path:"../strokes"}]}]}},fills:{$palette:"fills"},strokes:{$palette:"strokes"},defaultColorRange:{$palette:"gradients"},defaultPatternFills:mD,fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,shadow:{enabled:!1,color:Wl,xOffset:3,yOffset:3,blur:5}},legend:{enabled:!0}},wre={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"pie",moduleFactory:e=>new rb(e),tooltipDefaults:{range:"exact"},themeTemplate:Dre},Are={type:"series",name:"pie",chartType:"polar",options:Rh,create:e=>new rb(e)};function JD(){kr.register(rO,Dae,Vne,Jae,eF,dre,lF,mre,Cre,wre,pre);for(const e of[No,Gl,Ma,Mh,wu,Vl])ph.register(e.type,{moduleFactory:t=>new e(t)})}function Ire(){for(const e of kr.modules){if(e.packageType==="enterprise"&&!cse(e)&&se.errorOnce("Unexpected enterprise module registered: "+e.identifier),e.type==="root"&&e.themeTemplate)for(const t of e.chartTypes)bM.set(t,e.themeTemplate);if(e.type==="series"){if(e.chartTypes.length>1)throw new Error(`AG Charts - Module definition error: ${e.identifier}`);xa.register(e.identifier,e)}if(e.type==="series-option"&&e.themeTemplate)for(const t of e.seriesTypes)xa.setThemeTemplate(t,e.themeTemplate);if(e.type==="axis-option"&&e.themeTemplate)for(const t of e.axisTypes){const i=ph.getThemeTemplate(t),s=Je(e.themeTemplate,i);ph.setThemeTemplate(t,s)}e.type==="axis"&&ph.register(e.identifier,e),e.type==="legend"&&vM.register(e.identifier,e)}if(kr.hasEnterpriseModules()){const e=hse();e.length>0&&se.errorOnce("Enterprise modules expected but not registered: ",e)}}var ew=["bar","line","scatter"],Tre=void 0,kre=void 0;kre=Tre;var Lre=void 0,Pre=void 0;Pre=Lre;var SF=(e=>(e.POINTER="pointer",e.NODE="node",e.CHART="chart",e))(SF||{}),MF=(e=>(e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.LEFT="left",e.TOP_RIGHT="top-right",e.BOTTOM_RIGHT="bottom-right",e.BOTTOM_LEFT="bottom-left",e.TOP_LEFT="top-left",e.CENTER="center",e))(MF||{}),DF=(e=>(e.POINTER="pointer",e.NODE="node",e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.LEFT="left",e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.BOTTOM_RIGHT="bottom-right",e.BOTTOM_LEFT="bottom-left",e))(DF||{}),Ere=void 0,Rre=void 0;Rre=Ere;var Nre=void 0,Ore=void 0;Ore=Nre;var Tn=Symbol("IGNORED_PROP");function Ia(e,t){const i={};for(const s of Object.keys(t)){const n=t[s];n!==Tn&&Object.hasOwn(e,s)&&(i[s]=n)}return i}function wF(e){const g=e,{enabled:t,mode:i,showArrow:s,range:n,position:a,pagination:r,delay:o,wrapping:l,interaction:c,renderer:h}=g,d=We(g,["enabled","mode","showArrow","range","position","pagination","delay","wrapping","interaction","renderer"]),u=Ia(e,b({enabled:t,showArrow:s,range:n,position:a,interaction:c,renderer:h},d));return{chartTooltipOptions:Ia(e,b({enabled:Tn,showArrow:Tn,range:Tn,position:Tn,mode:i,pagination:r,delay:o,wrapping:l},d)),seriesTooltipOptions:u}}function Fre(e){const ae=e,{animation:t,background:i,container:s,contextMenu:n,footnote:a,height:r,listeners:o,locale:l,minHeight:c,minWidth:h,overrideDevicePixelRatio:d,padding:u,subtitle:p,theme:g,title:f,width:y,type:v,cursor:x,nodeClickRange:S,tooltip:M={},value:D,scale:A={},startAngle:w,endAngle:T,highlightStyle:k,segmentation:N,bar:O,needle:L,targets:F,outerRadius:B,innerRadius:_,outerRadiusRatio:G,innerRadiusRatio:V,cornerRadius:j,cornerMode:H,label:U,secondaryLabel:$,spacing:W}=ae,Y=We(ae,["animation","background","container","contextMenu","footnote","height","listeners","locale","minHeight","minWidth","overrideDevicePixelRatio","padding","subtitle","theme","title","width","type","cursor","nodeClickRange","tooltip","value","scale","startAngle","endAngle","highlightStyle","segmentation","bar","needle","targets","outerRadius","innerRadius","outerRadiusRatio","innerRadiusRatio","cornerRadius","cornerMode","label","secondaryLabel","spacing"]),{chartTooltipOptions:K,seriesTooltipOptions:Q}=wF(M),Z=Ia(e,{animation:t,background:i,container:s,contextMenu:n,footnote:a,height:r,listeners:o,locale:l,minHeight:c,minWidth:h,overrideDevicePixelRatio:d,padding:u,subtitle:p,theme:g,title:f,tooltip:K,width:y}),J=Ia(e,b({needle:L!=null?b({enabled:!0},L):Tn,startAngle:w,endAngle:T,scale:A,type:v,cursor:x,nodeClickRange:S,tooltip:Q,value:D,highlightStyle:k,segmentation:N,bar:O,targets:F,outerRadius:B,innerRadius:_,outerRadiusRatio:G,innerRadiusRatio:V,cornerRadius:j,cornerMode:H,label:U,secondaryLabel:$,spacing:W},Y));return"context"in e&&(Z.context=e.context),E(b({},Z),{series:[J]})}function Bre(e){const $=e,{animation:t,background:i,container:s,contextMenu:n,footnote:a,height:r,listeners:o,locale:l,minHeight:c,minWidth:h,overrideDevicePixelRatio:d,padding:u,subtitle:p,theme:g,title:f,width:y,type:v,cursor:x,nodeClickRange:S,tooltip:M={},value:D,scale:A={},direction:w="vertical",thickness:T,highlightStyle:k,segmentation:N,bar:O,targets:L,cornerRadius:F,cornerMode:B,label:_}=$,G=We($,["animation","background","container","contextMenu","footnote","height","listeners","locale","minHeight","minWidth","overrideDevicePixelRatio","padding","subtitle","theme","title","width","type","cursor","nodeClickRange","tooltip","value","scale","direction","thickness","highlightStyle","segmentation","bar","targets","cornerRadius","cornerMode","label"]),{chartTooltipOptions:V,seriesTooltipOptions:j}=wF(M),H=Ia(e,{animation:t,background:i,container:s,contextMenu:n,footnote:a,height:r,listeners:o,locale:l,minHeight:c,minWidth:h,overrideDevicePixelRatio:d,padding:u,subtitle:p,theme:g,title:f,tooltip:V,width:y}),U=Ia(e,b({scale:A,type:v,cursor:x,nodeClickRange:S,tooltip:j,value:D,direction:w,thickness:T,highlightStyle:k,segmentation:N,bar:O,targets:L,cornerRadius:F,cornerMode:B,label:_},G));return"context"in e&&(H.context=e.context),E(b({},H),{series:[U]})}function AF(e,t){if(t==null)return e;const n=t,{targets:i}=n,s=We(n,["targets"]);return e=Je(e,s),e.targets!=null&&i!=null&&(e.targets=Iy(e.targets,i)),e}function _re(e,t){if(e.listeners){const i=e.listeners,{nodeClick:s,nodeDoubleClick:n}=i,a=We(i,["nodeClick","nodeDoubleClick"]);e=E(b({},e),{listeners:b({seriesNodeClick:s,seriesNodeDoubleClick:n},a)})}switch(e.type){case"radial-gauge":const s=AF(e,t);return Fre(s);case"linear-gauge":const n=AF(e,t);return Bre(n);default:return{}}}var Tf={fills:Pt(jd(2),Ie(es({color:ye,stop:ne},"")),pE),fillMode:ce("continuous","discrete")},ob=b(b(b({value:ee(ne),text:z,shape:Ne(ce("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),ft),placement:ce("before","after","middle"),spacing:X,size:X,rotation:ne},xe),ge),De),lb=b(b(b({value:ee(ne),text:z,shape:Ne(ce("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),ft),placement:ce("inside","outside","middle"),spacing:X,size:X,rotation:ne,label:E(b({},bt),{spacing:X})},xe),ge),De),cb=b({direction:ce("horizontal","vertical"),cornerMode:ce("container","item"),cornerRadius:X,thickness:X,segmentation:{enabled:q,spacing:X,interval:{values:Ie(ne),step:ne,count:ne}},bar:b(b(b(b({enabled:q,thickness:X,thicknessRatio:Me},Tf),xe),ge),De),label:E(b({},ec),{text:z,spacing:X,avoidCollisions:q,placement:ce("inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end")}),tooltip:nt},be(it,["listeners"])),ic=E(b(b({},cb),be(Jn,["listeners"])),{type:ee(Oe("linear-gauge")),value:ee(ne),scale:b(b(b(b({min:Pt(ne,Ar("max")),max:Pt(ne,Il("min")),label:b({enabled:q,formatter:ft,rotation:ne,spacing:X,minSpacing:X,placement:ce("before","after"),avoidCollisions:q,format:Zl},It),interval:{values:Ie(ne),step:ne}},Tf),xe),ge),De),targets:Li(ob,"target options array")});ic.margin=Ce(ne),ic.defaultColorRange=Ce(Ie(ye)),ic.defaultTarget=Ce(E(b({},ob),{value:ne,label:E(b({},bt),{spacing:ne})})),ic.defaultScale=Ce(ic.scale),ic.scale.defaultFill=Ce(ye);var hb=b({outerRadius:X,innerRadius:X,outerRadiusRatio:Me,innerRadiusRatio:Me,startAngle:ne,endAngle:ne,spacing:X,cornerMode:ce("container","item"),cornerRadius:X,scale:b(b(b(b({min:Pt(ne,Ar("max")),max:Pt(ne,Il("min")),label:b({enabled:q,formatter:ft,rotation:ne,spacing:X,minSpacing:X,avoidCollisions:q,format:Zl},It),interval:{values:Ie(ne),step:ne}},Tf),xe),ge),De),segmentation:{enabled:q,spacing:X,interval:{values:Ie(ne),step:ne,count:ne}},bar:b(b(b(b({enabled:q},Tf),xe),ge),De),needle:b(b(b({enabled:q,spacing:X,radiusRatio:Me},xe),ge),De),label:b({text:z,spacing:X},ec),secondaryLabel:b({text:z},ec),tooltip:nt},it),kf=E(b(b({},hb),Jn),{type:ee(Oe("radial-gauge")),value:ee(ne),targets:Li(lb,"target options array")});kf.defaultColorRange=Ce(Ie(ye)),kf.defaultTarget=Ce(E(b({},lb),{value:ne,label:E(b({},bt),{spacing:ne})})),kf.scale.defaultFill=Ce(ye);var Ta={stroke:li},ws={fill:Jg},IF={color:"white",fill:li},jo={color:li},Nh={color:Qg,fontSize:{$rem:[1.1666666666666667]},fontFamily:{$ref:"fontFamily"}},tw=E(b({},Nh),{fontSize:{$ref:"fontSize"},color:sf,fill:ef,stroke:tf,strokeWidth:1,divider:{stroke:nf,strokeWidth:1,strokeOpacity:.5}}),iw=E(b({},Ta),{background:{fill:Wi,fillOpacity:.2},handle:b({},ws),text:b({},jo),statistics:b({},tw)}),Gre={line:E(b({},Ta),{handle:b({},ws),text:b({},jo)}),"horizontal-line":E(b({},Ta),{handle:b({},ws),axisLabel:b({},IF),text:b({},jo)}),"vertical-line":E(b({},Ta),{handle:b({},ws),axisLabel:b({},IF),text:b({},jo)}),"disjoint-channel":E(b({},Ta),{background:{fill:Wi,fillOpacity:.2},handle:b({},ws),text:b({},jo)}),"parallel-channel":E(b({},Ta),{background:{fill:Wi,fillOpacity:.2},handle:b({},ws),text:b({},jo)}),"fibonacci-retracement":E(b({},Ta),{strokes:qg,rangeStroke:li,handle:b({},ws),text:E(b({},jo),{position:"center"}),label:E(b({},Nh),{color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}})}),"fibonacci-retracement-trend-based":E(b({},Ta),{strokes:qg,rangeStroke:li,handle:b({},ws),text:E(b({},jo),{position:"center"}),label:E(b({},Nh),{color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}})}),callout:E(b(b({},Ta),Nh),{color:{$ref:"textColor"},handle:b({},ws),fill:Wi,fillOpacity:.2}),comment:E(b({},Nh),{color:"white",fontWeight:700,handle:b({},ws),fill:li}),note:E(b({},Nh),{color:cf,fill:li,stroke:{$ref:"backgroundColor"},strokeWidth:1,strokeOpacity:1,handle:b({},ws),background:{fill:of,stroke:lf,strokeWidth:1}}),text:E(b({},Nh),{handle:b({},ws)}),arrow:E(b({},Ta),{handle:b({},ws),text:b({},jo)}),"arrow-up":{fill:{$palette:"up.fill"},handle:E(b({},ws),{stroke:li})},"arrow-down":{fill:{$palette:"down.fill"},handle:E(b({},ws),{stroke:li})},"date-range":b({},iw),"price-range":b({},iw),"date-price-range":b({},iw),"quick-date-price-range":{up:E(b({},Ta),{fill:Wi,fillOpacity:.2,handle:b({},ws),statistics:E(b({},tw),{color:"#fff",fill:Wi,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}})}),down:E(b({},Ta),{stroke:rf,fill:af,fillOpacity:.2,handle:E(b({},ws),{stroke:rf}),statistics:E(b({},tw),{color:"#fff",fill:af,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}})})},axesButtons:{enabled:!0}},zre=["ohlc","line","step-line","hlc","high-low","candlestick","hollow-candlestick"],Vre=[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"fibonacci-retracement-drawing",tooltip:"toolbarAnnotationsFibonacciAnnotations",value:"fibonacci-menu"},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"measurer-drawing",tooltip:"toolbarAnnotationsMeasurerAnnotations",value:"measurer-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}];function jre(e,t,i){const B=e,{dateKey:s="date",highKey:n="high",openKey:a="open",lowKey:r="low",closeKey:o="close",volumeKey:l="volume",chartType:c="candlestick",navigator:h=!1,volume:d=!0,rangeButtons:u=!0,statusBar:p=!0,toolbar:g=!0,zoom:f=!0,sync:y=!1,theme:v,data:x}=B,S=We(B,["dateKey","highKey","openKey","lowKey","closeKey","volumeKey","chartType","navigator","volume","rangeButtons","statusBar","toolbar","zoom","sync","theme","data"]),M=Wre(c,s,n,r,a,o),D=Hre(i,a,o,d,l),w={navigator:b({enabled:h},d?{miniChart:{enabled:h,series:[{type:"line",xKey:s,yKey:l,stroke:Tv,marker:{enabled:!1}}]},height:40,minHandle:{height:46},maxHandle:{height:46}}:null)},T={annotations:{enabled:g,optionsToolbar:{enabled:g},snap:!0,toolbar:{enabled:g,buttons:Vre,padding:0},data:x,xKey:s,volumeKey:d?l:void 0}},k=p?{statusBar:{enabled:!0,data:x,highKey:n,openKey:a,lowKey:r,closeKey:o,volumeKey:d?l:void 0}}:null,N={zoom:{enabled:f,autoScaling:{enabled:!0},enableIndependentAxes:!0}},O={ranges:{enabled:u}},L=y?{sync:{enabled:y,nodeInteraction:!0,zoom:!0}}:null,F=d?[{type:"number",position:"left",keys:[l],label:{enabled:!1},crosshair:{enabled:!1},gridLine:{enabled:!1},nice:!1,layoutConstraints:{stacked:!1,width:20,unit:"percent",align:"end"}}]:[];return b(b(b(b(b(b(b({theme:b({baseTheme:typeof v=="string"?v:"ag-financial"},Je(typeof v=="object"?v:null,{overrides:{common:{title:{padding:4},padding:{top:6,right:8,bottom:5},chartToolbar:{enabled:g},annotations:b({},Gre),axes:{number:{interval:{maxSpacing:45},label:{format:".2f"}}}},bar:{series:{fillOpacity:.5}},line:{series:b({marker:{enabled:!1}},LF(c,{hlc:{stroke:{$palette:"altNeutral.stroke"},strokeWidth:2},line:{stroke:{$palette:"neutral.stroke"}},"step-line":{stroke:{$palette:"neutral.stroke"},interpolation:{type:"step"}}}))},candlestick:{series:b({},LF(c,{"hollow-candlestick":{item:{up:{fill:"transparent"}}}}))},"range-area":{series:{fillOpacity:.3,strokeWidth:2}}}})),animation:{enabled:!1},legend:{enabled:!1},series:[...D,...M],axes:[{type:"number",position:"right",keys:[a,o,n,r],crosshair:{enabled:!0,snap:!1},layoutConstraints:{stacked:!1,width:100,unit:"percent",align:"start"}},...F,{type:"ordinal-time",position:"bottom",line:{enabled:!1},label:{enabled:!0},crosshair:{enabled:!0}}],tooltip:{enabled:!1},data:x},T),w),k),N),O),L),S)}function Hre(e,t,i,s,n){return s?[{type:"bar",xKey:"date",yKey:n,tooltip:{enabled:!1},itemStyler({datum:a}){const{up:r,down:o}=e().palette;return{fill:a[t]<a[i]?r==null?void 0:r.fill:o==null?void 0:o.fill}},focusPriority:1,fastDataProcessing:!0,highlight:{enabled:!1}}]:[]}var TF="range-area";function Wre(e,t,i,s,n,a){const r={xKey:t,openKey:n,closeKey:a,highKey:i,lowKey:s},o={xKey:t,yKey:a},l={pickOutsideVisibleMinorAxis:!0};switch(e!=null?e:"candlestick"){case"ohlc":return Ure(l,r);case"line":case"step-line":return Kre(l,o);case"hlc":return $re(l,o,r);case"high-low":return Yre(l,r);case"candlestick":case"hollow-candlestick":return kF(l,r);default:return se.warnOnce(`unknown chart type: ${e}; expected one of: ${zre.join(", ")}`),kF(l,r)}}function Ure(e,t){return[b(b({type:"ohlc",focusPriority:0},e),t)]}function Kre(e,t){return[b(b({type:"line",focusPriority:0},e),t)]}function $re(e,t,{xKey:i,highKey:s,closeKey:n,lowKey:a}){return[E(b({type:TF,focusPriority:0},e),{xKey:i,yHighKey:s,yLowKey:n,fill:Sv,stroke:xv}),E(b({type:TF,focusPriority:0},e),{xKey:i,yHighKey:n,yLowKey:a,fill:Mv,stroke:Cv}),b(b({type:"line"},e),t)]}function Yre(e,{xKey:t,highKey:i,lowKey:s}){return[E(b({type:"range-bar"},e),{xKey:t,yHighKey:i,yLowKey:s,fill:wv,stroke:Dv,tooltip:{range:"nearest"},focusPriority:0,fastDataProcessing:!0})]}function kF(e,t){return[b(b({type:"candlestick",focusPriority:0},e),t)]}function LF(e,t){var i;return(i=t[e])!=null?i:t.default}var PF={title:{enabled:!1},label:{enabled:!1},line:{enabled:!1},gridLine:{enabled:!1},crosshair:{enabled:!1,stroke:Iv,lineDash:[0],label:{enabled:!1}}},sw=E(b({},PF),{nice:!1}),db={mode:"compact",position:{anchorTo:"node",placement:["right","left"]},showArrow:!1},nw={style:[{stroke:{$ref:"gridLineColor"}}],width:2},Xre={number:{gridLine:nw},time:{gridLine:nw},category:{gridLine:nw}},Zre={overrides:{common:{animation:{enabled:!1},contextMenu:{enabled:!1},keyboard:{enabled:!1},background:{visible:!1},navigator:{enabled:!1},padding:{top:0,right:0,bottom:0,left:0},axes:{number:E(b({},sw),{interval:{values:[0]}}),log:b({},sw),time:b({},sw),category:b({},PF)}},bar:{series:{crisp:!1,label:{placement:"inside-end",padding:4},sparklineMode:!0},tooltip:E(b({},db),{position:E(b({},db.position),{anchorTo:"pointer"}),range:"nearest"}),axes:Xre},line:{seriesArea:{padding:{top:2,right:2,bottom:2,left:2}},series:{sparklineMode:!0,strokeWidth:1,marker:{enabled:!1,size:3}},tooltip:db},area:{seriesArea:{padding:{top:1,right:0,bottom:1,left:0}},series:{strokeWidth:1,fillOpacity:.4},tooltip:db}}},EF=fn(qre);function qre(e,t){return typeof e=="string"?E(b({},t),{baseTheme:e}):e!=null?E(b({},e),{baseTheme:EF(e.baseTheme,t)}):t}function RF(e){if(Array.isArray(e)&&e.length!==0){const t=e[0];if(typeof t=="number")return{data:e.map((s,n)=>({x:n,y:s})),series:[{xKey:"x",yKey:"y"}],datumKey:"y"};if(Array.isArray(t))return{data:e.map(s=>({x:s[0],y:s[1],datum:s})),series:[{xKey:"x",yKey:"y"}],datumKey:"datum"}}return{data:e}}function Qre(e){switch(e==null?void 0:e.type){case"number":{const{type:n,min:a,max:r,reverse:o}=e;return Ia(e,{type:n,reverse:o,min:a,max:r})}case"time":{const{type:n,min:a,max:r,reverse:o}=e;return Ia(e,{type:n,reverse:o,min:a,max:r})}case"category":default:const{paddingInner:t,paddingOuter:i,reverse:s}=e!=null?e:{};return Ia(E(b({},e),{type:"category"}),{type:"category",reverse:s,paddingInner:t,paddingOuter:i})}}function Jre(e,t,i){var n,a,r,o;const s={};return(e==null?void 0:e.stroke)!=null&&(s.style=[{stroke:e==null?void 0:e.stroke}],(n=s.enabled)!=null||(s.enabled=!0)),(e==null?void 0:e.strokeWidth)!=null&&(s.width=e==null?void 0:e.strokeWidth,(a=s.enabled)!=null||(s.enabled=!0)),i.type==="bar"&&i.direction!=="horizontal"&&((r=s.enabled)!=null||(s.enabled=!0)),(e==null?void 0:e.visible)!=null&&(s.enabled=e.visible),(o=s.enabled)!=null||(s.enabled=t),s}var eoe=fn((e,t,i)=>s=>{var c,h;const n=s.datum[s.xKey],a=s.datum[s.yKey],r=i!=null?s.datum[i]:s.datum,o=(c=t==null?void 0:t.renderer)==null?void 0:c.call(t,{context:e,datum:r,xValue:n,yValue:a});if(typeof o=="string")return o;const l=(h=o==null?void 0:o.content)!=null?h:a.toFixed(2);return o!=null&&o.title?{heading:void 0,title:void 0,data:[{label:o.title,value:l}]}:{heading:void 0,title:l,data:[]}});function toe(e){const _=e,{background:t,container:i,height:s,listeners:n,locale:a,minHeight:r,minWidth:o,overrideDevicePixelRatio:l,padding:c,width:h,theme:d,data:u,crosshair:p,axis:g,min:f,max:y,tooltip:v,context:x,styleNonce:S}=_,M=We(_,["background","container","height","listeners","locale","minHeight","minWidth","overrideDevicePixelRatio","padding","width","theme","data","crosshair","axis","min","max","tooltip","context","styleNonce"]),D=Ia(e,{background:t,container:i,height:s,listeners:n,locale:a,minHeight:r,minWidth:o,overrideDevicePixelRatio:l,padding:c,width:h,styleNonce:S,tooltip:Tn,context:Tn,data:Tn,crosshair:Tn,axis:Tn,min:Tn,max:Tn,theme:Tn}),{data:A,series:[w]=[],datumKey:T}=RF(u),k=M;w!=null&&Object.assign(k,w),k.tooltip=E(b({},v),{renderer:eoe(x,v,T)}),D.theme=EF(d,Zre),D.data=A,D.series=[k];const N=k.type!=="bar"||k.direction!=="horizontal",[O,L]=N?["bottom","left"]:["left","bottom"],F=b(E(b({},Qre(g)),{position:O}),Ia(e,{crosshair:p})),B=b({type:"number",gridLine:Jre(g,!1,e),position:L},Ia(e,{min:f,max:y}));return D.axes=N?[B,F]:[F,B],D}var ioe={chartType:ce("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),dateKey:z,openKey:z,highKey:z,lowKey:z,closeKey:z,volumeKey:z,navigator:q,volume:q,rangeButtons:q,statusBar:q,toolbar:q,zoom:q,sync:q,theme:_e,container:_e,width:_e,height:_e,minWidth:_e,minHeight:_e,listeners:_e,initialState:_e,title:_e,data:hn},aw={theme:_e,container:_e,animation:_e,background:_e,contextMenu:_e,listeners:_e,locale:_e,width:_e,height:_e,minWidth:_e,minHeight:_e,title:_e,subtitle:_e,footnote:_e,padding:_e,tooltip:b(b({},nt),Pe.tooltip)};aw.overrideDevicePixelRatio=Ce(X);var rw=["showInLegend","showInMiniChart","grouped","stacked","stackGroup","tooltip","listeners","errorBar","xKey","yKey","type"],ow={visible:q,reverse:q,stroke:ye,strokeWidth:X},lw={context:_e,tooltip:_e,theme:_e,background:_e,container:_e,width:_e,height:_e,minWidth:_e,minHeight:_e,padding:_e,listeners:_e,locale:_e,data:_e,styleNonce:z,axis:th({number:E(b({},ow),{min:Pt(ne,Ar("max")),max:Pt(ne,Il("min"))}),category:E(b({},ow),{paddingInner:Me,paddingOuter:Me}),time:E(b({},ow),{min:Pt(Ne(ne,wr),Ar("max")),max:Pt(Ne(ne,wr),Il("min"))})},"axis options","category"),min:Pt(ne,Ar("max")),max:Pt(ne,Il("min")),crosshair:b(b({enabled:q,snap:q},ge),De),xKey:z,yKey:z},soe={type:"preset",name:"price-volume",enterprise:!0,options:ioe,create:jre},noe={type:"preset",name:"gauge-preset",enterprise:!0,options:th({"linear-gauge":b(b({},be(ic,["type"])),aw),"radial-gauge":b(b({},be(kf,["type"])),aw)},"gauge options"),create:_re},aoe={type:"preset",name:"sparkline",options:th({area:b(b({},lw),be($O,rw)),bar:b(b({},lw),be(Af,rw)),line:b(b({},lw),be(Zv,rw))},"sparkline options"),create:toe,processData:RF},roe=["top","right","bottom","left"],ub=class Gj extends dv{constructor(t,i){super(t,i),this.paired=!0,this.lastUpdateClipRect=void 0,this.lastLayoutWidth=NaN,this.lastLayoutHeight=NaN}onAxisChange(t,i){super.onAxisChange(t,i),this.syncAxisChanges(t,i),this.ctx!=null&&this.ctx.zoomManager.updateAxes(t)}destroySeries(t){super.destroySeries(t),this.lastLayoutWidth=NaN,this.lastLayoutHeight=NaN}getChartType(){return"cartesian"}setRootClipRects(t){const{seriesRoot:i,annotationRoot:s}=this;i.setClipRect(t),s.setClipRect(t)}async processData(){await super.processData(),this.syncStatus==="init"&&(this.syncStatus="domains-calculated"),this.ctx.updateService.dispatchProcessData({series:{shouldFlipXY:this.shouldFlipXY()}})}async processDomains(){await super.processDomains();for(const t of this.axes){const i=await this.getSyncedDomain(t);i!=null&&t.setDomains(i)}}performLayout(t){const{seriesRoot:i,annotationRoot:s}=this,{clipSeries:n,seriesRect:a,visible:r}=this.updateAxes(t.layoutBox);this.seriesRoot.visible=r,this.seriesRect=a,this.animationRect=t.layoutBox;const{x:o,y:l}=a;if(t.width!==this.lastLayoutWidth||t.height!==this.lastLayoutHeight)for(const u of[i,s])u.translationX=Math.floor(o),u.translationY=Math.floor(l);else{const{translationX:u,translationY:p}=i;ko(this.id,"seriesRect",this.ctx.animationManager,[i,s],{translationX:u,translationY:p},{translationX:Math.floor(o),translationY:Math.floor(l)},{phase:"update"})}this.lastLayoutWidth=t.width,this.lastLayoutHeight=t.height;const c=a.clone().grow(this.seriesArea.padding),h=this.seriesArea.clip||n?c:void 0,{lastUpdateClipRect:d}=this;this.lastUpdateClipRect=h,this.ctx.animationManager.isActive()&&d!=null?this.ctx.animationManager.animate({id:this.id,groupId:"clip-rect",phase:"update",from:d,to:c,onUpdate:u=>this.setRootClipRects(u),onComplete:()=>this.setRootClipRects(h)}):this.setRootClipRects(h),this.ctx.layoutManager.emitLayoutComplete(t,{axes:this.axes.map(u=>u.getLayoutState()),series:{visible:r,rect:a,paddedRect:c},clipSeries:n})}updateAxes(t){const{clipSeries:i,seriesRect:s,overflows:n}=this.resolveAxesLayout(t);for(const a of this.axes)a.update(),a.setCrossLinesVisible(!n),this.clipAxis(a,s,t);return{clipSeries:i,seriesRect:s,visible:!n}}resolveAxesLayout(t){let i,s,n=0;const a=10;do if(s=i!=null?i:this.getDefaultState(),i=this.updateAxesPass(new Map(s.axisAreaWidths),t.clone()),n++>a){se.warn("Max iterations reached. Unable to stabilize axes layout.");break}while(!this.isLayoutStable(i,s));return this.lastAreaWidths=i.axisAreaWidths,i}updateAxesPass(t,i){var S,M,D,A,w,T,k,N;const s=new Map,n={};let a=!1,r=!1;for(const O of roe){const L=this.seriesArea.padding[O],F=this.axes.findLast(B=>B.position===O);F?F.seriesAreaPadding=L:i.shrink(L,O)}const o=((S=t.get("left"))!=null?S:0)+((M=t.get("right"))!=null?M:0),l=((D=t.get("top"))!=null?D:0)+((A=t.get("bottom"))!=null?A:0),c=this.buildCrossLinePadding(t),h=c.left+c.right,d=c.top+c.bottom;i.width<=o+h||i.height<=l+d?a=!0:i.shrink(c);const u=i.clone().shrink(Object.fromEntries(t));for(const O of this.axes){const{position:L="left",direction:F}=O;this.sizeAxis(O,u,L);const B=F==="y",{primaryTickCount:_,bbox:G}=O.calculateLayout(O.nice?n[F]:void 0,this.padding);(w=n[F])!=null||(n[F]=_),r||(r=O.dataDomain.clipped||O.visibleRange[0]>0||O.visibleRange[1]<1),s.set(O.id,Math.ceil((k=(T=O.thickness)!=null?T:B?G==null?void 0:G.width:G==null?void 0:G.height)!=null?k:0))}const p=r0(this.axes,O=>{var L;return(L=O.position)!=null?L:"left"}),{width:g,height:f,pixelRatio:y}=this.ctx.scene,v=new Map,x=new Map;for(const[O,L]of Zt(p)){let B=O==="left"||O==="right"?f%y:g%y,_=0;for(const G of L!=null?L:[]){x.set(G.id,B);const V=(N=s.get(G.id))!=null?N:0;_=Math.max(_,B+V),G.layoutConstraints.stacked&&(B+=V+Gj.AxesPadding)}v.set(O,Math.ceil(_))}for(const[O,L]of Zt(p))this.positionAxes({axes:L!=null?L:[],position:O,axisWidths:s,axisOffsets:x,axisAreaWidths:v,axisBound:i,seriesRect:u});return{clipSeries:r,seriesRect:u,axisAreaWidths:v,overflows:a}}buildCrossLinePadding(t){var s;const i={top:0,right:0,bottom:0,left:0};this.axes.forEach(n=>{var o;const{position:a,label:r}=n;(o=n.crossLines)==null||o.forEach(l=>{var h,d;var c;l instanceof pn&&(l.position=a!=null?a:"top",(h=(c=l.label).parallel)!=null||(c.parallel=r.parallel)),(d=l.calculatePadding)==null||d.call(l,i)})});for(const[n,a=0]of Zt(i))i[n]=Math.max(a-((s=t.get(n))!=null?s:0),0);return i}clampToOutsideSeriesRect(t,i,s,n){const a=s==="x"?t.x:t.y,r=s==="x"?t.width:t.height;return n===1?Math.min(i,a+r):Math.max(i,a)}async getSyncedDomain(t){const i=this.modulesManager.getModule("sync");if(i!=null&&i.enabled)return await i.getSyncedDomain(t)}syncAxisChanges(t,i){const s=this.modulesManager.getModule("sync");if(!(s!=null&&s.enabled))return;const n=new Set(i!=null?i:[]);for(const a of t)n.delete(a);for(const a of n)s.removeAxis(a)}sizeAxis(t,i,s){const n=t instanceof Gl,a=s==="left"||s==="right",{width:r,height:o}=i,l=a?o:r;let c=0,h=l,{min:d,max:u}=this.ctx.zoomManager.getAxisZoom(t.id);const{width:p,unit:g,align:f}=t.layoutConstraints;g==="px"?h=c+p:h=h*p/100,f==="end"&&(c=l-(h-c),h=l),a&&(n?[d,u]=[1-u,1-d]:[c,h]=[h,c]),t.range=[c,h],t.visibleRange=[d,u],t.gridLength=a?r:o}positionAxes(t){var g,f,y,v;const{axes:i,axisBound:s,axisWidths:n,axisOffsets:a,axisAreaWidths:r,seriesRect:o,position:l}=t,c=(g=r.get(l))!=null?g:0;let h="x",d="y",u=1;(l==="top"||l==="bottom")&&(h="y",d="x");let p=s[h];(l==="right"||l==="bottom")&&(u=-1,p+=h==="x"?s.width:s.height);for(const x of i){const S=(f=r.get(d==="x"?"left":"top"))!=null?f:0,M=(y=n.get(x.id))!=null?y:0,D=(v=a.get(x.id))!=null?v:0;x.gridPadding=c-D-M,x.translation[d]=s[d]+S,x.translation[h]=this.clampToOutsideSeriesRect(o,p+u*(D+M),h,u)}}shouldFlipXY(){return this.series.every(t=>t instanceof Xl&&t.shouldFlipXY())}getDefaultState(){const t=new Map;if(this.lastAreaWidths)for(const{position:i="left"}of this.axes){const s=this.lastAreaWidths.get(i);s!=null&&t.set(i,s)}return{axisAreaWidths:t,clipSeries:!1,overflows:!1}}isLayoutStable(t,i){if(i.overflows!==t.overflows||i.clipSeries!==t.clipSeries)return!1;for(const s of t.axisAreaWidths.keys())if(!i.axisAreaWidths.has(s))return!1;for(const[s,n]of i.axisAreaWidths.entries()){const a=t.axisAreaWidths.get(s);if((n!=null||a!=null)&&n!==a)return!1}return!0}clipAxis(t,i,s){var l,c,h,d;const n=Math.ceil((c=(l=t.gridLine)==null?void 0:l.width)!=null?c:0),a=Math.ceil((d=(h=t.line)==null?void 0:h.width)!=null?d:0);let{width:r,height:o}=i;switch(r+=t.direction==="x"?n:a,o+=t.direction==="y"?n:a,t.clipGrid(i.x,i.y,r,o),t.position){case"left":case"right":t.clipTickLines(s.x,i.y-n,s.width+n,i.height+n*2);break;case"top":case"bottom":t.clipTickLines(i.x-n,s.y,i.width+n*2,s.height+n);break}}};ub.className="CartesianChart",ub.type="cartesian",ub.AxesPadding=15;var ooe=ub,Oh={mode:Ce(ce("integrated","standalone")),container:oE,theme:_e,series:hn,annotations:_e,navigator:_e,initialState:{chartType:z,annotations:_e,legend:Li({visible:q,seriesId:z,itemId:z,legendItemName:z},"legend state array"),zoom:_e}},NF=E(b(b({},Pe),Oh),{axes:_e,data:hn}),OF=E(b(b({},Pe),Oh),{axes:_e,data:hn}),loe=E(b(b({},Pe),Oh),{data:hn,topology:Kd}),coe=E(b(b({},Pe),Oh),{data:hn}),hoe=E(b(b({},Pe),Oh),{data:hn}),doe=E(b(b({},Pe),Oh),{data:hn,nodes:hn}),uoe=E(b(b({},Pe),Oh),{data:hn}),poe=new Set(["number","log","time"]),goe=e=>Ve(e)&&!poe.has(e.type),foe={type:"chart",name:"cartesian",options:NF,detect:VM,create(e,t){return new ooe(e,t)},validate(e,t,i){var a,r,o;const s=[];((r=(a=e==null?void 0:e.series)==null?void 0:a[0])==null?void 0:r.type)==="histogram"&&(o=e==null?void 0:e.axes)!=null&&o.some(goe)&&(s.push(new eh("invalid","only continuous axis types when histogram series is used",e.axes,i,"axes")),e=be(e,["axes"]));const n=js(e,t,i);return n.invalid.push(...s),n}},Lf=()=>{throw new Error("Enterprise module placeholder cannot be initialised")},moe={type:"chart",name:"flow-proportion",placeholder:!0,options:{},detect:p1,create:Lf},yoe={type:"chart",name:"gauge",placeholder:!0,options:{},detect:HM,create:Lf},voe={type:"chart",name:"hierarchy",placeholder:!0,options:{},detect:d1,create:Lf},boe={type:"chart",name:"standalone",placeholder:!0,options:{},detect:jM,create:Lf},xoe={type:"chart",name:"topology",placeholder:!0,options:{},detect:u1,create:Lf},Nu=class extends BM{constructor(){super(...arguments),this.shape="polygon",this.innerRadiusRatio=0,this.defaultTickMinSpacing=20}layoutCrossLines(){const e=this.label.getSideFlag(),t=this.isAnySeriesActive(),{rotation:i,parallelFlipRotation:s,regularFlipRotation:n}=this.calculateRotations();this.crossLines.forEach(a=>{var r;a.sideFlag=-e,a.direction=i===-Math.PI/2?"angle":"radius",a.parallelFlipRotation=s,a.regularFlipRotation=n,(r=a.calculateLayout)==null||r.call(a,t,this.reverse)})}updatePosition(){super.updatePosition();const e=Math.floor(this.translation.x),t=Math.floor(this.translation.y);this.tickLineGroup.translationX=e,this.tickLineGroup.translationY=t,this.tickLabelGroup.translationX=e,this.tickLabelGroup.translationY=t,this.crossLineRangeGroup.translationX=e,this.crossLineRangeGroup.translationY=t,this.crossLineLineGroup.translationX=e,this.crossLineLineGroup.translationY=t,this.crossLineLabelGroup.translationX=e,this.crossLineLabelGroup.translationY=t,this.tickLabelGroupSelection.each(lv())}computeLabelsBBox(e,t){return null}computeRange(){}getAxisLinePoints(){}};I([P],Nu.prototype,"shape",2),I([P],Nu.prototype,"innerRadiusRatio",2);var cw=class extends dv{constructor(e,t){super(e,t),this.padding=new El(40),this.ctx.axisManager.axisGroup.zIndex=6}getChartType(){return"polar"}async performLayout(e){const{layoutBox:t}=e;t.shrink(this.seriesArea.padding.toJson());const i=t.clone();this.seriesRect=i,this.animationRect=i,this.seriesRoot.translationX=i.x,this.seriesRoot.translationY=i.y,await this.computeCircle(i),this.axes.forEach(s=>s.update()),this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:i,paddedRect:i}})}updateAxes(e,t,i,s){var l,c;const n=this.axes.find(h=>h.direction==="angle"),a=this.axes.find(h=>h.direction==="radius");if(!(n instanceof Nu)||!(a instanceof Nu))return;const r=n.scale,o=a.innerRadiusRatio;n.innerRadiusRatio=o,n.computeRange(),n.gridLength=s,a.gridAngles=(c=(l=r.ticks({nice:n.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}))==null?void 0:l.ticks)==null?void 0:c.map(h=>r.convert(h)),a.gridRange=n.range,a.range=[s,s*o],[n,a].forEach(h=>{h.translation.x=e.x+t,h.translation.y=e.y+i,h.calculateLayout()})}async computeCircle(e){const t=this.series.filter(Coe),i=this.axes.filter(Soe),s=(c,h,d)=>{this.updateAxes(e,c,h,d),t.forEach(p=>{p.centerX=c,p.centerY=h,p.radius=d});const u=t.filter(p=>p.type==="donut"||p.type==="pie");if(u.length>1){const p=u.map(g=>{const f=g.getInnerRadius();return{series:g,innerRadius:f}}).sort((g,f)=>g.innerRadius-f.innerRadius);p.at(-1).series.surroundingRadius=void 0;for(let g=0;g<p.length-1;g++)p[g].series.surroundingRadius=p[g+1].innerRadius}},n=e.width/2,a=e.height/2,r=Math.max(0,Math.min(e.width,e.height)/2);let o=r;s(n,a,o);const l=async({hideWhenNecessary:c=!1}={})=>{const h=[];for(const p of ih(i,t)){const g=await p.computeLabelsBBox({hideWhenNecessary:c},e);g&&h.push(g)}if(h.length===0){s(n,a,r);return}const d=ve.merge(h),u=this.refineCircle(d,o,e);s(u.centerX,u.centerY,u.radius),o=u.radius};await l(),await l(),await l(),await l({hideWhenNecessary:!0}),await l({hideWhenNecessary:!0});for(const c of ih(i,t))await c.computeLabelsBBox({hideWhenNecessary:!0},e);return{radius:o,centerX:n,centerY:a}}refineCircle(e,t,i){const n=-t,a=-t,r=t,o=t;let l=Math.max(0,n-e.x),c=Math.max(0,a-e.y),h=Math.max(0,e.x+e.width-r),d=Math.max(0,e.y+e.height-o);l=h=Math.max(l,h),c=d=Math.max(c,d);const u=i.width-l-h,p=i.height-c-d;let g=Math.min(u,p)/2;const f=.5*i.width/2,y=.5*i.height/2,v=Math.min(f,y);if(g<v){g=v;const M=l+h,D=c+d;if(2*g+D>i.height){const A=i.height-2*g;Math.min(c,d)*2>A?(c=A/2,d=A/2):c>d?c=A-d:d=A-c}if(2*g+M>i.width){const A=i.width-2*g;Math.min(l,h)*2>A?(l=A/2,h=A/2):l>h?l=A-h:h=A-l}}const x=l+2*g+h,S=c+2*g+d;return{centerX:(i.width-x)/2+l+g,centerY:(i.height-S)/2+c+g,radius:g}}};cw.className="PolarChart",cw.type="polar";function Coe(e){return e instanceof sb}function Soe(e){return e instanceof Nu}var Moe={type:"chart",name:"polar",options:OF,detect:h1,create(e,t){return new cw(e,t)},validate(e,t,i){var r,o;const s=[],n=(o=(r=e==null?void 0:e.series)==null?void 0:r[0])==null?void 0:o.type;(n==="pie"||n==="donut")&&e!=null&&e.axes&&(s.push(new JS([],e.axes,i,"axes")),e=be(e,["axes"]));const a=js(e,t,i);return a.invalid.push(...s),a}},Ou=E(b(b({},zo),Jl(ne)),{type:ee(Oe("number")),label:ED,crosshair:Ql(!0)}),Fu=E(b(b({},zo),Jl(ne)),{type:ee(Oe("log")),base:Pt(e0,st(e=>e!==1,"not equal to 1")),label:ED,crosshair:Ql(!0)}),Ho=E(b(b({},zo),Jl(Ne(ne,wr),!0)),{type:ee(Oe("time")),label:xf,parentLevel:Gv,crosshair:Ql(!0)});Ho.paddingInner=X,Ho.paddingOuter=X,Ho.groupPaddingInner=X;var Bu=E(b({},zo),{type:ee(Oe("category")),label:bf,paddingInner:Me,paddingOuter:Me,groupPaddingInner:Me,crosshair:Ql()}),_u=E(b({},zo),{type:ee(Oe("grouped-category")),label:bf,crosshair:Ql(),paddingInner:Me,groupPaddingInner:Me,depthOptions:Li({label:b({enabled:q,avoidCollisions:q,rotation:ne,spacing:ne},It),tick:{enabled:q,stroke:ye,width:X}},"depth options objects array")}),Fh=E(b(b({},zo),Jl(Ne(ne,wr),!0)),{type:ee(Oe("unit-time")),unit:Ne(dE(ji),PD),label:xf,parentLevel:Gv,paddingInner:Me,paddingOuter:Me,groupPaddingInner:Me,crosshair:Ql(!0)}),FF=(e,t)=>{const i={};for(const s of new Set([...Object.keys(e),...Object.keys(t)])){const n=e[s],a=t[s];Lt(n)&&Lt(a)?i[s]=FF(n,a):n!=null&&a!=null&&n!==a?i[s]=Ne(n,a):i[s]=n!=null?n:a}return i},Doe=FF(Ho,Fh),woe={type:"axis",name:"number",chartType:"cartesian",options:Ou,create:e=>new No(e)},Aoe={type:"axis",name:"log",chartType:"cartesian",options:Fu,create:e=>new wu(e)},Ioe={type:"axis",name:"time",chartType:"cartesian",options:Doe,create:e=>new Ma(e)},Toe={type:"axis",name:"category",chartType:"cartesian",options:Bu,create:e=>new Gl(e)},koe={type:"axis",name:"grouped-category",chartType:"cartesian",options:_u,create:e=>new Mh(e)},Loe={type:"axis",name:"unit-time",chartType:"cartesian",options:Fh,create:e=>new Vl(e)},Poe=[foe,woe,Aoe,Ioe,Toe,koe,Loe,YO,tF,nF,oF,cF,uF],Eoe=[Moe,Sre,Are],Roe=[...Poe,...Eoe,moe,yoe,voe,boe,xoe,soe,noe,aoe],kn={isEnterprise:!1};function BF(e,t){var r,o,l,c;let i=[];const s=HM(e),n=Po(e),a=n?qt.get(n):"unknown";for(const h of Rg)if(!(a!=="unknown"&&!h.chartTypes.includes(a))){if(h.type==="root"||h.type==="legend"){const d=e[h.optionsKey];if(d==null)continue;h.optionsInnerKey?d[h.optionsInnerKey]&&(i.push(`${h.optionsKey}.${h.optionsInnerKey}`),delete d[h.optionsInnerKey]):(i.push(h.optionsKey),delete e[h.optionsKey])}else if(h.type==="axis"){if(!("axes"in e)||!Ke(e.axes)||!((r=e.axes)!=null&&r.some(d=>d.type===h.identifier)))continue;i.push(`axis[type=${h.identifier}]`),e.axes=e.axes.filter(d=>d.type!==h.identifier)}else if(h.type==="axis-option"){if(!("axes"in e)||!Ke(e.axes)||!((o=e.axes)!=null&&o.some(d=>d[h.optionsKey])))continue;i.push(`axis.${h.optionsKey}`),e.axes.forEach(d=>{d[h.optionsKey]&&delete d[h.optionsKey]})}else if(h.type==="series"){if(h.community||!Ke(e.series)||!((l=e.series)!=null&&l.some(d=>d.type===h.identifier)))continue;i.push(`series[type=${h.identifier}]`),e.series=e.series.filter(d=>d.type!==h.identifier)}else if(h.type==="series-option"){if(!Ke(e.series)||!((c=e.series)!=null&&c.some(d=>d[h.optionsKey])))continue;i.push(`series.${h.optionsKey}`),e.series.forEach(d=>{d[h.optionsKey]&&delete d[h.optionsKey]})}}if(i.length&&!t){s&&(i=["AgCharts.createGauge"]);let h="ag-charts-enterprise",d="https://www.ag-grid.com/charts/javascript/installation/";e.mode==="integrated"&&(h="ag-grid-charts-enterprise' or 'ag-grid-enterprise/charts-enterprise",d="https://www.ag-grid.com/javascript-data-grid/integrated-charts-installation/"),se.warnOnce([`unable to use these enterprise features as '${h}' has not been loaded:`,"",...i,"",`See: ${d}`].join(`
`))}}function Noe(e){const t="mode"in e&&e.mode==="integrated";for(const i of kr.byType("root","legend")){const s=e[i.optionsKey],n=s!=null&&s.enabled===!1,a=!("removable"in i)||i.removable===!0||i.removable==="standalone-only"&&!t;n&&a&&delete e[i.optionsKey]}}function _F(e){return e!=null&&e.up||e!=null&&e.down||e!=null&&e.neutral?"user-full":e!=null&&e.fills||e!=null&&e.strokes?"user-indexed":"inbuilt"}var hw="white",dw={get cartesian(){return{seriesTypes:qt.cartesianTypes,commonOptions:["zoom","navigator"]}},get polar(){return{seriesTypes:qt.polarTypes,commonOptions:[]}},get hierarchy(){return{seriesTypes:qt.hierarchyTypes,commonOptions:[]}},get topology(){return{seriesTypes:qt.topologyTypes,commonOptions:[]}},get"flow-proportion"(){return{seriesTypes:qt.flowProportionTypes,commonOptions:[]}},get standalone(){return{seriesTypes:qt.standaloneTypes,commonOptions:[]}},get gauge(){return{seriesTypes:qt.gaugeTypes,commonOptions:[]}}},Ooe={"radial-gauge":!0,"linear-gauge":!0};function GF(e){return Ooe[e]===!0}var Foe={millisecond:"%H:%M:%S.L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e %B",month:"%B",year:"%Y"},Ln={millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e",month:"%b",year:"%Y"},Boe=Object.values(dw).reduce((e,{commonOptions:t})=>e.concat(t),[]),ea=class Tm{static getDefaultColors(){return{fills:xi,fillsFallback:Object.values(xi),strokes:jr,sequentialColors:qn(xi),divergingColors:[xi.ORANGE,xi.YELLOW,xi.GREEN],hierarchyColors:["#fff","#e0e5ea","#c1ccd5","#a3b4c1","#859cad"],secondSequentialColors:yt.interpolate([yt.fromHexString(xi.BLUE),yt.fromHexString("#cbdef5")],8).map(t=>t.toString()),secondDivergingColors:[xi.GREEN,xi.YELLOW,xi.RED],secondHierarchyColors:["#fff","#c5cbd1","#a4b1bd","#8498a9","#648096"],up:{fill:xi.GREEN,stroke:jr.GREEN},down:{fill:xi.RED,stroke:jr.RED},neutral:{fill:xi.GRAY,stroke:jr.GRAY},altUp:{fill:xi.BLUE,stroke:jr.BLUE},altDown:{fill:xi.ORANGE,stroke:jr.ORANGE},altNeutral:{fill:xi.GRAY,stroke:jr.GRAY}}}static getDefaultPublicParameters(){return{accentColor:"#2196f3",axisColor:{$foregroundBackgroundMix:[.675]},backgroundColor:hw,borderColor:{$foregroundBackgroundMix:[.818]},foregroundColor:"#464646",fontFamily:"Verdana, sans-serif",fontSize:12,fontWeight:400,gridLineColor:{$foregroundBackgroundAccentMix:[.93,.085]},padding:20,subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"backgroundColor"},.38]},textColor:{$ref:"foregroundColor"},chromeBackgroundColor:{$foregroundBackgroundMix:[.975]},chromeFontFamily:{$ref:"fontFamily"},chromeFontSize:{$ref:"fontSize"},chromeFontWeight:{$ref:"fontWeight"},chromeTextColor:"#181d1f",chromeSubtleTextColor:{$mix:[{$ref:"chromeTextColor"},{$ref:"backgroundColor"},.38]},inputBackgroundColor:{$ref:"backgroundColor"},inputTextColor:{$ref:"textColor"},crosshairLabelBackgroundColor:{$ref:"foregroundColor"},crosshairLabelTextColor:{$ref:"backgroundColor"}}}static getAxisDefaults(t,{title:i,time:s}){const n=s==="modern"?Foe:void 0;return Je(t,i&&{title:{enabled:!1,text:"Axis Title",spacing:25,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.0833333333333333]},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},s!=="off"&&{label:{format:{millisecond:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.millisecond,n==null?void 0:n.millisecond]},second:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.second,n==null?void 0:n.second]},minute:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.minute,n==null?void 0:n.minute]},hour:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.hour,n==null?void 0:n.hour]},day:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.day,n==null?void 0:n.day]},month:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.month,n==null?void 0:n.month]},year:{$if:[{$path:["../../parentLevel/enabled",{$path:"../enabled"}]},Ln.year,n==null?void 0:n.year]}}},parentLevel:{enabled:!1,label:{enabled:{$path:"../../label/enabled"},fontSize:{$path:"../../label/fontSize"},fontFamily:{$path:"../../label/fontFamily"},fontWeight:"bold",spacing:{$path:"../../label/spacing"},color:{$path:"../../label/color"},avoidCollisions:{$path:"../../label/avoidCollisions"},format:{millisecond:{$path:["../../../label/format/millisecond",Ln.millisecond]},second:{$path:["../../../label/format/second",Ln.second]},minute:{$path:["../../../label/format/minute",Ln.minute]},hour:{$path:["../../../label/format/hour",Ln.hour]},day:{$path:["../../../label/format/day",Ln.day]},month:{$path:["../../../label/format/month",Ln.month]},year:{$path:["../../../label/format/year",Ln.year]}}},tick:{enabled:{$path:"../../tick/enabled"},size:{$path:"../../tick/size"},width:{$path:"../../tick/width"},stroke:{$path:"../../tick/stroke"}}}},{label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:11,color:{$ref:"textColor"},avoidCollisions:!0},line:{enabled:!0,width:1,stroke:{$ref:"axisColor"}},tick:{enabled:!1,size:6,width:1,stroke:{$ref:"axisColor"}},gridLine:{enabled:!0,style:[{stroke:{$ref:"gridLineColor"},lineDash:[]}]},crossLines:{enabled:!0,fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},fillOpacity:.1,strokeWidth:1,label:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},padding:5,color:{$ref:"textColor"}}}})}getChartDefaults(){return{minHeight:300,minWidth:300,background:{visible:!0,fill:{$ref:"backgroundColor"}},padding:{top:{$ref:"padding"},right:{$ref:"padding"},bottom:{$ref:"padding"},left:{$ref:"padding"}},seriesArea:{padding:{top:0,right:0,bottom:0,left:0}},keyboard:{enabled:!0},title:{enabled:!1,text:"Title",spacing:{$if:[{$path:"../subtitle/enabled"},10,20]},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.4166666666666667]},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},wrapping:"hyphenate",layoutStyle:Ul,textAlign:Kl},subtitle:{enabled:!1,text:"Subtitle",spacing:20,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.0833333333333333]},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:Ul,textAlign:Kl},footnote:{enabled:!1,text:"Footnote",spacing:20,fontSize:{$rem:[1.0833333333333333]},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:Ul,textAlign:Kl},legend:{position:"bottom",orientation:{$if:[{$or:[{$eq:[{$path:"./position"},"left"]},{$eq:[{$path:"./position"},"right"]}]},"vertical","horizontal"]},spacing:30,listeners:{},toggleSeries:!0,item:{paddingX:16,paddingY:8,marker:{size:15,padding:8},showSeriesStroke:!0,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"}}},reverseOrder:!1,pagination:{marker:{size:12},activeStyle:{fill:{$ref:"foregroundColor"}},inactiveStyle:{fill:{$ref:"subtleTextColor"}},highlightStyle:{fill:{$ref:"foregroundColor"}},label:{color:{$ref:"textColor"}}}},tooltip:{enabled:!0,darkTheme:Lu,delay:0,pagination:!1},overlays:{darkTheme:Lu},listeners:{}}}constructor(t={}){const{overrides:i,palette:s,params:n}=Bt(t),a=this.createChartConfigPerChartType(this.getDefaults()),r={};i&&this.mergeOverrides(a,r,i);const d=this.getDefaultColors(),{fills:o,strokes:l,sequentialColors:c}=d,h=We(d,["fills","strokes","sequentialColors"]);this.palette=oh(Je(s,b({fills:Object.values(o),strokes:Object.values(l),sequentialColors:Object.values(c)},h))),this.paletteType=_F(s),this.params=Je(n,this.getPublicParameters()),this.config=oh(this.templateTheme(a)),this.presets=oh(r)}mergeOverrides(t,i,s){for(const{seriesTypes:n,commonOptions:a}of Object.values(dw)){const r=b({},s.common);for(const o of Boe)a.includes(o)||delete r[o];for(const o of n){const l=o;GF(l)||(t[l]=Je(r,t[l]))}}qt.seriesTypes.forEach(n=>{const a=n,r=s[a];GF(a)?i[a]=r:t[a]=Je(r,t[a])})}createChartConfigPerChartType(t){var i;for(const[s,{seriesTypes:n}]of Zt(dw)){const a=bM.get(s);for(const r of n)(i=t[r])!=null||(t[r]=Bt(a))}return t}getDefaults(){const t=(i,s)=>{var r;const n={},a=b(b(b({axes:{}},vM.getThemeTemplates()),this.getChartDefaults()),bM.get(i));for(const o of s){n[o]=Je(xa.getThemeTemplate(o),(r=n[o])!=null?r:Bt(a));const{axes:l}=n[o];for(const c of ph.keys())l[c]=Je(l[c],ph.getThemeTemplate(c),Tm.axisDefault[c])}return n};return Je(t("cartesian",qt.cartesianTypes),t("polar",qt.polarTypes),t("hierarchy",qt.hierarchyTypes),t("topology",qt.topologyTypes),t("flow-proportion",qt.flowProportionTypes),t("standalone",qt.standaloneTypes),t("gauge",qt.gaugeTypes))}static applyTemplateTheme(t,i,s){if(Ke(t))for(let n=0;n<t.length;n++){const a=t[n];typeof a=="symbol"&&(s!=null&&s.has(a))&&(t[n]=s.get(a))}else for(const n of Object.keys(t)){const a=t[n];typeof a=="symbol"&&(s!=null&&s.has(a))&&(t[n]=s.get(a))}}templateTheme(t,i=!0){const s=i?Bt(t):t,n=this.getTemplateParameters();return Pr(s,Tm.applyTemplateTheme,void 0,void 0,n),s}getDefaultColors(){return Tm.getDefaultColors()}getPublicParameters(){return Tm.getDefaultPublicParameters()}getTemplateParameters(){var s,n,a,r,o,l,c,h,d,u,p,g,f,y,v,x,S,M,D,A,w,T,k,N;const t=new Map;t.set(Lu,!1),t.set(Zg,"#d9d9d9"),t.set(Wl,"#00000080"),t.set(Iv,"#aaa"),t.set(Ul,"block"),t.set(Kl,"center"),t.set(qg,["#797b86","#e24c4a","#f49d2d","#65ab58","#409682","#4db9d2","#5090dc","#3068f9","#e24c4a","#913aac","#d93e64"]),t.set(Av,hw),t.set(li,xi.BLUE),t.set(Wi,xi.BLUE),t.set(Qg,xi.BLUE),t.set(Jg,hw),t.set(ef,"#fafafa"),t.set(tf,"#ddd"),t.set(sf,"#000"),t.set(nf,"#181d1f"),t.set(af,"#e35c5c"),t.set(rf,"#e35c5c"),t.set(of,"#fafafa"),t.set(lf,"#ddd"),t.set(cf,"#000"),t.set(hf,"top"),t.set(ir,!1);const i=this.getDefaultColors();return t.set(xv,(n=(s=this.palette.up)==null?void 0:s.stroke)!=null?n:i.up.stroke),t.set(Sv,(r=(a=this.palette.up)==null?void 0:a.fill)!=null?r:i.up.fill),t.set(Cv,(l=(o=this.palette.down)==null?void 0:o.stroke)!=null?l:i.down.stroke),t.set(Mv,(h=(c=this.palette.down)==null?void 0:c.fill)!=null?h:i.down.fill),t.set(Dv,(u=(d=this.palette.neutral)==null?void 0:d.stroke)!=null?u:i.neutral.stroke),t.set(wv,(g=(p=this.palette.neutral)==null?void 0:p.fill)!=null?g:i.neutral.fill),t.set(hD,(y=(f=this.palette.altUp)==null?void 0:f.stroke)!=null?y:i.up.stroke),t.set(uD,(x=(v=this.palette.altUp)==null?void 0:v.fill)!=null?x:i.up.fill),t.set(dD,(M=(S=this.palette.altDown)==null?void 0:S.stroke)!=null?M:i.down.stroke),t.set(pD,(A=(D=this.palette.altDown)==null?void 0:D.fill)!=null?A:i.down.fill),t.set(gD,(T=(w=this.palette.altNeutral)==null?void 0:w.fill)!=null?T:i.altNeutral.fill),t.set(fD,(N=(k=this.palette.altNeutral)==null?void 0:k.stroke)!=null?N:i.altNeutral.stroke),t}};ea.axisDefault={number:ea.getAxisDefaults({keys:[],line:{enabled:!1},crosshair:{enabled:!0}},{title:!0,time:"off"}),log:ea.getAxisDefaults({keys:[],base:10,line:{enabled:!1},crosshair:{enabled:!0}},{title:!0,time:"off"}),category:ea.getAxisDefaults({keys:[],groupPaddingInner:.1,label:{autoRotate:!0},gridLine:{enabled:ir},crosshair:{enabled:!1}},{title:!0,time:"off"}),"grouped-category":ea.getAxisDefaults({keys:[],tick:{enabled:!0,stroke:Zg},label:{spacing:10,rotation:270},paddingInner:.4,groupPaddingInner:.2,crosshair:{enabled:!1}},{title:!0,time:"off"}),time:ea.getAxisDefaults({keys:[],gridLine:{enabled:ir},crosshair:{enabled:!0}},{title:!0,time:"legacy"}),"ordinal-time":ea.getAxisDefaults({keys:[],groupPaddingInner:0,label:{autoRotate:!1},gridLine:{enabled:ir},crosshair:{enabled:!0}},{title:!0,time:"legacy"}),"unit-time":ea.getAxisDefaults({keys:[],groupPaddingInner:.1,label:{autoRotate:!1},gridLine:{enabled:ir},crosshair:{enabled:!0},parentLevel:{enabled:!0}},{title:!0,time:"modern"}),"angle-category":ea.getAxisDefaults({label:{spacing:5},gridLine:{enabled:ir},shape:{$path:["./shape",void 0,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]}},{title:!1,time:"off"}),"angle-number":ea.getAxisDefaults({label:{spacing:5},gridLine:{enabled:ir}},{title:!1,time:"off"}),"radius-category":ea.getAxisDefaults({positionAngle:0,line:{enabled:!1}},{title:!0,time:"off"}),"radius-number":ea.getAxisDefaults({positionAngle:0,line:{enabled:!1},shape:{$path:["./shape",void 0,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]}},{title:!0,time:"off"})};var nr=ea,uw="#192232",As={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},Bh={BLUE:"#74a8e6",ORANGE:"#ffbe70",GREEN:"#6cb176",CYAN:"#75d4ef",YELLOW:"#f6e559",VIOLET:"#aa86d8",GRAY:"#a1a1a1",MAGENTA:"#ce7ab9",BROWN:"#997b52",RED:"#ff7872"},Gu=class extends nr{getDefaultColors(){return{fills:As,fillsFallback:Object.values(As),strokes:Bh,sequentialColors:qn(As),divergingColors:[As.ORANGE,As.YELLOW,As.GREEN],hierarchyColors:["#192834","#253746","#324859","#3f596c","#4d6a80"],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[As.GREEN,As.YELLOW,As.RED],secondHierarchyColors:["#192834","#3b5164","#496275","#577287","#668399"],up:{fill:As.GREEN,stroke:Bh.GREEN},down:{fill:As.RED,stroke:Bh.RED},neutral:{fill:As.GRAY,stroke:Bh.GRAY},altUp:{fill:As.BLUE,stroke:Bh.BLUE},altDown:{fill:As.ORANGE,stroke:Bh.ORANGE},altNeutral:{fill:As.GRAY,stroke:Bh.GRAY}}}getPublicParameters(){return E(b({},super.getPublicParameters()),{axisColor:{$foregroundBackgroundMix:[.263]},backgroundColor:uw,borderColor:{$foregroundBackgroundMix:[.784]},chromeBackgroundColor:{$foregroundBackgroundMix:[.93]},foregroundColor:"#fff",gridLineColor:{$foregroundBackgroundAccentMix:[.743,.01]},subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"backgroundColor"},.57]},chromeTextColor:{$ref:"textColor"},crosshairLabelBackgroundColor:{$foregroundBackgroundAccentMix:[.35,.1]}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(Lu,!0),e.set(Av,uw),e.set(Zg,"#7f8389"),e.set(li,As.BLUE),e.set(Qg,"#fff"),e.set(Wi,As.BLUE),e.set(Jg,uw),e.set(ef,"#28313e"),e.set(tf,"#4b525d"),e.set(sf,"#fff"),e.set(nf,"#fff"),e.set(of,"#28313e"),e.set(lf,"#4b525d"),e.set(cf,"#fff"),e}constructor(e){super(e)}},Pn={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},_h={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},_oe=class extends Gu{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:b({},Pn),fillsFallback:Object.values(b({},Pn)),strokes:b({},_h),sequentialColors:qn(Pn),divergingColors:[Pn.GREEN,Pn.BLUE,Pn.RED],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],up:{fill:Pn.GREEN,stroke:_h.GREEN},down:{fill:Pn.RED,stroke:_h.RED},neutral:{fill:Pn.BLUE,stroke:_h.BLUE},altUp:{fill:Pn.GREEN,stroke:_h.GREEN},altDown:{fill:Pn.RED,stroke:_h.RED},altNeutral:{fill:Pn.GRAY,stroke:_h.GRAY}})}getPublicParameters(){return E(b({},super.getPublicParameters()),{gridLineColor:{$foregroundBackgroundAccentMix:[.88,.01]},padding:0})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,Pn.BLUE),e.set(Wi,Pn.BLUE),e.set(Ul,"overlay"),e.set(Kl,"left"),e.set(hf,"bottom"),e.set(ir,!0),e}},En={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},Gh={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},Goe=class extends nr{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:b({},En),fillsFallback:Object.values(b({},En)),strokes:b({},Gh),sequentialColors:qn(En),divergingColors:[En.GREEN,En.BLUE,En.RED],up:{fill:En.GREEN,stroke:Gh.GREEN},down:{fill:En.RED,stroke:Gh.RED},neutral:{fill:En.BLUE,stroke:Gh.BLUE},altUp:{fill:En.GREEN,stroke:Gh.GREEN},altDown:{fill:En.RED,stroke:Gh.RED},altNeutral:{fill:En.GRAY,stroke:Gh.GRAY}})}getPublicParameters(){return E(b({},super.getPublicParameters()),{gridLineColor:{$foregroundBackgroundAccentMix:[.94,.01]},padding:0})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,En.BLUE),e.set(Wi,En.BLUE),e.set(Ul,"overlay"),e.set(Kl,"left"),e.set(hf,"bottom"),e.set(ir,!0),e}},Is={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},zh={BLUE:"#90CAF9",ORANGE:"#FFCC80",GREEN:"#A5D6A7",CYAN:"#80DEEA",YELLOW:"#FFF9C4",VIOLET:"#B39DDB",GRAY:"#E0E0E0",MAGENTA:"#F48FB1",BROWN:"#A1887F",RED:"#EF9A9A"},zoe=class extends Gu{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:Is,fillsFallback:Object.values(Is),strokes:zh,sequentialColors:qn(Is),divergingColors:[Is.ORANGE,Is.YELLOW,Is.GREEN],secondSequentialColors:["#2196f3","#208FEC","#1E88E5","#1C7FDC","#1976d2","#176EC9","#1565c0"],secondDivergingColors:[Is.GREEN,Is.YELLOW,Is.RED],up:{fill:Is.GREEN,stroke:zh.GREEN},down:{fill:Is.RED,stroke:zh.RED},neutral:{fill:Is.GRAY,stroke:zh.GRAY},altUp:{fill:Is.BLUE,stroke:zh.BLUE},altDown:{fill:Is.RED,stroke:zh.RED},altNeutral:{fill:Is.GRAY,stroke:zh.GRAY}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,Is.BLUE),e.set(Wi,Is.BLUE),e}},Ts={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},Vh={BLUE:"#1565C0",ORANGE:"#E65100",GREEN:"#2E7D32",CYAN:"#00838F",YELLOW:"#F9A825",VIOLET:"#4527A0",GRAY:"#616161",MAGENTA:"#C2185B",BROWN:"#4E342E",RED:"#B71C1C"},Voe=class extends nr{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:Ts,fillsFallback:Object.values(Ts),strokes:Vh,sequentialColors:qn(Ts),divergingColors:[Ts.ORANGE,Ts.YELLOW,Ts.GREEN],secondSequentialColors:["#2196f3","#329EF4","#42a5f5","#53ADF6","#64b5f6","#7AC0F8","#90caf9"],secondDivergingColors:[Ts.GREEN,Ts.YELLOW,Ts.RED],up:{fill:Ts.GREEN,stroke:Vh.GREEN},down:{fill:Ts.RED,stroke:Vh.RED},neutral:{fill:Ts.GRAY,stroke:Vh.GRAY},altUp:{fill:Ts.BLUE,stroke:Vh.BLUE},altDown:{fill:Ts.RED,stroke:Vh.RED},altNeutral:{fill:Ts.GRAY,stroke:Vh.GRAY}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,Ts.BLUE),e.set(Wi,Ts.BLUE),e}},di={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},jh={BLUE:"#6698ff",PURPLE:"#c0a3ff",MAGENTA:"#fc8dfc",PINK:"#ff82b1",RED:"#ff9b70",ORANGE:"#ffcf4e",YELLOW:"#ffff58",GREEN:"#58dd70",CYAN:"#51e2c9",MODERATE_BLUE:"#4fd7ff",GRAY:"#eeeeee"},joe=class extends Gu{getDefaultColors(){return{fills:di,fillsFallback:Object.values(di),strokes:jh,sequentialColors:qn(di),divergingColors:[di.BLUE,di.RED],hierarchyColors:[],secondSequentialColors:[di.BLUE,di.PURPLE,di.MAGENTA,di.PINK,di.RED,di.ORANGE,di.YELLOW,di.GREEN],secondDivergingColors:[di.BLUE,di.RED],secondHierarchyColors:[],up:{fill:di.GREEN,stroke:jh.GREEN},down:{fill:di.RED,stroke:jh.RED},neutral:{fill:di.GRAY,stroke:jh.GRAY},altUp:{fill:di.BLUE,stroke:jh.BLUE},altDown:{fill:di.RED,stroke:jh.RED},altNeutral:{fill:di.GRAY,stroke:jh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,di.BLUE),e.set(Wi,di.BLUE),e}},ui={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},Hh={BLUE:"#2346c9",PURPLE:"#7653d4",MAGENTA:"#a73da9",PINK:"#c32d66",RED:"#c84b1c",ORANGE:"#c87f00",YELLOW:"#c1b900",GREEN:"#008c1c",CYAN:"#00927c",MODERATE_BLUE:"#0087bb",GRAY:"#888888"},Hoe=class extends nr{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:ui,fillsFallback:Object.values(ui),strokes:Hh,sequentialColors:qn(ui),divergingColors:[ui.BLUE,ui.RED],hierarchyColors:[],secondSequentialColors:[ui.BLUE,ui.PURPLE,ui.MAGENTA,ui.PINK,ui.RED,ui.ORANGE,ui.YELLOW,ui.GREEN],secondDivergingColors:[ui.BLUE,ui.RED],secondHierarchyColors:[],up:{fill:ui.GREEN,stroke:Hh.GREEN},down:{fill:ui.RED,stroke:Hh.RED},neutral:{fill:ui.GRAY,stroke:Hh.GRAY},altUp:{fill:ui.BLUE,stroke:Hh.BLUE},altDown:{fill:ui.RED,stroke:Hh.RED},altNeutral:{fill:ui.GRAY,stroke:Hh.GRAY}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,ui.BLUE),e.set(Wi,ui.BLUE),e}},$i={BLUE:"#4472C4",ORANGE:"#ED7D31",GRAY:"#A5A5A5",YELLOW:"#FFC000",MODERATE_BLUE:"#5B9BD5",GREEN:"#70AD47",DARK_GRAY:"#7B7B7B",DARK_BLUE:"#264478",VERY_DARK_GRAY:"#636363",DARK_YELLOW:"#997300"},sc={BLUE:"#6899ee",ORANGE:"#ffa55d",GRAY:"#cdcdcd",YELLOW:"#ffea53",MODERATE_BLUE:"#82c3ff",GREEN:"#96d56f",DARK_GRAY:"#a1a1a1",DARK_BLUE:"#47689f",VERY_DARK_GRAY:"#878787",DARK_YELLOW:"#c0993d"},Woe=class extends Gu{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:E(b({},$i),{RED:$i.ORANGE}),fillsFallback:Object.values(E(b({},$i),{RED:$i.ORANGE})),strokes:E(b({},sc),{RED:sc.ORANGE}),sequentialColors:qn(E(b({},$i),{RED:$i.ORANGE})),divergingColors:[$i.ORANGE,$i.YELLOW,$i.GREEN],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[$i.GREEN,$i.YELLOW,$i.ORANGE],up:{fill:$i.GREEN,stroke:sc.GREEN},down:{fill:$i.ORANGE,stroke:sc.ORANGE},neutral:{fill:$i.GRAY,stroke:sc.GRAY},altUp:{fill:$i.BLUE,stroke:sc.BLUE},altDown:{fill:$i.ORANGE,stroke:sc.ORANGE},altNeutral:{fill:$i.GRAY,stroke:sc.GRAY}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,$i.BLUE),e.set(Wi,$i.BLUE),e}},ls={BLUE:"#5281d5",ORANGE:"#ff8d44",GRAY:"#b5b5b5",YELLOW:"#ffd02f",MODERATE_BLUE:"#6aabe6",GREEN:"#7fbd57",DARK_GRAY:"#8a8a8a",DARK_BLUE:"#335287",VERY_DARK_GRAY:"#717171",DARK_YELLOW:"#a98220"},Wo={BLUE:"#214d9b",ORANGE:"#c25600",GRAY:"#7f7f7f",YELLOW:"#d59800",MODERATE_BLUE:"#3575ac",GREEN:"#4b861a",DARK_GRAY:"#575757",DARK_BLUE:"#062253",VERY_DARK_GRAY:"#414141",DARK_YELLOW:"#734f00"},Uoe=class extends nr{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:E(b({},ls),{RED:ls.ORANGE}),fillsFallback:Object.values(E(b({},ls),{RED:ls.ORANGE})),strokes:E(b({},Wo),{RED:Wo.ORANGE}),sequentialColors:qn(E(b({},ls),{RED:ls.ORANGE})),divergingColors:[ls.ORANGE,ls.YELLOW,ls.GREEN],secondSequentialColors:["#5090dc","#629be0","#73a6e3","#85b1e7","#96bcea","#a8c8ee","#b9d3f1","#cbdef5"],secondDivergingColors:[ls.GREEN,ls.YELLOW,ls.ORANGE],secondHierarchyColors:[],up:{fill:ls.GREEN,stroke:Wo.GREEN},down:{fill:ls.ORANGE,stroke:Wo.ORANGE},neutral:{fill:Wo.GRAY,stroke:Wo.GRAY},altUp:{fill:ls.BLUE,stroke:Wo.BLUE},altDown:{fill:ls.ORANGE,stroke:Wo.ORANGE},altNeutral:{fill:ls.GRAY,stroke:Wo.GRAY}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,ls.BLUE),e.set(Wi,ls.BLUE),e}},zu=E(b({},zo),{type:ee(Oe("ordinal-time")),paddingInner:Me,paddingOuter:Me,groupPaddingInner:Me,label:xf,parentLevel:Gv,interval:Jl(Ne(ne,wr),!0).interval,crosshair:Ql(!0)}),zF=E(b(b({},ql),Jl(ne)),{type:ee(Oe("angle-number")),crossLines:Li(zr),startAngle:ne,endAngle:ne,label:E(b({},Lh),{orientation:ce("fixed","parallel","perpendicular"),format:Zl})}),Koe={innerRadiusRatio:Me},VF=E(b(b({},ql),Koe),{type:ee(Oe("angle-category")),shape:ce("polygon","circle"),crossLines:Li(zr),startAngle:ne,endAngle:ne,paddingInner:Me,groupPaddingInner:Me,label:E(b({},Lh),{orientation:ce("fixed","parallel","perpendicular")})}),jF=E(b(b({},ql),Jl(ne)),{type:ee(Oe("radius-number")),shape:ce("polygon","circle"),positionAngle:ne,innerRadiusRatio:Me,crossLines:Li(E(b({},zr),{label:E(b({},kh),{positionAngle:ne})}),"cross-line options"),title:b({enabled:q,text:z,spacing:X,formatter:ft},It),label:E(b({},Lh),{format:Zl})}),HF=E(b({},ql),{type:ee(Oe("radius-category")),positionAngle:ne,innerRadiusRatio:Me,paddingInner:Me,paddingOuter:Me,groupPaddingInner:Me,label:Lh,crossLines:Li(E(b({},zr),{label:E(b({},kh),{positionAngle:ne})}),"cross-line options"),title:b({enabled:q,text:z,spacing:X,formatter:ft},It)}),Vu=b({lineStyle:ce("solid","dashed","dotted")},De),Wh=b(b(b({},xe),ge),De),Pf=b({visible:q,locked:q,handle:Wh},It),pb=b({position:ce("top","center","bottom"),alignment:ce("left","center","right")},It),WF=b({position:ce("top","inside","bottom"),alignment:ce("left","center","right")},It),$oe=b(b(b(b({enabled:q,cornerRadius:X,formatter:ft},It),xe),ge),De),Yoe=b(b({visible:q},Vu),ge),UF=b(b(b({divider:ge},xe),ge),It),KF=b(b(b({handle:Wh,statistics:UF},Vu),xe),ge),gb=b(b({visible:q,locked:q,extendStart:q,extendEnd:q,handle:Wh,text:pb},Vu),ge),pw=b(b({visible:q,locked:q,axisLabel:$oe,handle:Wh,text:pb},Vu),ge),gw=b(b({visible:q,locked:q,extendStart:q,extendEnd:q,handle:Wh,text:WF,background:xe},Vu),ge),$F=b({},gw),YF=E(b({},gw),{middle:Yoe}),fw=b({label:It,showFill:q,isMultiColor:q,strokes:Ie(ye),rangeStroke:ye,bands:ce(4,6,10)},gb),XF=b(b(b({},xe),ge),Pf),ZF=b(b(b({},xe),ge),Pf),qF=E(b(b(b({},xe),ge),Pf),{background:b(b({},xe),ge)}),mw=b({visible:q,locked:q,handle:Wh},xe),fb=b(b({visible:q,locked:q,extendStart:q,extendEnd:q,handle:Wh,text:pb,background:xe,statistics:UF},Vu),ge),QF={visible:q,up:KF,down:KF},ju={enabled:q,axesButtons:{enabled:q,axes:ce("x","y","xy")},toolbar:{enabled:q,padding:X,buttons:Li(E(b({},Ph),{value:ce("line-menu","fibonacci-menu","text-menu","shape-menu","measurer-menu","line","horizontal-line","vertical-line","parallel-channel","disjoint-channel","fibonacci-retracement","fibonacci-retracement-trend-based","text","comment","callout","note","clear")}),"annotation toolbar buttons array")},optionsToolbar:{enabled:q,buttons:Ie(Ne(es(E(b({},Ph),{value:ee(ce("line-stroke-width","line-style-type","line-color","fill-color","text-color","text-size","delete","settings"))})),es(E(b({},Ph),{value:ee(ce("lock")),checkedOverrides:Ph}))))}};ju.data=Ce(hn),ju.xKey=Ce(z),ju.volumeKey=Ce(z),ju.snap=Ce(q);var JF=b(b(b(b({direction:ce("horizontal","vertical"),showInMiniChart:q,cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X,whisker:b(b({},ge),De),cap:{lengthRatio:Me}})),whisker:b(b({},ge),De),cap:{lengthRatio:Me},tooltip:nt},it),xe),ge),De),e2=b(b(b({cornerRadius:X,wick:b(b({},ge),De)},xe),ge),De),t2=b({item:{up:e2,down:e2},itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X,wick:b(b({},ge),De)})),showInMiniChart:q,tooltip:nt},it),i2=b({fills:Ie(Ir),strokes:Ie(ye),label:b({spacing:X,maxWidth:X},bt),link:b(b(b({tension:Me,itemStyler:Ft(E(b(b(b({},xe),ge),De),{tension:Me}))},xe),ge),De),node:b(b(b({width:X,spacing:X,itemStyler:Ft(b(b(b({},xe),ge),De))},xe),ge),De),tooltip:nt},it),s2=b(b(b(b({direction:ce("horizontal","vertical"),fills:Ie(Ir),strokes:Ie(ye),showInMiniChart:q,label:b({spacing:X,placement:ce("before","middle","after")},bt),stageLabel:b({rotation:ne,spacing:X,minSpacing:X,placement:ce("before","after"),avoidCollisions:q,itemStyler:Ft(E(b({},It),{spacing:ne})),format:z},bt),tooltip:nt},it),be(xe,["fill"])),be(ge,["stroke"])),De),n2=b(b(b(b({direction:ce("horizontal","vertical"),fills:Ie(Ir),strokes:Ie(ye),showInMiniChart:q,itemStyler:Ft(b(b(b({},xe),ge),De)),spacingRatio:Me,crisp:q,dropOff:b(b(b({enabled:q},xe),ge),De),stageLabel:b({rotation:ne,spacing:X,minSpacing:X,placement:ce("before","after"),avoidCollisions:q,itemStyler:Ft(E(b({},It),{spacing:ne})),format:z},bt),label:bt,tooltip:nt,shadow:Vr},it),be(xe,["fill"])),be(ge,["stroke"])),De),a2=b(b({title:z,textAlign:ce("left","center","right"),verticalAlign:ce("top","middle","bottom"),itemPadding:X,itemStyler:Ft(b(b({},xe),ge)),showInMiniChart:q,label:ec,tooltip:nt},it),ge),r2=b({showInMiniChart:q,itemStyler:Ft(b(b({},ge),De)),item:{up:b(b({},ge),De),down:b(b({},ge),De)},tooltip:nt},it),o2=E(b(b(b({maxStrokeWidth:X,itemStyler:Ft(b(b({},ge),De)),sizeDomain:Ie(X),label:bt,tooltip:nt},it),ge),De),{highlightStyle:b(b({},it.highlightStyle),ge)}),l2=b(b({},ge),De),c2=E(b(b({colorRange:Ie(ye),maxSize:X,sizeDomain:Ie(X),label:b({placement:ce("top","bottom","left","right")},bt),tooltip:nt},it),be(Vo,["enabled"])),{highlightStyle:b(b(b({},it.highlightStyle),xe),ge)}),h2=E(b(b(b(b({colorRange:Ie(ye),padding:X,itemStyler:Ft(b(b(b({},xe),ge),De)),label:ec,tooltip:nt},it),xe),ge),De),{highlightStyle:b(b(b({},it.highlightStyle),xe),ge)}),d2=b(b(b(b({},it),xe),ge),De),u2=b(b(b(b({cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),label:bt,tooltip:nt},it),xe),ge),De),p2=b(b(b(b({direction:ce("horizontal","vertical"),aspectRatio:X,spacing:X,reverse:q,itemStyler:Ft(b(b(b({},xe),ge),De)),fills:Ie(Ir),strokes:Ie(ye),label:bt,stageLabel:b({spacing:X,placement:ce("before","after")},bt),tooltip:nt,shadow:Vr},it),be(xe,["fill"])),be(ge,["stroke"])),De),g2=b(b(b(b({connectMissingData:q,marker:Vo,label:bt,tooltip:nt},it),xe),ge),De),f2=b(b(b({connectMissingData:q,marker:Vo,label:bt,tooltip:nt},it),ge),De),m2=b(b(b(b({cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),label:bt,tooltip:nt},it),xe),ge),De),y2=b(b(b(b({cornerRadius:X,columnWidthRatio:Me,maxColumnWidthRatio:Me,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),label:bt,tooltip:nt},it),xe),ge),De),v2=b(b(b(b({showInMiniChart:q,connectMissingData:q,interpolation:$v,label:E(b({},bt),{padding:X,placement:ce("inside","outside")}),marker:Vo,tooltip:nt,shadow:Vr},it),xe),ge),De),b2=b(b(b(b({direction:ce("horizontal","vertical"),showInMiniChart:q,cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),label:E(b({},bt),{padding:X,placement:ce("inside","outside")}),tooltip:nt,shadow:Vr},it),xe),ge),De),x2=b({fills:Ie(Ir),strokes:Ie(ye),label:E(b({},bt),{spacing:X}),link:b(b(b({itemStyler:Ft(b(b(b({},xe),ge),De))},xe),ge),De),node:b(b(b({width:X,spacing:X,alignment:ce("left","center","right","justify"),itemStyler:Ft(b(b(b({},xe),ge),De))},xe),ge),De),tooltip:nt},it),C2=E(b(b(b({fills:Ie(Ir),strokes:Ie(ye),colorRange:Ie(ye),sectorSpacing:X,cornerRadius:X,padding:X,itemStyler:Ft(b(b({},xe),ge)),label:b({spacing:X},ec),secondaryLabel:ec,tooltip:nt},it),be(xe,["fill"])),be(ge,["stroke"])),{highlightStyle:b(b({label:{color:ye},secondaryLabel:{color:ye}},xe),ge)}),S2=E(b({fills:Ie(Ir),strokes:Ie(ye),colorRange:Ie(ye),itemStyler:Ft(b(b({},xe),ge)),group:b(b({gap:X,padding:X,cornerRadius:X,textAlign:ce("left","center","right"),interactive:q,label:E(b({},bt),{spacing:X})},xe),ge),tile:b(b({gap:X,padding:X,cornerRadius:X,textAlign:ce("left","center","right"),verticalAlign:ce("top","middle","bottom"),label:E(b({},bt),{spacing:X,lineHeight:X,minimumFontSize:X,wrapping:ce("never","always","hyphenate","on-space"),overflowStrategy:ce("ellipsis","hide")}),secondaryLabel:E(b({},bt),{lineHeight:X,minimumFontSize:X,wrapping:ce("never","always","hyphenate","on-space"),overflowStrategy:ce("ellipsis","hide")})},xe),ge),tooltip:nt},it),{highlightStyle:{group:b(b({label:{color:ye}},xe),ge),tile:b(b({label:{color:ye},secondaryLabel:{color:ye}},xe),ge)}}),yw=b(b(b({name:z,cornerRadius:X,itemStyler:Ft(E(b(b(b({},xe),ge),De),{cornerRadius:X})),label:E(b({},bt),{padding:X,placement:ce("inside-start","inside-center","inside-end","outside-start","outside-end")}),tooltip:nt,shadow:Vr},xe),ge),De),M2=b({direction:ce("horizontal","vertical"),showInMiniChart:q,item:{positive:yw,negative:yw,total:yw},line:b(b({enabled:q},ge),De),tooltip:nt},it),mb=es({__type:ee(Oe("date")),value:Ne(z,ne)},"a serializable date object"),D2={width:X,height:X,grip:q,fill:ye,stroke:ye,strokeWidth:X,cornerRadius:X},ut={enabled:q,height:X,spacing:X,cornerRadius:ne,mask:{fill:ye,fillOpacity:Me,stroke:ye,strokeWidth:X},minHandle:D2,maxHandle:D2,miniChart:{enabled:q,padding:{top:X,bottom:X},label:b({enabled:q,avoidCollisions:q,spacing:X,format:Zl,formatter:ft,interval:{minSpacing:X,maxSpacing:X,values:hn,step:ne}},It),series:_e}},Zs={number:E(b({},be(Ou,["type","crossLines"])),{top:be(Ou,["type","crossLines","position"]),right:be(Ou,["type","crossLines","position"]),bottom:be(Ou,["type","crossLines","position"]),left:be(Ou,["type","crossLines","position"]),crossLines:be(Go,["type"])}),log:E(b({},be(Fu,["type","crossLines"])),{top:be(Fu,["type","crossLines","position"]),right:be(Fu,["type","crossLines","position"]),bottom:be(Fu,["type","crossLines","position"]),left:be(Fu,["type","crossLines","position"]),crossLines:be(Go,["type"])}),category:E(b({},be(Bu,["type","crossLines"])),{top:be(Bu,["type","crossLines","position"]),right:be(Bu,["type","crossLines","position"]),bottom:be(Bu,["type","crossLines","position"]),left:be(Bu,["type","crossLines","position"]),crossLines:be(Go,["type"])}),time:E(b({},be(Ho,["type","crossLines"])),{top:be(Ho,["type","crossLines","position"]),right:be(Ho,["type","crossLines","position"]),bottom:be(Ho,["type","crossLines","position"]),left:be(Ho,["type","crossLines","position"]),crossLines:be(Go,["type"])}),"grouped-category":E(b({},be(_u,["type"])),{top:be(_u,["type","position"]),right:be(_u,["type","position"]),bottom:be(_u,["type","position"]),left:be(_u,["type","position"]),crossLines:be(Go,["type"])}),"unit-time":E(b({},be(Fh,["type","crossLines"])),{top:be(Fh,["type","crossLines","position"]),right:be(Fh,["type","crossLines","position"]),bottom:be(Fh,["type","crossLines","position"]),left:be(Fh,["type","crossLines","position"]),crossLines:be(Go,["type"])}),"ordinal-time":E(b({},be(zu,["type","crossLines"])),{top:be(zu,["type","crossLines","position"]),right:be(zu,["type","crossLines","position"]),bottom:be(zu,["type","crossLines","position"]),left:be(zu,["type","crossLines","position"]),crossLines:be(Go,["type"])})},Hu={"angle-category":E(b({},be(VF,["type","crossLines"])),{crossLines:be(zr,["type"])}),"angle-number":E(b({},be(zF,["type","crossLines"])),{crossLines:be(zr,["type"])}),"radius-category":E(b({},be(HF,["type","crossLines"])),{crossLines:E(b({},be(zr,["type"])),{label:E(b({},kh),{positionAngle:ne})})}),"radius-number":E(b({},be(jF,["type","crossLines"])),{crossLines:E(b({},be(zr,["type"])),{label:E(b({},kh),{positionAngle:ne})})})},xt={visible:q},Xoe={common:E(b({},Pe),{navigator:ut,axes:b(b({},Zs),Hu),annotations:E(b({},ju),{line:gb,"horizontal-line":pw,"vertical-line":pw,"disjoint-channel":$F,"parallel-channel":YF,"fibonacci-retracement":fw,"fibonacci-retracement-trend-based":fw,callout:XF,comment:ZF,note:qF,text:Pf,arrow:gb,"arrow-up":mw,"arrow-down":mw,"date-range":fb,"price-range":fb,"date-price-range":fb,"quick-date-price-range":QF}),chartToolbar:{enabled:q},initialState:{legend:Li({visible:q,seriesId:z,itemId:z,legendItemName:z},"legend state array"),zoom:{rangeX:{start:Ne(ne,mb),end:Ne(ne,mb)},rangeY:{start:Ne(ne,mb),end:Ne(ne,mb)},ratioX:{start:Me,end:Me},ratioY:{start:Me,end:Me},autoScaledAxes:Ie(Oe("y"))}}}),line:b(E(b({},Pe),{axes:Zs,series:WD,navigator:ut}),xt),scatter:b(E(b({},Pe),{axes:Zs,series:dF,navigator:ut}),xt),bubble:b(E(b({},Pe),{axes:Zs,series:sF,navigator:ut}),xt),area:b(E(b({},Pe),{axes:Zs,series:KO,navigator:ut}),xt),bar:b(E(b({},Pe),{axes:Zs,series:jD,navigator:ut}),xt),"box-plot":b(E(b({},Pe),{axes:Zs,series:JF,navigator:ut}),xt),candlestick:b(E(b({},Pe),{axes:Zs,series:t2,navigator:ut}),xt),"cone-funnel":b(E(b({},Pe),{axes:Zs,series:s2,navigator:ut}),xt),funnel:b(E(b({},Pe),{axes:Zs,series:n2,navigator:ut}),xt),ohlc:b(E(b({},Pe),{axes:Zs,series:r2,navigator:ut}),xt),histogram:b(E(b({},Pe),{axes:be(Zs,["category","grouped-category","ordinal-time","unit-time"]),series:rF,navigator:ut}),xt),heatmap:b(E(b({},Pe),{axes:Zs,series:a2,navigator:ut}),xt),waterfall:b(E(b({},Pe),{axes:Zs,series:M2,navigator:ut}),xt),"range-bar":b(E(b({},Pe),{axes:Zs,series:b2,navigator:ut}),xt),"range-area":b(E(b({},Pe),{axes:Zs,series:v2,navigator:ut}),xt),donut:b(E(b({},Pe),{series:xF,navigator:ut}),xt),pie:b(E(b({},Pe),{series:qD,navigator:ut}),xt),"radar-line":b(E(b({},Pe),{axes:Hu,series:f2,navigator:ut}),xt),"radar-area":b(E(b({},Pe),{axes:Hu,series:g2,navigator:ut}),xt),"radial-bar":b(E(b({},Pe),{axes:Hu,series:m2,navigator:ut}),xt),"radial-column":b(E(b({},Pe),{axes:Hu,series:y2,navigator:ut}),xt),nightingale:b(E(b({},Pe),{axes:Hu,series:u2,navigator:ut}),xt),sunburst:b(E(b({},Pe),{series:C2,navigator:ut}),xt),treemap:b(E(b({},Pe),{series:S2,navigator:ut}),xt),"map-shape":b(E(b({},Pe),{series:h2,navigator:ut}),xt),"map-line":b(E(b({},Pe),{series:o2,navigator:ut}),xt),"map-marker":b(E(b({},Pe),{series:c2,navigator:ut}),xt),"map-shape-background":b(E(b({},Pe),{series:d2,navigator:ut}),xt),"map-line-background":b(E(b({},Pe),{series:l2,navigator:ut}),xt),sankey:b(E(b({},Pe),{series:x2,navigator:ut}),xt),chord:b(E(b({},Pe),{series:i2,navigator:ut}),xt),pyramid:b(E(b({},Pe),{series:p2,navigator:ut}),xt),"radial-gauge":E(b(b({},Pe),hb),{targets:be(lb,["value"]),tooltip:b(b({},hb.tooltip),Pe.tooltip)}),"linear-gauge":E(b(b({},Pe),cb),{targets:be(ob,["value"]),tooltip:b(b({},cb.tooltip),Pe.tooltip)})};function yb(e,t){const i={};for(const s of Reflect.ownKeys(e))i[s]=t(e[s],s,e);return i}var Zoe=yb(Xoe,function e(t,i){if(oy(i))return t;if(Dr(t))return Ne(t,py,oy);if(Ve(t))return Ne(es(cy in t?yb(t,s=>Ve(s)?yb(s,e):s):yb(t,e)),py,oy);throw new Error(`Invalid theme override value: ${String(t)}`)}),ks={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},Uh={BLUE:"#67b7ff",ORANGE:"#ffc24d",GREEN:"#5cc86f",CYAN:"#54ebff",VIOLET:"#fff653",YELLOW:"#c18aff",GRAY:"#aeaeae",MAGENTA:"#f078d4",BROWN:"#ba8438",RED:"#ff726e"},qoe=class extends Gu{getDefaultColors(){return{fills:ks,fillsFallback:Object.values(ks),strokes:Uh,sequentialColors:qn(ks),divergingColors:[ks.ORANGE,ks.YELLOW,ks.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#0076e6","#0069cc","#005cb3","#004f99","#004280","#003466","#00274c"],secondDivergingColors:[ks.GREEN,ks.YELLOW,ks.RED],secondHierarchyColors:[],up:{fill:ks.GREEN,stroke:Uh.GREEN},down:{fill:ks.RED,stroke:Uh.RED},neutral:{fill:ks.GRAY,stroke:Uh.GRAY},altUp:{fill:ks.BLUE,stroke:Uh.BLUE},altDown:{fill:ks.ORANGE,stroke:Uh.ORANGE},altNeutral:{fill:ks.GRAY,stroke:Uh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,ks.BLUE),e.set(Wi,ks.BLUE),e}},Ls={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},Kh={BLUE:"#0f68c0",ORANGE:"#d47100",GREEN:"#007922",CYAN:"#009ac2",VIOLET:"#bca400",YELLOW:"#753cac",GRAY:"#646464",MAGENTA:"#9b2685",BROWN:"#6c3b00",RED:"#cb0021"},Qoe=class extends nr{getDefaultColors(){return E(b({},super.getDefaultColors()),{fills:Ls,fillsFallback:Object.values(Ls),strokes:Kh,sequentialColors:qn(Ls),divergingColors:[Ls.ORANGE,Ls.YELLOW,Ls.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#1a8fff","#339cff","#4da8ff","#66b5ff","#80c1ff","#99cdff","#b3daff"],secondDivergingColors:[Ls.GREEN,Ls.YELLOW,Ls.RED],secondHierarchyColors:[],up:{fill:Ls.GREEN,stroke:Kh.GREEN},down:{fill:Ls.RED,stroke:Kh.RED},neutral:{fill:Ls.GRAY,stroke:Kh.GRAY},altUp:{fill:Ls.BLUE,stroke:Kh.BLUE},altDown:{fill:Ls.ORANGE,stroke:Kh.ORANGE},altNeutral:{fill:Ls.GRAY,stroke:Kh.GRAY}})}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(li,Ls.BLUE),e.set(Wi,Ls.BLUE),e}},vw=fn(()=>new nr),Joe=ct.create(!0,"perf"),ar=(e,t,i)=>{Joe("[CACHE] ChartTheme",e,t.name,i)},bw={"ag-default-dark":fn(()=>new Gu),"ag-sheets-dark":fn(()=>new Woe,ar),"ag-polychroma-dark":fn(()=>new joe,ar),"ag-vivid-dark":fn(()=>new qoe,ar),"ag-material-dark":fn(()=>new zoe,ar),"ag-financial-dark":fn(()=>new _oe,ar),"ag-default":vw,"ag-sheets":fn(()=>new Uoe,ar),"ag-polychroma":fn(()=>new Hoe,ar),"ag-vivid":fn(()=>new Qoe,ar),"ag-material":fn(()=>new Voe,ar),"ag-financial":fn(()=>new Goe,ar)},vb=fn(ele,ar);function ele(e){if(e instanceof nr)return e;if(!nle(e))return vw();if(e==null||typeof e=="string"){const n=bw[e!=null?e:"ag-default"];if(n)return n();throw new Error(`Cannot find theme \`${e}\`.`)}const{cleared:t,invalid:i}=js(tle(e),ile,"theme");for(const n of i)se.warnOnce(String(n));const s=t!=null&&t.baseTheme?vb(t.baseTheme):vw();return t?new s.constructor(t):s}function tle(e){if(!Ve(e)||!Ve(e.baseTheme))return e;let t=e,i,s;const n=[];for(;typeof t=="object";)i!=null||(i=t.palette),s!=null||(s=t.params),t.overrides&&n.push(t.overrides),t=t.baseTheme;return{baseTheme:t,overrides:Je(...n),params:s,palette:i}}var ile={baseTheme:Ne(z,dy),overrides:Zoe,params:{accentColor:ye,axisColor:ye,backgroundColor:ye,borderColor:ye,foregroundColor:ye,fontFamily:n0,fontSize:ne,fontWeight:Ne(z,ne),gridLineColor:ye,padding:ne,subtleTextColor:ye,textColor:ye,chromeBackgroundColor:ye,chromeFontFamily:n0,chromeFontSize:ne,chromeFontWeight:Ne(z,ne),chromeSubtleTextColor:ye,chromeTextColor:ye,inputBackgroundColor:ye,inputTextColor:ye,crosshairLabelBackgroundColor:ye,crosshairLabelTextColor:ye},palette:{fills:Ie(Ir),strokes:Ie(ye),up:{fill:Ne(ye,s0),stroke:ye},down:{fill:Ne(ye,s0),stroke:ye},neutral:{fill:Ne(ye,s0),stroke:ye}}},sle=ce("ag-default","ag-default-dark","ag-sheets","ag-sheets-dark","ag-polychroma","ag-polychroma-dark","ag-vivid","ag-vivid-dark","ag-material","ag-material-dark","ag-financial","ag-financial-dark");function nle(e){const{invalid:t}=js({theme:e},{theme:Ne(sle,dy)});for(const i of t)se.warnOnce(String(i));return t.length===0}var w2=e=>`'${e}'`,Wu=class Ii{constructor(t,i,s,n,a,r,o=!1){this.themeParameters={},this.optionMetadata=a!=null?a:{},this.processedOverrides=s!=null?s:{};let l=null;t instanceof Ii?(l=t,this.specialOverrides=l.specialOverrides,r===void 0&&(r=Lr(l.userOptions,i,Ii.JSON_DIFF_OPTS)),this.userOptions=Bt(pg(r,l.userOptions),E(b({},Ii.OPTIONS_CLONE_OPTS),{seen:[]}))):(this.userOptions=Bt(t!=null?t:i,E(b({},Ii.OPTIONS_CLONE_OPTS),{seen:[]})),this.specialOverrides=this.specialOverridesDefaults(b({},n))),o&&this.removeLeftoverSymbols(this.userOptions);let c,h,d,u,p,g,f;!o&&r!==void 0&&Ii.isFastPathDelta(r)&&l!=null?({activeTheme:c,processedOptions:h,defaultAxes:d,fastDelta:u}=this.fastSetup(r,l),p=l.themeParameters,g=l.annotationThemes):(Ii.perfDebug("ChartOptions.slowSetup()"),{activeTheme:c,processedOptions:h,defaultAxes:d,themeParameters:p,annotationThemes:g,googleFonts:f}=this.slowSetup(s,r,o)),this.activeTheme=c,this.processedOptions=h,this.defaultAxes=d,this.fastDelta=u!=null?u:void 0,this.themeParameters=p,this.annotationThemes=g,this.googleFonts=f,ct.inDevelopmentMode(()=>oh(this))}static isFastPathDelta(t){for(const i of Object.keys(t!=null?t:{}))if(!this.FAST_PATH_OPTIONS.has(i))return Ii.perfDebug("ChartOptions.isFastPathDelta() - slow path required due to presence of: ",i),!1;return Ii.perfDebug("ChartOptions.isFastPathDelta() - fast path possible."),!0}fastSetup(t,i){const{activeTheme:s,defaultAxes:n,processedOptions:a}=i,{presetType:r}=this.optionMetadata;if(r!=null&&(t==null?void 0:t.data)!=null){const l=cn.getPresetModule(r);if(l!=null&&l.processData){const{series:c,data:h}=l.processData(t.data);t=Je({series:c,data:h},t)}}this.fastSeriesSetup(t,a);const o=Je(t,a);return Ii.debug("ChartOptions.fastSetup() - processed options",o),{activeTheme:s,defaultAxes:n,processedOptions:o,fastDelta:t}}fastSeriesSetup(t,i){var s;t!=null&&t.series&&((s=t.series)!=null&&s.every((n,a)=>{var r,o;return oR(n,(o=(r=i.series)==null?void 0:r[a])!=null?o:{})})?delete t.series:t.series=t.series.map((n,a)=>{var r,o;return pg(n,(o=(r=i.series)==null?void 0:r[a])!=null?o:{})}))}slowSetup(t,i,s=!1){var M,D,A;let n=Bt(this.userOptions,Ii.OPTIONS_CLONE_OPTS);i&&(n=Je(i,n),s&&this.removeLeftoverSymbols(n));const{presetType:a}=this.optionMetadata;if(a!=null){const w=cn.getPresetModule(a);if(w){const{validate:T=js}=w,k=n,N=n.type,O=N!=null?vb(n.theme).presets[N]:void 0,{cleared:L,invalid:F}=T(k,w.options,"");F.forEach(B=>se.warn(B)),Hd(F,"")?n={}:(Ii.debug(">>> AgCharts.createOrUpdate() - applying preset",L),n=w.create(L,O,()=>this.activeTheme))}}this.soloSeriesIntegrity(n),kn.isEnterprise||BF(n);const r=vb(n.theme);if(a!=null&&r.templateTheme(n,!1),this.validateSeriesOptions(n),this.chartDef=cn.detectChartDefinition(n),!this.chartDef.placeholder){const{validate:w=js}=this.chartDef,{cleared:T,invalid:k}=w(n,this.chartDef.options,"");k.forEach(N=>se.warn(N)),n=T}this.validateAxesOptions(n),this.removeDisabledOptions(n);const o=this.optionsType(n),S=this.getSeriesThemeConfig(o,r),{annotations:l={},axes:c={},series:h}=S,d=We(S,["annotations","axes","series"]),[u,p]=this.splitAnnotationsOptions(l),g=Bt(p),f=this.getDefaultAxes(n,h);let y=Je(t,n,u,d,f);this.processAxesOptions(y,c),this.processSeriesOptions(y,r),y=Bt(y,Ii.OPTIONS_CLONE_OPTS),(VM(y)||jM(y)||ane(y))&&((M=y.legend)==null?void 0:M.enabled)==null&&((D=y.legend)!=null||(y.legend={}),y.legend.enabled=y.series.length>1),this.enableConfiguredOptions(y,n);let v=this.processFonts(y);const x=r.params;return v=this.processFonts(x,v),x.__palette=Bt(r.palette),x.__palette.type=Ve(n.theme)?_F((A=n.theme)==null?void 0:A.palette):"inbuilt",this.resolveThemeOperations(x,x),this.resolveThemeOperations(x,y),this.resolveThemeOperations(x,g),r.templateTheme(y,!1),Noe(y),kn.isEnterprise||BF(y,!0),this.validateSeriesOptions(y),this.validateAxesOptions(y),this.validatePluginOptions(y),this.processMiniChartSeriesOptions(y),y.loadGoogleFonts||v.clear(),Ii.debug(()=>["ChartOptions.slowSetup() - processed options",Bt(y)]),{activeTheme:r,processedOptions:y,defaultAxes:f,themeParameters:x,annotationThemes:g,googleFonts:v}}validatePluginOptions(t){var i;for(const s of cn.listModulesByType(ry.Plugin)){const n=s.name;if(n in t&&(!s.chartType||s.chartType===((i=this.chartDef)==null?void 0:i.name))){const{cleared:a,invalid:r}=js(t[n],s.options,s.name);r.forEach(o=>se.warn(o)),t[n]=a}}}validateSeriesOptions(t){var r,o,l,c;const i=(r=this.chartDef)==null?void 0:r.name,s=[],n=(l=(o=t.series)==null?void 0:o.length)!=null?l:0;let a;for(let h=0;h<n;h++){const d=`series[${h}]`,u=t.series[h],p=cn.getSeriesModule((c=u.type)!=null?c:"line");if(p==null){a!=null||(a=rg(Array.from(cn.listModulesByType(ry.Series)).filter(v=>!i||v.chartType===i).map(v=>v.name),"or",w2)),se.warn(`Unknown type \`${u.type}\` at \`${d}.type\`; expecting ${a}, ignoring.`);continue}else if(i&&p.chartType!==i){se.warn(`Series type \`${p.name}\` at \`${d}.type\` is not supported by chart type \`${i}\`, ignoring.`);continue}const{validate:g=js}=p,{cleared:f,invalid:y}=g(u,p.options,d);y.forEach(v=>se.warn(v)),Hd(y,d)||s.push(f)}t.series=s}validateAxesOptions(t){var r,o;if(!("axes"in t)||!t.axes)return;const i=(r=this.chartDef)==null?void 0:r.name,s=[],n=(o=t.axes.length)!=null?o:0;let a;for(let l=0;l<n;l++){const c=`axes[${l}]`;let h=t.axes[l];h.type==="time"&&h.unit!=null&&(h=E(b({},h),{type:"unit-time"}));const d=cn.getAxisModule(h.type);if(d==null){a!=null||(a=rg(Array.from(cn.listModulesByType(ry.Axis)).filter(f=>f.chartType===i).map(f=>f.name),"or",w2)),se.warn(`Unknown type \`${h.type}\` at  \`${c}.type\`; expecting one of ${a}, ignoring all axes options.`),delete t.axes;break}else if(d.chartType!==i){se.warn(`Axis type \`${d.name}\` at  \`${c}.type\` is not supported by chart type \`${i}\`, ignoring.`);break}const{validate:u=js}=d,{cleared:p,invalid:g}=u(h,d.options,c);g.forEach(f=>se.warn(f)),Hd(g,c)||s.push(p)}t.axes=s}diffOptions(t){var i;return this===t?{}:t==null?this.processedOptions:(i=this.fastDelta)!=null?i:Lr(t.processedOptions,this.processedOptions,Ii.JSON_DIFF_OPTS)}getSeriesThemeConfig(t,i){var s;return(s=i==null?void 0:i.config[t])!=null?s:{}}getDefaultAxes(t,i){var r,o;const s=this.optionsType(t),n=(o=(r=t.series)==null?void 0:r.find(l=>{var c;return((c=l.type)!=null?c:"line")===s}))!=null?o:{},a=xa.cloneDefaultAxes(s);return Fy(a,{},void 0,Je(n,i)),a}optionsType(t){var i,s,n;return(n=(s=(i=t.series)==null?void 0:i[0])==null?void 0:s.type)!=null?n:"line"}splitAnnotationsOptions(t){const o=t,{axesButtons:i=null,enabled:s=null,optionsToolbar:n=null,toolbar:a=null}=o,r=We(o,["axesButtons","enabled","optionsToolbar","toolbar"]);return i==null&&s==null&&n==null&&a==null?[{},r]:[{annotations:{axesButtons:i,enabled:s,optionsToolbar:n,toolbar:a}},r]}processAxesOptions(t,i){var s;"axes"in t&&(t.axes=(s=t.axes)==null?void 0:s.map(n=>{var p,f,y;const g=Je((p=i[n.type])==null?void 0:p[n.position],i[n.type]),{crossLines:a}=g,r=We(g,["crossLines"]);n.crossLines&&(n.crossLines=Iy(n.crossLines,a));const o=(f=r.gridLine)==null?void 0:f.style;(y=n.gridLine)!=null&&y.style&&(o!=null&&o.length)&&(n.gridLine.style=n.gridLine.style.map((x,S)=>x.stroke!=null||x.lineDash!=null?Je(x,o.at(S%o.length)):x));const v=Je(n,r),{top:l,right:c,bottom:h,left:d}=v;return We(v,["top","right","bottom","left"])}))}processSeriesOptions(t,i){var a;const s=this.getTooltipPositionDefaults(t),n=(a=t.series)==null?void 0:a.map(r=>{var g,f;(g=r.type)!=null||(r.type="line");const y=(f=this.getSeriesThemeConfig(r.type,i).series)!=null?f:{},{innerLabels:o}=y,l=We(y,["innerLabels"]),c=cn.getSeriesModule(r.type),h=!!(c!=null&&c.options.tooltip),d=!!(c!=null&&c.options.visible),u=h&&this.getTooltipRangeDefaults(t,r.type),p=Je(this.getSeriesGroupingOptions(r),r,h&&s,u,l,d&&{visible:!0});return p.innerLabels&&(p.innerLabels=Iy(p.innerLabels,o)),p});t.series=this.setSeriesGroupingOptions(n!=null?n:[])}processMiniChartSeriesOptions(t){var s,n;let i=(n=(s=t.navigator)==null?void 0:s.miniChart)==null?void 0:n.series;i!=null&&(i=i.map(a=>{var r;return(r=a.type)!=null||(a.type="line"),a}),t.navigator.miniChart.series=this.setSeriesGroupingOptions(i))}resolveThemeOperations(t,i){const s=Fy(i,t,new Set(["palette","data","theme"]));Ii.debug("ChartOptions.resolveTheme()",s)}getSeriesGroupingOptions(t){const i=xa.isGroupable(t.type),s=xa.isStackable(t.type),n=xa.isStackedByDefault(t.type);t.grouped&&!i&&se.warnOnce(`unsupported grouping of series type "${t.type}".`),(t.stacked||t.stackGroup)&&!s&&se.warnOnce(`unsupported stacking of series type "${t.type}".`);let{grouped:a,stacked:r}=t;return r!=null||(r=(n||t.stackGroup!=null)&&!(i&&a)),a!=null||(a=!0),{stacked:s&&r,grouped:i&&a&&!(s&&r)}}setSeriesGroupingOptions(t){const i=this.getSeriesGrouping(t);Ii.debug("ChartOptions.setSeriesGroupingOptions() - series grouping: ",i);const s={},n=i.reduce((a,r)=>{var l;var o;return r.groupType==="default"||((l=a[o=r.seriesType])!=null||(a[o]=0),a[r.seriesType]+=r.groupType==="stack"?1:r.series.length),a},{});return i.flatMap(a=>{var o;var r;switch((o=s[r=a.seriesType])!=null||(s[r]=0),a.groupType){case"stack":{const l=s[a.seriesType]++;return a.series.map((c,h)=>Object.assign(c,{seriesGrouping:{groupId:a.groupId,groupIndex:l,groupCount:n[a.seriesType],stackIndex:h,stackCount:a.series.length}}))}case"group":return a.series.map(l=>Object.assign(l,{seriesGrouping:{groupId:a.groupId,groupIndex:s[a.seriesType]++,groupCount:n[a.seriesType],stackIndex:0,stackCount:0}}))}return a.series}).map(l=>{var c=l,{stacked:a,grouped:r}=c,o=We(c,["stacked","grouped"]);return o})}getSeriesGroupId(t){var i;return[t.type,t.xKey,t.stacked?(i=t.stackGroup)!=null?i:"stacked":"grouped"].filter(Boolean).join("-")}getSeriesGrouping(t){const i=new Map;return t.reduce((s,n)=>{const a=n.type;if(!n.stacked&&!n.grouped)s.push({groupType:"default",seriesType:a,series:[n],groupId:"__default__"});else{const r=this.getSeriesGroupId(n);if(!i.has(r)){const l={groupType:n.stacked?"stack":"group",seriesType:a,series:[],groupId:r};i.set(r,l),s.push(l)}i.get(r).series.push(n)}return s},[])}getTooltipPositionDefaults(t){var c;const i=(c=t.tooltip)==null?void 0:c.position;if(!Lt(i))return;const{type:s,anchorTo:n,placement:a,xOffset:r,yOffset:o}=i,l={};return Ji(s)&&qS(DF,s)&&(l.type=s),Ji(n)&&qS(SF,n)&&(l.anchorTo=n),Ji(a)&&qS(MF,a)&&(l.placement=a),Xe(r)&&(l.xOffset=r),Xe(o)&&(l.yOffset=o),{tooltip:{position:l}}}getTooltipRangeDefaults(t,i){var s,n,a;return{tooltip:{range:(a=(s=t.tooltip)==null?void 0:s.range)!=null?a:(n=xa.getTooltipDefauls(i))==null?void 0:n.range}}}soloSeriesIntegrity(t){if(!Ke(t.series))return;const i=t.series;if(i&&i.length>1&&i.some(s=>xa.isSolo(s.type))){const s=this.optionsType(t);if(xa.isSolo(s))se.warn(`series[0] of type '${s}' is incompatible with other series types. Only processing series[0]`),t.series=i.slice(0,1);else{const{solo:n,nonSolo:a}=r0(i,o=>xa.isSolo(o.type)?"solo":"nonSolo"),r=a0(n.map(o=>o.type)).join(", ");se.warn(`Unable to mix these series types with the lead series type: ${r}`),t.series=a}}}static enableConfiguredJsonOptions(t,i){typeof i=="object"&&"enabled"in i&&!i._enabledFromTheme&&t.enabled==null&&(i.enabled=!0)}static cleanupEnabledFromThemeJsonOptions(t){t._enabledFromTheme!=null&&delete t._enabledFromTheme}enableConfiguredOptions(t,i){Pr(i,Ii.enableConfiguredJsonOptions,new Set(["data","theme"]),t),Pr(t,Ii.cleanupEnabledFromThemeJsonOptions,new Set(["data","theme"]))}static processFontOptions(t,i,s,n=new Set){if(typeof t=="object"&&"fontFamily"in t)if(Array.isArray(t.fontFamily)){const a=[];for(const r of t.fontFamily)typeof r=="object"&&"googleFont"in r?(a.push(r.googleFont),n==null||n.add(r.googleFont)):a.push(r);t.fontFamily=a.join(", ")}else typeof t.fontFamily=="object"&&"googleFont"in t.fontFamily&&(t.fontFamily=t.fontFamily.googleFont,n==null||n.add(t.fontFamily));return n}processFonts(t,i=new Set){return Pr(t,Ii.processFontOptions,new Set(["data","theme"]),void 0,void 0,i)}static removeDisabledOptionJson(t){"enabled"in t&&t.enabled===!1&&Object.keys(t).forEach(i=>{i!=="enabled"&&delete t[i]})}removeDisabledOptions(t){Pr(t,Ii.removeDisabledOptionJson,new Set(["data","theme","contextMenu"]))}static removeLeftoverSymbolsJson(t){if(!(!t||!Ve(t)))for(const i of Object.keys(t)){const s=t[i];oy(s)&&delete t[i]}}removeLeftoverSymbols(t){Pr(t,Ii.removeLeftoverSymbolsJson,new Set(["data"]))}specialOverridesDefaults(t){if(t.window==null?t.window=Ct():MQ(t.window),t.document==null?t.document=Sr():SQ(t.document),t.window==null)throw new Error("AG Charts - unable to resolve global window");if(t.document==null)throw new Error("AG Charts - unable to resolve global document");return t}};Wu.OPTIONS_CLONE_OPTS={shallow:new Set(["data","container"]),assign:new Set(["context","theme"])},Wu.JSON_DIFF_OPTS=new Set(["data"]),Wu.perfDebug=ct.create(!0,"perf"),Wu.FAST_PATH_OPTIONS=new Set(["data","width","height","container"]),Wu.debug=ct.create(!0,"opts");var xw=Wu,ale=1e3,Cw=class Gc{constructor(t,i,s,n,a,r=ale){this.name=t,this.buildItem=i,this.releaseItem=s,this.destroyItem=n,this.maxPoolSize=a,this.cleanupTimeMs=r,this.freePool=[],this.busyPool=new Set}static getPool(t,i,s,n,a){return this.pools.has(t)||this.pools.set(t,new Gc(t,i,s,n,a)),this.pools.get(t)}isFull(){return this.freePool.length+this.busyPool.size>=this.maxPoolSize}hasFree(){return this.freePool.length>0}obtain(t){if(!this.hasFree()&&this.isFull())throw new Error("AG Charts - pool exhausted");let i=this.freePool.pop();return i==null?(i=this.buildItem(t),Gc.debug(()=>[`Pool[name=${this.name}]: Created instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,i])):Gc.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,i]),this.busyPool.add(i),{item:i,release:()=>this.release(i)}}obtainFree(){const t=this.freePool.pop();if(t==null)throw new Error("AG Charts - pool has no free instances");return Gc.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,t]),this.busyPool.add(t),{item:t,release:()=>this.release(t)}}release(t){var n;if(!this.busyPool.has(t))throw new Error("AG Charts - cannot free item from pool which is not tracked as busy.");Gc.debug(()=>[`Pool[name=${this.name}]: Releasing instance (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,t]),this.releaseItem(t),this.busyPool.delete(t),this.freePool.push(t),Gc.debug(()=>[`Pool[name=${this.name}]: Returned instance to free pool (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,t]);const i=Date.now(),s=i+this.cleanupTimeMs*.5;this.cleanPoolTimer&&((n=this.cleanPoolDue)!=null?n:1/0)<s&&(clearTimeout(this.cleanPoolTimer),this.cleanPoolTimer=void 0),this.cleanPoolTimer||(this.cleanPoolDue=i+this.cleanupTimeMs,this.cleanPoolTimer=setTimeout(this.cleanPool.bind(this),this.cleanupTimeMs))}cleanPool(){const t=this.freePool.splice(0);for(const i of t)this.destroyItem(i);Gc.debug(()=>[`Pool[name=${this.name}]: Cleaned pool of ${t.length} items (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`])}destroy(){this.cleanPool();for(const t of this.busyPool.values())this.destroyItem(t);this.busyPool.clear()}};Cw.pools=new Map,Cw.debug=ct.create(!0,"pool");var rle=Cw;cn.registerMany(Roe);var Uo=ct.create(!0,"opts"),rr=class{static licenseCheck(e){var t,i;this.licenseChecked||(this.licenseManager=(t=kn.licenseManager)==null?void 0:t.call(kn,e),(i=this.licenseManager)==null||i.validateLicense(),this.licenseChecked=!0)}static getLicenseDetails(e){var t;return(t=kn.licenseManager)==null?void 0:t.call(kn,{}).getLicenseDetails(e)}static getInstance(e){return A2.getInstance(e)}static create(e,t){return Uo.group("AgCharts.create()",()=>{var s,n,a;e=(s=ct.inDevelopmentMode(()=>oh(Bt(e))))!=null?s:e,this.licenseCheck(e);const i=A2.createOrUpdate({userOptions:e,licenseManager:this.licenseManager,optionsMetadata:t});return(n=this.licenseManager)!=null&&n.isDisplayWatermark()&&this.licenseManager&&((a=kn.injectWatermark)==null||a.call(kn,i.chart.ctx.domManager,this.licenseManager.getWatermarkMessage())),i})}static createFinancialChart(e){return Uo.group("AgCharts.createFinancialChart()",()=>this.create(e,{presetType:"price-volume"}))}static createGauge(e){return Uo.group("AgCharts.createGauge()",()=>this.create(e,{presetType:"gauge-preset"}))}static __createSparkline(e){return Uo.group("AgCharts.__createSparkline()",()=>{const s=e,{pool:t}=s,i=We(s,["pool"]);return this.create(i,{presetType:"sparkline",pool:t!=null?t:!0,domMode:"minimal"})})}};rr.licenseChecked=!1;var Hr=class zc{static getInstance(t){const i=dv.getInstance(t);return i?N1.chartInstances.get(i):void 0}static initialiseModules(){zc.initialised||(JD(),Ire(),zc.initialised=!0)}static createOrUpdate(t){var w,T,k,N,O,L,B,_,G;let{proxy:i}=t;const{userOptions:s,licenseManager:n,processedOverrides:a=(T=(w=i==null?void 0:i.chart)==null?void 0:w.chartOptions.processedOverrides)!=null?T:{},specialOverrides:r=(N=(k=i==null?void 0:i.chart)==null?void 0:k.chartOptions.specialOverrides)!=null?N:{},optionsMetadata:o=(L=(O=i==null?void 0:i.chart)==null?void 0:O.chartOptions.optionMetadata)!=null?L:{},deltaOptions:l,stripSymbols:c=!1}=t,h=kn.styles!=null?[["ag-charts-enterprise",kn.styles]]:[],{presetType:d}=o;zc.initialiseModules(),Uo(()=>[">>> AgCharts.createOrUpdate() user options",Bt(s)]);let u=s;rr.optionsMutationFn&&u&&(u=rr.optionsMutationFn(Bt(u),d),Uo(()=>[">>> AgCharts.createOrUpdate() MUTATED user options",Bt(u)]));const p=this.getPool(o);let g=!1,f,y=i==null?void 0:i.chart;y==null&&(p!=null&&p.hasFree())&&(f=p.obtainFree(),y=f.item);const F=u!=null?u:{},{document:v,window:x,styleContainer:S}=F,M=We(F,["document","window","styleContainer"]),D=y==null?void 0:y.getChartOptions(),A=new xw(D,M,a,E(b({},r),{document:v,window:x,styleContainer:S}),o,l,c);return(y==null||cn.detectChartDefinition(A.processedOptions)!==cn.detectChartDefinition(y.chartOptions.processedOptions))&&(f==null||f.release(),f=(B=this.getPool(A.optionMetadata))==null?void 0:B.obtain(A),f?y=f.item:(g=!0,y=zc.createChartInstance(A,y))),h.forEach(([V,j])=>{y.ctx.domManager.addStyles(V,j)}),y.ctx.fontManager.updateFonts(A.googleFonts),i==null?(i=new N1(y,zc.callbackApi,n),i.releaseChart=f==null?void 0:f.release):(f||g)&&((_=i.releaseChart)==null||_.call(i),i.chart=y,i.releaseChart=f==null?void 0:f.release),Uo.check()&&typeof window!="undefined"&&((G=window.agChartInstances)!=null||(window.agChartInstances={}),window.agChartInstances[y.id]=y),y.queuedUserOptions.push(A.userOptions),y.queuedChartOptions.push(A),y.requestFactoryUpdate(V=>{Uo.group(">>>> Chart.applyOptions()",()=>{V.applyOptions(A);const j=V.queuedUserOptions.indexOf(A.userOptions)+1;V.queuedUserOptions.splice(0,j),V.queuedChartOptions.splice(0,j)})}),i}static markRemovedProperties(t,i,s=!1){if(typeof t!="object")return s;for(const n of Object.keys(t))typeof t[n]=="undefined"&&(Object.assign(t,{[n]:Symbol("UNSET")}),s||(s=!0));return s}static updateUserDelta(t,i){i=Bt(i,xw.OPTIONS_CLONE_OPTS);const s=Pr(i,zc.markRemovedProperties,new Set(["data"]),void 0,void 0,!1);Uo(()=>[">>> AgCharts.updateUserDelta() user delta",Bt(i)]),zc.createOrUpdate({proxy:t,deltaOptions:i,stripSymbols:s})}static createChartInstance(t,i){const s=i==null?void 0:i.destroy({keepTransferableResources:!0});return cn.detectChartDefinition(t.processedOptions).create(t,s)}static getPool(t){var i;if(t.pool===!0)return rle.getPool((i=t.presetType)!=null?i:"default",this.createChartInstance,this.detachAndClear,this.destroy,1/0)}};Hr.caretaker=new xR(au),Hr.initialised=!1,Hr.callbackApi={caretaker:Hr.caretaker,create(e,t,i,s){return Hr.createOrUpdate({userOptions:e,processedOverrides:t,specialOverrides:i,optionsMetadata:s})},update(e,t){return Hr.createOrUpdate({userOptions:e,proxy:t})},updateUserDelta(e,t){return Hr.updateUserDelta(e,t)}},Hr.detachAndClear=e=>e.detachAndClear(),Hr.destroy=e=>e.destroy();var A2=Hr,Sw={};Ua(Sw,{Arc:()=>Wr,BBox:()=>ve,Caption:()=>Ht,CategoryScale:()=>Ug,Group:()=>Ge,Line:()=>Ks,LinearScale:()=>tr,Marker:()=>rs,Path:()=>gn,RadialColumnShape:()=>ka,Rect:()=>$s,Scene:()=>Ky,Sector:()=>gs,Shape:()=>va,TranslatableGroup:()=>ds,getRadialColumnWidth:()=>I2,toRadians:()=>Vi});var Wr=class extends gn{constructor(){super(),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0,this.restoreOwnStyles()}get fullPie(){return mt(bi(this.startAngle),bi(this.endAngle))}updatePath(){const e=this.path;e.clear(),e.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?e.closePath():this.type===2&&!this.fullPie&&(e.lineTo(this.centerX,this.centerY),e.closePath())}computeBBox(){return new ve(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(e,t){const i=this.getBBox();return this.type!==0&&i.containsPoint(e,t)&&this.path.isPointInPath(e,t)}};Wr.className="Arc",I([he()],Wr.prototype,"centerX",2),I([he()],Wr.prototype,"centerY",2),I([he()],Wr.prototype,"radius",2),I([he()],Wr.prototype,"startAngle",2),I([he()],Wr.prototype,"endAngle",2),I([he()],Wr.prototype,"counterClockwise",2),I([he()],Wr.prototype,"type",2);function Mw(e,t,i){const s=Math.sqrt(e**2+t**2),a=Math.atan2(t,e)+i;return{x:Math.cos(a)*s,y:Math.sin(a)*s}}var ka=class extends gn{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}set cornerRadius(e){}computeBBox(){const{innerRadius:e,outerRadius:t,columnWidth:i}=this,s=this.getRotation(),n=-i/2,a=i/2,r=-t,o=-e;let l=1/0,c=1/0,h=-1/0,d=-1/0;for(let u=0;u<4;u+=1){const{x:p,y:g}=Mw(u%2===0?n:a,u<2?r:o,s);l=Math.min(p,l),c=Math.min(g,c),h=Math.max(p,h),d=Math.max(g,d)}return new ve(l,c,h-l,d-c)}getRotation(){const{startAngle:e,endAngle:t}=this,i=Ty(e,t);return bi(e+i/2+Math.PI/2)}updatePath(){const{isBeveled:e}=this;e?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth:e,innerRadius:t,outerRadius:i,path:s}=this,n=-e/2,a=e/2,r=-i,o=-t,l=this.getRotation(),c=[[n,o],[n,r],[a,r],[a,o]].map(([h,d])=>Mw(h,d,l));s.clear(!0),s.moveTo(c[0].x,c[0].y),s.lineTo(c[1].x,c[1].y),s.lineTo(c[2].x,c[2].y),s.lineTo(c[3].x,c[3].y),s.closePath()}updateBeveledPath(){const{columnWidth:e,path:t,outerRadius:i,innerRadius:s,axisInnerRadius:n,axisOuterRadius:a,isRadiusAxisReversed:r}=this,o=mt(s,n),l=Math.asin(e/2/s),c=this.getRotation(),h=(T,k)=>Mw(T,k,c),d=(T,k)=>Math.sqrt(T**2+k**2),u=(T,k)=>k>T?0:Math.sqrt(T**2-k**2),p=(T,k,N)=>N?T<k:T>k,g=o&&!isNaN(l)&&l<Math.PI/6;let f=-e/2,y=e/2;const v=-i,x=-s*(g?Math.cos(l):1),S=p(a,d(s,e/2),!r);if(S){const T=u(a,s);f=-T,y=T}t.clear(!0);const M=h(f,x);t.moveTo(M.x,M.y);const D=mt(s,i),A=p(a,d(i,e/2),!r);if(D&&g)t.arc(0,0,s,bi(-l-Math.PI/2)+c,bi(l-Math.PI/2)+c,!1);else if(A){const T=-u(a,e/2),k=u(a,i);if(!S){const N=h(f,T);t.lineTo(N.x,N.y)}if(t.arc(0,0,a,Math.atan2(T,f)+c,Math.atan2(v,-k)+c,!1),!mt(k,0)){const N=h(k,v);t.lineTo(N.x,N.y)}t.arc(0,0,a,Math.atan2(v,k)+c,Math.atan2(T,y)+c,!1)}else{const T=h(f,v),k=h(y,v);t.lineTo(T.x,T.y),t.lineTo(k.x,k.y)}const w=h(y,x);if(t.lineTo(w.x,w.y),g)t.arc(0,0,s,bi(l-Math.PI/2)+c,bi(-l-Math.PI/2)+c,!0);else{const T=h(f,x);t.lineTo(T.x,T.y)}t.closePath()}};ka.className="RadialColumnShape",I([he()],ka.prototype,"isBeveled",2),I([he()],ka.prototype,"columnWidth",2),I([he()],ka.prototype,"startAngle",2),I([he()],ka.prototype,"endAngle",2),I([he()],ka.prototype,"outerRadius",2),I([he()],ka.prototype,"innerRadius",2),I([he()],ka.prototype,"axisInnerRadius",2),I([he()],ka.prototype,"axisOuterRadius",2),I([he()],ka.prototype,"isRadiusAxisReversed",2);function I2(e,t,i,s,n){const a=Ty(e,t),r=a*(1-s)/2;if(e+=r,t-=r,a<.001)return 2*i*n;if(a>=2*Math.PI){const p=e+a/2;e=p-Math.PI,t=p+Math.PI}const o=i*Math.cos(e),l=i*Math.sin(e),c=i*Math.cos(t),h=i*Math.sin(t),d=Math.floor(Math.sqrt((o-c)**2+(l-h)**2)),u=2*i*n;return Math.max(1,Math.min(u,d))}var Dw={};Ua(Dw,{ChartTheme:()=>nr,DEFAULT_ANNOTATION_HANDLE_FILL:()=>Jg,DEFAULT_ANNOTATION_STATISTICS_COLOR:()=>sf,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:()=>nf,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:()=>af,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:()=>rf,DEFAULT_ANNOTATION_STATISTICS_FILL:()=>ef,DEFAULT_ANNOTATION_STATISTICS_STROKE:()=>tf,DEFAULT_CAPTION_ALIGNMENT:()=>Kl,DEFAULT_CAPTION_LAYOUT_STYLE:()=>Ul,DEFAULT_FIBONACCI_STROKES:()=>qg,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:()=>Wi,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:()=>li,DEFAULT_GRIDLINE_ENABLED:()=>ir,DEFAULT_POLAR_SERIES_STROKE:()=>Av,DEFAULT_SEPARATION_LINES_COLOUR:()=>Zg,DEFAULT_SHADOW_COLOUR:()=>Wl,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:()=>Iv,DEFAULT_TEXTBOX_COLOR:()=>cf,DEFAULT_TEXTBOX_FILL:()=>of,DEFAULT_TEXTBOX_STROKE:()=>lf,DEFAULT_TEXT_ANNOTATION_COLOR:()=>Qg,DEFAULT_TOOLBAR_POSITION:()=>hf,IS_DARK_THEME:()=>Lu,PALETTE_ALT_DOWN_FILL:()=>pD,PALETTE_ALT_DOWN_STROKE:()=>dD,PALETTE_ALT_NEUTRAL_FILL:()=>gD,PALETTE_ALT_NEUTRAL_STROKE:()=>fD,PALETTE_ALT_UP_FILL:()=>uD,PALETTE_ALT_UP_STROKE:()=>hD,PALETTE_DOWN_FILL:()=>Mv,PALETTE_DOWN_STROKE:()=>Cv,PALETTE_NEUTRAL_FILL:()=>wv,PALETTE_NEUTRAL_STROKE:()=>Dv,PALETTE_UP_FILL:()=>Sv,PALETTE_UP_STROKE:()=>xv,getChartTheme:()=>vb,resolveOperation:()=>lle,themeNames:()=>ole,themeSymbols:()=>cD,themes:()=>bw});var ole=Object.keys(bw);function lle(e){const t=nr.getDefaultPublicParameters();t.__palette=nr.getDefaultColors();const i={operation:e};return Fy(i,t),i.operation}var ww={};Ua(ww,{Color:()=>yt,interpolateColor:()=>HR});var R={};Ua(R,{AbstractBarSeries:()=>XO,AbstractBarSeriesProperties:()=>BD,ActionOnSet:()=>Dn,AnchoredPopover:()=>R2,Animation:()=>$R,AnimationManager:()=>QR,Arc:()=>Wr,Axis:()=>BM,AxisGroupZIndexMap:()=>o1,AxisInterval:()=>mh,AxisLabel:()=>Hi,AxisTick:()=>yh,AxisTickGenerator:()=>l1,AxisTicks:()=>Lle,BBox:()=>ve,BBoxValues:()=>nh,Background:()=>Iu,BackgroundModule:()=>rO,BandScale:()=>Pg,BarSeries:()=>wf,BarSeriesModule:()=>eF,BaseModuleInstance:()=>Cy,BaseProperties:()=>Be,BaseToolbar:()=>Fw,ButtonWidget:()=>wg,CachedTextMeasurer:()=>mR,CachedTextMeasurerPool:()=>Rr,CallbackCache:()=>VR,Caption:()=>Ht,CartesianAxis:()=>Gg,CartesianSeries:()=>Xl,CartesianSeriesNodeEvent:()=>xD,CartesianSeriesProperties:()=>_o,CategoryAxis:()=>Gl,CategoryScale:()=>Ug,ChangeDetectableProperties:()=>yD,Chart:()=>dv,ChartAxisDirection:()=>W0,ChartEventManager:()=>JR,ChartOptions:()=>xw,ChartUpdateType:()=>Ag,CollapseMode:()=>DO,Color:()=>yt,ColorScale:()=>Zd,ConicGradient:()=>UE,ContextMenuBuiltins:()=>eN,ContextMenuRegistry:()=>tN,ContinuousScale:()=>Mt,DEFAULT_CARTESIAN_DIRECTION_KEYS:()=>Ah,DEFAULT_CARTESIAN_DIRECTION_NAMES:()=>Ih,DEFAULT_TOOLTIP_CLASS:()=>ps,DEFAULT_TOOLTIP_DARK_CLASS:()=>D1,DIRECTION_SWAP_AXES:()=>gO,DOMManager:()=>LR,DataController:()=>BN,DataModel:()=>ON,DataModelSeries:()=>bD,DataService:()=>Yy,Debug:()=>ct,Deprecated:()=>v1,DeprecatedAndRenamedTo:()=>vne,DiscreteTimeScale:()=>Xa,DragInterpreter:()=>cN,DraggablePopover:()=>N2,DropShadow:()=>sr,ExtendedPath2D:()=>Jd,FILL_IMAGE_DEFAULTS:()=>wh,FILL_PATTERN_DEFAULTS:()=>$l,FONT_SIZE_RATIO:()=>lD,FillGradientDefaults:()=>wa,FillImageDefaults:()=>In,FillPatternDefaults:()=>Wt,FloatingToolbar:()=>jle,Gradient:()=>Ly,Group:()=>Ge,GroupedCategoryAxis:()=>Mh,HdpiCanvas:()=>iM,HierarchyNode:()=>Ale,HierarchySeries:()=>Ile,HierarchySeriesProperties:()=>or,HighlightManager:()=>iN,HighlightProperties:()=>vD,HighlightStyle:()=>df,Image:()=>Ku,InteractionManager:()=>ZR,InteractionState:()=>XR,InterpolationProperties:()=>Pu,Invalidating:()=>yg,LARGEST_KEY_INTERVAL:()=>X1,Label:()=>as,LayoutElement:()=>U0,LayoutManager:()=>vR,LegendMarkerLabel:()=>Da,Line:()=>Ks,LineSeries:()=>If,LineSeriesModule:()=>lF,LinearGradient:()=>KE,LinearScale:()=>tr,Listeners:()=>Nl,LogScale:()=>aD,LonLatBBox:()=>Tle,Marker:()=>rs,Menu:()=>Gle,MenuItemWidget:()=>Nw,MenuWidget:()=>P2,MercatorScale:()=>kle,ModuleRegistry:()=>cn,Motion:()=>nM,NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>Za,NativeWidget:()=>lu,NewAreaSeriesModule:()=>YO,NewBarSeriesModule:()=>tF,NewBubbleSeriesModule:()=>nF,NewHistogramSeriesModule:()=>oF,NewLineSeriesModule:()=>cF,NewScatterSeriesModule:()=>uF,NiceMode:()=>s1,Node:()=>xo,NumberAxis:()=>No,ObserveChanges:()=>Rl,OrdinalTimeScale:()=>nv,PHASE_METADATA:()=>Tg,PHASE_ORDER:()=>hu,PREV_NEXT_KEYS:()=>ru,Padding:()=>El,ParallelStateMachine:()=>vse,Path:()=>gn,PointerEvents:()=>zE,PolarAxis:()=>Nu,PolarSeries:()=>sb,PolarZIndexMap:()=>bF,Popover:()=>Ow,PropertiesArray:()=>vg,Property:()=>P,ProxyInteractionService:()=>FR,ProxyOnWrite:()=>yee,ProxyProperty:()=>vt,ProxyPropertyOnWrite:()=>us,QUICK_TRANSITION:()=>Xy,RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD:()=>Pv,RadialColumnShape:()=>ka,Range:()=>qa,Rect:()=>$s,RepeatType:()=>KR,Rotatable:()=>tu,RotatableGroup:()=>jJ,RotatableText:()=>yR,SAFE_FILLS_OPERATION:()=>mD,SAFE_FILL_OPERATION:()=>wae,SAFE_RANGE2_OPERATION:()=>Aae,SAFE_STROKE_FILL_OPERATION:()=>Tv,SKIP_JS_BUILTINS:()=>m0,SMALLEST_KEY_INTERVAL:()=>Y1,SORT_DOMAIN_GROUPS:()=>Z1,Scalable:()=>T0,ScalableGroup:()=>VJ,Scene:()=>Ky,SceneArrayChangeDetection:()=>b0,SceneChangeDetection:()=>he,SceneObjectChangeDetection:()=>$n,Sector:()=>gs,SectorBox:()=>pF,Selection:()=>Pi,Series:()=>hv,SeriesContentZIndexMap:()=>m1,SeriesGroupingChangedEvent:()=>UM,SeriesItemHighlightStyle:()=>Bo,SeriesMarker:()=>os,SeriesNodeEvent:()=>zg,SeriesNodePickMode:()=>y1,SeriesProperties:()=>Qn,SeriesTooltip:()=>Ys,SeriesZIndexMap:()=>f1,Shape:()=>va,SimpleTextMeasurer:()=>j0,SliderWidget:()=>eM,StateMachine:()=>Ng,StateMachineProperty:()=>yse,StopProperties:()=>D0,SvgPath:()=>Rw,TRIPLE_EQ:()=>Xd,Text:()=>is,TextUtils:()=>_t,TextWrapper:()=>H0,ThemeConstants:()=>lO,ThemeSymbols:()=>cD,TimeAxisParentLevel:()=>Au,TimeScale:()=>Bg,Toolbar:()=>zle,ToolbarButtonProperties:()=>Ef,ToolbarButtonWidget:()=>O2,ToolbarWidget:()=>Wy,Tooltip:()=>Sa,TooltipManager:()=>qy,TooltipPosition:()=>Eo,Transformable:()=>ai,TransformableGroup:()=>iu,TransformableText:()=>nu,Translatable:()=>hh,TranslatableGroup:()=>ds,TranslatableLine:()=>$se,UnitTimeScale:()=>Xn,UpdateService:()=>LN,Vec2:()=>Uu,Vec4:()=>Eg,WIDGET_HTML_EVENTS:()=>B0,Widget:()=>Er,WidgetEventUtil:()=>Do,ZIndexMap:()=>jR,ZoomManager:()=>IN,accumulateGroup:()=>Q1,accumulateStack:()=>J1,accumulatedValue:()=>z1,accumulativeValueProperty:()=>$g,addEscapeEventListener:()=>Vy,addHitTestersToQuadtree:()=>OD,addMouseCloseListener:()=>$0,addOverrideFocusVisibleEventListener:()=>X0,addTouchCloseListener:()=>Y0,adjustLabelPlacement:()=>JO,angleBetween:()=>Ty,angleCategoryAxisOptionsDefs:()=>VF,angleNumberAxisOptionsDefs:()=>zF,angularPadding:()=>x0,animationValidation:()=>Mu,annotationCalloutStylesDefs:()=>XF,annotationChannelStyleDefs:()=>gw,annotationChannelTextDefs:()=>WF,annotationCommentStylesDefs:()=>ZF,annotationCrossLineStyleDefs:()=>pw,annotationDisjointChannelStyleDefs:()=>$F,annotationFibonacciStylesDefs:()=>fw,annotationLineStyleDefs:()=>gb,annotationLineTextDefs:()=>pb,annotationMeasurerStylesDefs:()=>fb,annotationNoteStylesDefs:()=>qF,annotationOptionsDef:()=>ju,annotationParallelChannelStyleDefs:()=>YF,annotationQuickMeasurerStylesDefs:()=>QF,annotationShapeStylesDefs:()=>mw,annotationTextStylesDef:()=>Pf,applyShapeFillBBox:()=>cv,applyShapeStyle:()=>xh,areScalingEqual:()=>Th,area:()=>JM,autoSizedLabelOptionsDefs:()=>ec,boxPlotSeriesThemeableOptionsDef:()=>JF,buildFormatter:()=>Lg,buildResetPathFn:()=>LD,calculateDataDiff:()=>VD,calculateDefaultTimeTickFormat:()=>SN,calculateDerivativeExtrema:()=>w0,calculateDerivativeExtremaXY:()=>QE,calculateLabelTranslation:()=>Rle,calculatePlacement:()=>b1,callWithContext:()=>$y,candlestickSeriesThemeableOptionsDef:()=>t2,cartesianAxisCrosshairOptions:()=>Ql,cartesianAxisLabelOptionsDefs:()=>bf,cartesianAxisOptionsDefs:()=>zo,cartesianChartOptionsDefs:()=>NF,cartesianCrossLineOptionsDefs:()=>Go,cartesianNumericAxisLabel:()=>ED,cartesianTimeAxisLabel:()=>xf,cartesianTimeAxisParentLevel:()=>Gv,checkCrisp:()=>ZO,chordSeriesThemeableOptionsDef:()=>i2,clampArray:()=>cM,clippedRoundRect:()=>vv,collapsedStartingBarPosition:()=>Sf,commonAxisLabelOptionsDefs:()=>Lh,commonAxisOptionsDefs:()=>ql,commonChartOptionsDefs:()=>Pe,commonCrossLineLabelOptionsDefs:()=>kh,commonCrossLineOptionsDefs:()=>zr,commonSeriesOptionsDefs:()=>Jn,commonSeriesThemeableOptionsDefs:()=>it,compareDates:()=>iv,computeBarFocusBounds:()=>zD,computeMarkerFocusBounds:()=>vf,coneFunnelSeriesThemeableOptionsDef:()=>s2,continuousAxisOptions:()=>Jl,countExpandingSearch:()=>aN,createButton:()=>Nle,createCheckbox:()=>Ole,createDatumId:()=>Zn,createDeprecationWarning:()=>KM,createIcon:()=>L2,createSelect:()=>Fle,createTextArea:()=>Ble,dateToNumber:()=>Us,datesSortOrder:()=>LM,datumKeys:()=>ev,datumStylerProperties:()=>Ol,deconstructSelectionsOrNodes:()=>Zy,deepClone:()=>Bt,deepFreeze:()=>oh,defaultTimeTickFormat:()=>pM,diff:()=>Du,drawCorner:()=>Xg,drawMarkerUnitPolygon:()=>jg,easing:()=>nM,enterpriseModule:()=>kn,errorBarOptionsDefs:()=>Kv,errorBarThemeableOptionsDefs:()=>Cf,evaluateBezier:()=>Py,extent:()=>Ro,extractDecoratedProperties:()=>FE,fillsOptionsDef:()=>Tf,findMinMax:()=>ss,findQuadtreeMatch:()=>FD,findRangeExtent:()=>du,fixNumericExtent:()=>wn,flowProportionChartOptionsDefs:()=>doe,focusCursorAtEnd:()=>HJ,formatNumber:()=>NR,formatPercent:()=>ER,formatValue:()=>Ao,fromToMotion:()=>Qt,funnelSeriesThemeableOptionsDef:()=>n2,gaugeChartOptionsDefs:()=>uoe,getAngleRatioRadians:()=>VE,getColorStops:()=>YE,getCrossLineValue:()=>e1,getDateTicksForInterval:()=>RM,getDatumRefPoint:()=>rM,getElementBBox:()=>aR,getIconClassNames:()=>Oy,getLastFocus:()=>Hy,getMissCount:()=>mM,getPath:()=>Yd,getPathComponents:()=>NN,getRadialColumnWidth:()=>I2,getSequentialColors:()=>qn,getShapeFill:()=>bh,getShapeStyle:()=>Br,groupAccumulativeValueProperty:()=>zl,groupAverage:()=>G1,groupCount:()=>QM,groupStackValueProperty:()=>$1,groupSum:()=>_1,hasNoModifiers:()=>Dg,heatmapSeriesThemeableOptionsDef:()=>a2,hierarchyChartOptionsDefs:()=>hoe,initMenuKeyNav:()=>DR,initRovingTabIndex:()=>MR,interpolatePoints:()=>Rv,interpolationOptionsDefs:()=>$v,isAgFlowProportionChartOptions:()=>p1,isAgGaugeChartOptions:()=>HM,isAgHierarchyChartOptions:()=>d1,isAgStandaloneChartOptions:()=>jM,isAgTopologyChartOptions:()=>u1,isBetweenAngles:()=>Ll,isButtonClickEvent:()=>Z0,isChartAxisDirection:()=>Eee,isContinuous:()=>av,isDecoratedObject:()=>Ay,isDenseInterval:()=>bu,isGradientFill:()=>Ka,isGradientOrPatternFill:()=>zJ,isImageFill:()=>eu,isInputPending:()=>rR,isObjectWithProperty:()=>_E,isObjectWithStringProperty:()=>fJ,isPatternFill:()=>ch,isProperties:()=>qd,isScaleValid:()=>gf,jsonApply:()=>Sg,jsonDiff:()=>Lr,jsonPropertyCompare:()=>oR,jsonResolveOperations:()=>Fy,jsonWalk:()=>Pr,keyProperty:()=>er,legendSymbolSvg:()=>M1,lineDistanceSquared:()=>xg,linearGaugeSeriesOptionsDef:()=>ic,linearGaugeSeriesThemeableOptionsDef:()=>cb,linearGaugeTargetOptionsDef:()=>ob,listDecoratedProperties:()=>rh,makeAccessibleClickListener:()=>jee,mapLineBackgroundSeriesThemeableOptionsDef:()=>l2,mapLineSeriesThemeableOptionsDef:()=>o2,mapMarkerSeriesThemeableOptionsDef:()=>c2,mapShapeBackgroundSeriesThemeableOptionsDef:()=>d2,mapShapeSeriesThemeableOptionsDef:()=>h2,mapValues:()=>BE,markerFadeInAnimation:()=>ff,markerOptionsDefs:()=>Vo,markerScaleInAnimation:()=>ID,markerSwipeScaleInAnimation:()=>TD,merge:()=>pg,mergeArrayDefaults:()=>Iy,mergeDefaults:()=>Je,midpointStartingBarPosition:()=>ere,moduleRegistry:()=>kr,motion:()=>Wle,nearestSquared:()=>Dy,nearestSquaredInContainer:()=>dJ,nightingaleSeriesThemeableOptionsDef:()=>u2,normaliseGroupTo:()=>gv,normalisePropertyTo:()=>Sh,normalisedExtentWithMetadata:()=>qM,normalizeAngle180:()=>mg,normalizeAngle360:()=>bi,normalizeAngle360FromDegrees:()=>Co,normalizeAngle360Inclusive:()=>CJ,normalizeContinuousDomains:()=>hM,numberFormatValidator:()=>Zl,objectsEqual:()=>dn,objectsEqualWith:()=>f0,ohlcSeriesThemeableOptionsDef:()=>r2,ordinalTimeAxisOptionsDefs:()=>zu,pairUpSpans:()=>pf,partialAssign:()=>v0,pathFadeInAnimation:()=>Fv,pathMotion:()=>kv,pathSwipeInAnimation:()=>kD,pickByMatchingAngle:()=>ZD,plotAreaPathFill:()=>_O,plotInterpolatedAreaSeriesFillSpans:()=>Ov,plotInterpolatedLinePathStroke:()=>Nv,plotLinePathStroke:()=>DD,polarChartOptionsDefs:()=>OF,prepareAreaFillAnimationFns:()=>GO,prepareAreaPathAnimation:()=>zO,prepareAxisAnimationContext:()=>n1,prepareAxisAnimationFunctions:()=>a1,prepareBarAnimationFunctions:()=>Mf,prepareLinePathAnimation:()=>BO,prepareLinePathPropertyAnimation:()=>AD,prepareLinePathStrokeAnimationFns:()=>wD,preparePieSeriesAnimationFunctions:()=>Eh,pyramidSeriesThemeableOptionsDef:()=>p2,radarAreaSeriesThemeableOptionsDef:()=>g2,radarLineSeriesThemeableOptionsDef:()=>f2,radialBarSeriesThemeableOptionsDef:()=>m2,radialColumnSeriesThemeableOptionsDef:()=>y2,radialGaugeSeriesOptionsDef:()=>kf,radialGaugeSeriesThemeableOptionsDef:()=>hb,radialGaugeTargetOptionsDef:()=>lb,radiusCategoryAxisOptionsDefs:()=>HF,radiusNumberAxisOptionsDefs:()=>jF,range:()=>sv,rangeAreaSeriesThemeableOptionsDef:()=>v2,rangeBarSeriesThemeableOptionsDef:()=>b2,rangeValidator:()=>jv,rangedValueProperty:()=>eD,resetAxisGroupFn:()=>r1,resetAxisLabelSelectionFn:()=>lv,resetAxisLineSelectionFn:()=>FM,resetBarSelectionsFn:()=>Df,resetLabelFn:()=>Fo,resetMarkerFn:()=>mf,resetMarkerPositionFn:()=>yf,resetMotion:()=>ns,resetPieSelectionsFn:()=>XD,rowCountProperty:()=>U1,sankeySeriesThemeableOptionsDef:()=>x2,scale:()=>Xs,sectorBox:()=>gF,seriesLabelFadeInAnimation:()=>dt,seriesLabelFadeOutAnimation:()=>Yl,seriesLabelOptionsDefs:()=>bt,setElementBBox:()=>Ny,setPath:()=>y0,shadowOptionsDefs:()=>Vr,shallowClone:()=>E0,solveBezier:()=>Ey,sortAndUniqueDates:()=>kM,splitBezier:()=>Ry,standaloneChartOptionsDefs:()=>coe,staticFromToMotion:()=>ko,stopPageScrolling:()=>wR,sum:()=>Hne,sumValues:()=>pv,sunburstSeriesThemeableOptionsDef:()=>C2,timeIntervalUnit:()=>PD,toDegrees:()=>SJ,toRadians:()=>Vi,toolbarButtonOptionsDefs:()=>Ph,tooltipContentAriaLabel:()=>A1,tooltipHtml:()=>k1,tooltipOptionsDefs:()=>nt,topologyChartOptionsDefs:()=>loe,trailingAccumulatedValue:()=>V1,trailingAccumulatedValueProperty:()=>$ne,treemapSeriesThemeableOptionsDef:()=>S2,updateClipPath:()=>Bv,updateLabelNode:()=>QO,validateCrossLineValue:()=>t1,valueProperty:()=>et,visibleRangeIndices:()=>nN,waterfallSeriesThemeableOptionsDef:()=>M2,without:()=>be});var Uu={add:cle,angle:fle,apply:Dle,equal:Sle,distance:ule,distanceSquared:ple,from:Mle,gradient:yle,intercept:vle,intersectAtX:xle,intersectAtY:ble,length:Iw,lengthSquared:dle,multiply:hle,normalized:gle,origin:T2,required:wle,rotate:mle,round:Cle,sub:Aw};function cle(e,t){return typeof t=="number"?{x:e.x+t,y:e.y+t}:{x:e.x+t.x,y:e.y+t.y}}function Aw(e,t){return typeof t=="number"?{x:e.x-t,y:e.y-t}:{x:e.x-t.x,y:e.y-t.y}}function hle(e,t){return typeof t=="number"?{x:e.x*t,y:e.y*t}:{x:e.x*t.x,y:e.y*t.y}}function Iw(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function dle(e){return e.x*e.x+e.y*e.y}function ule(e,t){const i=Aw(e,t);return Math.sqrt(i.x*i.x+i.y*i.y)}function ple(e,t){const i=Aw(e,t);return i.x*i.x+i.y*i.y}function gle(e){const t=Iw(e);return{x:e.x/t,y:e.y/t}}function fle(e,t){return t==null?Math.atan2(e.y,e.x):Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x)}function mle(e,t,i=T2()){const s=Iw(e);return{x:i.x+s*Math.cos(t),y:i.y+s*Math.sin(t)}}function yle(e,t,i){const s=t.x-e.x;return(i==null?t.y-e.y:i-t.y-(i-e.y))/s}function vle(e,t,i){return(i==null?e.y:i-e.y)-t*e.x}function ble(e,t,i=0,s){return{x:e===1/0?1/0:(i-t)/e,y:s==null?i:s-i}}function xle(e,t,i=0,s){const n=e===1/0?1/0:e*i+t;return{x:i,y:s==null?n:s-n}}function Cle(e,t=2){return{x:h0(e.x,t),y:h0(e.y,t)}}function Sle(e,t){return e.x===t.x&&e.y===t.y}function Mle(e,t){if(typeof e=="number")return{x:e,y:t};if("currentX"in e)return{x:e.currentX,y:e.currentY};if("offsetWidth"in e)return{x:e.offsetWidth,y:e.offsetHeight};if("width"in e)return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y+e.height}];if("x1"in e)return[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2}];throw new Error(`Values can not be converted into a vector: [${JSON.stringify(e)}] [${t}]`)}function Dle(e,t){return e.x=t.x,e.y=t.y,e}function wle(e){var t,i;return{x:(t=e==null?void 0:e.x)!=null?t:0,y:(i=e==null?void 0:e.y)!=null?i:0}}function T2(){return{x:0,y:0}}var k2=class XC{constructor(t,i,s,n,a,r,o,l,c){this.series=t,this.datumIndex=i,this.datum=s,this.sizeValue=n,this.colorValue=a,this.sumSize=r,this.depth=o,this.parent=l,this.children=c,this.midPoint={x:0,y:0}}get hasChildren(){return this.children.length>0}walk(t,i=XC.Walk.PreOrder){i===XC.Walk.PreOrder&&t(this),this.children.forEach(s=>{s.walk(t,i)}),i===XC.Walk.PostOrder&&t(this)}*[Symbol.iterator](){yield this;for(const t of this.children)yield*UC(t)}};k2.Walk={PreOrder:0,PostOrder:1};var Ale=k2,Ile=class extends hv{constructor(e){super({moduleCtx:e,pickModes:[1,0]}),this.colorDomain=[0,0],this.maxDepth=0,this.colorScale=new Zd,this.animationState=new Ng("empty",{empty:{update:{target:"ready",action:t=>this.animateEmptyUpdateReady(t)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:t=>this.animateReadyHighlight(t),resize:t=>this.animateReadyResize(t),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:t=>this.animateWaitingUpdateReady(t)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:t=>this.animateClearingUpdateEmpty(t)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}processData(){const{NodeClass:e}=this,{childrenKey:t,sizeKey:i,colorKey:s,colorRange:n}=this.properties;let a=0,r=1/0,o=-1/0;const l=(u,p,g)=>{const f=g.depth!=null?g.depth+1:0,y=t!=null?u[t]:void 0,v=y==null||y.length===0;let x=i!=null?u[i]:void 0;Number.isFinite(x)?x=Math.max(x,0):x=v?1:0;const S=x;a=Math.max(a,f);const M=s!=null?u[s]:void 0;return typeof M=="number"&&(r=Math.min(r,M),o=Math.max(o,M)),c(new e(this,p,u,x,M,S,f,g,[]),y)},c=(u,p)=>{const{datumIndex:g}=u;return p==null||p.forEach((f,y)=>{const v=l(f,g.concat(y),u);u.children.push(v),u.sumSize+=v.sumSize}),u},h=c(new e(this,[],void 0,0,void 0,0,void 0,void 0,[]),this.data),d=[r,o];this.colorScale.domain=r<o?[r,o]:[0,1],this.colorScale.range=n!=null?n:["black"],this.colorScale.update(),this.rootNode=h,this.maxDepth=a,this.colorDomain=d}update({seriesRect:e}){this.updateSelections(),this.updateNodes();const t=this.getAnimationData();this.checkResize(e)&&this.animationState.transition("resize",t),this.animationState.transition("update",t)}resetAllAnimation(e){this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateWaitingUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateReadyHighlight(e){}animateReadyResize(e){this.resetAllAnimation(e)}animateClearingUpdateEmpty(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}getAnimationData(){return{}}isProcessedDataAnimatable(){return!0}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}getLegendData(e){const{colorKey:t,colorName:i,colorRange:s}=this.properties,{id:n,ctx:{legendManager:a},visible:r}=this;return e==="gradient"&&t!=null&&s!=null?[{legendType:"gradient",enabled:r&&a.getItemEnabled({seriesId:n}),seriesId:n,colorName:i,colorRange:s,colorDomain:this.colorDomain}]:[]}getDatumIdFromData(e){return e.datumIndex.join(":")}getDatumId(e){return this.getDatumIdFromData(e)}removeMeIndexPathForIndex(e){var t,i;return(i=(t=this.datumSelection.at(e+1))==null?void 0:t.datum.datumIndex)!=null?i:[]}removeMeIndexForIndexPath(e){for(const{index:t,datum:i}of this.datumSelection)if(fa(i.datumIndex,e))return t-1;return 0}pickFocus(e){var l;if(!((l=this.rootNode)!=null&&l.children.length))return;const t=we(0,e.datumIndex-e.datumIndexDelta,this.datumSelection.length-1),{datumIndexDelta:i,otherIndexDelta:s}=e;let n=this.removeMeIndexPathForIndex(t);const a=n.reduce((c,h)=>c.children[h],this.rootNode);if(s>0&&a.hasChildren)n=[...n,0];else if(s<0&&n.length>1)n=n.slice(0,-1);else if(s===0&&i!==0){const c=a.parent.children.length-1;n=n.slice(),n[n.length-1]=we(0,n[n.length-1]+i,c)}const r=n.reduce((c,h)=>c.children[h],this.rootNode),o=this.computeFocusBounds(this.datumSelection.at(t+1));if(o!=null)return{datum:r,datumIndex:this.removeMeIndexForIndexPath(n),otherIndex:r.depth,bounds:o,clipFocusBox:!0}}getDatumAriaText(e,t){var i;if(!(e instanceof this.NodeClass)){se.error(`datum is not HierarchyNode: ${JSON.stringify(e)}`);return}return this.ctx.localeManager.t("ariaAnnounceHierarchyDatum",{level:((i=e.depth)!=null?i:-1)+1,count:e.children.length,description:t})}getCategoryValue(e){}datumIndexForCategoryValue(e){}},or=class extends Qn{constructor(){super(...arguments),this.childrenKey="children",this.fills=Object.values(xi),this.fillGradientDefaults=new wa,this.fillPatternDefaults=new Wt,this.fillImageDefaults=new In,this.strokes=Object.values(jr)}};I([P],or.prototype,"childrenKey",2),I([P],or.prototype,"sizeKey",2),I([P],or.prototype,"colorKey",2),I([P],or.prototype,"colorName",2),I([P],or.prototype,"fills",2),I([P],or.prototype,"fillGradientDefaults",2),I([P],or.prototype,"fillPatternDefaults",2),I([P],or.prototype,"fillImageDefaults",2),I([P],or.prototype,"strokes",2),I([P],or.prototype,"colorRange",2);var Tle=class{constructor(e,t,i,s){this.lon0=e,this.lat0=t,this.lon1=i,this.lat1=s}merge(e){this.lon0=Math.min(this.lon0,e.lon0),this.lat0=Math.min(this.lat0,e.lat0),this.lon1=Math.max(this.lon1,e.lon1),this.lat1=Math.max(this.lat1,e.lat1)}},bb=Math.PI/180,Tw=e=>e*bb,kw=e=>-Math.log(Math.tan(Math.PI*.25+e*bb*.5)),Lw=e=>e/bb,Pw=e=>(Math.atan(Math.exp(-e))-Math.PI*.25)/(bb*.5),kle=class zT extends ky{constructor(t,i){super(),this.domain=t,this.range=i,this.type="mercator",this.bounds=zT.bounds(t)}static bounds(t){const[[i,s],[n,a]]=t,r=Tw(i),o=kw(s),l=Tw(n),c=kw(a);return new ve(Math.min(r,l),Math.min(o,c),Math.abs(l-r),Math.abs(c-o))}static fixedScale(){return new zT([[Lw(0),Pw(0)],[Lw(1),Pw(1)]],[[0,0],[1,1]])}toDomain(){}normalizeDomains(...t){let i=-1/0,s=1/0,n=-1/0,a=1/0;for(const r of t)for(const[o,l]of r)i=Math.min(o,i),s=Math.max(o,s),n=Math.min(l,n),a=Math.max(l,a);return{domain:[[i,n],[s,a]],animatable:!0}}convert([t,i]){const[[s,n],[a,r]]=this.range,o=(a-s)/this.bounds.width,l=(r-n)/this.bounds.height;return[(Tw(t)-this.bounds.x)*o+s,(kw(i)-this.bounds.y)*l+n]}invert([t,i]){const[[s,n],[a,r]]=this.range,o=(a-s)/this.bounds.width,l=(r-n)/this.bounds.height;return[Lw((t-s)/o+this.bounds.x),Pw((i-n)/l+this.bounds.y)]}},Ew=class VT{constructor(){this.id=Hs(this),this.axisGroup=new ds({name:`${this.id}-AxisTicks`,zIndex:2}),this.labelSelection=Pi.select(this.axisGroup,is),this.interval=new mh,this.label=new Hi,this.scale=new tr,this.position="bottom",this.translationX=0,this.translationY=0,this.padding=0}attachAxis(t){t.appendChild(this.axisGroup)}calculateLayout(){const t=[],i=this.generateTicks(),{translationX:s,translationY:n}=this;return this.labelSelection.update(i.ticks.map(a=>this.createLabelDatum(a)),void 0,a=>a.tickId),this.labelSelection.each((a,r)=>{a.setProperties(r),r.visible&&t.push(a.getBBox())}),this.axisGroup.setProperties({translationX:s,translationY:n}),t.length>0?ve.merge(t):void 0}getLabelParams(t){const{padding:i}=this,{translate:s}=t;switch(this.position){case"top":case"bottom":return{x:s,y:i,textAlign:"center",textBaseline:"top"};case"left":case"right":return{x:i,y:s,textAlign:"start",textBaseline:"middle"}}}inRange(t,i=.001){const[s,n]=ss(this.scale.range);return t>=s-i&&t<=n+i}createLabelDatum(t){const{x:i,y:s,textBaseline:n,textAlign:a}=this.getLabelParams(t);return{visible:!!t.tickLabel,tickId:t.tickId,fill:this.label.color,fontFamily:this.label.fontFamily,fontSize:this.label.fontSize,fontStyle:this.label.fontStyle,fontWeight:this.label.fontWeight,rotation:0,rotationCenterX:0,text:t.tickLabel,textAlign:a,textBaseline:n,x:i,y:s}}generateTicks(){const{minSpacing:t,maxSpacing:i}=this.interval,{maxTickCount:s,minTickCount:n,tickCount:a}=qN(du(this.scale.range),1,t,i,VT.DefaultTickCount,VT.DefaultMinSpacing),r=this.getTicksData({nice:!0,interval:this.interval.step,tickCount:a,minTickCount:n,maxTickCount:s});if(this.position==="bottom"||this.position==="top"){const o=Rr.getMeasurer({font:this.label}),{domain:l}=this.scale,h=l[0]>l[1]?-1:1;let d=-1/0*h;r.ticks=r.ticks.filter(u=>Math.sign(u.translate-d)!==h?!1:(d=u.translate+o.textWidth(u.tickLabel,!0)*h,!0))}return r}getTicksData(t){var c,h,d,u,p;const i=[],s=t.nice?this.scale.niceDomain(t):this.scale.domain,n=(h=(c=this.scale.ticks(t,s))==null?void 0:c.ticks)!=null?h:[],a=n.reduce((g,f)=>Math.max(g,Ud(f)),0),r=[],o=_M(),l=typeof this.label.format=="string"?this.scale.tickFormatter({domain:s,ticks:n,fractionDigits:a,specifier:this.label.format}):g=>Ao(g,a);for(let g=0;g<n.length;g++){const f=n[g],y=this.scale.convert(f);if(!this.inRange(y))continue;const v=(p=(u=(d=this.label).formatter)==null?void 0:u.call(d,{value:f,index:g,domain:s,fractionDigits:a,boundSeries:r}))!=null?p:l(f),x=o(v);i.push({tick:f,tickId:x,tickLabel:v,translate:y})}return{rawTicks:n,fractionDigits:a,ticks:i}}};Ew.DefaultTickCount=5,Ew.DefaultMinSpacing=10;var Lle=Ew,Ple={top:{xTranslationDirection:0,yTranslationDirection:-1},bottom:{xTranslationDirection:0,yTranslationDirection:1},left:{xTranslationDirection:-1,yTranslationDirection:0},right:{xTranslationDirection:1,yTranslationDirection:0},"top-left":{xTranslationDirection:1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"bottom-right":{xTranslationDirection:-1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:1,yTranslationDirection:0},"inside-right":{xTranslationDirection:-1,yTranslationDirection:0},"inside-top":{xTranslationDirection:0,yTranslationDirection:1},"inside-bottom":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-right":{xTranslationDirection:-1,yTranslationDirection:-1}},Ele={top:{xTranslationDirection:1,yTranslationDirection:0},bottom:{xTranslationDirection:-1,yTranslationDirection:0},left:{xTranslationDirection:0,yTranslationDirection:-1},right:{xTranslationDirection:0,yTranslationDirection:1},"top-left":{xTranslationDirection:-1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"bottom-right":{xTranslationDirection:1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:0,yTranslationDirection:1},"inside-right":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top":{xTranslationDirection:-1,yTranslationDirection:0},"inside-bottom":{xTranslationDirection:1,yTranslationDirection:0},"inside-top-left":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"inside-bottom-right":{xTranslationDirection:1,yTranslationDirection:-1}};function Rle({yDirection:e,padding:t=0,position:i="top",bbox:s}){const n=e?Ple:Ele,{xTranslationDirection:a,yTranslationDirection:r}=n[i],o=a*(t+s.width/2),l=r*(t+s.height/2);return{xTranslation:o,yTranslation:l}}function Nle(e,t){const i=ke("button",xb("ag-charts-input ag-charts-button",t));return e.label!==void 0?i.append(e.label):(i.append(L2(e.icon)),i.ariaLabel=e.altText),i.addEventListener("click",e.onPress),bo(i,t),i}function Ole(e,t){const i=ke("input",xb("ag-charts-input ag-charts-checkbox",t));return i.type="checkbox",i.checked=e.checked,i.addEventListener("change",s=>e.onChange(i.checked,s)),i.addEventListener("keydown",s=>{Z0(s)&&(s.preventDefault(),i.click())}),bo(i,t),i}function Fle(e,t){const i=ke("select",xb("ag-charts-input ag-charts-select",t));return i.append(...e.options.map(s=>{const n=ke("option");return n.value=s.value,n.textContent=s.label,n})),$e(i,"data-preventdefault",!1),i.value=e.value,i.addEventListener("change",s=>e.onChange(i.value,s)),bo(i,t),i}function Ble(e,t){const i=ke("textarea",xb("ag-charts-input ag-charts-textarea",t));return i.value=e.value,i.addEventListener("input",s=>e.onChange(i.value,s)),bo(i,t),$e(i,"data-preventdefault",!1),i}function L2(e){const t=ke("span",`ag-charts-icon ag-charts-icon-${e}`);return $e(t,"aria-hidden",!0),t}function xb(e,t){return t==null?e:`${e} ${t.class}`}var Rw=class extends gn{constructor(e=""){super(),this.x=0,this.y=0,this.commands=[],this._d="",this.d=e}get d(){return this._d}set d(e){if(e!==this._d){this._d=e,this.commands.length=0;for(const[t,i,s]of e.matchAll(/([A-Z])([0-9. ]*)/g)){const n=s.split(/\s+/g).map(Number);this.commands.push([i,n])}this.checkPathDirty()}}updatePath(){const{path:e,x:t,y:i}=this;e.clear();let s=t,n=i;for(const[a,r]of this.commands)switch(a){case"M":e.moveTo(t+r[0],i+r[1]),s=t+r[0];break;case"C":e.cubicCurveTo(t+r[0],i+r[1],t+r[2],i+r[3],t+r[4],i+r[5]),s=t+r[4],n=i+r[5];break;case"H":e.lineTo(t+r[0],n),s=i+r[0];break;case"L":e.lineTo(t+r[0],i+r[1]),s=t+r[0],n=i+r[1];break;case"V":e.lineTo(s,i+r[0]),n=i+r[0];break;case"Z":e.closePath();break;default:throw new Error(`Could not translate command '${a}' with '${r.join(" ")}'`)}e.closePath()}};I([he()],Rw.prototype,"x",2),I([he()],Rw.prototype,"y",2);var Ku=class extends xo{constructor(e){super(),this.sourceImage=e,this.x=0,this.y=0,this.width=0,this.height=0,this.opacity=1}render(e){const{ctx:t}=e,i=this.sourceImage;i&&(t.globalAlpha=this.opacity,t.drawImage(i,0,0,i.width,i.height,this.x,this.y,this.width,this.height)),super.render(e)}};I([he()],Ku.prototype,"x",2),I([he()],Ku.prototype,"y",2),I([he()],Ku.prototype,"width",2),I([he()],Ku.prototype,"height",2),I([he()],Ku.prototype,"opacity",2);var Cb={};Ua(Cb,{ButtonWidget:()=>wg,MenuItemWidget:()=>Nw,MenuWidget:()=>P2,NativeWidget:()=>lu,SliderWidget:()=>eM,ToolbarWidget:()=>Wy,WIDGET_HTML_EVENTS:()=>B0,Widget:()=>Er,WidgetEventUtil:()=>Do});var Nw=class extends PR{constructor(){super(ke("div"),"menuitem")}},_le=["Escape","ArrowLeft"],P2=class zj extends Q0{constructor(t="vertical"){super(t,"menu"),this.closeSubMenu=i=>this.openSubMenu(i,void 0)}destructor(){this.selfClose("2")}addSeparator(){const t=Sr().createElement("div");return $e(t,"role","separator"),this.elem.appendChild(t),t}onChildAdded(t){super.onChildAdded(t),t.hasPopup()||t.addListener("mouseenter",this.closeSubMenu)}onChildRemoved(t){super.onChildRemoved(t),t.hasPopup()||t.removeListener("mouseenter",this.closeSubMenu)}addSubMenu(){const t=new Nw,i=sh(),s=new zj(this.orientation),n=r=>{t.isDisabled()||this.openSubMenu(r,s)},a=r=>{Dg(r.sourceEvent)&&r.sourceEvent.code==="ArrowRight"&&n(r)};return t.setAriaHasPopup("menu"),t.setAriaExpanded(!1),t.setAriaControls(i),t.addListener("click",n),t.addListener("mouseenter",n),t.addListener("keydown",a),s.addListener("close-widget",()=>t.setAriaExpanded(!1)),s.addListener("open-widget",()=>t.setAriaExpanded(!0)),s.id=i,this.addChild(t),{subMenuButton:t,subMenu:s}}openSubMenu(t,i){var n;const{openScope:s}=this;s&&((n=s.openSubMenu)==null||n.selfClose("4"),i==null||i.open(t),s.openSubMenu=i)}open(t,i){var a,r;const{overrideFocusVisible:s=void 0}=i!=null?i:{};if(this.openScope!=null)return;this.openScope={lastFocus:Hy(t.sourceEvent),openSubMenu:void 0,abort:()=>this.selfClose("1"),close:()=>this.selfClose("0"),removers:new K0};const n=this.children.map(o=>o.getElement());$e(this.openScope.lastFocus,"aria-expanded",!0),$0(this.openScope.removers,this.elem,this.openScope.abort),Y0(this.openScope.removers,this.elem,this.openScope.abort);for(const o of this.children)Vy(this.openScope.removers,o.getElement(),this.openScope.close,_le);s!==void 0&&X0(this.openScope.removers,this.elem,n,s),(a=this.internalListener)==null||a.dispatch("open-widget",this,{type:"open-widget"}),(r=this.children[0])==null||r.focus({preventScroll:!0})}selfClose(t){var a;if(this.openScope===void 0)return;const{lastFocus:i,removers:s,openSubMenu:n}=this.openScope;this.openScope=void 0,n==null||n.selfClose("3"),$e(i,"aria-expanded",!1),t==="0"&&(i==null||i.focus({preventScroll:!0})),s.destroy(),(a=this.internalListener)==null||a.dispatch("close-widget",this,{type:"close-widget"})}close(){this.selfClose("0")}},E2="canvas-overlay",Ow=class extends Cy{constructor(e,t,i){super(),this.ctx=e,this.hideFns=[],this.moduleId=`popover-${t}`,i!=null&&i.detached?this.element=ke("div"):this.element=e.domManager.addChild(E2,this.moduleId),this.element.setAttribute("role","presentation"),this.destroyFns.push(()=>e.domManager.removeChild(E2,this.moduleId))}attachTo(e){this.element.parentElement||e.element.append(this.element)}hide(e){const{lastFocus:t=this.lastFocus}=e!=null?e:{};this.element.children.length!==0&&(this.hideFns.forEach(i=>i()),t==null||t.focus(),this.lastFocus=void 0)}removeChildren(){this.element.replaceChildren()}showWithChildren(e,t){if(!this.element.parentElement)throw new Error("Can not show popover that has not been attached to a parent.");const i=ke("div","ag-charts-popover");if(t.ariaLabel!=null&&i.setAttribute("aria-label",t.ariaLabel),t.class!=null&&i.classList.add(t.class),i.replaceChildren(...e),this.element.replaceChildren(i),this.hideFns.push(()=>this.removeChildren()),t.onHide&&this.hideFns.push(t.onHide),t.initialFocus&&t.sourceEvent){const s=Hy(t.sourceEvent);s!==void 0&&(this.lastFocus=s,this.initialFocus=t.initialFocus)}return i}getPopoverElement(){return this.element.firstElementChild}updatePosition(e){var i;const t=this.getPopoverElement();t&&(t.style.setProperty("right","unset"),t.style.setProperty("bottom","unset"),e.x!=null&&t.style.setProperty("left",`${Math.floor(e.x)}px`),e.y!=null&&t.style.setProperty("top",`${Math.floor(e.y)}px`),(i=this.initialFocus)==null||i.focus(),this.initialFocus=void 0)}},R2=class extends Ow{setAnchor(e,t){this.anchor=e,this.fallbackAnchor=t,this.updatePosition(e),this.repositionWithinBounds()}showWithChildren(e,t){var a,r;const i=(a=t.anchor)!=null?a:this.anchor,s=(r=t.fallbackAnchor)!=null?r:this.fallbackAnchor,n=super.showWithChildren(e,t);return i&&this.setAnchor(i,s),Ct().requestAnimationFrame(()=>{this.repositionWithinBounds()}),n}repositionWithinBounds(){const{anchor:e,ctx:t,fallbackAnchor:i}=this,s=this.getPopoverElement();if(!e||!s)return;const n=t.domManager.getBoundingClientRect(),{offsetWidth:a,offsetHeight:r}=s;let o=we(0,e.x,n.width-a),l=we(0,e.y,n.height-r);o!==e.x&&(i==null?void 0:i.x)!=null&&(o=we(0,i.x-a,n.width-a)),l!==e.y&&(i==null?void 0:i.y)!=null&&(l=we(0,i.y-r,n.height-r)),this.updatePosition({x:o,y:l})}},Gle=class extends R2{show(e){const t=e.items.map(s=>this.createRow(e,s)),i=this.showWithChildren(t,e);i.classList.add("ag-charts-menu"),i.setAttribute("role","menu"),this.menuCloser=DR({orientation:"vertical",menu:i,buttons:t,sourceEvent:e.sourceEvent,closeCallback:()=>this.hide()}),this.hideFns.push(()=>{var s;(s=this.menuCloser)==null||s.finishClosing(),this.menuCloser=void 0})}createRow(e,t){const{menuItemRole:i="menuitem"}=e,s=t.value===e.value,n=ke("div","ag-charts-menu__row");if(n.setAttribute("role",i),i==="menuitemradio"&&n.setAttribute("aria-checked",(e.value===t.value).toString()),typeof t.value=="string"&&(n.dataset.popoverId=t.value),n.classList.toggle("ag-charts-menu__row--active",s),t.icon!=null){const l=ke("span",`ag-charts-menu__icon ${Oy(t.icon)}`);n.appendChild(l)}const a=t.strokeWidth!=null;if(a&&(n.classList.toggle("ag-charts-menu__row--stroke-width-visible",a),n.style.setProperty("--strokeWidth",a?`${t.strokeWidth}px`:null)),t.label!=null){const l=ke("span","ag-charts-menu__label");l.textContent=this.ctx.localeManager.t(t.label),n.appendChild(l)}"altText"in t&&(n.ariaLabel=this.ctx.localeManager.t(t.altText));const r=()=>{var l;(l=e.onPress)==null||l.call(e,t)},o=l=>{Z0(l)&&(r(),l.preventDefault(),l.stopPropagation())};return n.addEventListener("keydown",o),n.addEventListener("click",o),n.addEventListener("mousemove",()=>{n.focus({preventScroll:!0})}),n}},N2=class extends Ow{constructor(){super(...arguments),this.dragged=!1}setDragHandle(e){e.addListener("drag-start",t=>{e.addClass(this.dragHandleDraggingClass),this.onDragStart(t)}),e.addListener("drag-move",this.onDragMove.bind(this)),e.addListener("drag-end",()=>{e.removeClass(this.dragHandleDraggingClass),this.onDragEnd.bind(this)})}onDragStart(e){const t=this.getPopoverElement();t&&(e.sourceEvent.preventDefault(),this.dragged=!0,this.dragStartState={client:Uu.from(e.clientX,e.clientY),position:Uu.from(Number(t.style.getPropertyValue("left").replace("px","")),Number(t.style.getPropertyValue("top").replace("px","")))})}onDragMove(e){const{dragStartState:t}=this,i=this.getPopoverElement();if(!t||!i)return;const s=Uu.sub(Uu.from(e.clientX,e.clientY),t.client),n=Uu.add(t.position,s),a=this.ctx.domManager.getBoundingClientRect(),r={};n.x>=0&&n.x+i.offsetWidth<=a.width&&(r.x=n.x),n.y>=0&&n.y+i.offsetHeight<=a.height&&(r.y=n.y),this.updatePosition(r)}onDragEnd(){this.dragStartState=void 0}},Ef=class extends Be{};I([P],Ef.prototype,"icon",2),I([P],Ef.prototype,"label",2),I([P],Ef.prototype,"ariaLabel",2),I([P],Ef.prototype,"tooltip",2);var O2=class extends wg{constructor(e){super(),this.localeManager=e}update(e){const{localeManager:t}=this;e.tooltip&&(this.elem.title=t.t(e.tooltip));let i="";if(e.icon!=null&&(i=`<span class="${Oy(e.icon)} ag-charts-toolbar__icon"></span>`),e.label!=null){const s=t.t(e.label);i=`${i}<span class="ag-charts-toolbar__label">${s}</span>`}this.elem.innerHTML=i}setChecked(e){$e(this.elem,"aria-checked",e)}},F2="ag-charts-toolbar__button--active",Fw=class extends Wy{constructor(e,t="horizontal"){super(t),this.localeManager=e,this.horizontalSpacing=10,this.verticalSpacing=10,this.events=new Nl,this.hasPrefix=!1,this.buttonWidgets=[],this.addClass("ag-charts-toolbar"),this.toggleClass("ag-charts-toolbar--horizontal",t==="horizontal"),this.toggleClass("ag-charts-toolbar--vertical",t==="vertical")}addToolbarListener(e,t){return this.events.addListener(e,t)}clearButtons(){for(const e of this.buttonWidgets)e.destroy();this.buttonWidgets.splice(0)}updateButtons(e){var i;const{buttonWidgets:t}=this;for(const[s,n]of e.entries())((i=this.buttonWidgets.at(s))!=null?i:this.createButton(s,n)).update(n);for(let s=e.length;s<t.length;s++){const n=this.buttonWidgets.at(s);n==null||n.destroy()}this.buttonWidgets.splice(e.length),this.refreshButtonClasses()}updateButtonByIndex(e,t){var i;(i=this.buttonWidgets.at(e))==null||i.update(t)}clearActiveButton(){for(const e of this.buttonWidgets)e.toggleClass(F2,!1)}toggleActiveButtonByIndex(e){if(e!==-1)for(const[t,i]of this.buttonWidgets.entries())i.toggleClass(F2,e!=null&&e===t)}toggleButtonEnabledByIndex(e,t){var i;e!==-1&&((i=this.buttonWidgets.at(e))==null||i.setEnabled(t))}toggleSwitchCheckedByIndex(e,t){var i;e!==-1&&((i=this.buttonWidgets.at(e))==null||i.setChecked(t))}getButtonBounds(){return this.buttonWidgets.map(e=>this.getButtonWidgetBounds(e))}setButtonHiddenByIndex(e,t){var i;(i=this.buttonWidgets.at(e))==null||i.setHidden(t)}getButtonWidgetBounds(e){const t=this.getBounds(),i=e.getBounds();return new ve(i.x+t.x,i.y+t.y,i.width,i.height)}refreshButtonClasses(){var a;const{buttonWidgets:e,hasPrefix:t}=this;let i,s,n;for(const[r,o]of e.entries())i=!t&&r===0||n!=o.section,s=r===e.length-1||o.section!=((a=e.at(r+1))==null?void 0:a.section),o.toggleClass("ag-charts-toolbar__button--first",i),o.toggleClass("ag-charts-toolbar__button--last",s),o.toggleClass("ag-charts-toolbar__button--gap",r>0&&i),n=o.section}createButton(e,t){const i=this.createButtonWidget();return i.addClass("ag-charts-toolbar__button"),i.addListener("click",s=>{const n=b({index:e},t instanceof Be?t.toJson():t),a=this.getButtonWidgetBounds(i);this.events.dispatch("button-pressed",{event:s,button:n,buttonBounds:a})}),i.addListener("focus",()=>{this.events.dispatch("button-focused",{button:{index:e}})}),t.section&&(i.section=t.section),this.buttonWidgets.push(i),this.addChild(i),i}},zle=class extends Fw{createButtonWidget(){return new O2(this.localeManager)}},Vle=class extends N2{constructor(e,t,i){super(e,t),this.onPopoverMoved=i,this.dragHandleDraggingClass="ag-charts-floating-toolbar__drag-handle--dragging"}show(e,t={}){this.showWithChildren(e,E(b({},t),{class:"ag-charts-floating-toolbar"}))}hide(){this.dragged=!1,super.hide()}getBounds(){var t,i,s,n;const e=this.getPopoverElement();return new ve((t=e==null?void 0:e.offsetLeft)!=null?t:0,(i=e==null?void 0:e.offsetTop)!=null?i:0,(s=e==null?void 0:e.offsetWidth)!=null?s:0,(n=e==null?void 0:e.offsetHeight)!=null?n:0)}hasBeenDragged(){return this.dragged}setAnchor(e,t,i){var c;const s=this.getPopoverElement();if(!s)return;const n=(c=e.position)!=null?c:"above",{offsetWidth:a,offsetHeight:r}=s;let o=e.y-r-i,l=e.x-a/2;n==="below"?o=e.y+i:n==="right"?(o=e.y-r/2,l=e.x+t):n==="above-left"&&(l=e.x),this.updatePosition({x:l,y:o})}ignorePointerEvents(){const e=this.getPopoverElement();e&&(e.style.pointerEvents="none")}capturePointerEvents(){const e=this.getPopoverElement();e&&(e.style.pointerEvents="unset")}updatePosition(e){const t=this.getBounds(),i=this.ctx.domManager.getBoundingClientRect();e.x=Math.floor(we(0,e.x,i.width-t.width)),e.y=Math.floor(we(0,e.y,i.height-t.height)),super.updatePosition(e),this.onPopoverMoved()}},jle=class extends Fw{constructor(e,t){super(e.localeManager),this.hasPrefix=!0,this.popover=new Vle(e,t,this.onPopoverMoved.bind(this)),this.dragHandle=new Hle(e.localeManager.t("toolbarAnnotationsDragHandle")),this.popover.setDragHandle(this.dragHandle)}show(e={}){this.popover.show([this.dragHandle.getElement(),this.getElement()],e)}hide(){this.popover.hide()}setAnchor(e){this.popover.setAnchor(e,this.horizontalSpacing,this.verticalSpacing)}hasBeenDragged(){return this.popover.hasBeenDragged()}ignorePointerEvents(){this.popover.ignorePointerEvents()}capturePointerEvents(){this.popover.capturePointerEvents()}onPopoverMoved(){var i;const e=this.popover.getBounds();if((i=this.popoverBounds)!=null&&i.equals(e))return;this.popoverBounds=e.clone();const t=this.getButtonBounds();this.events.dispatch("toolbar-moved",{popoverBounds:e,buttonBounds:t})}getButtonWidgetBounds(e){const t=this.popover.getBounds(),i=super.getButtonWidgetBounds(e),s=this.dragHandle.getBounds();return new ve(i.x+t.x-s.width,i.y+t.y,i.width,i.height)}},Hle=class extends lu{constructor(e){super(ke("div","ag-charts-floating-toolbar__drag-handle"));const t=new lu(ke("span",`${Oy("drag-handle")} ag-charts-toolbar__icon`));t.setAriaHidden(!0),this.addChild(t),this.elem.title=e}},Wle=b(b({},GN),zN),dIe={VERSION:au,_Scene:Sw,_Theme:Dw,_Util:ww,create:rr.create.bind(rr),createSparkline:rr.__createSparkline.bind(rr),setup:JD,isEnterprise:!1},Ule=Object.defineProperty,Kle=Object.getOwnPropertyDescriptor,C=(e,t,i,s)=>{for(var n=s>1?void 0:s?Kle(t,i):t,a=e.length-1,r;a>=0;a--)(r=e[a])&&(n=(s?r(t,i,n):r(n))||n);return s&&n&&Ule(t,i,n),n},$le=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(e,t){let i=e[0],s=e[1],n=e[2],a=e[3];i=this.ff(i,s,n,a,t[0],7,-680876936),a=this.ff(a,i,s,n,t[1],12,-389564586),n=this.ff(n,a,i,s,t[2],17,606105819),s=this.ff(s,n,a,i,t[3],22,-1044525330),i=this.ff(i,s,n,a,t[4],7,-176418897),a=this.ff(a,i,s,n,t[5],12,1200080426),n=this.ff(n,a,i,s,t[6],17,-1473231341),s=this.ff(s,n,a,i,t[7],22,-45705983),i=this.ff(i,s,n,a,t[8],7,1770035416),a=this.ff(a,i,s,n,t[9],12,-1958414417),n=this.ff(n,a,i,s,t[10],17,-42063),s=this.ff(s,n,a,i,t[11],22,-1990404162),i=this.ff(i,s,n,a,t[12],7,1804603682),a=this.ff(a,i,s,n,t[13],12,-40341101),n=this.ff(n,a,i,s,t[14],17,-1502002290),s=this.ff(s,n,a,i,t[15],22,1236535329),i=this.gg(i,s,n,a,t[1],5,-165796510),a=this.gg(a,i,s,n,t[6],9,-1069501632),n=this.gg(n,a,i,s,t[11],14,643717713),s=this.gg(s,n,a,i,t[0],20,-373897302),i=this.gg(i,s,n,a,t[5],5,-701558691),a=this.gg(a,i,s,n,t[10],9,38016083),n=this.gg(n,a,i,s,t[15],14,-660478335),s=this.gg(s,n,a,i,t[4],20,-405537848),i=this.gg(i,s,n,a,t[9],5,568446438),a=this.gg(a,i,s,n,t[14],9,-1019803690),n=this.gg(n,a,i,s,t[3],14,-187363961),s=this.gg(s,n,a,i,t[8],20,1163531501),i=this.gg(i,s,n,a,t[13],5,-1444681467),a=this.gg(a,i,s,n,t[2],9,-51403784),n=this.gg(n,a,i,s,t[7],14,1735328473),s=this.gg(s,n,a,i,t[12],20,-1926607734),i=this.hh(i,s,n,a,t[5],4,-378558),a=this.hh(a,i,s,n,t[8],11,-2022574463),n=this.hh(n,a,i,s,t[11],16,1839030562),s=this.hh(s,n,a,i,t[14],23,-35309556),i=this.hh(i,s,n,a,t[1],4,-1530992060),a=this.hh(a,i,s,n,t[4],11,1272893353),n=this.hh(n,a,i,s,t[7],16,-155497632),s=this.hh(s,n,a,i,t[10],23,-1094730640),i=this.hh(i,s,n,a,t[13],4,681279174),a=this.hh(a,i,s,n,t[0],11,-358537222),n=this.hh(n,a,i,s,t[3],16,-722521979),s=this.hh(s,n,a,i,t[6],23,76029189),i=this.hh(i,s,n,a,t[9],4,-640364487),a=this.hh(a,i,s,n,t[12],11,-421815835),n=this.hh(n,a,i,s,t[15],16,530742520),s=this.hh(s,n,a,i,t[2],23,-995338651),i=this.ii(i,s,n,a,t[0],6,-198630844),a=this.ii(a,i,s,n,t[7],10,1126891415),n=this.ii(n,a,i,s,t[14],15,-1416354905),s=this.ii(s,n,a,i,t[5],21,-57434055),i=this.ii(i,s,n,a,t[12],6,1700485571),a=this.ii(a,i,s,n,t[3],10,-1894986606),n=this.ii(n,a,i,s,t[10],15,-1051523),s=this.ii(s,n,a,i,t[1],21,-2054922799),i=this.ii(i,s,n,a,t[8],6,1873313359),a=this.ii(a,i,s,n,t[15],10,-30611744),n=this.ii(n,a,i,s,t[6],15,-1560198380),s=this.ii(s,n,a,i,t[13],21,1309151649),i=this.ii(i,s,n,a,t[4],6,-145523070),a=this.ii(a,i,s,n,t[11],10,-1120210379),n=this.ii(n,a,i,s,t[2],15,718787259),s=this.ii(s,n,a,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(s,e[1]),e[2]=this.add32(n,e[2]),e[3]=this.add32(a,e[3])}cmn(e,t,i,s,n,a){return t=this.add32(this.add32(t,e),this.add32(s,a)),this.add32(t<<n|t>>>32-n,i)}ff(e,t,i,s,n,a,r){return this.cmn(t&i|~t&s,e,t,n,a,r)}gg(e,t,i,s,n,a,r){return this.cmn(t&s|i&~s,e,t,n,a,r)}hh(e,t,i,s,n,a,r){return this.cmn(t^i^s,e,t,n,a,r)}ii(e,t,i,s,n,a,r){return this.cmn(i^(t|~s),e,t,n,a,r)}md51(e){const t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=e.length;s+=64)this.md5cycle(i,this.md5blk(e.substring(s-64,s)));e=e.substring(s-64);const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<e.length;s++)n[s>>2]|=e.charCodeAt(s)<<(s%4<<3);if(n[s>>2]|=128<<(s%4<<3),s>55)for(this.md5cycle(i,n),s=0;s<16;s++)n[s]=0;return n[14]=t*8,this.md5cycle(i,n),i}md5blk(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let i="",s=0;for(;s<4;s++)i+=t[e>>s*8+4&15]+t[e>>s*8&15];return i}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const i=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(i>>16)<<16|i&65535}};function Bw(e){return e==null||e.length===0}var Sb={"01":"GRID","02":"CHARTS","0102":"BOTH"},B2="https://www.ag-grid.com/charts/licensing/",_w=class qi{constructor(t){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=t,this.md5=new $le,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(qi.licenseKey,qi.gridContext),i=`AG ${t.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`;let s="";if(t.suppliedLicenseType==="BOTH"?s="AG Grid and AG Charts Enterprise":t.suppliedLicenseType==="GRID"?s="AG Grid Enterprise":t.suppliedLicenseType!==void 0&&(s="AG Charts Enterprise"),t.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(t.expired){const n=qi.getChartsReleaseDate(),a=qi.formatDate(n);this.outputExpiredKey(t.expiry,a,s)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,i,s):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,i,s)}static extractExpiry(t){const i=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(qi.decode(i),10))}static extractLicenseComponents(t){let i=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const s=i.length-32,n=i.substring(s),a=i.substring(0,s),[r,o,l]=qi.extractBracketedInformation(i);return{md5:n,license:a,version:r,isTrial:o,type:l}}getLicenseDetails(t,i=!1){const s="CHARTS";if(Bw(t))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:s};const n=qi.getChartsReleaseDate(),{md5:a,license:r,version:o,isTrial:l,type:c}=qi.extractLicenseComponents(t);let h=a===this.md5.md5(r)&&t.indexOf("For_Trialing_ag-Grid_Only")===-1,d,u,p=null,g=!1,f;function y(){d=p<new Date,u=void 0}if(h&&(p=qi.extractExpiry(r),h=!isNaN(p.getTime()),h))switch(u=n>p,o){case"legacy":case"2":{h=!1;break}case"3":Bw(c)?h=!1:(f=c,c!==Sb["02"]&&c!==Sb["0102"]?(h=!1,g=!0):l&&y())}return h?{licenseKey:t,valid:h,expiry:qi.formatDate(p),expired:u,version:o,isTrial:l,trialExpired:d,invalidLicenseTypeForCombo:i?f!=="BOTH":void 0,incorrectLicenseType:g,currentLicenseType:s,suppliedLicenseType:f}:{licenseKey:t,valid:h,incorrectLicenseType:g,currentLicenseType:s,suppliedLicenseType:f}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isE2ETest()&&!this.isWebsiteUrl()&&!Bw(this.watermarkMessage)}getWatermarkMessage(){var t;return(t=this.watermarkMessage)!=null?t:""}getHostname(){var n;if(!this.document)return"localhost";const t=(n=this.document.defaultView)!=null?n:window;if(!t)return"localhost";const i=t.location,{hostname:s=""}=i;return s}isForceWatermark(){var s,n;if(!this.document)return!1;const t=((n=(s=this.document)==null?void 0:s.defaultView)!=null?n:typeof window!="undefined")?window:void 0;if(!t)return!1;const{pathname:i}=t.location;return i?i.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){const t=this.getHostname();return/^((?:[\w-]+\.)?ag-grid\.com)$/.exec(t)!==null}isLocalhost(){const t=this.getHostname();return/^(?:127\.0\.0\.1|localhost)$/.exec(t)!==null}isE2ETest(){const t=this.getHostname();return/^(?:172\.17\.0\.1|host\.docker\.internal)$/.exec(t)!==null}static formatDate(t){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=t.getDate(),n=t.getMonth(),a=t.getFullYear();return s+" "+i[n]+" "+a}static getChartsReleaseDate(){return new Date(parseInt(qi.decode(qi.RELEASE_INFORMATION),10))}static decode(t){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s="",n,a,r,o,l,c,h,d=0;const u=t.replace(/[^A-Za-z0-9+/=]/g,"");for(;d<u.length;)o=i.indexOf(u.charAt(d++)),l=i.indexOf(u.charAt(d++)),c=i.indexOf(u.charAt(d++)),h=i.indexOf(u.charAt(d++)),n=o<<2|l>>4,a=(l&15)<<4|c>>2,r=(c&3)<<6|h,s=s+String.fromCharCode(n),c!=64&&(s=s+String.fromCharCode(a)),h!=64&&(s=s+String.fromCharCode(r));return s=qi.utf8_decode(s),s}static utf8_decode(t){t=t.replace(/rn/g,"n");let i="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);n<128?i+=String.fromCharCode(n):n>127&&n<2048?(i+=String.fromCharCode(n>>6|192),i+=String.fromCharCode(n&63|128)):(i+=String.fromCharCode(n>>12|224),i+=String.fromCharCode(n>>6&63|128),i+=String.fromCharCode(n&63|128))}return i}static setGridContext(t=!1){qi.gridContext=t}static setLicenseKey(t){qi.licenseKey=t}static extractBracketedInformation(t){if(!t.includes("["))return["legacy",!1,void 0];const i=t.match(/\[(.*?)\]/g).map(o=>o.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const s=i.filter(o=>o==="TRIAL").length===1,n=i.filter(o=>o.startsWith("v"))[0],a=n?n.replace("v",""):"legacy",r=Sb[i.filter(o=>Sb[o])[0]];return[a,s,r]}centerPadAndOutput(t){const i=this.totalMessageLength-t.length;console.error(t.padStart(i/2+t.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(t,i="*",s=""){console.error(t.padEnd(this.totalMessageLength-s.length,i)+s)}outputInvalidLicenseKey(t,i,s){qi.gridContext||(t?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${s} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${B2}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${B2}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(t,i,s){qi.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${s} expired on ${t}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(t){qi.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${t} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(t,i,s){qi.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${s} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${s} released before ${t}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};_w.RELEASE_INFORMATION="MTc0OTAyMzU3MDQyNA==",_w.gridContext=!1;var $u=_w;function Gw(e,t,i){const s=(a,r,o,l)=>{let c=e[0];for(let h=a;o>0?h<=r:h>r;h+=o){const d=e[h];if(l(c,d))return!0;c=d}return!1},n=Math.floor(e.length/2);return s(t,n,t,i)?!0:s(e.length-t,n,-t,i)}var{AxisInterval:Yle,Property:Xle}=R,zw=class extends Yle{};C([Xle],zw.prototype,"minSpacing",2);var{BaseProperties:_2,ChartAxisDirection:Zle,Property:Ci,Group:Vw}=R,lr=class extends _2{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};C([Ci],lr.prototype,"enabled",2),C([Ci],lr.prototype,"text",2),C([Ci],lr.prototype,"fontStyle",2),C([Ci],lr.prototype,"fontWeight",2),C([Ci],lr.prototype,"fontSize",2),C([Ci],lr.prototype,"fontFamily",2),C([Ci],lr.prototype,"padding",2),C([Ci],lr.prototype,"color",2),C([Ci],lr.prototype,"parallel",2);var mn=class extends _2{constructor(){super(...arguments),this.id=Hs(this),this.defaultColorRange=[],this.shape="polygon",this.label=new lr,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=Zle.Angle,this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new Vw({name:this.id}),this.rangeGroup=new Vw({name:this.id}),this.labelGroup=new Vw({name:this.id}),this._isRange=void 0}assignCrossLineGroup(e,t){e!==this._isRange&&(e?this.rangeGroup.appendChild(t):this.lineGroup.appendChild(t)),this._isRange=e}setSectorNodeProps(e){var t,i,s;e.fill=this.fill,e.fillOpacity=(t=this.fillOpacity)!=null?t:1,e.stroke=this.stroke,e.strokeOpacity=(i=this.strokeOpacity)!=null?i:1,e.strokeWidth=(s=this.strokeWidth)!=null?s:1,e.lineDash=this.lineDash}setLabelNodeProps(e,t,i,s,n){const{label:a}=this;e.x=t,e.y=i,e.text=a.text,e.textAlign="center",e.textBaseline=s,e.rotation=n,e.rotationCenterX=t,e.rotationCenterY=i,e.fill=a.color,e.fontFamily=a.fontFamily,e.fontSize=a.fontSize,e.fontStyle=a.fontStyle,e.visible=!0}};C([Ci],mn.prototype,"enabled",2),C([Ci],mn.prototype,"type",2),C([Ci],mn.prototype,"range",2),C([Ci],mn.prototype,"value",2),C([Ci],mn.prototype,"defaultColorRange",2),C([Ci],mn.prototype,"fill",2),C([Ci],mn.prototype,"fillOpacity",2),C([Ci],mn.prototype,"stroke",2),C([Ci],mn.prototype,"strokeWidth",2),C([Ci],mn.prototype,"strokeOpacity",2),C([Ci],mn.prototype,"lineDash",2),C([Ci],mn.prototype,"shape",2),C([Ci],mn.prototype,"label",2);var{ChartAxisDirection:qle,getCrossLineValue:G2,validateCrossLineValue:Qle,normalizeAngle360:jw,Group:Jle,Path:z2,Sector:ece,RotatableText:tce,ContinuousScale:ice}=R,Hw=class extends mn{constructor(){super(),this.direction=qle.Angle,this.polygonNode=new z2,this.sectorNode=new ece,this.lineNode=new z2,this.crossLineRange=new Jle,this.labelNode=new tce,this.ticks=[],this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}visibilityCheck(){if(!ice.is(this.scale))return!0;const[e,t]=this.scale.domain,i=G2(this);if(Ke(i)){const[s,n]=i;return s>=e&&s<=t&&n>=s&&n<=t}else return i>=e&&i<=t}update(e){const{scale:t}=this;if(!t||!Qle(G2(this),t)||!this.visibilityCheck()){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(e){var u,p;const{scale:t,type:i,value:s,lineNode:n}=this;if(!e||i!=="line"||!t){n.visible=!1;return}const a=t.convert(s);if(isNaN(a)){n.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:o}=this;n.visible=!0,n.stroke=this.stroke,n.strokeOpacity=(u=this.strokeOpacity)!=null?u:1,n.strokeWidth=(p=this.strokeWidth)!=null?p:1,n.fill=void 0,n.lineDash=this.lineDash;const l=o*Math.cos(a),c=o*Math.sin(a),h=r*Math.cos(a),d=r*Math.sin(a);n.path.clear(!0),n.path.moveTo(h,d),n.path.lineTo(l,c),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(e){const{polygonNode:t,range:i,scale:s,shape:n,type:a,ticks:r}=this;if(!e||a!=="range"||n!=="polygon"||!s||!i){t.visible=!1;return}const{axisInnerRadius:o,axisOuterRadius:l}=this,c=r.indexOf(i[0]),h=r.indexOf(i[1]),u=(c<=h?r.slice(c,h+1):r.slice(c).concat(r.slice(0,h+1))).map(g=>s.convert(g));t.visible=!0,this.setSectorNodeProps(t);const{path:p}=t;p.clear(!0),u.forEach((g,f)=>{const y=l*Math.cos(g),v=l*Math.sin(g);f===0?p.moveTo(y,v):p.lineTo(y,v)}),o===0?p.lineTo(0,0):u.slice().reverse().forEach(g=>{const f=o*Math.cos(g),y=o*Math.sin(g);p.lineTo(f,y)}),t.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(e){var d;const{sectorNode:t,range:i,scale:s,shape:n,type:a}=this;if(!e||a!=="range"||n!=="circle"||!s||!i){t.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:o}=this,l=i.map(u=>s.convert(u)),c=(d=s.step)!=null?d:0,h=s instanceof R.BandScale?c/2:0;t.visible=!0,this.setSectorNodeProps(t),t.centerX=0,t.centerY=0,t.innerRadius=r,t.outerRadius=o,t.startAngle=l[0]-h,t.endAngle=l[1]+h,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(e){const{label:t,labelNode:i,range:s,scale:n,type:a,ticks:r}=this;if(!e||t.enabled===!1||!t.text||!n||a==="range"&&!s){i.visible=!1;return}i.visible=!0;const{axisInnerRadius:o,axisOuterRadius:l}=this;let c,h,d,u;if(a==="line"){const p=jw(n.convert(this.value)),g=1.5*Math.PI,f=mt(p,g)||p>g||p<Math.PI/2,y=(o+l)/2*Math.cos(p),v=(o+l)/2*Math.sin(p);c=y+t.padding*Math.cos(p+Math.PI/2),h=v+t.padding*Math.sin(p+Math.PI/2),u=f?"top":"bottom",d=f?p:p-Math.PI}else{const[p,g]=s.map(x=>jw(n.convert(x)));let f=(p+g)/2;p>g&&(f-=Math.PI),f=jw(f);const y=(mt(f,0)||f>0)&&f<Math.PI;let v;this.shape==="circle"||r.length<3?v=l-t.padding:v=l*Math.cos(Math.PI/r.length)-t.padding,c=v*Math.cos(f),h=v*Math.sin(f),u=y?"bottom":"top",d=y?f-Math.PI/2:f+Math.PI/2}this.setLabelNodeProps(i,c,h,u,d)}};Hw.className="AngleCrossLine";var{ChartAxisDirection:sce,TextWrapper:nce,TextUtils:ace,Property:Ww,toRadians:Rf,normalizeAngle360:nc,normalizeAngle360Inclusive:rce,Path:oce,RotatableText:lce,Transformable:cce,BBox:hce,Selection:V2,Line:j2}=R,Uw=class extends R.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};C([Ww],Uw.prototype,"orientation",2);var Nf=class extends R.PolarAxis{constructor(e,t){super(e,t),this.startAngle=0,this.endAngle=void 0,this.tickLineGroupSelection=V2.select(this.tickLineGroup,j2,!1),this.gridLineGroupSelection=V2.select(this.gridLineGroup,j2,!1),this.labelData=[],this.tickData=[],this.radiusLineGroup=this.axisGroup.appendChild(new R.TransformableGroup),this.radiusLine=this.radiusLineGroup.appendChild(new oce),this.includeInvisibleDomains=!0}get direction(){return sce.Angle}createLabel(){return new Uw}calculateRotations(){const e=Rf(this.startAngle),t=nc(e),i=nc(e-Math.PI/2);return{rotation:e,parallelFlipRotation:t,regularFlipRotation:i}}calculateTickLayout(e){const{nice:t,scale:i}=this,s={nice:t,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},n=t?i.niceDomain(s,e):e,a=this.generateAngleTicks(n);this.tickData=a;const r=a.map(l=>l.value),o=r.reduce((l,c)=>Math.max(typeof c=="number"?Ud(c):0,l),0);return{niceDomain:n,tickDomain:n,ticks:r,rawTickCount:void 0,fractionDigits:o,timeInterval:void 0,bbox:this.getBBox()}}update(){super.update(),this.updateRadiusLine(),this.updateGridLines(),this.updateTickLines()}normalizedAngles(){const e=nc(-Math.PI/2+Rf(this.startAngle)),t=this.endAngle!=null?rce(Rf(this.endAngle)-Rf(this.startAngle)):2*Math.PI,i=e+t;return[e,i]}computeRange(){this.range=this.normalizedAngles()}updateSelections(){const e=this.tickData;this.gridLineGroupSelection.update(this.gridLength&&this.gridLine.enabled?e:[]),this.tickLineGroupSelection.update(this.tick.enabled?e:[]),this.tickLabelGroupSelection.update(this.label.enabled?e:[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup()}updatePosition(){super.updatePosition();const{translation:e,radiusLineGroup:t}=this,i=Math.floor(e.x),s=Math.floor(e.y);t.translationX=i,t.translationY=s}updateRadiusLine(){const e=this.radiusLine,{path:t}=e;t.clear(!0);const{points:i,closePath:s}=this.getAxisLinePoints();i.forEach(({x:n,y:a,moveTo:r,arc:o,radius:l=0,startAngle:c=0,endAngle:h=0})=>{o?t.arc(n,a,l,c,h):r?t.moveTo(n,a):t.lineTo(n,a)}),s&&t.closePath(),e.visible=this.line.enabled,e.stroke=this.line.stroke,e.strokeWidth=this.line.width,e.fill=void 0}getAxisLinePoints(){var o,l;const{scale:e,shape:t,gridLength:i}=this,[s,n]=this.range,a=mt(n-s,2*Math.PI),r=[];if(t==="circle")a?r.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):r.push({x:i*Math.cos(s),y:i*Math.sin(s),moveTo:!0},{x:0,y:0,radius:i,startAngle:nc(s),endAngle:nc(n),arc:!0,moveTo:!1});else if(t==="polygon"){const c=(l=(o=e.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}))==null?void 0:o.ticks)==null?void 0:l.map(h=>e.convert(h));c&&c.length>2&&c.forEach((h,d)=>{const u=i*Math.cos(h),p=i*Math.sin(h),g=d===0;r.push({x:u,y:p,moveTo:g})})}return{points:r,closePath:a}}updateGridLines(){const{scale:e,gridLength:t,gridLine:{style:i,width:s},innerRadiusRatio:n}=this;if(!(i&&t>0))return;const a=t*n,r=i.length;this.gridLineGroupSelection.each((o,l,c)=>{const{value:h}=l,{stroke:d,lineDash:u}=i[c%r],p=e.convert(h);o.x1=a*Math.cos(p),o.y1=a*Math.sin(p),o.x2=t*Math.cos(p),o.y2=t*Math.sin(p),o.stroke=d,o.strokeWidth=s,o.lineDash=u,o.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:e,tickLabelGroupSelection:t}=this;t.each((i,s,n)=>{const a=this.labelData[n];if(!a||a.hidden){i.visible=!1;return}i.text=a.text,i.setFont(e),i.fill=e.color,i.x=a.x,i.y=a.y,i.textAlign=a.textAlign,i.textBaseline=a.textBaseline,i.visible=!0,a.rotation?(i.rotation=a.rotation,i.rotationCenterX=a.x,i.rotationCenterY=a.y):i.rotation=0})}updateTickLines(){const{scale:e,gridLength:t,tick:i,tickLineGroupSelection:s}=this;s.each((n,a)=>{const{value:r}=a,o=e.convert(r),l=Math.cos(o),c=Math.sin(o);n.x1=t*l,n.y1=t*c,n.x2=(t+i.size)*l,n.y2=(t+i.size)*c,n.stroke=i.stroke,n.strokeWidth=i.width})}createLabelNodeData(e,t,i){const{label:s,gridLength:n,scale:a,tick:r}=this;if(!s.enabled)return[];const o=new lce,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,h=e.map((d,u)=>{const{value:p}=d,g=n+s.spacing+r.size,f=a.convert(p),y=Math.cos(f),v=Math.sin(f),x=g*y,S=g*v,{textAlign:M,textBaseline:D}=this.getLabelAlign(f),A=u===e.length-1&&p!==e[0]&&mt(nc(f),nc(a.convert(e[0]))),w=this.getLabelRotation(f);let T=this.formatTick(p,u,a.domain);o.text=T,o.x=x,o.y=S,o.setFont(s),o.textAlign=M,o.textBaseline=D,o.rotation=w,w&&(o.rotationCenterX=x,o.rotationCenterY=S);let k=w?cce.toCanvas(o):o.getBBox();if(k&&t.hideWhenNecessary&&!w){const N=l-k.x,O=k.x+k.width-c,L=1;if(N>L||O>L){const F=k.width-Math.max(N,O);T=nce.wrapText(T,{maxWidth:F,font:s,textWrap:"never"}),T===ace.EllipsisChar&&(T=""),o.text=T,k=o.getBBox()}}return{text:T,x,y:S,textAlign:M,textBaseline:D,hidden:T===""||d.hidden||A,rotation:w,box:k}});return s.avoidCollisions&&this.avoidLabelCollisions(h),h}computeLabelsBBox(e,t){this.labelData=this.createLabelNodeData(this.tickData,e,t);const i=this.labelData.map(({box:s})=>s).filter(s=>s!=null);return!this.label.enabled||i.length===0?null:hce.merge(i)}getLabelOrientation(){const{label:e}=this;return e instanceof Uw?e.orientation:"fixed"}getLabelRotation(e){var s;let t=Rf((s=this.label.rotation)!=null?s:0);e=nc(e);const i=this.getLabelOrientation();return i==="parallel"?(t+=e,e>=0&&e<Math.PI?t-=Math.PI/2:t+=Math.PI/2):i==="perpendicular"&&(t+=e,e>=Math.PI/2&&e<1.5*Math.PI&&(t+=Math.PI)),t}getLabelAlign(e){const t=Math.cos(e),i=Math.sin(e);let s,n;const a=this.getLabelOrientation(),r=mt(t,0),o=mt(i,0),l=mt(t,1),c=mt(i,-1),h=t>0&&!r,d=i>0&&!o;return a==="parallel"?(s="center",n=l&&o||d?"top":"bottom"):a==="perpendicular"?(s=c||h?"left":"right",n="middle"):(s="right",r?s="center":h&&(s="left"),n="bottom",o?n="middle":d&&(n="top")),{textAlign:s,textBaseline:n}}updateCrossLines(){const{shape:e,gridLength:t,innerRadiusRatio:i}=this;this.crossLines.forEach(s=>{s instanceof Hw&&(s.ticks=this.tickData.map(n=>n.value),s.shape=e,s.axisOuterRadius=t,s.axisInnerRadius=t*i)}),super.updateCrossLines()}};Nf.CrossLineConstructor=Hw,C([Ww],Nf.prototype,"startAngle",2),C([Ww],Nf.prototype,"endAngle",2);var{Property:Kw,CategoryScale:dce}=R,ac=class extends Nf{constructor(e){super(e,new dce),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new zw}generateAngleTicks(){var c,h;const{scale:e,gridLength:t}=this,{values:i,minSpacing:s}=this.interval,n=(h=i!=null?i:(c=e.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}))==null?void 0:c.ticks)!=null?h:[];if(n.length<2||s==null)return n.map(d=>({value:d,visible:!0}));const a=n[0],r=e.convert(a),o=t*Math.cos(r),l=t*Math.sin(r);for(let d=1;d<n.length-1;d++){const u=n[d],p=e.convert(u);if(p-r>Math.PI)break;const g=t*Math.cos(p),f=t*Math.sin(p);if(Math.sqrt((g-o)**2+(f-l)**2)>s){const v=new Set([a]);return Gw(n,d,(x,S)=>{v.add(S)}),n.map(x=>{const S=v.has(x);return{value:x,visible:S}})}}return[{value:a,visible:!0}]}avoidLabelCollisions(e){const{minSpacing:t}=this.label;if(e.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;if(t==null)return l.box.collidesBBox(c.box);const h=l.box.clone().grow(t/2),d=c.box.clone().grow(t/2);return h.collidesBBox(d)},s=e[0],n=e.at(-1),a=new Set([s]),r=mt(s.x,n.x)&&mt(s.y,n.y),o=Math.floor(e.length/2);for(let l=1;l<=o;l++){const c=r?e.slice(0,-1):e;if(!Gw(c,l,i)){Gw(c,l,(d,u)=>{a.add(u)});break}}e.forEach(l=>{a.has(l)||(l.hidden=!0,l.box=void 0)})}};ac.className="AngleCategoryAxis",ac.type="angle-category",C([Kw],ac.prototype,"groupPaddingInner",2),C([Kw],ac.prototype,"paddingInner",2),C([Kw],ac.prototype,"interval",2);var uce={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",moduleFactory:e=>new ac(e)},{range:H2,isDenseInterval:pce,LinearScale:$w}=R,W2=class jT extends $w{constructor(){super(...arguments),this.arcLength=0}static getNiceStepAndTickCount(t,i){const[s,n]=i;let a=$w.getTickStep(s,n,t);const r=isNaN(t.maxTickCount)?1/0:t.maxTickCount,o=Math.abs(n-s)/a;let l=Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)));return l>r&&(l/=2,a*=2),{count:l,step:a}}ticks(t,i=this.domain){const{arcLength:s}=this;if(!i||i.length<2||i.some(c=>!isFinite(c))||s<=0)return{ticks:[],count:0};const{nice:n,interval:a}=t,[r,o]=i;if(a){const c=Math.abs(a),h=this.getPixelRange();if(!pce((o-r)/c,h))return H2(r,o,c)}let l;if(n&&this.hasNiceRange()){const c=super.niceDomain(t,i);l=jT.getNiceStepAndTickCount(t,c).step}else l=$w.getTickStep(r,o,t);return H2(r,o,l)}hasNiceRange(){const t=this.range.slice().sort((s,n)=>s-n);return[Math.PI,2*Math.PI].some(s=>mt(s,t[1]-t[0]))}niceDomain(t,i=this.domain){const s=super.niceDomain(t,i);if(!this.hasNiceRange())return s;const n=s[0]>s[1],a=n?s[1]:s[0],{step:r,count:o}=jT.getNiceStepAndTickCount(t,s),l=1/r,c=r>=1?Math.ceil(a/r+o)*r:Math.ceil((a+o*r)*l)/l;return n?[c,a]:[a,c]}getPixelRange(){return this.arcLength}},{Property:Yw,angleBetween:gce,normalisedExtentWithMetadata:fce,findMinMax:mce}=R,$h=class extends Nf{constructor(e){super(e,new W2),this.shape="circle",this.interval=new zw}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:s,clipped:n}=fce(e,t,i);return{domain:s,clipped:n}}updateScale(){super.updateScale(),this.scale.arcLength=this.getRangeArcLength()}getRangeArcLength(){const{range:e}=this,t=Math.min(...e),i=Math.max(...e),s=gce(t,i)||2*Math.PI,n=this.gridLength;return s*n}generateAngleTicks(e){var c,h;const{scale:t,range:i,nice:s}=this,{values:n,step:a,minSpacing:r,maxSpacing:o}=this.interval;let l;if(n==null){const{arcLength:d}=t,u=o?Math.floor(d/o):1,p=r?Math.floor(d/r):1/0,g=Math.floor(4/Math.PI*Math.abs(i[0]-i[1])),f=Math.max(u,Math.min(p,g)),y={nice:s,interval:a,tickCount:f,minTickCount:u,maxTickCount:p};l=(h=(c=t.ticks(y,e))==null?void 0:c.ticks)!=null?h:[]}else{const[d,u]=mce(e.map(Number));l=n.filter(p=>p>=d&&p<=u).sort((p,g)=>p-g)}return l.map(d=>({value:d,visible:!0}))}avoidLabelCollisions(e){const{minSpacing:t}=this.label,i=(a,r)=>{if(a.hidden||r.hidden)return!1;if(t==null)return a.box.collidesBBox(r.box);const o=a.box.clone().grow(t/2),l=r.box.clone().grow(t/2);return o.collidesBBox(l)},s=e[0],n=e.at(-1);s!==n&&mt(s.x,n.x)&&mt(s.y,n.y)&&(n.hidden=!0);for(let a=1;a<e.length;a*=2){let r=!1;for(let o=a;o<e.length;o+=a){const l=e[o],c=e[o-a];if(i(c,l)){r=!0;break}}if(!r){e.forEach((o,l)=>{l%a>0&&(o.hidden=!0,o.box=void 0)});return}}e.forEach((a,r)=>{r>0&&(a.hidden=!0,a.box=void 0)})}};$h.className="AngleNumberAxis",$h.type="angle-number",C([Yw],$h.prototype,"min",2),C([Yw],$h.prototype,"max",2),C([Yw],$h.prototype,"interval",2);var yce={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",moduleFactory:e=>new $h(e)},{OrdinalTimeScale:vce,Property:bce,TimeAxisParentLevel:xce}=R,Of=class extends R.CategoryAxis{constructor(e){super(e,new vce),this.parentLevel=new xce}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}};Of.className="OrdinalTimeAxis",Of.type="ordinal-time",C([bce],Of.prototype,"parentLevel",2);var Cce={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",moduleFactory:e=>new Of(e)},{ChartAxisDirection:Sce,Property:Mce,getCrossLineValue:Dce,validateCrossLineValue:wce,normalizeAngle360FromDegrees:Ace,Group:Ice,Path:Tce,Sector:kce,RotatableText:Lce}=R,U2=class extends lr{constructor(){super(...arguments),this.positionAngle=void 0}};C([Mce],U2.prototype,"positionAngle",2);var Xw=class extends mn{constructor(){super(),this.direction=Sce.Radius,this.label=new U2,this.polygonNode=new Tce,this.sectorNode=new kce,this.crossLineRange=new Ice,this.labelNode=new Lce,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:t}=this;if(!t||!wce(Dce(this),t)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.updateRadii();const{innerRadius:i,outerRadius:s}=this;e&&(e=i>=this.axisInnerRadius&&s<=this.axisOuterRadius),this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e),this.assignCrossLineGroup(this.type==="range",this.crossLineRange)}updateRadii(){var l;const{range:e,scale:t,type:i,axisInnerRadius:s,axisOuterRadius:n}=this;if(!t)return{innerRadius:0,outerRadius:0};const a=c=>n+s-c;let r,o;if(i==="line")r=a(t.convert(this.value)),o=r;else{const c=Math.abs((l=t==null?void 0:t.bandwidth)!=null?l:0),h=e.map(d=>t.convert(d));r=a(Math.max(...h)),o=a(Math.min(...h))+c}this.outerRadius=r,this.innerRadius=o}drawPolygon(e,t,i){t.forEach((s,n)=>{const a=e*Math.cos(s),r=e*Math.sin(s);n===0?i.path.moveTo(a,r):i.path.lineTo(a,r)}),i.path.closePath()}updatePolygonNode(e){const{gridAngles:t,polygonNode:i,scale:s,shape:n,type:a,innerRadius:r,outerRadius:o}=this;if(!e||n!=="polygon"||!s||!t){i.visible=!1;return}i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(o-l,t,i);const c=t.slice().reverse(),h=a==="line"?o-l:r+l;this.drawPolygon(h,c,i),this.setSectorNodeProps(i)}updateSectorNode(e){const{axisInnerRadius:t,axisOuterRadius:i,scale:s,sectorNode:n,shape:a,innerRadius:r,outerRadius:o}=this;if(!e||a!=="circle"||!s){n.visible=!1;return}n.visible=!0,n.startAngle=0,n.endAngle=2*Math.PI;const l=this.getPadding(),c=we(t,r+l,i),h=we(t,o-l,i);n.innerRadius=Math.min(c,h),n.outerRadius=Math.max(c,h),this.setSectorNodeProps(n)}updateLabelNode(e){var f,y;const{innerRadius:t,label:i,labelNode:s,scale:n,shape:a,type:r}=this;if(!e||i.enabled===!1||!i.text||!n){s.visible=!1;return}const o=Ace(((f=i.positionAngle)!=null?f:0)-90),l=(mt(o,0)||o>0)&&o<Math.PI,c=l?o-Math.PI/2:o+Math.PI/2;let h;const d=(y=this.gridAngles)!=null?y:[];r==="line"?h=t+i.padding:a==="circle"||d.length<3?h=t-i.padding:h=t*Math.cos(Math.PI/d.length)-i.padding;const u=h*Math.cos(o),p=h*Math.sin(o);let g;r==="line"?g=l?"top":"bottom":g=l?"bottom":"top",this.setLabelNodeProps(s,u,p,g,c)}getPadding(){var s,n;const{scale:e}=this;if(!e)return 0;const t=Math.abs((s=e.bandwidth)!=null?s:0),i=Math.abs((n=e.step)!=null?n:0);return e instanceof R.BandScale?(i-t)/2:0}};Xw.className="RadiusCrossLine";var{ChartAxisDirection:Pce,ZIndexMap:Ece,Property:Zw,normalizeAngle360:K2,toRadians:Rce,Caption:Nce,Group:Oce,TransformableGroup:$2,Path:Fce,Line:Y2,Selection:X2,AxisTickGenerator:Bce,AxisGroupZIndexMap:_ce}=R,qw=class extends R.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};C([Zw],qw.prototype,"autoRotate",2),C([Zw],qw.prototype,"autoRotateAngle",2);var Mb=class extends R.PolarAxis{constructor(e,t){super(e,t),this.positionAngle=0,this.gridLineGroupSelection=X2.select(this.gridLineGroup,Y2,!1),this.tickGenerator=new Bce(this),this.generatedTicks=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new $2({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new $2({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new Y2({name:`${this.id}-Axis-line`,zIndex:_ce.AxisLine})),this.gridPathGroup=this.gridGroup.appendChild(new Oce({name:`${this.id}-gridPaths`,zIndex:Ece.AXIS_GRID})),this.gridPathSelection=X2.select(this.gridPathGroup,Fce),this.headingLabelGroup.appendChild(this.title.caption.node),this.destroyFns.push(this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}get direction(){return Pce.Radius}getAxisTransform(){const e=this.scale.range[0],{translation:t,positionAngle:i,innerRadiusRatio:s}=this,n=e*s,a=Rce(i);return{translationX:t.x,translationY:t.y-e-n,rotation:a,rotationCenterX:0,rotationCenterY:e+n}}update(){super.update(),this.updateTitle(),this.updateGridLines();const{enabled:e,stroke:t,width:i}=this.line;this.lineNode.setProperties({stroke:t,strokeWidth:e?i:0,x1:0,y1:this.range[0],x2:0,y2:this.range[1]})}updatePosition(){super.updatePosition();const e=this.getAxisTransform();this.tickLineGroup.setProperties(e),this.tickLabelGroup.setProperties(e),this.lineNodeGroup.setProperties(e),this.headingLabelGroup.setProperties(e)}calculateRotations(){return{rotation:0,parallelFlipRotation:0,regularFlipRotation:-Math.PI/2}}calculateTickLayout(e,t,i){const n=-Math.PI/2,a=[0,1],r=this.label.getSideFlag(),o=r*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),l=this.tickGenerator.generateTicks({domain:e,niceMode:t,visibleRange:a,primaryTickCount:void 0,parallelFlipRotation:0,regularFlipRotation:n,labelX:o,sideFlag:r,removeOverflowLabels:!1}),{tickData:c}=l,{ticks:h,rawTicks:d,rawTickCount:u,tickDomain:p,fractionDigits:g,niceDomain:f=e}=c,y=h.map(v=>this.getTickLabelProps(v,l));return this.generatedTicks={ticks:h,labels:y},{ticks:d,tickDomain:p,niceDomain:f,rawTickCount:u,fractionDigits:g,timeInterval:void 0}}updateSelections(){const{generatedTicks:e}=this;if(!e)return;const{ticks:t,labels:i}=e;this.gridLineGroupSelection.update(this.gridLength?t:[]),this.tickLabelGroupSelection.update(i),this.gridPathSelection.update(this.gridLine.enabled?this.prepareGridPathTickData(t):[]),this.gridLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup(),this.gridPathSelection.cleanup()}updateLabels(){if(!this.label.enabled)return;const e=R.resetAxisLabelSelectionFn();this.tickLabelGroupSelection.each((t,i)=>{var s;t.fill=i.fill,t.fontFamily=i.fontFamily,t.fontSize=i.fontSize,t.fontStyle=i.fontStyle,t.fontWeight=i.fontWeight,t.text=i.text,t.textBaseline=i.textBaseline,t.textAlign=(s=i.textAlign)!=null?s:"center",t.setProperties(e(t,i))})}updateGridLines(){var u;const{gridLine:{style:e,width:t},shape:i,generatedTicks:s}=this;if(!e||!s)return;const n=e.length,a=(p,g)=>{const{stroke:f,lineDash:y}=e[g%n];p.stroke=f,p.strokeWidth=t,p.lineDash=y,p.fill=void 0},[r,o]=(u=this.gridRange)!=null?u:[0,2*Math.PI],l=mt(o-r,2*Math.PI),d=i==="circle"?(p,g)=>{const{path:f}=p;f.clear(!0);const y=this.getTickRadius(g);l?(f.moveTo(y,0),f.arc(0,0,y,0,2*Math.PI)):(f.moveTo(y*Math.cos(r),y*Math.sin(r)),f.arc(0,0,y,K2(r),K2(o))),l&&f.closePath()}:(p,g)=>{const{path:f}=p,y=this.gridAngles;if(f.clear(!0),!y||y.length<3)return;const v=this.getTickRadius(g);y.forEach((x,S)=>{const M=v*Math.cos(x),D=v*Math.sin(x);S===0?f.moveTo(M,D):f.lineTo(M,D),y.forEach((A,w)=>{const T=v*Math.cos(A),k=v*Math.sin(A);w===0?f.moveTo(T,k):f.lineTo(T,k)}),f.closePath()}),f.closePath()};this.gridPathSelection.each((p,g,f)=>{a(p,f),d(p,g)})}updateTitle(){const e=r=>r.defaultValue,{title:t,range:i}=this,{formatter:s=e}=this.title;t.caption.enabled=t.enabled,t.caption.fontFamily=t.fontFamily,t.caption.fontSize=t.fontSize,t.caption.fontStyle=t.fontStyle,t.caption.fontWeight=t.fontWeight,t.caption.color=t.color,t.caption.wrapping=t.wrapping;let n=!1;const a=t.caption.node;t.enabled&&(n=!0,a.rotation=Math.PI/2,a.x=Math.floor((i[0]+i[1])/2),a.y=-Nce.SMALL_PADDING,a.textAlign="center",a.textBaseline="bottom",a.text=this.callWithContext(s,this.getTitleFormatterParams(this.scale.domain))),a.visible=n}updateCrossLines(){this.crossLines.forEach(e=>{if(e instanceof Xw){const{shape:t,gridAngles:i,range:s,innerRadiusRatio:n}=this,a=s[0];e.shape=t,e.gridAngles=i,e.axisOuterRadius=a,e.axisInnerRadius=a*n}}),super.updateCrossLines()}createLabel(){return new qw}getTickLabelProps(e,t){var u;const{label:i}=this,{rotation:s,textBaseline:n,textAlign:a}=t,r=this.scale.range,o=(u=e.tickLabel)!=null?u:"",c=i.getSideFlag()*(this.getTickSize()+i.spacing+this.seriesAreaPadding),h=o!==""&&o!=null,d=s;return E(b({},this.getLabelStyles({value:e.tickLabel})),{tickId:e.tickId,rotation:d,text:o,textAlign:a,textBaseline:n,visible:h,x:c,y:e.translationY,rotationCenterX:c,rotationCenterY:e.translationY,range:r})}};Mb.CrossLineConstructor=Xw,C([Zw],Mb.prototype,"positionAngle",2);var{ProxyPropertyOnWrite:Z2,Property:Qw,CategoryScale:q2}=R,rc=class extends Mb{constructor(e){super(e,new q2),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}normaliseDataDomain(e){return{domain:e,clipped:!1}}prepareGridPathTickData(e){return e.slice().reverse()}getTickRadius(e){const{scale:t,innerRadiusRatio:i}=this,s=t.range[0],n=s*i;if(q2.is(t)){const a=t.domain,r=a.length-1-a.indexOf(e.tick);return r===0?n:t.inset+t.step*(r-.5)+t.bandwidth/2}else{const a=(s-n)/t.domain.length;return s-e.translationY+n-a/2}}};rc.className="RadiusCategoryAxis",rc.type="radius-category",C([Qw],rc.prototype,"groupPaddingInner",2),C([Z2("scale","paddingInner"),Qw],rc.prototype,"paddingInner",2),C([Z2("scale","paddingOuter"),Qw],rc.prototype,"paddingOuter",2);var Gce={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",moduleFactory:e=>new rc(e)},{Property:Q2,normalisedExtentWithMetadata:zce,LinearScale:Vce}=R,Yu=class extends Mb{constructor(e){super(e,new Vce),this.shape="polygon"}prepareGridPathTickData(e){const{scale:t}=this,i=t.domain[1];return e.filter(({tick:s})=>s!==i).sort((s,n)=>n.tick-s.tick)}getTickRadius(e){const{scale:t}=this,i=t.range[0],s=i*this.innerRadiusRatio;return i-e.translationY+s}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:s,clipped:n}=zce(e,t,i);return{domain:s,clipped:n}}};Yu.className="RadiusNumberAxis",Yu.type="radius-number",C([Q2],Yu.prototype,"min",2),C([Q2],Yu.prototype,"max",2);var jce={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",moduleFactory:e=>new Yu(e)},{ObserveChanges:J2,Property:eB}=R,Jw=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,e.animationManager.skip(!1),this.destroyFns.push(()=>{e.animationManager.skip(!0)})}};C([J2((e,t)=>{e.ctx.animationManager.skip(!t)}),eB],Jw.prototype,"enabled",2),C([J2((e,t)=>{e.ctx.animationManager.defaultDuration=t}),eB],Jw.prototype,"duration",2);var Hce={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new Jw(e),themeTemplate:{animation:{enabled:!0}}},Wce='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>',{focusCursorAtEnd:Uce}=R,tB="text-input",iB="canvas-overlay",Kce=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=e.domManager.addChild(iB,tB),this.element.classList.add("ag-charts-text-input"),this.destroyFns.push(()=>e.domManager.removeChild(iB,tB))}setKeyDownHandler(e){this.element.addEventListener("keydown",e),this.destroyFns.push(()=>this.element.removeEventListener("keydown",e))}show(e){var i,s,n,a,r,o,l,c,h,d,u,p,g,f,y;this.element.innerHTML=Wce;const t=this.element.firstElementChild;$e(t,"data-preventdefault",!1),t.isContentEditable||(t.contentEditable="true"),t.setAttribute("placeholder",this.ctx.localeManager.t((i=e.placeholderText)!=null?i:"inputTextareaPlaceholder")),(s=e.styles)!=null&&s.placeholderColor&&t.style.setProperty("--placeholder-text-color",(n=e.styles)==null?void 0:n.placeholderColor),t.innerText=(a=e.text)!=null?a:"",t.style.color=(o=(r=e.styles)==null?void 0:r.color)!=null?o:"inherit",t.style.fontFamily=(c=(l=e.styles)==null?void 0:l.fontFamily)!=null?c:"inherit",t.style.fontSize=(h=e.styles)!=null&&h.fontSize?`${e.styles.fontSize}px`:"inherit",t.style.fontStyle=(u=(d=e.styles)==null?void 0:d.fontStyle)!=null?u:"inherit",t.style.fontWeight=typeof((p=e.styles)==null?void 0:p.fontWeight)=="number"?`${e.styles.fontWeight}`:(f=(g=e.styles)==null?void 0:g.fontWeight)!=null?f:"inherit",Uce(t),t.addEventListener("input",()=>{var v;this.updatePosition(),(v=e.onChange)==null||v.call(e,this.getValue(),this.getBBox())}),t.addEventListener("click",v=>{v.stopPropagation()}),e.layout&&(this.layout=e.layout,this.updatePosition()),(y=e.onChange)==null||y.call(e,this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(e){this.element.firstElementChild&&(this.element.firstElementChild.style.color=e)}updateFontSize(e){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${e}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){const{element:e}=this,t=e.firstElementChild;if(!t)return;const i=this.ctx.domManager.getBoundingClientRect(),{width:s,getTextInputCoords:n,getTextPosition:a,alignment:r,textAlign:o}=this.layout;e.style.setProperty("width",s?`${s}px`:"unset");const l=t.getBoundingClientRect(),c=n(l.height);let h=c.x;r==="center"?h-=(s!=null?s:l.width)/2:r==="right"&&(h-=s!=null?s:l.width);const d=a();let u=c.y;d==="center"?u-=l.height/2:d==="bottom"&&(u-=l.height),e.style.setProperty("top",`${u}px`),e.style.setProperty("left",`${h}px`),e.style.setProperty("max-width",`${i.width-h}px`),e.style.setProperty("text-align",r),t.style.setProperty("text-align",o)}getBBox(){const{left:e,top:t,width:i,height:s}=this.element.getBoundingClientRect();return new R.BBox(e,t,i,s)}},{BaseProperties:$ce,Property:sB}=R,eA=class extends $ce{constructor(){super(...arguments),this.enabled=!1,this.axes="y"}};C([sB],eA.prototype,"enabled",2),C([sB],eA.prototype,"axes",2);var tA=(e=>(e.Line="line",e.HorizontalLine="horizontal-line",e.VerticalLine="vertical-line",e.DisjointChannel="disjoint-channel",e.ParallelChannel="parallel-channel",e.FibonacciRetracement="fibonacci-retracement",e.FibonacciRetracementTrendBased="fibonacci-retracement-trend-based",e.Callout="callout",e.Comment="comment",e.Note="note",e.Text="text",e.Arrow="arrow",e.ArrowUp="arrow-up",e.ArrowDown="arrow-down",e.DateRange="date-range",e.PriceRange="price-range",e.DatePriceRange="date-price-range",e.QuickDatePriceRange="quick-date-price-range",e))(tA||{}),Yce=Object.values(tA);function Xce(e){for(const t of Yce)if(t===e)return t}var{BaseProperties:oc,Property:tt}=R,Ff=class extends oc{};C([tt],Ff.prototype,"x",2),C([tt],Ff.prototype,"y",2);var Zce=class extends qs(Ko(oB(oc))){},iA=class extends qs(Ko(Ur(aA(Zh(oc))))){constructor(){super(...arguments),this.cornerRadius=2}};C([tt],iA.prototype,"enabled",2),C([tt],iA.prototype,"cornerRadius",2);var qce=class extends Ur(oc){},Qce=class extends qs(Ko(Ur(oc))){},Yh=class extends Zh(oc){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};C([tt],Yh.prototype,"label",2),C([tt],Yh.prototype,"position",2),C([tt],Yh.prototype,"alignment",2);var Jce=class extends Zh(oc){},Bf=class extends Zh(oc){constructor(){super(...arguments),this.label=""}};C([tt],Bf.prototype,"label",2),C([tt],Bf.prototype,"position",2),C([tt],Bf.prototype,"alignment",2);function Xh(e){class t extends the(oB(e)){constructor(){super(...arguments),this.id=by()}}return t}function sA(e){class t extends e{constructor(){super(...arguments),this.start=new Ff,this.end=new Ff}}return C([tt],t.prototype,"start",2),C([tt],t.prototype,"end",2),t}function nB(e){class t extends e{}return C([tt],t.prototype,"x",2),C([tt],t.prototype,"y",2),t}function aB(e){class t extends e{}return C([tt],t.prototype,"value",2),t}function nA(e){class t extends e{constructor(){super(...arguments),this.background=new qce}}return C([tt],t.prototype,"background",2),t}function lc(e){class t extends e{constructor(){super(...arguments),this.handle=new Qce}}return C([tt],t.prototype,"handle",2),t}function rB(e){class t extends e{constructor(){super(...arguments),this.axisLabel=new iA}}return C([tt],t.prototype,"axisLabel",2),t}function aA(e){class t extends e{constructor(){super(...arguments),this.padding=void 0,this.textAlign="center",this.formatter=void 0}}return C([tt],t.prototype,"padding",2),C([tt],t.prototype,"textAlign",2),C([tt],t.prototype,"formatter",2),t}function ehe(e){class t extends e{}return t}function rA(e){class t extends e{}return C([tt],t.prototype,"extendStart",2),C([tt],t.prototype,"extendEnd",2),t}function the(e){class t extends e{}return C([tt],t.prototype,"locked",2),t}function oA(e){class t extends e{setLocaleManager(s){var n;(n=this.localeManager)!=null||(this.localeManager=s)}}return t}function oB(e){class t extends e{}return C([tt],t.prototype,"visible",2),t}function Ur(e){class t extends e{}return C([tt],t.prototype,"fill",2),C([tt],t.prototype,"fillOpacity",2),t}function qs(e){class t extends e{}return C([tt],t.prototype,"stroke",2),C([tt],t.prototype,"strokeOpacity",2),C([tt],t.prototype,"strokeWidth",2),t}function Ko(e){class t extends e{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return C([tt],t.prototype,"lineDash",2),C([tt],t.prototype,"lineDashOffset",2),C([tt],t.prototype,"lineStyle",2),t}function Zh(e){class t extends e{constructor(){super(...arguments),this.fontSize=12,this.fontFamily="Verdana, sans-serif"}}return C([tt],t.prototype,"fontStyle",2),C([tt],t.prototype,"fontWeight",2),C([tt],t.prototype,"fontSize",2),C([tt],t.prototype,"fontFamily",2),C([tt],t.prototype,"color",2),t}function lB(e){return ki(e)||Ji(e)||Mr(e)?{value:e,groupPercentage:0}:e!=null?e:{value:void 0,groupPercentage:0}}function Yi(e){var t;return(t=lB(e))==null?void 0:t.value}var{clampArray:ihe}=R;function yn(e,t){if(e.start==null||e.end==null)return;const i=pi(e.start,t),s=pi(e.end,t);if(!(i==null||s==null))return{x1:i.x,y1:i.y,x2:s.x,y2:s.y}}function pi(e,t){const i=$o(e.x,t.xAxis),s=$o(e.y,t.yAxis);return{x:i,y:s}}function $o(e,t){var l,c;if(e==null)return 0;const{value:i,groupPercentage:s}=lB(e),{scale:n,snapToGroup:a}=t,r=n.bandwidth===0?(l=n.step)!=null?l:0:(c=n.bandwidth)!=null?c:0,o=a?r/2:r*s;return n.convert(i)+o}function vn(e,t){const i=Db(e.x,t.xAxis),s=Db(e.y,t.yAxis);return{x:i,y:s}}function Db(e,t){var c;const{scale:i}=t;if(t.continuous&&i.step==null)return t.scaleInvert(e);const s=t.scaleInvertNearest(e),n=i.bandwidth===0?i.step:(c=i.bandwidth)!=null?c:0,a=i.convert(s),r=a+n,o=ihe(e,i.range),l=a===r?0:(o-a)/(r-a);return{value:s,groupPercentage:l}}var{BaseProperties:she}=R,lA=class extends Xh(sA(lc(she))){constructor(){super(...arguments),this.snapToAngle=45}getDefaultColor(e){}getDefaultOpacity(e){}},{Property:nhe}=R,cB=class extends oA(aA(Zh(lA))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(e){return this.color}getDefaultOpacity(e){}getPlaceholderColor(){}getPadding(){const{padding:e=0}=this;return{top:e,right:e,bottom:e,left:e}}getText(){var i;const e=this.text.length==0;let t=this.text;return e&&(t=(i=this.placeholderText)!=null?i:"",this.localeManager&&(t=this.localeManager.t(t))),{text:t,isPlaceholder:e}}getTextInputCoords(e,t){return pi(this.end,e)}getTextPosition(){return this.position}};C([nhe],cB.prototype,"text",2);var{Property:ahe,Color:hB}=R,rhe={top:6,right:12,bottom:9,left:12},cr=class extends Ur(qs(cB)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(e){return Ve(e)&&e.type==="callout"}getDefaultColor(e){switch(e){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){var s;const{r:e,g:t,b:i}=hB.fromString((s=this.color)!=null?s:"#888888");return new hB(e,t,i,.66).toString()}getPadding(){const{padding:e}=this;return e==null?b({},rhe):{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){var r,o;const i=super.getTextInputCoords(e,t),s=this.getPadding(),n=(r=s.left)!=null?r:0,a=(o=s.bottom)!=null?o:0;return{x:i.x+n,y:i.y-a}}};C([ahe],cr.prototype,"type",2);var{BaseProperties:ohe,Property:lhe}=R,wb=class extends Xh(nB(lc(aA(Zh(ohe))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(e){return this.color}getDefaultOpacity(e){}getPlaceholderColor(){}getPadding(){const{padding:e=0}=this;return{top:e,right:e,bottom:e,left:e}}getText(){var i;const e=this.text.length==0;return{text:e?(i=this.placeholderText)!=null?i:"":this.text,isPlaceholder:e}}getTextInputCoords(e,t){return pi(this,e)}getTextPosition(){return this.position}};C([lhe],wb.prototype,"text",2);var{Property:che,Color:dB}=R,Ab={top:8,right:14,bottom:8,left:14},Kr=class extends Ur(qs(wb)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(e){return Ve(e)&&e.type==="comment"}getDefaultColor(e){switch(e){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){var s;const{r:e,g:t,b:i}=dB.fromString((s=this.color)!=null?s:"#888888");return new dB(e,t,i,.66).toString()}getPadding(){const{padding:e,fontSize:t}=this;return e==null?{top:Math.max(t*.4,Ab.top),bottom:Math.max(t*.4,Ab.bottom),left:Math.max(t*.8,Ab.left),right:Math.max(t*.8,Ab.right)}:{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const i=super.getTextInputCoords(e,t),s=this.getPadding();return{x:i.x+s.left,y:i.y-s.bottom}}};C([che],Kr.prototype,"type",2);var{Vec2:qh}=R;function _f(e,t){return e?"dashed":t!=null?t:"solid"}function uB(e,t){switch(t){case"solid":return[];case"dashed":return[e*4,e*2];case"dotted":return[0,e*2]}}function Xu(e,t,i,s){var a;const n=_f(e,i);return(a=t!=null?t:e)!=null?a:uB(s!=null?s:1,n)}function Zu(e,t,i){const s=_f(t,i);return(e!=null?e:s==="dotted")?"round":void 0}function hhe(e,t){const[i,s]=qh.from(e),n=t.height,a=qh.gradient(s,i,n),r=qh.intercept(s,a,n),o=[{x:i.x,y:n!=null?n:0},{x:i.x,y:n==null?t.height:n-t.height}];if(a===1/0)return o;let l=[qh.intersectAtY(a,r,0,n),qh.intersectAtY(a,r,t.height,n),qh.intersectAtX(a,r,0,n),qh.intersectAtX(a,r,t.width,n)];return l=l.filter(c=>c.x>=t.x&&c.x<=t.width&&c.y>=t.y&&c.y<=t.height).sort((c,h)=>c.x===h.x?0:c.x<h.x?-1:1),l.length!==2?o:l}var{BaseProperties:cA,Property:Rn}=R,dhe=class extends qs(cA){},hA=class extends Zh(Ur(qs(cA))){constructor(){super(...arguments),this.divider=new dhe}};C([Rn],hA.prototype,"divider",2);var dA=class extends Ur(qs(lc(cA))){constructor(){super(...arguments),this.statistics=new hA}};C([Rn],dA.prototype,"statistics",2);var qu=class extends oA(nA(qs(Ko(lA)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new hA,this.getVolume=()=>{},this.text=new Yh}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Xu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Zu(this.lineCap,this.lineDash,this.lineStyle)}};C([Rn],qu.prototype,"statistics",2),C([Rn],qu.prototype,"text",2);function uA(e){class t extends e{constructor(){super(...arguments),this.hasDateRange=!0}}return t}function pA(e){class t extends e{constructor(){super(...arguments),this.hasPriceRange=!0}}return t}var La=class extends uA(qu){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(e){return Ve(e)&&e.type==="date-range"}};C([Rn],La.prototype,"type",2),C([Rn],La.prototype,"extendAbove",2),C([Rn],La.prototype,"extendBelow",2);var Pa=class extends pA(qu){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(e){return Ve(e)&&e.type==="price-range"}};C([Rn],Pa.prototype,"type",2),C([Rn],Pa.prototype,"extendLeft",2),C([Rn],Pa.prototype,"extendRight",2);var Yo=class extends uA(pA(qu)){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(e){return Ve(e)&&e.type==="date-price-range"}};C([Rn],Yo.prototype,"type",2);var ta=class extends uA(pA(qu)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new dA,this.down=new dA,this.direction="both"}static is(e){return Ve(e)&&e.type==="quick-date-price-range"}};C([Rn],ta.prototype,"type",2),C([Rn],ta.prototype,"up",2),C([Rn],ta.prototype,"down",2);var{TextWrapper:uhe,CachedTextMeasurerPool:phe,BBox:ghe}=R,Gf=1.38;function pB(e){return{font:{fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight},textAlign:e.textAlign,textBaseline:e.position=="center"?"middle":e.position,lineHeight:Gf,avoidOrphans:!1,textWrap:"always"}}function Ib(e,t,i){return i?uhe.wrapText(t,E(b({},pB(e)),{maxWidth:i})):t}function fhe(e,t){var r;const i=pB(e),{lineMetrics:s,width:n}=phe.measureLines(t,i),a=s.length*((r=e.fontSize)!=null?r:14)*Gf;return{width:n,height:a}}function gA(e,t,i,s){var r,o;let n=(r=s==null?void 0:s.width)!=null?r:0,a=(o=s==null?void 0:s.height)!=null?o:0;if(!s){const l=e.width!=null?Ib(e,t,e.width):t;({width:n,height:a}=fhe(e,l))}return new ghe(i.x,i.y,n,a)}function gB(e,t,i,s,{x:n,y:a},r){const{visible:o=!0,fontFamily:l,fontSize:c=14,fontStyle:h,fontWeight:d,textAlign:u}=s,p=c*Gf;r!=null||(r=s.position=="center"?"middle":s.position);const g=i?s.getPlaceholderColor():s.color;e.setProperties({x:n,y:a,visible:o,text:t,fill:g,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,textAlign:u,lineHeight:p,textBaseline:r})}var{BaseProperties:mhe,Property:fB}=R,yhe=10,vhe=11,mB=20,bhe=22,xhe=10,yB=mB+xhe,vB=34,Che=class extends Ur(qs(mhe)){},Nn=class extends Ur(qs(wb)){constructor(){super(...arguments),this.type="note",this.background=new Che,this.position="bottom",this.alignment="center",this.width=200}static is(e){return Ve(e)&&e.type==="note"}getDefaultColor(e){switch(e){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(e){switch(e){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){var t;const e=(t=this.padding)!=null?t:yhe;return{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const{width:i,text:s}=this,n=super.getTextInputCoords(e,t),a=this.getPadding().top,r=gA(this,s,n);r.x=we(i/2,r.x,e.seriesRect.width-i/2);const o=r.y-yB-a*2,l=r.y+vhe+a*2,c=Math.max(r.height,t);return o-c-vB<0?(r.y=l,this.position="top"):(r.y=o+a,this.position="bottom"),{x:r.x,y:r.y}}};C([fB],Nn.prototype,"type",2),C([fB],Nn.prototype,"background",2);var{BaseProperties:She}=R,Mhe=class extends Xh(nB(lc(She))){getDefaultColor(e){}getDefaultOpacity(e){}},fA=class Vj extends Ur(Mhe){constructor(){super(...arguments),this.size=32}static is(t){return t instanceof Vj}getDefaultColor(t){return t==="fill-color"?this.fill:void 0}getDefaultOpacity(t){return t==="fill-color"?this.fillOpacity:void 0}},{BaseProperties:bB,Property:Tb}=R,Qs=class extends Xh(aB(lc(rB(qs(Ko(bB)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new Yh}static is(e){return Ve(e)&&e.type==="horizontal-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Xu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Zu(this.lineCap,this.lineDash,this.lineStyle)}};C([Tb],Qs.prototype,"type",2),C([Tb],Qs.prototype,"text",2);var $r=class extends Xh(aB(lc(rB(qs(Ko(bB)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new Yh}static is(e){return Ve(e)&&e.type==="vertical-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Xu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Zu(this.lineCap,this.lineDash,this.lineStyle)}};C([Tb],$r.prototype,"type",2),C([Tb],$r.prototype,"text",2);var{BaseProperties:Dhe,Property:kb}=R,Ea=class extends Xh(nA(sA(lc(rA(qs(Ko(Dhe))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new Bf,this.snapToAngle=45}static is(e){return Ve(e)&&e.type==="disjoint-channel"}get bottom(){const e={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof e.start.y=="number"&&typeof e.end.y=="number"?(e.start.y-=this.startHeight,e.end.y-=this.endHeight):se.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),e}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Xu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Zu(this.lineCap,this.lineDash,this.lineStyle)}};C([kb],Ea.prototype,"type",2),C([kb],Ea.prototype,"startHeight",2),C([kb],Ea.prototype,"endHeight",2),C([kb],Ea.prototype,"text",2);var{Property:mA}=R,Lb=class extends oA(ehe(rA(qs(Ko(lA))))){constructor(){super(...arguments),this.text=new Yh}getDefaultColor(e){switch(e){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Xu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Zu(this.lineCap,this.lineDash,this.lineStyle)}};C([mA],Lb.prototype,"text",2);var Xo=class extends Lb{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(e){return Ve(e)&&e.type==="arrow"}};C([mA],Xo.prototype,"type",2);var Zo=class extends Lb{constructor(){super(...arguments),this.type="line"}static is(e){return Ve(e)&&e.type==="line"}};C([mA],Zo.prototype,"type",2);var{Property:Qh}=R,qo=class extends Lb{constructor(){super(...arguments),this.label=new Jce,this.reverse=!1,this.showFill=!0,this.isMultiColor=!0,this.strokes=[],this.bands=10}getDefaultColor(e){var t;switch(e){case"line-color":return(t=this.rangeStroke)!=null?t:this.stroke;case"text-color":return this.text.color}}};C([Qh],qo.prototype,"label",2),C([Qh],qo.prototype,"reverse",2),C([Qh],qo.prototype,"showFill",2),C([Qh],qo.prototype,"isMultiColor",2),C([Qh],qo.prototype,"strokes",2),C([Qh],qo.prototype,"rangeStroke",2),C([Qh],qo.prototype,"bands",2);var{Property:xB}=R,Yr=class extends qo{constructor(){super(...arguments),this.type="fibonacci-retracement-trend-based",this.endRetracement=new Ff}static is(e){return Ve(e)&&e.type==="fibonacci-retracement-trend-based"}};C([xB],Yr.prototype,"type",2),C([xB],Yr.prototype,"endRetracement",2);var{Property:whe}=R,Qo=class extends qo{constructor(){super(...arguments),this.type="fibonacci-retracement"}static is(e){return Ve(e)&&e.type==="fibonacci-retracement"}};C([whe],Qo.prototype,"type",2);var{BaseProperties:Ahe,Property:Pb}=R,Ra=class extends Xh(nA(sA(lc(rA(qs(Ko(Ahe))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new Zce,this.text=new Bf,this.snapToAngle=45}static is(e){return Ve(e)&&e.type==="parallel-channel"}get bottom(){const e={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof e.start.y=="number"&&typeof e.end.y=="number"?(e.start.y-=this.height,e.end.y-=this.height):se.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),e}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Xu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Zu(this.lineCap,this.lineDash,this.lineStyle)}};C([Pb],Ra.prototype,"type",2),C([Pb],Ra.prototype,"height",2),C([Pb],Ra.prototype,"middle",2),C([Pb],Ra.prototype,"text",2);var{Property:Ihe}=R,Jo=class extends wb{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(e){return Ve(e)&&e.type==="text"}};C([Ihe],Jo.prototype,"type",2);function cc(e){return ta.is(e)}function Eb(e){return Zo.is(e)||Qs.is(e)||$r.is(e)||Xo.is(e)||CB(e)}function el(e){return Ea.is(e)||Ra.is(e)}function CB(e){return Qo.is(e)||Yr.is(e)}function Xr(e){return cr.is(e)||Kr.is(e)||Nn.is(e)||Jo.is(e)}function zf(e){return La.is(e)||Pa.is(e)||Yo.is(e)||ta.is(e)}function yA(e){return Xr(e)&&!Nn.is(e)}function hc(e){return Eb(e)||el(e)||zf(e)&&!ta.is(e)}function The(e){return Eb(e)||el(e)||zf(e)||cr.is(e)||Nn.is(e)}function khe(e){return Nn.is(e)}function Lhe(e){return el(e)||zf(e)||cr.is(e)||Kr.is(e)||fA.is(e)}function Phe(e){return Xr(e)&&!Nn.is(e)}function Qu(e){return(Eb(e)||el(e)||zf(e))&&!cc(e)&&Ve(e.text)}function Ehe(e,t){"fontSize"in e&&(e.fontSize=t),Qu(e)&&(e.text.fontSize=t)}function SB(e,t){var r,o,l;const i=(o=(r=t==null?void 0:t.strokeWidth)!=null?r:e.strokeWidth)!=null?o:1,s=(l=t==null?void 0:t.type)!=null?l:e.lineStyle,n=s!=null?s:_f(e.lineDash,s),a=uB(i,n);e.strokeWidth=i,e.computedLineDash=a,e.lineStyle=n,e.lineCap=n==="dotted"?"round":void 0}function Rb(e,t,i,s,n,a){switch(t){case"fill-color":{"fill"in e&&(e.fill=s),"fillOpacity"in e&&(e.fillOpacity=n),"background"in e&&(e.background.fill=s,e.background.fillOpacity=n);break}case"line-color":{"axisLabel"in e&&(e.axisLabel.fill=s,e.axisLabel.fillOpacity=n,e.axisLabel.stroke=s,e.axisLabel.strokeOpacity=n),"fill"in e&&"fillOpacity"in e&&khe(e)?(e.fill=s,e.fillOpacity=n):("strokeOpacity"in e&&(e.strokeOpacity=n),"isMultiColor"in e&&"rangeStroke"in e?(e.isMultiColor=a,e.rangeStroke=s):"stroke"in e&&(e.stroke=s));break}case"text-color":{"color"in e&&(e.color=i),Qu(e)&&(e.text.color=s);break}}}var{deepClone:Na}=R,Rhe=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(tA).map(e=>[e,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.fibonacciOptions=new Map([["fibonacci-retracement",{bands:void 0,reverse:void 0,showFill:void 0}],["fibonacci-retracement-trend-based",{bands:void 0,reverse:void 0,showFill:void 0}]])}createMemento(){return{colors:Na(this.colors),fontSizes:Na(this.fontSizes),lineStyles:Na(this.lineStyles),lineTextAlignments:Na(this.lineTextAlignments),lineTextPositions:Na(this.lineTextPositions),fibonacciOptions:Na(this.fibonacciOptions)}}guardMemento(e){return!0}restoreMemento(e,t,i){this.colors=Na(i.colors),this.fontSizes=Na(i.fontSizes),this.lineStyles=Na(i.lineStyles),this.lineTextAlignments=Na(i.lineTextAlignments),this.lineTextPositions=Na(i.lineTextPositions),this.fibonacciOptions=Na(i.fibonacciOptions)}setDefaultColor(e,t,i,s,n,a){var r;(r=this.colors.get(e))==null||r.set(t,[i,s,n,a])}setDefaultFontSize(e,t){this.fontSizes.set(e,t)}setDefaultLineStyleType(e,t){const i=this.lineStyles.get(e);i?i.type=t:this.lineStyles.set(e,{type:t})}setDefaultLineStyleWidth(e,t){const i=this.lineStyles.get(e);i?i.strokeWidth=t:this.lineStyles.set(e,{strokeWidth:t})}setDefaultLineTextAlignment(e,t){this.lineTextAlignments.set(e,t)}setDefaultLineTextPosition(e,t){this.lineTextPositions.set(e,t)}setDefaultFibonacciOptions(e,t,i){if(e!="fibonacci-retracement"&&e!="fibonacci-retracement-trend-based")return;const s=this.fibonacciOptions.get(e);s[t]=i,this.fibonacciOptions.set(e,s)}applyDefaults(e){for(const[t,i]of this.colors)if(e.type===t)for(const[s,[n,a,r,o]=[]]of i)n&&a&&r!=null&&o!=null&&Rb(e,s,n,a,r,o);for(const[t,i]of this.fontSizes)e.type!==t||i==null||Ehe(e,i);for(const[t,i]of this.lineStyles)e.type!==t||i==null||SB(e,i);for(const[t,i]of this.lineTextPositions)e.type!==t||i==null||(e.text.position=i);for(const[t,i]of this.lineTextAlignments)e.type!==t||i==null||(e.text.alignment=i);for(const[t,i]of this.fibonacciOptions)e.type!==t||i==null||Object.keys(i).forEach(s=>{const n=i[s];n!=null&&e.set({[s]:n})})}},Nhe='<div class="ag-charts-color-picker__palette" tabindex="0"></div><div class="ag-charts-color-picker__color-row"><button class="ag-charts-color-picker__multi-color-button" tabindex="0" type="button"></button> <input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"></div><input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field"><span class="ag-charts-color-picker__color-label">Color</span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',{Color:vA}=R,MB=e=>{try{const t=vA.fromString(e),[i,s,n]=t.toHSB();return[i,s,n,t.a]}catch(t){return}},DB=class extends R.AnchoredPopover{constructor(e,t){super(e,"color-picker",t),this.hasChanged=!1,this.hideFns.push(()=>{var i;this.hasChanged&&((i=this.onChangeHide)==null||i.call(this))})}show(e){this.hasChanged=!1,this.onChangeHide=e.onChangeHide;const{element:t,initialFocus:i}=this.createColorPicker(e),s=this.showWithChildren([t],b({initialFocus:i},e));s.classList.add("ag-charts-color-picker"),s.setAttribute("role","dialog")}createColorPicker(e){var v,x,S,M;let t=(v=e.isMultiColor)!=null?v:!1,[i,s,n,a]=(S=MB((x=e.color)!=null?x:"#f00"))!=null?S:[0,1,.5,1];a=(M=e.opacity)!=null?M:a;const r=ke("div","ag-charts-color-picker__content");r.innerHTML=Nhe,r.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");const o=r.querySelector(".ag-charts-color-picker__palette"),l=r.querySelector(".ag-charts-color-picker__hue-input"),c=r.querySelector(".ag-charts-color-picker__multi-color-button"),h=r.querySelector(".ag-charts-color-picker__alpha-input"),d=r.querySelector(".ag-charts-color-picker__color-input"),u=r.querySelector(".ag-charts-color-picker__color-label");c.classList.toggle("ag-charts-color-picker__multi-color-button--hidden",!e.hasMultiColorOption);const p=(D=!0)=>{var T;const w=vA.fromHSB(i,s,n,a).toHexString();if(r.style.setProperty("--h",`${i}`),r.style.setProperty("--s",`${s}`),r.style.setProperty("--v",`${n}`),r.style.setProperty("--a",`${a}`),r.style.setProperty("--color",w.slice(0,7)),r.style.setProperty("--color-a",w),l.value=`${i}`,h.value=`${a}`,h.classList.toggle("ag-charts-color-picker__alpha-input--opaque",a===1),c.classList.toggle("ag-charts-color-picker__multi-color-button--active",t),u.classList.toggle("ag-charts-color-picker__color-label--multi-color",t),document.activeElement!==d&&(d.value=t?"Multi Colour":w.toUpperCase()),D||e.color==null){const k=vA.fromHSB(i,s,n,1).toHexString();(T=e.onChange)==null||T.call(e,w,k,a,t)}D&&(this.hasChanged=!0)};p(!1);const g=D=>D.preventDefault(),f=D=>D.stopPropagation(),y=D=>{D.preventDefault();const A=D.currentTarget;A.focus();const w=A.getBoundingClientRect(),T=({clientX:N,clientY:O})=>{t=!1,s=Math.min(Math.max((N-w.left)/w.width,0),1),n=1-Math.min(Math.max((O-w.top)/w.height,0),1),p()},k=()=>{window.removeEventListener("pointermove",T)};T(D),window.addEventListener("pointermove",T),window.addEventListener("pointerup",k,{once:!0})};return r.addEventListener("mousedown",f),r.addEventListener("touchstart",f),r.addEventListener("touchmove",f),r.addEventListener("keydown",D=>{switch(D.stopPropagation(),D.key){case"Enter":case"Escape":this.hide();break;default:return}D.preventDefault()}),o.addEventListener("pointerdown",y),o.addEventListener("touchstart",g,{passive:!1}),o.addEventListener("touchmove",g,{passive:!1}),o.addEventListener("keydown",D=>{if(D.key==="ArrowLeft")s=we(0,s-.01,1);else if(D.key==="ArrowRight")s=we(0,s+.01,1);else if(D.key==="ArrowUp")n=we(0,n+.01,1);else if(D.key==="ArrowDown")n=we(0,n-.01,1);else return;D.preventDefault(),p()}),c.addEventListener("click",()=>{t=!t,p()}),l.addEventListener("input",D=>{var A;t=!1,i=(A=D.currentTarget.valueAsNumber)!=null?A:0,p()}),h.addEventListener("input",D=>{var A;t=!1,a=(A=D.currentTarget.valueAsNumber)!=null?A:0,p()}),d.addEventListener("input",D=>{t=!1;const A=MB(D.currentTarget.value);A!=null&&([i,s,n,a]=A,p())}),d.addEventListener("blur",()=>p()),d.addEventListener("keydown",D=>{D.key==="Enter"&&(D.currentTarget.blur(),p())}),{element:r,initialFocus:o}}};function wB(e){return!(e instanceof R.LogScale)&&!(e instanceof R.BandScale)}var Ohe=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel",visible:wB},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel",visible:wB}],Fhe=[{label:"toolbarAnnotationsFibonacciRetracement",icon:"fibonacci-retracement-drawing",value:"fibonacci-retracement"},{label:"toolbarAnnotationsFibonacciRetracementTrendBased",icon:"fibonacci-retracement-trend-based-drawing",value:"fibonacci-retracement-trend-based"}],Bhe=[{label:"Fibonacci - Extended",value:10},{label:"Fibonacci - 6 Band",value:6},{label:"Fibonacci - 4 Band",value:4}],_he=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],Ghe=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],zhe=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],AB=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],Vf=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],IB=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}],{Color:TB,FloatingToolbar:Vhe,Listeners:jhe,Menu:bA,PropertiesArray:Hhe,ToolbarButtonProperties:kB,ToolbarButtonWidget:Whe,Property:Jh}=R,Ju=class extends kB{constructor(){super(...arguments),this.checkedOverrides=new kB}};C([Jh],Ju.prototype,"value",2),C([Jh],Ju.prototype,"checkedOverrides",2),C([Jh],Ju.prototype,"color",2),C([Jh],Ju.prototype,"strokeWidth",2),C([Jh],Ju.prototype,"isMultiColor",2);var Uhe=class extends Whe{update(e){super.update(e),e.value==="line-stroke-width"&&this.updateLineStrokeWidth(e),(e.value==="fill-color"||e.value==="line-color"||e.value==="text-color")&&this.updateFillColor(e)}updateFillColor(e){var i;const t=this.getElement();t.classList.add("ag-charts-annotations__color-picker-button"),t.classList.toggle("ag-charts-annotations__color-picker-button--multi-color",e.isMultiColor),t.style.setProperty("--color",(i=e.color)!=null?i:null)}updateLineStrokeWidth(e){const t=this.getElement();t.classList.add("ag-charts-annotations__stroke-width-button"),t.style.setProperty("--stroke-width",`${e.strokeWidth}px`)}},Khe=class extends Vhe{createButtonWidget(){return new Uhe(this.localeManager)}},xA=class extends R.BaseProperties{constructor(e,t){super(),this.ctx=e,this.getActiveDatum=t,this.enabled=!0,this.buttons=new Hhe(Ju),this.destroyFns=[],this.events=new jhe,this.visibleButtons=[],this.toolbar=new Khe(this.ctx,"annotation-options"),this.colorPicker=new DB(this.ctx),this.textSizeMenu=new bA(this.ctx,"text-size"),this.lineStyleTypeMenu=new bA(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new bA(this.ctx,"annotations-line-stroke-width"),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("toolbar-moved",this.onToolbarMoved.bind(this)),e.widgets.seriesWidget.addListener("drag-start",this.onDragStart.bind(this)),e.widgets.seriesWidget.addListener("drag-end",this.onDragEnd.bind(this)),()=>this.colorPicker.destroy())}onDragStart(){this.toolbar.ignorePointerEvents()}onDragEnd(){this.toolbar.capturePointerEvents()}destroy(){for(const e of this.destroyFns)e()}addListener(e,t){return this.events.addListener(e,t)}show(){this.enabled&&this.toolbar.show()}hide(){this.toolbar.hide()}updateButtons(e){if(!this.enabled)return;const t={"line-style-type":hc(e),"line-stroke-width":hc(e),"line-color":The(e),"text-color":Phe(e),"fill-color":Lhe(e),"text-size":yA(e),settings:Qu(e),lock:!0,delete:!0};this.visibleButtons=this.buttons.filter(i=>t[i.value]),this.toolbar.clearButtons(),this.toolbar.updateButtons(this.visibleButtons),this.refreshButtons(e)}setAnchorScene(e){this.toolbar.hasBeenDragged()||this.toolbar.setAnchor(e.getAnchor())}hideOverlays(){this.toolbar.clearActiveButton(),this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.dispatch("hid-overlays")}clearActiveButton(){this.toolbar.clearActiveButton()}updateColors(e){this.updateColorPickerColor("line-color",e.getDefaultColor("line-color"),e.getDefaultOpacity("line-color"),"isMultiColor"in e&&(e==null?void 0:e.isMultiColor)),this.updateColorPickerColor("fill-color",e.getDefaultColor("fill-color"),e.getDefaultOpacity("fill-color"),"isMultiColor"in e&&(e==null?void 0:e.isMultiColor)),this.updateColorPickerColor("text-color",e.getDefaultColor("text-color"),e.getDefaultOpacity("text-color"),"isMultiColor"in e&&(e==null?void 0:e.isMultiColor))}updateColorPickerColor(e,t,i,s){if(t!=null&&i!=null){const{r:n,g:a,b:r}=TB.fromString(t);t=TB.fromArray([n,a,r,i]).toHexString()}this.updateButtonByValue(e,{color:t,isMultiColor:s})}updateFontSize(e){this.updateButtonByValue("text-size",{label:e!=null?String(e):void 0})}updateLineStyleType(e){this.updateButtonByValue("line-style-type",{icon:e.icon})}updateStrokeWidth(e){this.updateButtonByValue("line-stroke-width",{label:e.label,strokeWidth:e.value})}dispatch(e,t){this.events.dispatch(e,t)}onButtonPress({event:e,button:t}){const i=this.getActiveDatum();if(i)switch(this.hideOverlays(),t.value){case"line-style-type":{const s=hc(i)?_f(i.lineDash,i.lineStyle):void 0;this.lineStyleTypeMenu.show({items:Vf,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:s,sourceEvent:e.sourceEvent,onPress:n=>this.onLineStyleTypeMenuPress(n,i),class:"ag-charts-annotations__line-style-type-menu"});break}case"line-stroke-width":{const s=hc(i)?i.strokeWidth:void 0;this.lineStrokeWidthMenu.show({items:AB,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:s,sourceEvent:e.sourceEvent,onPress:n=>this.onLineStrokeWidthMenuPress(n,i),class:"ag-charts-annotations__line-stroke-width-menu"});break}case"line-color":case"fill-color":case"text-color":{this.toolbar.toggleActiveButtonByIndex(t.index),this.colorPicker.show({color:i==null?void 0:i.getDefaultColor(t.value),opacity:i==null?void 0:i.getDefaultOpacity(t.value),sourceEvent:e.sourceEvent,hasMultiColorOption:"isMultiColor"in i,isMultiColor:"isMultiColor"in i&&(i==null?void 0:i.isMultiColor),onChange:i!=null?this.onColorPickerChange.bind(this,t.value,i):void 0,onChangeHide:(s=>{this.dispatch("saved-color",{type:i.type,colorPickerType:t.value,color:i.getDefaultColor(s)})}).bind(this,t.value)});break}case"text-size":{const s=Xr(i)?i.fontSize:void 0;this.textSizeMenu.show({items:IB,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:s,sourceEvent:e.sourceEvent,onPress:n=>this.onTextSizeMenuPress(n,i),class:"ag-charts-annotations__text-size-menu"});break}case"delete":{this.dispatch("pressed-delete");break}case"lock":{i.locked=!i.locked,this.refreshButtons(i),this.dispatch("pressed-lock");break}case"settings":{this.toolbar.toggleActiveButtonByIndex(t.index),this.dispatch("pressed-settings",e);break}}}onToolbarMoved(e){const{buttonBounds:t,popoverBounds:i}=e,s={x:i.x,y:i.y+i.height+4},n={y:i.y-4};this.colorPicker.setAnchor(s,n);for(const[a,r]of t.entries()){const o=this.visibleButtons.at(a);if(!o)continue;const l={x:r.x,y:r.y+r.height-1},c={y:r.y};switch(o.value){case"line-stroke-width":this.lineStrokeWidthMenu.setAnchor(l,c);break;case"line-style-type":this.lineStyleTypeMenu.setAnchor(l,c);break;case"text-size":this.textSizeMenu.setAnchor(l,c);break}}}onColorPickerChange(e,t,i,s,n,a){this.dispatch("updated-color",{type:t.type,colorPickerType:e,colorOpacity:i,color:s,opacity:n,isMultiColor:a}),this.updateColorPickerColor(e,i,n,a)}onTextSizeMenuPress(e,t){if(!yA(t))return;const i=e.value;this.dispatch("updated-font-size",{type:t.type,fontSize:i}),this.textSizeMenu.hide(),this.updateFontSize(i)}onLineStyleTypeMenuPress(e,t){if(!hc(t))return;const i=e.value;this.dispatch("updated-line-style",{type:t.type,lineStyleType:i}),this.lineStyleTypeMenu.hide(),this.updateLineStyleType(e)}onLineStrokeWidthMenuPress(e,t){if(!hc(t))return;const i=e.value;this.dispatch("updated-line-width",{type:t.type,strokeWidth:i}),this.lineStrokeWidthMenu.hide(),this.updateStrokeWidth(e)}refreshButtons(e){var i;const t=(i=e.locked)!=null?i:!1;for(const[s,n]of this.visibleButtons.entries())n&&(n.value==="lock"?(this.toolbar.toggleSwitchCheckedByIndex(s,t),this.updateButtonByIndex(s,t?n.checkedOverrides.toJson():n.toJson())):this.toolbar.toggleButtonEnabledByIndex(s,!t));yA(e)&&this.updateFontSize(e.fontSize),this.updateColors(e),this.updateLineStyles(e)}updateLineStyles(e){var s,n;if(!hc(e))return;const t=(s=e.strokeWidth)!=null?s:1,i=_f(e.lineDash,e.lineStyle);this.updateStrokeWidth({strokeWidth:t,value:t,label:String(t)}),this.updateLineStyleType((n=Vf.find(a=>a.value===i))!=null?n:Vf[0])}updateButtonByValue(e,t){const i=this.visibleButtons.findIndex(s=>s.value===e);i!==-1&&this.updateButtonByIndex(i,t)}updateButtonByIndex(e,t){var s;const i=this.visibleButtons.at(e);i&&this.toolbar.updateButtonByIndex(e,E(b(b({},i.toJson()),t),{value:(s=t.value)!=null?s:i.value}))}};C([Jh],xA.prototype,"enabled",2),C([Jh],xA.prototype,"buttons",2);var{StateMachine:LB,StateMachineProperty:CA,Vec2:PB,Debug:$he}=R,Ei=class extends LB{constructor(e){const t=({context:i})=>{var s;(s=this.node)==null||s.drag(this.datum,this.offset,i,this.snapping),e.update()};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:i,context:s})=>{var n;this.hasMoved=!1,this.dragStart=i,this.offset=i,(n=this.node)==null||n.dragStart(this.datum,i,s)}}},dragging:{keyDown:t,keyUp:t,drag:({offset:i,context:s})=>{var n;this.hasMoved=PB.lengthSquared(PB.sub(i,this.dragStart))>0,this.offset=i,(n=this.node)==null||n.drag(this.datum,i,s,this.snapping),e.update()},dragEnd:{target:LB.parent,action:()=>{var i;(i=this.node)==null||i.stopDragging(),this.hasMoved&&e.recordAction("Move annotation"),e.update()}}}}),this.debug=$he.create(!0,"annotations"),this.hasMoved=!1,this.snapping=!1}};C([CA()],Ei.prototype,"snapping",2),C([CA()],Ei.prototype,"datum",2),C([CA()],Ei.prototype,"node",2);var{Property:Yhe}=R,dc=class extends fA{constructor(){super(...arguments),this.type="arrow-down"}static is(e){return Ve(e)&&e.type==="arrow-down"}};C([Yhe],dc.prototype,"type",2);var EB=class jj extends R.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(t){const{handle:i,locked:s}=this;return s?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:t,offset:{x:t.x-i.x,y:t.y-i.y}}}toggleActive(t){this.active=t,t||(this.handle.strokeWidth=jj.INACTIVE_STROKE_WIDTH)}toggleHovered(t){this.glow.visible=!this.locked&&t,this.glow.dirtyPath=!0}toggleDragging(t){this.locked||(this.handle.visible=!t,this.glow.visible=this.glow.visible&&!t,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(t){this.locked=t}getCursor(){}containsPoint(t,i){return this.handle.containsPoint(t,i)}};EB.INACTIVE_STROKE_WIDTH=2;var uc=EB,SA=class Hj extends uc{constructor(){super(),this.handle=new R.Marker({shape:"circle"}),this.glow=new R.Marker({shape:"circle"}),this.append([this.handle]),this.handle.size=Hj.HANDLE_SIZE,this.handle.strokeWidth=uc.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(t){this.handle.setProperties(E(b({},t),{strokeWidth:uc.INACTIVE_STROKE_WIDTH}))}drag(t){return{point:t,offset:{x:0,y:0}}}};SA.HANDLE_SIZE=7,SA.GLOW_SIZE=9;var pc=SA,Nb=class Wn extends uc{constructor(){super(),this.handle=new R.Rect,this.glow=new R.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=Wn.CORNER_RADIUS,this.handle.width=Wn.HANDLE_SIZE,this.handle.height=Wn.HANDLE_SIZE,this.handle.strokeWidth=uc.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=Wn.CORNER_RADIUS,this.glow.width=Wn.GLOW_SIZE,this.glow.height=Wn.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(t){if(super.toggleLocked(t),t){const i=(Wn.HANDLE_SIZE-pc.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=pc.HANDLE_SIZE,this.handle.height=pc.HANDLE_SIZE,this.glow.width=pc.GLOW_SIZE,this.glow.height=pc.GLOW_SIZE}else this.handle.cornerRadius=Wn.CORNER_RADIUS,this.handle.width=Wn.HANDLE_SIZE,this.handle.height=Wn.HANDLE_SIZE,this.glow.width=Wn.GLOW_SIZE,this.glow.height=Wn.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(t){var i,s;if(this.cachedStyles=b({},t),this.active||delete t.strokeWidth,this.locked){delete t.fill,delete t.strokeWidth;const n=(Wn.HANDLE_SIZE-pc.HANDLE_SIZE)/2;t.x-=n,t.y-=n,this.cachedStyles.x-=n,this.cachedStyles.y-=n}this.handle.setProperties(t),this.glow.setProperties(E(b({},t),{x:((i=t.x)!=null?i:this.glow.x)-2,y:((s=t.y)!=null?s:this.glow.y)-2,strokeWidth:0,fill:t.stroke}))}drag(t){return this.locked?{point:t,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:t.x,y:this.handle.y},offset:{x:t.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:t.y},offset:{x:0,y:t.y-this.handle.y}}}getCursor(){if(!this.locked)return this.gradient==="vertical"?"col-resize":"row-resize"}};Nb.HANDLE_SIZE=12,Nb.GLOW_SIZE=16,Nb.CORNER_RADIUS=4;var ep=Nb,MA=class km extends uc{constructor(){super(),this.handle=new R.Marker({shape:"circle"}),this.glow=new R.Marker({shape:"circle"}),this.append([this.glow,this.handle]),this.handle.size=km.HANDLE_SIZE,this.handle.strokeWidth=uc.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=km.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(t){super.toggleLocked(t),t?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=pc.HANDLE_SIZE,this.glow.size=pc.GLOW_SIZE):(this.handle.size=km.HANDLE_SIZE,this.glow.size=km.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(t){this.cachedStyles=b({},t),this.active||delete t.strokeWidth,this.locked&&(delete t.fill,delete t.strokeWidth),this.handle.setProperties(t),this.glow.setProperties(E(b({},t),{strokeWidth:0,fill:t.stroke}))}getCursor(){return"pointer"}};MA.HANDLE_SIZE=11,MA.GLOW_SIZE=17;var gi=MA,{ZIndexMap:Xhe}=R,fs=class extends R.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=Xhe.CHART_ANNOTATION}static isCheck(e,t){return Ve(e)&&Object.hasOwn(e,"type")&&e.type===t}toggleHovered(e){this.toggleHandles(e)}*nonHandleChildren(){for(const e of this.children())e instanceof uc||(yield e)}computeBBoxWithoutHandles(){return R.Transformable.toCanvas(this,R.Group.computeChildrenBBox(this.nonHandleChildren()))}updateNode(e,t,i){if(!i&&t){this.removeChild(t);return}return i&&t==null&&(t=new e,this.appendChild(t)),t}},{ContinuousScale:Zhe,Vec2:Oa,toRadians:qhe}=R;function jf(e,t,i=!1,s,n=1){if(!i)return vn(e,t);const a=s?pi(s,t):Oa.origin();return vn(Ob(e,a,n),t)}function Ob(e,t,i){const s=Oa.sub(e,t),n=qhe(i),a=Math.round(Oa.angle(s)/n)*n;return Oa.rotate(s,a,t)}function Fb(e,t){const i={};for(const[s,n]of Zt(e))i[s]=pi(n,t);return i}function tl(e,t,i,s={overflowContinuous:0,translateVectors:void 0,invertYVectors:void 0,snap:void 0}){var v,x;const{xAxis:n,yAxis:a}=i,r=Object.keys(e),o=[],l=[],c=new Set((v=s.translateVectors)!=null?v:r),h=new Set((x=s.invertYVectors)!=null?x:[]),d=new Set([...c,...h]),u=Oa.multiply(t,Oa.from(1,-1));for(const S of r)d.has(S)&&(e[S]=Oa.add(e[S],h.has(S)?u:t),s.snap&&(e[S]=Ob(e[S],s.snap.vectors[S],s.snap.angle))),o.push(n.getRangeOverflow(e[S].x)),l.push(a.getRangeOverflow(e[S].y));const p=(S,M)=>Math.abs(S)-Math.abs(M),g=(S,M,D)=>{var w,T,k;return s.overflowContinuous===0||!Zhe.is(S)?(w=D.toSorted(p).at(-1))!=null?w:0:r.length===d.size?(T=D.toSorted(p).at(-s.overflowContinuous-1))!=null?T:0:D.filter(N=>N!==0).length<=s.overflowContinuous?0:(k=D.filter((N,O)=>N!==0&&Math.abs(N)<=Math.abs(M)&&d.has(r[O])).toSorted(p).at(-1))!=null?k:0},f=Oa.from(g(n.scale,t.x,o),g(a.scale,t.y,l));if(!Oa.equal(f,Oa.origin()))for(const S of r)d.has(S)&&(e[S]=Oa.round(Oa.sub(e[S],f),4));const y={};for(const S of r)y[S]=vn(e[S],i);return y}var{Vec2:Qhe}=R,RB=class extends fs{constructor(){super(...arguments),this.handle=new gi,this.anchor={x:0,y:0,position:"above"}}update(e,t){const i=pi(e,t);this.updateHandle(e,i),this.anchor=this.updateAnchor(e,i,t)}dragStart(e,t,i){this.dragState=b({offset:t},Fb({handle:e},i))}drag(e,t,i){const{dragState:s}=this;if(e.locked||!s)return;const{point:n}=tl({point:s.handle},Qhe.sub(t,s.offset),i);e.x=n.x,e.y=n.y}translate(e,t,i){if(e.locked)return;const{point:s}=tl({point:pi(e,i)},t,i);e.x=s.x,e.y=s.y}toggleHandles(e){this.handle.visible=!!e,this.handle.toggleHovered(this.activeHandle==="handle")}toggleActive(e){this.toggleHandles(e),this.handle.toggleActive(e)}stopDragging(){this.handle.toggleDragging(!1)}copy(e,t,i){const s=pi(e,i),n=vn({x:s.x-30,y:s.y-30},i);return t.x=n.x,t.y=n.y,t}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(e,t){const{handle:i}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="handle",!0):!1}getNodeAtCoords(e,t){if(this.handle.containsPoint(e,t))return"handle"}updateHandle(e,t,i){var r;const{x:s,y:n}=this.getHandleCoords(e,t,i),a=this.getHandleStyles(e);this.handle.update(E(b({},a),{x:s,y:n})),this.handle.toggleLocked((r=e.locked)!=null?r:!1)}updateAnchor(e,t,i){const s=this.getHandleCoords(e,t);return{x:s.x+i.seriesRect.x,y:s.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(e,t,i){return{x:t.x,y:t.y}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}},NB=class extends RB{constructor(){super(),this.append([this.handle])}update(e,t){super.update(e,t);const i=pi(e,t);this.updateShape(e,i)}updateShape(e,t){this.updateShapeStyles(e),this.updateShapePath(e,t)}updateShapeStyles(e){var i;const{shape:t}=this;t.fill=e.fill,t.fillOpacity=(i=e.fillOpacity)!=null?i:1}updateShapePath(e,t){const{shape:i}=this;i.x=t.x,i.y=t.y,i.size=e.size}containsPoint(e,t){return super.containsPoint(e,t)||this.shape.containsPoint(e,t)}getNodeAtCoords(e,t){return this.shape.containsPoint(e,t)?"shape":super.getNodeAtCoords(e,t)}},OB=[[.5,0],[1,.5],[.75,.5],[.75,1],[.25,1],[.25,.5],[0,.5]];function FB(e){R.drawMarkerUnitPolygon(e,OB)}FB.anchor={x:.5,y:0};var Bb=class extends NB{constructor(){super(),this.type="arrow-up",this.shape=new R.Marker({shape:FB}),this.append([this.shape])}static is(e){return fs.isCheck(e,"arrow-up")}getHandleCoords(e,t){const i=gi.HANDLE_SIZE/2,s=super.getHandleCoords(e,t);return s.y-=i,s}},Jhe=OB.map(([e,t])=>[e,1-t]);function BB(e){R.drawMarkerUnitPolygon(e,Jhe)}BB.anchor={x:.5,y:1};var _b=class extends NB{constructor(){super(),this.type="arrow-down",this.shape=new R.Marker({shape:BB}),this.append([this.shape])}static is(e){return fs.isCheck(e,"arrow-down")}updateAnchor(e,t,i){const s=super.updateAnchor(e,t,i);return s.y-=e.size,s}getHandleCoords(e,t){const i=gi.HANDLE_SIZE/2,s=super.getHandleCoords(e,t);return s.y+=i,s}},{StateMachine:Gb,StateMachineProperty:ede,Debug:tde}=R,DA=class extends Gb{constructor(e){const t=({point:s})=>{const n=this.createDatum();n.set({x:s.x,y:s.y}),e.create(n)},i=()=>{var s;(s=this.node)==null||s.toggleActive(!0),e.showAnnotationOptions(),e.update()};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},cancel:Gb.parent,reset:Gb.parent},"waiting-first-render":{render:{target:Gb.parent,action:i}}}),this.debug=tde.create(!0,"annotations")}};C([ede()],DA.prototype,"node",2);var ide=class extends DA{createDatum(){return new dc}},_B={type:"arrow-down",datum:dc,scene:_b,isDatum:dc.is,translate:(e,t,i,s)=>{dc.is(t)&&_b.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(dc.is(t)&&dc.is(i)&&_b.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{dc.is(t)&&_b.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new ide(E(b({},e),{create:t("arrow-down")})),dragState:e=>new Ei(e)},{Property:sde}=R,gc=class extends fA{constructor(){super(...arguments),this.type="arrow-up"}static is(e){return Ve(e)&&e.type==="arrow-up"}};C([sde],gc.prototype,"type",2);var nde=class extends DA{createDatum(){return new gc}},GB={type:"arrow-up",datum:gc,scene:Bb,isDatum:gc.is,translate:(e,t,i,s)=>{gc.is(t)&&Bb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(gc.is(t)&&gc.is(i)&&Bb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{gc.is(t)&&Bb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new nde(E(b({},e),{create:t("arrow-up")})),dragState:e=>new Ei(e)},{Vec2:ade,Vec4:zB}=R,VB=class extends fs{constructor(){super(...arguments),this.overflowContinuous=0}extendLine({x1:e,y1:t,x2:i,y2:s},n,a){const r={x1:e,y1:t,x2:i,y2:s};if(!n.extendStart&&!n.extendEnd)return r;const[o,l]=hhe(r,a.yAxis.bounds),c=r.x2<r.x1,h=r.y1>=r.y2,d=r.x2===r.x1;return n.extendEnd&&(d?r.y2=h?l.y:o.y:(r.x2=c?o.x:l.x,r.y2=c?o.y:l.y)),n.extendStart&&(d?r.y1=h?o.y:l.y:(r.x1=c?l.x:o.x,r.y1=c?l.y:o.y)),r}dragStart(e,t,i){this.dragState=b({offset:t},Fb({start:e.start,end:e.end},i))}drag(e,t,i,s){e.locked||(this.activeHandle?this.dragHandle(e,t,i,s):this.dragAll(e,t,i))}dragAll(e,t,i){const{dragState:s}=this;s&&this.translatePoints(e,s.start,s.end,ade.sub(t,s.offset),i)}translate(e,t,i){e.locked||this.translatePoints(e,pi(e.start,i),pi(e.end,i),t,i)}copy(e,t,i){const s=yn(e,i);if(!s)return;const n=this.computeBBoxWithoutHandles(),a={x:-n.width/2,y:-n.height/2};return this.translatePoints(t,zB.start(s),zB.end(s),a,i),t}translatePoints(e,t,i,s,n){const a=this.getTranslatePointsVectors(t,i),r=tl(a,s,n,{overflowContinuous:this.overflowContinuous});e.start.x=r.start.x,e.end.x=r.end.x,e.start.y=r.start.y,e.end.y=r.end.y}getTranslatePointsVectors(e,t){return{start:e,end:t}}},{Vec2:rde,Vec4:jB}=R,wA=class extends VB{constructor(){super(...arguments),this.start=new gi,this.end=new gi,this.anchor={x:0,y:0,position:"above"}}update(e,t){const i=yn(e,t);i!=null&&(this.updateHandles(e,i),this.updateAnchor(e,i,t))}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e;else for(const[t,i]of Zt(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}dragHandle(e,t,i,s){const{activeHandle:n,dragState:a}=this;if(!n||!a)return;this[n].toggleDragging(!0);const r=n==="start"?"end":"start",o=s?{vectors:{[n]:pi(e[r],i)},angle:e.snapToAngle}:void 0,{[n]:l}=tl({[n]:a[n]},rde.sub(t,a.offset),i,{overflowContinuous:0,snap:o});e[n].x=l.x,e[n].y=l.y}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(e,t){const{start:i,end:s}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):!1}getNodeAtCoords(e,t){if(this.start.containsPoint(e,t)||this.end.containsPoint(e,t))return"handle"}updateHandles(e,t,i){var s,n;this.start.update(b(b({},this.getHandleStyles(e,"start")),this.getHandleCoords(e,t,"start"))),this.end.update(b(b({},this.getHandleStyles(e,"end")),this.getHandleCoords(e,t,"end",i))),this.start.toggleLocked((s=e.locked)!=null?s:!1),this.end.toggleLocked((n=e.locked)!=null?n:!1)}updateAnchor(e,t,i,s){this.anchor={x:t.x1+i.seriesRect.x,y:t.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(e,t,i,s){return i==="start"?jB.start(t):jB.end(t)}getHandleStyles(e,t){return{fill:e.handle.fill,stroke:e.handle.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}},{Vec4:HB}=R,ode=class extends wA{constructor(){super(...arguments),this.label=new R.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(e){this.textInputBBox=e,this.markDirty("TextualStartEndScene")}update(e,t){const i=yn(e,t);if(i==null)return;const s=this.getTextBBox(e,i);this.updateLabel(e,s,i),this.updateHandles(e,i,s),this.updateShape(e,s,i),this.updateAnchor(e,i,t,s)}containsPoint(e,t){return super.containsPoint(e,t)||this.label.containsPoint(e,t)}getNodeAtCoords(e,t){return this.label.containsPoint(e,t)?"text":super.getNodeAtCoords(e,t)}getTextBBox(e,t){const{text:i}=e.getText();return gA(e,i,HB.end(t),this.textInputBBox)}updateLabel(e,t,i){const{text:s,isPlaceholder:n}=e.getText();gB(this.label,s,n,e,this.getLabelCoords(e,t,i))}updateShape(e,t,i){}getLabelCoords(e,t,i){return HB.end(i)}getHandleStyles(e,t){var i;return E(b({},super.getHandleStyles(e,t)),{stroke:(i=e.handle.stroke)!=null?i:e.color})}},{drawCorner:lde,Path:cde}=R,zb=class extends ode{constructor(){super(),this.type="callout",this.shape=new cde,this.append([this.shape,this.label,this.start,this.end])}static is(e){return fs.isCheck(e,"callout")}drag(e,t,i,s){e.locked||(this.activeHandle==="end"?this.dragHandle(e,t,i,s):this.dragAll(e,t,i))}getLabelCoords(e,t,i){var a;const s=e.getPadding(),{bodyBounds:n={x:0,y:0,width:0,height:0}}=(a=this.getDimensions(e,t,i))!=null?a:{};return{x:n.x+s.left,y:n.y-s.bottom}}getHandleStyles(e,t){var i;return t==="start"?{fill:e.handle.fill,stroke:(i=e.handle.stroke)!=null?i:e.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(e,t,i,s){var r;const{bodyBounds:n}=(r=this.getDimensions(e,s,t))!=null?r:{},a=n!=null?n:s;this.anchor={x:a.x+i.seriesRect.x,y:a.y+i.seriesRect.y-a.height,position:this.anchor.position}}updateShape(e,t,i){var r,o,l,c;const{shape:s}=this;s.fill=e.fill,s.fillOpacity=(r=e.fillOpacity)!=null?r:1,s.stroke=e.stroke,s.strokeWidth=(o=e.strokeWidth)!=null?o:1,s.strokeOpacity=(l=e.strokeOpacity)!=null?l:1;const{tailPoint:n,bodyBounds:a}=(c=this.getDimensions(e,t,i))!=null?c:{};!n||!a||this.updatePath(n,a)}updatePath(e,t){const{x:i,y:s}=e,{x:n,y:a,width:r,height:o}=t,l=a-o,c=n+r,h=this.calculateCalloutPlacement({x:i,y:s},t),d=8,u=[{coordinates:{x0:n,x1:n+d,y0:l+d,y1:l,cx:h==="topLeft"?i:n+d,cy:h==="topLeft"?s:l+d},type:h==="topLeft"?"calloutCorner":"corner"},{coordinates:{x0:n+d,x1:c-d,y0:l,y1:l,cx:i,cy:s},type:h==="top"?"calloutSide":"side"},{coordinates:{x0:c-d,x1:c,y0:l,y1:l+d,cx:h==="topRight"?i:c-d,cy:h==="topRight"?s:l+d},type:h==="topRight"?"calloutCorner":"corner"},{coordinates:{x0:c,x1:c,y0:l+d,y1:a-d,cx:i,cy:s},type:h==="right"?"calloutSide":"side"},{coordinates:{x0:c,x1:c-d,y0:a-d,y1:a,cx:h==="bottomRight"?i:c-d,cy:h==="bottomRight"?s:a-d},type:h==="bottomRight"?"calloutCorner":"corner"},{coordinates:{x0:c-d,x1:n+d,y0:a,y1:a,cx:i,cy:s},type:h==="bottom"?"calloutSide":"side"},{coordinates:{x0:n+d,x1:n,y0:a,y1:a-d,cx:h==="bottomLeft"?i:n+d,cy:h==="bottomLeft"?s:a-d},type:h==="bottomLeft"?"calloutCorner":"corner"},{coordinates:{x0:n,x1:n,y0:a-d,y1:l+d,cx:i,cy:s},type:h==="left"?"calloutSide":"side"}],{path:p}=this.shape;p.clear(),p.moveTo(n,l+d),u.forEach(({coordinates:g,type:f})=>{this.drawPath(p,g,d,f)}),p.closePath()}drawPath(e,{x0:t,y0:i,x1:s,y1:n,cx:a,cy:r},o,l){switch(l){case"calloutCorner":{e.lineTo(a,r),e.lineTo(s,n);break}case"corner":{lde(e,{x0:t,x1:s,y0:i,y1:n,cx:a,cy:r},o,!1);break}case"calloutSide":{if(t!==s){const h=t>s?-1:1,d=Math.min(t,s)+Math.abs(s-t)/2;e.lineTo(d-6*h,i),e.lineTo(a,r),e.lineTo(d+6*h,i),e.lineTo(s,n)}else{const h=i>n?-1:1,d=Math.min(i,n)+Math.abs(i-n)/2;e.lineTo(t,d-6*h),e.lineTo(a,r),e.lineTo(t,d+6*h),e.lineTo(s,n)}break}case"side":default:{e.lineTo(s,n);break}}}calculateCalloutPlacement(e,t){const i=t.x+t.width,s=t.y-t.height;let n,a;return e.x>i?n="right":e.x<t.x&&(n="left"),e.y>t.y?a="bottom":e.y<s&&(a="top"),n&&a?`${a}${n[0].toUpperCase()}${n.substring(1)}`:a!=null?a:n}getDimensions(e,t,i){const{fontSize:s}=e,n=e.getPadding(),a=n.left+n.right,r=n.top+n.bottom,o=t.width+a,l=Math.max(t.height+r,s+r);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:t.x,y:t.y,width:o,height:l}}}containsPoint(e,t){const{start:i,end:s,shape:n}=this;if(this.activeHandle=void 0,i.containsPoint(e,t))return this.activeHandle="start",!0;const a=s.containsPoint(e,t)||n.containsPoint(e,t);return a&&(this.activeHandle="end"),a}};function AA({key:e}){return e==="Escape"}function IA({key:e,shiftKey:t}){return!t&&e==="Enter"}var{StateMachine:hr,StateMachineProperty:WB,Debug:hde}=R,TA=class extends hr{constructor(e){const t=({point:u})=>{const p=this.createDatum();p.set({start:u,end:u,visible:!0}),e.create(p)},i=()=>{const{node:u}=this;u==null||u.toggleActive(!0),u==null||u.toggleHandles({start:!0})},s=()=>{e.showTextInput(),this.datum&&(this.datum.visible=!1)},n=()=>{e.hideTextInput(),this.datum&&(this.datum.visible=!0),e.deselect()},a=u=>{var p;(p=this.node)==null||p.setTextInputBBox(u),e.update()},r=({point:u})=>{const{datum:p,node:g}=this;p==null||p.set({end:u}),g==null||g.toggleActive(!0),g==null||g.toggleHandles({end:!1}),e.update()},o=()=>{var u;e.showAnnotationOptions(),(u=this.node)==null||u.toggleHandles({end:!0})},l=({colorPickerType:u,colorOpacity:p,color:g,opacity:f,isMultiColor:y})=>{const{datum:v}=this;v&&(u==="text-color"&&e.updateTextInputColor(g),Rb(v,u,p,g,f,y),e.update())},c=u=>{const{datum:p,node:g}=this;!p||!g||!Xr(p)||(p.fontSize=u,e.updateTextInputFontSize(u),e.update())},h=()=>{e.delete()},d=({textInputValue:u,bbox:p})=>{const{datum:g}=this;if(p!=null&&u!=null&&u.length>0){if(!Xr(g))return;const f=Ib(g,u,p.width);g==null||g.set({text:f}),e.update(),e.recordAction(`Create ${g==null?void 0:g.type} annotation`)}else e.delete()};super("start",{start:{click:{target:"waiting-first-render",action:t},dragStart:{target:"waiting-first-render",action:t},cancel:hr.parent,reset:hr.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:r,drag:r,click:{target:"edit",action:o},dragEnd:{target:"edit",action:o},reset:{target:hr.parent,action:h},cancel:{target:hr.parent,action:h}},edit:{onEnter:s,updateTextInputBBox:a,color:l,fontSize:c,textInput:[{guard:AA,target:hr.parent,action:h},{guard:IA,target:hr.parent,action:d}],click:{target:hr.parent,action:d},dragStart:{target:hr.parent,action:d},resize:{target:hr.parent,action:d},onExit:n,cancel:{target:hr.parent,action:h}}}),this.debug=hde.create(!0,"annotations")}};C([WB()],TA.prototype,"datum",2),C([WB()],TA.prototype,"node",2);var dde=class extends TA{createDatum(){return new cr}},UB={type:"callout",datum:cr,scene:zb,isDatum:cr.is,translate:(e,t,i,s)=>{if(cr.is(t)&&zb.is(e))return e.translate(t,i,s)},copy:(e,t,i,s)=>{if(cr.is(t)&&cr.is(i)&&zb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{cr.is(t)&&zb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new dde(E(b({},e),{create:t("callout")})),dragState:e=>new Ei(e)},kA=class extends RB{constructor(){super(...arguments),this.label=new R.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(e){this.textInputBBox=e,this.markDirty("TextualPointScene")}update(e,t){const i=pi(e,t),s=this.getTextBBox(e,i,t);this.updateLabel(e,s),this.updateHandle(e,i,s),this.updateShape(e,s),this.anchor=this.updateAnchor(e,s,t)}copy(e,t,i){const s=pi(e,i),n=this.getTextBBox(e,s,i),a=e.getPadding(),r=a.left+a.right,o=a.top+a.bottom,l=(n.width+r)/2,c=n.height+o,h=vn({x:s.x-l,y:s.y-c},i);return t.x=h.x,t.y=h.y,t}containsPoint(e,t){const{label:i}=this;return super.containsPoint(e,t)||i.visible&&i.containsPoint(e,t)}getNodeAtCoords(e,t){return this.label.visible&&this.label.containsPoint(e,t)?"text":super.getNodeAtCoords(e,t)}getTextBBox(e,t,i){const{text:s}=e.getText();return gA(e,s,{x:t.x,y:t.y},this.textInputBBox)}updateLabel(e,t){const{text:i,isPlaceholder:s}=e.getText();gB(this.label,i,s,e,this.getLabelCoords(e,t),this.getTextBaseline(e))}updateShape(e,t){}updateAnchor(e,t,i){return{x:t.x+i.seriesRect.x,y:t.y+i.seriesRect.y-t.height,position:this.anchor.position}}getLabelCoords(e,t){return t}getTextBaseline(e){return e.position=="center"?"middle":e.position}getHandleCoords(e,t,i){return i}getHandleStyles(e){var i;const t=super.getHandleStyles(e);return t.stroke=(i=e.handle.stroke)!=null?i:e.color,t}},{drawCorner:LA}=R,Vb=class extends kA{constructor(){super(),this.type="comment",this.shape=new R.Path,this.append([this.shape,this.label,this.handle])}static is(e){return fs.isCheck(e,"comment")}updateShape(e,t){var s,n,a,r;const{shape:i}=this;i.fill=e.fill,i.fillOpacity=(s=e.fillOpacity)!=null?s:1,i.stroke=(n=e.stroke)!=null?n:"transparent",i.strokeWidth=(a=e.strokeWidth)!=null?a:1,i.strokeOpacity=(r=e.strokeOpacity)!=null?r:1,this.updatePath(e,t)}getLabelCoords(e,t){const i=e.getPadding();return{x:t.x+i.left,y:t.y-i.bottom}}getHandleStyles(e){var t,i;return{fill:e.handle.fill,stroke:(i=(t=e.handle.stroke)!=null?t:e.stroke)!=null?i:e.fill,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}updateAnchor(e,t,i){const s=super.updateAnchor(e,t,i),n=e.getPadding();return s.y-=n.bottom+n.top,s}updatePath(e,t){const i=e.getPadding(),{x:s,y:n}=t;let{width:a,height:r}=t;const{fontSize:o}=e,l=i.left+i.right,c=i.top+i.bottom;a=a+l,r=Math.max(r+c,o+c);const h=n-r,d=s+a,u=(o*Gf+c)/2,{path:p}=this.shape;p.clear(),p.moveTo(s,n),p.lineTo(s,h+u),LA(p,{x0:s,x1:s+u,y0:h+u,y1:h,cx:s+u,cy:h+u},u,!1),p.lineTo(d-u,h),LA(p,{x0:d-u,x1:d,y0:h,y1:h+u,cx:d-u,cy:h+u},u,!1),p.lineTo(d,n-u),LA(p,{x0:d,x1:d-u,y0:n-u,y1:n,cx:d-u,cy:n-u},u,!1),p.closePath()}containsPoint(e,t){return super.containsPoint(e,t)||this.shape.containsPoint(e,t)}},{StateMachine:il,StateMachineProperty:KB,Debug:ude}=R,Hf=class extends il{constructor(e){const t=({point:h})=>{const d=this.createDatum();d.set({x:h.x,y:h.y}),e.create(d)},i=()=>{var h;(h=this.node)==null||h.toggleActive(!0),e.showAnnotationOptions(),e.update()},s=()=>{e.showTextInput(),this.datum&&(this.datum.visible=!1)},n=()=>{e.hideTextInput(),this.datum&&(this.datum.visible=!0),e.deselect()},a=h=>{var d;(d=this.node)==null||d.setTextInputBBox(h),e.update()},r=({colorPickerType:h,colorOpacity:d,color:u,opacity:p,isMultiColor:g})=>{this.datum&&(h==="text-color"&&e.updateTextInputColor(u),Rb(this.datum,h,d,u,p,g),e.update())},o=h=>{const{datum:d,node:u}=this;!d||!u||!Xr(d)||(d.fontSize=h,e.updateTextInputFontSize(h),e.update())},l=()=>{e.delete()},c=({textInputValue:h,bbox:d})=>{if(d!=null&&h!=null&&h.length>0){const{datum:u}=this;if(!Xr(u))return;const p=Ib(u,h,d.width);u==null||u.set({text:p}),e.update(),e.recordAction(`Create ${u==null?void 0:u.type} annotation`)}else e.delete()};super("start",{start:{click:{target:"waiting-first-render",action:t},dragStart:{target:"waiting-first-render",action:t},cancel:il.parent,reset:il.parent},"waiting-first-render":{render:{target:"edit",action:i}},edit:{onEnter:s,updateTextInputBBox:a,color:r,fontSize:o,textInput:[{guard:AA,target:il.parent,action:l},{guard:IA,target:il.parent,action:c}],click:{target:il.parent,action:c},dragStart:{target:il.parent,action:c},resize:{target:il.parent,action:c},onExit:n,cancel:{target:il.parent,action:l}}}),this.debug=ude.create(!0,"annotations")}};C([KB()],Hf.prototype,"datum",2),C([KB()],Hf.prototype,"node",2);var pde=class extends Hf{createDatum(){return new Kr}},$B={type:"comment",datum:Kr,scene:Vb,isDatum:Kr.is,translate:(e,t,i,s)=>{Kr.is(t)&&Vb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Kr.is(t)&&Kr.is(i)&&Vb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Kr.is(t)&&Vb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new pde(E(b({},e),{create:t("comment")})),dragState:e=>new Ei(e)},{calculateLabelTranslation:gde,ChartAxisDirection:fde}=R,YB=class extends R.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new R.Text({zIndex:1}),this.rect=new R.Rect;const{label:e}=this;e.fontSize=12,e.fontFamily="Verdana, sans-serif",e.fill="black",e.textBaseline="middle",e.textAlign="center",this.append([this.rect,this.label])}update(e){this.updateLabel(e),this.updateRect(e),this.updatePosition(e)}updateLabel({value:e,styles:t,context:i}){const{fontWeight:s,fontSize:n,fontStyle:a,fontFamily:r,textAlign:o,color:l="white",formatter:c}=t,h=c?c({value:e}):i.scaleValueFormatter()(e);this.label.setProperties({fontWeight:s,fontSize:n,fontStyle:a,fontFamily:r,textAlign:o,fill:l,text:h})}updateRect({styles:e}){const{rect:t}=this,{cornerRadius:i,fill:s,fillOpacity:n,stroke:a,strokeOpacity:r}=e;t.setProperties({cornerRadius:i,fill:s,fillOpacity:n,stroke:a,strokeOpacity:r})}updatePosition({x:e,y:t,context:i,styles:{padding:s}}){var g,f;const{label:n,rect:a}=this,r=(g=n.getBBox())==null?void 0:g.clone(),o=s!=null?s:8,l=s!=null?s:5;r.grow(o,"horizontal"),r.grow(l,"vertical");const c=i.direction===fde.X?Math.round(l/2):o,{xTranslation:h,yTranslation:d}=gde({yDirection:!0,padding:i.labelPadding-c,position:(f=i.position)!=null?f:"left",bbox:r}),u=e+h,p=t+d;n.x=u,n.y=p,a.y=p-Math.round(r.height/2),a.x=u-Math.round(r.width/2),a.height=r.height,a.width=r.width}};YB.className="AxisLabel";var{Vec2:Zr}=R,On=class extends R.Line{constructor(){super(...arguments),this.growCollisionBox=9,this.clipMask=new Map}setProperties(e,t){return super.setProperties(e,t),this.updateCollisionBBox(),this}updateCollisionBBox(){const{growCollisionBox:e,strokeWidth:t,x1:i,y1:s,x2:n,y2:a}=this;let r=t+e;r%2===0&&(r+=1);const o=Zr.from(i,s-Math.floor(r/2)),l=Zr.from(n,a),c=Zr.distance(o,l);this.collisionBBox=new R.BBox(o.x,o.y,c,r)}isPointInPath(e,t){var u;const{collisionBBox:i,x1:s,y1:n,x2:a,y2:r}=this;if(!i)return!1;const o=Zr.from(s,n),l=Zr.from(a,r),c=Zr.sub(Zr.from(e,t),o),h=Zr.sub(l,o),d=Zr.rotate(c,Zr.angle(c,h),o);return(u=i.containsPoint(d.x,d.y))!=null?u:!1}render(e){this.applyClipMask(e.ctx),super.render(e),this.closeClipMask(e.ctx)}setClipMask(e,t){const i=this.clipMask.get(e);R.jsonDiff(i,t)!=null&&this.markDirty("CollidableLine"),t?this.clipMask.set(e,t):this.clipMask.delete(e)}applyClipMask(e){const{clipMask:t}=this;t.size!==0&&this.clipMask.forEach(i=>{const{x:s,y:n,radius:a}=i;e.save(),e.beginPath(),e.rect(0,0,e.canvas.width,e.canvas.height),e.ellipse(s,n,a,a,0,Math.PI*2,0,!0),e.clip()})}closeClipMask(e){this.clipMask.size!==0&&e.restore()}},ed=class extends R.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(e,t){const i=this.fromParentPoint(e,t),s=this.computeBBoxWithoutTransforms();return s?s.grow(this.growCollisionBox).containsPoint(i.x,i.y):!1}},{Vec2:Js}=R;function tp(e,t,i,s,n,a,r){if(!a||!n||!s){t.setClipMask(e);return}const{alignment:o,position:l}=s,c=ZB(i,s.fontSize,r),{point:h,textBaseline:d}=qB(c,l,o);QB(n,a,s,h,c.angle,d);const{x:u,y:p,width:g,height:f}=n.getBBox(),y=Js.length(Js.from(g,f)),v={x:u+g/2,y:p+f/2,radius:y/2+Js.length(c.offset)};return l==="center"?t.setClipMask(e,v):t.setClipMask(e),{clipMask:v,numbers:c}}function XB(e,t,i,s,n,a,r){if(!r||!a)return;const{alignment:o,position:l}=s,[c,h]=t.y1<=i.y1?[t,i]:[i,t];let d=c;l==="bottom"?d=h:l==="inside"&&(d={x1:(c.x1+h.x1)/2,y1:(c.y1+h.y1)/2,x2:(c.x2+h.x2)/2,y2:(c.y2+h.y2)/2});const u=ZB(d,s.fontSize,n),{point:p,textBaseline:g}=qB(u,l==="inside"?"center":l,o,e);QB(a,r,s,p,u.angle,g)}function ZB(e,t,i){let[s,n]=Js.from(e);s.x>n.x&&([s,n]=[n,s]);const a=Js.normalized(Js.sub(n,s)),r=Js.angle(a),o=Js.multiply(a,gi.HANDLE_SIZE/2+(t!=null?t:14)/2),l=Js.multiply(a,(i!=null?i:2)/2+(t!=null?t:14)/3);return{left:s,right:n,normal:a,angle:r,inset:o,offset:l}}function qB({left:e,right:t,normal:i,angle:s,inset:n,offset:a},r,o,l){let c;o==="right"?c=Js.sub(t,n):o==="center"?c=Js.add(e,Js.multiply(i,Js.distance(e,t)/2)):c=Js.add(e,n);let h="bottom";return r==="bottom"?(c=Js.rotate(a,s+Math.PI/2,c),h="top"):r==="center"&&!l?h="middle":c=Js.rotate(a,s-Math.PI/2,c),{point:c,textBaseline:h}}function QB(e,t,i,s,n,a){e.setProperties({text:t,x:s.x,y:s.y,rotation:n,rotationCenterX:s.x,rotationCenterY:s.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:a})}var{ChartAxisDirection:mde,Vec2:td,Vec4:PA}=R,fc=class extends fs{constructor(){super(),this.type="cross-line",this.line=new On,this.middle=new ep,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(e){return fs.isCheck(e,"cross-line")}update(e,t){var a;const{seriesRect:i}=t;this.seriesRect=i,this.isHorizontal=Qs.is(e);const s=this.isHorizontal?t.yAxis:t.xAxis,n=this.convertCrossLine(e,s);if(n==null){this.visible=!1;return}this.visible=(a=e.visible)!=null?a:!0,this.visible&&(this.updateLine(e,n),this.updateHandle(e,n),this.updateText(e,n),this.updateAxisLabel(e,s,n))}updateLine(e,t){const{line:i}=this,{lineDashOffset:s,stroke:n,strokeWidth:a,strokeOpacity:r}=e,{x1:o,y1:l,x2:c,y2:h}=t;i.setProperties({x1:o,y1:l,x2:c,y2:h,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:s,stroke:n,strokeWidth:a,strokeOpacity:r,fillOpacity:0})}updateHandle(e,t){var c,h,d;const{middle:i}=this,{locked:s,stroke:n,strokeWidth:a,strokeOpacity:r}=e,o={fill:e.handle.fill,stroke:(c=e.handle.stroke)!=null?c:n,strokeOpacity:(h=e.handle.strokeOpacity)!=null?h:r,strokeWidth:(d=e.handle.strokeWidth)!=null?d:a},l=td.sub(PA.center(t),td.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update(b(b({},o),l)),i.toggleLocked(s!=null?s:!1)}updateText(e,t){this.text=this.updateNode(ed,this.text,!!e.text.label),tp(this.line.id,this.line,t,e.text,this.text,e.text.label,e.strokeWidth)}createAxisLabel(e){const t=new YB;return e.attachLabel(t),t}updateAxisLabel(e,t,i){this.axisLabel||(this.axisLabel=this.createAxisLabel(t));const{axisLabel:s,seriesRect:n}=this,{direction:a,position:r}=t;if(e.axisLabel.enabled){s.visible=this.visible;const o=r==="left"||r==="top"?PA.start(i):PA.end(i),l=a===mde.X?o.x:o.y;if(!t.inRange(l)){s.visible=!1;return}const c=Yi(e.value);s.update(E(b({},td.add(o,td.required(n))),{value:c,styles:e.axisLabel,context:t}))}else s.visible=!1}setAxisLabelOpacity(e){this.axisLabel&&(this.axisLabel.opacity=e)}setAxisLabelVisible(e){this.axisLabel&&(this.axisLabel.visible=e)}toggleHandles(e){this.middle.visible=e,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){var e;super.destroy(),(e=this.axisLabel)==null||e.destroy()}toggleActive(e){this.toggleHandles(e),this.middle.toggleActive(e)}dragStart(e,t,i){const s=Qs.is(e)?{x:t.x,y:$o(e.value,i.yAxis)}:{x:$o(e.value,i.xAxis),y:t.y};this.dragState={offset:t,middle:s}}drag(e,t,i){const{activeHandle:s,dragState:n}=this;e.locked||!n||(s&&this[s].toggleDragging(!0),this.translatePoint(e,n.middle,td.sub(t,n.offset),i))}translate(e,t,i){if(e.locked)return;const s=Qs.is(e)?td.from(0,$o(e.value,i.yAxis)):td.from($o(e.value,i.xAxis),0);this.translatePoint(e,s,t,i)}translatePoint(e,t,i,s){const n=Qs.is(e);n?i.x=0:i.y=0;const{point:a}=tl({point:t},i,s);e.value=n?a.y:a.x}stopDragging(){this.middle.toggleDragging(!1)}copy(e,t,i){const s=Qs.is(e),n=this.isHorizontal?i.yAxis:i.xAxis,a=this.convertCrossLine(e,n);if(!a)return;const r=s?-30:0,o=s?0:-30,l=vn({x:a.x1+o,y:a.y1+r},i);return t.set({value:s?l.y:l.x}),t}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(e,t){const{middle:i,line:s,text:n}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="middle",!0):s.isPointInPath(e,t)||!!(n!=null&&n.containsPoint(e,t))}getNodeAtCoords(e,t){var i;if((i=this.text)!=null&&i.containsPoint(e,t))return"text";if(this.line.isPointInPath(e,t))return"line";if(this.middle.containsPoint(e,t))return"handle"}getAnchor(){const e=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:e.x+e.width/2,y:e.y}:{x:e.x+e.width,y:e.y+e.height/2,position:"right"}}convertCrossLine(e,t){if(e.value==null)return;let i=0,s=0,n,a;const{bounds:r}=t,o=$o(e.value,t);return Qs.is(e)?(n=r.width,s=o,a=o):(i=o,n=o,a=r.height),{x1:i,y1:s,x2:n,y2:a}}},{StateMachine:jb,StateMachineProperty:yde,Debug:vde}=R,EA=class extends jb{constructor(e,t){const i=({point:n})=>{const a=e==="horizontal",r=a?new Qs:new $r;r.set({value:a?n.y:n.x}),t.create(r),t.recordAction(`Create ${a?"horizontal-line":"vertical-line"} annotation`)},s=()=>{var n;(n=this.node)==null||n.toggleActive(!0),t.showAnnotationOptions(),t.update()};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:jb.parent,cancel:jb.parent},"waiting-first-render":{render:{target:jb.parent,action:s}}}),this.debug=vde.create(!0,"annotations")}};C([yde()],EA.prototype,"node",2);var JB={type:"horizontal-line",datum:Qs,scene:fc,isDatum:Qs.is,translate:(e,t,i,s)=>{Qs.is(t)&&fc.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Qs.is(t)&&Qs.is(i)&&fc.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Qs.is(t)&&fc.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new EA("horizontal",E(b({},e),{create:t("horizontal-line")})),dragState:e=>new Ei(e)},e_={type:"vertical-line",datum:$r,scene:fc,isDatum:$r.is,translate:(e,t,i,s)=>{$r.is(t)&&fc.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if($r.is(t)&&$r.is(i)&&fc.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{$r.is(t)&&fc.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new EA("vertical",E(b({},e),{create:t("vertical-line")})),dragState:e=>new Ei(e)},{Vec4:bde}=R,t_=class{static updateBackground(e,t,i,s){var c,h;const{background:n}=this,{seriesRect:a}=s;n.path.clear(!0);const r=bde.from(0,0,a.width,a.height),o=this.getBackgroundPoints(e,t,i,r);for(let d=0;d<o.length;d++){const u=o[d];d===0?n.path.moveTo(u.x,u.y):n.path.lineTo(u.x,u.y)}n.path.closePath(),n.checkPathDirty();const l=(h=(c=this.getBackgroundStyles)==null?void 0:c.call(this,e))!=null?h:e.background;n.setProperties({fill:l.fill,fillOpacity:l.fillOpacity})}},i_=class extends VB{constructor(){super(...arguments),this.handles={},this.overflowContinuous=2,this.topLine=new On,this.bottomLine=new On,this.background=new R.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=t_.updateBackground.bind(this)}update(e,t){const{locked:i,visible:s}=e,n=yn(e,t),a=yn(e.bottom,t);if(n==null||a==null){this.visible=!1;return}else this.visible=s!=null?s:!0;const r=this.extendLine(n,e,t),o=this.extendLine(a,e,t);this.updateLines(e,r,o,t,n,a),this.updateHandles(e,n,a),this.updateText(e,n,a),this.updateBackground(e,r,o,t),this.updateAnchor(n,a);for(const l of Object.values(this.handles))l.toggleLocked(i!=null?i:!1)}toggleHandles(e){const{handles:t}=this;if(typeof e=="boolean"){for(const[i,s]of Object.entries(t))s.visible=e,s.toggleHovered(this.activeHandle===i);return}for(const[i,s]of Object.entries(e)){const n=t[i];n.visible=s!=null?s:!0,n.toggleHovered(this.activeHandle===i)}}toggleActive(e){this.toggleHandles(e);for(const t of Object.values(this.handles))t.toggleActive(e)}stopDragging(){const{activeHandle:e,handles:t}=this;e!=null&&t[e].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(e,t){const{handles:i,topLine:s,bottomLine:n,text:a}=this;this.activeHandle=void 0;for(const[r,o]of Object.entries(i))if(o.containsPoint(e,t))return this.activeHandle=r,!0;return s.containsPoint(e,t)||n.containsPoint(e,t)||!!(a!=null&&a.containsPoint(e,t))}getNodeAtCoords(e,t){var i;if((i=this.text)!=null&&i.containsPoint(e,t))return"text";if(this.topLine.containsPoint(e,t)||this.bottomLine.containsPoint(e,t))return"line";for(const[s,n]of Object.entries(this.handles))if(n.containsPoint(e,t))return"handle"}updateAnchor(e,t){const{x:i,y:s}=R.Transformable.toCanvasPoint(this.topLine,(e.x1+e.x2)/2,Math.min(e.y1,e.y2,t.y1,t.y2));this.anchor.x=i,this.anchor.y=s}},{Vec2:Fa,Vec4:mc}=R,Hb=class extends i_{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new gi,topRight:new gi,bottomLeft:new gi,bottomRight:new ep},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(e){return fs.isCheck(e,"disjoint-channel")}dragHandle(e,t,i,s){const{activeHandle:n,handles:a}=this;if(n==null)return;const{offset:r}=a[n].drag(t);a[n].toggleDragging(!0),n==="bottomRight"&&(r.x=0);let o=[],l=[],c=s;switch(n){case"topLeft":o=["topLeft"],l=["bottomLeft"];break;case"bottomLeft":o=["bottomLeft"],l=["topLeft"];break;case"topRight":o=["topRight"],l=["bottomRight"];break;case"bottomRight":o=["bottomLeft","bottomRight"],c=!1;break}const h=yn(e,i),d=yn(e.bottom,i);if(!h||!d)return;const u={topLeft:mc.start(h),topRight:mc.end(h),bottomLeft:mc.start(d),bottomRight:mc.end(d)},p={vectors:{topLeft:u.topRight,bottomLeft:u.bottomRight,topRight:u.topLeft,bottomRight:u.bottomLeft},angle:e.snapToAngle},g=tl(u,r,i,{overflowContinuous:this.overflowContinuous,translateVectors:o,invertYVectors:l,snap:c?p:void 0});e.start.x=g.topLeft.x,e.start.y=g.topLeft.y,e.end.x=g.topRight.x,e.end.y=g.topRight.y,e.startHeight=g.topLeft.y-g.bottomLeft.y,e.endHeight=g.topRight.y-g.bottomRight.y}getTranslatePointsVectors(e,t){const{bottomLeft:i,bottomRight:s,topLeft:n,topRight:a}=this.handles,r=i.getBBox().y-n.getBBox().y,o=s.getBBox().y-a.getBBox().y,l=Fa.add(e,Fa.from(0,r)),c=Fa.add(t,Fa.from(0,o));return{start:e,end:t,bottomStart:l,bottomEnd:c}}updateLines(e,t,i){const{topLine:s,bottomLine:n}=this,{lineDashOffset:a,stroke:r,strokeOpacity:o,strokeWidth:l}=e,c={lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:a,stroke:r,strokeOpacity:o,strokeWidth:l};s.setProperties(b(b({},t),c)),n.setProperties(b(b({},i),c))}updateHandles(e,t,i){var l,c,h;const{handles:{topLeft:s,topRight:n,bottomLeft:a,bottomRight:r}}=this,o={fill:e.handle.fill,stroke:(l=e.handle.stroke)!=null?l:e.stroke,strokeOpacity:(c=e.handle.strokeOpacity)!=null?c:e.strokeOpacity,strokeWidth:(h=e.handle.strokeWidth)!=null?h:e.strokeWidth};s.update(b(b({},o),mc.start(t))),n.update(b(b({},o),mc.end(t))),a.update(b(b({},o),mc.start(i))),r.update(b(b({},o),Fa.sub(mc.end(i),Fa.from(r.handle.width/2,r.handle.height/2))))}updateText(e,t,i){this.text=this.updateNode(ed,this.text,!!e.text.label),XB(!1,t,i,e.text,e.strokeWidth,this.text,e.text.label)}getBackgroundPoints(e,t,i,s){const n=t.x1>t.x2,a=t.y1>t.y2,r=a?s.y2:s.y1,o=a?s.y1:s.y2,l=Fa.from(t);return e.extendEnd&&t.y2===o&&l.push(Fa.from(n?s.x1:s.x2,a?s.y1:s.y2)),e.extendEnd&&i.y2===r&&l.push(Fa.from(n?s.x1:s.x2,a?s.y2:s.y1)),l.push(...Fa.from(i).reverse()),e.extendStart&&i.y1===o&&l.push(Fa.from(n?s.x2:s.x1,a?s.y1:s.y2)),e.extendStart&&t.y1===r&&l.push(Fa.from(n?s.x2:s.x1,a?s.y2:s.y1)),l}},{StateMachine:yc,StateMachineProperty:RA,Debug:xde}=R,Wb=class extends yc{constructor(e){const t=({point:l})=>{const c=new Ea;c.set({start:l,end:l,startHeight:0,endHeight:0}),e.create(c)},i=()=>{const{node:l}=this;l==null||l.toggleActive(!0),l==null||l.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1})},s=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:jf(l,c,d,h.start,h.snapToAngle)}),e.update())},n=()=>{var l;(l=this.node)==null||l.toggleHandles({topRight:!0}),e.update()},a=({point:l})=>{const{datum:c,node:h}=this,d=Yi(c==null?void 0:c.end.y),u=Yi(c==null?void 0:c.start.y),{y:p}=l;if(c==null||!ki(u)||!ki(d)||!ki(p))return;const g=d-(p!=null?p:0),f=(u-d)*2+g,y={x:c==null?void 0:c.start.x,y:u-f},v={x:c==null?void 0:c.end.x,y:l.y};h==null||h.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!e.validatePoint(y,{overflowContinuous:!0})||!e.validatePoint(v,{overflowContinuous:!0}))&&(c.set({startHeight:f,endHeight:g}),e.update())},r=({point:l})=>{const{datum:c,node:h}=this,d=Yi(c==null?void 0:c.end.y),u=Yi(c==null?void 0:c.start.y),{y:p}=l;if(c==null||!ki(u)||!ki(d)||!ki(p))return;const g=d-(p!=null?p:0),f=(u-d)*2+g,y={x:c.start.x,y:u-g},v={x:c.end.x,y:l.y};h==null||h.toggleHandles(!0),!(!e.validatePoint(y,{overflowContinuous:!0})||!e.validatePoint(v,{overflowContinuous:!0}))&&(c.set({startHeight:f,endHeight:g}),e.recordAction("Create disjoint-channel annotation"),e.showAnnotationOptions(),e.update())},o=()=>e.delete();super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:yc.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,drag:s,click:{target:"height",action:n},dragEnd:{target:"height",action:n},reset:{target:yc.parent,action:o},cancel:{target:yc.parent,action:o}},height:{hover:a,click:{target:yc.parent,action:r},drag:{target:yc.parent,action:r},reset:{target:yc.parent,action:o},cancel:{target:yc.parent,action:o}}}),this.debug=xde.create(!0,"annotations"),this.snapping=!1}};C([RA()],Wb.prototype,"datum",2),C([RA()],Wb.prototype,"node",2),C([RA()],Wb.prototype,"snapping",2);var s_={type:"disjoint-channel",datum:Ea,scene:Hb,isDatum:Ea.is,translate:(e,t,i,s)=>{Ea.is(t)&&Hb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Ea.is(t)&&Ea.is(i)&&Hb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Ea.is(t)&&Hb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Wb(E(b({},e),{create:t("disjoint-channel")})),dragState:e=>new Ei(e)},NA=[0,23.6,38.2,50,61.8,78.6,100],Cde=[161.8,261.8,361.8,423.6],Sde=[...NA,...Cde],Mde={10:Sde,6:NA,4:NA.filter(e=>e!==78.6&&e!==23.6)},Dde=10;function wde(e,t){const{x2:i,y1:s,y2:n}=e,a=s-n;return t==null?{x1:i,x2:i,y1:n-a,y2:n}:{x1:t.x1,x2:t.x2,y1:t.y2-a,y2:t.y2}}function n_({x1:e,y1:t,x2:i,y2:s},n,a,r,o=10){const l=t-s,c=a?-1:1;let h=r;const d=[];return Mde[o].forEach((u,p)=>{const g=r+l*(u/100)*c,f=n.yAxis.scaleInvert(g);d.push({id:p,x1:e,x2:i,y1:h,y2:g,tag:u==100?0:1,label:{x1:Math.min(e,i)-Dde,x2:i,y1:g,y2:g,text:`${(u/100).toFixed(3)} (${f.toFixed(2)})`}}),h=g}),d}var{Vec2:Ade,Vec4:a_}=R,r_=class extends fs{constructor(){super(),this.trendLine=new On,this.rangeFillsGroup=new R.Group({name:`${this.id}-range-fills`}),this.rangeFillsGroupSelection=R.Selection.select(this.rangeFillsGroup,R.Range),this.rangeStrokesGroup=new R.Group({name:`${this.id}-range-strokes`}),this.rangeStrokesGroupSelection=R.Selection.select(this.rangeStrokesGroup,On),this.labelsGroup=new R.Group({name:`${this.id}-ranges-labels`}),this.labelsGroupSelection=R.Selection.select(this.labelsGroup,ed),this.anchor={x:0,y:0,position:"above"},this.append([this.trendLine,this.rangeFillsGroup,this.rangeStrokesGroup,this.labelsGroup])}update(e,t){var c;let i=yn(e,t);if(i==null){this.visible=!1;return}if(i=a_.round(i),this.visible=(c=e.visible)!=null?c:!0,!this.visible)return;this.updateLine(e,i,this.trendLine),this.updateHandles(e,i),this.updateAnchor(e,i,t);const{reverse:s}=e,n=this.extendLine(i,e,t),a=s?n.y1:n.y2,r=s?n.y2:n.y1,o=n_(n,t,e.reverse,a,e.bands);this.updateRanges(e,o,t);const l=E(b({},n),{y1:r,y2:r});this.updateText(e,l)}extendLine({x1:e,y1:t,x2:i,y2:s},n,a){const r={x1:e,y1:t,x2:i,y2:s};if(!n.extendStart&&!n.extendEnd)return r;const{x:o,width:l}=a.xAxis.bounds;return n.extendEnd&&(r[e>i?"x1":"x2"]=o+l),n.extendStart&&(r[e>i?"x2":"x1"]=o),r}updateLine(e,t,i){if(!t||!i)return;const{lineDashOffset:s,strokeWidth:n,strokeOpacity:a,stroke:r}=e;i.setProperties(E(b({},t),{lineCap:e.getLineCap(),lineDash:[3,4],lineDashOffset:s,strokeWidth:n,strokeOpacity:a,fillOpacity:0,stroke:r}))}updateRangeStrokes(e){const{lineDashOffset:t,strokeWidth:i,strokeOpacity:s,strokes:n,rangeStroke:a,isMultiColor:r}=e;this.rangeStrokesGroupSelection.each((o,{x1:l,x2:c,y2:h,tag:d},u)=>{const p=h,g=r?n[u%n.length]:a;o.setProperties({x1:l,x2:c,y1:p,y2:p,stroke:g,strokeOpacity:s,strokeWidth:i,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,tag:d})})}updateRanges(e,t,i){const s=n=>n.id;this.rangeFillsGroupSelection.update(t,void 0,s),this.rangeStrokesGroupSelection.update(t,void 0,s),this.labelsGroupSelection.update(t,void 0,s),this.updateRangeFills(e),this.updateRangeStrokes(e),this.updateRangeLabels(e,i)}updateRangeFills(e){const{lineDashOffset:t,strokeWidth:i,strokeOpacity:s,strokes:n,rangeStroke:a,showFill:r,isMultiColor:o}=e;this.rangeFillsGroupSelection.each((l,{x1:c,x2:h,y1:d,y2:u},p)=>{const g=o?n[p%n.length]:a;if(!r){l.visible=!1;return}l.setProperties({x1:c,x2:h,y1:d,y2:u,startLine:!1,endLine:!1,stroke:g,strokeOpacity:s,fill:g,fillOpacity:(s!=null?s:1)*.15,strokeWidth:i,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,visible:!0})})}updateRangeLabels(e,{xAxis:t}){const{rangeStrokesGroupSelection:i}=this,{strokes:s,strokeWidth:n,rangeStroke:a,isMultiColor:r,label:{fontFamily:o,fontSize:l,fontStyle:c,fontWeight:h,color:d}}=e,u={fontFamily:o,fontSize:l,fontStyle:c,fontWeight:h},p=this.checkWithinBounds(t,u,this.labelsGroupSelection.at(0));this.labelsGroupSelection.each((g,f,y)=>{const v=d!=null?d:r?s[y%s.length]:a,x=i.at(y);if(!x)return;const D=f.label,{text:S}=D,M=We(D,["text"]);if(p)g.setProperties(E(b({},u),{text:S,x:M.x1,y:M.y1,textBaseline:"middle",textAlign:"end",fill:v})),tp(g.id,x,M);else{const A=E(b({},u),{label:S,position:"center",alignment:"left",color:v});tp(g.id,x,M,A,g,S,n)}})}checkWithinBounds(e,t,i){if(!i)return!1;const r=i.datum.label,{text:s}=r,n=We(r,["text"]);i.setProperties(E(b({},t),{text:s,x:n.x1,y:n.y1,textBaseline:"middle",textAlign:"end"}));const{x:a}=i.getBBox();return a>=e.bounds.x&&a<=e.bounds.x+e.bounds.width}updateText(e,t){const i=this.rangeStrokesGroupSelection.selectByTag(0)[0];if(!i)return;const{text:s,strokeWidth:n}=e;this.text=this.updateNode(ed,this.text,!!s.label),tp(i.id,i,t,s,this.text,s.label,n)}updateAnchor(e,t,i,s){const n=a_.topCenter(t);Ade.apply(this.anchor,R.Transformable.toCanvasPoint(this.trendLine,n.x,n.y))}containsPoint(e,t){const{trendLine:i,rangeStrokesGroupSelection:s,text:n}=this;let a=!1;return s.each(r=>a||(a=r.isPointInPath(e,t))),a||i.isPointInPath(e,t)||!!(n!=null&&n.containsPoint(e,t))}getNodeAtCoords(e,t){var i;if((i=this.text)!=null&&i.containsPoint(e,t))return"text";if(this.trendLine.isPointInPath(e,t))return"line"}getHandleStyles(e){var t,i,s;return{fill:e.handle.fill,stroke:(t=e.handle.stroke)!=null?t:e.stroke,strokeOpacity:(i=e.handle.strokeOpacity)!=null?i:e.strokeOpacity,strokeWidth:(s=e.handle.strokeWidth)!=null?s:e.strokeWidth}}drag(e,t,i,s){e.locked||(this.activeHandle?this.dragHandle(e,t,i,s):this.dragAll(e,t,i))}getAnchor(){return this.anchor}getCursor(){return"pointer"}},{ContinuousScale:o_}=R;function Ub(e,t,i={overflowContinuous:!1},s){if(t.x==null||t.y==null)return s&&se.warnOnce(`${s}requires both an [x] and [y] property, ignoring.`),!1;const{xAxis:n,yAxis:a}=e,r=i.overflowContinuous&&o_.is(n.scale),o=i.overflowContinuous&&o_.is(a.scale),l=r||l_(t.x,n),c=o||l_(t.y,a);if(l&&c)return!0;if(s){let h="x & y domains";l&&(h="y domain"),c&&(h="x domain");const d=Yi(t.x),u=Yi(t.y);se.warnOnce(`${s}is outside the ${h}, ignoring. - x: [${d}], y: ${u}]`)}return!1}function l_(e,t){const{domain:i}=t.scale,s=Yi(e);return i&&s!=null&&t.continuous?s>=i[0]&&s<=i.at(-1):!0}var{Vec2:Ide,Vec4:id}=R,Kb=class extends r_{constructor(){super(),this.type="fibonacci-retracement-trend-based",this.endRetracementLine=new On,this.start=new gi,this.end=new gi,this.endRetracement=new gi,this.append([this.endRetracementLine,this.start,this.end,this.endRetracement])}static is(e){return fs.isCheck(e,"fibonacci-retracement-trend-based")}update(e,t){var u;let{coords1:i,coords2:s}=this.getCoords(e,t);if(i==null||s==null){this.visible=!1;return}if(i=id.round(i),s=id.round(s),this.visible=(u=e.visible)!=null?u:!0,!this.visible)return;(e.endRetracement.x==null||e.endRetracement.y==null)&&(s=void 0),this.updateLine(e,i,this.trendLine),this.updateLine(e,s,this.endRetracementLine),this.updateHandles(e,i,s),this.updateAnchor(e,s!=null?s:i,t);const{reverse:n,bands:a}=e,r=wde(i,s),o=this.extendLine(r,e,t),l=o.y2,c=o.y1,h=s?n_(o,t,n,l,a):[];this.updateRanges(e,h,t);const d=E(b({},o),{y1:c,y2:c});this.updateText(e,d)}containsPoint(e,t){const{start:i,end:s,endRetracement:n,endRetracementLine:a}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):n.containsPoint(e,t)?(this.activeHandle="endRetracement",!0):a.isPointInPath(e,t)||super.containsPoint(e,t)}getNodeAtCoords(e,t){return this.start.containsPoint(e,t)||this.end.containsPoint(e,t)||this.endRetracement.containsPoint(e,t)?"handle":this.endRetracementLine.isPointInPath(e,t)?"line":super.getNodeAtCoords(e,t)}dragStart(e,t,i){this.dragState=b({offset:t},Fb({start:e.start,end:e.end,endRetracement:e.endRetracement},i))}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1),this.endRetracement.toggleDragging(!1)}dragAll(e,t,i){const{dragState:s}=this;s&&this.translatePoints({datum:e,start:s.start,end:s.end,endRetracement:s.endRetracement,translation:Ide.sub(t,s.offset),context:i})}dragHandle(e,t,i,s){const{activeHandle:n,dragState:a}=this;if(!n||!a)return;this[n].toggleDragging(!0);const r=s?this.snapToAngle(e,t,i):vn(this[n].drag(t).point,i);!r||!Ub(i,r)||(e[n].x=r.x,e[n].y=r.y)}snapToAngle(e,t,i){const{activeHandle:s}=this,n=["start","end","endRetracement"];if(!s)return;const a=(n.indexOf(s)+1)%n.length,r=n[a];this[s].toggleDragging(!0);const o=pi(e[r],i);return vn(Ob(t,o,e.snapToAngle),i)}translatePoints({datum:e,start:t,end:i,endRetracement:s,translation:n,context:a}){const r=tl({start:t,end:i,endRetracement:s},n,a,{overflowContinuous:2});e.start.x=r.start.x,e.end.x=r.end.x,e.endRetracement.x=r.endRetracement.x,e.start.y=r.start.y,e.end.y=r.end.y,e.endRetracement.y=r.endRetracement.y}translate(e,t,i){this.translatePoints({datum:e,start:pi(e.start,i),end:pi(e.end,i),endRetracement:pi(e.endRetracement,i),translation:t,context:i})}copy(e,t,i){const{coords1:s,coords2:n}=this.getCoords(e,i);if(!s||!n)return;const a=this.computeBBoxWithoutHandles();return this.translatePoints({datum:t,start:id.start(s),end:id.end(s),endRetracement:id.end(n),translation:{x:-a.width/2,y:-a.height/2},context:i}),t}getCoords(e,t){return{coords1:yn(e,t),coords2:yn({start:e.end,end:e.endRetracement},t)}}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e,this.endRetracement.visible=e;else for(const[t,i]of Zt(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end"),this.endRetracement.toggleHovered(this.activeHandle==="endRetracement")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e),this.endRetracement.toggleActive(e)}updateHandles(e,t,i,s){var n,a,r;this.start.update(b(b({},this.getHandleStyles(e)),this.getHandleCoords(e,t,"start"))),this.end.update(b(b({},this.getHandleStyles(e)),this.getHandleCoords(e,t,"end",s))),i&&this.endRetracement.update(b(b({},this.getHandleStyles(e)),this.getHandleCoords(e,i,"endRetracement",s))),this.start.toggleLocked((n=e.locked)!=null?n:!1),this.end.toggleLocked((a=e.locked)!=null?a:!1),this.endRetracement.toggleLocked((r=e.locked)!=null?r:!1)}getHandleCoords(e,t,i,s){return i==="start"?id.start(t):id.end(t)}},{StateMachine:vc,StateMachineProperty:OA,Debug:Tde}=R,$b=class extends vc{constructor(e){const t=({point:c})=>{const h=this.createDatum();h.set({start:c,end:c}),e.create(h)},i=()=>{const{node:c}=this;c==null||c.toggleActive(!0),c==null||c.toggleHandles({start:!0,end:!1,endRetracement:!1})},s=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({end:jf(c,h,u,d.start,d.snapToAngle)}),e.update())},n=()=>{var h;const{datum:c}=this;c&&(c.endRetracement.x=c.end.x,c.endRetracement.y=c.end.y,(h=this.node)==null||h.toggleHandles({end:!0}),e.update())},a=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({endRetracement:jf(c,h,u,d.end,d.snapToAngle)}),e.update())},r=()=>{var c;(c=this.node)==null||c.toggleHandles({endRetracement:!0}),e.update()},o=()=>e.delete(),l=()=>{var c;e.showAnnotationOptions(),e.recordAction(`Create ${(c=this.datum)==null?void 0:c.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:vc.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,click:{target:"endRetracement",action:n},drag:s,dragEnd:{target:"endRetracement",action:n},reset:{target:vc.parent,action:o},cancel:{target:vc.parent,action:o},onExit:l},endRetracement:{hover:a,click:{target:vc.parent,action:r},drag:{target:vc.parent,action:r},reset:{target:vc.parent,action:o},cancel:{target:vc.parent,action:o}}}),this.debug=Tde.create(!0,"annotations"),this.snapping=!1}createDatum(){return new Yr}};C([OA()],$b.prototype,"datum",2),C([OA()],$b.prototype,"node",2),C([OA()],$b.prototype,"snapping",2);var c_={type:"fibonacci-retracement-trend-based",datum:Yr,scene:Kb,isDatum:Yr.is,translate:(e,t,i,s)=>{Yr.is(t)&&Kb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Yr.is(t)&&Yr.is(i)&&Kb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Yr.is(t)&&Kb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new $b(E(b({},e),{create:t("fibonacci-retracement-trend-based")})),dragState:e=>new Ei(e)},{Vec2:kde,Vec4:h_}=R,Yb=class extends r_{constructor(){super(),this.type="fibonacci-retracement",this.start=new gi,this.end=new gi,this.append([this.start,this.end])}static is(e){return fs.isCheck(e,"fibonacci-retracement")}containsPoint(e,t){const{start:i,end:s}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):super.containsPoint(e,t)}getNodeAtCoords(e,t){return this.start.containsPoint(e,t)||this.end.containsPoint(e,t)?"handle":super.getNodeAtCoords(e,t)}dragStart(e,t,i){this.dragState=b({offset:t},Fb({start:e.start,end:e.end},i))}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}dragAll(e,t,i){const{dragState:s}=this;s&&this.translatePoints({datum:e,start:s.start,end:s.end,translation:kde.sub(t,s.offset),context:i})}dragHandle(e,t,i,s){const{activeHandle:n,dragState:a}=this;if(!n||!a)return;this[n].toggleDragging(!0);const r=s?this.snapToAngle(e,t,i):vn(this[n].drag(t).point,i);!r||!Ub(i,r)||(e[n].x=r.x,e[n].y=r.y)}snapToAngle(e,t,i){const{activeHandle:s}=this,a=["start","end"].find(o=>o!==s);if(!s||!a)return;this[s].toggleDragging(!0);const r=pi(e[a],i);return vn(Ob(t,r,e.snapToAngle),i)}translatePoints({datum:e,start:t,end:i,translation:s,context:n}){const a=tl({start:t,end:i},s,n,{overflowContinuous:1});e.start.x=a.start.x,e.end.x=a.end.x,e.start.y=a.start.y,e.end.y=a.end.y}translate(e,t,i){this.translatePoints({datum:e,start:pi(e.start,i),end:pi(e.end,i),translation:t,context:i})}copy(e,t,i){const s=yn(e,i);if(!s)return;const n=this.computeBBoxWithoutHandles();return this.translatePoints({datum:t,start:{x:s.x1,y:s.y1},end:{x:s.x2,y:s.y2},translation:{x:-n.width/2,y:-n.height/2},context:i}),t}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e;else for(const[t,i]of Zt(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}updateHandles(e,t,i,s){var n,a;this.start.update(b(b({},this.getHandleStyles(e)),this.getHandleCoords(e,t,"start"))),this.end.update(b(b({},this.getHandleStyles(e)),this.getHandleCoords(e,t,"end",s))),this.start.toggleLocked((n=e.locked)!=null?n:!1),this.end.toggleLocked((a=e.locked)!=null?a:!1)}getHandleCoords(e,t,i,s){return i==="start"?h_.start(t):h_.end(t)}},{StateMachine:ip,StateMachineProperty:FA,Debug:Lde}=R,sp=class extends ip{constructor(e){const t=({point:o})=>{const l=this.createDatum();l.set({start:o,end:o}),e.create(l)},i=()=>{const{node:o}=this;o==null||o.toggleActive(!0),o==null||o.toggleHandles({start:!0,end:!1})},s=({offset:o,context:l})=>{const{datum:c,snapping:h}=this;c&&(c.set({end:jf(o,l,h,c.start,c.snapToAngle)}),e.update())},n=()=>{var o;(o=this.node)==null||o.toggleHandles({end:!0}),e.update()},a=()=>e.delete(),r=()=>{var o;e.showAnnotationOptions(),e.recordAction(`Create ${(o=this.datum)==null?void 0:o.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:ip.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,click:{target:ip.parent,action:n},drag:s,dragEnd:{target:ip.parent,action:n},reset:{target:ip.parent,action:a},cancel:{target:ip.parent,action:a},onExit:r}}),this.debug=Lde.create(!0,"annotations"),this.snapping=!1}};C([FA()],sp.prototype,"datum",2),C([FA()],sp.prototype,"node",2),C([FA()],sp.prototype,"snapping",2);var Pde=class extends sp{createDatum(){return new Xo}},Ede=class extends sp{createDatum(){return new Zo}},Rde=class extends sp{createDatum(){return new Qo}},d_={type:"fibonacci-retracement",datum:Qo,scene:Yb,isDatum:Qo.is,translate:(e,t,i,s)=>{Qo.is(t)&&Yb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Qo.is(t)&&Qo.is(i)&&Yb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Qo.is(t)&&Yb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Rde(E(b({},e),{create:t("fibonacci-retracement")})),dragState:e=>new Ei(e)},{Vec2:Wf}=R,Nde=class extends R.Group{},Xb=class extends Nde{constructor(){super(),this.type="arrow",this.path=new R.Path,this.armLength=6,this.append([this.path])}update(e){var u;const{path:t}=this,d=e,{x:i,y:s,angle:n}=d,a=We(d,["x","y","angle"]),r=Wf.from(i,s),o=3*Math.PI/4,l=this.armLength+((u=e.strokeWidth)!=null?u:0)*2,c=Wf.rotate(Wf.from(0,l),n+o,r),h=Wf.rotate(Wf.from(l,0),n-o,r);t.setProperties(a),t.fillOpacity=0,t.path.clear(),t.path.moveTo(c.x,c.y),t.path.lineTo(r.x,r.y),t.path.lineTo(h.x,h.y)}},{Vec2:dr,Vec4:u_}=R,bc=class extends wA{constructor(){super(),this.type="line",this.line=new On,this.append([this.line,this.start,this.end])}static is(e){return fs.isCheck(e,"line")}update(e,t){var s;let i=yn(e,t);if(i==null){this.visible=!1;return}i=u_.round(i),this.visible=(s=e.visible)!=null?s:!0,this.visible&&(this.updateLine(e,i,t),this.updateHandles(e,i),this.updateText(e,i),this.updateCaps(e,i),this.updateAnchor(e,i,t))}updateLine(e,t,i){const{line:s}=this,{lineDashOffset:n,stroke:a,strokeWidth:r,strokeOpacity:o}=e,l=this.extendLine(t,e,i);s.setProperties(E(b({},l),{lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:n,stroke:a,strokeWidth:r,strokeOpacity:o,fillOpacity:0}))}updateText(e,t){this.text=this.updateNode(ed,this.text,!!e.text.label),tp(this.line.id,this.line,t,e.text,this.text,e.text.label,e.strokeWidth)}updateCaps(e,t){if(!e.startCap&&this.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),!e.endCap&&this.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),!e.startCap&&!e.endCap)return;const{stroke:i,strokeWidth:s,strokeOpacity:n}=e,[a,r]=dr.from(t),o=dr.angle(dr.sub(r,a));e.startCap&&(this.startCap&&this.startCap.type!==e.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),this.startCap==null&&(this.startCap=new Xb,this.append([this.startCap])),this.startCap.update({x:a.x,y:a.y,angle:o-Math.PI,stroke:i,strokeWidth:s,strokeOpacity:n})),e.endCap&&(this.endCap&&this.endCap.type!==e.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),this.endCap==null&&(this.endCap=new Xb,this.append([this.endCap])),this.endCap.update({x:r.x,y:r.y,angle:o,stroke:i,strokeWidth:s,strokeOpacity:n}))}updateAnchor(e,t,i,s){const n=u_.topCenter(t);dr.apply(this.anchor,R.Transformable.toCanvasPoint(this.line,n.x,n.y))}containsPoint(e,t){const{line:i,text:s}=this;return super.containsPoint(e,t)||i.isPointInPath(e,t)||!!(s!=null&&s.containsPoint(e,t))}getNodeAtCoords(e,t){var i;return(i=this.text)!=null&&i.containsPoint(e,t)?"text":this.line.isPointInPath(e,t)?"line":super.getNodeAtCoords(e,t)}getHandleCoords(e,t,i,s){const{startCap:n,endCap:a}=this;let[r,o]=dr.from(t);const l=dr.angle(dr.sub(o,r));return n&&(r=dr.rotate(dr.from(0,-gi.HANDLE_SIZE/2),l,r)),a&&(o=dr.rotate(dr.from(0,gi.HANDLE_SIZE/2),l,o)),i==="start"?r:o}getHandleStyles(e){var t,i,s;return{fill:e.handle.fill,stroke:(t=e.handle.stroke)!=null?t:e.stroke,strokeOpacity:(i=e.handle.strokeOpacity)!=null?i:e.strokeOpacity,strokeWidth:(s=e.handle.strokeWidth)!=null?s:e.strokeWidth}}},p_={type:"line",datum:Zo,scene:bc,isDatum:Zo.is,translate:(e,t,i,s)=>{Zo.is(t)&&bc.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Zo.is(t)&&Zo.is(i)&&bc.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Zo.is(t)&&bc.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Ede(E(b({},e),{create:t("line")})),dragState:e=>new Ei(e)},g_={type:"arrow",datum:Xo,scene:bc,isDatum:Xo.is,translate:(e,t,i,s)=>{Xo.is(t)&&bc.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Xo.is(t)&&Xo.is(i)&&bc.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Xo.is(t)&&bc.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Pde(E(b({},e),{create:t("arrow")})),dragState:e=>new Ei(e)};function f_(e,t=0,i=0){let s=t;for(const n of e)if(Array.isArray(n)){for(const a of n)m_(a,s);s+=R.Group.computeChildrenBBox(n).width+i}else m_(n,s),s+=n.getBBox().width+i}function Ode(e,t=0,i=0){let s=t;for(const n of e)if(Array.isArray(n)){for(const a of n)y_(a,s);s+=R.Group.computeChildrenBBox(n).height+i}else y_(n,s),s+=n.getBBox().height+i}function m_(e,t){"x1"in e?(e.x2=t+(e.x2-e.x1),e.x1=t):e.x=t}function y_(e,t){"y1"in e?(e.y2=t+(e.y2-e.y1),e.y1=t):e.y=t}function v_(e,t){"x1"in e?(e.x1+=t,e.x2+=t):e.x+=t}function b_(e,t){"y1"in e?(e.y1+=t,e.y2+=t):e.y+=t}var{Vec4:BA}=R,x_=class extends R.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new R.Rect,this.dateRangeBarsText=new R.Text,this.dateRangeDivider=new R.Line,this.dateRangeValueText=new R.Text,this.priceRangeValueText=new R.Text,this.priceRangeDivider=new R.Line,this.priceRangePercentageText=new R.Text,this.volumeText=new R.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(e,t,i,s,n,a,r){this.verticalDirection=a;const o=this.updateStatistics(e,t,i,r),l=R.Group.computeChildrenBBox(o.flat()),c=10;l.grow(c),this.updateBackground(e,l,c),this.reposition(o,c,n),this.checkVisibility(e,n,s)}checkVisibility(e,t,i){var n;const s=BA.from(new R.BBox(0,0,t.seriesRect.width,t.seriesRect.height));BA.collides(i,s)?this.visible=(n=e.visible)!=null?n:!0:this.visible=!1}updateStatistics(e,t,i,s){const{dateRangeBarsText:n,dateRangeDivider:a,dateRangeValueText:r,priceRangeValueText:o,priceRangeDivider:l,priceRangePercentageText:c,volumeText:h}=this,d=8,u=6,p=e.statistics.fontSize+3,g=-2,f=this.getTextStyles(e),y=E(b({},this.getDividerStyles(e)),{x1:0,y1:0,x2:0,y2:p}),v=[n,a,r],x=[o,l,c],S=[];return t.priceRange&&(o.setProperties(E(b({},f),{text:this.formatPriceRangeValue(t.priceRange.value,s)})),l.setProperties(y),c.setProperties(E(b({},f),{text:this.formatPriceRangePercentage(t.priceRange.percentage,s)})),f_(x,i.x,d),S.push(x)),t.dateRange&&(n.setProperties(E(b({},f),{text:this.formatDateRangeBars(t.dateRange.bars,s)})),a.setProperties(y),r.setProperties(E(b({},f),{text:this.formatDateRangeValue(t.dateRange.value)})),f_(v,i.x,d),S.push(v)),t.volume!=null?(h.setProperties(E(b({},f),{x:i.x,text:this.formatVolume(t.volume,s),visible:!0})),S.push(h)):h.visible=!1,Ode(S,i.y,u),l.y1+=g,l.y2+=g,a.y1+=g,a.y2+=g,S}updateBackground(e,t,i){const s=this.getBackgroundStyles(e);this.background.setProperties(E(b(b({},s),t),{x:t.x-t.width/2+i,y:t.y}))}reposition(e,t,i){const{width:s,height:n}=i.seriesRect,a=BA.from(this.background.getBBox());let r=0;a.x1<0&&(r=-a.x1),a.x2>s&&(r=s-a.x2);const o=Math.min(t,n-a.y2);for(const l of e)if(Array.isArray(l)){const c=R.Group.computeChildrenBBox(l).width;for(const h of l)v_(h,r-c/2),b_(h,o)}else v_(l,r-l.getBBox().width/2),b_(l,o);this.background.x+=r,this.background.y+=o}getTextStyles(e){return{fill:e.statistics.color,fontFamily:e.statistics.fontFamily,fontSize:e.statistics.fontSize,fontStyle:e.statistics.fontStyle,fontWeight:e.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(e){return{stroke:e.statistics.divider.stroke,strokeOpacity:e.statistics.divider.strokeOpacity,strokeWidth:e.statistics.divider.strokeWidth}}getBackgroundStyles(e){return{fill:e.statistics.fill,stroke:e.statistics.stroke,strokeOpacity:e.statistics.strokeOpacity,strokeWidth:e.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(e,t){var i;return(i=t==null?void 0:t.t("measurerDateRangeBars",{value:e}))!=null?i:`${e}`}formatDateRangeValue(e){const t=[],i=e>=0?"":"-";e=Math.abs(e);const s=1e3*60,n=s*60,a=n*24,r=Math.floor(e/s),o=Math.floor(e/n),l=Math.floor(e/a),c=o%(a/n),h=r%(n/s);return l>=1&&t.push(`${l}d`),o>=1&&(e<a||c!==0)&&t.push(`${c}h`),(e<n||h!==0)&&t.push(`${h}m`),t[0]=`${i}${t[0]}`,t.join(" ")}formatPriceRangeValue(e,t){var i;return(i=t==null?void 0:t.t("measurerPriceRangeValue",{value:Number(e.toFixed(2))}))!=null?i:`${e}`}formatPriceRangePercentage(e,t){var i;return(i=t==null?void 0:t.t("measurerPriceRangePercent",{value:e}))!=null?i:`${e}`}formatVolume(e,t){var s;const i=isNaN(e)?"":this.volumeFormatter.format(e);return(s=t==null?void 0:t.t("measurerVolume",{value:i}))!=null?s:i}},Fde=class extends x_{getDirectionStyles(e){return this.verticalDirection==="down"?e.down.statistics:e.up.statistics}getTextStyles(e){const t=this.getDirectionStyles(e);return E(b({},super.getTextStyles(e)),{fill:t.color,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight})}getDividerStyles(e){const t=this.getDirectionStyles(e);return{stroke:t.divider.stroke,strokeOpacity:t.divider.strokeOpacity,strokeWidth:t.divider.strokeWidth}}getBackgroundStyles(e){const t=this.getDirectionStyles(e);return E(b({},super.getBackgroundStyles(e)),{fill:t.fill,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth})}},{Vec2:qr,Vec4:sd}=R,ia=class extends wA{constructor(){super(),this.type="measurer",this.horizontalLine=new On,this.verticalLine=new On,this.horizontalStartLine=new On,this.horizontalEndLine=new On,this.verticalStartLine=new On,this.verticalEndLine=new On,this.horizontalEndCap=new Xb,this.verticalEndCap=new Xb,this.background=new R.Path({zIndex:-1}),this.updateBackground=t_.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(e){return fs.isCheck(e,"measurer")}createStatisticsScene(){return new x_}update(e,t){var r;const i=yn(e,t);if(i==null){this.visible=!1;return}if(this.visible=(r=e.visible)!=null?r:!0,!this.visible)return;const s=this.extendPerpendicular(i,e,t),n=E(b({},s),{y2:s.y1}),a=E(b({},s),{y1:s.y2});this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(e),this.updateLines(e,i),this.updateHandles(e,i),this.updateText(e,i),this.updateCaps(e,i),this.updateBoundingLines(e,s),this.updateBackground(e,n,a,t),this.updateStatistics(e,i,t),this.updateAnchor(e,i,t)}extendPerpendicular(e,t,i){const s={x1:Math.min(e.x1,e.x2),x2:Math.max(e.x1,e.x2),y1:Math.min(e.y1,e.y2),y2:Math.max(e.y1,e.y2)},[n,a]=qr.from(i.yAxis.bounds);return La.is(t)?(t.extendAbove&&(s.y1=n.y),t.extendBelow&&(s.y2=a.y)):Pa.is(t)&&(t.extendLeft&&(s.x1=n.x),t.extendRight&&(s.x2=a.x)),s}updateVisibilities(e){const{horizontalStartLine:t,horizontalEndLine:i,horizontalEndCap:s,verticalStartLine:n,verticalEndLine:a,verticalEndCap:r}=this,{direction:o}=e;n.visible=o!=="vertical",a.visible=o!=="vertical",s.visible=o!=="vertical",t.visible=o!=="horizontal",i.visible=o!=="horizontal",r.visible=o!=="horizontal"}updateLines(e,t){const{horizontalLine:i,verticalLine:s}=this,{direction:n}=e,{x1:a,y1:r,x2:o,y2:l}=t,c=qr.round(sd.center(t),0),h=this.getLineStyles(e);n!=="vertical"&&i.setProperties(E(b({},h),{x1:a,x2:o,y1:c.y,y2:c.y})),n!=="horizontal"&&s.setProperties(E(b({},h),{x1:c.x,x2:c.x,y1:r,y2:l}))}updateText(e,t){const{direction:i}=e,s=qr.round(sd.center(t),0);let n;const a=b({},t);i==="vertical"?(n=this.verticalLine,a.x1=s.x,a.x2=s.x):(n=this.horizontalLine,a.y1=s.y,a.y2=s.y),this.text=this.updateNode(ed,this.text,!!e.text.label);const{id:r}=n,o=tp(r,n,a,e.text,this.text,e.text.label,e.strokeWidth);let l;if(i==="both"&&o&&this.text){const c=sd.from(this.text.getBBox()),{offset:h}=o.numbers;c.x1<=s.x+h.x&&c.x2>=s.x-h.x&&(l={x:s.x,y:o.clipMask.y,radius:this.text.getBBox().height/2+qr.length(h)})}this.verticalLine.setClipMask(r,l)}updateCaps(e,t){const{horizontalEndCap:i,verticalEndCap:s}=this,{direction:n}=e,{x1:a,y1:r,x2:o,y2:l}=t,c=qr.round(sd.center(t),0),{stroke:h,strokeWidth:d,strokeOpacity:u}=this.getLineStyles(e),p={stroke:h,strokeWidth:d,strokeOpacity:u};if(n!=="vertical"){const g=a<=o?0:Math.PI;let f=o;n==="horizontal"&&(f+=a<=o?-2:2),i.update(E(b({},p),{x:f,y:c.y,angle:g}))}if(n!=="horizontal"){const g=r<=l?Math.PI/2:Math.PI/-2;let f=l;n==="vertical"&&(f+=r<=l?-2:2),s.update(E(b({},p),{x:c.x,y:f,angle:g}))}}updateBoundingLines(e,t){const{verticalStartLine:i,verticalEndLine:s,horizontalStartLine:n,horizontalEndLine:a}=this,{direction:r}=e,{x1:o,y1:l,x2:c,y2:h}=t,d=this.getLineStyles(e);r==="horizontal"&&(i.setProperties(E(b({},d),{x1:o,y1:l,x2:o,y2:h})),s.setProperties(E(b({},d),{x1:c,y1:l,x2:c,y2:h}))),r==="vertical"&&(n.setProperties(E(b({},d),{x1:o,y1:l,x2:c,y2:l})),a.setProperties(E(b({},d),{x1:o,y1:h,x2:c,y2:h})))}updateStatistics(e,t,i){const s=qr.add(sd.bottomCenter(t),qr.from(0,10)),n={volume:this.getVolume(e)};e.hasPriceRange&&(n.priceRange={percentage:this.getPriceRangePercentage(e),value:this.getPriceRangeValue(e)}),e.hasDateRange&&(n.dateRange={bars:this.getDateRangeBars(t,i),value:this.getDateRangeValue(e)}),this.statistics.update(e,n,s,t,i,this.verticalDirection,e.localeManager)}updateAnchor(e,t,i,s){const n=sd.topCenter(t);qr.apply(this.anchor,R.Transformable.toCanvasPoint(this.horizontalLine,n.x,n.y))}getBackgroundPoints(e,t,i,s){const[n,a]=qr.from(t),[r,o]=qr.from(i);return[n,a,o,r]}getLineStyles(e){const{lineDashOffset:t,stroke:i,strokeWidth:s,strokeOpacity:n}=e;return{lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,stroke:i,strokeWidth:s,strokeOpacity:n,fillOpacity:0}}getBackgroundStyles(e){const{background:t}=e;return{fill:t.fill,fillOpacity:t.fillOpacity}}getHandleStyles(e){var t,i,s;return{fill:e.handle.fill,stroke:(t=e.handle.stroke)!=null?t:e.stroke,strokeOpacity:(i=e.handle.strokeOpacity)!=null?i:e.strokeOpacity,strokeWidth:(s=e.handle.strokeWidth)!=null?s:e.strokeWidth}}containsPoint(e,t){const{horizontalLine:i,text:s,verticalLine:n,horizontalStartLine:a,horizontalEndLine:r,verticalStartLine:o,verticalEndLine:l}=this;return super.containsPoint(e,t)||i.isPointInPath(e,t)||n.isPointInPath(e,t)||a.visible&&a.isPointInPath(e,t)||r.visible&&r.isPointInPath(e,t)||o.visible&&o.isPointInPath(e,t)||l.visible&&l.isPointInPath(e,t)||!!(s!=null&&s.containsPoint(e,t))}getNodeAtCoords(e,t){var i;return(i=this.text)!=null&&i.containsPoint(e,t)?"text":this.start.containsPoint(e,t)||this.end.containsPoint(e,t)?"handle":"line"}getDateRangeBars(e,t){const{step:i}=t.xAxis.scale,s=e.x1<=e.x2?1:-1;return i?Math.round(sd.width(e)/i)*s:0}getDateRangeValue(e){const t=Yi(e.start.x),i=Yi(e.end.x);if(!Mr(t)||!Mr(i))throw new Error("Can not create a date range measurement of non-date x-axis.");return i.getTime()-t.getTime()}getPriceRangePercentage(e){if(e.start.y==null||e.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const t=Yi(e.end.y),i=Yi(e.start.y);if(!ki(t)||!ki(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return(t-i)/i}getPriceRangeValue(e){if(e.start.y==null||e.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const t=Yi(e.end.y),i=Yi(e.start.y);if(!ki(t)||!ki(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return t-i}getVolume(e){return e.getVolume(e.start.x,e.end.x)}},Zb=class extends ia{constructor(){super(...arguments),this.type="quick-measurer"}static is(e){return fs.isCheck(e,"quick-measurer")}createStatisticsScene(){return new Fde}getDirectionStyles(e){return this.verticalDirection==="down"?e.down:e.up}getLineStyles(e){const t=this.getDirectionStyles(e);return E(b({},super.getLineStyles(e)),{stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity})}getBackgroundStyles(e){const t=this.getDirectionStyles(e);return{fill:t.fill,fillOpacity:t.fillOpacity}}getHandleStyles(e){var i,s,n;const t=this.getDirectionStyles(e);return{fill:t.handle.fill,stroke:(i=t.handle.stroke)!=null?i:t.stroke,strokeOpacity:(s=t.handle.strokeOpacity)!=null?s:t.strokeOpacity,strokeWidth:(n=t.handle.strokeWidth)!=null?n:t.strokeWidth}}},{StateMachine:np,StateMachineProperty:C_,Debug:Bde}=R,ap=class extends np{constructor(e){const t=({point:r})=>{const o=this.createDatum();o.set({start:r,end:r}),e.create(o)},i=({point:r})=>{const{datum:o,node:l}=this;o==null||o.set({end:r}),l==null||l.toggleActive(!0),l==null||l.toggleHandles({end:!1}),e.update()},s=()=>{var r;(r=this.node)==null||r.toggleHandles({end:!0})},n=()=>e.delete(),a=()=>{var r;e.showAnnotationOptions(),!cc(this.datum)&&e.recordAction(`Create ${(r=this.node)==null?void 0:r.type} annotation`)};super("start",{start:{reset:np.parent,click:{target:"end",action:t},drag:{target:"end",action:t}},end:{hover:i,drag:i,click:{target:np.parent,action:s},dragEnd:{target:np.parent,action:s},reset:{target:np.parent,action:n},cancel:{target:np.parent,action:n},onExit:a}}),this.debug=Bde.create(!0,"annotations")}};C([C_()],ap.prototype,"datum",2),C([C_()],ap.prototype,"node",2);var _de=class extends ap{createDatum(){return new La}},Gde=class extends ap{createDatum(){return new Pa}},zde=class extends ap{createDatum(){return new Yo}},Vde=class extends ap{createDatum(){return new ta}},S_={type:"date-range",datum:La,scene:ia,isDatum:La.is,translate:(e,t,i,s)=>{La.is(t)&&ia.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(La.is(t)&&La.is(i)&&ia.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{La.is(t)&&ia.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new _de(E(b({},e),{create:t("date-range")})),dragState:e=>new Ei(e)},M_={type:"price-range",datum:Pa,scene:ia,isDatum:Pa.is,translate:(e,t,i,s)=>{Pa.is(t)&&ia.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Pa.is(t)&&Pa.is(i)&&ia.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Pa.is(t)&&ia.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Gde(E(b({},e),{create:t("date-range")})),dragState:e=>new Ei(e)},D_={type:"date-price-range",datum:Yo,scene:ia,isDatum:Yo.is,translate:(e,t,i,s)=>{Yo.is(t)&&ia.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Yo.is(t)&&Yo.is(i)&&ia.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Yo.is(t)&&ia.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new zde(E(b({},e),{create:t("date-range")})),dragState:e=>new Ei(e)},w_={type:"quick-date-price-range",datum:ta,scene:Zb,isDatum:ta.is,translate:(e,t,i,s)=>{ta.is(t)&&Zb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(ta.is(t)&&ta.is(i)&&Zb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{ta.is(t)&&Zb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Vde(E(b({},e),{create:t("quick-date-price-range")})),dragState:e=>new Ei(e)},{ZIndexMap:A_,TextWrapper:jde}=R,qb=class extends kA{constructor(){super(),this.type="note",this.shape=new R.Rect,this.iconBackground=new R.SvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new R.SvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new R.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(e){return fs.isCheck(e,"note")}update(e,t){this.updateIcon(e,t),super.update(e,t)}getTextBBox(e,t,i){const s=super.getTextBBox(e,t,i);s.x-=e.width/2,s.x=we(0,s.x,i.seriesRect.width-e.width);const n=e.getPadding().top,a=s.y-yB-n*2,r=s.y+gi.HANDLE_SIZE+n*2;return a-s.height-vB<0?(s.y=r,e.position="top"):(s.y=a+n,e.position="bottom"),s}updateLabel(e,t){const i=e.visible===!1?!1:this.label.visible;super.updateLabel(e,t),this.label.visible=i,this.label.text=jde.wrapText(e.text,{font:{fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight},avoidOrphans:!1,textAlign:e.textAlign,textBaseline:"hanging",textWrap:"always",maxWidth:200})}updateShape(e,t){var a,r,o;const{shape:i}=this;i.fill=e.background.fill,i.fillOpacity=(a=e.background.fillOpacity)!=null?a:1,i.stroke=e.background.stroke,i.strokeOpacity=(r=e.background.strokeOpacity)!=null?r:1,i.strokeWidth=(o=e.background.strokeWidth)!=null?o:1,i.cornerRadius=4;const s=e.getPadding().top,n=e.position==="top";i.x=t.x-s,i.width=e.width+s*2,i.height=t.height+s*2,i.y=t.y+(n?0:-t.height)-s}updateIcon(e,t){var o,l,c,h;const{active:i,iconBackground:s,iconLines:n}=this,{x:a,y:r}=pi(e,t);s.x=a-bhe/2,s.y=r-mB,n.x=s.x,n.y=s.y,s.fill=e.fill,s.fillOpacity=(o=e.fillOpacity)!=null?o:1,s.stroke=e.stroke,s.strokeOpacity=(l=e.strokeOpacity)!=null?l:1,s.strokeWidth=(c=e.strokeWidth)!=null?c:1,n.fill=e.stroke,i?s.fillShadow.color=(h=e.fill)!=null?h:"rgba(0, 0, 0, 0.22)":s.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(e,t,i){const s=e.getPadding().top,n=e.position==="top",a=n?1:-1;return{x:t.x+i.seriesRect.x+e.width/2,y:t.y+i.seriesRect.y+a*(t.height+s),position:n?"below":"above"}}getLabelCoords(e,t){const i=e.position==="top",s=e.getPadding().top+e.fontSize*Gf/2;return{x:t.x,y:t.y+(i?s/2:0)}}getTextBaseline(e){return e.position==="top"?"middle":e.position}getHandleCoords(e,t,i){return{x:t.x,y:t.y+gi.HANDLE_SIZE/2+4}}getHandleStyles(e){var t;return{fill:e.handle.fill,stroke:(t=e.handle.stroke)!=null?t:e.fill,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}toggleHovered(e){super.toggleHovered(e),this.label.visible=e,this.shape.visible=e,this.zIndex=e?A_.CHART_ANNOTATION_FOCUSED:A_.CHART_ANNOTATION}toggleActive(e){super.toggleActive(e),this.label.visible=e,this.shape.visible=e,this.active=e}containsPoint(e,t){return this.shape.visible&&this.shape.containsPoint(e,t)||this.iconBackground.containsPoint(e,t)?!0:super.containsPoint(e,t)}},Hde=class extends Hf{createDatum(){return new Nn}},I_={type:"note",datum:Nn,scene:qb,isDatum:Nn.is,translate:(e,t,i,s)=>{Nn.is(t)&&qb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Nn.is(t)&&Nn.is(i)&&qb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Nn.is(t)&&qb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Hde(E(b({},e),{create:t("note")})),dragState:e=>new Ei(e)},{Vec2:Ba,Vec4:Qr}=R,Qb=class extends i_{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new gi,topMiddle:new ep,topRight:new gi,bottomLeft:new gi,bottomMiddle:new ep,bottomRight:new gi},this.middleLine=new On,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(e){return fs.isCheck(e,"parallel-channel")}dragHandle(e,t,i,s){const{activeHandle:n,handles:a}=this;if(n==null)return;const{offset:r}=a[n].drag(t);a[n].toggleDragging(!0),(n==="topMiddle"||n==="bottomMiddle")&&(r.x=0);let o=[],l=s;switch(n){case"topLeft":case"bottomLeft":o=["topLeft","bottomLeft"];break;case"topMiddle":o=["topLeft","topRight"],r.y-=ep.HANDLE_SIZE/2,l=!1;break;case"topRight":case"bottomRight":o=["topRight","bottomRight"];break;case"bottomMiddle":o=["bottomLeft","bottomRight"],r.y-=ep.HANDLE_SIZE/2,l=!1;break}const c=yn(e,i),h=yn(e.bottom,i);if(!c||!h)return;const d={topLeft:Qr.start(c),topRight:Qr.end(c),bottomLeft:Qr.start(h),bottomRight:Qr.end(h)},u={vectors:{topLeft:d.topRight,bottomLeft:d.bottomRight,topRight:d.topLeft,bottomRight:d.bottomLeft},angle:e.snapToAngle},p=tl(d,r,i,{overflowContinuous:this.overflowContinuous,translateVectors:o,snap:l?u:void 0});e.start.x=p.topLeft.x,e.start.y=p.topLeft.y,e.end.x=p.topRight.x,e.end.y=p.topRight.y,e.height=p.topLeft.y-p.bottomLeft.y}getTranslatePointsVectors(e,t){const{bottomLeft:i,topLeft:s}=this.handles,n=i.getBBox().y-s.getBBox().y,a=Ba.add(e,Ba.from(0,n)),r=Ba.add(t,Ba.from(0,n));return{start:e,end:t,bottomStart:a,bottomEnd:r}}containsPoint(e,t){return super.containsPoint(e,t)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(e,t)}getNodeAtCoords(e,t){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(e,t)?"line":super.getNodeAtCoords(e,t)}updateLines(e,t,i,s,n,a){var y,v,x,S,M,D;const{topLine:r,middleLine:o,bottomLine:l}=this,{lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u}=e,p=e.getLineDash(),g={lineCap:e.getLineCap(),lineDash:p,lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u};r.setProperties(b(b({},t),g)),l.setProperties(b(b({},i),g));const f=this.extendLine({x1:n.x1,y1:a.y1+(n.y1-a.y1)/2,x2:n.x2,y2:a.y2+(n.y2-a.y2)/2},e,s);o.setProperties(E(b({},f),{lineDash:(y=e.middle.lineDash)!=null?y:p,lineDashOffset:(v=e.middle.lineDashOffset)!=null?v:c,stroke:(x=e.middle.stroke)!=null?x:h,strokeOpacity:(S=e.middle.strokeOpacity)!=null?S:d,strokeWidth:(M=e.middle.strokeWidth)!=null?M:u,visible:(D=e.middle.visible)!=null?D:!0}))}updateHandles(e,t,i){var h,d,u;const{handles:{topLeft:s,topMiddle:n,topRight:a,bottomLeft:r,bottomMiddle:o,bottomRight:l}}=this,c={fill:e.handle.fill,stroke:(h=e.handle.stroke)!=null?h:e.stroke,strokeOpacity:(d=e.handle.strokeOpacity)!=null?d:e.strokeOpacity,strokeWidth:(u=e.handle.strokeWidth)!=null?u:e.strokeWidth};s.update(b(b({},c),Qr.start(t))),a.update(b(b({},c),Qr.end(t))),r.update(b(b({},c),Qr.start(i))),l.update(b(b({},c),Qr.end(i))),n.update(b(b({},c),Ba.sub(Qr.center(t),Ba.from(n.handle.width/2,n.handle.height/2)))),o.update(b(b({},c),Ba.sub(Qr.center(i),Ba.from(o.handle.width/2,o.handle.height/2))))}updateText(e,t,i){this.text=this.updateNode(ed,this.text,!!e.text.label),XB(!0,t,i,e.text,e.strokeWidth,this.text,e.text.label)}getBackgroundPoints(e,t,i,s){const n=t.x1>t.x2,a=t.y1>t.y2,r=t.x1!==i.x1&&t.y1!==i.y1,o=t.x2!==i.x2&&t.y2!==i.y2,l=Ba.from(t);return e.extendEnd&&o&&l.push(Ba.from(n?s.x1:s.x2,a?s.y1:s.y2)),l.push(...Ba.from(i).reverse()),e.extendStart&&r&&l.push(Ba.from(n?s.x2:s.x1,a?s.y2:s.y1)),l}},{StateMachine:xc,StateMachineProperty:_A,Debug:Wde}=R,Jb=class extends xc{constructor(e){const t=({point:l})=>{const c=new Ra;c.set({start:l,end:l,height:0}),e.create(c)},i=()=>{const{node:l}=this;l==null||l.toggleActive(!0),l==null||l.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})},s=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:jf(l,c,d,h.start,h.snapToAngle)}),e.update())},n=()=>{var l;(l=this.node)==null||l.toggleHandles({topRight:!0}),e.update()},a=({point:l})=>{const{datum:c,node:h}=this,d=Yi(c==null?void 0:c.end.y),u=Yi(c==null?void 0:c.start.y),{y:p}=l;if(c==null||!ki(u)||!ki(d)||!ki(p))return;const g=d-(p!=null?p:0),f=u-g;h==null||h.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!e.validatePoint({x:c.start.x,y:f},{overflowContinuous:!0})||!e.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:g}),e.update())},r=({point:l})=>{const{datum:c,node:h}=this,d=Yi(c==null?void 0:c.end.y),u=Yi(c==null?void 0:c.start.y),{y:p}=l;if(c==null||!ki(u)||!ki(d)||!ki(p))return;const g=d-(p!=null?p:0),f=u-g;h==null||h.toggleHandles(!0),!(!e.validatePoint({x:c.start.x,y:f},{overflowContinuous:!0})||!e.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:g}),e.recordAction("Create parallel-channel annotation"),e.showAnnotationOptions(),e.update())},o=()=>e.delete();super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:xc.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,drag:s,click:{target:"height",action:n},dragEnd:{target:"height",action:n},reset:{target:xc.parent,action:o},cancel:{target:xc.parent,action:o}},height:{hover:a,click:{target:xc.parent,action:r},drag:{target:xc.parent,action:r},reset:{target:xc.parent,action:o},cancel:{target:xc.parent,action:o}}}),this.debug=Wde.create(!0,"annotations"),this.snapping=!1}};C([_A()],Jb.prototype,"datum",2),C([_A()],Jb.prototype,"node",2),C([_A()],Jb.prototype,"snapping",2);var T_={type:"parallel-channel",datum:Ra,scene:Qb,isDatum:Ra.is,translate:(e,t,i,s)=>{Ra.is(t)&&Qb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Ra.is(t)&&Ra.is(i)&&Qb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Ra.is(t)&&Qb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Jb(E(b({},e),{create:t("parallel-channel")})),dragState:e=>new Ei(e)},ex=class extends kA{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(e){return fs.isCheck(e,"text")}getHandleCoords(e,t){const i=gi.HANDLE_SIZE/2;return{x:t.x+i,y:t.y+2+i}}},Ude=class extends Hf{createDatum(){return new Jo}},k_={type:"text",datum:Jo,scene:ex,isDatum:Jo.is,translate:(e,t,i,s)=>{Jo.is(t)&&ex.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Jo.is(t)&&Jo.is(i)&&ex.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Jo.is(t)&&ex.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Ude(E(b({},e),{create:t("text")})),dragState:e=>new Ei(e)},sa={[p_.type]:p_,[JB.type]:JB,[e_.type]:e_,[T_.type]:T_,[s_.type]:s_,[d_.type]:d_,[c_.type]:c_,[UB.type]:UB,[$B.type]:$B,[I_.type]:I_,[k_.type]:k_,[g_.type]:g_,[GB.type]:GB,[_B.type]:_B,[S_.type]:S_,[M_.type]:M_,[D_.type]:D_,[w_.type]:w_};function nd(e){for(const{isDatum:t}of Object.values(sa))if(t(e))return e}var{ActionOnSet:Kde,ParallelStateMachine:$de,StateMachine:GA,StateMachineProperty:Jr,Debug:Yde}=R,tx=class extends $de{constructor(e){super(new Xde(t=>{this.snapping=t}),new Zde(()=>{this.node=this.active==null?void 0:e.node(this.active)}),new Cc(e,t=>{this.active=t,this.datum=this.active==null?void 0:e.datum(this.active),this.node=this.active==null?void 0:e.node(this.active)})),this.snapping=!1}getActive(){return this.active}isActive(e){return e===this.active}};C([Jr()],tx.prototype,"snapping",2),C([Jr()],tx.prototype,"datum",2),C([Jr()],tx.prototype,"node",2);var Xde=class extends GA{constructor(e){super("idle",{idle:{hover:({shiftKey:t})=>e(t),keyDown:({shiftKey:t})=>e(t),keyUp:({shiftKey:t})=>e(t),click:({shiftKey:t})=>e(t),drag:({shiftKey:t})=>e(t)},dragging:{},translating:{},"text-input":{}})}},Zde=class extends GA{constructor(e){super("idle",{idle:{onEnter:e,render:e},dragging:{onEnter:e,render:e},translating:{onEnter:e,render:e},"text-input":{render:e}})}},Cc=class extends GA{constructor(e,t){const i=S=>M=>{e.create(S,M),this.active=e.selectLast()},s=()=>{this.active!=null&&e.delete(this.active),this.active=void 0,e.select()},n={createDatum:i},a=E(b({},e),{delete:s,showTextInput:()=>{this.active!=null&&e.showTextInput(this.active)},deselect:()=>{const S=this.active;this.active=void 0,this.hovered=void 0,e.select(this.active,S)},showAnnotationOptions:()=>{this.active!=null&&e.showAnnotationOptions(this.active)}}),r=Object.fromEntries(Object.entries(sa).map(([S,M])=>[S,M.createState(a,n)])),o=Object.fromEntries(Object.entries(sa).map(([S,M])=>[S,M.dragState(e,n)])),l=({colorPickerType:S,colorOpacity:M,color:D,opacity:A,isMultiColor:w})=>{this.datum&&(S==="text-color"&&e.updateTextInputColor(D),Rb(this.datum,S,M,D,A,w),e.update())},c=S=>{const{datum:M,node:D}=this;!M||!D||(Xr(M)?(M.fontSize=S,e.updateTextInputFontSize(S)):Qu(M)&&(M.text.fontSize=S),e.update())},h=S=>{const{datum:M,node:D}=this;!M||!D||!hc(M)||(SB(M,S),e.update())},d=S=>{const{node:M}=this;!M||!("setTextInputBBox"in M)||(M.setTextInputBBox(S),e.update())},u=({textInputValue:S,bbox:M})=>{const{datum:D}=this;if(M!=null&&S!=null&&S.length>0){if(!Xr(D))return;const A=Ib(D,S,M.width);D.set({text:A}),e.update(),e.recordAction(`Change ${D.type} annotation text`)}else e.delete(this.active),e.recordAction(`Delete ${D==null?void 0:D.type} annotation`)},p=()=>{e.updateTextInputBBox(void 0)},g=()=>this.active!=null,f=()=>this.copied!=null,y=()=>{const{active:S,datum:M}=this;return S==null||!M?!1:Qu(M)&&!M.locked},v=()=>this.active!=null&&!cc(this.datum),x=()=>this.hovered!=null;super("idle",{idle:b({onEnter:()=>{e.select(this.active,this.active),this.hoverCoords&&(this.hovered=e.hoverAtCoords(this.hoverCoords,this.active,this.hovered))},hover:({offset:S})=>{this.hovered=e.hoverAtCoords(S,this.active,this.hovered),this.hoverCoords=S},translate:{guard:g,target:"translating",action:({translation:S})=>{e.startInteracting(),e.translate(this.active,S),e.update()}},copy:{guard:v,action:()=>{this.copied=e.copy(this.active)}},cut:{guard:v,action:()=>{this.copied=e.copy(this.active),s()}},paste:{guard:f,action:()=>{e.paste(this.copied)}},selectLast:()=>{const S=this.active;this.active=e.selectLast(),e.select(this.active,S)},click:[{guard:()=>{const{active:S,hovered:M,datum:D}=this;return S==null||M!==S||!D?!1:Xr(D)&&!D.locked},target:"text-input"},{action:()=>{const S=this.active;this.active=this.hovered,e.select(this.active,S)}}],dblclick:{guard:y,action:({offset:S})=>{const M=e.getNodeAtCoords(S,this.active)==="text"?"text":"line";e.showAnnotationSettings(this.active,void 0,M)}},dragStart:[{guard:x,target:"dragging",action:()=>{const S=this.active;this.active=this.hovered,e.select(this.active,S),e.startInteracting()}},{action:()=>{const S=this.active;this.active=this.hovered,e.select(this.active,S)}}],color:{guard:g,action:l},fontSize:{guard:g,action:c},lineProps:{guard:g,action:S=>{const M=nd(this.datum);M==null||M.set(S),e.update(),e.recordAction(`Change ${M==null?void 0:M.type} ${Object.entries(S).map(([D,A])=>`${D} to ${A}`).join(", ")}`)}},lineStyle:{guard:g,action:h},lineText:{guard:g,action:S=>{const M=nd(this.datum);Qu(M)&&(el(M)&&S.position==="center"&&(S.position="inside"),M.text.set(S),e.update())}},updateTextInputBBox:{guard:g,action:d},toolbarPressSettings:{guard:y,action:S=>{e.showAnnotationSettings(this.active,S)}},reset:()=>{var S;this.active!=null&&((S=this.node)==null||S.toggleActive(!1)),this.hovered=void 0,this.active=void 0,e.select(this.active,this.active),e.resetToIdle()},delete:()=>{var S;this.active!=null&&(e.delete(this.active),!cc(this.datum)&&e.recordAction(`Delete ${(S=this.datum)==null?void 0:S.type} annotation`))},deleteAll:()=>{e.deleteAll()}},r),dragging:b({onEnter:(S,M)=>{if(this.active==null)return;const D=e.getAnnotationType(this.active);D&&(this.transitionRoot(D),this.transitionRoot("dragStart",M))}},o),translating:{onEnter:()=>{},translate:{guard:g,target:"translating",action:({translation:S})=>{e.startInteracting(),e.translate(this.active,S),e.update()}},translateEnd:{guard:g,target:"idle"},onExit:()=>{e.stopInteracting(),e.update(),e.recordAction("Translate annotation")}},"text-input":{onEnter:()=>{if(this.active==null)return;const S=nd(this.datum);!S||!("getTextInputCoords"in S)||(e.startInteracting(),e.showTextInput(this.active),S.visible=!1,e.update())},updateTextInputBBox:{guard:g,action:d},resize:{target:"idle",action:u},click:{target:"idle",action:u},drag:{target:"idle",action:u},textInput:[{guard:AA,target:"idle",action:p},{guard:IA,target:"idle",action:u}],color:{guard:g,action:l},fontSize:{guard:g,action:c},cancel:{target:"idle",action:p},onExit:()=>{e.stopInteracting(),e.hideTextInput();const S=this.active;if(this.active=this.hovered=void 0,e.select(this.active,S),S==null)return;const M=e.datum(S),D=e.node(S);!M||!D||(M.visible=!0)}}}),this.setActive=t,this.debug=Yde.create(!0,"annotations"),this.snapping=!1}};C([Kde({changeValue(e){this.setActive(e)}}),Jr()],Cc.prototype,"active",2),C([Jr()],Cc.prototype,"hovered",2),C([Jr()],Cc.prototype,"hoverCoords",2),C([Jr()],Cc.prototype,"copied",2),C([Jr()],Cc.prototype,"snapping",2),C([Jr()],Cc.prototype,"datum",2),C([Jr()],Cc.prototype,"node",2);var{ActionOnSet:qde,LayoutElement:Qde,Menu:Jde,PropertiesArray:eue,ToolbarButtonProperties:tue,Property:ix,ChartAxisDirection:iue}=R,L_=class extends tue{};C([ix],L_.prototype,"value",2);var sx=class extends R.BaseProperties{constructor(e){super(),this.ctx=e,this.enabled=!0,this.padding=20,this.buttons=new eue(L_),this.events=new R.Listeners,this.annotationMenu=new Jde(this.ctx,"annotations"),this.destroyFns=[],this.toolbar=e.sharedToolbar.getSharedToolbar("annotations");const t=this.onKeyDown.bind(this);this.toolbar.addListener("keydown",t),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onToolbarButtonPress.bind(this)),e.layoutManager.registerElement(Qde.ToolbarLeft,this.onLayoutStart.bind(this)),()=>{this.toolbar.removeListener("keydown",t),this.toolbar.destroy()})}destroy(){for(const e of this.destroyFns)e()}addListener(e,t){return this.events.addListener(e,t)}toggleVisibility(e){this.toolbar.setHidden(!e)}toggleClearButtonEnabled(e){const t=this.buttons.findIndex(i=>i.value==="clear");this.toolbar.toggleButtonEnabledByIndex(t,e)}resetButtonIcons(){for(const[e,t]of this.buttons.entries())switch(t.value){case"line-menu":this.updateButtonByIndex(e,{icon:"trend-line-drawing",value:"line-menu"});break;case"fibonacci-menu":this.updateButtonByIndex(e,{icon:"fibonacci-retracement-drawing",value:"fibonacci-menu"});break;case"text-menu":this.updateButtonByIndex(e,{icon:"text-annotation",value:"text-menu"});break;case"shape-menu":this.updateButtonByIndex(e,{icon:"arrow-drawing",value:"shape-menu"});break;case"measurer-menu":this.updateButtonByIndex(e,{icon:"measurer-drawing",value:"measurer-menu"});break}}hideOverlays(){this.annotationMenu.hide()}clearActiveButton(){this.toolbar.clearActiveButton()}dispatch(e,t){this.events.dispatch(e,t)}onLayoutStart(e){this.enabled&&(this.toolbar.updateButtons(this.buttons),this.toolbar.layout(e.layoutBox,this.padding))}refreshButtonsEnabled(e){for(const[t,i]of this.buttons.entries())i&&this.toolbar.toggleButtonEnabledByIndex(t,e)}onToolbarButtonPress({event:e,button:t,buttonBounds:i}){const s=this.ctx.axisManager.getAxisContext(iue.Y)[0].scale;switch(t.value){case"clear":this.dispatch("pressed-clear");break;case"line-menu":this.onToolbarButtonPressShowMenu(e,i,t.value,"toolbarAnnotationsLineAnnotations",Ohe.filter(n=>n.visible?n.visible(s):!0));break;case"fibonacci-menu":this.onToolbarButtonPressShowMenu(e,i,t.value,"toolbarAnnotationsFibonacciAnnotations",Fhe);break;case"text-menu":this.onToolbarButtonPressShowMenu(e,i,t.value,"toolbarAnnotationsTextAnnotations",_he);break;case"shape-menu":this.onToolbarButtonPressShowMenu(e,i,t.value,"toolbarAnnotationsShapeAnnotations",Ghe);break;case"measurer-menu":this.onToolbarButtonPressShowMenu(e,i,t.value,"toolbarAnnotationsMeasurerAnnotations",zhe);break}}onToolbarButtonPressShowMenu(e,t,i,s,n){this.dispatch("pressed-show-menu");const a=this.buttons.findIndex(r=>r.value===i);this.toolbar.toggleActiveButtonByIndex(a),this.annotationMenu.setAnchor({x:t.x+t.width+6,y:t.y}),this.annotationMenu.show({items:n,ariaLabel:this.ctx.localeManager.t(s),class:"ag-charts-annotations__toolbar-menu",sourceEvent:e.sourceEvent,onPress:this.onButtonPressMenuCreateAnnotation.bind(this,i)})}onButtonPressMenuCreateAnnotation(e,t){const i=this.buttons.findIndex(s=>s.value===e);this.updateButtonByIndex(i,{icon:t.icon}),this.dispatch("pressed-create-annotation",{annotation:t.value}),this.annotationMenu.hide()}onKeyDown({sourceEvent:e}){e.key==="Escape"&&this.dispatch("cancel-create-annotation")}updateButtonByIndex(e,t){var s;const i=this.buttons.at(e);i&&(i.set(E(b(b({},i.toJson()),t),{value:(s=t.value)!=null?s:i.value})),this.toolbar.updateButtonByIndex(e,b({},i.toJson())))}};C([ix,qde({changeValue(e){var t;(t=this.toolbar)==null||t.setHidden(!e)}})],sx.prototype,"enabled",2),C([ix],sx.prototype,"padding",2),C([ix],sx.prototype,"buttons",2);var{BaseModuleInstance:sue,InteractionState:Uf,Property:nue,ChartAxisDirection:aue,getIconClassNames:rue}=R,Kf="ag-charts-annotations__axis-button",P_=class extends sue{constructor(e,t,i,s){super(),this.ctx=e,this.axisCtx=t,this.onButtonClick=i,this.seriesRect=s,this.enabled=!0,this.snap=!1,this.padding=0,this.button=this.setup(),this.toggleVisibility(!1),this.updateButtonElement(),this.snap=!!t.scale.bandwidth,e.domManager.addEventListener("focusin",({target:n})=>{const a=n instanceof HTMLElement?n:void 0;!(a&&e.domManager.contains(a,"series-area"))&&a!==this.button.getElement()&&this.hide()}),this.destroyFns.push(e.widgets.seriesWidget.addListener("drag-move",n=>this.onMouseDrag(n)),e.widgets.seriesWidget.addListener("mousemove",n=>this.onMouseMove(n)),e.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseLeave()),e.widgets.seriesDragInterpreter.addListener("click",n=>this.onClick(n)),e.chartEventManager.addListener("series-focus-change",()=>this.onKeyPress()),e.zoomManager.addListener("zoom-pan-start",()=>this.hide()),e.zoomManager.addListener("zoom-change",()=>this.hide()),()=>this.destroyElements(),()=>this.button.destroy())}update(e,t){this.seriesRect=e,this.padding=t}setup(){const e=new Cb.ButtonWidget;return e.addClass(Kf),e.setTabIndex(-1),e.setAriaLabel(this.ctx.localeManager.t("ariaLabelAddHorizontalLine")),this.ctx.widgets.seriesWidget.getElement().appendChild(e.getElement()),e}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",Kf)}onMouseMove(e){this.ctx.interactionManager.isState(Uf.Clickable)&&this.show(e)}onMouseDrag(e){this.ctx.interactionManager.isState(Uf.AnnotationsMoveable)&&this.show(e)}onMouseLeave(){this.ctx.interactionManager.isState(Uf.Clickable)&&this.hide()}onClick(e){this.ctx.interactionManager.isState(Uf.Clickable)&&e.device==="touch"&&this.show(e)}show(e){const{sourceEvent:t,currentX:i,currentY:s}=e;if(!(this.enabled&&this.ctx.widgets.seriesWidget.getElement().contains(t.target))){this.hide();return}this.toggleVisibility(!0);const n=this.getButtonCoordinates({x:i,y:s});this.coords={x:n.x+this.button.clientWidth/2,y:n.y+this.button.clientHeight/2},this.updatePosition(n)}hide(){this.toggleVisibility(!1)}onKeyPress(){this.snap&&this.ctx.interactionManager.isState(Uf.Default)||this.hide()}getButtonCoordinates({x:e,y:t}){const{axisCtx:{direction:i,position:s},seriesRect:n,snap:a,axisCtx:r,padding:o}=this,{clientWidth:l,clientHeight:c}=this.button,[h,d]=[0,n.height],[u,p]=[0,n.width];if(a&&(e=$o(Db(e-n.x,r),r)+n.x,t=$o(Db(t-n.y,r),r)+n.y),i===aue.X){const f=c-Math.max(0,o-5);e=e-l/2,t=s==="top"?h-c+f:d-f}else{const f=l-Math.max(0,o-9);e=s==="left"?u-l+f:p-f,t=t-c/2}return{x:e,y:t}}toggleVisibility(e){const{button:t}=this;if(t==null)return;const i=this.enabled&&e;this.toggleClass("-hidden",!i)}toggleClass(e,t){this.button.toggleClass(`${Kf}-${e}`,t)}updatePosition({x:e,y:t}){this.button.getElement().style.transform=`translate(${Math.round(e)}px, ${Math.round(t)}px)`}updateButtonElement(){const{button:e}=this;e.addListener("click",()=>this.onButtonClick(this.coords)),e.addListener("touchend",()=>this.onButtonClick(this.coords)),e.addListener("drag-start",()=>{}),e.setInnerHTML(`<span class="${rue("zoom-in")} ${Kf}-icon"></span>`)}};C([nue],P_.prototype,"enabled",2);var{Color:E_,DraggablePopover:oue,NativeWidget:zA,Vec2:Xi,createButton:nx,createCheckbox:lue,createSelect:cue,createTextArea:hue,initRovingTabIndex:R_,getIconClassNames:due,mapValues:VA}=R,N_=class HT extends oue{constructor(t,i){super(t,i),this.dragHandleDraggingClass="ag-charts-dialog__drag-handle--dragging",this.colorPicker=new DB(this.ctx,{detached:!0}),this.destroyFns.push(t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(t,i){const s=super.showWithChildren(t,i);return s.classList.add("ag-charts-dialog"),s.setAttribute("role","dialog"),s.addEventListener("mousedown",n=>{var a;(a=n.target.classList)!=null&&a.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),s.addEventListener("keydown",this.onKeyDown.bind(this)),Ct().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),s}updatePosition(t){var n;super.updatePosition(t);const{anchor:i,fallbackAnchor:s}=(n=this.getColorPickerAnchors())!=null?n:{};i&&this.colorPicker.setAnchor(i,s)}createTabs(t,i,s){const n=ke("div","ag-charts-dialog__tabs"),a=VA(s,()=>sh()),r=VA(s,()=>sh());for(const[p,g]of Zt(s))bo(g.panel,{id:r[p],role:"tabpanel","aria-labelledby":a[p]});const o=p=>{var g;for(const[f,y]of Zt(s))y.panel.classList.toggle("ag-charts-dialog__tab-panel--active",f===p),h[f].classList.toggle("ag-charts-dialog__tab-button--active",f===p),$e(h[f],"aria-selected",f===p),f===p&&((g=y.onShow)==null||g.call(y))},l=new zA(ke("div","ag-charts-dialog__header"));l.addListener("drag-start",p=>{const{sourceEvent:g}=p;g.target instanceof Element&&g.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(p)}),l.addListener("drag-move",p=>this.onDragMove(p)),l.addListener("drag-end",()=>this.onDragEnd());const c=new pue;this.setDragHandle(c);const h=VA(s,(p,g)=>nx({label:this.ctx.localeManager.t(p.label),onPress:()=>o(g)},{id:a[g],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":r[g]})),d=ke("div","ag-charts-dialog__tab-list");bo(d,{role:"tablist","aria-label":this.ctx.localeManager.t(t)}),d.append(...Object.values(h));const u=this.createHeaderCloseButton();return l.getElement().append(c.getElement(),d,u),n.append(l.getElement(),...Object.values(s).map(p=>p.panel)),o(i),R_({orientation:"horizontal",buttons:Object.values(h)}),{tabs:n,initialFocus:h[i]}}createTabPanel(){return ke("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return ke("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:t,options:i,value:s,onChange:n}){const a=this.createInputGroup(t);bo(a,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(t)});const r="ag-charts-dialog__button--active",o=[];for(const l of i){const{icon:c,altText:h}=l,d=this.ctx.localeManager.t(h),u=nx({icon:c,altText:d,onPress:()=>{for(const p of Array.from(a.children))p.classList.remove(r),p.ariaChecked="false";u.classList.add(r),u.ariaChecked="true",n(l.value)}},{"aria-checked":l.value===s,class:"ag-charts-dialog__button",role:"radio",title:d});l.value===s&&u.classList.add(r),a.appendChild(u),o.push(u)}return R_({orientation:"horizontal",buttons:o}),a}createSelect({altText:t,label:i,options:s,value:n,onChange:a}){const r=this.createInputGroup(i),o=this.ctx.localeManager.t(t),l=cue({value:n,options:s,onChange:a},{class:"ag-charts-dialog__select","aria-label":o,title:o});return r.append(l),r}createTextArea({placeholder:t,value:i,onChange:s}){const n=t?this.ctx.localeManager.t(t):void 0;return hue({value:i,onChange:s},{placeholder:n})}createCheckbox({label:t,checked:i,onChange:s}){const n=sh(),a=this.createInputGroup(t,{for:n}),r=lue({checked:i,onChange:s},{class:"ag-charts-dialog__checkbox",role:"switch",id:n});return a.append(r),a}createColorPicker({color:t,opacity:i,label:s,altText:n,onChange:a,onChangeHide:r,isMultiColor:o,hasMultiColorOption:l}){const c=this.createInputGroup(s),h=this.ctx.localeManager.t(n),d=nx({label:h,onPress:u=>{var f;const{anchor:p,fallbackAnchor:g}=(f=this.getColorPickerAnchors(d))!=null?f:{};this.colorPicker.show({anchor:p,fallbackAnchor:g,color:t,opacity:i,isMultiColor:o,hasMultiColorOption:l,sourceEvent:u,onChange:(y,v,x,S)=>{d.style.setProperty("--color",y),d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color",S),a(y,v,x,S)},onChangeHide:r})}},{"aria-label":h,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:h});if(o)d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color");else if(t){const u=E_.fromString(t),p=new E_(u.r,u.g,u.b,i);d.style.setProperty("--color",p.toHexString())}return c.append(d),this.hideFns.push(()=>{this.colorPicker.hide()}),c}createHeaderCloseButton(){return nx({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(t,i){const s=ke("div","ag-charts-dialog__input-group"),n=ke("label","ag-charts-dialog__input-group-label");return n.innerText=this.ctx.localeManager.t(t),$e(n,"for",i==null?void 0:i.for),s.appendChild(n),s}onLayoutComplete(t){this.seriesRect=t.series.paddedRect,this.reposition()}onKeyDown(t){t.altKey||t.ctrlKey||t.metaKey||t.isComposing||t.key!=="Escape"||this.hide()}reposition(){const{seriesRect:t,ctx:i}=this,s=i.domManager.getBoundingClientRect(),n=this.getPopoverElement();if(!t||!n)return;const a=Xi.from(0,t.y),r=Xi.from(s.width,t.height),o=Xi.from(n),l=Xi.from(.5,1);let c;if(t.width>1e3){const h=Xi.sub(Xi.add(a,Xi.multiply(r,l)),Xi.multiply(o,l));c=Xi.sub(h,Xi.from(0,HT.offset))}else{const h=Xi.sub(Xi.add(a,r),o);c=Xi.sub(h,HT.offset)}this.updatePosition(c)}getColorPickerAnchors(t){if(t&&(this.colorPickerAnchorElement=t),!this.colorPickerAnchorElement)return;const i=this.colorPickerAnchorElement.getBoundingClientRect(),s=this.ctx.domManager.getBoundingClientRect(),n=Xi.sub(Xi.from(i.x,i.y),Xi.from(s.left,s.top)),a=Xi.add(n,Xi.from(0,i.height+5)),r=Xi.sub(n,Xi.from(0,5));return{anchor:a,fallbackAnchor:r}}};N_.offset=60;var uue=N_,pue=class extends zA{constructor(){super(ke("div","ag-charts-dialog__drag-handle"));const e=new zA(ke("span",due("drag-handle")));e.setAriaHidden(!0),this.addChild(e)}},{Listeners:gue,focusCursorAtEnd:fue}=R,mue=class extends uue{constructor(e){super(e,"settings"),this.events=new gue,this.hideFns.push(()=>this.events.dispatch("hidden"))}addListener(e,t){return this.events.addListener(e,t)}show(e,t){const i=this.createLinearLineTab(e,t),s=this.createLinearTextTab(e,t);let n="dialogHeaderLine";el(e)?n="dialogHeaderChannel":CB(e)?n="dialogHeaderFibonacciRange":e.type==="date-range"?n="dialogHeaderDateRange":e.type==="price-range"?n="dialogHeaderPriceRange":e.type==="date-price-range"&&(n="dialogHeaderDatePriceRange");const{tabs:a,initialFocus:r}=this.createTabs("ariaLabelSettingsTabBar",t.initialSelectedTab,{line:{label:n,panel:i},text:{label:"dialogHeaderText",panel:s.panel,onShow:s.onShow}});t.initialFocus=r,this.showWithChildren([a],t).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(e,t){var c,h,d,u,p,g,f,y,v,x,S;const i=this.createTabPanel(),s=this.createInputGroupLine(),n=this.createInputGroupLine(),a="isMultiColor"in e,r=this.createColorPickerInput("line-color",e.getDefaultColor("line-color"),e.getDefaultOpacity("line-color"),a?e.isMultiColor:!1,a,t.onChangeLineColor,t.onChangeHideLineColor),o=this.createStrokeWidthSelect((c=e.strokeWidth)!=null?c:2,t.onChangeLineStyleWidth),l=this.createLineStyleRadioGroup((h=e.lineStyle)!=null?h:"solid",t.onChangeLineStyleType);if(s.append(r),"background"in e){const M=this.createColorPickerInput("fill-color",e.getDefaultColor("fill-color"),e.getDefaultOpacity("fill-color"),!1,!1,t.onChangeFillColor,t.onChangeHideFillColor);s.append(M),n.append(o)}else"showFill"in e?(s.append(this.createCheckbox({label:"dialogInputShowFill",checked:(d=e.showFill)!=null?d:!0,onChange:M=>t.onChangeLine({showFill:M})})),n.append(o)):s.append(o);return n.append(l),i.append(s,n),"bands"in e&&i.append(this.createFibonacciRatioSelect((u=e.bands)!=null?u:10,M=>t.onChangeLine({bands:M}))),"extendStart"in e&&"extendEnd"in e&&i.append(this.createCheckbox({label:el(e)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:(p=e.extendStart)!=null?p:!1,onChange:M=>t.onChangeLine({extendStart:M})}),this.createCheckbox({label:el(e)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:(g=e.extendEnd)!=null?g:!1,onChange:M=>t.onChangeLine({extendEnd:M})})),"extendAbove"in e&&"extendBelow"in e&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:(f=e.extendAbove)!=null?f:!1,onChange:M=>t.onChangeLine({extendAbove:M})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:(y=e.extendBelow)!=null?y:!1,onChange:M=>t.onChangeLine({extendBelow:M})})),"extendLeft"in e&&"extendRight"in e&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:(v=e.extendLeft)!=null?v:!1,onChange:M=>t.onChangeLine({extendLeft:M})}),this.createCheckbox({label:"dialogInputExtendRight",checked:(x=e.extendRight)!=null?x:!1,onChange:M=>t.onChangeLine({extendRight:M})})),"reverse"in e&&"showFill"in e&&i.append(this.createCheckbox({label:"dialogInputReverse",checked:(S=e.reverse)!=null?S:!1,onChange:M=>t.onChangeLine({reverse:M})})),i}createLinearTextTab(e,t){var h;const i=this.createTabPanel(),s=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:e.text.label,onChange:d=>t.onChangeText({label:d})}),n=this.createFontSizeSelect(e.text.fontSize,t.onChangeTextFontSize),a=this.createColorPickerInput("text-color",e.text.color,1,!1,!1,t.onChangeTextColor,t.onChangeHideTextColor),r=e.text.position==="inside"?"center":e.text.position,o=this.createPositionRadioGroup(r!=null?r:"top",d=>t.onChangeText({position:d})),l=this.createAlignmentRadioGroup((h=e.text.alignment)!=null?h:"center",d=>t.onChangeText({alignment:d})),c=this.createInputGroupLine();return c.append(n,a,o,l),i.append(s,c),{panel:i,onShow:()=>fue(s)}}createColorPickerInput(e,t,i,s,n,a,r){const o=e==="fill-color"?"dialogInputFillColorPicker":"dialogInputColorPicker",l=e==="fill-color"?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText";return this.createColorPicker({label:o,altText:l,color:t,opacity:i,isMultiColor:s,hasMultiColorOption:n,onChange:a,onChangeHide:r})}createStrokeWidthSelect(e,t){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:AB.map(({label:i,value:s})=>({label:i,value:`${s}`})),value:String(e),onChange:i=>t(Number(i))})}createFibonacciRatioSelect(e,t){return this.createSelect({label:"dialogInputFibonacciBands",altText:"dialogInputFibonacciBandsAltText",options:Bhe.map(({label:i,value:s})=>({label:i,value:`${s}`})),value:String(e),onChange:i=>t(Number(i))})}createLineStyleRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:e,onChange:t})}createFontSizeSelect(e,t){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:IB.map(({label:i,value:s})=>({label:i,value:String(s)})),value:String(e),onChange:i=>t(Number(i))})}createPositionRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:e,onChange:t})}createAlignmentRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:e,onChange:t})}};function jA(e){return e.gridPadding+e.seriesAreaPadding+e.tickSize+e.label.spacing}function yue(e,t,i){for(const{update:s}of Object.values(sa))s(e,t,i)}var{ChartUpdateType:vue,InteractionState:Fn,ObserveChanges:bue,PropertiesArray:xue,Property:$f,ChartAxisDirection:Cue,Vec2:ad,keyProperty:Sue,valueProperty:Mue,Selection:Due,BBox:wue}=R,rp=class Wj extends R.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,this.toolbar=new sx(this.ctx),this.optionsToolbar=new xA(this.ctx,()=>{const i=this.state.getActive();if(i!=null)return nd(this.annotationData.at(i))}),this.axesButtons=new eA,this.snap=!1,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new xue(Wj.createAnnotationDatum),this.defaults=new Rhe,this.container=new R.Group({name:"static-annotations"}),this.annotations=new Due(this.container,this.createAnnotationScene.bind(this)),this.settingsDialog=new mue(this.ctx),this.textInput=new Kce(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.setupDOM(),this.ctx.historyManager.addMementoOriginator(t.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this))}setupStateMachine(){const{ctx:t}=this;return new tx({resetToIdle:()=>{t.domManager.updateCursor("annotations"),this.popAnnotationState(Fn.Annotations),this.hideOverlays(),this.optionsToolbar.hide(),this.deleteEphemeralAnnotations(),this.update()},hoverAtCoords:(i,s,n)=>{var r;let a;return this.annotations.each((o,l,c)=>{const h=o.containsPoint(i.x,i.y);h&&(a!=null||(a=c)),o.toggleHovered(h||s===c)}),a!=null?t.tooltipManager.suppressTooltip("annotations"):this.isAnnotationState()||t.tooltipManager.unsuppressTooltip("annotations"),this.ctx.domManager.updateCursor("annotations",a==null||(r=this.annotations.at(a))==null?void 0:r.getCursor()),a!==n&&this.update(),a},getNodeAtCoords:(i,s)=>{const n=this.annotations.at(s);if(n)return n.getNodeAtCoords(i.x,i.y)},translate:(i,s)=>{const n=this.annotations.at(i),a=nd(this.annotationData.at(i));if(!(!n||!a))return this.translateNode(n,a,s)},copy:i=>{const s=this.annotations.at(i),n=nd(this.annotationData.at(i));if(!(!s||!n))return this.createAnnotationDatumCopy(s,n)},paste:i=>{this.createAnnotation(i.type,i,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(i,s)=>{const{annotations:n,optionsToolbar:a,toolbar:r}=this;this.hideOverlays(),r.clearActiveButton(),r.resetButtonIcons();const o=i!=null?n.at(i):null,l=s!=null?n.at(s):null;l===o&&o!=null||(l==null||l.toggleActive(!1),a.hide(),o?(this.pushAnnotationState(Fn.AnnotationsSelected),o.toggleActive(!0),a.updateButtons(this.annotationData.at(i)),this.postUpdateFns.push(()=>{a.show(),a.setAnchorScene(o)})):(this.popAnnotationState(Fn.AnnotationsSelected),this.popAnnotationState(Fn.Annotations)),this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.pushAnnotationState(Fn.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.pushAnnotationState(Fn.Annotations)},stopInteracting:()=>{this.popAnnotationState(Fn.Annotations)},create:(i,s)=>{this.createAnnotation(i,s)},delete:i=>{this.annotationData.splice(i,1)},deleteAll:()=>{this.annotationData.splice(0,this.annotationData.length)},validatePoint:(i,s)=>{const n=this.getAnnotationContext();return n?Ub(n,i,s):!0},getAnnotationType:i=>Xce(this.annotationData[i].type),datum:i=>this.annotationData.at(i),node:i=>this.annotations.at(i),recordAction:i=>{this.recordActionAfterNextUpdate(i)},update:()=>{this.postUpdateFns.push(()=>{const i=this.state.getActive(),s=i!=null?this.annotations.at(i):null;s!=null&&this.optionsToolbar.setAnchorScene(s)}),this.update()},showTextInput:i=>{const s=nd(this.annotationData.at(i));if(!this.annotations.at(i)||!s||!("getTextInputCoords"in s)||!("getTextPosition"in s))return;const a={color:s.color,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight,placeholderColor:s.getPlaceholderColor()},r=this.getAnnotationContext(),o=c=>ad.add(s.getTextInputCoords(r,c),ad.required(this.seriesRect)),l=()=>s.getTextPosition();this.textInput.show({styles:a,layout:{getTextInputCoords:o,getTextPosition:l,alignment:s.alignment,textAlign:s.textAlign,width:s.width},text:s.text,placeholderText:s.placeholderText,onChange:(c,h)=>{this.state.transition("updateTextInputBBox",h)}}),this.ctx.domManager.updateCursor("annotations")},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:i=>{this.textInput.updateColor(i)},updateTextInputFontSize:i=>{const s=this.textInput.updateFontSize(i);this.state.transition("updateTextInputBBox",s)},updateTextInputBBox:i=>{this.state.transition("updateTextInputBBox",i)},showAnnotationOptions:i=>{const s=this.annotations.at(i);!s||cc(this.annotationData.at(i))||(this.optionsToolbar.updateButtons(this.annotationData.at(i)),this.optionsToolbar.show(),this.optionsToolbar.setAnchorScene(s))},showAnnotationSettings:(i,s,n="line")=>{const a=this.annotationData.at(i);if(!Eb(a)&&!el(a)&&!zf(a)||cc(a))return;const r=c=>(h,d,u,p)=>{this.setColorAndDefault(a.type,c,h,d,u,p),this.optionsToolbar.updateColorPickerColor(c,d,u,p)},o=c=>()=>{this.recordActionAfterNextUpdate(`Change ${a.type} ${c} to ${a.getDefaultColor(c)}`,["annotations","defaults"]),this.update()},l={initialSelectedTab:n,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:s,onChangeLine:c=>{this.state.transition("lineProps",c),c.bands!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"bands",c.bands),c.reverse!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"reverse",c.reverse),c.showFill!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"showFill",c.showFill)},onChangeText:c=>{this.state.transition("lineText",c),c.alignment&&this.defaults.setDefaultLineTextAlignment(a.type,c.alignment),c.position&&this.defaults.setDefaultLineTextPosition(a.type,c.position),this.recordActionAfterNextUpdate(`Change ${a.type} text ${Object.keys(c).map(h=>`${h} to ${c[h]}`).join(", ")}`)},onChangeFillColor:r("fill-color"),onChangeHideFillColor:o("fill-color"),onChangeLineColor:r("line-color"),onChangeHideLineColor:o("line-color"),onChangeLineStyleType:c=>{var h;this.setLineStyleTypeAndDefault(a.type,c),this.optionsToolbar.updateLineStyleType((h=Vf.find(d=>d.value===c))!=null?h:Vf[0])},onChangeLineStyleWidth:c=>{this.setLineStyleWidthAndDefault(a.type,c),this.optionsToolbar.updateStrokeWidth({strokeWidth:c,value:c,label:String(c)})},onChangeTextColor:r("text-color"),onChangeHideTextColor:o("text-color"),onChangeTextFontSize:c=>{this.setFontSizeAndDefault(a.type,c)}};this.settingsDialog.show(a,l)}})}setupListeners(){const{ctx:t,optionsToolbar:i,settingsDialog:s,toolbar:n}=this,{seriesWidget:a,seriesDragInterpreter:r,chartWidget:o}=t.widgets;this.destroyFns.push(r.addListener("click",this.hoverTouchPreHandler.bind(this)),r.addListener("drag-start",this.hoverTouchPreHandler.bind(this)),r.addListener("drag-move",this.dragMoveTouchPreHandler.bind(this)),r.addListener("mousemove",this.onHover.bind(this)),r.addListener("click",this.onClick.bind(this)),r.addListener("dblclick",this.onDoubleClick.bind(this)),r.addListener("drag-start",this.onDragStart.bind(this)),r.addListener("drag-move",this.onDrag.bind(this)),r.addListener("drag-end",this.onDragEnd.bind(this)),a.addListener("keydown",this.onKeyDown.bind(this)),a.addListener("keyup",this.onKeyUp.bind(this)),o.addListener("click",this.onCancel.bind(this)),t.annotationManager.addListener("restore-annotations",this.onRestoreAnnotations.bind(this)),t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),t.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),t.zoomManager.addListener("zoom-change",()=>this.onResize()),t.domManager.addListener("resize",()=>this.onResize()),n.addListener("cancel-create-annotation",()=>{this.cancel(),this.reset(),this.update()}),n.addListener("pressed-create-annotation",({annotation:l})=>{this.cancel(),this.pushAnnotationState(Fn.Annotations),this.state.transition(l),this.update()}),n.addListener("pressed-clear",()=>{this.clear(),this.recordActionAfterNextUpdate("Clear all")}),n.addListener("pressed-show-menu",()=>{this.cancel(),this.reset()}),n.addListener("pressed-unrelated",()=>{this.reset()}),i.addListener("pressed-delete",()=>{this.cancel(),this.delete(),this.reset()}),i.addListener("pressed-settings",({sourceEvent:l})=>{this.state.transition("toolbarPressSettings",l)}),i.addListener("pressed-lock",()=>{this.update()}),i.addListener("hid-overlays",()=>{this.settingsDialog.hide()}),i.addListener("saved-color",({type:l,colorPickerType:c,color:h})=>{this.recordActionAfterNextUpdate(`Change ${l} ${c} to ${h}`,["annotations","defaults"])}),i.addListener("updated-color",({type:l,colorPickerType:c,colorOpacity:h,color:d,opacity:u,isMultiColor:p})=>{this.setColorAndDefault(l,c,h,d,u,p)}),i.addListener("updated-font-size",({type:l,fontSize:c})=>{this.setFontSizeAndDefault(l,c)}),i.addListener("updated-line-style",({type:l,lineStyleType:c})=>{this.setLineStyleTypeAndDefault(l,c)}),i.addListener("updated-line-width",({type:l,strokeWidth:c})=>{this.setLineStyleWidthAndDefault(l,c)}),s.addListener("hidden",()=>{this.optionsToolbar.clearActiveButton()}))}setupDOM(){const{ctx:t,toolbar:i}=this;this.destroyFns.push(t.annotationManager.attachNode(this.container),()=>t.domManager.removeStyles(Kf),()=>i.destroy())}async processData(t){if(!this.enabled||this.data==null||this.xKey==null||this.volumeKey==null)return;const i=[Sue(this.xKey,void 0,{id:"date"}),Mue(this.volumeKey,"number",{id:"volume"})],{dataModel:s,processedData:n}=await t.request("annotations",this.data,{props:i});this.dataModel=s,this.processedData=n}createAnnotationScene(t){if(t.type in sa)return new sa[t.type].scene;throw new Error(`AG Charts - Cannot create annotation scene of type [${t.type}], expected one of [${Object.keys(sa)}], ignoring.`)}static createAnnotationDatum(t){if(t.type in sa)return new sa[t.type].datum().set(t);throw new Error(`AG Charts - Cannot create annotation datum of unknown type [${t.type}], expected one of [${Object.keys(sa)}], ignoring.`)}createAnnotation(t,i,s=!0){if(this.annotationData.push(i),s){const n=this.ctx.annotationManager.getAnnotationTypeStyles(t);n&&i.set(n),this.defaults.applyDefaults(i)}this.injectDatumDependencies(i),this.update()}injectDatumDependencies(t){"setLocaleManager"in t&&t.setLocaleManager(this.ctx.localeManager),"getVolume"in t&&(t.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(t,i){const{dataModel:s,processedData:n}=this;let a=Yi(t),r=Yi(i);if(!Vd(a)||!Vd(r)||!s||!n||this.volumeKey==null)return;a>r&&([a,r]=[r,a]);const o=s.resolveKeysById({id:"annotations"},"date",n),l=s.resolveColumnById({id:"annotations"},"volume",n);let c=0;for(let h=0;h<n.input.count;h++){const d=o[h];Vd(d)&&d>=a&&d<=r&&(c+=l[h])}return c}translateNode(t,i,s){const n=this.getAnnotationConfig(i),a=this.getAnnotationContext();a&&n.translate(t,i,s,a)}createAnnotationDatumCopy(t,i){const s=this.getAnnotationConfig(i),n=new s.datum;n.set(i.toJson());const a=this.getAnnotationContext();if(a)return s.copy(t,i,n,a)}getAnnotationConfig(t){if(t.type in sa)return sa[t.type];throw new Error(`AG Charts - Cannot get annotation config of unknown type [${t.type}], expected one of [${Object.keys(sa)}], ignoring.`)}onRestoreAnnotations(t){this.enabled&&(this.clear(),this.annotationData.set(t.annotations),this.postUpdateFns.push(()=>{this.ctx.annotationManager.fireChangedEvent()}),this.update())}onLayoutComplete(t){var s,n,a;const i=t.series.paddedRect;this.seriesRect=i,this.container.setClipRect(i);for(const r of(s=t.axes)!=null?s:[])r.direction===R.ChartAxisDirection.X?this.xAxis=this.getAxis(r,i,(n=this.xAxis)==null?void 0:n.button):this.yAxis=this.getAxis(r,i,(a=this.yAxis)==null?void 0:a.button);this.showAnnotations()?this.animateAnnotations({from:0,to:1,phase:"trailing"}):this.animateAnnotations({from:1,to:0,phase:"remove"})}showAnnotations(){if(!this.yAxis||!this.xAxis)return!1;const t=this.ctx.chartService.series.some(n=>n.hasData),s=this.yAxis.context.seriesIds().some(n=>{const a=this.ctx.chartService.series.find(r=>r.id===n);return a==null?void 0:a.visible});return t&&s}animateAnnotations({from:t,to:i,phase:s}){var a;const{annotations:n}=this;(a=this.ctx.animationManager)==null||a.animate({from:t,to:i,id:"chart-annotations",phase:s,groupId:"opacity",onUpdate(r){n.each(o=>{o.opacity=r,"setAxisLabelOpacity"in o&&o.setAxisLabelOpacity(r)})},onStop(){n.each(r=>{r.opacity=i,"setAxisLabelOpacity"in r&&r.setAxisLabelOpacity(i)})}})}onPreRender(){this.updateAnnotations(),this.state.transition("render")}getAxis(t,i,s){const n=this.ctx.axisManager.getAxisContext(t.direction)[0],{position:a="bottom",direction:r}=n,o=t.gridPadding+t.seriesAreaPadding,l=new wue(0,0,i.width,i.height).grow(o,a),c=n.direction===Cue.X?"vertical":"horizontal",{axesButtons:h,snap:d}=this;if(this.enabled&&h.enabled&&(h.axes==="xy"||h.axes===r)){s!=null||(s=new P_(this.ctx,E(b({},n),{snapToGroup:d}),g=>this.onAxisButtonClick(g,c),i));const p=jA(t);s.update(i,p)}else s==null||s.destroy(),s=void 0;return{layout:t,context:n,bounds:l,button:s}}recordActionAfterNextUpdate(t,i=["annotations"]){const{defaults:s,ctx:{annotationManager:n,historyManager:a}}=this,r=i.map(o=>o==="defaults"?s:n);this.postUpdateFns.push(()=>{a.record(t,...r),n.fireChangedEvent()})}setColorAndDefault(t,i,s,n,a,r){this.state.transition("color",{colorPickerType:i,colorOpacity:s,color:n,opacity:a,isMultiColor:r}),this.defaults.setDefaultColor(t,i,s,n,a,r)}setFontSizeAndDefault(t,i){this.state.transition("fontSize",i),this.defaults.setDefaultFontSize(t,i),this.recordActionAfterNextUpdate(`Change ${t} font size to ${i}`,["annotations","defaults"])}setLineStyleTypeAndDefault(t,i){this.state.transition("lineStyle",{type:i}),this.defaults.setDefaultLineStyleType(t,i),this.recordActionAfterNextUpdate(`Change ${t} line style to ${i}`,["annotations","defaults"])}setLineStyleWidthAndDefault(t,i){this.state.transition("lineStyle",{strokeWidth:i}),this.defaults.setDefaultLineStyleWidth(t,i),this.recordActionAfterNextUpdate(`Change ${t} stroke width to ${i}`,["annotations","defaults"])}updateAnnotations(){const{annotationData:t,annotations:i,seriesRect:s,ctx:{annotationManager:n}}=this,a=this.getAnnotationContext();if(!s||!a)return;n.updateData(t.toJson().filter(o=>!cc(o)));const r=this.showAnnotations();this.toolbar.refreshButtonsEnabled(r),this.toolbar.toggleClearButtonEnabled(t.length>0&&r),i.update(t!=null?t:[],void 0,o=>o.id).each((o,l)=>{if(!r){o.visible=!1,"setAxisLabelVisible"in o&&o.setAxisLabelVisible(!1);return}"setAxisLabelVisible"in o&&o.setAxisLabelVisible(!0),this.injectDatumDependencies(l),yue(o,l,a)}),this.postUpdateFns.forEach(o=>o()),this.postUpdateFns=[]}getAnnotationContext(){const{seriesRect:t,xAxis:i,yAxis:s,snap:n}=this;if(t&&i&&s)return{seriesRect:t,xAxis:E(b({},i.context),{bounds:i.bounds,labelPadding:jA(i.layout),snapToGroup:n}),yAxis:E(b({},s.context),{bounds:s.bounds,labelPadding:jA(i.layout),snapToGroup:n})}}onHover(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const n=t.sourceEvent.shiftKey,a=ad.from(t),r=vn(a,s);i.transition("hover",{offset:a,point:r,shiftKey:n,context:s})}onClick(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const n=t.sourceEvent.shiftKey,a=vn(ad.from(t),s),r=this.textInput.getValue(),o=this.textInput.getBBox();i.transition("click",{point:a,shiftKey:n,textInputValue:r,bbox:o})}onDoubleClick(t){const{state:i}=this;if(!this.getAnnotationContext())return;const n=ad.from(t);i.transition("dblclick",{offset:n})}onAxisButtonClick(t,i){this.cancel(),this.reset();const s=this.getAnnotationContext();if(!this.annotationData||!s)return;const{state:n}=this;this.pushAnnotationState(Fn.Annotations);const a=i==="horizontal";if(n.transition(a?"horizontal-line":"vertical-line"),this.optionsToolbar.hide(),!t)return;const r=vn(t,s);Ub(s,r)&&(n.transition("click",{point:r,shiftKey:!1}),this.update())}onResize(){const t=this.textInput.getValue(),i=this.textInput.getBBox();this.state.transition("resize",{textInputValue:t,bbox:i})}hoverTouchPreHandler(t){t.device==="touch"&&this.onHover(t)}dragMoveTouchPreHandler(t){t.device==="touch"&&this.ctx.interactionManager.isState(Fn.AnnotationsSelected)&&t.sourceEvent.preventDefault()}onDragStart(t){if(!this.ctx.interactionManager.isState(Fn.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const s=ad.from(t),n=vn(s,i),a=this.textInput.getValue(),r=this.textInput.getBBox();this.state.transition("dragStart",{context:i,offset:s,point:n,textInputValue:a,bbox:r})}onDrag(t){if(!this.ctx.interactionManager.isState(Fn.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const s=ad.from(t),n=vn(s,i),a=t.sourceEvent.shiftKey,r=this.textInput.getValue(),o=this.textInput.getBBox();this.state.transition("drag",{context:i,offset:s,point:n,shiftKey:a,textInputValue:r,bbox:o})}onDragEnd(){this.state.transition("dragEnd")}onCancel(t){const{sourceEvent:i}=t!=null?t:{};(i==null?void 0:i.currentTarget)===(i==null?void 0:i.target)&&(this.cancel(),this.reset())}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const{key:n,shiftKey:a}=t,r=this.textInput.getValue(),o=this.textInput.getBBox();i.transition("textInput",{key:n,shiftKey:a,textInputValue:r,bbox:o,context:s})}onKeyDown(t){var p,g;const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const{sourceEvent:n}=t,{shiftKey:a,ctrlKey:r,metaKey:o}=n,l=r||o,c=r||a;i.transition("keyDown",{shiftKey:a,context:s});const h={x:0,y:0},d=Math.max((p=s==null?void 0:s.xAxis.scale.bandwidth)!=null?p:0,c?10:1),u=Math.max((g=s==null?void 0:s.yAxis.scale.bandwidth)!=null?g:0,c?10:1);switch(n.key){case"ArrowDown":h.y=u;break;case"ArrowUp":h.y=-u;break;case"ArrowLeft":h.x=-d;break;case"ArrowRight":h.x=d;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((h.x||h.y)&&(i.transition("translate",{translation:h}),n.stopPropagation(),n.preventDefault()),!!l)switch(n.key){case"c":i.transition("copy");return;case"x":i.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":i.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(t){const{shiftKey:i}=t.sourceEvent,s=this.getAnnotationContext();s&&(this.state.transition("keyUp",{shiftKey:i,context:s}),this.state.transition("translateEnd"))}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){for(const[t,i]of this.annotationData.entries())cc(i)&&this.annotationData.splice(t,1)}hideOverlays(){this.settingsDialog.hide(),this.toolbar.hideOverlays(),this.optionsToolbar.hideOverlays()}pushAnnotationState(t){this.ctx.interactionManager.pushState(t),this.ctx.tooltipManager.suppressTooltip("annotations")}popAnnotationState(t){this.ctx.interactionManager.popState(t),this.ctx.tooltipManager.unsuppressTooltip("annotations")}isAnnotationState(){return this.ctx.interactionManager.isState(Fn.Annotations)||this.ctx.interactionManager.isState(Fn.AnnotationsSelected)}update(t=vue.PRE_SCENE_RENDER){this.ctx.updateService.update(t)}};C([bue((e,t,i)=>{var a;const{ctx:{annotationManager:s,stateManager:n}}=e;t!==i&&((a=e.toolbar)==null||a.toggleVisibility(!!t),i===!1&&t===!0?n.restoreState(s):t===!1&&e.clear())}),$f],rp.prototype,"enabled",2),C([$f],rp.prototype,"toolbar",2),C([$f],rp.prototype,"optionsToolbar",2),C([$f],rp.prototype,"axesButtons",2),C([$f],rp.prototype,"snap",2);var Aue=rp,{FONT_SIZE_RATIO:Iue,ThemeSymbols:Ps}=R,_a={stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:2},Es={fill:Ps.DEFAULT_ANNOTATION_HANDLE_FILL,strokeOpacity:1,strokeWidth:2},rd={color:{$ref:"backgroundColor"},fontSize:{$rem:[Iue.LARGE]},fontFamily:{$ref:"fontFamily"}},O_=E(b({},rd),{enabled:!0,fill:{$ref:"foregroundColor"},fontSize:{$ref:"fontSize"}}),ax=E(b({},rd),{textAlign:"left"}),od=E(b({},rd),{position:"top",alignment:"center",color:{$ref:"textColor"}}),F_=E(b({},rd),{position:"top",alignment:"center",color:{$ref:"textColor"}}),HA=E(b({},rd),{fontSize:{$ref:"fontSize"},color:Ps.DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:Ps.DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:Ps.DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:Ps.DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}}),WA=E(b({},_a),{background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:b({},Es),text:b({},od),statistics:b({},HA)}),Tue={buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}],padding:{$ref:"padding"}},kue={buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color"},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color"},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color"},{tooltip:"toolbarAnnotationsTextSize",value:"text-size"},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width"},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type"},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings"},{icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]},Lue={enabled:!1,line:E(b({},_a),{handle:b({},Es),text:b({},od)}),"horizontal-line":E(b({},_a),{handle:b({},Es),axisLabel:b({},O_),text:b({},od)}),"vertical-line":E(b({},_a),{handle:b({},Es),axisLabel:b({},O_),text:b({},od)}),"disjoint-channel":E(b({},_a),{background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:b({},Es),text:b({},F_)}),"parallel-channel":E(b({},_a),{middle:{lineDash:[6,5],strokeWidth:1},background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:b({},Es),text:b({},F_)}),"fibonacci-retracement":E(b({},_a),{strokes:Ps.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:b({},Es),text:E(b({},od),{position:"center"}),label:E(b({},rd),{color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}})}),"fibonacci-retracement-trend-based":E(b({},_a),{strokes:Ps.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:b({},Es),text:E(b({},od),{position:"center"}),label:E(b({},rd),{color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}})}),callout:E(b(b({},_a),ax),{color:{$ref:"textColor"},handle:b({},Es),fill:{$ref:"foregroundColor"},fillOpacity:.075}),comment:E(b({},ax),{fontWeight:700,handle:b({},Es),fill:{$ref:"foregroundColor"}}),note:E(b({},ax),{color:Ps.DEFAULT_TEXTBOX_COLOR,fill:Ps.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,stroke:{$ref:"backgroundColor"},strokeWidth:1,strokeOpacity:1,handle:b({},Es),background:{fill:Ps.DEFAULT_TEXTBOX_FILL,stroke:Ps.DEFAULT_TEXTBOX_STROKE,strokeWidth:1}}),text:E(b({},ax),{color:{$ref:"textColor"},handle:b({},Es)}),arrow:E(b({},_a),{handle:b({},Es),text:b({},od)}),"arrow-up":{fill:{$palette:"up.fill"},handle:E(b({},Es),{stroke:{$ref:"foregroundColor"}})},"arrow-down":{fill:{$palette:"down.fill"},handle:E(b({},Es),{stroke:{$ref:"foregroundColor"}})},"date-range":b({},WA),"price-range":b({},WA),"date-price-range":b({},WA),"quick-date-price-range":{up:E(b({},_a),{fill:Ps.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:b({},Es),statistics:E(b({},HA),{color:"#fff",fill:Ps.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}})}),down:E(b({},_a),{stroke:Ps.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:Ps.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:E(b({},Es),{stroke:Ps.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE}),statistics:E(b({},HA),{color:"#fff",fill:Ps.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}})})},axesButtons:{},toolbar:Tue,optionsToolbar:kue},Pue={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new Aue(e),themeTemplate:{annotations:Lue}},{BaseProperties:Eue,ObserveChanges:Rue,ProxyProperty:Nue,Property:ld,calculatePlacement:Oue}=R,eo=class extends Eue{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{var e;this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),(e=this.onLoad)==null||e.call(this))},this.imageElement=ke("img"),this.imageElement.onload=this.onImageLoad,this.node=new R.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(e,t){this.containerWidth=e,this.containerHeight=t;const i={width:e,height:t},s=Oue(this.imageElement.width,this.imageElement.height,i,this);return this.node.setProperties(this.complete?b({visible:!0,opacity:this.opacity},s):{visible:!1}),s}};C([ld],eo.prototype,"top",2),C([ld],eo.prototype,"right",2),C([ld],eo.prototype,"bottom",2),C([ld],eo.prototype,"left",2),C([ld],eo.prototype,"width",2),C([ld],eo.prototype,"height",2),C([ld],eo.prototype,"opacity",2),C([Nue("imageElement.src"),Rue(e=>e.loadedSynchronously=e.complete)],eo.prototype,"url",2);var{ActionOnSet:Fue,Property:Bue}=R,B_=class extends R.Background{constructor(){super(...arguments),this.image=new eo}onLayoutComplete(e){if(super.onLayoutComplete(e),this.image){const{width:t,height:i}=e.chart;this.image.performLayout(t,i)}}onImageLoad(){this.ctx.updateService.update(R.ChartUpdateType.SCENE_RENDER)}};C([Bue,Fue({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){this.node.removeChild(e.node),e.onLoad=void 0}})],B_.prototype,"image",2);var _ue={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new B_(e)},{ActionOnSet:Gue,LayoutElement:zue,Menu:Vue,Property:jue}=R,UA=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],__=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.menu=new Vue(this.ctx,"chart-toolbar"),this.toolbar=e.sharedToolbar.getSharedToolbar("chartToolbar"),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPressed.bind(this)),e.layoutManager.registerElement(zue.ToolbarLeft,this.onLayoutStart.bind(this)),()=>this.toolbar.destroy())}onLayoutStart(e){this.enabled&&(this.updateButton(),this.toolbar.layout(e.layoutBox))}onButtonPressed({event:e,buttonBounds:t}){this.menu.setAnchor({x:t.x+t.width+6,y:t.y}),this.menu.show({items:UA,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),class:"ag-charts-chart-toolbar__menu",value:this.getChartType(),sourceEvent:e.sourceEvent,onPress:i=>{this.setChartType(i.value),this.hidePopover()},onHide:()=>{this.toolbar.clearActiveButton()}}),this.toolbar.toggleActiveButtonByIndex(0)}updateButton(){var i;const e=this.getChartType(),t=(i=UA.find(s=>s.value===e))==null?void 0:i.icon;t!=null&&this.toolbar.updateButtons([{icon:t,tooltip:"toolbarSeriesTypeDropdown"}])}hidePopover(){this.toolbar.clearActiveButton(),this.menu.hide()}setChartType(e){var i;const t={chartType:e};(i=this.ctx.chartService.publicApi)==null||i.updateDelta(t).catch(s=>se.error(s))}getChartType(){var t,i;const e=(i=(t=this.ctx.chartService.publicApi)==null?void 0:t.getOptions())==null?void 0:i.chartType;return e==null||!UA.some(s=>s.value===e)?"candlestick":e}};C([jue,Gue({changeValue(e){var t;(t=this.toolbar)==null||t.setHidden(!e)}})],__.prototype,"enabled",2);var Hue={type:"root",optionsKey:"chartToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new __(e)};function Wue(e,t){return e==="always"?!0:e==="series-area"?t==="series-area"||t==="series-node":e===t}function G_(e,t,i){var n;let s=!0;if(t.type==="separator"){const a=i.at(i.length-1);s=a!==void 0&&a.type!=="separator"}if(s&&(s=Wue((n=t.showOn)!=null?n:"always",e)),s){const a=new Kue(t);return i.push(a),a}}function z_(e,t,i,s){t.isVisible(i)&&G_(e,t.builtins.items[i],s)}function Uue(e,t,i,s){const{builtins:n}=t;if(LQ(i,n.lists))for(const a of n.lists[i])z_(e,t,a,s);else z_(e,t,i,s)}function KA(e,t,i,s){var n;for(const a of i)if(typeof a=="string")Uue(e,t,a,s);else{const r=G_(e,a,s);a.items&&r&&a.items.length>0&&KA(e,t,a.items,r.items)}((n=s[s.length-1])==null?void 0:n.type)==="separator"&&s.pop()}var Kue=class{constructor(e){this.type="action",this.showOn="always",this.label="",this.iconUrl=void 0,this.enabled=!0,this.items=[],this.action=void 0,e&&this.setOptions(e),this.items=[]}setField(e,t,i){t[e]=i}setOptions(e){let t;for(t in e)e[t]!==void 0&&this.setField(t,this,e[t])}},op="ag-charts-context-menu",rx="ag-charts-dark-context-menu",{Deprecated:ox,Property:$A,ContextMenuRegistry:Yf}=R,YA="context-menu",lx="Use [items] instead",Sc=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,this.darkTheme=!1,this.items=["defaults"],this.pickedNode=void 0,this.showEvent=void 0,this.x=0,this.y=0,this.closingSubMenus=0,this.menuWidget=new Cb.MenuWidget;const t=this;if(this.deprecationMap={extraActions:{get items(){var i;return(i=t.extraActions)!=null?i:[]},showOn:"always"},extraSeriesAreaActions:{get items(){var i;return(i=t.extraSeriesAreaActions)!=null?i:[]},showOn:"series-area"},extraNodeActions:{get items(){var i;return(i=t.extraNodeActions)!=null?i:[]},showOn:"series-node"},extraLegendItemActions:{get items(){var i;return(i=t.extraLegendItemActions)!=null?i:[]},showOn:"legend-item"}},this.interactionManager=e.interactionManager,this.registry=e.contextMenuRegistry,this.element=e.domManager.addChild("canvas-overlay",YA),this.element.classList.add(op),this.element.style.display="none",this.element.addEventListener("contextmenu",i=>i.preventDefault()),this.element.addEventListener("focusout",({relatedTarget:i})=>{this.closingSubMenus>0||(i==null||i instanceof Node&&!this.element.contains(i))&&this.hide()}),this.destroyFns.push(()=>{var i;return(i=this.element.parentNode)==null?void 0:i.removeChild(this.element)},()=>this.menuWidget.destroy(),e.domManager.addListener("hidden",()=>this.hide()),this.menuWidget.addListener("close-widget",()=>this.onClose())),this.menuWidget.addClass(`${op}__menu`),typeof MutationObserver!="undefined"){const i=new MutationObserver(()=>{this.element.contains(this.menuWidget.getElement())&&this.reposition()});i.observe(this.element,{childList:!0}),this.mutationObserver=i,this.destroyFns.push(()=>i.disconnect())}this.ctx.contextMenuRegistry.builtins.items.download.action=()=>{var n;const i=e.chartService.title;let s="image";i!=null&&i.enabled&&(i==null?void 0:i.text)!==void 0&&(s=i.text.replace(/\.+/,"")),(n=this.ctx.chartService.publicApi)==null||n.download({fileName:s}).catch(a=>{se.error("Unable to download chart",a)})},this.destroyFns.push(this.registry.addListener("context-complete",i=>this.onContext(i)))}createDeprecatedAdaptorItems(){const e=[];for(const t of Object.keys(this.deprecationMap)){const{items:i,showOn:s}=this.deprecationMap[t];e.push("separator");for(const{action:n,label:a}of i)e.push({type:"action",showOn:s,enabled:!0,label:a,action:n})}return e}expandItemsOptions(e){const t=[],i=this.createDeprecatedAdaptorItems();return KA(e,this.ctx.contextMenuRegistry,this.items,t),KA(e,this.ctx.contextMenuRegistry,i,t),t}onContext(e){if(!this.enabled)return;e.widgetEvent.sourceEvent.preventDefault(),this.showEvent=e.widgetEvent.sourceEvent,this.x=e.x,this.y=e.y,this.pickedNode=void 0,this.pickedLegendItem=void 0,Yf.check("series-node",e)?this.pickedNode=e.context.pickedNode:Yf.check("legend-item",e)&&(this.pickedLegendItem=e.context.legendItem);const t=this.expandItemsOptions(e.showOn);t.length!==0&&this.show(e.widgetEvent,t)}show(e,t){this.interactionManager.pushState(R.InteractionState.ContextMenu),this.element.classList.toggle(rx,this.darkTheme),this.element.style.display="block";const i=e.sourceEvent.pointerType==="touch"?!1:void 0;i!==void 0&&this.ctx.chartService.overrideFocusVisible(i),this.createMenu(t),this.element.appendChild(this.menuWidget.getElement()),this.menuWidget.open(e,{overrideFocusVisible:i})}hide(){this.menuWidget.close()}onClose(){this.interactionManager.popState(R.InteractionState.ContextMenu),this.element.removeChild(this.menuWidget.getElement()),this.element.style.display="none"}onSubMenuOpen(e,t){const i=e.getBounds();e.setFocusOverride(!0),e.getElement().insertAdjacentElement("afterend",t.getElement()),t.getElement().style.position="absolute";const s=this.ctx.domManager.getBoundingClientRect(),n=e.getBoundingClientRect(),a=s.right-n.right,r=n.left-s.left,{offsetWidth:o,offsetHeight:l}=t.getElement();let c=i.y;if(s.height>l){const h=s.bottom-n.top;h<l&&(c-=l-h)}if(a>=o)t.setBounds({x:i.x+i.width,y:c});else{const h=i.x-o,d=r+h;d>=0?t.setBounds({x:h,y:c}):t.setBounds({x:h-d,y:c})}}onSubMenuClose(e,t){e.setFocusOverride(void 0),this.closingSubMenus++,t.remove(),this.closingSubMenus--}createMenu(e){const{menuWidget:t}=this;t.clear(),t.toggleClass(rx,this.darkTheme),t.setTabIndex(-1),this.createMenuItems(t,e)}createMenuItems(e,t){for(const i of t)switch(i.type){case"separator":const s=e.addSeparator();s.classList.add(`${op}__divider`),s.classList.toggle(rx,this.darkTheme),this.initTableCells(s);break;case"action":if(i.items.length===0){const n=new Cb.MenuItemWidget;this.initButtonElement(n,i),e.addChild(n)}else{const{subMenuButton:n,subMenu:a}=e.addSubMenu();a.addClass(`${op}__menu`),a.addListener("open-widget",()=>this.onSubMenuOpen(n,a)),a.addListener("close-widget",()=>this.onSubMenuClose(n,a)),this.initButtonElement(n,i),this.createMenuItems(a,i.items)}break;default:throw new Error("unhandled case")}}createButtonOnClick(e,t){return Yf.checkCallback("legend-item",e,t)?i=>{const s=i.sourceEvent;if(this.pickedLegendItem){const{seriesId:n,itemId:a}=this.pickedLegendItem;t({type:"contextmenu",seriesId:n,itemId:a,event:s}),this.hide()}else se.error("legend item not found")}:Yf.checkCallback("series-area",e,t)?()=>{t({type:"seriesContextMenuAction",event:this.showEvent}),this.hide()}:Yf.checkCallback("series-node",e,t)?()=>{const{pickedNode:i,showEvent:s}=this,n=i==null?void 0:i.series.createNodeContextMenuActionEvent(s,i);n?t(n):se.error("series node not found"),this.hide()}:()=>{t({type:"contextMenuEvent",event:this.showEvent}),this.hide()}}initTableCells(e){const t=ke("div"),i=ke("div"),s=ke("div");return t.classList.toggle("ag-charts-context-menu__icon",!0),i.classList.toggle("ag-charts-context-menu__label",!0),s.classList.toggle("ag-charts-context-menu__rightarrowhead",!0),t.ariaHidden="true",i.role="presentation",s.ariaHidden="true",e.append(t,i,s),{cellIcon:t,cellLabel:i,cellArrow:s}}initButtonElement(e,t){e.addClass(`${op}__item`),e.toggleClass(rx,this.darkTheme),e.setEnabled(t.enabled);const i=this.ctx.localeManager.t(t.label),s=`${op}__cellpadding`,{cellIcon:n,cellLabel:a,cellArrow:r}=this.initTableCells(e.getElement());if(a.textContent=i,a.classList.add(s),t.iconUrl!=null){const c=ke("img");c.src=t.iconUrl,n.append(c),n.classList.add(s)}t.items.length>0&&(r.textContent="\u276F",r.classList.add(s));const{showOn:o,action:l}=t;if(l!=null){const c=this.createButtonOnClick(o,l);e.addListener("click",c),e.addListener("keydown",h=>{R.isButtonClickEvent(h.sourceEvent)&&(h.sourceEvent.preventDefault(),c(h))})}e.addListener("mousemove",()=>e.focus({preventScroll:!0}))}reposition(){let{x:e,y:t}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:s,offsetHeight:n}=this.element;e=we(0,e,i.width-s),t=we(0,t,i.height-n),this.element.style.left=`${e}px`,this.element.style.top=`calc(${t}px - 0.5em)`}destroy(){var e;super.destroy(),(e=this.mutationObserver)==null||e.disconnect(),this.ctx.domManager.removeStyles(YA),this.ctx.domManager.removeChild("canvas-overlay",YA)}};C([$A],Sc.prototype,"enabled",2),C([$A],Sc.prototype,"darkTheme",2),C([$A],Sc.prototype,"items",2),C([ox(lx)],Sc.prototype,"extraActions",2),C([ox(lx)],Sc.prototype,"extraNodeActions",2),C([ox(lx)],Sc.prototype,"extraSeriesAreaActions",2),C([ox(lx)],Sc.prototype,"extraLegendItemActions",2);var $ue={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsKey:"contextMenu",moduleFactory:e=>new Sc(e),themeTemplate:{contextMenu:{enabled:!0,darkTheme:R.ThemeSymbols.IS_DARK_THEME}}},{BaseProperties:Yue,Property:to}=R,Xue="ag-charts-crosshair-label",lp=class extends R.ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0}};C([to],lp.prototype,"enabled",2),C([to],lp.prototype,"xOffset",2),C([to],lp.prototype,"yOffset",2),C([to],lp.prototype,"format",2),C([to],lp.prototype,"renderer",2);var cp=class extends Yue{constructor(e,t,i){super(),this.domManager=e,this.id=Hs(this),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.renderer=void 0,this.element=e.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(Xue),$e(this.element,"aria-hidden",!0),this.element.setAttribute("data-key",t),this.element.setAttribute("data-axis-id",i)}show(e){const{element:t}=this,i=e.x+this.xOffset,s=e.y+this.yOffset;t.style.top=`${Math.round(s)}px`,t.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml({html:e,styles:t}){e!==void 0&&(this.element.innerHTML=e),t!==void 0&&Object.assign(this.element.style,t)}getBBox(){const{element:e}=this;return new R.BBox(e.clientLeft,e.clientTop,e.clientWidth,e.clientHeight)}toggle(e){this.element.classList.toggle("ag-charts-crosshair-label--hidden",!e)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(e,t){var o,l;if(typeof e=="string")return{html:e,styles:{}};t=t!=null?t:{};const{text:i=(o=t.text)!=null?o:"",color:s=t.color,backgroundColor:n=t.backgroundColor,opacity:a=(l=t.opacity)!=null?l:1}=e,r={opacity:a,"background-color":n==null?void 0:n.toLowerCase(),color:s};return{html:`<div class="ag-charts-crosshair-label-content">
                    <span>${i}</span>
                </div>`,styles:r}}};C([to],cp.prototype,"enabled",2),C([to],cp.prototype,"xOffset",2),C([to],cp.prototype,"yOffset",2),C([to],cp.prototype,"format",2),C([to],cp.prototype,"renderer",2);var{Group:Zue,TranslatableGroup:que,Line:V_,BBox:j_,InteractionState:cx,Property:Mc,ZIndexMap:H_,formatNumber:Que,ChartAxisDirection:W_}=R,sl=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.id=Hs(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new lp,this.seriesRect=new j_(0,0,0,0),this.bounds=new j_(0,0,0,0),this.crosshairGroup=new que({name:"crosshairs",zIndex:H_.SERIES_CROSSHAIR}),this.lineGroup=this.crosshairGroup.appendChild(new Zue({name:`${this.id}-crosshair-lines`,zIndex:H_.SERIES_CROSSHAIR})),this.lineGroupSelection=R.Selection.select(this.lineGroup,V_,!1),this.activeHighlight=void 0,this.axisCtx=e.parent,this.labels={},this.hideCrosshairs(),e.domManager.addEventListener("focusin",({target:t})=>{const i=t instanceof HTMLElement&&e.domManager.contains(t,"series-area");this.crosshairGroup.visible&&!i&&(this.hideCrosshairs(),this.ctx.updateService.update(R.ChartUpdateType.PERFORM_LAYOUT))}),this.destroyFns.push(e.scene.attachNode(this.crosshairGroup),e.widgets.seriesWidget.addListener("mousemove",t=>this.onMouseHoverLike(t)),e.widgets.seriesWidget.addListener("drag-move",t=>this.onMouseHoverLike(t)),e.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseOut()),e.widgets.seriesDragInterpreter.addListener("click",t=>this.onClick(t)),e.chartEventManager.addListener("series-focus-change",()=>this.onKeyPress()),e.zoomManager.addListener("zoom-pan-start",()=>this.onMouseOut()),e.zoomManager.addListener("zoom-change",()=>this.onMouseOut()),e.highlightManager.addListener("highlight-change",t=>this.onHighlightChange(t)),e.layoutManager.addListener("layout:complete",t=>this.layout(t)),()=>Object.values(this.labels).forEach(t=>t.destroy()))}layout({series:{rect:e,visible:t},axes:i}){if(!t||!i||!this.enabled)return;this.seriesRect=e;const{position:s="left",axisId:n}=this.axisCtx,a=i.find(c=>c.id===n);if(!a)return;this.axisLayout=a,this.bounds=e.clone().grow(a.gridPadding+a.seriesAreaPadding,s);const{crosshairGroup:r,bounds:o}=this;r.translationX=Math.round(o.x),r.translationY=Math.round(o.y);const l=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(l),this.updateLines(),this.updateLabels(l)}updateSelections(e){this.lineGroupSelection.update(e,t=>t.append(new V_),t=>t)}updateLabels(e){var s;const{labels:t,ctx:i}=this;for(const n of e)this.label.enabled&&((s=t[n])!=null||(t[n]=new cp(i.domManager,n,this.axisCtx.axisId))),t[n]&&this.updateLabel(t[n]);this.labelFormatter=this.axisCtx.scaleValueFormatter(this.label.format)}updateLabel(e){const{enabled:t,xOffset:i,yOffset:s,format:n,renderer:a}=this.label;e.enabled=t,e.xOffset=i,e.yOffset=s,e.format=n,e.renderer=a}updateLines(){const{lineGroupSelection:e,bounds:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,axisLayout:o}=this;if(!o)return;const l=this.isVertical();e.each(c=>{c.stroke=i,c.strokeWidth=s,c.strokeOpacity=n,c.lineDash=a,c.lineDashOffset=r,c.y1=0,c.y2=l?t.height:0,c.x1=0,c.x2=l?0:t.width})}isVertical(){return this.axisCtx.direction===W_.X}isHover(e){return e.type==="mousemove"||e.type==="click"||e.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}formatValue(e){var s;const{labelFormatter:t,axisLayout:i}=this;if(t){const n=this.cachedCallWithContext(t,e);if(n!=null)return n}if(typeof e=="number"){const n=((s=i==null?void 0:i.label.fractionDigits)!=null?s:0)+(yE(e)?0:1);return Que(e,n)}return String(e!=null?e:"")}onClick(e){e.device==="touch"&&this.onMouseHoverLike(e)}onMouseHoverLike(e){if(!this.enabled||this.snap)return;const t=this.isHover(e)?cx.Clickable:cx.AnnotationsMoveable;this.ctx.interactionManager.isState(t)&&(this.updatePositions(this.getData(e)),this.crosshairGroup.visible=!0,this.ctx.updateService.update(R.ChartUpdateType.SCENE_RENDER))}onMouseOut(){this.ctx.interactionManager.isState(cx.Clickable)&&(this.hideCrosshairs(),this.ctx.updateService.update(R.ChartUpdateType.SCENE_RENDER))}onKeyPress(){this.enabled&&!this.snap&&this.ctx.interactionManager.isState(cx.Default)&&this.hideCrosshairs()}onHighlightChange(e){var r,o,l;if(!this.enabled)return;const{crosshairGroup:t,axisCtx:i}=this,{datum:s,series:n}=(r=e.currentHighlight)!=null?r:{},a=s&&(((o=n==null?void 0:n.axes.x)==null?void 0:o.id)===i.axisId||((l=n==null?void 0:n.axes.y)==null?void 0:l.id)===i.axisId);if(this.activeHighlight=a?e.currentHighlight:void 0,!this.activeHighlight)this.hideCrosshairs();else if(this.snap){const c=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(c),t.visible=!0}}isInRange(e){return this.axisCtx.inRange(e)}updatePositions(e){const{seriesRect:t,lineGroupSelection:i}=this;i.each((s,n)=>{const a=e[n];if(!a){s.visible=!1,this.hideLabel(n);return}s.visible=!0;const{value:r,position:o}=a;let l=0,c=0;this.isVertical()?(l=o,s.x=Math.round(l)):(c=o,s.y=Math.round(c)),this.label.enabled?this.showLabel(l+t.x,c+t.y,r,n):this.hideLabel(n)})}getData(e){var d,u;const{axisCtx:t}=this,i="pointer",{datum:s,xKey:n="",yKey:a=""}=(d=this.activeHighlight)!=null?d:{},{currentX:r,currentY:o}=e,l=this.isVertical(),c=l?r:o;let h=(u=s==null?void 0:s[l?n:a])!=null?u:"";return t.continuous&&(h=t.scaleInvert(c)),{[i]:{position:c,value:h}}}getActiveHighlightData(e){var f,y,v;const{axisCtx:t}=this,{datum:i,series:s,xKey:n="",aggregatedValue:a,cumulativeValue:r,midPoint:o}=e,l=s.getKeyProperties(t.direction),c=((f=t.scale.bandwidth)!=null?f:0)/2,h=((y=s.axes[t.direction])==null?void 0:y.id)===t.axisId,d=l.indexOf("yKey")>-1&&h,u=l.indexOf("xKey")>-1&&h,p=a!=null?a:r;if(d&&p!==void 0){const x=t.scale.convert(p)+c;return this.isInRange(x)?{yKey:{value:p,position:x}}:{}}if(u){const x=(v=this.isVertical()?o==null?void 0:o.x:o==null?void 0:o.y)!=null?v:0,S=t.continuous?t.scaleInvert(x):i[n];return this.isInRange(x)?{xKey:{value:S,position:x}}:{}}const g={};return l.forEach(x=>{const S=s.properties[x],M=i[S],D=t.scale.convert(M)+c;this.isInRange(D)&&(g[x]={value:M,position:D})}),g}getLabelHtml(e,t){var n,a,r;const i=(r=(a=(n=this.axisLayout)==null?void 0:n.label)==null?void 0:a.fractionDigits)!=null?r:0,s={text:this.formatValue(e)};return this.label.renderer?t.toLabelHtml(this.label.renderer({value:e,fractionDigits:i}),s):t.toLabelHtml(s)}showLabel(e,t,i,s){if(!this.axisLayout)return;const{bounds:n}=this,a=this.labels[s],r=this.getLabelHtml(i,a);a.setLabelHtml(r);const{width:o,height:l}=a.getBBox(),c=this.axisCtx.position;let h=this.axisLayout.label.spacing+this.axisLayout.tickSize;this.axisCtx.direction===W_.X?(h-=4,a.show({x:e-o/2,y:c==="bottom"?n.y+n.height+h:n.y-l-h})):(h-=8,a.show({x:c==="right"?n.x+n.width+h:n.x-o-h,y:t-l/2}))}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const e of Object.keys(this.labels))this.hideLabel(e)}hideLabel(e){var t;(t=this.labels[e])==null||t.toggle(!1)}cachedCallWithContext(e,...t){const{callbackCache:i,chartService:s}=this.ctx;return i.call(this.axisCtx,s,e,...t)}};C([Mc],sl.prototype,"enabled",2),C([Mc],sl.prototype,"stroke",2),C([Mc],sl.prototype,"lineDash",2),C([Mc],sl.prototype,"lineDashOffset",2),C([Mc],sl.prototype,"strokeWidth",2),C([Mc],sl.prototype,"strokeOpacity",2),C([Mc],sl.prototype,"snap",2),C([Mc],sl.prototype,"label",2);var Jue={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","unit-time","number","log","time"],moduleFactory:e=>new sl(e),themeTemplate:{crosshair:{snap:!0,stroke:{$ref:"subtleTextColor"},strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}},{ActionOnSet:Xf,Property:U_}=R,hp=class extends R.BaseModuleInstance{constructor(e){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=e.dataService}updateCallback(e,t){this.dataService&&(e&&t!=null?this.dataService.updateCallback(t):this.dataService.clearCallback())}};C([Xf({newValue(e){this.updateCallback(e,this.getData)}}),U_],hp.prototype,"enabled",2),C([Xf({newValue(e){this.updateCallback(this.enabled,e)}}),U_],hp.prototype,"getData",2),C([Xf({newValue(e){this.dataService.requestThrottle=e}})],hp.prototype,"requestThrottle",2),C([Xf({newValue(e){this.dataService.dispatchThrottle=e}})],hp.prototype,"updateThrottle",2),C([Xf({newValue(e){this.dataService.dispatchOnlyLatest=!e}})],hp.prototype,"updateDuringInteraction",2);var epe={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","hierarchy","polar","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new hp(e),themeTemplate:{dataSource:{enabled:!1}}},{nearestSquaredInContainer:tpe,partialAssign:ipe,mergeDefaults:K_,BBox:nl}=R,spe=class{constructor(e){this.components=e,this.union=nl.merge(e)}containsPoint(e,t){if(!this.union.containsPoint(e,t))return!1;for(const i of this.components)if(i.containsPoint(e,t))return!0;return!1}},npe=class extends R.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new R.Path,this.capsPath=new R.Path,this.bboxes=new spe([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(e){this._datum=e}calculateCapLength(e,t){const{lengthRatio:i=1,length:s}=e,{lengthRatioMultiplier:n,lengthMax:a}=t,r=s!=null?s:i*n;return Math.min(r,a)}getItemStylerParams(e,t,i){const{datum:s}=this;if(s==null||e.itemStyler==null)return;const{xLowerKey:n,xUpperKey:a,yLowerKey:r,yUpperKey:o}=e;return E(b({},t),{datum:s.datum,seriesId:s.datum.seriesId,xKey:s.xKey,yKey:s.yKey,xLowerKey:n,xUpperKey:a,yLowerKey:r,yUpperKey:o,highlighted:i})}formatStyles(e,t,i,s){let o=e,{cap:n}=o,a=We(o,["cap"]);const r=this.getItemStylerParams(t,e,s);if(r!=null&&t.itemStyler!=null){const l=i.callWithContext(t.itemStyler,r);a=K_(l,a),n=K_(l==null?void 0:l.cap,l,n)}return{whiskerStyle:a,capsStyle:n}}applyStyling(e,t){ipe(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],e,t)}update(e,t,i,s){if(this.datum===void 0)return;const{whiskerStyle:n,capsStyle:a}=this.formatStyles(e,t,i,s),{xBar:r,yBar:o,capDefaults:l}=this.datum,c=this.whiskerPath;this.applyStyling(c,n),c.path.clear(!0),o!==void 0&&(c.path.moveTo(o.lowerPoint.x,o.lowerPoint.y),c.path.lineTo(o.upperPoint.x,o.upperPoint.y)),r!==void 0&&(c.path.moveTo(r.lowerPoint.x,r.lowerPoint.y),c.path.lineTo(r.upperPoint.x,r.upperPoint.y)),c.path.closePath(),this.capLength=this.calculateCapLength(a!=null?a:{},l);const h=this.capLength/2,d=this.capsPath;this.applyStyling(d,a),d.path.clear(!0),o!==void 0&&(d.path.moveTo(o.lowerPoint.x-h,o.lowerPoint.y),d.path.lineTo(o.lowerPoint.x+h,o.lowerPoint.y),d.path.moveTo(o.upperPoint.x-h,o.upperPoint.y),d.path.lineTo(o.upperPoint.x+h,o.upperPoint.y)),r!==void 0&&(d.path.moveTo(r.lowerPoint.x,r.lowerPoint.y-h),d.path.lineTo(r.lowerPoint.x,r.lowerPoint.y+h),d.path.moveTo(r.upperPoint.x,r.upperPoint.y-h),d.path.lineTo(r.upperPoint.x,r.upperPoint.y+h)),d.path.closePath()}updateBBoxes(){var o;const{capLength:e,whiskerPath:t,capsPath:i}=this,{yBar:s,xBar:n}=(o=this.datum)!=null?o:{},a=e/2,r=[];if(s!==void 0){const l=s.lowerPoint.y-s.upperPoint.y;r.push(new nl(s.lowerPoint.x,s.upperPoint.y,t.strokeWidth,l),new nl(s.lowerPoint.x-a,s.lowerPoint.y,e,i.strokeWidth),new nl(s.upperPoint.x-a,s.upperPoint.y,e,i.strokeWidth))}if(n!==void 0){const l=n.upperPoint.x-n.lowerPoint.x;r.push(new nl(n.lowerPoint.x,n.upperPoint.y,l,t.strokeWidth),new nl(n.lowerPoint.x,n.lowerPoint.y-a,i.strokeWidth,e),new nl(n.upperPoint.x,n.upperPoint.y-a,i.strokeWidth,e))}this.bboxes.components=r,this.bboxes.union=nl.merge(r)}containsPoint(e,t){return this.bboxes.containsPoint(e,t)}pickNode(e,t){return this.containsPoint(e,t)?this:void 0}nearestSquared(e,t,i){const{bboxes:s}=this;if(s.union.distanceSquared(e,t)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:n}=nl.nearestBox(e,t,s.components);return{nearest:this,distanceSquared:n}}},ape=class extends R.Group{nearestSquared(e,t){const{nearest:i,distanceSquared:s}=tpe(e,t,{children:this.children()});if(i!==void 0&&!isNaN(s))return{datum:i.datum,distanceSquared:s}}},{BaseProperties:$_,Property:Jt}=R,al=class extends $_{};C([Jt],al.prototype,"visible",2),C([Jt],al.prototype,"stroke",2),C([Jt],al.prototype,"strokeWidth",2),C([Jt],al.prototype,"strokeOpacity",2),C([Jt],al.prototype,"lineDash",2),C([Jt],al.prototype,"lineDashOffset",2),C([Jt],al.prototype,"length",2),C([Jt],al.prototype,"lengthRatio",2);var Rs=class extends $_{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new al}};C([Jt],Rs.prototype,"yLowerKey",2),C([Jt],Rs.prototype,"yLowerName",2),C([Jt],Rs.prototype,"yUpperKey",2),C([Jt],Rs.prototype,"yUpperName",2),C([Jt],Rs.prototype,"xLowerKey",2),C([Jt],Rs.prototype,"xLowerName",2),C([Jt],Rs.prototype,"xUpperKey",2),C([Jt],Rs.prototype,"xUpperName",2),C([Jt],Rs.prototype,"visible",2),C([Jt],Rs.prototype,"stroke",2),C([Jt],Rs.prototype,"strokeWidth",2),C([Jt],Rs.prototype,"strokeOpacity",2),C([Jt],Rs.prototype,"lineDash",2),C([Jt],Rs.prototype,"lineDashOffset",2),C([Jt],Rs.prototype,"itemStyler",2),C([Jt],Rs.prototype,"cap",2);var{fixNumericExtent:rpe,groupAccumulativeValueProperty:ope,mergeDefaults:lpe,valueProperty:hx,ChartAxisDirection:XA}=R;function cpe(e){for(const t of ew)if(t===e.series.type)return e.series;throw new Error(`AG Charts - unsupported series type '${e.series.type}', error bars supported series types: ${ew.join(", ")}`)}var hpe=class Lm extends R.BaseModuleInstance{constructor(t){super(),this.properties=new Rs;const i=cpe(t),{annotationGroup:s,annotationSelections:n}=i;this.cartesianSeries=i,this.groupNode=new ape({name:`${s.id}-errorBars`}),s.appendChild(this.groupNode),this.selection=R.Selection.select(this.groupNode,()=>this.errorBarFactory()),n.add(this.selection),i.addEventListener("seriesVisibilityChange",a=>this.onToggleSeriesItem(a)),this.destroyFns.push(i.addListener("data-processed",a=>this.onDataProcessed(a)),i.addListener("data-update",a=>this.onDataUpdate(a)),t.highlightManager.addListener("highlight-change",a=>this.onHighlightChange(a)),()=>s.removeChild(this.groupNode),()=>n.delete(this.selection))}hasErrorBars(){const{xLowerKey:t,xUpperKey:i,yLowerKey:s,yUpperKey:n}=this.properties;return ni(t)&&ni(i)||ni(s)&&ni(n)}isStacked(){var i;const t=(i=this.cartesianSeries.seriesGrouping)==null?void 0:i.stackCount;return t==null?!1:t>0}getUnstackPropertyDefinition(t){const i=[],{xLowerKey:s,xUpperKey:n,yLowerKey:a,yUpperKey:r,xErrorsID:o,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=t;return a!=null&&r!=null&&i.push(hx(a,h,{id:`${l}-lower`}),hx(r,h,{id:`${l}-upper`})),s!=null&&n!=null&&i.push(hx(s,c,{id:`${o}-lower`}),hx(n,c,{id:`${o}-upper`})),i}getStackPropertyDefinition(t){var y,v;const i=[],{cartesianSeries:s}=this,{xLowerKey:n,xUpperKey:a,yLowerKey:r,yUpperKey:o,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:d}=t,u=(v=(y=s.seriesGrouping)==null?void 0:y.groupIndex)!=null?v:s.id,p=b({invalidValue:null,missingValue:0,separateNegative:!0},s.visible?{}:{forceValue:0}),g=(x,S,M,D)=>ope(x,"normal","current",b({id:`${S}-${M}`,groupId:`errorGroup-${u}-${M}`},p),D),f=(x,S,M,D)=>{i.push(...g(x,M,"lower",D),...g(S,M,"upper",D))};return r!=null&&o!=null&&f(r,o,c,d),n!=null&&a!=null&&f(n,a,l,h),i}getPropertyDefinitions(t){return this.isStacked()?this.getStackPropertyDefinition(t):this.getUnstackPropertyDefinition(t)}onDataProcessed(t){this.dataModel=t.dataModel,this.processedData=t.processedData}getDomain(t){const{xLowerKey:i,xUpperKey:s,xErrorsID:n,yLowerKey:a,yUpperKey:r,yErrorsID:o}=this.getMaybeFlippedKeys();if(t===XA.X?ni(i)&&ni(s):ni(a)&&ni(r)){const{dataModel:c,processedData:h,cartesianSeries:d}=this;if(c!=null&&h!=null){const u={x:n,y:o}[t],p=c.getDomain(d,`${u}-lower`,"value",h),g=c.getDomain(d,`${u}-upper`,"value",h),f=[Math.min(...p,...g),Math.max(...p,...g)];return rpe(f)}}return[]}onDataUpdate(t){this.dataModel=t.dataModel,this.processedData=t.processedData,ni(t.dataModel)&&ni(t.processedData)&&(this.createNodeData(),this.update())}getNodeData(){var t;return this.hasErrorBars()?(t=this.cartesianSeries.contextNodeData)==null?void 0:t.nodeData:void 0}createNodeData(){var n,a;const t=this.getNodeData(),i=(n=this.cartesianSeries.axes[XA.X])==null?void 0:n.scale,s=(a=this.cartesianSeries.axes[XA.Y])==null?void 0:a.scale;if(!(!i||!s||!t))for(let r=0;r<t.length;r++){const{midPoint:o,xLower:l,xUpper:c,yLower:h,yUpper:d}=this.getDatum(t,r);if(o!=null){let u,p;ni(l)&&ni(c)&&(u={lowerPoint:{x:this.convert(i,l),y:o.y},upperPoint:{x:this.convert(i,c),y:o.y}}),ni(h)&&ni(d)&&(p={lowerPoint:{x:o.x,y:this.convert(s,h)},upperPoint:{x:o.x,y:this.convert(s,d)}}),t[r].xBar=u,t[r].yBar=p}}}getMaybeFlippedKeys(){let{xLowerKey:t,xUpperKey:i,yLowerKey:s,yUpperKey:n}=this.properties,[a,r]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([t,s]=[s,t],[i,n]=[n,i],[a,r]=[r,a]),{xLowerKey:t,xUpperKey:i,xErrorsID:a,yLowerKey:s,yUpperKey:n,yErrorsID:r}}static getDatumKey(t,i,s){if(i==null)return;const n=t.datum[i];if(n!=null){if(typeof n!="number"){se.warnOnce(`Found [${i}] error value of type ${typeof n}. Expected number type`);return}return n+s}}getDatum(t,i){const{xLowerKey:s,xUpperKey:n,yLowerKey:a,yUpperKey:r}=this.getMaybeFlippedKeys(),o=t[i],l=o.cumulativeValue==null||!this.isStacked()?0:o.cumulativeValue-o.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:o.midPoint,xLower:Lm.getDatumKey(o,s,c),xUpper:Lm.getDatumKey(o,n,c),yLower:Lm.getDatumKey(o,a,h),yUpper:Lm.getDatumKey(o,r,h)}}convert(t,i){var n;const s=((n=t.bandwidth)!=null?n:0)/2;return t.convert(i)+s}update(){const t=this.getNodeData();t!=null&&(this.selection.update(t),this.selection.each((i,s,n)=>this.updateNode(i,s,n)))}updateNode(t,i,s){t.datum=i,t.update(this.getDefaultStyle(),this.properties,this.cartesianSeries,!1),t.updateBBoxes()}pickNodeExact(t){const{x:i,y:s}=t,n=this.groupNode.pickNode(i,s);if(n!=null)return{datum:n.datum,distanceSquared:0}}pickNodeNearest(t){return this.groupNode.nearestSquared(t.x,t.y)}pickNodeMainAxisFirst(t){return this.groupNode.nearestSquared(t.x,t.y)}getTooltipParams(){const{xLowerKey:t,xUpperKey:i,yLowerKey:s,yUpperKey:n,xLowerName:a=t,xUpperName:r=i,yLowerName:o=s,yUpperName:l=n}=this.properties;return{xLowerKey:t,xLowerName:a,xUpperKey:i,xUpperName:r,yLowerKey:s,yLowerName:o,yUpperKey:n,yUpperName:l}}onToggleSeriesItem(t){this.groupNode.visible=t.visible}makeStyle(t){return{visible:t.visible,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,cap:lpe(this.properties.cap,t)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(t,i,s){var a;const n=this.getNodeData();if(n!=null){for(let r=0;r<n.length;r++)if(t===n[r]){(a=this.selection.at(r))==null||a.update(i,this.properties,this.cartesianSeries,s);break}}}onHighlightChange(t){const{previousHighlight:i,currentHighlight:s}=t;(s==null?void 0:s.series)===this.cartesianSeries&&this.restyleHighlightChange(s,this.getHighlightStyle(),!0),(i==null?void 0:i.series)===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new npe}getWhiskerProperties(){const{stroke:t,strokeWidth:i,visible:s,strokeOpacity:n,lineDash:a,lineDashOffset:r}=this.properties;return{stroke:t,strokeWidth:i,visible:s,strokeOpacity:n,lineDash:a,lineDashOffset:r}}},dpe={series:{errorBar:{visible:!0,stroke:{$ref:"foregroundColor"},strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}},upe={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:ew,moduleFactory:e=>new hpe(e),themeTemplate:dpe},{ZIndexMap:ppe,ActionOnSet:gpe,Property:ZA,ProxyPropertyOnWrite:Y_}=R,dx=class extends R.Background{constructor(){super(...arguments),this.image=new eo,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new R.Group({name:"foreground",zIndex:ppe.FOREGROUND})}onLayoutComplete(e){super.onLayoutComplete(e);const{width:t,height:i}=e.chart;let s={x:0,y:0,width:t,height:i};this.image&&(s=this.image.performLayout(t,i)),this.text&&this.updateTextNode(s)}onImageLoad(){this.ctx.updateService.update(R.ChartUpdateType.SCENE_RENDER)}updateTextNode(e){const{textNode:t}=this;t.fontWeight="bold",t.fontFamily="Impact, sans-serif",t.fontSize=19,t.opacity=.7,t.fill="#9b9b9b",t.textBaseline="top";const i=this.textNode.getBBox(),s=10;t.x=e.x+e.width/2-i.width/2,t.y=e.y+e.height+s}};C([ZA,gpe({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){this.node.removeChild(e.node),e.onLoad=void 0}})],dx.prototype,"image",2),C([ZA,Y_("rectNode","fill")],dx.prototype,"fill",2),C([ZA,Y_("rectNode","fillOpacity")],dx.prototype,"fillOpacity",2);var fpe={type:"root",optionsKey:"foreground",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:e=>new dx(e)},{TranslatableGroup:mpe,SceneChangeDetection:X_}=R,qA=class extends mpe{constructor(){super(...arguments),this.inset=0,this.cornerRadius=0}applyClip(e,t){const{cornerRadius:i,inset:s}=this,{x:n,y:a,width:r,height:o}=t;e.beginPath(),e.roundRect(n+s,a+s,r-2*s,o-2*s,i),e.clip()}};C([X_()],qA.prototype,"inset",2),C([X_()],qA.prototype,"cornerRadius",2);var{Property:QA,ZIndexMap:cd,ActionOnSet:Z_,CategoryAxis:ype,TextUtils:vpe,Padding:bpe,Group:hd,BBox:q_,ProxyProperty:Q_}=R,JA=class{constructor(){this.top=0,this.bottom=0}};C([QA],JA.prototype,"top",2),C([QA],JA.prototype,"bottom",2);var dp=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.padding=new JA,this.root=new hd({name:"root"}),this.seriesRoot=this.root.appendChild(new qA({name:"Series-root",zIndex:cd.SERIES_LAYER,renderToOffscreenCanvas:!0})),this.axisGridGroup=this.root.appendChild(new hd({name:"Axes-Grids",zIndex:cd.AXIS_GRID})),this.axisGroup=this.root.appendChild(new hd({name:"Axes-Grids",zIndex:cd.AXIS_GRID})),this.axisLabelGroup=this.root.appendChild(new hd({name:"Axes-Labels",zIndex:cd.SERIES_LABEL})),this.axisCrosslineRangeGroup=this.root.appendChild(new hd({name:"Axes-Crosslines-Range",zIndex:cd.SERIES_CROSSLINE_RANGE})),this.axisCrosslineLineGroup=this.root.appendChild(new hd({name:"Axes-Crosslines-Line",zIndex:cd.SERIES_CROSSLINE_LINE})),this.axisCrosslineLabelGroup=this.root.appendChild(new hd({name:"Axes-Crosslines-Label",zIndex:cd.SERIES_LABEL})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach(e=>e.destroy()),this.axes=[],this._destroyed=!0)}onSeriesChange(e,t){var s;const i=(s=t==null?void 0:t.filter(n=>!e.includes(n)))!=null?s:[];this.destroySeries(i);for(const n of e){if(t!=null&&t.includes(n))continue;n.attachSeries(this.seriesRoot,this.seriesRoot,void 0);const a=this;n.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return a.seriesRect}},n.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled")}}destroySeries(e){e==null||e.forEach(t=>{t.destroy(),t.detachSeries(this.seriesRoot,this.seriesRoot,void 0),t.chart=void 0})}assignSeriesToAxes(){this.axes.forEach(e=>{e.boundSeries=this.series.filter(t=>t.axes[e.direction]===e)})}assignAxesToSeries(){const e={};this.axes.forEach(t=>{var n;const i=t.direction;((n=e[i])!=null?n:e[i]=[]).push(t)}),this.series.forEach(t=>{t.directions.forEach(i=>{const s=e[i];if(!s){se.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);return}const n=t.getKeys(i),a=this.findMatchingAxis(s,n);if(!a){se.warnOnce(`no matching axis for direction [${i}] and keys [${n}]; check series and axes configuration.`);return}t.axes[i]=a})})}findMatchingAxis(e,t){for(const i of e){if(!i.keys.length)return i;if(t){for(const s of t)if(i.keys.includes(s))return i}}}updateData(e){this.series.forEach(t=>t.setChartData(e)),this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready",this.series.forEach(t=>t.resetAnimation("disabled"))})}async processData(e){this.series.some(t=>t.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes()),await Promise.all(this.series.map(t=>(t.resetDatumCallbackCache(),t.processData(e))));for(const t of this.axes)t.processData()}computeAxisPadding(){const e=new bpe;return this.enabled&&this.axes.forEach(({position:t,thickness:i,line:s,label:n})=>{var r;if(t==null)return;let a;i?a=i:a=(s.enabled?s.width:0)+(n.enabled?vpe.getLineHeight((r=n.fontSize)!=null?r:0)+n.spacing:0),e[t]=Math.ceil(a)}),e}async layout(e,t){const{padding:i}=this,s=this.seriesRect!=null,n=new q_(0,0,e,t-(i.top+i.bottom));this.seriesRect=n,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectCanvasSpace(new q_(0,-i.top,e,t)),this.axes.forEach(a=>{const{position:r="left"}=a;switch(r){case"top":case"bottom":a.range=[0,n.width],a.gridLength=n.height;break;case"right":case"left":{const o=a instanceof ype;a.range=o?[0,n.height]:[n.height,0],a.gridLength=n.width;break}}a.gridPadding=0,a.translation.x=0,a.translation.y=0,r==="right"?a.translation.x=e:r==="bottom"&&(a.translation.y=t),s||a.resetAnimation("initial"),a.calculateLayout(),a.update()}),await Promise.all(this.series.map(a=>a.update({seriesRect:n})))}};C([QA],dp.prototype,"enabled",2),C([Q_(["seriesRoot","inset"])],dp.prototype,"inset",2),C([Q_(["seriesRoot","cornerRadius"])],dp.prototype,"cornerRadius",2),C([Z_({changeValue(e,t=[]){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const s of t)e.includes(s)||(s.detachAxis(i),s.destroy());for(const s of e)t!=null&&t.includes(s)||s.attachAxis(i)}})],dp.prototype,"axes",2),C([Z_({changeValue(e,t){this.onSeriesChange(e,t)}})],dp.prototype,"series",2);var{SliderWidget:J_}=R,xpe=class{constructor(e,t){this.ctx=e,this.sliderHandlers=t,this._min=0,this._max=1,this.minRange=.001,this.dragStartX=0,this.ctx=e,this.toolbar=e.proxyInteractionService.createProxyContainer({type:"toolbar",domManagerId:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],orientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.sliders=[e.proxyInteractionService.createProxyElement({type:"slider",domIndex:1,ariaLabel:{id:"ariaLabelNavigatorMinimum"},parent:this.toolbar,cursor:"ew-resize"}),e.proxyInteractionService.createProxyElement({type:"slider",domIndex:-1/0,ariaLabel:{id:"ariaLabelNavigatorRange"},parent:this.toolbar,cursor:"grab"}),e.proxyInteractionService.createProxyElement({type:"slider",domIndex:2,ariaLabel:{id:"ariaLabelNavigatorMaximum"},parent:this.toolbar,cursor:"ew-resize"})];for(const[i,s]of["min","pan","max"].entries()){const n=this.sliders[i];n.step=J_.STEP_HUNDRETH,n.keyboardStep=J_.STEP_ONE,n.orientation="horizontal",n.setPreventsDefault(!1),n.addListener("drag-start",a=>this.onDragStart(i,a,s)),n.addListener("drag-move",a=>this.onDrag(n,a,s)),n.addListener("drag-end",()=>this.updateSliderRatios()),n.addListener("contextmenu",a=>this.onContextMenu(n,a))}this.sliders[0].addListener("change",()=>this.onMinSliderChange()),this.sliders[1].addListener("change",()=>this.onPanSliderChange()),this.sliders[2].addListener("change",()=>this.onMaxSliderChange()),this.updateSliderRatios(),this.updateVisibility(!1)}destroy(){this.toolbar.destroy()}updateVisibility(e){this.toolbar.setHidden(!e)}updateZoom(){const{_min:e,_max:t}=this;if(!(e==null||t==null))return this.ctx.zoomManager.updateZoom("navigator",{x:{min:e,max:t}})}updateBounds(e){this.toolbar.setBounds(e)}updateSliderBounds(e,t){this.sliders[e].setBounds(t)}updateMinMax(e,t){this._min=e,this._max=t,this.updateSliderRatios()}updateSliderRatios(){let{_min:e,_max:t}=this;e=Math.round(e*100)/100,t=Math.round(t*100)/100;const i=this.ctx.localeManager.t("ariaValuePanRange",{min:e,max:t});this.sliders[0].setValueRatio(e),this.sliders[1].setValueRatio(e,{ariaValueText:i}),this.sliders[2].setValueRatio(t)}toCanvasOffsets(e){return{offsetX:this.dragStartX+e.originDeltaX}}moveToFront(e){if(e===1)return;const t=this.sliders[e],i=this.sliders[2-e];this.toolbar.moveChild(i,t.domIndex-1)}onDragStart(e,t,i){const s=this.sliders[e],n=this.toolbar.cssLeft(),a=s.cssLeft();this.dragStartX=n+a+t.offsetX,this.moveToFront(e),t.device==="touch"&&t.sourceEvent.preventDefault(),this.sliderHandlers.onDragStart(i,this.toCanvasOffsets(t))}onDrag(e,t,i){t.device==="touch"&&t.sourceEvent.preventDefault(),this.sliderHandlers.onDrag(i,this.toCanvasOffsets(t))}onContextMenu(e,t){const{offsetX:i,offsetY:s}=t,{x:n,y:a}=this.toolbar.getBounds(),{x:r,y:o}=e.getBounds(),l=i+n+r,c=s+a+o;this.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:t,canvasX:l,canvasY:c},void 0)}onPanSliderChange(){const e=this.sliders[1].getValueRatio(),t=this._max-this._min;this._min=we(0,e,1-t),this._max=this._min+t,this.updateZoom()}onMinSliderChange(){this._min=this.sliders[0].clampValueRatio(0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(){this._max=this.sliders[2].clampValueRatio(this._min+this.minRange,1),this.updateZoom()}},{Property:ux,SceneChangeDetection:px,BBox:Cpe,ExtendedPath2D:Spe}=R,Dc=class extends R.Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.cornerRadius=4,this.grip=!0,this.gripPath=new Spe}setCenter(e,t){this.dirtyPath=!0,(this.centerX!==e||this.centerY!==t)&&(this.centerX=e,this.centerY=t,this.markDirty("center"))}static align(e,t,i,s,n,a,r,o,l){const c=e.align(i+n*r)+l,h=c+e.align(i+n*r,n*(o-r))-2*l,d=e.align(s+a/2);e.setCenter(c,d),t.setCenter(h,d)}computeBBox(){const{centerX:e,centerY:t,width:i,height:s}=this,n=e-i/2,a=t-s/2;return new Cpe(n,a,i,s)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}updatePath(){var u,p,g;const{centerX:e,centerY:t,path:i,gripPath:s,strokeWidth:n,cornerRadius:a,grip:r}=this,o=n/2,l=(g=(p=(u=this.layerManager)==null?void 0:u.canvas)==null?void 0:p.pixelRatio)!=null?g:1;i.clear(),s.clear();const c=Math.floor(this.width/2*l)/l,h=Math.floor(this.height/2*l)/l;i.roundRect(e-c+o,t-h+o,2*(c-o),2*(h-o),a);const d=3;if(r)for(let f=-.5;f<=.5;f+=1)for(let y=-1;y<=1;y+=1)s.arc(e+f*d,t+y*d,1,0,2*Math.PI),s.closePath()}renderFill(e,t){const{stroke:i}=this;super.renderFill(e,t),e.fillStyle=typeof i=="string"?i:"black",e.fill(this.gripPath.getPath2D())}};Dc.className="RangeHandle",C([ux,px()],Dc.prototype,"width",2),C([ux,px()],Dc.prototype,"height",2),C([ux,px()],Dc.prototype,"cornerRadius",2),C([ux,px()],Dc.prototype,"grip",2);var{Path:Mpe,BBox:Zf,ExtendedPath2D:Dpe,clippedRoundRect:eI,Property:wpe,SceneChangeDetection:Ape}=R,tI=class extends Mpe{constructor(){super(...arguments),this.cornerRadius=4,this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1,this.visiblePath=new Dpe}layout(e,t,i,s,n,a){n=isNaN(n)?this.min:n,a=isNaN(a)?this.max:a,(e!==this.x||t!==this.y||i!==this.width||this.height!==s||n!==this.min||a!==this.max)&&(this.x=e,this.y=t,this.width=i,this.height=s,this.min=n,this.max=a,this.dirtyPath=!0,this.markDirty("RangeMask.layout"))}computeBBox(){const{x:e,y:t,width:i,height:s}=this;return new Zf(e,t,i,s)}computeVisibleRangeBBox(){const{x:e,y:t,width:i,height:s,min:n,max:a}=this,r=e+i*n,o=e+i*a;return new Zf(r,t,o-r,s)}updatePath(){const{path:e,visiblePath:t,x:i,y:s,width:n,height:a,min:r,max:o,strokeWidth:l,cornerRadius:c}=this,h=l/2;e.clear(),t.clear();const d=this.align(i)+h,u=this.align(s)+h,p=this.align(i,n)-2*h,g=this.align(s,a)-2*h,f=this.align(i+n*r)+h,y=f+this.align(i+n*r,n*(o-r))-2*h,v={topLeft:c,topRight:c,bottomRight:c,bottomLeft:c};eI(e,d,u,p,g,v,new Zf(d,u,f-d,g)),eI(e,d,u,p,g,v,new Zf(y,u,p+d-y,g)),y-f>1&&eI(t,d,u,p,g,v,new Zf(f,u,y-f,g))}renderStroke(e,t){super.renderStroke(e,t),super.renderStroke(e,this.visiblePath.getPath2D())}};tI.className="RangeMask",C([wpe,Ape()],tI.prototype,"cornerRadius",2);var Ipe=class extends R.Group{constructor(e){super({name:"rangeSelectorGroup",zIndex:R.ZIndexMap.NAVIGATOR}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.background=this.appendChild(new R.TranslatableGroup({name:"navigator-background",zIndex:1})),this.append(e)}layout(e,t,i,s,n,a){this.x=e,this.y=t,this.width=i,this.height=s,this.lOffset=n,this.rOffset=a,this.background.translationX=e,this.background.translationY=t,this.markDirty("RangeSelector")}updateBackground(e,t){e!=null&&this.background.removeChild(e),t!=null&&this.background.appendChild(t),this.markDirty("RangeSelector")}computeBBox(){const{x:e,y:t,width:i,height:s,lOffset:n,rOffset:a}=this;return new R.BBox(e-n,t,i+(n+a),s)}},{BaseModuleInstance:Tpe,ObserveChanges:iI,Property:gx}=R,up=class extends Tpe{constructor(e){super(),this.ctx=e,this.enabled=!1,this.mask=new tI,this.minHandle=new Dc,this.maxHandle=new Dc,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:()=>this.mask.computeVisibleRangeBBox(),toCanvasBBox:()=>this.mask.computeVisibleRangeBBox(),fromCanvasPoint:(t,i)=>({x:t,y:i})},this.height=30,this.cornerRadius=0,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new Ipe([this.mask,this.minHandle,this.maxHandle]),this.destroyFns.push(e.scene.attachNode(this.rangeSelector),this.ctx.localeManager.addListener("locale-changed",()=>this.updateZoom()),this.ctx.layoutManager.registerElement(R.LayoutElement.Navigator,t=>this.onLayoutStart(t)),this.ctx.layoutManager.addListener("layout:complete",t=>this.onLayoutComplete(t)),e.zoomManager.addListener("zoom-change",t=>this.onZoomChange(t))),this.domProxy=new xpe(e,this),this.updateGroupVisibility(),this.miniChart=new dp(e)}updateBackground(e,t){var i;(i=this.rangeSelector)==null||i.updateBackground(e,t)}updateGroupVisibility(){const{enabled:e}=this;this.rangeSelector==null||e===this.rangeSelector.visible||(this.rangeSelector.visible=e,this.domProxy.updateVisibility(e),e?this.updateZoom():this.ctx.zoomManager.updateZoom("navigator"))}onLayoutStart(e){if(this.enabled){const{layoutBox:t}=e,i=this.height+this.spacing;t.shrink(i,"bottom"),this.y=t.y+t.height+this.spacing}else this.y=0;if(this.enabled&&this.miniChart){const{top:t,bottom:i}=this.miniChart.computeAxisPadding();e.layoutBox.shrink(t+i,"bottom"),this.y-=i,this.miniChart.inset=this.mask.strokeWidth/2,this.miniChart.cornerRadius=this.mask.cornerRadius}}onLayoutComplete(e){var a;const{x:t,width:i}=e.series.rect,{y:s,height:n}=this;if(this.domProxy.updateVisibility(this.enabled),this.enabled){const{_min:r,_max:o}=this.domProxy;this.layoutNodes(t,s,i,n,r,o),this.domProxy.updateBounds({x:t,y:s,width:i,height:n})}this.x=t,this.width=i,(a=this.miniChart)==null||a.layout(i,n).catch(r=>se.error(r))}canDrag(){return this.enabled&&this.ctx.interactionManager.isState(R.InteractionState.ZoomDraggable)}onDragStart(e,{offsetX:t}){this.canDrag()&&(e==="pan"&&(this.panStart=(t-this.x)/this.width-this.domProxy._min),this.ctx.zoomManager.fireZoomPanStartEvent("navigator"))}onDrag(e,{offsetX:t}){if(!this.canDrag())return;const{panStart:i,x:s,width:n}=this,{minRange:a}=this.domProxy;let{_min:r,_max:o}=this.domProxy;const l=(t-s)/n;if(e==="min")r=we(0,l,o-a);else if(e==="max")o=we(r+a,l,1);else if(e==="pan"&&i!=null){const c=o-r;r=we(0,l-i,1-c),o=r+c}this.domProxy._min=r,this.domProxy._max=o,this.updateZoom()}onZoomChange(e){const{x:t}=e;if(!t)return;const{x:i,y:s,width:n,height:a}=this,{min:r,max:o}=t;this.domProxy.updateMinMax(r,o),this.layoutNodes(i,s,n,a,r,o)}layoutNodes(e,t,i,s,n,a){const{rangeSelector:r,mask:o,minHandle:l,maxHandle:c}=this;o.layout(e,t,i,s,n,a),r.layout(e,t,i,s,l.width/2,c.width/2),Dc.align(l,c,e,t,i,s,n,a,o.strokeWidth/2),n+(a-n)/2<.5?(l.zIndex=3,c.zIndex=4):(l.zIndex=4,c.zIndex=3),[l,this.maskVisibleRange,c].forEach((h,d)=>{const u=h.getBBox(),p={x:u.x-e,y:u.y-t,height:u.height,width:u.width};this.domProxy.updateSliderBounds(d,p)})}updateZoom(){this.enabled&&this.domProxy.updateZoom()}updateData(e){var t;return(t=this.miniChart)==null?void 0:t.updateData(e)}async processData(e){var t;if(this.miniChart)return(t=this.miniChart)==null?void 0:t.processData(e)}};C([iI((e,t,i)=>{e.updateBackground(i==null?void 0:i.root,t==null?void 0:t.root)})],up.prototype,"miniChart",2),C([gx,iI((e,t)=>{e.ctx.zoomManager.setNavigatorEnabled(!!t),e.updateGroupVisibility()})],up.prototype,"enabled",2),C([gx],up.prototype,"height",2),C([gx,iI((e,t)=>{e.mask.cornerRadius=t})],up.prototype,"cornerRadius",2),C([gx],up.prototype,"spacing",2);var kpe={enabled:!1,height:18,cornerRadius:4,mask:{fill:{$ref:"foregroundColor"},fillOpacity:.1,stroke:{$ref:"borderColor"},strokeWidth:1},minHandle:{fill:{$ref:"backgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},maxHandle:{fill:{$ref:"backgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},miniChart:{enabled:!1,label:{color:{$ref:"textColor"},fontSize:{$rem:[R.FONT_SIZE_RATIO.SMALLER]},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:5},padding:{top:0,bottom:0}}},Lpe={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new up(e),removable:!1,themeTemplate:{navigator:kpe}},{ToolbarButtonProperties:Ppe,Property:Epe}=R,eG=class extends Ppe{};C([Epe],eG.prototype,"value",2);var{ChartAxisDirection:sI,LayoutElement:Rpe,PropertiesArray:Npe,Toolbar:Ope,Property:tG}=R,nI=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.buttons=new Npe(eG),this.verticalSpacing=10,this.container=e.domManager.addChild("canvas-overlay","range-buttons"),this.container.role="presentation",this.toolbar=new Ope(this.ctx.localeManager),this.toolbar.addClass("ag-charts-range-buttons"),this.container.append(this.toolbar.getElement()),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),e.layoutManager.registerElement(Rpe.ToolbarBottom,this.onLayoutStart.bind(this)),e.zoomManager.addListener("zoom-change",this.onZoomChanged.bind(this)),this.teardown.bind(this))}teardown(){this.container.removeChild(this.toolbar.getElement()),this.toolbar.destroy()}onLayoutStart(e){const{buttons:t,ctx:i,enabled:s,toolbar:n,verticalSpacing:a}=this,{layoutBox:r}=e;if(!s||!i.zoomManager.isZoomEnabled()){n.setHidden(!0);return}n.setHidden(!1),n.updateButtons(t);const o=n.getBounds().height;n.setBounds({x:r.x,y:r.y+r.height-o,width:r.width,height:o}),r.shrink({bottom:o+a})}onZoomChanged(){this.toolbar.clearActiveButton()}onButtonPress({button:{index:e}}){const{zoomManager:t}=this.ctx,i=this.buttons.at(e);if(!i)return;const{value:s}=i;typeof s=="number"?t.extendToEnd("zoom-buttons",sI.X,s):Array.isArray(s)?t.updateWith("zoom-buttons",sI.X,()=>s):typeof s=="function"&&t.updateWith("zoom-buttons",sI.X,s),this.toolbar.toggleActiveButtonByIndex(e)}};C([tG],nI.prototype,"enabled",2),C([tG],nI.prototype,"buttons",2);var iG=1e3*60*60*24,aI=iG*30,Fpe=iG*365,Bpe={type:"root",optionsKey:"ranges",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new nI(e),themeTemplate:{ranges:{enabled:!1,buttons:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:aI},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:3*aI},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:6*aI},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:(e,t)=>[new Date(`${new Date(t).getFullYear()}-01-01`).getTime(),t]},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:Fpe},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:(e,t)=>[e,t]}]}}},sG=class Pm extends R.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.activeSections=new Set,this.sectionButtons={annotations:[],chartToolbar:[]},this.container=this.ctx.domManager.addChild("canvas-overlay","shared-toolbar"),this.container.role="presentation"}getSharedToolbar(t){return this.sharedToolbar||this.createSharedToolbar(),this.toolbarWithSection(t)}createSharedToolbar(){this.sharedToolbar=new R.Toolbar(this.ctx.localeManager,"vertical"),this.sharedToolbar.addClass("ag-charts-shared-toolbar"),this.container.append(this.sharedToolbar.getElement()),this.destroyFns.push(()=>{this.sharedToolbar&&(this.container.removeChild(this.sharedToolbar.getElement()),this.sharedToolbar.destroy(),this.sharedToolbar=void 0)})}toolbarWithSection(t){const i=this.sharedToolbar,s={layout:(n,a)=>{if(this.firstLayoutSection!=null&&this.firstLayoutSection!==t&&this.activeSections.has(this.firstLayoutSection))return;this.firstLayoutSection=t;const r=i.getBounds().width;i.setBounds({x:n.x,y:n.y,width:r}),n.shrink({left:r+i.horizontalSpacing+(a!=null?a:0)})},addToolbarListener:(n,a)=>i.addToolbarListener(n,r=>{const o=this.getSectionIndex(t,r.button.index);if(o<0)return;const l=E(b({},r),{button:this.sectionButtons[t][o]});a(l)}),updateButtons:n=>{this.sectionButtons[t]=n;const a=Pm.SECTION_ORDER.flatMap(r=>this.sectionButtons[r]);i.updateButtons(a)},updateButtonByIndex:(n,a)=>{i.updateButtonByIndex(this.getIndex(t,n),a)},toggleActiveButtonByIndex:n=>{i.toggleActiveButtonByIndex(this.getIndex(t,n))},toggleButtonEnabledByIndex:(n,a)=>{i.toggleButtonEnabledByIndex(this.getIndex(t,n),a)},setHidden:n=>{n?this.activeSections.delete(t):this.activeSections.add(t);let a=0;for(const r of Pm.SECTION_ORDER){if(r!==t){a+=this.sectionButtons[r].length;continue}for(const o of this.sectionButtons[t].keys())i.setButtonHiddenByIndex(a+o,n)}},destroy:()=>{s.setHidden(!0),this.activeSections.size===0&&this.destroy()},clearActiveButton:i.clearActiveButton.bind(i),addListener:i.addListener.bind(i),removeListener:i.removeListener.bind(i)};return s.setHidden(!1),s}getIndex(t,i){let s=0;for(const n of Pm.SECTION_ORDER){if(n===t)return s+i;s+=this.sectionButtons[n].length}return-1}getSectionIndex(t,i){let s=0;for(const n of Pm.SECTION_ORDER){if(n===t)return i>=s+this.sectionButtons[t].length?-1:i-s;s+=this.sectionButtons[n].length}return-1}};sG.SECTION_ORDER=["chartToolbar","annotations"];var _pe=sG,Gpe={type:"context",contextKey:"sharedToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new _pe(e)},{CachedTextMeasurerPool:qf,ZIndexMap:zpe,LayoutElement:Vpe,Property:bn,BaseProperties:jpe,valueProperty:Hpe,TextUtils:Wpe,Group:Upe,Label:Qf,Rect:Kpe,Text:ms}=R,nG={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,hlc:184,"high-low":800},$pe={up:"positive",down:"negative"},Ype={hlc:"altNeutral"},rI=class extends jpe{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};C([bn],rI.prototype,"fill",2),C([bn],rI.prototype,"fillOpacity",2);var Bn=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new Qf,this.positive=new Qf,this.negative=new Qf,this.neutral=new Qf,this.altNeutral=new Qf,this.background=new rI,this.layoutStyle="block",this.id="status-bar",this.data=void 0,this.layer=new Upe({name:"StatusBar",zIndex:zpe.STATUS_BAR}),this.labelGroup=this.layer.appendChild(new R.TranslatableGroup),this.backgroundNode=this.labelGroup.appendChild(new Kpe),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new ms),value:this.labelGroup.appendChild(new ms),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=e.highlightManager,this.labelGroup.visible=!1,this.destroyFns.push(e.scene.attachNode(this.layer),e.layoutManager.registerElement(Vpe.Overlay,t=>this.startPerformLayout(t)),e.layoutManager.addListener("layout:complete",t=>this.onLayoutComplete(t)),e.highlightManager.addListener("highlight-change",()=>this.updateHighlight()))}async processData(e){if(!this.enabled||this.data==null)return;const t=[];for(const n of this.labels){const{id:a,key:r}=n,o=this[r];o==null?n.domain=void 0:t.push(Hpe(o,"number",{id:a}))}if(t.length===0)return;const{processedData:i,dataModel:s}=await e.request(this.id,this.data,{props:t});for(const n of this.labels){const{id:a,key:r}=n;this[r]!=null&&(n.domain=s.getDomain(this,a,"value",i))}}startPerformLayout(e){var u;if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled)return;const{layoutBox:t}=e,i=4,s=12,n=0,a=8;this.labelGroup.translationY=t.y+n;const r=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),o=Wpe.getLineHeight(r),l=(u=nG[this.getChartType()])!=null?u:0;let c=0,h,d="alphabetic";if(this.layoutStyle==="block")t.shrink(n+o+a,"top"),h=r+(o-r)/2;else{const{title:p}=this.ctx.chartService;if(d="top",h=n+p.padding,p.enabled){const g=p.node.getBBox();c=g.x+g.width+s}else c=p.padding}for(const{label:p,configuration:g,title:f,value:y,domain:v,formatter:x}of this.labels){if(v==null||(l&g)===0){f.visible=!1,y.visible=!1;continue}const S=Math.max(qf.measureText(x.format(v[0]),{font:this.positive.getFont(),textBaseline:d,textAlign:"left"}).width,qf.measureText(x.format(v[1]),{font:this.positive.getFont(),textBaseline:d,textAlign:"left"}).width,qf.measureText(x.format(v[0]),{font:this.negative.getFont(),textBaseline:d,textAlign:"left"}).width,qf.measureText(x.format(v[1]),{font:this.negative.getFont(),textBaseline:d,textAlign:"left"}).width);f.visible=!0,y.visible=!0;const M=qf.measureText(p,{font:this.title.getFont(),textBaseline:d,textAlign:"left"});f.setFont(this.title),f.fill=this.title.color,f.text=p,f.textBaseline=d,f.y=h,f.x=c,c+=M.width+i,y.textBaseline=d,y.y=h,y.x=c,c+=S+s}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=c-s,this.backgroundNode.height=o+n+a,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(e){this.labelGroup.translationX=e.series.rect.x,this.updateHighlight()}updateHighlight(){var n,a,r,o;if(!this.enabled)return;const e=this.highlightManager.getActiveHighlight(),t=(a=e==null?void 0:e.datum)!=null?a:(n=this.data)==null?void 0:n.at(-1);if(t==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const i=e==null?void 0:e.itemId;let s=i!=null?$pe[i]:void 0;s==null&&this.openKey!=null&&this.closeKey!=null&&(t[this.openKey]<t[this.closeKey]?s="positive":s="negative");for(const{domain:l,value:c,key:h,formatter:d,style:u}of this.labels){if(l==null)continue;let p=(r=u!=null?u:s)!=null?r:"neutral";p==="neutral"&&(p=(o=Ype[this.getChartType()])!=null?o:p);const g=this[h],f=g!=null?t==null?void 0:t[g]:void 0;c.setFont(this[p]),c.fill=this[p].color,c.text=typeof f=="number"?d.format(f):""}}getChartType(){var t,i;let e=(i=(t=this.ctx.chartService.publicApi)==null?void 0:t.getOptions())==null?void 0:i.chartType;return(e==null||nG[e]==null)&&(e="candlestick"),e}};C([bn],Bn.prototype,"enabled",2),C([bn],Bn.prototype,"openKey",2),C([bn],Bn.prototype,"highKey",2),C([bn],Bn.prototype,"lowKey",2),C([bn],Bn.prototype,"closeKey",2),C([bn],Bn.prototype,"volumeKey",2),C([bn],Bn.prototype,"title",2),C([bn],Bn.prototype,"positive",2),C([bn],Bn.prototype,"negative",2),C([bn],Bn.prototype,"neutral",2),C([bn],Bn.prototype,"altNeutral",2),C([bn],Bn.prototype,"background",2),C([bn],Bn.prototype,"layoutStyle",2);var Xpe={type:"root",identifier:"status-bar",optionsKey:"statusBar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new Bn(e),themeTemplate:{statusBar:{enabled:!1,layoutStyle:R.ThemeSymbols.DEFAULT_CAPTION_LAYOUT_STYLE,title:{color:{$ref:"textColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},positive:{color:{$palette:"up.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},negative:{color:{$palette:"down.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},neutral:{color:{$palette:"neutral.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},background:{fill:{$ref:"backgroundColor"},fillOpacity:.5},altNeutral:{color:"gray",fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}}}}},{BaseProperties:Zpe,CartesianAxis:oI,ChartAxisDirection:dd,ContinuousScale:lI,ChartUpdateType:fx,ObserveChanges:pp,TooltipManager:qpe,Property:gp,findMinMax:mx,isObjectWithStringProperty:Qpe}=R,io=R.Debug.create("sync");function aG(e,t,i){var a;const s=e.getKeys(t),n=e.getKeys(i);return(a=e.shouldFlipXY)!=null&&a.call(e)?[n,s]:[s,n]}function cI(e="x"){switch(e){case"x":return[dd.X];case"y":return[dd.Y];case"xy":return[dd.X,dd.Y]}}var wc=class extends Zpe{constructor(e){super(),this.moduleContext=e,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0,this.domainMode="key",this.domainSync=new o0}updateSiblings(e){const{syncManager:t}=this.moduleContext;for(const i of t.getGroupSiblings(e!=null?e:this.groupId))io("ChartSync.updateSiblings()",i.id,i),this.updateChart(i)}updateChart(e,t=fx.PROCESS_DOMAIN){io("ChartSync.updateChart()",e.id,fx[t],e),t===fx.PROCESS_DOMAIN?e.ctx.updateService.update(t,{forceNodeDataRefresh:!0}):e.ctx.updateService.update(t)}enabledZoomSync(){var i;const{syncManager:e,zoomManager:t}=this.moduleContext;(i=this.disableZoomSync)==null||i.call(this),this.disableZoomSync=t.addListener("zoom-change",()=>{var s;for(const n of e.getGroupSiblings(this.groupId))(s=n.modulesManager.getModule("sync"))!=null&&s.zoom&&n.ctx.zoomManager.updateZoom("sync",this.mergeZoom(n))})}enabledNodeInteractionSync(){var t;const{highlightManager:e}=this.moduleContext;(t=this.disableNodeInteractionSync)==null||t.call(this),this.disableNodeInteractionSync=e.addListener("highlight-change",this.onHighlightChange.bind(this))}onHighlightChange(e){var h,d,u,p,g;const{syncManager:t}=this.moduleContext;if(e.callerId.endsWith("-sync"))return;io("ChartSync.onHighlightChange()",e);const i=(h=e.currentHighlight)==null?void 0:h.series,[s]=cI(this.axes),n=s===dd.X?dd.Y:dd.X,[a,r]=i?aG(i,s,n):[];let o=a!=null&&a[0]?(u=(d=e.currentHighlight)==null?void 0:d.datum)==null?void 0:u[a[0]]:void 0;const l=Mr(o);if(l&&(o=o.getTime()),!((p=e.currentHighlight)!=null&&p.datum)){for(const f of t.getGroupSiblings(this.groupId))(g=f.modulesManager.getModule("sync"))!=null&&g.nodeInteraction&&(f.ctx.highlightManager.updateHighlight(`${f.id}-sync`),f.ctx.tooltipManager.removeTooltip(`${f.id}-sync`));return}const c=t.getGroupSyncMode(this.groupId)==="multi-series";this.findMatchingHighlightNodes(s,n,c?r:[],l,o,e)}findMatchingHighlightNodes(e,t,i,s,n,a){var o,l;const{syncManager:r}=this.moduleContext;io("ChartSync.findMatchingHighlightNodes()",{mainDirection:e,secondaryKeys:i});for(const c of r.getGroupSiblings(this.groupId)){if(!((o=c.modulesManager.getModule("sync"))!=null&&o.nodeInteraction))continue;let h=!1;for(const d of c.axes){if(!oI.is(d)||d.direction!==e)continue;const u=c.series.filter(p=>{if(!p.visible)return!1;if(i.length>0){const[,g]=aG(p,e,t);return i.every(f=>g.includes(f))}return!0}).map(this.findMatchingNodes(d,e,s,n)).filter(ni);if(u.length===1&&((l=u[0])==null?void 0:l.nodeDatum)!==c.ctx.highlightManager.getActiveHighlight()){this.dispatchHighlightUpdate(c,u[0].nodeDatum),h=!0;break}}h||(io("ChartSync.findMatchingHighlightNodes() - no matching nodes",c.id,a),this.dispatchHighlightUpdate(c))}}findMatchingNodes(e,t,i,s){return n=>{var d,u;const a=n.getKeys(e.direction);if(e.keys.length&&!e.keys.some(p=>a.includes(p)))return;const r=(u=(d=n.contextNodeData)==null?void 0:d.nodeData)!=null?u:[];if(!(r!=null&&r.length))return;const o=r[0],l=`${t}Key`;if(!Qpe(o,l))return;const c=o[l],h=r.find(p=>{const g=p.datum[c];return i?g.getTime()===s:g===s});return h?{series:n,nodeDatum:h}:null}}dispatchHighlightUpdate(e,t){var s,n,a,r,o,l,c,h,d;io("ChartSync.dispatchHighlightUpdate()",e.id,t),e.ctx.highlightManager.updateHighlight(`${e.id}-sync`,t);const i=(s=t==null?void 0:t.series.tooltipEnabled)!=null?s:e.tooltip.enabled;if(t&&i){const u=e.seriesAreaBoundingBox,p=u.x+((o=(r=(n=t.midPoint)==null?void 0:n.x)!=null?r:(a=t.point)==null?void 0:a.x)!=null?o:0),g=u.y+((d=(h=(l=t.midPoint)==null?void 0:l.y)!=null?h:(c=t.point)==null?void 0:c.y)!=null?d:0),f=qpe.makeTooltipMeta({type:"pointermove",canvasX:p,canvasY:g},t.series,t,void 0);e.ctx.tooltipManager.updateTooltip(`${e.id}-sync`,f,e.getTooltipContent(t.series,t.datumIndex,t))}else e.ctx.tooltipManager.removeTooltip(`${e.id}-sync`);this.updateChart(e,fx.SERIES_UPDATE)}async getSyncedDomain(e){if(!oI.is(e)||this.axes!=="xy"&&this.axes!==e.direction)return;const{groupState:t,directionDomains:i,domainsByKey:s,positionDomains:n}=this.updateDomainState(e);return this.validateAxis(e,t),await this.waitForDomainsToBeReady(),this.domainMode==="position"?this.calculateDerivedDomain(e,n):this.domainMode==="direction"||e.keys.length===0?this.calculateDerivedDomain(e,i):this.calculateKeyDerivedDomain(e,s)}updateDomainState(e){var v,x,S,M,D,A,w,T,k,N;var t,i,s,n,a;const{syncManager:r}=this.moduleContext,o=r.getChart().id,l=e.id,c=r.getGroupState(this.groupId);if(!c)throw new Error("AG Charts - no GroupState for groupId: "+this.groupId);const h=(v=c.domains)!=null?v:c.domains={},d=(x=h[t=e.direction])!=null?x:h[t]={derived:[],sources:{},dirty:!0},u=(S=(i=d.sources)[o])!=null?S:i[o]={};u[l]=e.dataDomain.domain,d.dirty=!0;const p=(M=c.domainsByKey)!=null?M:c.domainsByKey={};for(const O of(D=e.keys)!=null?D:[]){const L=(A=p[O])!=null?A:p[O]={derived:[],sources:{},dirty:!0},F=(w=(s=L.sources)[o])!=null?w:s[o]={};F[l]=e.dataDomain.domain,L.dirty=!0}const g=(T=c.domainsByPosition)!=null?T:c.domainsByPosition={},f=(k=g[n=e.position])!=null?k:g[n]={derived:[],sources:{},dirty:!0},y=(N=(a=f.sources)[o])!=null?N:a[o]={};return y[l]=e.dataDomain.domain,f.dirty=!0,{groupState:c,directionDomains:d,domainsByKey:p,positionDomains:f}}validateAxis(e,t){const i=this.moduleContext.syncManager.getGroupSyncMode(this.groupId)==="multi-series";cI(this.axes).includes(e.direction)&&(i?this.validateMultiSeries(e,t):this.validateSingleSeries(e,t))}validateMultiSeries(e,t){var o;const{min:i,max:s,nice:n,reverse:a}=e,r=new Set(e.boundSeries.flatMap(l=>l.getKeys(e.direction)));for(const l of t.members){const{axes:c,modulesManager:h}=l,d=cI((o=h.getModule("sync"))==null?void 0:o.axes),u=c.filter(g=>d.includes(g.direction)).filter(g=>g.boundSeries.some(f=>f.getKeys(g.direction).some(y=>r.has(y))));if(u.length===0)continue;const[p]=u;if(p.min!==i||p.max!==s||p.nice!==n||p.reverse!==a){se.warnOnce("To allow synchronization, ensure that all synchronized axes with matching keys have matching min, max, nice, and reverse properties."),this.enabled=!1;return}}}validateSingleSeries(e,t){const i=t.members,[{axes:s}]=i,{direction:n,min:a,max:r,nice:o,reverse:l}=e;for(const c of s)if(n===c.direction&&(o!==c.nice||l!==c.reverse||a!==c.min&&(Xe(a)||Xe(c.min))||r!==c.max&&(Xe(r)||Xe(c.max)))){se.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}}calculateDerivedDomain(e,t){if(!t.dirty)return t.derived;const i=t.derived;return t.derived=a0(Object.values(t.sources).map(s=>Object.values(s)).flat(2)),lI.is(e.scale)&&(t.derived=mx(t.derived)),t.dirty=!1,fa(i,t.derived)||(io(e.id,"updated",e.keys,{before:i,after:t.derived}),this.updateSiblings()),t.derived}calculateKeyDerivedDomain(e,t){var a;let i=[],s=[],n=!1;for(const r of(a=e.keys)!=null?a:[]){const o=t[r],l=o.derived;if(i.push(...l),!o.dirty){s.push(...o.derived);continue}o.derived=a0(Object.values(o.sources).map(c=>Object.values(c)).flat(2)),lI.is(e.scale)&&(o.derived=mx(o.derived)),s.push(...o.derived),o.dirty=!1,n||(n=!fa(l,o.derived))}return lI.is(e.scale)&&(i=mx(i),s=mx(s)),n&&!fa(i,s)&&(io(e.id,"updated",e.keys,{before:i,after:s}),this.updateSiblings()),s}removeAxis(e){var a,r,o,l,c,h,d,u,p,g,f,y,v;if(!oI.is(e)||this.axes!=="xy"&&this.axes!==e.direction)return;const{syncManager:t}=this.moduleContext,i=t.getGroupState(this.groupId),s=t.getChart().id,n=e.id;(l=(o=(r=(a=i==null?void 0:i.domains)==null?void 0:a[e.direction])==null?void 0:r.sources)==null?void 0:o[s])==null||delete l[n];for(const x of(c=e.keys)!=null?c:[])(p=(u=(d=(h=i==null?void 0:i.domainsByKey)==null?void 0:h[x])==null?void 0:d.sources)==null?void 0:u[s])==null||delete p[n];(v=(y=(f=(g=i==null?void 0:i.domainsByPosition)==null?void 0:g[e.position])==null?void 0:f.sources)==null?void 0:y[s])==null||delete v[n]}async waitForDomainsToBeReady(){const{syncManager:e}=this.moduleContext;let t=0;for(;e.getGroupMembers(this.groupId).some(i=>i.syncStatus==="init");)io("ChartSync.waitForDomainsToBeReady() - waiting for all domains to be calculated",this.groupId),await this.domainSync.await(),t++;t>0&&io("ChartSync.waitForDomainsToBeReady() - waited for",t,"iterations"),this.domainSync.notify()}mergeZoom(e){var s,n;const{zoomManager:t}=this.moduleContext;if(this.axes==="xy")return t.getZoom();const i=(s=e.ctx.zoomManager.getZoom())!=null?s:{};return i[this.axes]=(n=t.getZoom())==null?void 0:n[this.axes],i}onEnabledChange(){const{syncManager:e}=this.moduleContext;this.enabled?e.subscribe(this.groupId):e.unsubscribe(this.groupId),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(e,t){if(!this.enabled||e===t)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(t),i.subscribe(e),this.updateSiblings(t),this.updateSiblings(e)}onAxesChange(){if(!this.enabled)return;const{syncManager:e}=this.moduleContext;this.updateChart(e.getChart())}onNodeInteractionChange(){var e;this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():(e=this.disableNodeInteractionSync)==null||e.call(this)}onZoomChange(){var e;this.enabled&&this.zoom?this.enabledZoomSync():(e=this.disableZoomSync)==null||e.call(this)}destroy(){var t;const{syncManager:e}=this.moduleContext;e.unsubscribe(this.groupId),this.updateSiblings(),(t=this.disableZoomSync)==null||t.call(this)}};wc.className="Sync",C([gp,pp(e=>e.onEnabledChange())],wc.prototype,"enabled",2),C([gp,pp((e,t,i)=>e.onGroupIdChange(t,i))],wc.prototype,"groupId",2),C([gp,pp(e=>e.onAxesChange())],wc.prototype,"axes",2),C([gp,pp(e=>e.onNodeInteractionChange())],wc.prototype,"nodeInteraction",2),C([gp,pp(e=>e.onZoomChange())],wc.prototype,"zoom",2),C([gp,pp(e=>e.onAxesChange())],wc.prototype,"domainMode",2);var Jpe={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:e=>new wc(e),themeTemplate:{sync:{enabled:!1}}},{Property:rG}=R,oG="#2196f3",ege="#8a8a8a",yx=class extends R.Rect{constructor(){super(...arguments),this.fill=oG,this.fillOpacity=.2,this.zIndex=R.ZIndexMap.ZOOM_SELECTION}updateValid(){this.fill=oG}updateInvalid(){this.fill=ege}};yx.className="ZoomRect",C([rG],yx.prototype,"fill",2),C([rG],yx.prototype,"fillOpacity",2);var ei={min:0,max:1},ud=ei.max-ei.min,lG="end",cG="middle",vx=(e,t=ei.min,i=ei.max)=>we(t,e,i);function hI(){return{x:b({},ei),y:b({},ei)}}function ys(e){return e.x.max-e.x.min}function na(e){return e.y.max-e.y.min}function hG(e,t,i=1e-10){return mt(e.min,t.min,i)&&mt(e.max,t.max,i)}function Jf(e,t,i){return hG(e.x,t.x,i)&&hG(e.y,t.y,i)}function en(e){var t,i,s,n,a,r,o,l;return{x:{min:(i=(t=e==null?void 0:e.x)==null?void 0:t.min)!=null?i:ei.min,max:(n=(s=e==null?void 0:e.x)==null?void 0:s.max)!=null?n:ei.max},y:{min:(r=(a=e==null?void 0:e.y)==null?void 0:a.min)!=null?r:ei.min,max:(l=(o=e==null?void 0:e.y)==null?void 0:o.max)!=null?l:ei.max}}}function rl(e,t,i){if(!e)return{x:0,y:0};const s=vx(t-e.x,0,e.x+e.width),n=vx(i-e.y,0,e.y+e.height),a=1/e.width*s,r=1-1/e.height*n;return{x:vx(a),y:vx(r)}}function pd(e,t,i){return{x:{min:e.x.min+t,max:e.x.max+t},y:{min:e.y.min+i,max:e.y.max+i}}}function bx(e,t,i){return{x:{min:e.x.min,max:e.x.min+ys(e)*t},y:{min:e.y.min,max:e.y.min+na(e)*i}}}function dG(e,t,i){const s=ys(e),n=na(e),a=e.x.min+s/2,r=e.y.min+n/2;return{x:{min:a-s*t/2,max:a+s*t/2},y:{min:r-n*i/2,max:r+n*i/2}}}function aa(e,t,i,s){const{min:n,max:a}=t,r=n+(a-n)/2,o=e.max-e.min;switch(i){case"start":return{min:n,max:t.min+o};case"end":return{min:t.max-o,max:a};case"middle":return{min:r-o/2,max:r+o/2};case"pointer":return tge(e,t,s!=null?s:r);default:return{min:n,max:a}}}function tge(e,t,i){const s=e.max-e.min,n=t.max-t.min,a=i*(1-(n-s)),r=i-a,o=e.min+r,l=e.max+r;return{min:o,max:l}}function ige(e,t,i){return{x:{min:e.x.min*t,max:e.x.max*t},y:{min:e.y.min*i,max:e.y.max*i}}}function Ga(e){return{x:xx(e.x),y:xx(e.y)}}function xx(e){const t=e.max-e.min;let i=e.max>ei.max?ei.max-t:e.min,s=e.min<ei.min?t:e.max;return i=Math.max(ei.min,i),s=Math.min(ei.max,s),{min:i,max:s}}var sge=class{update(e,t,i,s,n,a){var r;return(r=this.oldZoom)!=null||(this.oldZoom=en(t===R.ChartAxisDirection.X?E(b({},n),{x:a}):E(b({},n),{y:a}))),this.updateCoords(e.currentX,e.currentY),this.updateZoom(t,i,s)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(e,t){this.coords?(this.coords.x2=e,this.coords.y2=t):this.coords={x1:e,y1:t,x2:e,y2:t}}updateZoom(e,t,i){const{coords:s,oldZoom:n}=this;let a=en(n);if(!s||!n)return e===R.ChartAxisDirection.X?a.x:a.y;const r=rl(i,s.x1,s.y1),o=rl(i,s.x2,s.y2);if(e===R.ChartAxisDirection.X){const c=(o.x-r.x)*ys(n);return a.x.max+=c,a.x=aa(a.x,n.x,t,r.x),a=Ga(a),a.x}const l=(o.y-r.y)*na(n);return a.y.max-=l,a.y=aa(a.y,n.y,t,r.y),a=Ga(a),a.y}},nge=class{constructor(e,t,i,s,n,a){this.contextMenuRegistry=e,this.zoomManager=t,this.getModuleProperties=i,this.getRect=s,this.updateZoom=n,this.isZoomValid=a}registerActions(e){const{contextMenuRegistry:t}=this;if(e)t.setVisible("zoom-to-cursor",!0),t.setVisible("pan-to-cursor",!0);else{t.setVisible("zoom-to-cursor",!1),t.setVisible("pan-to-cursor",!1);return}t.builtins.items["zoom-to-cursor"].action=this.onZoomToHere.bind(this),t.builtins.items["pan-to-cursor"].action=this.onPanToHere.bind(this);const i=a=>{const r=this.getRect();if(!r)return!0;const o=rl(r,a.x,a.y);return this.iterateFindNextZoomAtPoint(o)!=null},s=()=>!Jf(en(this.zoomManager.getZoom()),hI()),n=t.addListener("context-setup",a=>{t.builtins.items["zoom-to-cursor"].enabled=i(a),t.builtins.items["pan-to-cursor"].enabled=s()});return()=>{n(),t.setVisible("zoom-to-cursor",!1),t.setVisible("pan-to-cursor",!1)}}computeOrigin(e){const t=this.getRect(),{enabled:i}=this.getModuleProperties();if(!i||!t||!(e!=null&&e.target)||!(e instanceof MouseEvent))return;const s={x:0,y:0,width:t.width,height:t.height};return rl(s,e.offsetX,e.offsetY)}onZoomToHere({event:e}){const t=this.computeOrigin(e);if(!t)return;const i=this.iterateFindNextZoomAtPoint(t);i!=null&&this.updateZoom(i)}onPanToHere({event:e}){const t=this.computeOrigin(e);if(!t)return;const i=en(this.zoomManager.getZoom()),s=ys(i),n=na(i),a=t.x*s,r=t.y*n,o=ud/2;let l={x:{min:t.x-o,max:t.x+o},y:{min:t.y-o,max:t.y+o}};l=dG(l,s,n),l=pd(l,i.x.min-t.x+a,i.y.min-t.y+r),this.updateZoom(Ga(l))}iterateFindNextZoomAtPoint(e){const{scrollingStep:t}=this.getModuleProperties();for(let i=t;i<=1-t;i+=t){const s=this.getNextZoomAtPoint(e,i);if(this.isZoomValid(s))return s}}getNextZoomAtPoint(e,t){const{isScalingX:i,isScalingY:s}=this.getModuleProperties(),n=en(this.zoomManager.getZoom()),a=e.x*ys(n),r=e.y*na(n),o=ud/2;let l={x:{min:e.x-o,max:e.x+o},y:{min:e.y-o,max:e.y+o}};return l=dG(l,i?ys(n)*t:ud,s?na(n)*t:ud),l=pd(l,n.x.min-e.x+a,n.y.min-e.y+r),Ga(l)}},{BBoxValues:age,ChartAxisDirection:rge}=R,oge=class{constructor(e){this.axesHandlers=e,this.axes=[]}destroy(){this.axes.forEach(e=>e.div.destroy())}update(e,t){if(this.axes.forEach(o=>o.div.setHidden(!e)),!e)return;const{X:i,Y:s}=R.ChartAxisDirection,n=[...t.axisManager.getAxisContext(i),...t.axisManager.getAxisContext(s)],{removed:a,added:r}=this.diffAxisIds(n);a.length>0&&(this.axes=this.axes.filter(o=>a.includes(o.axisId)?(o.div.destroy(),!1):!0));for(const o of r){const{axisId:l,direction:c}=o;this.axes.push(this.initAxis(t,l,this.axesHandlers,c))}for(const o of this.axes){const c=n.find(h=>h.axisId===o.axisId).getCanvasBounds();o.div.setHidden(age.isEmpty(c)),c!==void 0&&o.div.setBounds(c)}}toggleAxisDraggingCursor(e,t){for(const i of this.axes)i.direction===e&&i.div.setCursor(t?this.getCursor(e):void 0)}getCursor(e){return e===rge.X?"ew-resize":"ns-resize"}initAxis(e,t,i,s){const a=e.proxyInteractionService.createProxyElement({type:"region",domManagerId:t,where:"afterend"});return a.setCursor(this.getCursor(s)),a.addListener("drag-start",r=>{r.device==="touch"&&r.sourceEvent.preventDefault(),i.onDragStart(t,s)}),a.addListener("drag-move",r=>i.onDrag(r)),a.addListener("drag-end",i.onDragEnd),a.addListener("dblclick",()=>i.onDoubleClick(t,s)),{axisId:t,div:a,direction:s}}diffAxisIds(e){const t=this.axes.map(a=>a.axisId),i=e.map(a=>a.axisId),s=t.filter(a=>!i.includes(a)),n=e.filter(a=>!t.includes(a.axisId));return{removed:s,added:n}}},uG=16,lge={off:1,short:.01,long:.002},cge=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){var t;const{deceleration:e}=this;return Math.max(typeof e=="number"?e:(t=lge[e])!=null?t:1,1e-4)}addListener(e,t){return this.onUpdate=t,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(e){var a,r;this.updateCoords(e.currentX,e.currentY);const{x1:t=0,y1:i=0,x2:s=0,y2:n=0}=(a=this.coords)!=null?a:{};(r=this.onUpdate)==null||r.call(this,{type:"update",deltaX:t-s,deltaY:i-n})}start(){this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:e}=this;let t=0,i=0,s=0;if(e.length>0){const n=this.zoomCoordsHistoryIndex%uG;let a=n-1;a<0&&(a=e.length-1);let r=n;r>=e.length&&(r=0);const o=e[a],l=e[r];t=o.x-l.x,i=o.y-l.y,s=o.t-l.t}if(this.coords=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,s>0&&this.decelerationValue<1){const n=t/s,a=i/s,r=Math.hypot(n,a),o=Math.atan2(a,n),l=performance.now();this.inertiaHandle=Ct().requestAnimationFrame(c=>{this.animateInertia(c,c,l,r,o)})}}recordCurrentZoomCoords(){const{coords:e,coordsHistory:t,zoomCoordsHistoryIndex:i}=this;if(!e)return;const{x2:s,y2:n}=e,a=Date.now();t[i%uG]={x:s,y:n,t:a},this.zoomCoordsHistoryIndex+=1}animateInertia(e,t,i,s,n){var c;const a=1-this.decelerationValue,r=-s/Math.log(a),o=s*(a**(t-i)-1)/Math.log(a),l=s*(a**(e-i)-1)/Math.log(a);(c=this.onUpdate)==null||c.call(this,{type:"update",deltaX:-Math.cos(n)*(l-o),deltaY:-Math.sin(n)*(l-o)}),!(l>=r-1)&&(this.inertiaHandle=requestAnimationFrame(h=>{this.animateInertia(h,e,i,s,n)}))}updateCoords(e,t){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:e,y2:t}:this.coords={x1:e,y1:t,x2:e,y2:t}}translateZooms(e,t,i,s){const n=rl(e,e.x+Math.abs(i),e.y+e.height-Math.abs(s)),a=Math.sign(i)*n.x,r=-Math.sign(s)*n.y,o={};for(const[l,{direction:c,zoom:h}]of Zt(t)){if(h&&h.min===ei.min&&h.max===ei.max)continue;let d=en({[c]:h});d=Ga(pd(d,a*ys(d),r*na(d))),o[l]={direction:c,zoom:d[c]}}return o}},hge=200,dge=class{update(e,t,i,s){const n=e.deltaX*t*hge;return this.translateZooms(i,s,n)}translateZooms(e,t,i){const s={},n=rl(e,e.x+Math.abs(i),0),a=i<0?-n.x:n.x;for(const[r,{direction:o,zoom:l}]of Zt(t)){if(o!==R.ChartAxisDirection.X)continue;let c=en({x:l});c=Ga(pd(c,a*ys(c),0)),s[r]={direction:o,zoom:c.x}}return s}},uge=class{updateAxes(e,t,i,s){var u,p;const n=e.sourceEvent,a={},{anchorPointX:r,anchorPointY:o,isScalingX:l,isScalingY:c,scrollingStep:h}=t,d=rl(i,(u=n.offsetX)!=null?u:n.clientX,(p=n.offsetY)!=null?p:n.clientY);for(const[g,{direction:f,zoom:y}]of Zt(s)){if(y==null)continue;let v=b({},y);const x=h*e.deltaY*(y.max-y.min);if(f===R.ChartAxisDirection.X&&l)v.max+=x,v=aa(v,y,r,d.x);else if(f===R.ChartAxisDirection.Y&&c)v.max+=x,v=aa(v,y,o,d.y);else continue;a[g]={direction:f,zoom:xx(v)}}return a}update(e,t,i,s){const{anchorPointX:n,anchorPointY:a,isScalingX:r,isScalingY:o,scrollingStep:l}=t,c=e.offsetX+i.x,h=e.offsetY+i.y,d=rl(i,c,h),u=e.deltaY;let p=en(s);return p.x.max+=r?l*u*ys(s):0,p.y.max+=o?l*u*na(s):0,r&&(p.x=aa(p.x,s.x,n,d.x)),o&&(p.y=aa(p.y,s.y,a,d.y)),p=Ga(p),p}updateDelta(e,t,i){const{anchorPointX:s,anchorPointY:n,isScalingX:a,isScalingY:r,scrollingStep:o}=t;let l=en(i);return l.x.max+=a?o*-e*ys(i):0,l.y.max+=r?o*-e*na(i):0,a&&(l.x=aa(l.x,i.x,s)),r&&(l.y=aa(l.y,i.y,n)),l=Ga(l),l}},pge=class{constructor(e,t,i){this.rect=e,this.getZoom=t,this.isZoomValid=i,this.rect.visible=!1}update(e,t,i){var a,r;const s=e.currentX+((a=i==null?void 0:i.x)!=null?a:0),n=e.currentY+((r=i==null?void 0:i.y)!=null?r:0);this.rect.visible=!0,this.updateCoords(s,n,t,i),this.updateRect(i)}stop(e,t,i){let s=en();if(!e||!t)return s;this.coords&&(s=this.createZoomFromCoords(t,i));const n=t.width/e.width,a=t.height/e.height;return s=Ga(ige(s,n,a)),this.reset(),s}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible&&this.rect.width>0&&this.rect.height>0}updateCoords(e,t,i,s){if(!this.coords){this.coords={x1:e,y1:t,x2:e,y2:t};return}const{coords:n}=this;if(n.x2=e,n.y2=t,!s)return;const{isScalingX:a,isScalingY:r,keepAspectRatio:o}=i,l=this.getNormalisedDimensions();if(o&&a&&r){const c=s.width/s.height;n.y2<n.y1?n.y2=Math.min(n.y1-l.width/c,n.y1):n.y2=Math.max(n.y1+l.width/c,n.y1)}a||(n.x1=s.x,n.x2=s.x+s.width),r||(n.y1=s.y,n.y2=s.y+s.height)}updateRect(e){if(!e)return;const{rect:t}=this,i=this.getNormalisedDimensions(),{width:s,height:n}=i;let{x:a,y:r}=i;a=Math.max(a,e.x),a-=Math.max(0,a+s-(e.x+e.width)),r=Math.max(r,e.y),r-=Math.max(0,r+n-(e.y+e.height)),t.x=a,t.y=r,t.width=s,t.height=n;const o=this.createZoomFromCoords(e,this.getZoom());this.isZoomValid(o)?t.updateValid():t.updateInvalid()}createZoomFromCoords(e,t){const i=en(t),s=this.getNormalisedDimensions(),n=rl(e,s.x,s.y+s.height),a=s.width/e.width,r=s.height/e.height;let o=bx(i,a,r);const l=n.x*ys(i),c=n.y*na(i);return o=pd(o,l,c),o=Ga(o),o}getNormalisedDimensions(){var l;const{x1:e=0,y1:t=0,x2:i=0,y2:s=0}=(l=this.coords)!=null?l:{},n=e<=i?e:i,a=t<=s?t:s,r=e<=i?i-e:e-i,o=t<=s?s-t:t-s;return{x:n,y:a,width:r,height:o}}},{ActionOnSet:pG,BaseProperties:gge,ChartAxisDirection:fge,NativeWidget:mge,PropertiesArray:yge,Toolbar:vge,ToolbarButtonProperties:bge,Property:gd}=R,dI=class extends bge{};C([gd],dI.prototype,"value",2),C([gd],dI.prototype,"section",2);var fp=class extends gge{constructor(e,t,i,s,n,a,r){super(),this.ctx=e,this.getModuleProperties=t,this.getResetZoom=i,this.updateZoom=s,this.updateAxisZoom=n,this.resetZoom=a,this.isZoomValid=r,this.enabled=!1,this.buttons=new yge(dI),this.visible="hover",this.verticalSpacing=10,this.detectionRange=38,this.destroyFns=[],this.container=new mge(ke("div")),this.container.addClass("ag-charts-zoom-buttons"),e.domManager.addChild("canvas-overlay","zoom-buttons",this.container.getElement()),this.toolbar=new vge(e.localeManager),this.container.addChild(this.toolbar),this.toolbar.getElement().style.transform="translateY(54px)",this.toggleVisibility(this.visible==="always"),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("button-focused",this.onButtonFocus.bind(this)),e.widgets.containerWidget.addListener("mousemove",this.onHover.bind(this)),e.widgets.containerWidget.addListener("mouseleave",this.onLeave.bind(this)),e.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),this.teardown.bind(this))}destroy(){for(const e of this.destroyFns)e()}toggleVisibleZoomed(e){this.visible==="zoomed"&&this.toggleVisibility(!e)}teardown(){this.ctx.domManager.removeChild("canvas-overlay","zoom-buttons"),this.container.destroy()}onLayoutComplete(e){const{buttons:t,container:i}=this,{rect:s}=e.series;this.toolbar.updateButtons(t),this.toggleButtons();const n=i.getBounds().height;i.setBounds({y:s.y+s.height-n})}onHover(e){if(!this.enabled||this.visible!=="hover"||this.toolbar.isHidden())return;const{container:t,detectionRange:i,ctx:{scene:s}}=this,{currentY:n,sourceEvent:{target:a}}=e,r=t.getElement(),o=r.offsetTop-i,l=n>o&&n<s.canvas.element.offsetHeight||a===r;this.toggleVisibility(l)}onLeave(){this.visible==="hover"&&this.toggleVisibility(!1)}toggleVisibility(e,t=!1){const{container:i,toolbar:s,verticalSpacing:n}=this;s.toggleClass("ag-charts-zoom-buttons__toolbar--hidden",!e);const a=s.getElement();a.style.transitionDuration=t?"0s":"",a.style.transform=e?"translateY(0)":`translateY(${i.getBounds().height+n}px)`}toggleButtons(){const e=en(this.ctx.zoomManager.getZoom());if(!(this.previousZoom&&Jf(this.previousZoom,e))){this.previousZoom=e;for(const[t,i]of this.buttons.entries()){let s=!0;switch(i==null?void 0:i.value){case"pan-start":s=e.x.min>ei.min;break;case"pan-end":s=e.x.max<ei.max;break;case"pan-left":s=e.x.min>ei.min;break;case"pan-right":s=e.x.max<ei.max;break;case"zoom-out":s=!Jf(e,hI());break;case"zoom-in":s=this.isZoomValid(this.getNextZoomStateUnified("zoom-in",e,this.getModuleProperties()));break;case"reset":s=!Jf(e,this.getResetZoom());break}this.toolbar.toggleButtonEnabledByIndex(t,s)}}}onButtonPress({button:e}){if(!this.enabled||this.toolbar.isHidden())return;const t=this.getModuleProperties();if(t.independentAxes&&e.value!=="reset"){const i=this.ctx.zoomManager.getAxisZooms();for(const[s,{direction:n,zoom:a}]of Zt(i))a!=null&&this.onButtonPressAxis(e,t,s,n,a)}else this.onButtonPressUnified(e,t)}onButtonFocus(e){this.toggleVisibility(!0,!0)}onButtonPressAxis(e,t,i,s,n){const{isScalingX:a,isScalingY:r,scrollingStep:o}=t;let l=b({},n);const c=n.max-n.min;switch(e.value){case"pan-start":l.max=c,l.min=0;break;case"pan-end":l.min=l.max-c,l.max=ei.max;break;case"pan-left":l.min-=c*o,l.max-=c*o;break;case"pan-right":l.min+=c*o,l.max+=c*o;break;case"zoom-in":case"zoom-out":{const h=s===fge.X,d=h&&a||!h&&r;let u=e.value==="zoom-in"?1-o:1+o;d||(u=1);const p=h?this.getAnchorPointX(t):this.getAnchorPointY(t);l.max=l.min+(l.max-l.min)*u,l=aa(l,n,p);break}}this.updateAxisZoom(i,s,xx(l))}onButtonPressUnified(e,t){const{scrollingStep:i}=t,s=en(this.ctx.zoomManager.getZoom());let n=en(s);switch(e.value){case"reset":this.resetZoom();return;case"pan-start":n.x.max=ys(n),n.x.min=0;break;case"pan-end":n.x.min=ei.max-ys(n),n.x.max=ei.max;break;case"pan-left":n=pd(n,-ys(n)*i,0);break;case"pan-right":n=pd(n,ys(n)*i,0);break;case"zoom-in":case"zoom-out":{n=this.getNextZoomStateUnified(e.value,s,t);break}}this.updateZoom(Ga(n))}getNextZoomStateUnified(e,t,i){const{isScalingX:s,isScalingY:n,scrollingStep:a}=i,r=e==="zoom-in"?1-a:1+a,o=bx(t,s?r:1,n?r:1);return o.x=aa(o.x,t.x,this.getAnchorPointX(i)),o.y=aa(o.y,t.y,this.getAnchorPointY(i)),o}getAnchorPointX(e){var i;const t=(i=this.anchorPointX)!=null?i:e.anchorPointX;return t==="pointer"?lG:t}getAnchorPointY(e){var i;const t=(i=this.anchorPointY)!=null?i:e.anchorPointY;return t==="pointer"?cG:t}};C([gd,pG({changeValue(e){var t;(t=this.toolbar)==null||t.setHidden(!e)}})],fp.prototype,"enabled",2),C([gd],fp.prototype,"buttons",2),C([gd,pG({changeValue(e,t){t!=null&&this.toggleVisibility(e==="always")}})],fp.prototype,"visible",2),C([gd],fp.prototype,"anchorPointX",2),C([gd],fp.prototype,"anchorPointY",2);var fd=1e6;function Cx({min:e,max:t},i,s,n){return n===0?0:fd*((i-s)/n*(t-e)+e)}function xge(e,t,i,s,n,a){[e,t]=[Math.min(e,t),Math.max(e,t)],[i,s]=[Math.min(i,s),Math.max(i,s)];const r=fd*(i-n)/a,o=fd*(s-n)/a,l=(i-n)/(s-n),c=(e-l*t)/(fd-r+l*(o-fd)),h=(t+(o-fd)*c)/o;return{min:c,max:h}}function gG(e,t,i,s){t===0&&(t=30),s===0&&(s=30);const n=e-t,a=e+t,r=i-s,o=i+s;return!(a<r||o<n)}var Cge=class{constructor(){this.touchStart={origins:[{identifier:0,normalX:NaN,normalY:NaN},{identifier:0,normalX:NaN,normalY:NaN}]},this.initialZoom={x:{min:0,max:1},y:{min:0,max:1}},this.previous={a1:NaN,a2:NaN,b1:NaN,b2:NaN}}start(e,t,i){var g,f,y,v,x,S,M,D;if(e.sourceEvent.targetTouches.length!==2)return!1;e.sourceEvent.preventDefault();const s=Array.from(e.sourceEvent.targetTouches),{x:n,y:a,width:r,height:o}=t.getBoundingClientRect();this.initialZoom.x.min=(f=(g=i.x)==null?void 0:g.min)!=null?f:0,this.initialZoom.x.max=(v=(y=i.x)==null?void 0:y.max)!=null?v:1,this.initialZoom.y.min=(S=(x=i.y)==null?void 0:x.min)!=null?S:0,this.initialZoom.y.max=(D=(M=i.y)==null?void 0:M.max)!=null?D:1,this.touchStart.origins.forEach(A=>A.identifier=0),this.previous.a1=NaN,this.previous.a2=NaN,this.previous.b1=NaN,this.previous.b2=NaN;for(const A of[0,1]){const w=s[A].clientX,T=a+o-s[A].clientY;this.touchStart.origins[A].identifier=s[A].identifier,this.touchStart.origins[A].normalX=Cx(this.initialZoom.x,w,n,r),this.touchStart.origins[A].normalY=Cx(this.initialZoom.y,T,a,o)}const[l,c]=s,[h,d]=this.touchStart.origins,u=gG(l.clientX,l.radiusX,c.clientX,c.radiusX);return gG(l.clientY,l.radiusY,c.clientY,c.radiusY)&&(h.normalY=d.normalY=(h.normalY+d.normalY)/2),u&&(h.normalX=d.normalX=(h.normalX+d.normalX)/2),!0}update(e,t){e.sourceEvent.preventDefault();const i=Array.from(e.sourceEvent.targetTouches),{x:s,y:n,width:a,height:r}=t.getBoundingClientRect(),{origins:o}=this.touchStart,l=[0,1].map(v=>i.find(x=>x.identifier===o[v].identifier)),c=o[0].normalX,h=o[1].normalX,d=l[0].clientX,u=l[1].clientX,p=o[0].normalY,g=o[1].normalY,f=n+r-l[0].clientY,y=n+r-l[1].clientY;return this.twitchTolerantZoomPan4(c,h,d,u,p,g,f,y,s,n,a,r)}end(e){const t=Array.from(e.sourceEvent.targetTouches).map(i=>i.identifier);return!t.includes(this.touchStart.origins[0].identifier)||!t.includes(this.touchStart.origins[1].identifier)}twitchTolerantZoomPan4(e,t,i,s,n,a,r,o,l,c,h,d){const{initialZoom:u,previous:p}=this,g=fG(e,t,i,s,p,"a1","a2",l,h,u.x),f=fG(n,a,r,o,p,"b1","b2",c,d,u.y);return{x:g,y:f}}};function fG(e,t,i,s,n,a,r,o,l,c){if(e!=t){const h=n[a],d=n[r];return Math.abs(i-h)+Math.abs(s-d)<=1?(i=h,s=d):(n[a]=i,n[r]=s),xge(e,t,i,s,o,l)}else{const h=Cx(c,i,o,l),d=Cx(c,s,o,l),u=(h+d)/2,p=(e-u)/fd;return{min:c.min+p,max:c.max+p}}}var{ActionOnSet:Sx,ChartAxisDirection:md,ChartUpdateType:mG,Deprecated:yG,Property:Si,InteractionState:Mx,ProxyProperty:Sge}=R,Dx=e=>h0(e,10),vG="zoom-cursor",uI="zoom-tooltip",pI=class extends R.BaseProperties{constructor(e){super(),this.onChange=e,this.enabled=!1,this.padding=0}};C([Si,Sx({changeValue(e){this.onChange({enabled:e,padding:this.padding})}})],pI.prototype,"enabled",2),C([Si,Sx({changeValue(e){this.onChange({enabled:this.enabled,padding:e})}})],pI.prototype,"padding",2);var Ri=class extends R.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.enableAxisDragging=!0,this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.enableTwoFingerZoom=!0,this.panKey="alt",this.axes="x",this.scrollingStep=ud/10,this.keepAspectRatio=!1,this.minVisibleItems=2,this.anchorPointX=lG,this.anchorPointY=cG,this.autoScaling=new pI(i=>{this.ctx.zoomManager.setAutoScaleYAxis(i.enabled,i.padding)}),this.buttons=new fp(this.ctx,this.getModuleProperties.bind(this),this.getResetZoom.bind(this),this.updateZoom.bind(this),this.updateAxisZoom.bind(this),this.resetZoom.bind(this),this.isZoomValid.bind(this)),this.axisDragger=new sge,this.panner=new cge,this.scroller=new uge,this.scrollPanner=new dge,this.twoFingers=new Cge,this.deceleration="short",this.dragState=0,this.isState=i=>this.ctx.interactionManager.isState(i),this.destroyContextMenuActions=void 0,this.isFirstWheelEvent=!0,this.debouncedWheelReset=PQ(()=>{this.isFirstWheelEvent=!0},100);const t=new yx;this.selector=new pge(t,this.getZoom.bind(this),this.isZoomValid.bind(this)),this.contextMenu=new nge(e.contextMenuRegistry,e.zoomManager,this.getModuleProperties.bind(this),()=>this.paddedRect,this.updateZoom.bind(this),this.isZoomValid.bind(this)),this.domProxy=new oge({onDragStart:(i,s)=>this.onAxisDragStart(i,s),onDrag:i=>{this.onDragMove(E(b({},i),{currentX:i.offsetX,currentY:i.offsetY}))},onDragEnd:()=>this.onDragEnd(),onDoubleClick:(i,s)=>{this.hoveredAxis={id:i,direction:s},this.onDoubleClick(),this.hoveredAxis=void 0}}),this.destroyFns.push(e.scene.attachNode(t),e.chartEventManager.addListener("series-keynav-zoom",i=>this.onNavZoom(i)),e.widgets.seriesDragInterpreter.addListener("dblclick",i=>this.onDoubleClick(i)),e.widgets.seriesDragInterpreter.addListener("drag-move",i=>this.onDragMove(i)),e.widgets.seriesDragInterpreter.addListener("drag-start",i=>this.onDragStart(i)),e.widgets.seriesDragInterpreter.addListener("drag-end",()=>this.onDragEnd()),e.widgets.seriesWidget.addListener("wheel",i=>this.onWheel(i)),e.widgets.seriesWidget.addListener("touchstart",(i,s)=>this.onTouchStart(i,s)),e.widgets.seriesWidget.addListener("touchmove",(i,s)=>this.onTouchMove(i,s)),e.widgets.seriesWidget.addListener("touchend",i=>this.onTouchEnd(i)),e.widgets.seriesWidget.addListener("touchcancel",i=>this.onTouchEnd(i)),e.updateService.addListener("process-data",i=>this.onProcessData(i)),e.layoutManager.addListener("layout:complete",i=>this.onLayoutComplete(i)),e.zoomManager.addListener("zoom-change",i=>this.onZoomChange(i)),e.zoomManager.addListener("zoom-pan-start",i=>this.onZoomPanStart(i)),this.panner.addListener("update",i=>this.onPanUpdate(i)),()=>this.teardown())}teardown(){var e;this.ctx.zoomManager.setZoomModuleEnabled(!1),this.buttons.destroy(),(e=this.destroyContextMenuActions)==null||e.call(this)}onEnabledChange(e){var t;this.ctx.zoomManager.setZoomModuleEnabled(e),this.contextMenu&&((t=this.destroyContextMenuActions)==null||t.call(this),this.destroyContextMenuActions=this.contextMenu.registerActions(e))}isIgnoredTouch(e){if((e==null?void 0:e.device)!=="touch")return!1;if(this.ctx.chartService.touch.dragAction!=="drag")return!0;if(this.enableSelecting)return!1;if(!this.enablePanning)return!0;const{x:t,y:i}=this.getZoom();return t.min===0&&t.max===1&&i.min===0&&i.max===1}onDoubleClick(e){const{enabled:t,enableDoubleClickToReset:i,hoveredAxis:s,ctx:{zoomManager:n}}=this;!t||!i||!this.isState(Mx.ZoomClickable)||(s?n.resetAxisZoom("zoom",s.id):e!=null&&e.preventZoomDblClick||this.resetZoom())}onDragStart(e){const{enabled:t,enableAxisDragging:i,enablePanning:s,enableSelecting:n,hoveredAxis:a,ctx:{domManager:r,zoomManager:o}}=this;if(!t||!this.hoveredAxis&&(!this.isState(Mx.ZoomDraggable)||this.dragState!==0||this.isIgnoredTouch(e)))return;this.panner.stopInteractions();let l=0;if(i&&a)l=1;else if(e!=null){const c=this.isPanningKeyPressed(e.sourceEvent);s&&(!n||c)?(r.updateCursor(vG,"grabbing"),l=2,this.panner.start()):n&&!c&&(l=3)}(this.dragState=l)!==0&&o.fireZoomPanStartEvent("zoom")}onDragMove(e){const{anchorPointX:t,anchorPointY:i,axisDragger:s,dragState:n,enabled:a,paddedRect:r,panner:o,selector:l,seriesRect:c,shouldFlipXY:h,hoveredAxis:d,ctx:{interactionManager:u,tooltipManager:p,updateService:g,zoomManager:f}}=this;if(!a||!r||!c||!d&&(!this.isState(Mx.ZoomDraggable)||this.isIgnoredTouch(e)))return;u.pushState(R.InteractionState.ZoomDrag),e.device==="touch"&&e.sourceEvent.preventDefault();const y=this.getZoom();switch(n){case 1:{if(!d)break;const{id:v,direction:x}=d;let S=x===md.X?t:i;h&&(S=x===md.X?i:t);const M=f.getAxisZoom(v),D=s.update(e,x,S,c,y,M);f.setAxisManuallyAdjusted("zoom",v),this.updateAxisZoom(v,x,D);break}case 2:o.update(e);break;case 3:l.update(e,this.getModuleProperties(),r);break;case 0:return}p.updateTooltip(uI),g.update(mG.PERFORM_LAYOUT,{skipAnimations:!0})}onDragEnd(){const{axisDragger:e,dragState:t,enabled:i,panner:s,selector:n,ctx:{domManager:a,interactionManager:r,tooltipManager:o}}=this;if(r.popState(R.InteractionState.ZoomDrag),!(!i||t===0)){switch(t){case 1:this.hoveredAxis=void 0,e.stop();break;case 2:s.stop();break;case 3:{if(!n.didUpdate())break;const l=this.getZoom(),c=n.stop(this.seriesRect,this.paddedRect,l);this.updateZoom(c);break}}this.dragState=0,a.updateCursor(vG),o.removeTooltip(uI)}}onNavZoom(e){const{enabled:t,enableScrolling:i,scroller:s}=this;!this.ctx.interactionManager.isState(R.InteractionState.Default)||!t||!i||(e.widgetEvent.sourceEvent.preventDefault(),this.updateZoom(s.updateDelta(e.delta,this.getModuleProperties(),this.getZoom())))}onWheel(e){const{enabled:t,enablePanning:i,enableScrolling:s,paddedRect:n}=this;if(!t||!s||!n||!this.isState(Mx.ZoomWheelable))return;const{deltaX:a,deltaY:r}=e.sourceEvent,o=a!=null&&r!=null&&Math.abs(a)>Math.abs(r);i&&o?this.onWheelPanning(e):this.onWheelScrolling(e)}onWheelPanning(e){const{scrollingStep:t,scrollPanner:i,seriesRect:s,ctx:{zoomManager:n}}=this;if(!s)return;e.sourceEvent.preventDefault();const a=i.update(e,t,s,n.getAxisZooms());for(const[r,{direction:o,zoom:l}]of Zt(a))this.updateAxisZoom(r,o,l)}onWheelScrolling(e){const{enableAxisDragging:t,enableIndependentAxes:i,hoveredAxis:s,scroller:n,seriesRect:a,ctx:{zoomManager:r}}=this;if(!a)return;const o=this.getZoom();let l=e.deltaY>0&&this.isMaxZoom(o);const c=t&&s!=null;let h=this.isScalingX(),d=this.isScalingY();c&&(h=s.direction===R.ChartAxisDirection.X,d=!h);const u=this.getModuleProperties({isScalingX:h,isScalingY:d});let p=!0;if(i===!0){const g=n.updateAxes(e,u,a,r.getAxisZooms());for(const[f,{direction:y,zoom:v}]of Zt(g))c&&s.id!==f||p&&(p=this.updateAxisZoom(f,y,v))}else{const g=n.update(e,u,a,this.getZoom());p=this.updateUnifiedZoom(g)}l||(l=e.deltaY<0&&!p),(!this.isFirstWheelEvent||!l)&&e.sourceEvent.preventDefault(),this.isFirstWheelEvent=!1,this.debouncedWheelReset()}onAxisDragStart(e,t){this.hoveredAxis={id:e,direction:t},this.onDragStart(void 0)}onTouchStart(e,t){!this.enableTwoFingerZoom||this.dragState!==0||this.twoFingers.start(e,t,this.getZoom())&&(this.dragState=4)}onTouchMove(e,t){if(!this.enableTwoFingerZoom||this.dragState!==4)return;const i=this.twoFingers.update(e,t);this.updateZoom(Ga(i))}onTouchEnd(e){!this.enableTwoFingerZoom||this.dragState!==4||(e.sourceEvent.preventDefault(),this.twoFingers.end(e)&&(this.dragState=0))}onProcessData(e){this.shouldFlipXY=e.series.shouldFlipXY}onLayoutComplete(e){this.domProxy.update(this.enableAxisDragging,this.ctx),this.enabled&&(this.seriesRect=e.series.rect,this.paddedRect=e.series.paddedRect,this.enableAxisDragging&&this.toggleAxisDraggingCursors())}onZoomChange(e){e.callerId!=="zoom"&&this.panner.stopInteractions();const t=this.getZoom();this.buttons.toggleVisibleZoomed(this.isMaxZoom(t))}onZoomPanStart(e){e.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(e){const{panner:t,seriesRect:i,ctx:{tooltipManager:s,zoomManager:n}}=this;if(!i)return;const a=t.translateZooms(i,n.getAxisZooms(),e.deltaX,e.deltaY);for(const[r,{direction:o,zoom:l}]of Zt(a))this.updateAxisZoom(r,o,l);s.updateTooltip(uI)}isPanningKeyPressed(e){switch(this.panKey){case"alt":return e.altKey;case"ctrl":return e.ctrlKey;case"shift":return e.shiftKey;case"meta":return e.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}isMaxZoom(e){return Jf(e,hI())}isZoomValid(e){const{minVisibleItems:t,minVisibleItemsX:i,minVisibleItemsY:s,ctx:{zoomManager:n}}=this;if(t===0)return!0;const a=this.getZoom(),r=Dx(ys(e))<Dx(ys(a)),o=Dx(na(e))<Dx(na(a));return!r&&!o?!0:i!=null&&r?n.isVisibleItemsCountAtLeast(e,i):s!=null&&o?n.isVisibleItemsCountAtLeast(e,s):n.isVisibleItemsCountAtLeast(e,t)}isAxisZoomValid(e,t){const{minVisibleItems:i,minVisibleItemsX:s,minVisibleItemsY:n,ctx:{zoomManager:a}}=this,r=this.getZoom(),o=t.max-t.min,l=r[e].max-r[e].min,c=E(b({},r),{[e]:t}),h=e===md.X?s:n;return o>=l||a.isVisibleItemsCountAtLeast(c,h!=null?h:i)}resetZoom(){this.ctx.zoomManager.resetZoom("zoom")}updateZoom(e){this.enableIndependentAxes?this.updatePrimaryAxisZooms(e):this.updateUnifiedZoom(e)}updateUnifiedZoom(e){return this.isZoomValid(e)?(this.ctx.zoomManager.updateZoom("zoom",e),!0):(this.ctx.updateService.update(mG.SCENE_RENDER,{skipAnimations:!0}),!1)}updatePrimaryAxisZooms(e){this.updatePrimaryAxisZoom(e,md.X),this.updatePrimaryAxisZoom(e,md.Y)}updatePrimaryAxisZoom(e,t){const i=this.ctx.zoomManager.getPrimaryAxisId(t);i!=null&&this.updateAxisZoom(i,t,e[t])}updateAxisZoom(e,t,i){const{enableIndependentAxes:s,ctx:{zoomManager:n}}=this;if(!i)return!1;const a=this.getZoom();return s!==!0?(a[t]=i,this.updateUnifiedZoom(a)):this.isAxisZoomValid(t,i)?(n.updateAxisZoom("zoom",e,i),!0):!1}toggleAxisDraggingCursors(){const{anchorPointX:e,anchorPointY:t,domProxy:i}=this,s=this.getZoom();let n=ys(s)!==ud,a=na(s)!==ud;if(!n){const r=bx(s,.999,1);r.x=aa(r.x,s.x,e),n=this.isZoomValid(r)}if(!a){const r=bx(s,1,.999);r.y=aa(r.y,s.y,t),a=this.isZoomValid(r)}i.toggleAxisDraggingCursor(md.X,n),i.toggleAxisDraggingCursor(md.Y,a)}getZoom(){return en(this.ctx.zoomManager.getZoom())}getResetZoom(){return en(this.ctx.zoomManager.getRestoredZoom())}getModuleProperties(e){var t,i,s,n,a,r,o,l;return{anchorPointX:(t=e==null?void 0:e.anchorPointX)!=null?t:this.getAnchorPointX(),anchorPointY:(i=e==null?void 0:e.anchorPointY)!=null?i:this.getAnchorPointY(),enabled:(s=e==null?void 0:e.enabled)!=null?s:this.enabled,independentAxes:(n=e==null?void 0:e.independentAxes)!=null?n:this.enableIndependentAxes===!0,isScalingX:(a=e==null?void 0:e.isScalingX)!=null?a:this.isScalingX(),isScalingY:(r=e==null?void 0:e.isScalingY)!=null?r:this.isScalingY(),keepAspectRatio:(o=e==null?void 0:e.keepAspectRatio)!=null?o:this.keepAspectRatio,scrollingStep:(l=e==null?void 0:e.scrollingStep)!=null?l:this.scrollingStep}}};C([Sx({newValue(e){this.onEnabledChange(e)}}),Si],Ri.prototype,"enabled",2),C([Si],Ri.prototype,"enableAxisDragging",2),C([Si],Ri.prototype,"enableDoubleClickToReset",2),C([Sx({changeValue(e){this.ctx.zoomManager.setIndependentAxes(!!e)}}),Si],Ri.prototype,"enableIndependentAxes",2),C([Si],Ri.prototype,"enablePanning",2),C([Si],Ri.prototype,"enableScrolling",2),C([Si],Ri.prototype,"enableSelecting",2),C([Si],Ri.prototype,"enableTwoFingerZoom",2),C([Si],Ri.prototype,"panKey",2),C([Si],Ri.prototype,"axes",2),C([Si],Ri.prototype,"scrollingStep",2),C([Si],Ri.prototype,"keepAspectRatio",2),C([Si],Ri.prototype,"minVisibleItems",2),C([yG("Use [minVisibleItems] instead."),Si],Ri.prototype,"minVisibleItemsX",2),C([yG("Use [minVisibleItems] instead."),Si],Ri.prototype,"minVisibleItemsY",2),C([Si],Ri.prototype,"anchorPointX",2),C([Si],Ri.prototype,"anchorPointY",2),C([Si],Ri.prototype,"autoScaling",2),C([Si],Ri.prototype,"buttons",2),C([Sge("panner.deceleration"),Si],Ri.prototype,"deceleration",2);var Mge={enabled:!0,visible:"hover",buttons:[{icon:"zoom-out",tooltip:"toolbarZoomZoomOut",value:"zoom-out",section:"scale"},{icon:"zoom-in",tooltip:"toolbarZoomZoomIn",value:"zoom-in",section:"scale"},{icon:"pan-left",tooltip:"toolbarZoomPanLeft",value:"pan-left",section:"pan"},{icon:"pan-right",tooltip:"toolbarZoomPanRight",value:"pan-right",section:"pan"},{icon:"reset",tooltip:"toolbarZoomReset",value:"reset",section:"reset"}]},Dge={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian","topology"],moduleFactory:e=>new Ri(e),themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:Mge,enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,enableTwoFingerZoom:!0,deceleration:"short",minVisibleItems:2,panKey:"alt",scrollingStep:.1,autoScaling:{enabled:!1,padding:.05}}}},{BaseProperties:wge,AxisTicks:Age,ZIndexMap:Ige,ProxyProperty:gI,Property:yd,LayoutElement:Tge,Group:kge,Rect:Lge,Marker:Pge,TranslatableGroup:Ege,BBox:Rge}=R,fI=class extends wge{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};C([yd],fI.prototype,"thickness",2),C([yd],fI.prototype,"preferredLength",2);var wx=class{constructor(e){this.axisTicks=e}};C([gI("axisTicks.label")],wx.prototype,"label",2),C([gI("axisTicks.interval")],wx.prototype,"interval",2),C([gI("axisTicks.padding")],wx.prototype,"padding",2);var vd=class{constructor(e){this.ctx=e,this.id=Hs(this),this.legendGroup=new Ege({name:"legend",zIndex:Ige.LEGEND}),this.gradientRect=new Lge,this.arrow=new Pge({shape:"triangle"}),this.ticksGroup=new kge({name:"legend-axis-group"}),this.destroyFns=[],this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new fI,this.spacing=20,this.data=[],this.highlightManager=e.highlightManager,this.axisTicks=new Age,this.axisTicks.attachAxis(this.ticksGroup),this.scale=new wx(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.destroyFns.push(e.highlightManager.addListener("highlight-change",()=>this.onChartHoverChange()),e.layoutManager.registerElement(Tge.Legend,t=>this.onStartLayout(t)),()=>this.legendGroup.remove())}isVertical(){return this.position==="right"||this.position==="left"}destroy(){this.destroyFns.forEach(e=>e())}attachLegend(e){e.appendChild(this.legendGroup)}onStartLayout(e){var r;const[t]=this.data;if(!this.enabled||!(t!=null&&t.enabled)||t.legendType!=="gradient"){this.legendGroup.visible=!1;return}const{colorRange:i}=this.normalizeColorArrays(t);this.updateGradientRect(e.layoutBox,i);const s=(r=this.updateAxis(t))!=null?r:new Rge(0,0,0,0),{left:n,top:a}=this.getMeasurements(e.layoutBox,s);this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=n,this.legendGroup.translationY=a}normalizeColorArrays(e){let t=e.colorDomain.slice();const i=e.colorRange.slice();if(t.length===i.length)return{colorDomain:t,colorRange:i};t.length>i.length&&i.splice(t.length);const[s,n]=t,a=i.length;return t=i.map((r,o)=>o===0?s:o===a-1?n:s+(n-s)*o/(a-1)),{colorDomain:t,colorRange:i}}updateGradientRect(e,t){const{gradientRect:i}=this,{preferredLength:s,thickness:n}=this.gradient;let a;this.isVertical()?(a=0,i.width=n,i.height=Math.min(e.height,s)):(a=90,i.width=Math.min(e.width,s),i.height=n),i.fill={type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:t.map((r,o)=>({stop:o/(t.length-1),color:r})),rotation:a}}updateAxis(e){const{axisTicks:t}=this,i=this.isVertical(),s=this.reverseOrder!==i;return t.position=this.position,t.translationX=i?this.gradient.thickness:0,t.translationY=i?0:this.gradient.thickness,t.scale.domain=s?e.colorDomain.slice().reverse():e.colorDomain,t.scale.range=i?[0,this.gradientRect.height]:[0,this.gradientRect.width],t.calculateLayout()}updateArrow(){var c;const e=this.highlightManager.getActiveHighlight(),{arrow:t}=this;if((e==null?void 0:e.colorValue)==null){t.visible=!1;return}const{scale:i,label:s}=this.axisTicks,n=(c=s.fontSize)!=null?c:0,a=i.convert(e.colorValue);let{x:r,y:o}=this.gradientRect,l=Math.PI;this.isVertical()?(r-=n/2,o+=a,l/=2):(r+=a,o-=n/2),t.visible=!0,t.fill=s.color,t.rotation=l,t.size=n,t.translationX=r,t.translationY=o}getMeasurements(e,t){let{x:i,y:s}=e,{width:n,height:a}=this.gradientRect;switch(this.isVertical()?n+=t.width+5:a+=t.height+5,this.position){case"left":s+=e.height/2-a/2,e.shrink(n+this.spacing,"left");break;case"right":i+=e.width-n,s+=e.height/2-a/2,e.shrink(n+this.spacing,"right");break;case"top":i+=e.width/2-n/2,e.shrink(a+this.spacing,"top");break;case"bottom":i+=e.width/2-n/2,s+=e.height-a,e.shrink(a+this.spacing,"bottom")}return{top:s,left:i}}onChartHoverChange(){this.enabled&&this.updateArrow()}};vd.className="GradientLegend",C([yd],vd.prototype,"enabled",2),C([yd],vd.prototype,"position",2),C([yd],vd.prototype,"reverseOrder",2),C([yd],vd.prototype,"gradient",2),C([yd],vd.prototype,"spacing",2);var Nge={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],identifier:"gradient",moduleFactory:e=>new vd(e),themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"}},interval:{minSpacing:15}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1},removable:"standalone-only"};function Oge(e,t){const i=e.addChild("canvas-overlay","watermark"),s=ke("span");s.innerText=t,i.addEventListener("animationend",()=>{e.removeChild("canvas-overlay","watermark"),e.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(s)}var{ordinalTimeAxisOptionsDefs:Fge,angleNumberAxisOptionsDefs:Bge,angleCategoryAxisOptionsDefs:_ge,radiusNumberAxisOptionsDefs:Gge,radiusCategoryAxisOptionsDefs:zge}=R,Vge={type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,options:Fge,create:e=>new Of(e)},jge={type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,options:Bge,create:e=>new $h(e)},Hge={type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,options:_ge,create:e=>new ac(e)},Wge={type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,options:Gge,create:e=>new Yu(e)},Uge={type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,options:zge,create:e=>new rc(e)},{Chart:Kge,Property:$ge}=R;function Yge(e){return e.type==="sankey"||e.type==="chord"}var Ax=class extends Kge{getChartType(){return"flow-proportion"}async updateData(){await super.updateData();const e=this.getOptions();this.nodes!==e.nodes&&(this.nodes=e.nodes);const{nodes:t}=this;this.series.forEach(i=>{Yge(i)&&i.setChartNodes(t)})}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:s}=e;s.shrink(this.seriesArea.padding.toJson());const n=s.clone();this.seriesRect=n,this.animationRect=n,t.visible=this.series.some(a=>a.visible);for(const a of[t,i])a.translationX=Math.floor(n.x),a.translationY=Math.floor(n.y);this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:t.visible,rect:n,paddedRect:n}})}};Ax.className="FlowProportionChart",Ax.type="flow-proportion",C([$ge],Ax.prototype,"nodes",2);var{isAgFlowProportionChartOptions:Xge,flowProportionChartOptionsDefs:Zge}=R,qge={type:"chart",name:"flow-proportion",enterprise:!0,options:Zge,detect:Xge,create(e,t){return new Ax(e,t)}},{Chart:Qge}=R,mI=class extends Qge{getChartType(){return"gauge"}performLayout(e){const{seriesRoot:t,annotationRoot:i,series:s,seriesArea:n}=this,{layoutBox:a}=e,r=a.clone();a.shrink(n.padding.toJson()),this.seriesRect=r.clone().translate(r.x-a.x,r.y-a.y),this.animationRect=a,t.visible=s.some(o=>o.visible);for(const o of[t,i])o.translationX=Math.floor(a.x),o.translationY=Math.floor(a.y);this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:t.visible,rect:r,paddedRect:a}})}getAriaLabel(){const e=[],t=this.getCaptionText();t.length!==0&&e.push(t);for(const s of this.series)e.push(s.getCaptionText());const i=e.join(". ");return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption:i})}};mI.className="GaugeChart",mI.type="gauge";var{isAgGaugeChartOptions:Jge,gaugeChartOptionsDefs:efe}=R,tfe={type:"chart",name:"gauge",enterprise:!0,options:efe,detect:Jge,create(e,t){return new mI(e,t)}},{Chart:ife}=R,yI=class extends ife{getChartType(){return"hierarchy"}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:s}=e;s.shrink(this.seriesArea.padding.toJson());const n=s.clone();this.seriesRect=n,this.animationRect=n;for(const a of[t,i])a.translationX=Math.floor(n.x),a.translationY=Math.floor(n.y);t.visible=this.series[0].visible,t.setClipRect(n.clone()),this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:n,paddedRect:n}})}getAriaLabel(){const e=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:e})}};yI.className="HierarchyChart",yI.type="hierarchy";var{isAgHierarchyChartOptions:sfe,hierarchyChartOptionsDefs:nfe}=R,afe={type:"chart",name:"hierarchy",enterprise:!0,options:nfe,detect:sfe,create(e,t){return new yI(e,t)}},{Chart:rfe}=R,vI=class extends rfe{getChartType(){return"standalone"}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:s}=e;s.shrink(this.seriesArea.padding.toJson());const n=s.clone();this.seriesRect=n,this.animationRect=n;for(const a of[t,i])a.translationX=Math.floor(s.x),a.translationY=Math.floor(s.y);t.visible=this.series[0].visible,this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:n,paddedRect:s}})}getAriaLabel(){const e=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:e})}};vI.className="StandaloneChart",vI.type="standalone";var{isAgStandaloneChartOptions:ofe,standaloneChartOptionsDefs:lfe}=R,cfe={type:"chart",name:"standalone",enterprise:!0,options:lfe,detect:ofe,create(e,t){return new vI(e,t)}},{Chart:hfe,MercatorScale:bG,NumberAxis:xG,Property:dfe}=R;function CG(e){return e.type==="map-shape"||e.type==="map-line"||e.type==="map-marker"||e.type==="map-shape-background"||e.type==="map-line-background"}var Ix=class extends hfe{constructor(e,t){super(e,t),this.xAxis=new xG(this.getModuleContext()),this.xAxis.position="bottom",this.yAxis=new xG(this.getModuleContext()),this.yAxis.position="left",this.ctx.zoomManager.updateAxes([this.xAxis,this.yAxis])}getChartType(){return"topology"}async updateData(){await super.updateData();const e=this.getOptions();this.topology!==e.topology&&(this.topology=e.topology);const{topology:t}=this;this.series.forEach(i=>{CG(i)&&i.setChartTopology(t)})}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:s}=e;s.shrink(this.seriesArea.padding.toJson());const n=s.clone();this.seriesRect=n,this.animationRect=n;const a=this.series.filter(CG),r=a.reduce((c,h)=>{if(!h.visible)return c;const d=h.topologyBounds;return d==null?c:c==null?d:(c.merge(d),c)},void 0);let o;if(r!=null){const{lon0:c,lat0:h,lon1:d,lat1:u}=r,p=[[c,h],[d,u]],g=bG.bounds(p),{width:f,height:y}=n,v=Math.min(f/g.width,y/g.height),x=g.width*v,S=g.height*v,M=(f-x)/2,D=(y-S)/2,A=M,w=D,T=M+x,k=D+S,N=this.ctx.zoomManager.getAxisZoom(this.xAxis.id),O=this.ctx.zoomManager.getAxisZoom(this.yAxis.id),L=(T-A)/(N.max-N.min),F=A-L*N.min,B=(k-w)/(1-O.min-(1-O.max)),_=w-B*(1-O.max);o=new bG(p,[[F,_],[F+L,_+B]])}a.forEach(c=>{c.scale=o});const l=this.series.some(c=>c.visible);t.visible=l;for(const c of[t,i])c.translationX=Math.floor(n.x),c.translationY=Math.floor(n.y),c.setClipRect(n.clone());this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:l,rect:n,paddedRect:n}})}};Ix.className="TopologyChart",Ix.type="topology",C([dfe],Ix.prototype,"topology",2);var{isAgTopologyChartOptions:ufe,topologyChartOptionsDefs:pfe}=R,gfe={type:"chart",name:"topology",enterprise:!0,options:pfe,detect:ufe,create(e,t){return new Ix(e,t)}},{annotationCalloutStylesDefs:ffe,annotationNoteStylesDefs:mfe,annotationTextStylesDef:yfe,annotationCommentStylesDefs:vfe,annotationMeasurerStylesDefs:bI,annotationShapeStylesDefs:SG,annotationChannelTextDefs:bfe,annotationCrossLineStyleDefs:MG,annotationFibonacciStylesDefs:DG,annotationLineStyleDefs:wG,annotationLineTextDefs:xfe,annotationDisjointChannelStyleDefs:Cfe,annotationParallelChannelStyleDefs:Sfe}=R,em=es({__type:ee(Oe("date")),value:Ne(z,ne)},"a serializable date object"),AG=Ne(z,ne,em),xI=Ne(AG,es({value:AG,groupPercentage:hE(-1,1)})),IG=E(b({},bfe),{label:z}),ol=E(b({},xfe),{label:z}),zt={x:xI,y:ne},Mfe=th({line:E(b({},wG),{start:zt,end:zt,text:ol}),"horizontal-line":E(b({},MG),{value:xI,text:ol}),"vertical-line":E(b({},MG),{value:xI,text:ol}),"disjoint-channel":E(b({},Cfe),{startHeight:X,endHeight:X,start:zt,end:zt,text:IG}),"parallel-channel":E(b({},Sfe),{height:X,start:zt,end:zt,text:IG}),"fibonacci-retracement":E(b({},DG),{start:zt,end:zt,text:ol,reverse:q}),"fibonacci-retracement-trend-based":E(b({},DG),{start:zt,end:zt,endRetracement:zt,text:ol,reverse:q}),callout:E(b({},ffe),{start:zt,end:zt,text:z}),comment:E(b(b({},vfe),zt),{text:z}),note:E(b(b({},mfe),zt),{text:z}),text:E(b(b({},yfe),zt),{text:z}),arrow:E(b({},wG),{text:ol,start:zt,end:zt}),"arrow-up":b(b({},SG),zt),"arrow-down":b(b({},SG),zt),"date-range":E(b({},bI),{extendAbove:q,extendBelow:q,text:ol,start:zt,end:zt}),"price-range":E(b({},bI),{extendLeft:q,extendRight:q,text:ol,start:zt,end:zt}),"date-price-range":E(b({},bI),{text:ol,start:zt,end:zt})},"an annotation initial state object"),Dfe={chartType:ce("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),annotations:Li(Mfe),legend:Li({visible:q,seriesId:z,itemId:z,legendItemName:z},"legend state array"),zoom:{rangeX:{start:Ne(ne,em),end:Ne(ne,em)},rangeY:{start:Ne(ne,em),end:Ne(ne,em)},ratioX:{start:Me,end:Me},ratioY:{start:Me,end:Me},autoScaledAxes:Ie(Oe("y"))}};function wfe(e){return{from:e?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function Afe(e){return(t,i)=>e?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}var{ScalableGroup:Ife,Rect:tm,Line:im,BBox:Tfe,Selection:TG,applyShapeFillBBox:kfe}=R,Lfe=class extends Ife{constructor(){super(),this.append([new tm({tag:0}),new tm({tag:2}),new tm({tag:1}),new im({tag:3}),new im({tag:3}),new im({tag:4}),new im({tag:4})])}updateDatumStyles(e,t,i,s,n){const{bandwidth:a,scaledValues:{xValue:r,medianValue:o}}=e;let{minValue:l,q1Value:c,q3Value:h,maxValue:d}=e.scaledValues;(i&&!s||!i&&s)&&([d,h,c,l]=[l,c,h,d]);const u=($,W,Y,K)=>i?{y:$,x:W,width:K,height:Y}:{x:$,y:W,width:Y,height:K},p=($,W,Y)=>i?{y1:$,y2:W,x:Y}:{x1:$,x2:W,y:Y},g=($,W,Y)=>i?{x1:W,x2:Y,y:$}:{x:$,y1:W,y2:Y},f=($,W,Y,K)=>({x:$,y:W,width:Y,height:K}=u($,W,Y,K),new Tfe($,W,Y,K)),{fill:y,fillOpacity:v,stroke:x,strokeWidth:S,strokeOpacity:M,lineDash:D,lineDashOffset:A,cornerRadius:w,cap:T,whisker:k}=t,N=TG.select(this,tm),[O]=N.selectByTag(0),[L]=N.selectByTag(2),[F]=N.selectByTag(1),B=N.selectByTag(3),_=N.selectByTag(4);k.strokeWidth>a&&(k.strokeWidth=a);const G=u(c,r,h-c,a);L.setProperties(G),O.setProperties(G),O.setProperties({cornerRadius:w});const V=Math.max(Math.round(o-S/2),c+S),j=Math.min(Math.round(o+S/2),h-S);F.setProperties(G),F.setProperties({visible:V<j,cornerRadius:w,clipBBox:f(V,r+S,j-V,Math.max(0,a-S*2))});const H=Math.floor(r+a*(1-T.lengthRatio)/2),U=Math.ceil(r+a*(1+T.lengthRatio)/2);_[0].setProperties(g(l,H,U)),_[1].setProperties(g(d,H,U)),B[0].setProperties(p(Math.round(l+k.strokeWidth/2),c,Math.floor(r+a/2))),B[1].setProperties(p(h,Math.round(d-k.strokeWidth/2),Math.floor(r+a/2))),kfe(O,y,n),O.setProperties({fill:y,fillOpacity:v,strokeWidth:S*2,strokeOpacity:0}),F.setProperties({fill:x,fillOpacity:M,strokeWidth:0});for(const $ of[...B,..._])$.setProperties(k);L.setProperties({stroke:x,strokeWidth:S,strokeOpacity:M,lineDash:D,lineDashOffset:A,cornerRadius:w,fillOpacity:0})}distanceSquared(e,t){const i=TG.selectByClass(this,tm,im);return R.nearestSquared(e,t,i).distanceSquared}get midPoint(){const e=this.datum;return e.midPoint===void 0?(se.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):e.midPoint}},{BaseProperties:kG,FillGradientDefaults:Pfe,FillPatternDefaults:Efe,FillImageDefaults:Rfe,AbstractBarSeriesProperties:Nfe,SeriesTooltip:Ofe,Property:ht,mergeDefaults:Ffe}=R,LG=class extends kG{constructor(){super(...arguments),this.lengthRatio=.5}};C([ht],LG.prototype,"lengthRatio",2);var mp=class extends kG{};C([ht],mp.prototype,"stroke",2),C([ht],mp.prototype,"strokeWidth",2),C([ht],mp.prototype,"strokeOpacity",2),C([ht],mp.prototype,"lineDash",2),C([ht],mp.prototype,"lineDashOffset",2);var Tt=class extends Nfe{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new Pfe,this.fillPatternDefaults=new Efe,this.fillImageDefaults=new Rfe,this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new LG,this.whisker=new mp,this.tooltip=new Ofe}toJson(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:s,lineDashOffset:n}=this,a=super.toJson();return a.whisker=Ffe(a.whisker,{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:s,lineDashOffset:n}),a}};C([ht],Tt.prototype,"xKey",2),C([ht],Tt.prototype,"minKey",2),C([ht],Tt.prototype,"q1Key",2),C([ht],Tt.prototype,"medianKey",2),C([ht],Tt.prototype,"q3Key",2),C([ht],Tt.prototype,"maxKey",2),C([ht],Tt.prototype,"xName",2),C([ht],Tt.prototype,"yName",2),C([ht],Tt.prototype,"minName",2),C([ht],Tt.prototype,"q1Name",2),C([ht],Tt.prototype,"medianName",2),C([ht],Tt.prototype,"q3Name",2),C([ht],Tt.prototype,"maxName",2),C([ht],Tt.prototype,"fill",2),C([ht],Tt.prototype,"fillGradientDefaults",2),C([ht],Tt.prototype,"fillPatternDefaults",2),C([ht],Tt.prototype,"fillImageDefaults",2),C([ht],Tt.prototype,"fillOpacity",2),C([ht],Tt.prototype,"stroke",2),C([ht],Tt.prototype,"strokeWidth",2),C([ht],Tt.prototype,"strokeOpacity",2),C([ht],Tt.prototype,"lineDash",2),C([ht],Tt.prototype,"lineDashOffset",2),C([ht],Tt.prototype,"cornerRadius",2),C([ht],Tt.prototype,"itemStyler",2),C([ht],Tt.prototype,"cap",2),C([ht],Tt.prototype,"whisker",2),C([ht],Tt.prototype,"tooltip",2);var{extractDecoratedProperties:PG,fixNumericExtent:Bfe,keyProperty:_fe,mergeDefaults:CI,SeriesNodePickMode:EG,SMALLEST_KEY_INTERVAL:Gfe,valueProperty:sm,diff:zfe,animationValidation:Vfe,computeBarFocusBounds:jfe,createDatumId:RG,ContinuousScale:Hfe,ChartAxisDirection:Wfe,motion:NG,isGradientFill:Ufe,getShapeStyle:nm}=R,Kfe=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.minKey=s.properties.minKey,this.q1Key=s.properties.q1Key,this.medianKey=s.properties.medianKey,this.q3Key=s.properties.q3Key,this.maxKey=s.properties.maxKey}},Tx=class extends R.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[EG.NEAREST_NODE,EG.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},categoryKey:"xValue",pathsPerSeries:[],hasHighlightedLabels:!0}),this.properties=new Tt,this.NodeEvent=Kfe}async processData(e){var f,y,v;if(!this.visible)return;const{xKey:t,minKey:i,q1Key:s,medianKey:n,q3Key:a,maxKey:r}=this.properties,o=!this.ctx.animationManager.isSkipped(),l=(f=this.getCategoryAxis())==null?void 0:f.scale,c=(y=this.getValueAxis())==null?void 0:y.scale,{isContinuousX:h,xScaleType:d,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),p=[];o&&this.processedData&&p.push(zfe(this.id,this.processedData)),o&&p.push(Vfe());const{processedData:g}=await this.requestDataModel(e,this.data,{props:[_fe(t,d,{id:"xValue"}),sm(i,u,{id:"minValue"}),sm(s,u,{id:"q1Value"}),sm(n,u,{id:"medianValue"}),sm(a,u,{id:"q3Value"}),sm(r,u,{id:"maxValue"}),...h?[Gfe]:[],...p]});this.smallestDataInterval=(v=g.reduced)==null?void 0:v.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return[];if(e!==this.getBarDirection()){const{index:n,def:a}=i.resolveProcessedDataDefById(this,"xValue"),r=t.domain.keys[n];return a.type==="key"&&a.valueType==="category"?r:this.padBandExtent(r)}const s=this.domainForClippedRange(e,["minValue","maxValue"],"xValue",!0);return Bfe(s)}getSeriesRange(e,t){return this.domainForVisibleRange(Wfe.Y,["maxValue","minValue"],"xValue",t,!0)}createNodeData(){var F;const{visible:e,dataModel:t,processedData:i}=this,s=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&i&&s&&n))return;const{xKey:a,fill:r,fillOpacity:o,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u,cap:p,whisker:g}=this.properties,f=[],y=t.resolveKeysById(this,"xValue",i),v=t.resolveColumnById(this,"minValue",i),x=t.resolveColumnById(this,"q1Value",i),S=t.resolveColumnById(this,"medianValue",i),M=t.resolveColumnById(this,"q3Value",i),D=t.resolveColumnById(this,"maxValue",i),{barWidth:A,groupIndex:w}=this.updateGroupScale(s),T=Hfe.is(s.scale)?A*-.5:0,{groupScale:k}=this,N=this.isVertical(),O={itemId:a,nodeData:f,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};return e&&((F=i.dataSources.get(this.id))!=null?F:[]).forEach((B,_)=>{const G=y[_];if(G==null)return;const V=v[_],j=x[_],H=S[_],U=M[_],$=D[_];if([V,j,H,U,$].some(oe=>typeof oe!="number")||V>j||j>H||H>U||U>$)return;const W={xValue:Math.round(s.scale.convert(G)),minValue:Math.round(n.scale.convert(V)),q1Value:Math.round(n.scale.convert(j)),medianValue:Math.round(n.scale.convert(H)),q3Value:Math.round(n.scale.convert(U)),maxValue:Math.round(n.scale.convert($))};W.xValue+=Math.round(k.convert(String(w)))+T;const Y=Math.round(A),K=Math.abs(W.q3Value-W.q1Value),Q=W.xValue+Y/2,Z=Math.min(W.q3Value,W.q1Value)+K/2,J={x:N?Q:Z,y:N?Z:Q};let ae;N?ae={x:J.x-Y/2,y:W.minValue,width:Y,height:W.maxValue-W.minValue}:ae={x:W.minValue,y:J.y-Y/2,width:W.maxValue-W.minValue,height:Y},f.push({series:this,itemId:G,datum:B,datumIndex:_,xKey:a,bandwidth:Y,scaledValues:W,cap:p,whisker:g,fill:r,fillOpacity:o,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u,midPoint:J,focusRect:ae})}),O}legendItemSymbol(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,fillGradientDefaults:o,fillPatternDefaults:l,fillImageDefaults:c}=this.properties;return{marker:nm({fill:e,fillOpacity:t,stroke:i,strokeOpacity:n,strokeWidth:s,lineDash:a,lineDashOffset:r},o,l,c)}}getLegendData(e){var l;const{id:t,ctx:{legendManager:i},visible:s}=this,{xKey:n,yName:a,showInLegend:r,legendItemName:o}=this.properties;return!n||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:t}),label:{text:(l=o!=null?o:a)!=null?l:t},symbol:this.legendItemSymbol(),legendItemName:o,hideInLegend:!r}]}getTooltipContent(e){var B;const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:a,xName:r,yName:o,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:p,minKey:g,minName:f,maxKey:y,maxName:v,legendItemName:x,tooltip:S}=n,M=this.getCategoryAxis(),D=this.getValueAxis();if(!i||!s||!M||!D)return;const A=(B=s.dataSources.get(this.id))==null?void 0:B[e],w=i.resolveKeysById(this,"xValue",s)[e],T=i.resolveColumnById(this,"minValue",s)[e],k=i.resolveColumnById(this,"q1Value",s)[e],N=i.resolveColumnById(this,"medianValue",s)[e],O=i.resolveColumnById(this,"q3Value",s)[e],L=i.resolveColumnById(this,"maxValue",s)[e];if(w==null)return;const F=this.getItemBaseStyle(!1);return Object.assign(F,this.getItemStyleOverrides(String(e),A,F,!1)),this.formatTooltipWithContext(S,{heading:M.formatDatum(w),title:x!=null?x:o,symbol:this.legendItemSymbol(),data:[{label:f,fallbackLabel:g,value:D.formatDatum(T)},{label:d,fallbackLabel:h,value:D.formatDatum(k)},{label:c,fallbackLabel:l,value:D.formatDatum(N)},{label:p,fallbackLabel:u,value:D.formatDatum(O)},{label:v,fallbackLabel:y,value:D.formatDatum(L)}]},b({seriesId:t,datum:A,title:o,xKey:a,xName:r,yName:o,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:p,minKey:g,minName:f,maxKey:y,maxName:v},F))}animateEmptyUpdateReady({datumSelection:e}){const t=this.isVertical(),{from:i,to:s}=wfe(t);NG.resetMotion([e],Afe(t)),NG.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[e],i,s,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(e){var i;const t=(i=e.nodeData)!=null?i:[];return e.datumSelection.update(t)}getItemBaseStyle(e){var h,d,u,p,g,f,y,v;const{properties:t}=this,{cornerRadius:i,cap:s,whisker:n,fillGradientDefaults:a,fillPatternDefaults:r,fillImageDefaults:o}=t,l=e?t.highlightStyle.item:void 0,c=this.getStrokeWidth(t.strokeWidth);return nm({fill:(h=l==null?void 0:l.fill)!=null?h:t.fill,fillOpacity:(d=l==null?void 0:l.fillOpacity)!=null?d:t.fillOpacity,stroke:(u=l==null?void 0:l.stroke)!=null?u:t.stroke,strokeWidth:(p=l==null?void 0:l.strokeWidth)!=null?p:c,strokeOpacity:(g=l==null?void 0:l.strokeOpacity)!=null?g:t.strokeOpacity,lineDash:(y=(f=l==null?void 0:l.lineDash)!=null?f:t.lineDash)!=null?y:[],lineDashOffset:(v=l==null?void 0:l.lineDashOffset)!=null?v:t.lineDashOffset,cornerRadius:i,cap:s,whisker:n},a,r,o)}getItemStyleOverrides(e,t,i,s){const{id:n,properties:a}=this,{xKey:r,minKey:o,q1Key:l,medianKey:c,q3Key:h,maxKey:d,fillGradientDefaults:u,fillPatternDefaults:p,fillImageDefaults:g,itemStyler:f}=a;if(f==null)return;const y=this.cachedDatumCallback(RG(e,s?"highlight":"node"),()=>this.callWithContext(f,b({seriesId:n,datum:t,xKey:r,minKey:o,q1Key:l,medianKey:c,q3Key:h,maxKey:d,highlighted:s},i)));return nm(y,u,p,g)}updateDatumNodes({datumSelection:e,isHighlight:t}){var a;const i=this.isVertical(),s=(a=this.getValueAxis())==null?void 0:a.isReversed(),{highlightStyle:n}=this.properties;e.each((r,o)=>{let l=this.getFormattedStyles(o,t?"highlight":"node");t&&(l=CI(n.item,l));const{stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:p}=l;l.whisker=CI(l.whisker,{stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:p});const g=this.getShapeFillBBox();r.updateDatumStyles(o,l,i,s,g)})}updateLabelNodes(){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}nodeFactory(){return new Lfe}getFormattedStyles(e,t){const{id:i,properties:s}=this,{xKey:n,minKey:a,q1Key:r,medianKey:o,q3Key:l,maxKey:c,itemStyler:h,cornerRadius:d,fillGradientDefaults:u,fillPatternDefaults:p,fillImageDefaults:g}=s,{datum:f,stroke:y,strokeWidth:v,strokeOpacity:x,lineDash:S,lineDashOffset:M,cap:D,whisker:A}=e;let w,T=1;Ufe(e.fill)?w=e.fill:(w=e.fill,T=s.fillOpacity);let k=nm({fill:w,fillOpacity:T,stroke:y,strokeWidth:v,strokeOpacity:x,lineDash:S,lineDashOffset:M,cornerRadius:d,cap:PG(D),whisker:PG(A)},u,p,g);if(h){const N=this.cachedDatumCallback(RG(f.index,t),()=>this.callWithContext(h,E(b({datum:f,seriesId:i,highlighted:t==="highlight"},k),{xKey:n,minKey:a,q1Key:r,medianKey:o,q3Key:l,maxKey:c})));N&&(k=nm(CI(N,k),u,p,g))}return k}computeFocusBounds({datumIndex:e}){var t;return jfe(this,(t=this.contextNodeData)==null?void 0:t.nodeData[e].focusRect)}};Tx.className="BoxPlotSeries",Tx.type="box-plot";var{boxPlotSeriesThemeableOptionsDef:$fe,commonSeriesOptionsDefs:Yfe}=R,Xfe=E(b(b({},$fe),Yfe),{type:ee(Oe("box-plot")),xKey:ee(z),minKey:ee(z),q1Key:ee(z),medianKey:ee(z),q3Key:ee(z),maxKey:ee(z),xName:z,yName:z,minName:z,q1Name:z,medianName:z,q3Name:z,maxName:z,grouped:q,legendItemName:z}),{CARTESIAN_AXIS_TYPE:OG}=R.ThemeConstants,Zfe={series:{direction:"vertical",fill:{$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]},{$isImage:[{$palette:"fill"}]}]},{$palette:"fill"},{$mix:[R.SAFE_FILL_OPERATION,{$ref:"backgroundColor"},.7]}]},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,strokeWidth:2},axes:{[OG.NUMBER]:{crosshair:{snap:!1}},[OG.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},qfe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",moduleFactory:e=>new Tx(e),tooltipDefaults:{range:"exact"},defaultAxes:R.DIRECTION_SWAP_AXES,themeTemplate:Zfe,groupable:!0},FG={type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,options:Xfe,create:e=>new Tx(e)},{findMinMax:Qfe}=R,Ns=0,xn=1,_n=2,Gn=3,ra=4;function am(e,t=1){let i=Math.ceil(Math.log2(e.length/t))-1;return i=Math.min(Math.max(i,0),16),2**i|0}function rm(e){return Qfe(e.map(t=>Number(t)))}function kx(e,t,i){return(e.valueOf()-t)/(i-t)}function Lx(e,t){return Math.min(Math.floor(e*t),t-1)*ra|0}function om(e,t,i,s,n,a){const r=new Int32Array(a*ra).fill(-1),o=new Float64Array(a*ra).fill(NaN);for(let l=0;l<e.length;l+=1){const c=e[l],h=t[l],d=i[l];if(c==null||h==null||d==null)continue;const u=kx(c,s,n),p=h.valueOf(),g=d.valueOf(),f=Lx(u,a),y=r[f+Ns]===-1;(y||u<o[f+Ns])&&(r[f+Ns]=l,o[f+Ns]=u),(y||u>o[f+xn])&&(r[f+xn]=l,o[f+xn]=u),(y||g<o[f+_n])&&(r[f+_n]=l,o[f+_n]=g),(y||p>o[f+Gn])&&(r[f+Gn]=l,o[f+Gn]=p)}return{indexData:r,valueData:o}}function lm(e,t,i,{inPlace:s=!1}={}){const n=i/2|0,a=s?e:new Int32Array(n*ra),r=s?t:new Float64Array(n*ra);for(let o=0;o<n;o+=1){const l=o*ra|0,c=l*2|0,h=c+ra|0,d=e[h+Ns]===-1,u=d||t[c+Ns]<t[h+Ns]?c:h;a[l+Ns]=e[u+Ns],r[l+Ns]=t[u+Ns];const p=d||t[c+xn]>t[h+xn]?c:h;a[l+xn]=e[p+xn],r[l+xn]=t[p+xn];const g=d||t[c+_n]<t[h+_n]?c:h;a[l+_n]=e[g+_n],r[l+_n]=t[g+_n];const f=d||t[c+Gn]>t[h+Gn]?c:h;a[l+Gn]=e[f+Gn],r[l+Gn]=t[f+Gn]}return{maxRange:n,indexData:a,valueData:r}}var Jfe=1e3,BG=Ns,eme=Gn,tme=_n,_G=xn;function ime(e,t,i,s){if(e.length<Jfe)return;const[n,a]=rm(s);let r=am(e),{indexData:o,valueData:l}=om(e,t,i,n,a,r);const c=[{maxRange:r,indexData:o}];for(;r>64;)({indexData:o,valueData:l,maxRange:r}=lm(o,l,r)),c.push({maxRange:r,indexData:o});return c.reverse(),c}var{fixNumericExtent:sme,keyProperty:nme,createDatumId:GG,SeriesNodePickMode:zG,ChartAxisDirection:VG,SMALLEST_KEY_INTERVAL:ame,valueProperty:Px,diff:rme,animationValidation:ome,computeBarFocusBounds:lme,visibleRangeIndices:jG,ContinuousScale:cme,DiscreteTimeScale:hme,BandScale:dme,getShapeStyle:SI}=R,ume=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.openKey=s.properties.openKey,this.closeKey=s.properties.closeKey,this.highKey=s.properties.highKey,this.lowKey=s.properties.lowKey}},HG=class extends R.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[zG.AXIS_ALIGNED,zG.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.NodeEvent=ume,this.dataAggregationFilters=void 0}async processData(e){var f,y,v;if(!this.visible)return;const{xKey:t,openKey:i,closeKey:s,highKey:n,lowKey:a}=this.properties,r=!this.ctx.animationManager.isSkipped(),o=(f=this.getCategoryAxis())==null?void 0:f.scale,l=(y=this.getValueAxis())==null?void 0:y.scale,{isContinuousX:c,xScaleType:h,yScaleType:d}=this.getScaleInformation({xScale:o,yScale:l}),u=[];r&&(this.processedData&&u.push(rme(this.id,this.processedData)),u.push(ome())),i&&u.push(Px(i,d,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{dataModel:p,processedData:g}=await this.requestDataModel(e,this.data,{props:[nme(t,h,{id:"xValue"}),Px(s,d,{id:"closeValue"}),Px(n,d,{id:"highValue"}),Px(a,d,{id:"lowValue"}),...c?[ame]:[],...u]});this.smallestDataInterval=(v=g.reduced)==null?void 0:v.smallestKeyInterval,this.dataAggregationFilters=this.aggregateData(p,g),this.animationState.transition("updateData")}aggregateData(e,t){const i=this.axes[VG.X];if(i==null||!(cme.is(i.scale)||hme.is(i.scale)))return;const s=e.resolveKeysById(this,"xValue",t),n=e.resolveColumnById(this,"highValue",t),a=e.resolveColumnById(this,"lowValue",t),{index:r}=e.resolveProcessedDataDefById(this,"xValue"),o=t.domain.keys[r];return ime(s,n,a,o)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return[];if(e!==this.getBarDirection()){const{index:n,def:a}=i.resolveProcessedDataDefById(this,"xValue"),r=t.domain.keys[n];return a.type==="key"&&a.valueType==="category"?r:this.padBandExtent(r)}const s=this.domainForClippedRange(e,["highValue","lowValue"],"xValue",!0);return sme(s)}getSeriesRange(e,t){return this.domainForVisibleRange(VG.Y,["highValue","lowValue"],"xValue",t,!0)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["highValue","lowValue"],e,t,i)}createNodeData(){var B;const{visible:e,dataModel:t,processedData:i}=this,s=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&i&&s&&n))return;const a=[],{xKey:r,highKey:o,lowKey:l}=this.properties,c=(B=i.dataSources.get(this.id))!=null?B:[],h=t.resolveKeysById(this,"xValue",i),d=t.resolveColumnById(this,"openValue",i),u=t.resolveColumnById(this,"closeValue",i),p=t.resolveColumnById(this,"highValue",i),g=t.resolveColumnById(this,"lowValue",i),{groupScale:f}=this,{barWidth:y,groupIndex:v}=this.updateGroupScale(s),x=f.convert(String(v)),S=y>=1?y:f.rawBandwidth,M=dme.is(s.scale),D={itemId:r,nodeData:a,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};if(!e)return D;const A=(_,G,V,j,H,U,$,W)=>{const Y=c[_],K=M?$/2:0,Q=s.scale.convert(G)+x+K,Z=n.scale.convert(V),J=n.scale.convert(j),ae=n.scale.convert(H),oe=n.scale.convert(U),le=j>V,de=le?"up":"down",ue=Math.min(ae,oe),ie=Math.max(ae,oe)-ue,re={x:Q,y:ue+ie/2};a.push({series:this,itemId:de,datum:Y,datumIndex:_,xKey:r,xValue:G,openValue:V,closeValue:j,highValue:H,lowValue:U,midPoint:re,aggregatedValue:j,isRising:le,centerX:Q,width:$,y:ue,height:ie,yOpen:Z,yClose:J,crisp:W})},{dataAggregationFilters:w}=this,T=s.scale,[k,N]=T.range,O=N-k,L=_=>T.convert(h[_])+x,F=w==null?void 0:w.find(_=>_.maxRange>O);if(F==null){let[_,G]=jG(c.length,s.range,V=>{const j=L(V);return[j,j+S]});i.input.count<1e3&&(_=0,G=i.input.count);for(let V=_;V<G;V+=1){const j=h[V];if(j==null)continue;const H=d[V],U=u[V],$=p[V],W=g[V],Y=W!=null&&W<=H&&W<=U,K=$!=null&&$>=H&&$>=U;if(!Y){se.warnOnce(`invalid low value for key [${l}] in data element, low value cannot be higher than datum open or close values`);continue}if(!K){se.warnOnce(`invalid high value for key [${o}] in data element, high value cannot be lower than datum open or close values.`);continue}A(V,j,H,U,$,W,S,!0)}}else{const{maxRange:_,indexData:G}=F,[V,j]=jG(_,s.range,H=>{const U=H*ra,$=G[U+BG],W=G[U+_G];if($!==-1)return[L($),L(W)+S]});for(let H=V;H<j;H+=1){const U=H*ra,$=G[U+BG],W=G[U+_G],Y=G[U+eme],K=G[U+tme];if($===-1)continue;const Q=($+W)/2|0,Z=h[Q];if(Z==null)continue;const J=d[$],ae=u[W],oe=p[Y],le=g[K],de=Math.abs(L(W)-L($))+S;A(Q,Z,J,ae,oe,le,de,!1)}}return D}isVertical(){return!0}isLabelEnabled(){return!1}updateDatumSelection(e){var i;const t=(i=e.nodeData)!=null?i:[];return e.datumSelection.update(t)}updateLabelNodes(e){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}getItemBaseStyle(e,t){var r,o,l,c,h,d,u;const{properties:i}=this,s=i.item[e],n=t?i.highlightStyle.item:void 0,a={fill:(r=n==null?void 0:n.fill)!=null?r:s.fill,fillOpacity:(o=n==null?void 0:n.fillOpacity)!=null?o:s.fillOpacity,stroke:(l=n==null?void 0:n.stroke)!=null?l:s.stroke,strokeWidth:(c=n==null?void 0:n.strokeWidth)!=null?c:s.strokeWidth,strokeOpacity:(h=n==null?void 0:n.strokeOpacity)!=null?h:s.strokeOpacity,lineDash:(d=n==null?void 0:n.lineDash)!=null?d:s.lineDash,lineDashOffset:(u=n==null?void 0:n.lineDashOffset)!=null?u:s.lineDashOffset};return s.fillGradientDefaults&&s.fillPatternDefaults&&s.fillImageDefaults?SI(a,s.fillGradientDefaults,s.fillPatternDefaults,s.fillImageDefaults):a}getItemStyleOverrides(e,t,i,s,n){const{id:a,properties:r}=this,o=r.item[i],{itemStyler:l}=r;if(l==null)return;const{xKey:c,openKey:h,closeKey:d,highKey:u,lowKey:p}=r,g=this.cachedDatumCallback(GG(e,n?"highlight":"node"),()=>this.callWithContext(l,b({seriesId:a,datum:t,itemId:i,xKey:c,openKey:h,closeKey:d,highKey:u,lowKey:p,highlighted:n},s)));return o.fillGradientDefaults&&o.fillPatternDefaults&&o.fillImageDefaults?SI(g,o.fillGradientDefaults,o.fillPatternDefaults,o.fillImageDefaults):g}getTooltipContent(e){var B,_,G,V,j,H,U,$;const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:a,xName:r,yName:o,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:p,closeKey:g,closeName:f,legendItemName:y,tooltip:v}=n,x=this.getCategoryAxis(),S=this.getValueAxis();if(!i||!s||!x||!S)return;const M=(B=s.dataSources.get(this.id))==null?void 0:B[e],D=i.resolveKeysById(this,"xValue",s)[e],A=i.resolveColumnById(this,"openValue",s)[e],w=i.resolveColumnById(this,"highValue",s)[e],T=i.resolveColumnById(this,"lowValue",s)[e],k=i.resolveColumnById(this,"closeValue",s)[e];if(D==null)return;const N=k>=A?"up":"down",O=this.properties.item[N],L=this.getItemBaseStyle(N,!1);Object.assign(L,this.getItemStyleOverrides(String(e),M,N,L,!1));let F={fill:(_=O.fill)!=null?_:O.stroke,fillOpacity:(V=(G=O.fillOpacity)!=null?G:O.strokeOpacity)!=null?V:1,stroke:O.stroke,strokeWidth:(j=O.strokeWidth)!=null?j:1,strokeOpacity:(H=O.strokeOpacity)!=null?H:1,lineDash:(U=O.lineDash)!=null?U:[0],lineDashOffset:($=O.lineDashOffset)!=null?$:0};return O.fillGradientDefaults&&O.fillPatternDefaults&&O.fillImageDefaults&&(F=SI(F,O.fillGradientDefaults,O.fillPatternDefaults,O.fillImageDefaults)),this.formatTooltipWithContext(v,{heading:x.formatDatum(D),title:y,symbol:{marker:F},data:[{label:c,fallbackLabel:l,value:S.formatDatum(A)},{label:d,fallbackLabel:h,value:S.formatDatum(w)},{label:p,fallbackLabel:u,value:S.formatDatum(T)},{label:f,fallbackLabel:g,value:S.formatDatum(k)}]},b({seriesId:t,datum:M,title:o,itemId:N,xKey:a,xName:r,yName:o,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:p,closeKey:g,closeName:f},L))}getDatumId(e){return GG(e.xValue)}computeFocusBounds(e){var o;const t=(o=this.getNodeData())==null?void 0:o.at(e.datumIndex);if(t==null)return;const{centerX:i,y:s,width:n,height:a}=t,r={x:i-n/2,y:s,width:n,height:a};return lme(this,r)}},{Path:pme,SceneChangeDetection:Ac,BBox:gme}=R,so=class extends pme{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1,this.strokeAlignment=0}computeBBox(){const{centerX:e,y:t,width:i,height:s}=this;return new gme(e-i/2,t,i,s)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}get midPoint(){return{x:this.centerX,y:this.y+this.height/2}}alignedCoordinates(){const{y:e,width:t,height:i,crisp:s,strokeAlignment:n}=this;let{centerX:a,yOpen:r,yClose:o}=this,l=a-t/2,c=a+t/2,h=e,d=e+i;if(s&&t>1){a=this.align(a),r=this.align(r),o=this.align(o);const p=this.align(t/2);l=a-p,c=a+p,h=this.align(e),d=h+this.align(h,i)}const u=(h+d)/2;return a+=n,l+=n,c+=n,h-=n,d+=n,r+=r<u?n:-n,o+=o<u?n:-n,{centerX:a,x0:l,x1:c,y0:h,y1:d,yOpen:r,yClose:o}}executeStroke(e,t){const{width:i,strokeWidth:s}=this;i<s&&(e.lineWidth=i),super.executeStroke(e,t)}};C([Ac()],so.prototype,"centerX",2),C([Ac()],so.prototype,"y",2),C([Ac()],so.prototype,"width",2),C([Ac()],so.prototype,"height",2),C([Ac()],so.prototype,"yOpen",2),C([Ac()],so.prototype,"yClose",2),C([Ac()],so.prototype,"crisp",2),C([Ac()],so.prototype,"strokeAlignment",2);var fme=class extends so{updatePath(){const{path:e}=this,{centerX:t,x0:i,x1:s,y0:n,y1:a,yOpen:r,yClose:o}=this.alignedCoordinates();e.clear(),e.moveTo(t,n),e.lineTo(t,a),Math.abs(s-i)>1&&(e.moveTo(i,r),e.lineTo(t,r),e.moveTo(t,o),e.lineTo(s,o))}},{SceneArrayChangeDetection:mme,SceneChangeDetection:Ex,ExtendedPath2D:yme,BBox:vme}=R,yp=class extends so{constructor(){super(...arguments),this.wickPath=new yme,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0}computeDefaultGradientFillBBox(){const{width:e,centerX:t,yOpen:i,yClose:s}=this,n=Math.min(i,s),r=Math.max(i,s)-n,o=t-e/2,l=t+e/2;return new vme(o,n,l-o,r)}updatePath(){const{path:e,stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,lineDashOffset:a,wickStroke:r,wickStrokeWidth:o,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:h,strokeAlignment:d}=this,{centerX:u,x0:p,x1:g,y0:f,y1:y,yOpen:v,yClose:x}=this.alignedCoordinates();this.path.clear(),this.wickPath.clear();const M=r!=null&&r!==t||o!=null&&o!==i||l!=null&&l!==s||c!=null&&c!==n||h!=null&&h!==a?this.wickPath:e;if(Math.abs(g-p)<=3){M.moveTo(u,f),M.lineTo(u,y);return}const D=Math.min(v,x),A=Math.max(v,x);M.moveTo(u,f),M.lineTo(u,D+i/2),M.moveTo(u,y),M.lineTo(u,A-i/2);const w=d+i/2,T=A-D-2*w;if(T>0)e.rect(p+w,D+w,g-p-2*w,T);else{const k=(D+A)/2;e.moveTo(p,k),e.lineTo(g,k)}}drawPath(e){super.drawPath(e);const{wickPath:t}=this;if(t.isEmpty())return;const{stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,wickStroke:o=i,wickStrokeWidth:l=s,wickStrokeOpacity:c=n,wickLineDash:h=a,wickLineDashOffset:d=r}=this;l!==0&&(e.globalAlpha*=c,typeof o=="string"&&(e.strokeStyle=o),e.lineWidth=l,h!=null&&e.setLineDash([...h]),e.lineDashOffset=d,e.stroke(t.getPath2D()))}};C([Ex()],yp.prototype,"wickStroke",2),C([Ex()],yp.prototype,"wickStrokeWidth",2),C([Ex()],yp.prototype,"wickStrokeOpacity",2),C([mme()],yp.prototype,"wickLineDash",2),C([Ex()],yp.prototype,"wickLineDashOffset",2);var{BaseProperties:WG,Property:Ni,AbstractBarSeriesProperties:bme,SeriesTooltip:xme}=R,bd=class extends WG{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};C([Ni],bd.prototype,"stroke",2),C([Ni],bd.prototype,"strokeWidth",2),C([Ni],bd.prototype,"strokeOpacity",2),C([Ni],bd.prototype,"lineDash",2),C([Ni],bd.prototype,"lineDashOffset",2);var MI=class extends WG{constructor(){super(...arguments),this.up=new bd,this.down=new bd}};C([Ni],MI.prototype,"up",2),C([Ni],MI.prototype,"down",2);var oa=class extends bme{};C([Ni],oa.prototype,"xKey",2),C([Ni],oa.prototype,"openKey",2),C([Ni],oa.prototype,"closeKey",2),C([Ni],oa.prototype,"highKey",2),C([Ni],oa.prototype,"lowKey",2),C([Ni],oa.prototype,"xName",2),C([Ni],oa.prototype,"yName",2),C([Ni],oa.prototype,"openName",2),C([Ni],oa.prototype,"closeName",2),C([Ni],oa.prototype,"highName",2),C([Ni],oa.prototype,"lowName",2);var Rx=class extends oa{constructor(){super(...arguments),this.tooltip=new xme,this.item=new MI}};C([Ni],Rx.prototype,"tooltip",2),C([Ni],Rx.prototype,"item",2),C([Ni],Rx.prototype,"itemStyler",2);var{FillGradientDefaults:Cme,FillPatternDefaults:Sme,FillImageDefaults:Mme,BaseProperties:DI,SeriesTooltip:Dme,Property:Mi}=R,vp=class extends DI{};C([Mi],vp.prototype,"stroke",2),C([Mi],vp.prototype,"strokeWidth",2),C([Mi],vp.prototype,"strokeOpacity",2),C([Mi],vp.prototype,"lineDash",2),C([Mi],vp.prototype,"lineDashOffset",2);var zn=class extends DI{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new Cme,this.fillPatternDefaults=new Sme,this.fillImageDefaults=new Mme,this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new vp}};C([Mi],zn.prototype,"fill",2),C([Mi],zn.prototype,"fillGradientDefaults",2),C([Mi],zn.prototype,"fillPatternDefaults",2),C([Mi],zn.prototype,"fillImageDefaults",2),C([Mi],zn.prototype,"fillOpacity",2),C([Mi],zn.prototype,"stroke",2),C([Mi],zn.prototype,"strokeWidth",2),C([Mi],zn.prototype,"strokeOpacity",2),C([Mi],zn.prototype,"lineDash",2),C([Mi],zn.prototype,"lineDashOffset",2),C([Mi],zn.prototype,"cornerRadius",2),C([Mi],zn.prototype,"wick",2);var wI=class extends DI{constructor(){super(...arguments),this.up=new zn,this.down=new zn}};C([Mi],wI.prototype,"up",2),C([Mi],wI.prototype,"down",2);var Nx=class extends oa{constructor(){super(...arguments),this.item=new wI,this.tooltip=new Dme}};C([Mi],Nx.prototype,"item",2),C([Mi],Nx.prototype,"tooltip",2),C([Mi],Nx.prototype,"itemStyler",2);var{createDatumId:wme,isGradientFill:UG,isPatternFill:AI,isImageFill:II,getShapeFill:KG,applyShapeStyle:Ame,getShapeStyle:TI}=R,Ox=class extends HG{constructor(){super(...arguments),this.properties=new Nx}nodeFactory(){return new yp}updateDatumNodes({datumSelection:e,isHighlight:t}){const{id:i,properties:s}=this,{xKey:n,highKey:a,lowKey:r,openKey:o,closeKey:l,item:c,itemStyler:h}=s,{up:d,down:u}=c,p=TI({fill:d.fill,fillOpacity:d.fillOpacity,stroke:d.stroke,strokeWidth:d.strokeWidth,strokeOpacity:d.strokeOpacity,lineDash:d.lineDash,lineDashOffset:d.lineDashOffset},d.fillGradientDefaults,d.fillPatternDefaults,d.fillImageDefaults),g=TI({fill:u.fill,fillOpacity:u.fillOpacity,stroke:u.stroke,strokeWidth:u.strokeWidth,strokeOpacity:u.strokeOpacity,lineDash:u.lineDash,lineDashOffset:u.lineDashOffset},u.fillGradientDefaults,u.fillPatternDefaults,u.fillImageDefaults),f=t?s.highlightStyle.item:void 0;e.each((y,v)=>{var B,_,G,V,j,H,U,$,W,Y,K,Q,Z,J,ae,oe,le,de,ue,ie,re,te,fe,me,Le;const{isRising:x,centerX:S,width:M,y:D,height:A,yOpen:w,yClose:T,crisp:k}=v;let N;if(h!=null){const{fill:Ee,fillOpacity:He,stroke:Ue,strokeWidth:je,strokeOpacity:Te,lineDash:Fe,lineDashOffset:lt}=x?p:g;N=TI(this.cachedDatumCallback(wme(this.getDatumId(v),t?"highlight":"node"),()=>this.callWithContext(h,{seriesId:i,itemId:v.itemId,xKey:n,highKey:a,lowKey:r,openKey:o,closeKey:l,datum:v.datum,fill:Ee,fillOpacity:He,strokeOpacity:Te,stroke:Ue,strokeWidth:je,lineDash:Fe,lineDashOffset:lt,highlighted:t})),x?d.fillGradientDefaults:u.fillGradientDefaults,x?d.fillPatternDefaults:u.fillPatternDefaults,x?d.fillImageDefaults:u.fillImageDefaults)}y.centerX=S,y.width=M,y.y=D,y.height=A,y.yOpen=w,y.yClose=T,y.crisp=k;const O=x?p:g,L=x?d.wick:u.wick;Ame(y,{fill:(_=(B=f==null?void 0:f.fill)!=null?B:N==null?void 0:N.fill)!=null?_:O.fill,fillOpacity:(V=(G=f==null?void 0:f.fillOpacity)!=null?G:N==null?void 0:N.fillOpacity)!=null?V:O.fillOpacity,stroke:(H=(j=f==null?void 0:f.stroke)!=null?j:N==null?void 0:N.stroke)!=null?H:O.stroke,strokeWidth:($=(U=f==null?void 0:f.strokeWidth)!=null?U:N==null?void 0:N.strokeWidth)!=null?$:O.strokeWidth,strokeOpacity:(Y=(W=f==null?void 0:f.strokeOpacity)!=null?W:N==null?void 0:N.strokeOpacity)!=null?Y:O.strokeOpacity,lineDash:(Q=(K=f==null?void 0:f.lineDash)!=null?K:N==null?void 0:N.lineDash)!=null?Q:O.lineDash,lineDashOffset:(J=(Z=f==null?void 0:f.lineDashOffset)!=null?Z:N==null?void 0:N.lineDashOffset)!=null?J:O.lineDashOffset},void 0,this.getShapeFillBBox());const F=N==null?void 0:N.wick;y.wickStroke=(oe=(ae=f==null?void 0:f.stroke)!=null?ae:F==null?void 0:F.stroke)!=null?oe:L.stroke,y.wickStrokeWidth=(de=(le=f==null?void 0:f.strokeWidth)!=null?le:F==null?void 0:F.strokeWidth)!=null?de:L.strokeWidth,y.wickStrokeOpacity=(ie=(ue=f==null?void 0:f.strokeOpacity)!=null?ue:F==null?void 0:F.strokeOpacity)!=null?ie:L.strokeOpacity,y.wickLineDash=(te=(re=f==null?void 0:f.lineDash)!=null?re:F==null?void 0:F.lineDash)!=null?te:L.lineDash,y.wickLineDashOffset=(me=(fe=f==null?void 0:f.lineDashOffset)!=null?fe:F==null?void 0:F.lineDashOffset)!=null?me:L.lineDashOffset,y.strokeAlignment=((Le=N==null?void 0:N.strokeWidth)!=null?Le:O.strokeWidth)/2})}legendItemSymbol(){var l,c;const{up:e,down:t}=this.properties.item,i=KG(e.fill,e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults),s=UG(i)?i.colorStops.map(h=>typeof h=="string"?h:{color:h.color,stop:h.stop!=null?h.stop*.5:void 0}):[{color:AI(i)||II(i)?e.stroke:i,stop:0},{color:AI(i)||II(i)?e.stroke:i,stop:.5}],n=KG(t.fill,t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults),a=UG(n)?n.colorStops.map(h=>typeof h=="string"?h:{color:h.color,stop:h.stop!=null?h.stop*.5:void 0}):[{color:AI(n)||II(n)?t.stroke:n,stop:.5}],r={type:"gradient",gradient:"linear",rotation:90,colorStops:[...s,...a],reverse:!1},o={type:"gradient",gradient:"linear",rotation:90,colorStops:[{color:e.stroke,stop:0},{color:e.stroke,stop:.5},{color:t.stroke,stop:.5}],reverse:!1};return{marker:{fill:r,fillOpacity:e.fillOpacity,stroke:o,strokeWidth:(l=e.strokeWidth)!=null?l:1,strokeOpacity:(c=e.strokeOpacity)!=null?c:1,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset}}}getLegendData(e){var c;const{id:t,data:i,visible:s,ctx:{legendManager:n}}=this,{xKey:a,yName:r,showInLegend:o,legendItemName:l}=this.properties;return!(i!=null&&i.length)||!a||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:s&&n.getItemEnabled({seriesId:t,itemId:t}),label:{text:(c=l!=null?l:r)!=null?c:t},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!o}]}};Ox.className="CandleStickSeries",Ox.type="candlestick";var{commonSeriesOptionsDefs:Ime,candlestickSeriesThemeableOptionsDef:Tme}=R,kI=E(b(b({},Tme),Ime),{type:ee(Oe("candlestick")),xKey:ee(z),openKey:ee(z),highKey:ee(z),lowKey:ee(z),closeKey:ee(z),xName:z,yName:z,openName:z,highName:z,lowName:z,closeName:z});kI.pickOutsideVisibleMinorAxis=Ce(q),kI.focusPriority=Ce(ne);var{CARTESIAN_AXIS_TYPE:$G}=R.ThemeConstants;function YG(e){return{fill:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},e==="up"?"transparent":{$palette:"fill"},{$palette:`${e}.fill`}]},stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:`${e}.stroke`}]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$if:[{$or:[{$isGradient:[{$palette:`${e}.fill`}]},{$isPattern:[{$palette:`${e}.fill`}]},{$isImage:[{$palette:`${e}.fill`}]}]},{$map:[{$path:["./color",void 0,{$value:"$1"}]},{$path:["./colorStops",void 0,{$palette:`${e}.fill`}]}]},[{$mix:[{$palette:`${e}.fill`},"black",.15]},{$mix:[{$palette:`${e}.fill`},"white",.15]}]]},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS}}var kme={series:{item:{up:YG("up"),down:YG("down")},highlightStyle:{item:{strokeWidth:3}}},animation:{enabled:!1},axes:{[$G.NUMBER]:{crosshair:{snap:!1}},[$G.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},{CARTESIAN_AXIS_TYPE:XG,CARTESIAN_POSITION:ZG}=R.ThemeConstants,Lme={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",moduleFactory:e=>new Ox(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:XG.NUMBER,position:ZG.LEFT},{type:XG.ORDINAL_TIME,position:ZG.BOTTOM}],themeTemplate:kme,groupable:!1},qG={type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,options:kI,create:e=>new Ox(e)},{CachedTextMeasurerPool:QG,TextUtils:JG,TextWrapper:Fx}=R;function Pme(e,t){const{fontSize:i,minimumFontSize:s=i}=e,{fontSize:n,minimumFontSize:a=n}=t,r=i-s,o=n-a;let l=e.fontSize,c=t.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:n}];for(;l>s||c>a;){const d=r>0?(l-s)/r:-1,u=o>0?(c-a)/o:-1;d>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function bp(e,t){return e.lineHeight!=null&&e.fontSize!=null?e.lineHeight*t/e.fontSize:JG.getLineHeight(t)}function ez(e,t,i,s,{padding:n},a){var f,y;const{spacing:r=0}=t,o=2*n,l=2*n+r,c=((f=t.minimumFontSize)!=null?f:t.fontSize)+((y=s.minimumFontSize)!=null?y:s.fontSize);if(c>a(c+l,!1).height-l)return;const h=Pme(t,s),d={fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},u={fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight};let p,g;return mE(0,h.length-1,v=>{const{labelFontSize:x,secondaryLabelFontSize:S}=h[v],M=v===0,D=bp(t,x),A=bp(s,S),w=a(D+A+l,M),T=w.width-o,k=w.height-l;if(D+A>k||((p==null||p.fontSize!==x)&&(d.fontSize=x,p=iz(t,e,T,k,d,t.wrapping,M?t.overflowStrategy:"hide")),p==null||p.width>T||p.height>k)||((g==null||g.fontSize!==S)&&(u.fontSize=S,g=iz(s,i,T,k,u,s.wrapping,M?s.overflowStrategy:"hide")),g==null))return;const N=p.height+g.height;if(!(g.width>T||N>k))return{width:Math.max(p.width,g.width),height:N+r,meta:w.meta,label:p,secondaryLabel:g}})}function cm(e,t,{padding:i},s){var o;const n=2*i,a=Math.min((o=t.minimumFontSize)!=null?o:t.fontSize,t.fontSize),r={fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight};return mE(a,t.fontSize,l=>{var y;const c=bp(t,l),h=l===a,d=s(c+n,h),u=d.width-n,p=d.height-n;if(c>p)return;r.fontSize=l;const g=Fx.wrapLines(e,{maxWidth:u,maxHeight:p,font:r,textWrap:t.wrapping,overflow:(y=h?t.overflowStrategy:void 0)!=null?y:"hide"});if(!g.length)return;const f=Eme(g,{lineHeight:c,font:r,maxWidth:u,maxHeight:p});if(f)return[b({fontSize:l,lineHeight:c},f),d.meta]})}function tz(e){return(e==null?void 0:e.minimumFontSize)!=null&&(e==null?void 0:e.fontSize)!=null&&(e==null?void 0:e.minimumFontSize)>(e==null?void 0:e.fontSize)}function LI(e,t,i,s,n,a){const r=t.enabled?e:void 0,o=s.enabled?i:void 0;(tz(t)||tz(s))&&se.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;r!=null&&o!=null&&(l=ez(r,t,o,s,n,a));let c;if(l==null&&r!=null&&(c=cm(r,t,n,a)),c!=null){const[d,u]=c;l={width:d.width,height:d.height,meta:u,label:d,secondaryLabel:void 0}}let h;if(l==null&&r==null&&o!=null&&(h=cm(o,s,n,a)),h!=null){const[d,u]=h;l={width:d.width,height:d.height,meta:u,label:void 0,secondaryLabel:d}}return l}function iz(e,t,i,s,n,a,r){const o=Fx.wrapLines(t,{maxWidth:i,maxHeight:s,font:n,textWrap:a,overflow:r});if(!o.length)return;const l=bp(e,n.fontSize),{width:c}=QG.measureLines(o,{font:n});return{width:c,lineHeight:l,text:o.join(`
`),height:o.length*l,fontSize:n.fontSize}}function Eme(e,{font:t,lineHeight:i=JG.defaultLineHeight,maxWidth:s,maxHeight:n=1/0}){let a=i*e.length;for(;a>n;){if(e.length===1)return;e.pop(),e[e.length-1]=Fx.appendEllipsis(e.at(-1)),a=i*e.length}const r=QG.measureLines(e,{font:t});let o,l;if(r.width>s){const c=[];l=0;for(const h of r.lineMetrics){if(h.width>s){if(!c.length)return;break}c.push(h.text),l=Math.max(l,h.width)}o=Fx.appendEllipsis(c.join(`
`))}else o=e.join(`
`),l=r.width;return{text:o,width:l,height:a}}var{Property:hm}=R,xp=class extends R.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};C([hm],xp.prototype,"wrapping",2),C([hm],xp.prototype,"overflowStrategy",2),C([hm],xp.prototype,"lineHeight",2),C([hm],xp.prototype,"minimumFontSize",2);var no=class extends xp{constructor(){super(...arguments),this.spacing=0}};C([hm],no.prototype,"spacing",2);var dm=class extends xp{},{CartesianSeriesProperties:Rme,SeriesTooltip:Nme,Property:Os}=R,vs=class extends Rme{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new no,this.tooltip=new Nme}};C([Os],vs.prototype,"title",2),C([Os],vs.prototype,"xKey",2),C([Os],vs.prototype,"yKey",2),C([Os],vs.prototype,"colorKey",2),C([Os],vs.prototype,"xName",2),C([Os],vs.prototype,"yName",2),C([Os],vs.prototype,"colorName",2),C([Os],vs.prototype,"colorRange",2),C([Os],vs.prototype,"stroke",2),C([Os],vs.prototype,"strokeOpacity",2),C([Os],vs.prototype,"strokeWidth",2),C([Os],vs.prototype,"textAlign",2),C([Os],vs.prototype,"verticalAlign",2),C([Os],vs.prototype,"itemPadding",2),C([Os],vs.prototype,"itemStyler",2),C([Os],vs.prototype,"label",2),C([Os],vs.prototype,"tooltip",2);var{SeriesNodePickMode:sz,computeBarFocusBounds:Ome,getMissCount:Fme,valueProperty:PI,ChartAxisDirection:za,DEFAULT_CARTESIAN_DIRECTION_KEYS:Bme,DEFAULT_CARTESIAN_DIRECTION_NAMES:_me,createDatumId:Gme,ColorScale:zme,Rect:Vme,PointerEvents:jme,applyShapeStyle:Hme}=R,Wme=class extends R.CartesianSeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.colorKey=s.properties.colorKey}},Ume={left:-.5,center:0,right:-.5},Kme={top:-.5,middle:0,bottom:-.5},Bx=class extends R.CartesianSeries{constructor(e){super({moduleCtx:e,directionKeys:Bme,directionNames:_me,categoryKey:void 0,pickModes:[sz.NEAREST_NODE,sz.EXACT_SHAPE_MATCH],pathsPerSeries:[],hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new vs,this.NodeEvent=Wme,this.colorScale=new zme}async processData(e){var g,f,y;const t=this.axes[za.X],i=this.axes[za.Y];if(!t||!i||!((g=this.data)!=null&&g.length))return;const{xKey:s,yKey:n,colorRange:a,colorKey:r}=this.properties,o=(f=this.axes[za.X])==null?void 0:f.scale,l=(y=this.axes[za.Y])==null?void 0:y.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:o,yScale:l}),d=this.colorScale.type,{dataModel:u,processedData:p}=await this.requestDataModel(e,this.data,{props:[PI(s,c,{id:"xValue"}),PI(n,h,{id:"yValue"}),...r?[PI(r,d,{id:"colorValue",invalidValue:null})]:[]]});if(this.isColorScaleValid()){const v=u.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=p.domain.values[v],this.colorScale.range=a,this.colorScale.update()}}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,a=Fme(this,i.defs.values[s].missing);return!(n===0||n===a)}xCoordinateRange(e,t){var r,o;const i=this.axes[za.X].scale,s=t*((r=i.bandwidth)!=null?r:0)/2,n=i.convert(e)+s,a=t*((o=i.bandwidth)!=null?o:10);return[n,n+a]}yCoordinateRange(e,t){var r,o;const i=this.axes[za.Y].scale,s=t*((r=i.bandwidth)!=null?r:0)/2,n=i.convert(e[0])+s,a=t*((o=i.bandwidth)!=null?o:10);return[n,n+a]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;return!t||!i?[]:e===za.X?t.getDomain(this,"xValue","value",i):t.getDomain(this,"yValue","value",i)}getSeriesRange(e,t){return[NaN,NaN]}createNodeData(){var G,V,j,H,U,$;const{data:e,visible:t,axes:i,dataModel:s,processedData:n}=this,a=i[za.X],r=i[za.Y];if(!(e&&s&&n&&t&&a&&r))return;if(a.type!=="category"||r.type!=="category"){se.warnOnce(`Heatmap series expected axes to have "category" type, but received "${a.type}" and "${r.type}" instead.`);return}const{xKey:o,xName:l,yKey:c,yName:h,colorKey:d,colorName:u,textAlign:p,verticalAlign:g,itemPadding:f,label:y}=this.properties,v=s.resolveColumnById(this,"xValue",n),x=s.resolveColumnById(this,"yValue",n),S=d?s.resolveColumnById(this,"colorValue",n):void 0,M=a.scale,D=r.scale,A=((G=M.bandwidth)!=null?G:0)/2,w=((V=D.bandwidth)!=null?V:0)/2,T=[],k=[],N=(j=M.bandwidth)!=null?j:10,O=(H=D.bandwidth)!=null?H:10,L=(N-2*f)*Ume[p],F=(O-2*f)*Kme[g],B=()=>({width:N,height:O,meta:null});return((U=n.dataSources.get(this.id))!=null?U:[]).forEach((W,Y)=>{const K=v[Y],Q=x[Y],Z=M.convert(K)+A,J=D.convert(Q)+w,ae=S==null?void 0:S[Y],oe=ae==null?void 0:this.getLabelText(y,{value:ae,datum:W,colorKey:d,colorName:u,xKey:o,yKey:c,xName:l,yName:h}),le=LI(oe,this.properties.label,void 0,this.properties.label,{padding:f},B),de={x:Z,y:J,size:0};if(T.push({series:this,itemId:c,datumIndex:Y,yKey:c,xKey:o,xValue:K,yValue:Q,colorValue:ae,datum:W,point:de,width:N,height:O,midPoint:{x:Z,y:J},missing:S!=null&&ae==null}),(le==null?void 0:le.label)!=null){const{text:ue,fontSize:ie,lineHeight:re,height:te}=le.label,{fontStyle:fe,fontFamily:me,fontWeight:Le,color:Ee}=this.properties.label,He=de.x+L*(N-2*f),Ue=de.y+F*(O-2*f)-(le.height-te)*.5;k.push({series:this,itemId:c,datum:W,datumIndex:Y,text:ue,fontSize:ie,lineHeight:re,fontStyle:fe,fontFamily:me,fontWeight:Le,color:Ee,textAlign:p,verticalAlign:g,x:He,y:Ue})}}),{itemId:($=this.properties.yKey)!=null?$:this.id,nodeData:T,labelData:k,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new Vme}update(e){return this.ctx.animationManager.skipCurrentBatch(),super.update(e)}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t!=null?t:[];return i.update(s)}getItemBaseStyle(e){var s,n,a,r;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return{fill:i==null?void 0:i.fill,fillOpacity:(s=i==null?void 0:i.fillOpacity)!=null?s:1,stroke:(n=i==null?void 0:i.stroke)!=null?n:t.stroke,strokeWidth:(a=i==null?void 0:i.strokeWidth)!=null?a:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(r=i==null?void 0:i.strokeOpacity)!=null?r:t.strokeOpacity}}getItemStyleOverrides(e,t,i,s,n){const{id:a,properties:r}=this,{xKey:o,yKey:l,itemStyler:c}=r,h=this.isColorScaleValid()&&i!=null?this.colorScale.convert(i):"transparent";let d=s.fill==null?{fill:h}:void 0;if(c!=null){d!=null||(d={});const u=this.cachedDatumCallback(Gme(e,n?"highlight":"node"),()=>this.callWithContext(c,E(b({seriesId:a,datum:t,xKey:o,yKey:l,highlighted:n},s),{fill:h})));Object.assign(d,u)}return d}updateDatumNodes(e){var l;const{isHighlight:t}=e,i=this.axes[za.X],[s,n]=(l=i==null?void 0:i.visibleRange)!=null?l:[],r=!(s!==0||n!==1),o=this.getItemBaseStyle(t);e.datumSelection.each((c,h)=>{const{datumIndex:d,colorValue:u,datum:p,point:g,width:f,height:y}=h,v=this.getItemStyleOverrides(String(d),p,u,o,t);c.crisp=r,c.x=Math.floor(g.x-f/2),c.y=Math.floor(g.y-y/2),c.width=Math.ceil(f),c.height=Math.ceil(y),Hme(c,o,v)})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e,{enabled:s}=this.properties.label,n=s?t:[];return i.update(n)}updateLabelNodes(e){e.labelSelection.each((t,i)=>{t.text=i.text,t.fontSize=i.fontSize,t.lineHeight=i.lineHeight,t.fontStyle=i.fontStyle,t.fontFamily=i.fontFamily,t.fontWeight=i.fontWeight,t.fill=i.color,t.textAlign=i.textAlign,t.textBaseline=i.verticalAlign,t.x=i.x,t.y=i.y,t.pointerEvents=jme.None})}getTooltipContent(e){var O;const{id:t,dataModel:i,processedData:s,axes:n,properties:a,colorScale:r}=this,{xKey:o,xName:l,yKey:c,yName:h,colorKey:d,colorName:u,colorRange:p,title:g,legendItemName:f,tooltip:y}=a,v=n[za.X],x=n[za.Y];if(!i||!s||!v||!x)return;const S=(O=s.dataSources.get(this.id))==null?void 0:O[e],M=i.resolveColumnById(this,"xValue",s)[e],D=i.resolveColumnById(this,"yValue",s)[e],A=d!=null&&this.isColorScaleValid()?i.resolveColumnById(this,"colorValue",s)[e]:void 0;if(M==null)return;const w=[];let T;A==null?T=p[0]:(T=r.convert(A),w.push({label:u,fallbackLabel:d,value:String(A)})),w.push({label:l,fallbackLabel:o,value:v.formatDatum(M)},{label:h,fallbackLabel:c,value:x.formatDatum(D)});const k=this.getItemBaseStyle(!1);Object.assign(k,this.getItemStyleOverrides(String(e),S,A,k,!1)),k.fill!=null&&(T=k.fill);const N=T!=null?{marker:{shape:"square",fill:T,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}}:void 0;return this.formatTooltipWithContext(y,{title:g!=null?g:f,symbol:N,data:w},b({seriesId:t,datum:S,title:g,xKey:o,xName:l,yKey:c,yName:h,colorKey:d,colorName:u},k))}getLegendData(e){return e!=="gradient"||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:e}){var r;const t=(r=this.contextNodeData)==null?void 0:r.nodeData[e];if(t===void 0)return;const{width:i,height:s,midPoint:n}=t,a={x:n.x-i/2,y:n.y-s/2,width:i,height:s};return Ome(this,a)}};Bx.className="HeatmapSeries",Bx.type="heatmap";var{commonSeriesOptionsDefs:$me,heatmapSeriesThemeableOptionsDef:Yme}=R,Xme=E(b(b({},Yme),$me),{type:ee(Oe("heatmap")),xKey:ee(z),yKey:ee(z),colorKey:z,xName:z,yName:z,colorName:z,colorRange:Ie(ye)}),Zme={series:{stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"backgroundColor"},{$path:["./0",{$palette:"stroke"},{$palette:"strokes"}]}]},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},R.SAFE_RANGE2_OPERATION]},label:{enabled:!1,color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:nz,CARTESIAN_POSITION:az}}=R,qme={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",moduleFactory:e=>new Bx(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:nz.CATEGORY,position:az.LEFT},{type:nz.CATEGORY,position:az.BOTTOM}],themeTemplate:Zme},rz={type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,options:Xme,create:e=>new Bx(e)},{createDatumId:Qme}=R,_x=class extends HG{constructor(){super(...arguments),this.properties=new Rx}nodeFactory(){return new fme}updateDatumNodes({datumSelection:e,isHighlight:t}){const{id:i,properties:s}=this,{xKey:n,highKey:a,lowKey:r,openKey:o,closeKey:l,item:c,itemStyler:h}=s,{up:d,down:u}=c,{stroke:p,strokeWidth:g,strokeOpacity:f,lineDash:y,lineDashOffset:v}=d,{stroke:x,strokeWidth:S,strokeOpacity:M,lineDash:D,lineDashOffset:A}=u,w=t?s.highlightStyle.item:void 0;e.each((T,k)=>{var H,U,$,W,Y,K,Q,Z,J,ae,oe;const{isRising:N,centerX:O,width:L,y:F,height:B,yOpen:_,yClose:G,crisp:V}=k;let j;if(h!=null){const{stroke:le,strokeWidth:de,strokeOpacity:ue,lineDash:ie,lineDashOffset:re}=N?d:u;j=this.cachedDatumCallback(Qme(this.getDatumId(k),t?"highlight":"node"),()=>this.callWithContext(h,{seriesId:i,itemId:k.itemId,xKey:n,highKey:a,lowKey:r,openKey:o,closeKey:l,datum:k.datum,strokeOpacity:ue,stroke:le,strokeWidth:de,lineDash:ie,lineDashOffset:re,highlighted:t}))}T.centerX=O,T.width=L,T.y=F,T.height=B,T.yOpen=_,T.yClose=G,T.crisp=V,T.stroke=(U=(H=w==null?void 0:w.stroke)!=null?H:j==null?void 0:j.stroke)!=null?U:N?p:x,T.strokeWidth=(W=($=w==null?void 0:w.strokeWidth)!=null?$:j==null?void 0:j.strokeWidth)!=null?W:N?g:S,T.strokeOpacity=(K=(Y=w==null?void 0:w.strokeOpacity)!=null?Y:j==null?void 0:j.strokeOpacity)!=null?K:N?f:M,T.lineDash=(Z=(Q=w==null?void 0:w.lineDash)!=null?Q:j==null?void 0:j.lineDash)!=null?Z:N?y:D,T.lineDashOffset=(ae=(J=w==null?void 0:w.lineDashOffset)!=null?J:j==null?void 0:j.lineDashOffset)!=null?ae:N?v:A,T.strokeAlignment=((oe=j==null?void 0:j.strokeWidth)!=null?oe:N?g:S)/2})}getLegendData(e){var u;const{id:t,data:i,ctx:{legendManager:s},visible:n}=this,{xKey:a,yName:r,item:{up:o,down:l},showInLegend:c,legendItemName:h}=this.properties;if(!(i!=null&&i.length)||!a||e!=="category")return[];const d={type:"gradient",gradient:"linear",colorSpace:"rgb",colorStops:[{color:o.stroke,stop:0},{color:o.stroke,stop:.5},{color:l.stroke,stop:.5}],rotation:90};return[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:n&&s.getItemEnabled({seriesId:t,itemId:t}),label:{text:(u=h!=null?h:r)!=null?u:t},symbol:{marker:{fill:d,fillOpacity:o.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}},legendItemName:h,hideInLegend:!c}]}};_x.className="ohlc",_x.type="ohlc";var{commonSeriesOptionsDefs:Jme,ohlcSeriesThemeableOptionsDef:eye}=R,EI=E(b(b({},eye),Jme),{type:ee(Oe("ohlc")),xKey:ee(z),openKey:ee(z),highKey:ee(z),lowKey:ee(z),closeKey:ee(z),xName:z,yName:z,openName:z,highName:z,lowName:z,closeName:z});EI.pickOutsideVisibleMinorAxis=Ce(q),EI.focusPriority=Ce(ne);var{CARTESIAN_AXIS_TYPE:Gx,CARTESIAN_POSITION:oz}=R.ThemeConstants,tye={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",moduleFactory:e=>new _x(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Gx.NUMBER,position:oz.LEFT},{type:Gx.ORDINAL_TIME,position:oz.BOTTOM}],themeTemplate:{animation:{enabled:!1},series:{item:{up:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"up.stroke"}]}},down:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"down.stroke"}]}}}},axes:{[Gx.NUMBER]:{crosshair:{snap:!1}},[Gx.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1},lz={type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,options:EI,create:e=>new _x(e)},iye=1e3;function cz(e,t,i,s,n,a){const r=e[a];if(r==null)return!1;const o=kx(r,t,i),l=Lx(o,n);return a===s[l+Gn]}function hz(e,t,i,s,n,a){const r=e[a];if(r==null)return!1;const o=kx(r,t,i),l=Lx(o,n);return a===s[l+_n]}function sye(e,t,i,s){if(e.length<iye)return;const[n,a]=rm(s);let r=am(e);const{indexData:o,valueData:l}=om(e,t,i,n,a,r);let c=[],h=[];for(let u=0;u<e.length;u+=1)cz(e,n,a,o,r,u)&&c.push(u),hz(e,n,a,o,r,u)&&h.push(u);const d=[{maxRange:r,topIndices:c,bottomIndices:h}];for(;r>64;)({maxRange:r}=lm(o,l,r,{inPlace:!0})),c=c.filter(cz.bind(null,e,n,a,o,r)),h=h.filter(hz.bind(null,e,n,a,o,r)),d.push({maxRange:r,topIndices:c,bottomIndices:h});return d.reverse(),d}var{CartesianSeriesProperties:nye,FillGradientDefaults:aye,FillPatternDefaults:rye,FillImageDefaults:oye,InterpolationProperties:lye,SeriesMarker:cye,SeriesTooltip:hye,Property:Kt,DropShadow:dye,Label:uye}=R,RI=class extends uye{constructor(){super(...arguments),this.placement="outside",this.padding=6}};C([Kt],RI.prototype,"placement",2),C([Kt],RI.prototype,"padding",2);var ti=class extends nye{constructor(){super(...arguments),this.fill="#99CCFF",this.fillGradientDefaults=new aye,this.fillPatternDefaults=new rye,this.fillImageDefaults=new oye,this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new lye,this.shadow=new dye().set({enabled:!1}),this.marker=new cye,this.label=new RI,this.tooltip=new hye,this.connectMissingData=!1}};C([Kt],ti.prototype,"xKey",2),C([Kt],ti.prototype,"yLowKey",2),C([Kt],ti.prototype,"yHighKey",2),C([Kt],ti.prototype,"xName",2),C([Kt],ti.prototype,"yName",2),C([Kt],ti.prototype,"yLowName",2),C([Kt],ti.prototype,"yHighName",2),C([Kt],ti.prototype,"fill",2),C([Kt],ti.prototype,"fillGradientDefaults",2),C([Kt],ti.prototype,"fillPatternDefaults",2),C([Kt],ti.prototype,"fillImageDefaults",2),C([Kt],ti.prototype,"fillOpacity",2),C([Kt],ti.prototype,"stroke",2),C([Kt],ti.prototype,"strokeWidth",2),C([Kt],ti.prototype,"strokeOpacity",2),C([Kt],ti.prototype,"lineDash",2),C([Kt],ti.prototype,"lineDashOffset",2),C([Kt],ti.prototype,"interpolation",2),C([Kt],ti.prototype,"shadow",2),C([Kt],ti.prototype,"marker",2),C([Kt],ti.prototype,"label",2),C([Kt],ti.prototype,"tooltip",2),C([Kt],ti.prototype,"connectMissingData",2);var{CollapseMode:zx,isScaleValid:dz,pairUpSpans:Vx,prepareAreaFillAnimationFns:pye,plotInterpolatedLinePathStroke:Cp,prepareLinePathPropertyAnimation:gye,areScalingEqual:uz}=R;function fye(e,t,i,s){const n=(l,c)=>{Cp(l,c,t.removed),Cp(l,c,i.removed)},a=(l,c)=>{Cp(l,c,t.moved),Cp(l,c,i.moved)},r=(l,c)=>{Cp(l,c,t.added),Cp(l,c,i.added)},o=gye(e,s);return{status:e,path:{addPhaseFn:r,updatePhaseFn:a,removePhaseFn:n},pathProperties:o}}function mye(e,t,i){var g,f,y;const s=((g=e.scales.x)==null?void 0:g.type)==="category",n=((f=t.scales.x)==null?void 0:f.type)==="category";if(s!==n||!dz(e.scales.x)||!dz(t.scales.x))return;let a="updated";t.visible&&!e.visible?a="removed":!t.visible&&e.visible&&(a="added");const r=Vx({scales:e.scales,data:e.fillData.spans},{scales:t.scales,data:t.fillData.spans},zx.Split);if(r==null)return;const o=Vx({scales:e.scales,data:e.fillData.phantomSpans},{scales:t.scales,data:t.fillData.phantomSpans},zx.Split);if(o==null)return;const l=Vx({scales:e.scales,data:e.highStrokeData.spans},{scales:t.scales,data:t.highStrokeData.spans},zx.Split);if(l==null)return;const c=Vx({scales:e.scales,data:e.lowStrokeData.spans},{scales:t.scales,data:t.lowStrokeData.spans},zx.Split);if(c==null)return;const h="fade",d=pye(a,r,o,h),u=fye(a,l,c,h),p=((y=i==null?void 0:i.changed)!=null?y:!0)||!uz(e.scales.x,t.scales.x)||!uz(e.scales.y,t.scales.y)||a!=="updated";return{status:a,fill:d,stroke:u,hasMotion:p}}var{valueProperty:pz,keyProperty:yye,ChartAxisDirection:tn,mergeDefaults:vye,updateLabelNode:bye,fixNumericExtent:gz,buildResetPathFn:xye,resetLabelFn:Cye,resetMarkerFn:Sye,resetMarkerPositionFn:fz,pathSwipeInAnimation:Mye,resetMotion:Dye,markerSwipeScaleInAnimation:wye,seriesLabelFadeInAnimation:NI,animationValidation:Aye,diff:Iye,updateClipPath:mz,computeMarkerFocusBounds:yz,plotAreaPathFill:Tye,plotLinePathStroke:vz,interpolatePoints:bz,pathFadeInAnimation:xz,markerFadeInAnimation:Cz,fromToMotion:Sz,pathMotion:Mz,extent:kye,createDatumId:Lye,applyShapeFillBBox:Pye,PointerEvents:OI,Group:Eye,BBox:Rye,ContinuousScale:Nye,DiscreteTimeScale:Oye,findMinMax:Fye,getShapeStyle:Bye,getShapeFill:_ye,applyShapeStyle:Gye}=R,zye=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.yLowKey=s.properties.yLowKey,this.yHighKey=s.properties.yHighKey}},jx=class extends R.CartesianSeries{constructor(e){super({moduleCtx:e,hasMarkers:!0,pathsPerSeries:["fill","stroke"],pickModes:[R.SeriesNodePickMode.AXIS_ALIGNED],directionKeys:{[tn.X]:["xKey"],[tn.Y]:["yLowKey","yHighKey"]},directionNames:{[tn.X]:["xName"],[tn.Y]:["yLowName","yHighName","yName"]},categoryKey:"xValue",animationResetFns:{path:xye({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:Cye,marker:(t,i)=>b(b({},Sye(t)),fz(t,i))},clipFocusBox:!1}),this.properties=new ti,this.NodeEvent=zye,this.dataAggregationFilters=void 0}async processData(e){var u,p;const{xKey:t,yLowKey:i,yHighKey:s}=this.properties,n=(u=this.axes[tn.X])==null?void 0:u.scale,a=(p=this.axes[tn.Y])==null?void 0:p.scale,{xScaleType:r,yScaleType:o}=this.getScaleInformation({xScale:n,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(Iye(this.id,this.processedData)),c&&l.push(Aye());const{dataModel:h,processedData:d}=await this.requestDataModel(e,this.data,{props:[yye(t,r,{id:"xValue"}),pz(i,o,{id:"yLowValue"}),pz(s,o,{id:"yHighValue"}),...l]});this.dataAggregationFilters=this.aggregateData(h,d),this.animationState.transition("updateData")}aggregateData(e,t){const i=this.axes[tn.X];if(i==null||!(Nye.is(i.scale)||Oye.is(i.scale)))return;const s=e.resolveKeysById(this,"xValue",t),n=e.resolveColumnById(this,"yHighValue",t),a=e.resolveColumnById(this,"yLowValue",t),{index:r}=e.resolveProcessedDataDefById(this,"xValue"),o=t.domain.keys[r];return sye(s,n,a,o)}xCoordinateRange(e){const t=this.axes[tn.X].scale.convert(e);return[t,t]}yCoordinateRange(e){const t=this.axes[tn.Y].scale.convert(e[0]);return[t,t]}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return[];const{domain:{keys:[s]}}=t;if(e===tn.X){const n=i.resolveProcessedDataDefById(this,"xValue");return(n==null?void 0:n.def.type)==="key"&&n.def.valueType==="category"?s:gz(kye(s))}else{const n=this.domainForClippedRange(tn.Y,["yHighValue","yLowValue"],"xValue",!0),a=Fye(n);return gz(a)}}getSeriesRange(e,t){return this.domainForVisibleRange(tn.Y,["yHighValue","yLowValue"],"xValue",t,!0)}createNodeData(){var U,$,W,Y,K;const{data:e,dataModel:t,processedData:i,axes:s}=this,n=s[tn.X],a=s[tn.Y];if(!(e&&n&&a&&t&&i))return;const r=n.scale,o=a.scale,{xKey:l,yLowKey:c,yHighKey:h,connectMissingData:d,marker:u,interpolation:p}=this.properties,g=(U=i.dataSources.get(this.id))!=null?U:[],f=(($=r.bandwidth)!=null?$:0)/2,y=t.resolveKeysById(this,"xValue",i),v=t.resolveColumnById(this,"yHighValue",i),x=t.resolveColumnById(this,"yLowValue",i),S=Q=>r.convert(y[Q])+f,M=[],D=[],A=[],w=(Q,Z,J)=>{const ae=g[Q],oe=y[Q];if(oe==null)return;const le=A[A.length-1];if(Number.isFinite(Z)&&Number.isFinite(J)){const de=(Le,Ee,He)=>{D.push({index:Q,series:this,itemId:Le,datum:ae,datumIndex:Q,midPoint:{x:ie,y:He},yHighValue:Z,yLowValue:J,xValue:oe,xKey:l,yLowKey:c,yHighKey:h,point:{x:ie,y:He,size:fe},enabled:!0});const Ue=this.createLabelData({datumIndex:Q,point:{x:ie,y:He},value:Ee,yLowValue:J,yHighValue:Z,itemId:Le,inverted:ue,datum:ae,series:this});M.push(Ue)},ue=J>Z,ie=S(Q),re=o.convert(Z),te=o.convert(J),{size:fe}=u;de("high",Z,re),de("low",J,te);const me={high:{point:{x:ie,y:re},xDatum:oe,yDatum:Z},low:{point:{x:ie,y:te},xDatum:oe,yDatum:J}};Array.isArray(le)?le.push(me):le!=null?(le.skip+=1,A.push([me])):A.push([me])}else d||(Array.isArray(le)||le==null?A.push({skip:0}):le.skip+=1)},{dataAggregationFilters:T}=this,[k,N]=r.range,O=N-k,L=T==null?void 0:T.find(Q=>Q.maxRange>O),F=L==null?void 0:L.topIndices,B=L==null?void 0:L.bottomIndices;let[_,G]=this.visibleRange("xValue",n.range,F);_=Math.max(_-1,0),G=Math.min(G+1,(W=F==null?void 0:F.length)!=null?W:y.length),i.input.count<1e3&&(_=0,G=i.input.count);for(let Q=_;Q<G;Q+=1){const Z=(Y=F==null?void 0:F[Q])!=null?Y:Q,J=(K=B==null?void 0:B[Q])!=null?K:Q;w(Z,v[Z],x[J])}const V=A.flatMap(Q=>{if(!Array.isArray(Q))return[];const Z=Q.map(J=>J.high);return bz(Z,p)}),j=A.flatMap(Q=>{if(!Array.isArray(Q))return[];const Z=Q.map(J=>J.low);return bz(Z,p)});return{itemId:`${c}-${h}`,labelData:M,nodeData:D,fillData:{itemId:"high",spans:V,phantomSpans:j},highStrokeData:{itemId:"high",spans:V},lowStrokeData:{itemId:"low",spans:j},scales:this.calculateScaling(),visible:this.visible}}createLabelData({datumIndex:e,point:t,value:i,itemId:s,inverted:n,datum:a,series:r}){const{xKey:o,yLowKey:l,yHighKey:c,xName:h,yName:d,yLowName:u,yHighName:p,label:g}=this.properties,{placement:f,padding:y=10}=g;let v=s;n&&(v=s==="low"?"high":"low");const x=f==="outside"&&v==="high"||f==="inside"&&v==="low"?-1:1;return{x:t.x,y:t.y+y*x,series:r,itemId:s,datum:a,datumIndex:e,text:this.getLabelText(g,{value:i,datum:a,itemId:s,xKey:o,yLowKey:l,yHighKey:c,xName:h,yLowName:u,yHighName:p,yName:d}),textAlign:"center",textBaseline:x===-1?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(e){const{opacity:t,visible:i}=e,[s,n]=e.paths,a=this.getStrokeWidth(this.properties.strokeWidth);n.setProperties({fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:OI.None,stroke:this.properties.stroke,strokeWidth:a,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:t,visible:i});const r=_ye(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults),o=this.getShapeFillBBox();Pye(s,r,o),Gye(s,{stroke:void 0,fill:r,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,strokeWidth:a},void 0,o),s.setProperties({pointerEvents:OI.None,lineJoin:"round",fillShadow:this.properties.shadow,opacity:t,visible:i}),mz(this,n),mz(this,s)}updatePaths(e){this.updateAreaPaths(e.paths,e.contextData)}updateAreaPaths(e,t){for(const i of e)i.visible=t.visible;if(t.visible)this.updateFillPath(e,t),this.updateStrokePath(e,t);else for(const i of e)i.path.clear(),i.markDirty("RangeArea")}updateFillPath(e,t){const[i]=e;i.path.clear(),Tye(i,t.fillData),i.markDirty("RangeArea")}updateStrokePath(e,t){const[,i]=e;i.path.clear(),vz(i,t.highStrokeData.spans),vz(i,t.lowStrokeData.spans),i.markDirty("RangeArea")}updateMarkerSelection(e){const{nodeData:t,markerSelection:i}=e;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?t:[])}getMarkerItemBaseStyle(e){var n,a,r,o,l,c,h;const{properties:t}=this,{marker:i}=t,s=e?t.highlightStyle.item:void 0;return{shape:i.shape,size:i.size,fill:(n=s==null?void 0:s.fill)!=null?n:i.fill,fillOpacity:(a=s==null?void 0:s.fillOpacity)!=null?a:i.fillOpacity,stroke:(r=s==null?void 0:s.stroke)!=null?r:i.stroke,strokeWidth:(o=s==null?void 0:s.strokeWidth)!=null?o:this.getStrokeWidth(i.strokeWidth),strokeOpacity:(l=s==null?void 0:s.strokeOpacity)!=null?l:i.strokeOpacity,lineDash:(c=s==null?void 0:s.lineDash)!=null?c:i.lineDash,lineDashOffset:(h=s==null?void 0:s.lineDashOffset)!=null?h:i.lineDashOffset}}getMarkerItemStyleOverrides(e,t,i,s){const{id:n,properties:a}=this,{xKey:r,yHighKey:o,yLowKey:l,marker:c}=a,{itemStyler:h}=c;if(h!=null)return this.cachedDatumCallback(Lye(e,s?"highlight":"node"),()=>this.callWithContext(h,b({seriesId:n,datum:t,xKey:r,yHighKey:o,yLowKey:l,highlighted:s},i)))}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i}=e,{xKey:s,yLowKey:n,yHighKey:a,marker:r,fill:o,stroke:l,strokeWidth:c,fillOpacity:h,strokeOpacity:d}=this.properties,u=vye(i&&this.properties.highlightStyle.item,r.getStyle(),{fill:o,fillOpacity:h,stroke:l,strokeWidth:c,strokeOpacity:d}),p=this.getShapeFillBBox();t.each((g,f)=>{this.updateMarkerStyle(r,g,f.datum,f.point,{xKey:s,yHighKey:a,yLowKey:n},i,u,p)}),i||this.properties.marker.markClean()}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,s=>{s.pointerEvents=OI.None})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{bye(t,this.properties.label,i)})}getHighlightLabelData(e,t){const i=e.filter(s=>s.datum===t.datum);return i.length>0?i:void 0}getHighlightData(e,t){const i=e.filter(s=>s.datum===t.datum);return i.length>0?i:void 0}getTooltipContent(e,t){var w,T;const{id:i,dataModel:s,processedData:n,axes:a,properties:r}=this,{xName:o,yName:l,yLowKey:c,yLowName:h,xKey:d,yHighKey:u,yHighName:p,tooltip:g}=r,f=a[tn.X],y=a[tn.Y];if(!s||!n||!f||!y)return;const v=(w=n.dataSources.get(this.id))==null?void 0:w[e],x=s.resolveKeysById(this,"xValue",n)[e],S=s.resolveColumnById(this,"yHighValue",n)[e],M=s.resolveColumnById(this,"yLowValue",n)[e];if(x==null)return;const D=this.getMarkerItemBaseStyle(!1);Object.assign(D,this.getMarkerItemStyleOverrides(String(e),e,D,!1));const A=`${y.formatDatum(M)} - ${y.formatDatum(S)}`;return this.formatTooltipWithContext(g,{heading:f.formatDatum(x),symbol:this.legendItemSymbol(),data:[{label:l,fallbackLabel:`${h!=null?h:c} - ${p!=null?p:u}`,value:A}]},b({seriesId:i,datum:v,title:l,itemId:(T=t==null?void 0:t.itemId)!=null?T:"unknown",xName:o,yName:l,yLowKey:c,yLowName:h,xKey:d,yHighKey:u,yHighName:p},D))}legendItemSymbol(){var o,l;const{fill:e,stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,marker:a}=this.properties;return{marker:Bye({shape:a.shape,fill:(o=a.fill)!=null?o:e,stroke:(l=a.stroke)!=null?l:t,fillOpacity:a.fillOpacity,strokeOpacity:a.strokeOpacity,strokeWidth:a.strokeWidth,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset},a.fillGradientDefaults,a.fillPatternDefaults,a.fillImageDefaults),line:{stroke:t,strokeOpacity:s,strokeWidth:i,lineDash:n}}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yLowKey:s,yHighKey:n,yName:a,yLowName:r,yHighName:o,showInLegend:l}=this.properties,c=a!=null?a:`${r!=null?r:s} - ${o!=null?o:n}`,h=`${s}-${n}`;return[{legendType:"category",id:t,itemId:h,seriesId:t,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new Eye}animateEmptyUpdateReady(e){const{markerSelection:t,labelSelection:i,contextData:s,paths:n}=e,{animationManager:a}=this.ctx;this.updateAreaPaths(n,s),Mye(this,a,...n),Dye([t],fz),wye(this,a,t),NI(this,"labels",a,i)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){var u,p,g;const{animationManager:t}=this.ctx,{markerSelection:i,labelSelection:s,contextData:n,paths:a,previousContextData:r}=e,[o,l]=a;if(o==null&&l==null)return;this.resetMarkerAnimation(e),this.resetLabelAnimation(e);const c=()=>{this.resetPathAnimation(e),this.updateAreaPaths(a,n)},h=()=>{t.skipCurrentBatch(),c()};if(n==null||r==null){c(),Cz(this,t,"added",i),xz(this,"fill_path_properties",t,"add",o),xz(this,"stroke_path_properties",t,"add",l),NI(this,"labels",t,s);return}const d=mye(n,r,(g=(p=(u=this.processedData)==null?void 0:u.reduced)==null?void 0:p.diff)==null?void 0:g[this.id]);if(d===void 0){h();return}else if(d.status==="no-op")return;Sz(this.id,"fill_path_properties",t,[o],d.fill.pathProperties),Sz(this.id,"stroke_path_properties",t,[l],d.stroke.pathProperties),d.status==="added"?this.updateAreaPaths(a,n):d.status==="removed"?this.updateAreaPaths(a,r):(Mz(this.id,"fill_path_update",t,[o],d.fill.path),Mz(this.id,"stroke_path_update",t,[l],d.stroke.path)),d.hasMotion&&(Cz(this,t,void 0,i),NI(this,"labels",t,s)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,n)})}getFormattedMarkerStyle(e){const{xKey:t,yLowKey:i,yHighKey:s}=this.properties;return this.getMarkerStyle(this.properties.marker,e.datum,{xKey:t,yLowKey:i,yHighKey:s},!0)}computeFocusBounds(e){const t=yz(this,e),i=yz(this,E(b({},e),{datumIndex:e.datumIndex+1}));if(t&&i)return Rye.merge([t,i])}isDatumEnabled(e,t){return t%2===0&&super.isDatumEnabled(e,t)}};jx.className="RangeAreaSeries",jx.type="range-area";var{commonSeriesOptionsDefs:Vye,rangeAreaSeriesThemeableOptionsDef:jye}=R,FI=E(b(b({},jye),Vye),{type:ee(Oe("range-area")),xKey:ee(z),yLowKey:ee(z),yHighKey:ee(z),xName:z,yName:z,yLowName:z,yHighName:z});FI.pickOutsideVisibleMinorAxis=Ce(q),FI.focusPriority=Ce(ne);var Hye={series:{fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,stroke:{$palette:"stroke"},fillOpacity:.7,nodeClickRange:"nearest",marker:{enabled:!1,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,size:6,strokeWidth:2},label:{enabled:!1,placement:"outside",padding:10,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},interpolation:{type:"linear"}},axes:{[R.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:Dz,CARTESIAN_POSITION:wz}}=R,Wye={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",moduleFactory:e=>new jx(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Dz.NUMBER,position:wz.LEFT},{type:Dz.CATEGORY,position:wz.BOTTOM}],themeTemplate:Hye},Az={type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,options:FI,create:e=>new jx(e)},Uye=1e3,Kye=5;function $ye(e,t,i,s){if(e.length<Uye)return;const[n,a]=rm(s);let r=am(e,Kye),{indexData:o,valueData:l}=om(e,t,i,n,a,r);const c=[{maxRange:r,indexData:o}];for(;r>64;)({indexData:o,valueData:l,maxRange:r}=lm(o,l,r)),c.push({maxRange:r,indexData:o});return c.reverse(),c}var{AbstractBarSeriesProperties:Yye,FillGradientDefaults:Xye,FillPatternDefaults:Zye,FillImageDefaults:qye,SeriesTooltip:Qye,Property:$t,DropShadow:Jye,Label:eve}=R,BI=class extends eve{constructor(){super(...arguments),this.placement="inside",this.padding=6}};C([$t],BI.prototype,"placement",2),C([$t],BI.prototype,"padding",2);var ii=class extends Yye{constructor(){super(...arguments),this.fill="#99CCFF",this.fillGradientDefaults=new Xye,this.fillPatternDefaults=new Zye,this.fillImageDefaults=new qye,this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new Jye().set({enabled:!1}),this.label=new BI,this.tooltip=new Qye,this.fastDataProcessing=!1}};C([$t],ii.prototype,"xKey",2),C([$t],ii.prototype,"yLowKey",2),C([$t],ii.prototype,"yHighKey",2),C([$t],ii.prototype,"xName",2),C([$t],ii.prototype,"yName",2),C([$t],ii.prototype,"yLowName",2),C([$t],ii.prototype,"yHighName",2),C([$t],ii.prototype,"fill",2),C([$t],ii.prototype,"fillGradientDefaults",2),C([$t],ii.prototype,"fillPatternDefaults",2),C([$t],ii.prototype,"fillImageDefaults",2),C([$t],ii.prototype,"fillOpacity",2),C([$t],ii.prototype,"stroke",2),C([$t],ii.prototype,"strokeWidth",2),C([$t],ii.prototype,"strokeOpacity",2),C([$t],ii.prototype,"lineDash",2),C([$t],ii.prototype,"lineDashOffset",2),C([$t],ii.prototype,"cornerRadius",2),C([$t],ii.prototype,"itemStyler",2),C([$t],ii.prototype,"shadow",2),C([$t],ii.prototype,"label",2),C([$t],ii.prototype,"tooltip",2),C([$t],ii.prototype,"fastDataProcessing",2);var{SeriesNodePickMode:Iz,valueProperty:Tz,keyProperty:tve,ChartAxisDirection:Hx,checkCrisp:ive,updateLabelNode:sve,SMALLEST_KEY_INTERVAL:nve,LARGEST_KEY_INTERVAL:ave,diff:rve,prepareBarAnimationFunctions:kz,midpointStartingBarPosition:Lz,resetBarSelectionsFn:ove,fixNumericExtent:lve,seriesLabelFadeInAnimation:Pz,resetLabelFn:cve,animationValidation:hve,computeBarFocusBounds:dve,visibleRangeIndices:Ez,createDatumId:uve,ContinuousScale:Rz,DiscreteTimeScale:pve,Rect:gve,PointerEvents:fve,motion:Nz,applyShapeStyle:mve,findMinMax:yve,getShapeStyle:_I,areScalingEqual:vve}=R,bve=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.yLowKey=s.properties.yLowKey,this.yHighKey=s.properties.yHighKey}},Wx=class extends R.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[Iz.AXIS_ALIGNED,Iz.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:ove,label:cve}}),this.properties=new ii,this.dataAggregationFilters=void 0,this.NodeEvent=bve}async processData(e){var f,y,v,x;const{xKey:t,yLowKey:i,yHighKey:s,fastDataProcessing:n}=this.properties,a=!n,r=(f=this.getCategoryAxis())==null?void 0:f.scale,o=(y=this.getValueAxis())==null?void 0:y.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:o}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(rve(this.id,this.processedData)),d.push(hve()));const u=this.visible?{}:{forceValue:0},{dataModel:p,processedData:g}=await this.requestDataModel(e,this.data,{props:[tve(t,c,{id:"xValue"}),Tz(i,h,b({id:"yLowValue",invalidValue:null},u)),Tz(s,h,b({id:"yHighValue",invalidValue:null},u)),...l?[nve,ave]:[],...d],groupByKeys:a});this.smallestDataInterval=(v=g.reduced)==null?void 0:v.smallestKeyInterval,this.largestDataInterval=(x=g.reduced)==null?void 0:x.largestKeyInterval,this.dataAggregationFilters=this.aggregateData(p,g),this.animationState.transition("updateData")}aggregateData(e,t){if(t.type!=="grouped")return;const i=this.axes[Hx.X];if(i==null||!(Rz.is(i.scale)||pve.is(i.scale)))return;const s=e.resolveKeysById(this,"xValue",t),n=e.resolveColumnById(this,"yHighValue",t),a=e.resolveColumnById(this,"yLowValue",t),{index:r}=e.resolveProcessedDataDefById(this,"xValue"),o=t.domain.keys[r];return $ye(s,n,a,o)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return[];const{keys:[s]}=t.domain;if(e===this.getCategoryDirection()){const n=i.resolveProcessedDataDefById(this,"xValue");return(n==null?void 0:n.def.type)==="key"&&(n==null?void 0:n.def.valueType)==="category"?s:this.padBandExtent(s)}else{const n=this.domainForClippedRange(e,["yHighValue","yLowValue"],"xValue",!0),a=yve(n);return lve(a)}}getSeriesRange(e,t){return this.domainForVisibleRange(Hx.Y,["yHighValue","yLowValue"],"xValue",t,!0)}createNodeData(){var G;const{data:e,dataModel:t,groupScale:i,processedData:s,visible:n}=this,a=this.getCategoryAxis(),r=this.getValueAxis();if(!(e&&a&&r&&t&&(s!=null&&s.dataSources)))return;const o=a.scale,l=r.scale,c=this.getBarDirection()===Hx.X,{xKey:h,yLowKey:d,yHighKey:u,strokeWidth:p}=this.properties,g=`${d}-${u}`,f={itemId:g,nodeData:[],labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};if(!n)return f;const y=(G=s.dataSources.get(this.id))!=null?G:[],v=t.resolveKeysById(this,"xValue",s),x=t.resolveColumnById(this,"yLowValue",s),S=t.resolveColumnById(this,"yHighValue",s),{barWidth:M,groupIndex:D}=this.updateGroupScale(a),A=Rz.is(o)?M*-.5:0,w=i.convert(String(D)),T=ive(a==null?void 0:a.scale,a==null?void 0:a.visibleRange,this.smallestDataInterval,this.largestDataInterval),k=V=>Math.round(o.convert(v[V]))+w+A,N=(V,j,H,U,$,W,Y)=>{const K=y[V],Q=v[V];if(Q==null)return;const Z=x[V],J=S[V];if(!Number.isFinite(Z==null?void 0:Z.valueOf())||!Number.isFinite(J==null?void 0:J.valueOf()))return;const[ae,oe]=Z<J?[Z,J]:[J,Z],le=Math.round(l.convert(W)),de=Math.round(l.convert($)),ue=Math.max(p,Math.abs(de-le)),ie={x:c?Math.min(le,de):H,y:c?H:Math.min(le,de),width:c?ue:U,height:c?U:ue},re={x:ie.x+ie.width/2,y:ie.y+ie.height/2},te=this.createLabelData({datumIndex:V,rect:ie,barAlongX:c,yLowValue:ae,yHighValue:oe,datum:K,series:this}),fe={index:j,valueIndex:V,series:this,itemId:g,datum:K,datumIndex:V,xValue:Q,yLowValue:Z,yHighValue:J,yLowKey:d,yHighKey:u,xKey:h,x:ie.x,y:ie.y,width:ie.width,height:ie.height,midPoint:re,crisp:Y,labels:te};f.nodeData.push(fe),f.labelData.push(...te)},{dataAggregationFilters:O}=this,[L,F]=o.range,B=F-L,_=O==null?void 0:O.find(V=>V.maxRange>B);if(_!=null){const{maxRange:V,indexData:j}=_,[H,U]=Ez(V,a.range,$=>{const W=$*ra,Y=j[W+Ns],K=j[W+xn];if(Y===-1)return;const Q=(Y+K)/2|0;return[k(Q),k(K)+M]});for(let $=H;$<U;$+=1){const W=$*ra,Y=j[W+Ns],K=j[W+xn],Q=j[W+_n],Z=j[W+Gn];if(Y===-1)continue;const J=(Y+K)/2|0;if(v[J]==null)continue;const oe=k(J),le=Math.abs(k(Y)-k(K))+M,de=x[Q],ue=S[Z];N(J,0,oe,le,de,ue,!1)}}else if(s.type==="ungrouped"){let[V,j]=Ez(y.length,a.range,H=>[k(H),M]);s.input.count<1e3&&(V=0,j=s.input.count);for(let H=V;H<j;H+=1){const U=k(H),$=M,W=x[H],Y=S[H];N(H,0,U,$,W,Y,T)}}else for(const{datumIndex:V,groupIndex:j}of t.forEachGroupDatum(this,s)){const H=k(V),U=M,$=x[V],W=S[V];N(V,j,H,U,$,W,T)}return f}createLabelData({datumIndex:e,rect:t,barAlongX:i,yLowValue:s,yHighValue:n,datum:a,series:r}){const{xKey:o,yLowKey:l,yHighKey:c,xName:h,yLowName:d,yHighName:u,yName:p,label:g}=this.properties,f={datum:a,xKey:o,yLowKey:l,yHighKey:c,xName:h,yLowName:d,yHighName:u,yName:p},{placement:y,padding:v}=g,S=v*(y==="outside"?1:-1),M={datumIndex:e,x:t.x+(i?-S:t.width/2),y:t.y+(i?t.height/2:t.height+S),textAlign:i?"left":"center",textBaseline:i?"middle":"bottom",text:this.getLabelText(g,b({itemId:"low",value:s},f)),itemId:"low",datum:a,series:r},D={datumIndex:e,x:t.x+(i?t.width+S:t.width/2),y:t.y+(i?t.height/2:-S),textAlign:i?"right":"center",textBaseline:i?"middle":"top",text:this.getLabelText(g,b({itemId:"high",value:n},f)),itemId:"high",datum:a,series:r};return y==="outside"&&(M.textAlign=i?"right":"center",M.textBaseline=i?"middle":"top",D.textAlign=i?"left":"center",D.textBaseline=i?"middle":"bottom"),[M,D]}nodeFactory(){return new gve}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t!=null?t:[];return i.update(s,void 0,n=>this.getDatumId(n))}getItemBaseStyle(e){var o,l,c,h,d,u,p,g;const{properties:t}=this,{cornerRadius:i,fillGradientDefaults:s,fillPatternDefaults:n,fillImageDefaults:a}=t,r=e?t.highlightStyle.item:void 0;return _I({fill:(o=r==null?void 0:r.fill)!=null?o:t.fill,fillOpacity:(l=r==null?void 0:r.fillOpacity)!=null?l:t.fillOpacity,stroke:(c=r==null?void 0:r.stroke)!=null?c:t.stroke,strokeWidth:(h=r==null?void 0:r.strokeWidth)!=null?h:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(d=r==null?void 0:r.strokeOpacity)!=null?d:t.strokeOpacity,lineDash:(p=(u=r==null?void 0:r.lineDash)!=null?u:t.lineDash)!=null?p:[],lineDashOffset:(g=r==null?void 0:r.lineDashOffset)!=null?g:t.lineDashOffset,cornerRadius:i},s,n,a)}getItemStyleOverrides(e,t,i,s){const{id:n,properties:a}=this,{xKey:r,yHighKey:o,yLowKey:l,itemStyler:c,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:u}=a;if(c==null)return;const p=this.cachedDatumCallback(uve(e,s?"highlight":"node"),()=>this.callWithContext(c,b({seriesId:n,datum:t,xKey:r,yHighKey:o,yLowKey:l,highlighted:s},i)));return _I(p,h,d,u)}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getCategoryDirection()===Hx.X,n=this.getItemBaseStyle(i),a=this.getShapeFillBBox();t.each((r,o)=>{var c;const l=this.getItemStyleOverrides(String(o.datumIndex),o.datum,n,i);mve(r,n,l,a),r.cornerRadius=(c=l==null?void 0:l.cornerRadius)!=null?c:n.cornerRadius,r.visible=s?o.width>0:o.height>0,r.crisp=o.crisp})}getHighlightLabelData(e,t){const i=e.filter(s=>s.datum===t.datum);return i.length>0?i:void 0}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=fve.None})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{sve(t,this.properties.label,i)})}getTooltipContent(e){var D;const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:a,xName:r,yName:o,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,tooltip:u}=n,p=this.getCategoryAxis(),g=this.getValueAxis();if(!i||!s||!p||!g)return;const f=(D=s.dataSources.get(this.id))==null?void 0:D[e],y=i.resolveKeysById(this,"xValue",s)[e],v=i.resolveColumnById(this,"yHighValue",s)[e],x=i.resolveColumnById(this,"yLowValue",s)[e];if(y==null)return;const S=this.getItemBaseStyle(!1);Object.assign(S,this.getItemStyleOverrides(String(e),f,S,!1));const M=`${g.formatDatum(x)} - ${g.formatDatum(v)}`;return this.formatTooltipWithContext(u,{heading:p.formatDatum(y),symbol:this.legendItemSymbol(),data:[{label:o,fallbackLabel:`${h!=null?h:l} - ${d!=null?d:c}`,value:M}]},b({seriesId:t,datum:f,title:o,xKey:a,xName:r,yName:o,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d},S))}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,fillGradientDefaults:o,fillPatternDefaults:l,fillImageDefaults:c}=this.properties;return{marker:_I({fill:e,stroke:t,fillOpacity:s,strokeOpacity:n,strokeWidth:i,lineDash:a,lineDashOffset:r},o,l,c)}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yName:s,yLowName:n,yHighName:a,yLowKey:r,yHighKey:o,showInLegend:l}=this.properties,c=s!=null?s:`${n!=null?n:r} - ${a!=null?a:o}`,h=`${r}-${o}`;return[{legendType:"category",id:t,itemId:h,seriesId:t,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){const i=kz(Lz(this.isVertical(),"normal"));Nz.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],i),Pz(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:s,previousContextData:n}=e,a=R.calculateDataDiff(this.id,t,this.getDatumId.bind(this),s,n,this.processedData);this.ctx.animationManager.stopByAnimationGroupId(this.id);const r=n==null?"fade":"normal",o=kz(Lz(this.isVertical(),r));Nz.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],o,(l,c)=>this.getDatumId(c),a),(a!=null&&a.changed||!vve(s.groupScale,n==null?void 0:n.groupScale))&&Pz(this,"labels",this.ctx.animationManager,i)}getDatumId(e){return`${e.xValue}-${e.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:e}){var t;return dve(this,(t=this.contextNodeData)==null?void 0:t.nodeData[e])}};Wx.className="RangeBarSeries",Wx.type="range-bar";var{commonSeriesOptionsDefs:xve,rangeBarSeriesThemeableOptionsDef:Cve}=R,Ux=E(b(b({},Cve),xve),{type:ee(Oe("range-bar")),xKey:ee(z),yLowKey:ee(z),yHighKey:ee(z),xName:z,yName:z,yLowName:z,yHighName:z});Ux.pickOutsideVisibleMinorAxis=Ce(q),Ux.fastDataProcessing=Ce(q),Ux.focusPriority=Ce(ne);var Sve={series:{direction:"vertical",fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},placement:"inside"}},axes:{[R.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},Mve={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",moduleFactory:e=>new Wx(e),tooltipDefaults:{range:"exact"},defaultAxes:R.DIRECTION_SWAP_AXES,themeTemplate:Sve,groupable:!0},Oz={type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,options:Ux,create:e=>new Wx(e)},{AbstractBarSeriesProperties:Dve,BaseProperties:um,FillGradientDefaults:wve,FillPatternDefaults:Ave,FillImageDefaults:Ive,PropertiesArray:Tve,SeriesTooltip:kve,Property:qe,DropShadow:Lve,Label:Pve}=R,Kx=class extends um{};C([qe],Kx.prototype,"totalType",2),C([qe],Kx.prototype,"index",2),C([qe],Kx.prototype,"axisLabel",2);var Fz=class extends um{};C([qe],Fz.prototype,"renderer",2);var GI=class extends Pve{constructor(){super(...arguments),this.placement="outside-end",this.padding=6}};C([qe],GI.prototype,"placement",2),C([qe],GI.prototype,"padding",2);var cs=class extends um{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new wve,this.fillPatternDefaults=new Ave,this.fillImageDefaults=new Ive,this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new Lve().set({enabled:!1}),this.label=new GI,this.tooltip=new Fz}};C([qe],cs.prototype,"name",2),C([qe],cs.prototype,"fill",2),C([qe],cs.prototype,"fillGradientDefaults",2),C([qe],cs.prototype,"fillPatternDefaults",2),C([qe],cs.prototype,"fillImageDefaults",2),C([qe],cs.prototype,"stroke",2),C([qe],cs.prototype,"fillOpacity",2),C([qe],cs.prototype,"strokeOpacity",2),C([qe],cs.prototype,"lineDash",2),C([qe],cs.prototype,"lineDashOffset",2),C([qe],cs.prototype,"strokeWidth",2),C([qe],cs.prototype,"cornerRadius",2),C([qe],cs.prototype,"itemStyler",2),C([qe],cs.prototype,"shadow",2),C([qe],cs.prototype,"label",2),C([qe],cs.prototype,"tooltip",2);var xd=class extends um{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};C([qe],xd.prototype,"enabled",2),C([qe],xd.prototype,"stroke",2),C([qe],xd.prototype,"strokeOpacity",2),C([qe],xd.prototype,"lineDash",2),C([qe],xd.prototype,"lineDashOffset",2),C([qe],xd.prototype,"strokeWidth",2);var $x=class extends um{constructor(){super(...arguments),this.positive=new cs,this.negative=new cs,this.total=new cs}};C([qe],$x.prototype,"positive",2),C([qe],$x.prototype,"negative",2),C([qe],$x.prototype,"total",2);var ll=class extends Dve{constructor(){super(...arguments),this.item=new $x,this.totals=new Tve(Kx),this.line=new xd,this.tooltip=new kve}};C([qe],ll.prototype,"xKey",2),C([qe],ll.prototype,"yKey",2),C([qe],ll.prototype,"xName",2),C([qe],ll.prototype,"yName",2),C([qe],ll.prototype,"item",2),C([qe],ll.prototype,"totals",2),C([qe],ll.prototype,"line",2),C([qe],ll.prototype,"tooltip",2);var{adjustLabelPlacement:Eve,SeriesNodePickMode:Bz,fixNumericExtent:Rve,valueProperty:_z,keyProperty:Nve,accumulativeValueProperty:Yx,trailingAccumulatedValueProperty:Ove,ChartAxisDirection:zI,createDatumId:Fve,checkCrisp:Bve,updateLabelNode:_ve,prepareBarAnimationFunctions:Gve,collapsedStartingBarPosition:zve,resetBarSelectionsFn:Vve,seriesLabelFadeInAnimation:jve,resetLabelFn:Hve,animationValidation:Wve,DEFAULT_CARTESIAN_DIRECTION_KEYS:Uve,DEFAULT_CARTESIAN_DIRECTION_NAMES:Kve,computeBarFocusBounds:$ve,isContinuous:Gz,Rect:Yve,motion:Xve,applyShapeStyle:Zve,getShapeStyle:VI}=R,Xx=class extends R.AbstractBarSeries{constructor(e){super({moduleCtx:e,directionKeys:Uve,directionNames:Kve,categoryKey:void 0,pickModes:[Bz.NEAREST_NODE,Bz.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:Vve,label:Hve}}),this.properties=new ll,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(e){var x,S,M,D;const{xKey:t,yKey:i,totals:s}=this.properties,{data:n=[]}=this;if(!this.visible)return;const a=A=>Gz(A)&&Number(A)>=0,r=A=>Gz(A)&&Number(A)>=0,o=A=>A==="total"||A==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=s.reduce((A,w)=>{const T=A.get(w.index);return T?T.push(w):A.set(w.index,[w]),A},new Map);n.forEach((A,w)=>{var T;c.push(A),(T=h.get(w))==null||T.forEach(k=>c.push(E(b({},k.toJson()),{[t]:k.axisLabel})))});const d=[];this.ctx.animationManager.isSkipped()||d.push(Wve());const u=(x=this.getCategoryAxis())==null?void 0:x.scale,p=(S=this.getValueAxis())==null?void 0:S.scale,{isContinuousX:g,xScaleType:f,yScaleType:y}=this.getScaleInformation({xScale:u,yScale:p}),{processedData:v}=await this.requestDataModel(e,c,{props:[Nve(t,f,{id:"xValue"}),Yx(i,y,E(b({},l),{id:"yCurrent"})),Yx(i,y,E(b({},l),{missingValue:0,id:"yCurrentTotal"})),Yx(i,y,E(b({},l),{id:"yCurrentPositive",validation:a})),Yx(i,y,E(b({},l),{id:"yCurrentNegative",validation:r})),Ove(i,y,E(b({},l),{id:"yPrevious"})),_z(i,y,{id:"yRaw"}),_z("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:o}),...g?[R.SMALLEST_KEY_INTERVAL,R.LARGEST_KEY_INTERVAL]:[],...d]});this.smallestDataInterval=(M=v.reduced)==null?void 0:M.smallestKeyInterval,this.largestDataInterval=(D=v.reduced)==null?void 0:D.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return[];const{keys:[s],values:n}=t.domain;if(e===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if((a==null?void 0:a.def.type)==="key"&&(a==null?void 0:a.def.valueType)==="category")return s;const r=e===zI.Y,o=this.getCategoryAxis().isReversed();return this.padBandExtent(s,o!==r)}else{const a=i.resolveProcessedDataIndexById(this,"yCurrent"),r=n[a],o=[Math.min(0,r[0]),Math.max(0,r[1])];return Rve(o)}}getSeriesRange(e,t){return[NaN,NaN]}createNodeData(){var B,_;const{data:e,dataModel:t,processedData:i}=this,s=this.getCategoryAxis(),n=this.getValueAxis();if(!e||!s||!n||!t||!i)return;const{line:a}=this.properties,r=s.scale,o=n.scale,l=this.getBarDirection()===zI.X,c=(B=this.getBandwidth(s))!=null?B:10,h=s.isReversed(),d=n.isReversed();if(i.type!=="ungrouped")return;const u={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};if(!this.visible)return u;const p=[],g=t.resolveKeysById(this,"xValue",i),f=t.resolveColumnById(this,"yRaw",i),y=t.resolveColumnById(this,"totalTypeValue",i),v=t.resolveColumnById(this,"yCurrent",i),x=t.resolveColumnById(this,"yPrevious",i),S=t.resolveColumnById(this,"yCurrentTotal",i),M=Bve(s==null?void 0:s.scale,s==null?void 0:s.visibleRange,this.smallestDataInterval,this.largestDataInterval);function D(G,V,j){return G||V?{cumulativeValue:S[j],trailingValue:V?w:0}:{cumulativeValue:v[j],trailingValue:x[j]}}function A(G,V,j,H,U){return G?H:V?(H!=null?H:0)-(U!=null?U:0):j}let w=0;const{xKey:T,yKey:k,xName:N,yName:O}=this.properties;((_=i.dataSources.get(this.id))!=null?_:[]).forEach((G,V)=>{const j=y[V],H=this.isSubtotal(j),U=this.isTotal(j),$=U||H,W=g[V];if(W==null)return;const Y=Math.round(r.convert(W)),K=f[V],{cumulativeValue:Q,trailingValue:Z}=D(U,H,V);$&&(w=Q!=null?Q:0);const J=Math.round(o.convert(Q)),ae=Math.round(o.convert(Z)),oe=A(U,H,K,Q,Z),le=(oe!=null?oe:0)>=0,de=this.getSeriesItemType(le,j),{strokeWidth:ue,label:ie}=this.getItemConfig(de),re=le?J:ae,te=le?ae:J,fe=Math.max(ue,Math.abs(te-re)),me={x:l?Math.min(re,te):Y,y:l?Y:Math.min(re,te),width:l?fe:c,height:l?c:fe},Le={x:me.x+me.width/2,y:me.y+me.height/2},Ee=$?J:ae,He=Math.floor(a.strokeWidth)%2/2,Ue=h?J:Ee,je=h?Ee:J;let Te,Fe;l?(Te={x:Ue+He,y:me.y},Fe={x:je+He,y:me.y+me.height}):(Te={x:me.x,y:Ue+He},Fe={x:me.x+me.width,y:je+He});const lt={x:h?Fe.x:Te.x,y:h?Fe.y:Te.y,x2:h?Te.x:Fe.x,y2:h?Te.y:Fe.y,size:0};p.push(lt);const wt=de==="subtotal"?"total":de,Ai=this.getLabelText(ie,{itemId:wt,value:oe,datum:G,xKey:T,yKey:k,xName:N,yName:O}),vi={index:V,series:this,itemId:de,datum:G,datumIndex:V,cumulativeValue:Q!=null?Q:0,xValue:W,yValue:oe,yKey:k,xKey:T,x:me.x,y:me.y,width:me.width,height:me.height,midPoint:Le,crisp:M,label:b({text:Ai},Eve({isUpward:(oe!=null?oe:-1)>=0!==d,isVertical:!l,placement:ie.placement,padding:ie.padding,rect:me}))};u.nodeData.push(vi),u.labelData.push(vi)});const F=this.properties.line.enabled;return v!=null&&F&&(u.pointData=p),u}updateSeriesItemTypes(){var c,h;const{dataModel:e,seriesItemTypes:t,processedData:i}=this;if(!e||!i)return;t.clear();const s=e.resolveProcessedDataIndexById(this,"yCurrentPositive"),n=e.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=e.resolveProcessedDataIndexById(this,"totalTypeValue"),r=(c=i.domain.values[s])!=null?c:[],o=(h=i.domain.values[n])!=null?h:[];r.length>0&&t.add("positive"),o.length>0&&t.add("negative");const l=i==null?void 0:i.domain.values[a];l&&l.forEach(d=>{(d==="total"||d==="subtotal")&&t.add("total")})}isSubtotal(e){return e==="subtotal"}isTotal(e){return e==="total"}nodeFactory(){return new Yve}getSeriesItemType(e,t){return t!=null?t:e?"positive":"negative"}getItemConfig(e){switch(e){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t!=null?t:[];return i.update(s)}getItemStyle(e,t,i,s){var f,y,v,x,S,M,D,A;const{id:n,properties:a}=this,r=a.item[i==="subtotal"?"total":i],o=s?a.highlightStyle.item:void 0,{itemStyler:l,fillGradientDefaults:c,fillPatternDefaults:h,fillImageDefaults:d}=r,{xKey:u,yKey:p}=a,g=VI({fill:(f=o==null?void 0:o.fill)!=null?f:r.fill,fillOpacity:(y=o==null?void 0:o.fillOpacity)!=null?y:r.fillOpacity,stroke:(v=o==null?void 0:o.stroke)!=null?v:r.stroke,strokeWidth:(x=o==null?void 0:o.strokeWidth)!=null?x:r.strokeWidth,strokeOpacity:(S=o==null?void 0:o.strokeOpacity)!=null?S:r.strokeOpacity,lineDash:(D=(M=o==null?void 0:o.lineDash)!=null?M:r.lineDash)!=null?D:[],lineDashOffset:(A=o==null?void 0:o.lineDashOffset)!=null?A:r.lineDashOffset,cornerRadius:r.cornerRadius},c,h,d);if(l!=null){let w=this.cachedDatumCallback(Fve(e,s?"highlight":"node"),()=>this.callWithContext(l,b({seriesId:n,itemId:i,datum:t,xKey:u,yKey:p,highlighted:s},g)));w=VI(w,c,h,d),Object.assign(g,w)}return g}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getCategoryDirection()===zI.X,n=this.getShapeFillBBox();t.each((a,r)=>{const o=r.itemId,l=this.getItemStyle(String(r.datumIndex),r.datum,o,i);Zve(a,l,void 0,n),a.visible=s?r.width>0:r.height>0,a.crisp=r.crisp})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;if(t.length===0)return i.update([]);const s=t.filter(n=>{const{label:a}=this.getItemConfig(n.itemId);return a.enabled});return i.update(s)}updateLabelNodes(e){e.labelSelection.each((t,i)=>{_ve(t,this.getItemConfig(i.itemId).label,i.label)})}getTooltipContent(e){var A;const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:a,xName:r,yKey:o,yName:l,tooltip:c}=n,h=this.getCategoryAxis(),d=this.getValueAxis();if(!i||!s||!h||!d)return;const u=(A=s.dataSources.get(this.id))==null?void 0:A[e],p=i.resolveKeysById(this,"xValue",s)[e],g=i.resolveColumnById(this,"yRaw",s)[e],f=i.resolveColumnById(this,"yCurrentTotal",s),y=i.resolveColumnById(this,"totalTypeValue",s);if(p==null)return;const v=y[e],x=(g!=null?g:0)>=0,S=this.getSeriesItemType(x,v);let M;if(this.isTotal(v))M=f[e];else if(this.isSubtotal(v)){M=f[e];for(let w=e-1;w>=0;w-=1)if(this.isSubtotal(y[w])){M=M-f[w];break}}else M=g;const D=this.getItemStyle(String(e),u,S,!1);return this.formatTooltipWithContext(c,{heading:h.formatDatum(p),symbol:this.legendItemSymbol(S),data:[{label:l,fallbackLabel:o,value:d.formatDatum(M)}]},b({seriesId:t,datum:u,title:l,itemId:S,xKey:a,xName:r,yKey:o,yName:l},D))}legendItemSymbol(e){const{fill:t,stroke:i,fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:r,lineDashOffset:o,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=this.getItemConfig(e);return{marker:VI({fill:t,stroke:i,fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:r,lineDashOffset:o},l,c,h)}}getLegendData(e){if(e!=="category")return[];const{id:t,seriesItemTypes:i}=this,s=[],n=r=>r.charAt(0).toUpperCase()+r.substring(1),{showInLegend:a}=this.properties;return i.forEach(r=>{const{name:o}=this.getItemConfig(r);s.push({legendType:"category",id:t,itemId:r,seriesId:t,enabled:!0,label:{text:o!=null?o:n(r)},symbol:this.legendItemSymbol(r),hideInLegend:!a,isFixed:!0})}),s}toggleSeriesItem(){}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:s}=e,n=Gve(zve(this.isVertical(),this.axes,"normal"));Xve.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],n),jve(this,"labels",this.ctx.animationManager,i);const{pointData:a}=s;a&&(this.isVertical()?this.animateConnectorLinesVertical(e):this.animateConnectorLinesHorizontal(e))}animateConnectorLinesHorizontal(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:s}=i;this.updateLineNode(i);const n=this.getValueAxis(),a=n==null?void 0:n.isReversed(),r=a?(h,d)=>h<d:(h,d)=>h>d,o=n==null?void 0:n.scale.convert(0),l=t.reduce((h,d)=>(r(d.x,h)&&(h=d.x),h),a?1/0:0),c=(h,d,u,p,g)=>(h-d)/(u-d)*(g-p)+p;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:o,to:l,ease:R.Motion.easeOut,collapsable:!1,onUpdate(h){s.clear(!0),t.forEach((d,u)=>{const p=c(h,o,l,o,d.x),g=c(h,o,l,o,d.x2);u!==0&&s.lineTo(p,d.y),s.moveTo(g,d.y2)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateConnectorLinesVertical(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:s}=i;this.updateLineNode(i);const n=this.getValueAxis(),a=n==null?void 0:n.isReversed(),r=a?(h,d)=>h>d:(h,d)=>h<d,o=n==null?void 0:n.scale.convert(0),l=t.reduce((h,d)=>(r(d.y,h)&&(h=d.y),h),a?0:1/0),c=(h,d,u,p,g)=>(h-d)/(u-d)*(g-p)+p;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:o,to:l,ease:R.Motion.easeOut,collapsable:!1,onUpdate(h){s.clear(!0),t.forEach((d,u)=>{const p=c(h,o,l,o,d.y),g=c(h,o,l,o,d.y2);u!==0&&s.lineTo(d.x,p),s.moveTo(d.x2,g)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateReadyResize(e){super.animateReadyResize(e),this.resetConnectorLinesPath(e)}updatePaths(e){this.resetConnectorLinesPath({contextData:e.contextData,paths:e.paths})}resetConnectorLinesPath({contextData:e,paths:t}){if(t.length===0)return;const[i]=t;this.updateLineNode(i);const{path:s}=i;s.clear(!0);const{pointData:n}=e;n&&(n.forEach((a,r)=>{r!==0&&s.lineTo(a.x,a.y),s.moveTo(a.x2,a.y2)}),i.checkPathDirty())}updateLineNode(e){const{stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,lineDashOffset:a}=this.properties.line;e.setProperties({fill:void 0,stroke:t,strokeWidth:this.getStrokeWidth(i),strokeOpacity:s,lineDash:n,lineDashOffset:a,lineJoin:"round",pointerEvents:R.PointerEvents.None})}isLabelEnabled(){const{positive:e,negative:t,total:i}=this.properties.item;return e.label.enabled||t.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:e}){var t;return $ve(this,(t=this.contextNodeData)==null?void 0:t.nodeData[e])}};Xx.className="WaterfallSeries",Xx.type="waterfall";var{commonSeriesOptionsDefs:qve,waterfallSeriesThemeableOptionsDef:Qve}=R,Jve=E(b(b({},Qve),qve),{type:ee(Oe("waterfall")),xKey:ee(z),yKey:ee(z),xName:z,yName:z,totals:Li({totalType:ee(ce("total","subtotal")),index:ee(X),axisLabel:ee(z)},"a total definition options array")});function jI(e,t){return{fill:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$path:[`./${t}`,{$palette:"fill"},{$palette:"fills"}]},{$palette:`${e}.fill`}]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$if:[{$or:[{$isGradient:[{$palette:`${e}.fill`}]},{$isPattern:[{$palette:`${e}.fill`}]},{$isImage:[{$palette:`${e}.fill`}]}]},{$map:[{$path:["./color",void 0,{$value:"$1"}]},{$path:["./colorStops",void 0,{$palette:`${e}.fill`}]}]},[{$mix:[{$palette:`${e}.fill`},"black",.15]},{$mix:[{$palette:`${e}.fill`},"white",.15]}]]},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,stroke:{$palette:`${e}.stroke`},strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},formatter:void 0,placement:"outside-end"}}}var ebe={series:{item:{positive:jI("altUp",0),negative:jI("altDown",1),total:jI("neutral",2)},line:{stroke:{$palette:"neutral.stroke"},strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,toggleSeries:!1}},tbe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,moduleFactory:e=>new Xx(e),tooltipDefaults:{range:"exact"},defaultAxes:R.DIRECTION_SWAP_AXES,themeTemplate:ebe},zz={type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,options:Jve,create:e=>new Xx(e)},{NewAreaSeriesModule:ibe,NewBarSeriesModule:sbe,NewBubbleSeriesModule:nbe,NewHistogramSeriesModule:abe,NewLineSeriesModule:rbe,NewScatterSeriesModule:obe,numberFormatValidator:lbe,without:la}=R,Vz={width:X,height:X,grip:q,fill:ye,stroke:ye,strokeWidth:X,cornerRadius:X},ca=["cursor","highlightStyle","listeners","nodeClickRange","showInLegend","showInMiniChart","tooltip","visible","xName","yName"],cbe={enabled:q,height:X,spacing:X,cornerRadius:ne,mask:{fill:ye,fillOpacity:Me,stroke:ye,strokeWidth:X},minHandle:Vz,maxHandle:Vz,miniChart:{enabled:q,padding:{top:X,bottom:X},label:b({enabled:q,avoidCollisions:q,spacing:X,format:lbe,formatter:ft,interval:{minSpacing:X,maxSpacing:X,values:hn,step:ne}},It),series:Li(th({area:la(ibe.options,ca),bar:la(sbe.options,[...ca,"errorBar","label","legendItemName","direction"]),"box-plot":la(FG.options,[...ca,"direction","legendItemName","minName","q1Name","medianName","q3Name","maxName"]),bubble:la(nbe.options,[...ca,"title","label","labelKey","labelName","sizeName"]),candlestick:la(qG.options,ca),heatmap:la(rz.options,[...ca,"title","label","colorName","textAlign","verticalAlign","itemPadding","colorRange"]),histogram:la(abe.options,[...ca,"label"]),line:la(rbe.options,[...ca,"errorBar","title","label"]),ohlc:la(lz.options,ca),"range-area":la(Az.options,[...ca,"label","yLowName","yHighName"]),"range-bar":la(Oz.options,[...ca,"direction","label","yLowName","yHighName"]),scatter:la(obe.options,[...ca,"errorBar","title","label","labelKey","labelName"]),waterfall:la(zz.options,[...ca,"direction"])},"miniChart series options"))}},{annotationOptionsDef:hbe}=R,dbe={type:"plugin",name:"annotations",chartType:"cartesian",options:hbe,create(){return null}},ube={type:"plugin",name:"navigator",chartType:"cartesian",options:cbe,create(){return null}},pbe={type:"plugin",name:"initialState",options:Dfe,create(){return null}};function jz(e,t,i){i||(t=gbe(t));const s=new Map;for(const a of e)s.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let n=0;return s.forEach((a,r)=>{n=Math.max(n,HI(s,t,a,r,-1,[])+HI(s,t,a,r,1,[])+1)}),{links:t,nodeGraph:s,maxPathLength:n}}function Hz(e,t,i,s){const n=s.indexOf(t);if(n!==-1){for(let r=n;r<s.length;r+=1)i.add(s[r]);return}s.push(t);const{toNode:a}=t;for(const r of e)r.fromNode===a&&Hz(e,r,i,s);s.pop()}function gbe(e){const t=new Set;for(const i of e)Hz(e,i,t,[]);return t.size!==0&&se.warnOnce("Some links formed circular references. These will be removed from the output."),t.size===0?e:e.filter(i=>!t.has(i))}function HI(e,t,i,s,n,a){if(a.includes(s))return 1/0;let r=n===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(r===-1){r=0;const o=n===-1?i.linksBefore:i.linksAfter;for(const l of t){const{fromNode:c,toNode:h}=l,d=n===-1?h.id:c.id,u=n===-1?c.id:h.id,p=s===d?e.get(u):void 0;p!=null&&(o.push({node:p,link:l}),a==null||a.push(s),r=Math.max(r,HI(e,t,p,u,n,a)+1),a==null||a.pop())}n===-1?i.maxPathLengthBefore=r:i.maxPathLengthAfter=r}return r}var{Series:fbe,DataController:mbe,keyProperty:ybe,valueProperty:Zx,Selection:Cd,Group:Sp,TransformableText:vbe}=R,bbe=class extends R.SeriesNodeEvent{constructor(e,t,i,s){var r;super(e,t,i,s);const{datumIndex:n}=i,a=(r=s.contextNodeData)==null?void 0:r.nodeData.find(o=>o.datumIndex.type===n.type&&o.datumIndex.index===n.index);this.size=a==null?void 0:a.size,this.label=(a==null?void 0:a.type)===1?a==null?void 0:a.label:void 0}},Wz=class extends fbe{constructor(){super(...arguments),this.NodeEvent=bbe,this._chartNodes=void 0,this.nodeCount=0,this.linkCount=0,this.linksDataModel=void 0,this.linksProcessedData=void 0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new Sp({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new Sp({name:"nodeGroup"})),this.focusLinkGroup=this.highlightNode.appendChild(new Sp({name:"linkGroup"})),this.focusNodeGroup=this.highlightNode.appendChild(new Sp({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightNode.appendChild(new Sp({name:"linkGroup"})),this.highlightNodeGroup=this.highlightNode.appendChild(new Sp({name:"nodeGroup"})),this.labelSelection=Cd.select(this.labelGroup,vbe),this.linkSelection=Cd.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=Cd.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=Cd.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=Cd.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=Cd.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=Cd.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){var e;return(e=this.properties.nodes)!=null?e:this._chartNodes}setChartNodes(e){this._chartNodes=e,this.nodes===e&&(this.nodeDataRefresh=!0)}async processData(e){var g,f;const{data:t,nodes:i}=this;if(t==null)return;const{fromKey:s,toKey:n,sizeKey:a,idKey:r,labelKey:o}=this.properties,l=new mbe("standalone",e.suppressFieldDotNotation),c=i!=null?l.request(this.id,i,{props:[ybe(r,void 0,{id:"idValue",includeProperty:!1}),...o!=null?[Zx(o,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,h=e.request(this.id,t,{props:[Zx(s,void 0,{id:"fromValue",includeProperty:!1}),Zx(n,void 0,{id:"toValue",includeProperty:!1}),...a!=null?[Zx(a,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});i!=null&&l.execute();const[d,u]=await Promise.all([c,h]);this.nodesDataModel=d==null?void 0:d.dataModel,this.nodesProcessedData=d==null?void 0:d.processedData,this.linksDataModel=u==null?void 0:u.dataModel,this.linksProcessedData=u==null?void 0:u.processedData;const p=new Map;if(d==null){const y=u.dataModel.resolveColumnById(this,"fromValue",u.processedData),v=u.dataModel.resolveColumnById(this,"toValue",u.processedData),x=S=>{const M=p.size;return{series:this,itemId:void 0,datum:{},datumIndex:{type:1,index:M},type:1,index:M,linksBefore:[],linksAfter:[],id:S,size:0,label:S}};(g=u.processedData.dataSources.get(this.id))==null||g.forEach((S,M)=>{const D=y[M],A=v[M];D==null||A==null||(p.has(D)||p.set(D,x(D)),p.has(A)||p.set(A,x(A)))})}else{const y=d.dataModel.resolveColumnById(this,"idValue",d.processedData),v=o!=null?d.dataModel.resolveColumnById(this,"labelValue",d.processedData):void 0;(f=d.processedData.dataSources.get(this.id))==null||f.forEach((x,S)=>{const M=y[S],D=v==null?void 0:v[S];p.set(M,{series:this,itemId:void 0,datum:x,datumIndex:{type:1,index:S},type:1,index:S,linksBefore:[],linksAfter:[],id:M,size:0,label:D})})}this.processedNodes=p}getNodeGraph(e,t,{includeCircularReferences:i}){var g;const{linksDataModel:s,linksProcessedData:n}=this;if(s==null||n==null){const{links:f,nodeGraph:y,maxPathLength:v}=jz(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:y,links:f,maxPathLength:v}}const{sizeKey:a}=this.properties,r=s.resolveColumnById(this,"fromValue",n),o=s.resolveColumnById(this,"toValue",n),l=a!=null?s.resolveColumnById(this,"sizeValue",n):void 0,c=new Map;this.processedNodes.forEach(f=>{const y=e(f);c.set(f.id,y)});const h=[];(g=n.dataSources.get(this.id))==null||g.forEach((f,y)=>{const v=r[y],x=o[y],S=l!=null?l[y]:1,M=c.get(v),D=c.get(x);if(S<=0||M==null||D==null)return;const A=t({series:this,itemId:void 0,datum:f,datumIndex:{type:0,index:y},type:0,index:y,fromNode:M,toNode:D,size:S});h.push(A)});const{links:d,nodeGraph:u,maxPathLength:p}=jz(c.values(),h,i);return u.forEach(f=>{f.datum.linksBefore=f.linksBefore.map(y=>y.link),f.datum.linksAfter=f.linksAfter.map(y=>y.link)}),this.nodeCount=u.size,this.linkCount=d.length,{nodeGraph:u,links:d,maxPathLength:p}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(e){var h,d,u,p,g,f,y,v;const{seriesRect:t}=e,i={seriesRectWidth:(h=t==null?void 0:t.width)!=null?h:0,seriesRectHeight:(d=t==null?void 0:t.height)!=null?d:0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),this.updateSelections();const s=(p=(u=this.contextNodeData)==null?void 0:u.nodeData)!=null?p:[],n=(f=(g=this.contextNodeData)==null?void 0:g.labelData)!=null?f:[];let a=(y=this.ctx.highlightManager)==null?void 0:y.getActiveHighlight();if((a==null?void 0:a.series)===this&&a.type==null){const{itemId:x}=a;a=x!=null?s.find(S=>S.type===1&&S.id===x):void 0}else(a==null?void 0:a.series)!==this&&(a=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=a!=null&&(v=this.properties.highlightStyle.series.dimOpacity)!=null?v:1,this.labelSelection=this.updateLabelSelection({labelData:n,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:s.filter(x=>x.type===0),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:s.filter(x=>x.type===1),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let r,o,l,c;(a==null?void 0:a.type)===1?(r=s.filter(x=>x.type===0&&(x.toNode===a||x.fromNode===a)),o=r.map(x=>x.fromNode===a?x.toNode:x.fromNode),o.push(a),l=[],c=[a]):(a==null?void 0:a.type)===0?(r=[a],o=[a.fromNode,a.toNode],l=[a],c=[]):(r=[],o=[],l=[],c=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:r,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:o,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:l,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:c,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(e){}getSeriesDomain(e){return[]}getSeriesRange(e,t){return[NaN,NaN]}legendItemSymbol(e,t,i={}){const{fills:s,strokes:n}=this.properties,{fill:a=s[t%s.length],fillOpacity:r=1,stroke:o=n[t%n.length],strokeWidth:l=0,strokeOpacity:c=1,lineDash:h=[0],lineDashOffset:d=0}=i;return{marker:{fill:a,fillOpacity:r,stroke:o,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}}getLegendData(e){if(e!=="category")return[];const{showInLegend:t}=this.properties;return Array.from(this.processedNodes.values(),({id:i,label:s},n)=>({legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:!0,label:{text:s!=null?s:i},symbol:this.legendItemSymbol(1,n),hideInLegend:!t,isFixed:!0}))}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.linkSelection.each((n,a)=>{const r=n.containsPoint(e,t)?0:1/0;r<i&&(i=r,s=a)}),this.nodeSelection.each((n,a)=>{const r=n.distanceSquared(e,t);r<i&&(i=r,s=a)}),s!=null?{datum:s,distance:Math.sqrt(i)}:void 0}getDatumAriaText(e,t){var i;if(e.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:e.index+1,count:this.linkCount,from:e.fromNode.id,to:e.toNode.id,size:e.size,sizeName:(i=this.properties.sizeName)!=null?i:this.properties.sizeKey});if(e.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:e.index+1,count:this.nodeCount,description:t})}pickFocus(e){var o,l,c;const{datumIndexDelta:t,otherIndexDelta:i}=e,s=(o=this.contextNodeData)==null?void 0:o.nodeData[e.datumIndex-e.datumIndexDelta];let n=s;if(i!==0||t===0)return;if((s==null?void 0:s.type)===0){const h=Array.from(this.linkSelection,p=>p.datum),u=h.indexOf(s)+t;if(u>=0&&u<h.length)n=h[u];else if(u>0)n=h[h.length-1];else{const p=Array.from(this.nodeSelection,g=>g.datum);n=p[p.length-1]}}else if((s==null?void 0:s.type)===1){const h=Array.from(this.nodeSelection,p=>p.datum),u=h.indexOf(s)+t;u>=0&&u<h.length?n=h[u]:u<0?n=h[0]:n=Array.from(this.linkSelection,g=>g.datum)[0]}if(n==null)return;const a=n.type===1?Array.from(this.nodeSelection).find(h=>h.datum===n):Array.from(this.linkSelection).find(h=>h.datum===n);if(a==null)return;const r=this.computeFocusBounds(a.node);if(r!=null)return{datum:a.datum,datumIndex:(c=(l=this.contextNodeData)==null?void 0:l.nodeData.indexOf(a.datum))!=null?c:0,otherIndex:0,bounds:r,clipFocusBox:!0}}getCategoryValue(e){}datumIndexForCategoryValue(e){}},{Path:xbe,SceneChangeDetection:Ic}=R;function Uz({radius:e,startAngle:t,endAngle:i,tension:s}){const n=e*Math.cos(t),a=e*Math.sin(t),r=e*Math.cos(i),o=e*Math.sin(i),l=n*s,c=a*s,h=r*s,d=o*s;return{x:[n,l,h,r],y:[a,c,d,o]}}var cl=class extends xbe{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}tensionedCurveTo(e,t,i,s,n,a,r,o){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-e)*h+e,(s-t)*h+t,(n-r)*h+r,(a-o)*h+o,r,o)}updatePath(){const{path:e,centerX:t,centerY:i,radius:s}=this;let{startAngle1:n,endAngle1:a,startAngle2:r,endAngle2:o}=this;n>r&&([n,r]=[r,n],[a,o]=[o,a]),e.clear();const l=t+s*Math.cos(n),c=i+s*Math.sin(n);e.moveTo(l,c),this.tensionedCurveTo(l,c,t,i,t,i,t+s*Math.cos(o),i+s*Math.sin(o)),e.arc(t,i,s,o,r,!0),this.tensionedCurveTo(t+s*Math.cos(r),i+s*Math.sin(r),t,i,t,i,t+s*Math.cos(a),i+s*Math.sin(a)),e.arc(t,i,s,a,n,!0),e.closePath()}};C([Ic()],cl.prototype,"centerX",2),C([Ic()],cl.prototype,"centerY",2),C([Ic()],cl.prototype,"radius",2),C([Ic()],cl.prototype,"startAngle1",2),C([Ic()],cl.prototype,"endAngle1",2),C([Ic()],cl.prototype,"startAngle2",2),C([Ic()],cl.prototype,"endAngle2",2),C([Ic()],cl.prototype,"tension",2);var{FillGradientDefaults:Cbe,FillPatternDefaults:Sbe,FillImageDefaults:Mbe,BaseProperties:Kz,SeriesTooltip:Dbe,SeriesProperties:wbe,Property:Qe,Label:Abe}=R,WI=class extends Abe{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};C([Qe],WI.prototype,"spacing",2),C([Qe],WI.prototype,"maxWidth",2);var ao=class extends Kz{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}};C([Qe],ao.prototype,"fill",2),C([Qe],ao.prototype,"fillOpacity",2),C([Qe],ao.prototype,"stroke",2),C([Qe],ao.prototype,"strokeOpacity",2),C([Qe],ao.prototype,"strokeWidth",2),C([Qe],ao.prototype,"lineDash",2),C([Qe],ao.prototype,"lineDashOffset",2),C([Qe],ao.prototype,"tension",2),C([Qe],ao.prototype,"itemStyler",2);var ur=class extends Kz{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};C([Qe],ur.prototype,"spacing",2),C([Qe],ur.prototype,"width",2),C([Qe],ur.prototype,"fill",2),C([Qe],ur.prototype,"fillOpacity",2),C([Qe],ur.prototype,"stroke",2),C([Qe],ur.prototype,"strokeOpacity",2),C([Qe],ur.prototype,"strokeWidth",2),C([Qe],ur.prototype,"lineDash",2),C([Qe],ur.prototype,"lineDashOffset",2),C([Qe],ur.prototype,"itemStyler",2);var hs=class extends wbe{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fillGradientDefaults=new Cbe,this.fillPatternDefaults=new Sbe,this.fillImageDefaults=new Mbe,this.fills=[],this.strokes=[],this.label=new WI,this.link=new ao,this.node=new ur,this.tooltip=new Dbe}};C([Qe],hs.prototype,"fromKey",2),C([Qe],hs.prototype,"toKey",2),C([Qe],hs.prototype,"idKey",2),C([Qe],hs.prototype,"idName",2),C([Qe],hs.prototype,"labelKey",2),C([Qe],hs.prototype,"labelName",2),C([Qe],hs.prototype,"sizeKey",2),C([Qe],hs.prototype,"sizeName",2),C([Qe],hs.prototype,"nodes",2),C([Qe],hs.prototype,"fillGradientDefaults",2),C([Qe],hs.prototype,"fillPatternDefaults",2),C([Qe],hs.prototype,"fillImageDefaults",2),C([Qe],hs.prototype,"fills",2),C([Qe],hs.prototype,"strokes",2),C([Qe],hs.prototype,"label",2),C([Qe],hs.prototype,"link",2),C([Qe],hs.prototype,"node",2),C([Qe],hs.prototype,"tooltip",2);var{SeriesNodePickMode:$z,CachedTextMeasurerPool:Ibe,TextWrapper:Tbe,TextUtils:kbe,createDatumId:qx,angleBetween:Qx,normalizeAngle360:Lbe,isBetweenAngles:Yz,Sector:Pbe,evaluateBezier:Jx,applyShapeStyle:Xz,getShapeStyle:eC,BBox:Ebe}=R,tC=e=>e.startAngle+Qx(e.startAngle,e.endAngle)/2,iC=class extends Wz{constructor(e){super({moduleCtx:e,pickModes:[$z.NEAREST_NODE,$z.EXACT_SHAPE_MATCH]}),this.properties=new hs}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new cl}nodeFactory(){return new Pbe}createNodeData(){const{id:e,_nodeDataDependencies:{seriesRectWidth:t,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:s,toKey:n,sizeKey:a,label:{spacing:r,maxWidth:o,fontSize:l},node:{width:c,spacing:h}}=this.properties,d=t/2,u=i/2;let p=[];const{nodeGraph:g,links:f}=this.getNodeGraph(F=>E(b({},F),{centerX:d,centerY:u,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}),F=>E(b({},F),{centerX:d,centerY:u,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0});let y=0;g.forEach(({datum:F,linksBefore:B,linksAfter:_},G)=>{const V=B.reduce((j,{link:H})=>j+H.size,0)+_.reduce((j,{link:H})=>j+H.size,0);if(V===0)g.delete(G);else{F.size=V,y+=F.size;const j=this.getLabelText(this.properties.label,{datum:F.datum,value:F.label,fromKey:s,toKey:n,sizeKey:a,size:F.size});F.label=String(j)}});let v=0;if(this.isLabelEnabled()){const F=this.properties.label.getFont();let B=0;g.forEach(({datum:_})=>{const{id:G,label:V}=_;if(V==null)return;const j=Tbe.wrapText(V,{maxWidth:o,font:this.properties.label,textWrap:"never"}),{width:H}=Ibe.measureText(j,{font:F,textAlign:"left",textBaseline:"middle"});B=Math.max(H,B),p.push({id:G,text:j,centerX:d,centerY:u,angle:NaN,radius:NaN})}),v=B+r}const x=g.size;let S=Math.min(t,i)/2-c-v,M=h/S;if(v!==0&&(x*M>=1.5*Math.PI||S<=0)&&(p=[],S=Math.min(t,i)/2-c,M=h/S),x*M>=2*Math.PI||S<=0){se.warnOnce("There was insufficient space to display the Chord Series.");return}const D=S,A=S+c,w=Math.max((2*Math.PI-x*M)/y,0);let T=0;g.forEach(({datum:F})=>{F.innerRadius=D,F.outerRadius=A,F.startAngle=T,F.endAngle=T+F.size*w,T=F.endAngle+M;const B=(F.innerRadius+F.outerRadius)/2,_=tC(F);F.midPoint={x:F.centerX+B*Math.cos(_),y:F.centerY+B*Math.sin(_)}});const k=[];g.forEach(({datum:F,linksBefore:B,linksAfter:_})=>{const G=tC(F),V=[...B.map(H=>({link:H.link,distance:Qx(tC(H.node.datum),G),after:!1})),..._.map(H=>({link:H.link,distance:Qx(tC(H.node.datum),G),after:!0}))];let j=F.startAngle;V.toSorted((H,U)=>H.distance-U.distance).forEach(({link:H,after:U})=>{const $=H.size*w;U?(H.startAngle1=j,H.endAngle1=j+$):(H.startAngle2=j,H.endAngle2=j+$),j+=H.size*w}),k.push(F)});const{tension:N}=this.properties.link;f.forEach(F=>{F.radius=S;const B=Uz({radius:S,startAngle:F.startAngle1,endAngle:F.endAngle2,tension:N}),_=Uz({radius:S,startAngle:F.startAngle2,endAngle:F.endAngle1,tension:N}),G=Jx(...B.x,.5),V=Jx(...B.y,.5),j=Jx(..._.x,.5),H=Jx(..._.y,.5);F.midPoint={x:F.centerX+(G+j)/2,y:F.centerY+(V+H)/2},k.push(F)}),p.forEach(F=>{var _;const B=(_=g.get(F.id))==null?void 0:_.datum;B!=null&&(F.radius=A+r,F.angle=Lbe(B.startAngle+Qx(B.startAngle,B.endAngle)/2))}),p.sort((F,B)=>F.angle-B.angle);let O=1/0,L=-1/0;return p=p.filter(F=>{const B=kbe.getLineHeight(l),_=Math.atan2(B/2,F.radius),G=F.angle-_,V=F.angle+_;return Yz(O,G,V)||Yz(L,G,V)?!1:(O=Math.min(G,O),L=Math.max(V,L),!0)}),{itemId:e,nodeData:k,labelData:p}}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:s,fontWeight:n,fontSize:a,fontFamily:r}=this.properties.label;t.each((o,{text:l,centerX:c,centerY:h,radius:d,angle:u})=>{o.visible=!0,o.translationX=c+d*Math.cos(u),o.translationY=h+d*Math.sin(u),o.text=l,o.fill=i,o.fontStyle=s,o.fontWeight=n,o.fontSize=a,o.fontFamily=r,o.textBaseline="middle",Math.cos(u)>=0?(o.textAlign="left",o.rotation=u):(o.textAlign="right",o.rotation=u-Math.PI)})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>qx([t.type,t.id]))}getBaseNodeStyle(e){var c,h,d,u,p,g,f;const{properties:t}=this,{fill:i,fillOpacity:s,stroke:n,strokeOpacity:a,lineDash:r,lineDashOffset:o}=t.node,l=e?t.highlightStyle.item:void 0;return eC({fill:(c=l==null?void 0:l.fill)!=null?c:i,fillOpacity:(h=l==null?void 0:l.fillOpacity)!=null?h:s,stroke:(d=l==null?void 0:l.stroke)!=null?d:n,strokeOpacity:(u=l==null?void 0:l.strokeOpacity)!=null?u:a,strokeWidth:(p=l==null?void 0:l.strokeWidth)!=null?p:this.getStrokeWidth(t.node.strokeWidth),lineDash:(g=l==null?void 0:l.lineDash)!=null?g:r,lineDashOffset:(f=l==null?void 0:l.lineDashOffset)!=null?f:o},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getNodeStyleOverrides(e,t,i,s,n,a,r){var f,y;const{id:o,properties:l}=this,{fills:c,strokes:h}=l,{itemStyler:d}=l.node,u=(f=a.fill)!=null?f:c[i%c.length],p=(y=a.stroke)!=null?y:h[i%h.length];let g;if(r||(g!=null||(g={}),g.fill=u,g.stroke=p),d!=null){const v=this.cachedDatumCallback(qx(e,"node",r?"highlight":"node"),()=>{const{fillOpacity:x=1,strokeOpacity:S=1,strokeWidth:M=0,lineDash:D=[],lineDashOffset:A=0}=a;return this.callWithContext(d,{seriesId:o,datum:t,highlighted:r,label:n,size:s,fill:u,fillOpacity:x,stroke:p,strokeOpacity:S,strokeWidth:M,lineDash:D,lineDashOffset:A})});g!=null||(g={}),Object.assign(g,v)}return eC(g,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getBaseNodeStyle(i),n=this.getShapeFillBBox();t.each((a,r)=>{const{datumIndex:o,size:l,label:c}=r,h=this.getNodeStyleOverrides(String(o.index),r.datum,o.index,l,c,s,i);Xz(a,s,h,n),a.centerX=r.centerX,a.centerY=r.centerY,a.innerRadius=r.innerRadius,a.outerRadius=r.outerRadius,a.startAngle=r.startAngle,a.endAngle=r.endAngle,a.inset=a.strokeWidth/2})}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>qx([t.type,t.index,t.fromNode.id,t.toNode.id]))}getBaseLinkStyle(e){var h,d,u,p,g,f,y;const{properties:t}=this,{fill:i,fillOpacity:s,stroke:n,strokeOpacity:a,lineDash:r,lineDashOffset:o,tension:l}=t.link,c=e?t.highlightStyle.item:void 0;return eC({fill:(h=c==null?void 0:c.fill)!=null?h:i,fillOpacity:(d=c==null?void 0:c.fillOpacity)!=null?d:s,stroke:(u=c==null?void 0:c.stroke)!=null?u:n,strokeOpacity:(p=c==null?void 0:c.strokeOpacity)!=null?p:a,strokeWidth:(g=c==null?void 0:c.strokeWidth)!=null?g:this.getStrokeWidth(t.link.strokeWidth),lineDash:(f=c==null?void 0:c.lineDash)!=null?f:r,lineDashOffset:(y=c==null?void 0:c.lineDashOffset)!=null?y:o,tension:l},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getLinkStyleOverrides(e,t,i,s,n){var p,g;const{id:a,properties:r}=this,{fills:o,strokes:l}=r,{itemStyler:c}=r.link,h=(p=s.fill)!=null?p:o[i%o.length],d=(g=s.stroke)!=null?g:l[i%l.length];let u;if(n||(u!=null||(u={}),u.fill=h,u.stroke=d),c!=null){const f=this.cachedDatumCallback(qx(e,"link",n?"highlight":"node"),()=>{const{fillOpacity:y=1,strokeOpacity:v=1,strokeWidth:x=0,lineDash:S=[],lineDashOffset:M=0,tension:D}=s;return this.callWithContext(c,{seriesId:a,datum:t,highlighted:n,tension:D,fill:h,fillOpacity:y,stroke:d,strokeOpacity:v,strokeWidth:x,lineDash:S,lineDashOffset:M})});u!=null||(u={}),Object.assign(u,f)}return eC(u,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getBaseLinkStyle(i),n=this.getShapeFillBBox();t.each((a,r)=>{var h;const{datumIndex:o}=r,l=r.fromNode.datumIndex,c=this.getLinkStyleOverrides(String(o.index),r.datum,l.index,s,i);a.centerX=r.centerX,a.centerY=r.centerY,a.radius=r.radius,a.startAngle1=r.startAngle1,a.endAngle1=r.endAngle1,a.startAngle2=r.startAngle2,a.endAngle2=r.endAngle2,Xz(a,s,c,n),a.tension=(h=c==null?void 0:c.tension)!=null?h:s.tension})}getShapeFillBBox(){var r,o,l,c;const e=(o=(r=this._nodeDataDependencies)==null?void 0:r.seriesRectWidth)!=null?o:0,t=(c=(l=this._nodeDataDependencies)==null?void 0:l.seriesRectHeight)!=null?c:0,i=Math.min(e,t),s=(e-i)/2,n=(t-i)/2,a=new Ebe(s,n,e,t);return{series:a,axis:a}}getTooltipContent(e){var y,v,x;const{id:t,linksProcessedData:i,nodesProcessedData:s,properties:n}=this,{fromKey:a,toKey:r,sizeKey:o,sizeName:l,tooltip:c}=n,h=(y=this.contextNodeData)==null?void 0:y.nodeData.find(S=>S.datumIndex.type===e.type&&S.datumIndex.index===e.index);if(h==null)return;const d=h.type===0?h.fromNode.index:h.index,u=h.type===0?`${h.fromNode.label} - ${h.toNode.label}`:h.label,p=e.type===0?(v=i==null?void 0:i.dataSources.get(this.id))==null?void 0:v[e.index]:(x=s==null?void 0:s.dataSources.get(this.id))==null?void 0:x[e.index],g=h.size;let f;if(h.type===0){const S=h.fromNode.datumIndex,M=this.getBaseLinkStyle(!1);Object.assign(M,this.getLinkStyleOverrides(String(e.index),p,S.index,M,!1)),f=M}else{const S=h.label,M=this.getBaseNodeStyle(!1);Object.assign(M,this.getNodeStyleOverrides(String(e.index),p,e.index,g,S,M,!1)),f=M}return this.formatTooltipWithContext(c,{title:u,symbol:this.legendItemSymbol(h.type,d,f),data:o!=null?[{label:l,fallbackLabel:o,value:String(g)}]:[]},b({seriesId:t,datum:p,title:u,fromKey:a,toKey:r,sizeKey:o,sizeName:l,size:g},f))}computeFocusBounds(e){return e}};iC.className="ChordSeries",iC.type="chord";var{commonSeriesOptionsDefs:Rbe,chordSeriesThemeableOptionsDef:Nbe}=R,sC=E(b(b({},Nbe),Rbe),{type:ee(Oe("chord")),fromKey:ee(z),toKey:ee(z),sizeKey:z,sizeName:z});sC.fillGradientDefaults=Ce(gy),sC.fillPatternDefaults=Ce(fy),sC.fillImageDefaults=Ce(my);var Obe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"chord",tooltipDefaults:{range:"exact"},moduleFactory:e=>new iC(e),themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0,tension:.4}},legend:{enabled:!1,toggleSeries:!1}}},Fbe={type:"series",name:"chord",chartType:"flow-proportion",enterprise:!0,options:sC,create:e=>new iC(e)},{ThemeConstants:{CARTESIAN_AXIS_TYPE:Mp,CARTESIAN_POSITION:Dp},ThemeSymbols:{DEFAULT_SHADOW_COLOUR:Bbe}}=R,Zz={$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},[{type:Mp.NUMBER,position:Dp.LEFT},{type:Mp.CATEGORY,position:{$if:[{$eq:[{$path:["/stageLabel/placement",void 0]},"before"]},Dp.TOP,Dp.BOTTOM]},label:{$omit:[["placement"],{$path:["/stageLabel",void 0]}]}}],[{type:Mp.CATEGORY,position:{$if:[{$eq:[{$path:["/stageLabel/placement",void 0]},"after"]},Dp.RIGHT,Dp.LEFT]},label:{$omit:[["placement"],{$path:["/stageLabel",void 0]}]}},{type:Mp.NUMBER,position:Dp.BOTTOM}]]},_be={series:{direction:"vertical",strokeWidth:0,spacingRatio:.25,fills:[{$palette:"fill"}],strokes:[{$palette:"stroke"}],fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:0},shadow:{enabled:!1,color:Bbe,xOffset:3,yOffset:3,blur:5}},axes:{[Mp.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(e){var t;return Math.abs(e.value).toFixed((t=e.fractionDigits)!=null?t:0)}}},[Mp.CATEGORY]:{line:{enabled:!1}}}},{lineDistanceSquared:nC,BBox:Gbe,Path:zbe,SceneChangeDetection:Tc}=R,qz=1e-6;function Qz([e,t],[i,s]){return Math.abs(e-i)<=qz&&Math.abs(t-s)<=qz}var ro=class extends zbe{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:e,y0:t,x1:i,y1:s,x2:n,y2:a,x3:r,y3:o}=this;return{x:(e+i+n+r)/4,y:(t+s+a+o)/4}}distanceSquared(e,t){if(this.containsPoint(e,t))return 0;const{x0:i,y0:s,x1:n,y1:a,x2:r,y2:o,x3:l,y3:c}=this;return Math.min(nC(e,t,i,s,n,a,1/0),nC(e,t,n,a,r,o,1/0),nC(e,t,r,o,l,c,1/0),nC(e,t,l,c,i,s,1/0))}computeBBox(){const{x0:e,y0:t,x1:i,y1:s,x2:n,y2:a,x3:r,y3:o}=this,l=Math.min(e,i,n,r),c=Math.max(e,i,n,r)-l,h=Math.min(t,s,a,o),d=Math.max(t,s,a,o)-h;return new Gbe(l,h,c,d)}updatePath(){const{path:e,x0:t,y0:i,x1:s,y1:n,x2:a,y2:r,x3:o,y3:l}=this,c=[[t,i],[s,n],[a,r],[o,l]];e.clear();let h,d;c.forEach(u=>{if(h!=null&&Qz(h,u)||d!=null&&Qz(d,u))return;const[p,g]=u;h==null?e.moveTo(p,g):e.lineTo(p,g),h!=null||(h=u),d=u}),e.closePath()}};C([Tc()],ro.prototype,"x0",2),C([Tc()],ro.prototype,"y0",2),C([Tc()],ro.prototype,"x1",2),C([Tc()],ro.prototype,"y1",2),C([Tc()],ro.prototype,"x2",2),C([Tc()],ro.prototype,"y2",2),C([Tc()],ro.prototype,"x3",2),C([Tc()],ro.prototype,"y3",2);var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:Vbe}=R;function Jz(e,t,i,s){const{x0:n,y0:a,x1:r,y1:o,x2:l,y2:c,x3:h,y3:d,opacity:u}=e;return i?{x0:(n+h)/2,y0:(a+d)/2,x1:(r+l)/2,y1:(o+c)/2,x2:(r+l)/2,y2:(o+c)/2,x3:(n+h)/2,y3:(a+d)/2,opacity:u}:{x0:(n+r)/2,y0:(a+o)/2,x1:(n+r)/2,y1:(a+o)/2,x2:(l+h)/2,y2:(c+d)/2,x3:(l+h)/2,y3:(c+d)/2,opacity:u}}function jbe(e,t){const i=a=>a==null;return{fromFn:(a,r,o)=>{o==="updated"&&i(r)?o="removed":o==="updated"&&i(a.previousDatum)&&(o="added");let l;o==="added"&&a.previousDatum==null&&t==="fade"?l=E(b({},pm(a,r)),{opacity:0}):o==="unknown"||o==="added"?l=Jz(r,a.previousDatum,e,t):l={x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};const c=Vbe[o];return E(b({},l),{phase:c})},toFn:(a,r,o)=>{let l;return o==="removed"&&a.datum==null&&t==="fade"?l=E(b({},pm(a,r)),{opacity:0}):o==="removed"||i(r)?l=Jz(r,a.previousDatum,e,t):l=pm(a,r),l}}}function pm(e,t){const{x0:i,y0:s,x1:n,y1:a,x2:r,y2:o,x3:l,y3:c,opacity:h}=t;return{x0:i,y0:s,x1:n,y1:a,x2:r,y2:o,x3:l,y3:c,opacity:h}}var{SeriesNodePickMode:eV,SeriesZIndexMap:tV,valueProperty:Hbe,keyProperty:Wbe,ChartAxisDirection:Ube,updateLabelNode:Kbe,SMALLEST_KEY_INTERVAL:$be,LARGEST_KEY_INTERVAL:Ybe,diff:Xbe,fixNumericExtent:Zbe,seriesLabelFadeInAnimation:iV,resetMotion:qbe,resetLabelFn:Qbe,animationValidation:Jbe,computeBarFocusBounds:exe,ContinuousScale:txe,Group:ixe,Selection:sxe,PointerEvents:sV,motion:nxe,checkCrisp:axe,createDatumId:rxe,applyShapeStyle:oxe,getShapeStyle:lxe,getShapeFill:cxe}=R,hxe=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.stageKey,this.yKey=s.properties.valueKey}},nV=class extends R.AbstractBarSeries{constructor({moduleCtx:e,animationResetFns:t}){super({moduleCtx:e,pickModes:[eV.AXIS_ALIGNED,eV.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["stageKey"],y:["valueKey"]},directionNames:{x:[],y:[]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:t.datum,label:Qbe}}),this.NodeEvent=hxe,this.connectorNodeGroup=this.contentGroup.appendChild(new ixe({name:`${this.id}-series-connectorNodes`,zIndex:tV.BACKGROUND})),this.connectorSelection=sxe.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=sV.None}get pickModeAxis(){return"main-category"}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.connectorNodeGroup.zIndex=[tV.BACKGROUND,e],!0):!1}isVertical(){return!super.isVertical()}connectionFactory(){return new ro}async processData(e){var g,f,y,v;const{stageKey:t,valueKey:i}=this.properties,{visible:s,id:n}=this,a=(x,S,M)=>s&&this.ctx.legendManager.getItemEnabled({seriesId:n,itemId:M}),r=(g=this.getCategoryAxis())==null?void 0:g.scale,o=(f=this.getValueAxis())==null?void 0:f.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:o}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(Xbe(this.id,this.processedData)),d.push(Jbe()));const u=this.visible?{}:{forceValue:0},{processedData:p}=await this.requestDataModel(e,this.data,{props:[Wbe(t,c,{id:"xValue"}),Hbe(i,h,E(b({id:"yValue"},u),{validation:a,invalidValue:0})),...l?[$be,Ybe]:[],...d],groupByKeys:!1});this.smallestDataInterval=(y=p.reduced)==null?void 0:y.smallestKeyInterval,this.largestDataInterval=(v=p.reduced)==null?void 0:v.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i,id:s,ctx:{legendManager:n}}=this;if(!t||!i)return[];const{keys:[a]}=t.domain;if(e===this.getCategoryDirection()){const r=i.resolveProcessedDataDefById(this,"xValue");return(r==null?void 0:r.def.type)==="key"&&(r==null?void 0:r.def.valueType)==="category"?this.hasData?a.filter((o,l)=>n.getItemEnabled({seriesId:s,itemId:l})):[]:this.padBandExtent(a)}else{const r=this.domainForClippedRange(e,["yValue"],"xValue",!0),o=Math.max(...r),l=[-o,o];return Zbe(l)}}getSeriesRange(e,t){return[NaN,NaN]}createNodeData(){var N;const{hasData:e,data:t,dataModel:i,groupScale:s,processedData:n,id:a,ctx:{legendManager:r}}=this,o=this.getCategoryAxis(),l=this.getValueAxis();if(!(e&&t&&o&&l&&i&&(n==null?void 0:n.type)==="ungrouped"))return;const c=o.scale,h=l.scale,d=this.getBarDirection()===Ube.X,{stageKey:u,valueKey:p}=this.properties,{strokeWidth:g}=this.barStyle(),f=`${p}`,y={itemId:f,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible},v=this.visible;if(!v)return y;const x=i.resolveKeysById(this,"xValue",n),S=i.resolveColumnById(this,"yValue",n),{barWidth:M,groupIndex:D}=this.updateGroupScale(o),A=txe.is(c)?M*-.5:0,w=axe(o==null?void 0:o.scale,o==null?void 0:o.visibleRange,this.smallestDataInterval,this.largestDataInterval);let T;return((N=n.dataSources.get(this.id))!=null?N:[]).forEach((O,L)=>{const F=v&&r.getItemEnabled({seriesId:a,itemId:L}),B=x[L];if(B==null)return;const _=Math.round(c.convert(B))+s.convert(String(D))+A,G=S[L],V=Math.round(h.convert(-G)),j=Math.round(h.convert(G)),H=Math.max(g,Math.abs(j-V)),U={x:d?Math.min(j,V):_,y:d?_:Math.min(j,V),width:d?H:M,height:d?M:H},$={x:U.x+U.width/2,y:U.y+U.height/2},W=this.createLabelData({datumIndex:L,rect:U,barAlongX:d,yDatum:G,datum:O,visible:F}),Y={index:L,series:this,itemId:f,datum:O,datumIndex:L,xValue:B,yValue:G,xKey:u,yKey:p,x:U.x,y:U.y,width:U.width,height:U.height,midPoint:$,strokeWidth:g,crisp:w,label:W,visible:F};if(y.nodeData.push(Y),W!=null&&y.labelData.push(W),T!=null){const K=T.rect,Q=T.nodeDatum,Z=T.datumIndex;d?y.connectorData.push({datum:Q,datumIndex:Z,x0:K.x,y0:K.y+K.height,x1:K.x+K.width,y1:K.y+K.height,x2:U.x+U.width,y2:U.y,x3:U.x,y3:U.y,opacity:1}):y.connectorData.push({datum:Q,datumIndex:Z,x0:K.x+K.width,y0:K.y,x1:U.x,y1:U.y,x2:U.x,y2:U.y+U.height,x3:K.x+K.width,y3:K.y+K.height,opacity:1})}F&&(T={itemId:f,rect:U,nodeDatum:Y,datumIndex:L})}),y}updateNodes(e,t,i){var a,r;super.updateNodes(e,t,i);const{connectorSelection:s}=this,n=(r=(a=this.contextNodeData)==null?void 0:a.connectorData)!=null?r:[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:s,connectorData:n}),this.updateConnectorNodes({connectorSelection:s})}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t!=null?t:[];return i.update(s,void 0,n=>this.getDatumId(n))}updateConnectorSelection(e){const{connectorData:t,connectorSelection:i}=e;return i.update(this.connectorEnabled()?t:[],void 0,s=>this.getDatumId(s.datum))}updateConnectorNodes(e){const{fills:t,strokes:i,fillGradientDefaults:s,fillPatternDefaults:n,fillImageDefaults:a}=this.properties,{fill:r,fillOpacity:o,stroke:l,strokeOpacity:c,strokeWidth:h,lineDash:d,lineDashOffset:u}=this.connectorStyle(),p=this.getShapeFillBBox();e.connectorSelection.each((g,f)=>{const{datumIndex:y}=f;g.setProperties(pm(g,f));const v=cxe(r!=null?r:t[y%t.length],s,n,a);oxe(g,{fill:v,stroke:l!=null?l:i[y%i.length],fillOpacity:o,strokeOpacity:c,strokeWidth:h,lineDash:d,lineDashOffset:u},void 0,p)})}getHighlightLabelData(e,t){const i=e.filter(s=>s.datum===t.datum);return i.length>0?i:void 0}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=sV.None})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{Kbe(t,this.properties.label,i)})}getTooltipContent(e){var p;const{id:t,dataModel:i,processedData:s,properties:n}=this,{stageKey:a,valueKey:r,tooltip:o}=n,l=this.getCategoryAxis(),c=this.getValueAxis();if(!i||!s||!l||!c)return;const h=(p=s.dataSources.get(this.id))==null?void 0:p[e],d=i.resolveKeysById(this,"xValue",s)[e],u=i.resolveColumnById(this,"yValue",s)[e];if(d!=null)return this.formatTooltipWithContext(o,{symbol:this.legendItemSymbol(e),data:[{label:l.formatDatum(d),value:c.formatDatum(u)}]},b({seriesId:t,datum:h,title:a,stageKey:a,valueKey:r},this.tooltipStyle(h,e)))}resetAllAnimation(e){super.resetAllAnimation(e),qbe([this.connectorSelection],pm)}animateEmptyUpdateReady({labelSelection:e}){const{connectorSelection:t}=this,i=this.isVertical(),n=jbe(i,"normal");nxe.fromToMotion(this.id,"connectors",this.ctx.animationManager,[t],n),iV(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(e){const{labelSelection:t}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id),iV(this,"labels",this.ctx.animationManager,t)}getDatumId(e){return rxe(e.xValue)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){var t;return exe(this,(t=this.contextNodeData)==null?void 0:t.nodeData[e])}legendItemSymbol(e){var p,g;const{strokeWidth:t,fillOpacity:i,strokeOpacity:s,lineDash:n,lineDashOffset:a,fillGradientDefaults:r,fillPatternDefaults:o,fillImageDefaults:l}=this.barStyle(),{fills:c,strokes:h}=this.properties,d=(p=c[e%c.length])!=null?p:"black",u=(g=h[e%h.length])!=null?g:"black";return{marker:lxe({fill:d,fillOpacity:i,stroke:u,strokeWidth:t,strokeOpacity:s,lineDash:n,lineDashOffset:a},r,o,l)}}getLegendData(e){var l;const{id:t,processedData:i,dataModel:s,ctx:{legendManager:n},visible:a}=this;if(!s||!i||e!=="category")return[];const{showInLegend:r}=this.properties,o=s.resolveKeysById(this,"xValue",i);return((l=i.dataSources.get(this.id))!=null?l:[]).map((c,h)=>{const d=o[h];if(d!=null)return{legendType:"category",id:t,datum:c,itemId:h,seriesId:t,enabled:a&&n.getItemEnabled({seriesId:t,itemId:h}),label:{text:String(d)},symbol:this.legendItemSymbol(h),skipAnimations:!0,hideInLegend:!r}}).filter(c=>c!=null)}},{FillGradientDefaults:dxe,FillPatternDefaults:uxe,FillImageDefaults:pxe,Label:gxe,AbstractBarSeriesProperties:fxe,SeriesTooltip:mxe,AxisLabel:yxe,Property:bs}=R,UI=class extends gxe{constructor(){super(...arguments),this.spacing=0}};C([bs],UI.prototype,"placement",2),C([bs],UI.prototype,"spacing",2);var aV=class extends yxe{};C([bs],aV.prototype,"placement",2);var sn=class extends fxe{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new dxe,this.fillPatternDefaults=new uxe,this.fillImageDefaults=new pxe,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new UI,this.stageLabel=new aV,this.tooltip=new mxe}};C([bs],sn.prototype,"stageKey",2),C([bs],sn.prototype,"valueKey",2),C([bs],sn.prototype,"fills",2),C([bs],sn.prototype,"fillGradientDefaults",2),C([bs],sn.prototype,"fillPatternDefaults",2),C([bs],sn.prototype,"fillImageDefaults",2),C([bs],sn.prototype,"fillOpacity",2),C([bs],sn.prototype,"strokes",2),C([bs],sn.prototype,"strokeWidth",2),C([bs],sn.prototype,"strokeOpacity",2),C([bs],sn.prototype,"lineDash",2),C([bs],sn.prototype,"lineDashOffset",2),C([bs],sn.prototype,"label",2),C([bs],sn.prototype,"stageLabel",2),C([bs],sn.prototype,"tooltip",2);function rV(e,{x:t,y:i,width:s,height:n,opacity:a}){return{x1:t,y1:i,x2:t+s,y2:i+n,opacity:a}}var{formatValue:vxe,Line:bxe}=R,aC=class extends nV{constructor(e){super({moduleCtx:e,animationResetFns:{datum:rV}}),this.properties=new sn}get hasData(){var s;const{id:e,ctx:{legendManager:t}}=this,i=(s=this.data)==null?void 0:s.reduce((n,a,r)=>n+(t.getItemEnabled({seriesId:e,itemId:r})?1:0),0);return i!=null&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}barStyle(){return{fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[],lineDashOffset:0,fillGradientDefaults:this.properties.fillGradientDefaults,fillPatternDefaults:this.properties.fillPatternDefaults,fillImageDefaults:this.properties.fillImageDefaults}}connectorStyle(){const{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:s,lineDashOffset:n,fillGradientDefaults:a,fillPatternDefaults:r,fillImageDefaults:o}=this.properties;return{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:s,lineDashOffset:n,fillGradientDefaults:a,fillPatternDefaults:r,fillImageDefaults:o}}nodeFactory(){return new bxe}createLabelData({datumIndex:e,rect:t,barAlongX:i,yDatum:s,datum:n,visible:a}){const{stageKey:r,valueKey:o,label:l}=this.properties,{spacing:c,placement:h}=l;let d,u,p,g;if(i)switch(d=t.x+t.width/2,p="center",h){case"before":u=t.y-c,g="bottom";break;case"after":u=t.y+t.height+c,g="top";break;default:u=t.y+t.height/2,g="middle"}else switch(u=t.y+t.height/2,g="middle",h){case"before":d=t.x-c,p="right";break;case"after":d=t.x+t.width+c,p="left";break;default:d=t.x+t.width/2,p="center"}return{x:d,y:u,textAlign:p,textBaseline:g,text:this.getLabelText(l,{itemId:o,value:s,datum:n,stageKey:r,valueKey:o},f=>vxe(f,0)),itemId:o,datum:n,datumIndex:e,series:this,visible:a}}updateDatumNodes(e){const t=e.isHighlight?this.properties.highlightStyle.item:void 0;e.datumSelection.each((i,s)=>{var n,a,r;i.setProperties(rV(i,s)),i.stroke=t==null?void 0:t.stroke,i.strokeWidth=(n=t==null?void 0:t.strokeWidth)!=null?n:0,i.strokeOpacity=(a=t==null?void 0:t.strokeOpacity)!=null?a:1,i.lineDash=t==null?void 0:t.lineDash,i.lineDashOffset=(r=t==null?void 0:t.lineDashOffset)!=null?r:0})}tooltipStyle(e,t){var d,u;const{fills:i,strokes:s}=this.properties,n=(d=i[t%i.length])!=null?d:"black",a=(u=s[t%s.length])!=null?u:"black",{fillOpacity:r,strokeOpacity:o,strokeWidth:l,lineDash:c,lineDashOffset:h}=this.barStyle();return{fill:n,fillOpacity:r,stroke:a,strokeOpacity:o,strokeWidth:l,lineDash:c,lineDashOffset:h}}};aC.className="ConeFunnelSeries",aC.type="cone-funnel";var{commonSeriesOptionsDefs:xxe,coneFunnelSeriesThemeableOptionsDef:Cxe}=R,Sxe=E(b(b({},Cxe),xxe),{type:ee(Oe("cone-funnel")),stageKey:ee(z),valueKey:ee(z)}),{ThemeConstants:{CARTESIAN_AXIS_TYPE:oV}}=R,Mxe={series:{direction:"vertical",fills:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},R.SAFE_RANGE2_OPERATION]},strokes:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},R.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,strokeWidth:0,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},placement:"before",spacing:4}},seriesArea:{padding:{top:20,bottom:20}},axes:{[oV.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(e){var t;return Math.abs(e.value).toFixed((t=e.fractionDigits)!=null?t:0)}}},[oV.CATEGORY]:{line:{enabled:!1}}}},Dxe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"cone-funnel",moduleFactory:e=>new aC(e),solo:!0,tooltipDefaults:{range:"nearest"},defaultAxes:Zz,themeTemplate:Mxe},wxe={type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,options:Sxe,create:e=>new aC(e)},{FillGradientDefaults:Axe,FillPatternDefaults:Ixe,FillImageDefaults:Txe,Label:kxe,DropShadow:Lxe,AbstractBarSeriesProperties:Pxe,BaseProperties:Exe,SeriesTooltip:Rxe,AxisLabel:Nxe,Property:Et}=R,Oxe=class extends kxe{},lV=class extends Nxe{};C([Et],lV.prototype,"placement",2);var hl=class extends Exe{constructor(){super(...arguments),this.enabled=!0,this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};C([Et],hl.prototype,"enabled",2),C([Et],hl.prototype,"fill",2),C([Et],hl.prototype,"fillOpacity",2),C([Et],hl.prototype,"stroke",2),C([Et],hl.prototype,"strokeWidth",2),C([Et],hl.prototype,"strokeOpacity",2),C([Et],hl.prototype,"lineDash",2),C([Et],hl.prototype,"lineDashOffset",2);var Zi=class extends Pxe{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new Axe,this.fillPatternDefaults=new Ixe,this.fillImageDefaults=new Txe,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new hl,this.shadow=new Lxe().set({enabled:!1}),this.label=new Oxe,this.stageLabel=new lV,this.tooltip=new Rxe}};C([Et],Zi.prototype,"stageKey",2),C([Et],Zi.prototype,"valueKey",2),C([Et],Zi.prototype,"fills",2),C([Et],Zi.prototype,"fillGradientDefaults",2),C([Et],Zi.prototype,"fillPatternDefaults",2),C([Et],Zi.prototype,"fillImageDefaults",2),C([Et],Zi.prototype,"fillOpacity",2),C([Et],Zi.prototype,"strokes",2),C([Et],Zi.prototype,"strokeWidth",2),C([Et],Zi.prototype,"strokeOpacity",2),C([Et],Zi.prototype,"lineDash",2),C([Et],Zi.prototype,"lineDashOffset",2),C([Et],Zi.prototype,"spacingRatio",2),C([Et],Zi.prototype,"itemStyler",2),C([Et],Zi.prototype,"dropOff",2),C([Et],Zi.prototype,"shadow",2),C([Et],Zi.prototype,"label",2),C([Et],Zi.prototype,"stageLabel",2),C([Et],Zi.prototype,"tooltip",2);var{ChartAxisDirection:Fxe,resetBarSelectionsFn:Bxe,prepareBarAnimationFunctions:cV,midpointStartingBarPosition:hV,createDatumId:_xe,formatValue:Gxe,Rect:zxe,motion:dV,applyShapeStyle:Vxe,getShapeStyle:uV}=R,rC=class extends nV{constructor(e){super({moduleCtx:e,animationResetFns:{datum:Bxe}}),this.properties=new Zi}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}barStyle(){const{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:s,lineDashOffset:n,fillGradientDefaults:a,fillPatternDefaults:r,fillImageDefaults:o}=this.properties;return{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:s,lineDashOffset:n,fillGradientDefaults:a,fillPatternDefaults:r,fillImageDefaults:o}}connectorStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r}=this.properties.dropOff;return{fill:e,fillOpacity:t,stroke:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r,fillGradientDefaults:this.properties.fillGradientDefaults,fillPatternDefaults:this.properties.fillPatternDefaults,fillImageDefaults:this.properties.fillImageDefaults}}nodeFactory(){return new zxe}createLabelData({datumIndex:e,rect:t,yDatum:i,datum:s,visible:n}){const{valueKey:a,stageKey:r,label:o}=this.properties;return{x:t.x+t.width/2,y:t.y+t.height/2,textAlign:"center",textBaseline:"middle",text:this.getLabelText(o,{itemId:r,value:i,datum:s,valueKey:a,stageKey:r},l=>Gxe(l,0)),itemId:r,datum:s,datumIndex:e,series:this,visible:n}}getItemBaseStyle(e){var s,n,a,r,o;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return uV({fill:i==null?void 0:i.fill,fillOpacity:(s=i==null?void 0:i.fillOpacity)!=null?s:t.fillOpacity,stroke:i==null?void 0:i.stroke,strokeWidth:(n=i==null?void 0:i.strokeWidth)!=null?n:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(a=i==null?void 0:i.strokeOpacity)!=null?a:t.strokeOpacity,lineDash:(r=i==null?void 0:i.lineDash)!=null?r:t.lineDash,lineDashOffset:(o=i==null?void 0:i.lineDashOffset)!=null?o:t.lineDashOffset},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getItemStyleOverrides(e,t,i,s,n){var f,y,v,x;const{id:a,properties:r}=this,{stageKey:o,valueKey:l,fills:c,strokes:h,itemStyler:d}=r,u=(y=(f=s.fill)!=null?f:c[i%c.length])!=null?y:"black",p=(x=(v=s.stroke)!=null?v:h[i%h.length])!=null?x:"black",g={};if(n||(g.fill=u,g.stroke=p),d!=null){const S=this.cachedDatumCallback(_xe(e,n?"highlight":"node"),()=>{const{fillOpacity:M,strokeOpacity:D,strokeWidth:A,lineDash:w,lineDashOffset:T}=s;return this.callWithContext(d,{seriesId:a,datum:t,highlighted:n,stageKey:o,valueKey:l,fill:u,fillOpacity:M,stroke:p,strokeOpacity:D,strokeWidth:A,lineDash:w,lineDashOffset:T})});Object.assign(g,S)}return uV(g,r.fillGradientDefaults,r.fillPatternDefaults,r.fillImageDefaults)}updateDatumNodes(e){const{shadow:t}=this.properties,{datumSelection:i,isHighlight:s}=e,n=this.getCategoryDirection()===Fxe.X,a=this.getItemBaseStyle(s),r=this.getShapeFillBBox();i.each((o,l)=>{const{datumIndex:c}=l,h=this.getItemStyleOverrides(String(l.datumIndex),l.datum,c,a,s);Vxe(o,a,h,r),o.visible=n?l.width>0:l.height>0,o.crisp=l.crisp,o.fillShadow=t})}tooltipStyle(e,t){const i=this.getItemBaseStyle(!1);return Object.assign(i,this.getItemStyleOverrides(String(t),e,t,i,!1)),i}animateEmptyUpdateReady(e){super.animateEmptyUpdateReady(e);const{datumSelection:t}=e,i=this.isVertical(),n=cV(hV(i,"normal"));dV.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],n)}animateWaitingUpdateReady(e){var a,r;super.animateWaitingUpdateReady(e);const{datumSelection:t}=e,{processedData:i}=this,s=(r=(a=i==null?void 0:i.reduced)==null?void 0:a.diff)==null?void 0:r[this.id],n=cV(hV(this.isVertical(),"fade"));dV.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],n,(o,l)=>l.xValue,s)}};rC.className="FunnelSeries",rC.type="funnel";var{commonSeriesOptionsDefs:jxe,funnelSeriesThemeableOptionsDef:Hxe}=R,Wxe=E(b(b({},Hxe),jxe),{type:ee(Oe("funnel")),stageKey:ee(z),valueKey:ee(z)}),Uxe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"funnel",moduleFactory:e=>new rC(e),solo:!0,tooltipDefaults:{range:"exact"},defaultAxes:Zz,themeTemplate:_be},Kxe={type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,options:Wxe,create:e=>new rC(e)},pV=class{*[Symbol.iterator](){const{node:e,datum:t}=this;e&&t&&(yield{node:e,datum:t})}nodes(){return this.node?[this.node]:[]}update(e,t,i,s){var a,r;const n=e.nodes();if(n.length===0)(a=this.node)==null||a.remove(),this.node=void 0;else{this.node===void 0&&(this.node=new i,this.node.fillOpacity=0,this.node.strokeOpacity=0,t.appendChild(this.node));const o=n[0],l=(r=n.toReversed().find(c=>c.datum.datum.value>c.datum.datum.segmentStart))!=null?r:n[n.length-1];this.node.datum=this.datum=o.datum,s(this.node,o,l)}}},gV={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function fV(e,t){if(e==null)return"";const{min:i,max:s}=t,n=i!==0?Math.ceil(Math.log10(Math.abs(i))):0,a=s!==0?Math.ceil(Math.log10(Math.abs(s))):0,r=Math.max(2-Math.max(n,a),0);return e.toFixed(r)}function gm(e,t,i,s){if(i.text!=null)return i.text;const n=s!=null?s:i.value;let a;if((i==null?void 0:i.formatter)!=null&&(a=KI(t,i.formatter,{seriesId:e,datum:void 0,value:n})),a!=null)return String(a)}function KI(e,t,i){return R.callWithContext(e.chartService,void 0,t,[i])}function mV({path:e,x:t,y:i,size:s}){e.moveTo(t,i-s/2),e.lineTo(t,i+s/2)}function yV(e,t){const i=ih(e.datumUnion.nodes(),e.targetSelection.nodes());return e.pickNodeNearestDistantObject(t,i)}function vV(e,t){var l,c;const i=[{data:(l=e.contextNodeData)==null?void 0:l.nodeData,selection:e.datumUnion},{data:(c=e.contextNodeData)==null?void 0:c.targetData,selection:e.targetSelection}].filter(h=>h.data&&h.data.length>0),s=we(0,t.otherIndex+t.otherIndexDelta,i.length-1);if(i.length===0)return;const{data:n,selection:a}=i[s];if(n==null||n.length===0)return;const r=we(0,t.datumIndex,n.length-1),o=n[r];for(const h of a)if(h.datum===o)return{bounds:h.node,clipFocusBox:!0,datum:o,datumIndex:r,otherIndex:s}}var{BaseProperties:bV,Property:wp}=R,oC=class extends bV{getSegments(e,t){var l,c;const{values:i,step:s,count:n}=this,a=Math.min(...e.domain),r=Math.max(...e.domain);let o;if(i!=null){const h=i.filter(d=>d>a&&d<r).sort((d,u)=>d-u);o=[a,...h,r]}else if(s!=null){const h=[];for(let d=a;d<r;d+=s)h.push(d);h.push(r),o=h}else if(n!=null){const h=n+1;o=Array.from({length:h+1},(d,u)=>u/h*(r-a)+a)}else{const h=(c=(l=e.ticks({nice:!0,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}))==null?void 0:l.ticks)==null?void 0:c.filter(d=>d>a&&d<r);o=h!=null?[a,...h,r]:void 0}return o!=null&&o.length>t&&(se.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),o=void 0),o!=null||(o=[a,r]),o}};C([wp],oC.prototype,"values",2),C([wp],oC.prototype,"step",2),C([wp],oC.prototype,"count",2);var fm=class extends bV{constructor(){super(...arguments),this.enabled=!1,this.interval=new oC,this.spacing=0}};C([wp],fm.prototype,"enabled",2),C([wp],fm.prototype,"interval",2),C([wp],fm.prototype,"spacing",2);var{BaseProperties:lC,SeriesTooltip:$xe,SeriesProperties:Yxe,PropertiesArray:$I,Property:Ae,Label:Xxe,AxisLabel:Zxe}=R,xV=class extends Xxe{};C([Ae],xV.prototype,"spacing",2);var Fs=class extends lC{constructor(){super(...arguments),this.value=0,this.label=new xV}};C([Ae],Fs.prototype,"text",2),C([Ae],Fs.prototype,"value",2),C([Ae],Fs.prototype,"shape",2),C([Ae],Fs.prototype,"placement",2),C([Ae],Fs.prototype,"spacing",2),C([Ae],Fs.prototype,"size",2),C([Ae],Fs.prototype,"rotation",2),C([Ae],Fs.prototype,"fill",2),C([Ae],Fs.prototype,"fillOpacity",2),C([Ae],Fs.prototype,"stroke",2),C([Ae],Fs.prototype,"strokeWidth",2),C([Ae],Fs.prototype,"strokeOpacity",2),C([Ae],Fs.prototype,"lineDash",2),C([Ae],Fs.prototype,"lineDashOffset",2),C([Ae],Fs.prototype,"label",2);var ha=class extends lC{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new $I(R.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};C([Ae],ha.prototype,"enabled",2),C([Ae],ha.prototype,"thickness",2),C([Ae],ha.prototype,"thicknessRatio",2),C([Ae],ha.prototype,"fills",2),C([Ae],ha.prototype,"fillMode",2),C([Ae],ha.prototype,"fill",2),C([Ae],ha.prototype,"fillOpacity",2),C([Ae],ha.prototype,"stroke",2),C([Ae],ha.prototype,"strokeWidth",2),C([Ae],ha.prototype,"strokeOpacity",2),C([Ae],ha.prototype,"lineDash",2),C([Ae],ha.prototype,"lineDashOffset",2);var mm=class extends lC{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};C([Ae],mm.prototype,"values",2),C([Ae],mm.prototype,"step",2),C([Ae],mm.prototype,"minSpacing",2),C([Ae],mm.prototype,"maxSpacing",2);var CV=class extends Zxe{constructor(){super(...arguments),this.placement=void 0}};C([Ae],CV.prototype,"placement",2);var nn=class extends lC{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new $I(R.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new mm,this.label=new CV}};C([Ae],nn.prototype,"min",2),C([Ae],nn.prototype,"max",2),C([Ae],nn.prototype,"fills",2),C([Ae],nn.prototype,"fillMode",2),C([Ae],nn.prototype,"fill",2),C([Ae],nn.prototype,"fillOpacity",2),C([Ae],nn.prototype,"stroke",2),C([Ae],nn.prototype,"strokeWidth",2),C([Ae],nn.prototype,"strokeOpacity",2),C([Ae],nn.prototype,"lineDash",2),C([Ae],nn.prototype,"lineDashOffset",2),C([Ae],nn.prototype,"defaultFill",2),C([Ae],nn.prototype,"interval",2),C([Ae],nn.prototype,"label",2);var cC=class extends no{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};C([Ae],cC.prototype,"text",2),C([Ae],cC.prototype,"placement",2),C([Ae],cC.prototype,"avoidCollisions",2);var an=class extends Yxe{constructor(){super(...arguments),this.value=0,this.segmentation=new fm,this.defaultColorRange=[],this.targets=new $I(Fs),this.defaultTarget=new Fs,this.defaultScale=new nn,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new nn,this.bar=new ha,this.label=new cC,this.tooltip=new $xe}};C([Ae],an.prototype,"value",2),C([Ae],an.prototype,"segmentation",2),C([Ae],an.prototype,"defaultColorRange",2),C([Ae],an.prototype,"targets",2),C([Ae],an.prototype,"defaultTarget",2),C([Ae],an.prototype,"defaultScale",2),C([Ae],an.prototype,"direction",2),C([Ae],an.prototype,"thickness",2),C([Ae],an.prototype,"cornerRadius",2),C([Ae],an.prototype,"cornerMode",2),C([Ae],an.prototype,"margin",2),C([Ae],an.prototype,"scale",2),C([Ae],an.prototype,"bar",2),C([Ae],an.prototype,"label",2),C([Ae],an.prototype,"tooltip",2);var{CachedTextMeasurerPool:qxe,BBox:Qxe}=R;function YI(e){const{x0:t,y0:i,x1:s,y1:n,horizontalInset:a,verticalInset:r}=e,o=Math.min(t,s)+a,l=Math.min(i,n)+r,c=Math.max(Math.abs(s-t)-2*a,0),h=Math.max(Math.abs(n-i)-2*r,0);return{x:o,y:l,width:c,height:h}}function Jxe(e,t){if(t==null)return!0;const i=YI(e),s=1e-6,n=i.x+s,a=i.y+s,r=i.x+i.width-s,o=i.y+i.height-s,l=t.x,c=t.x+t.width,h=t.y,d=t.y+t.height;return Math.max(n,l)<=Math.min(r,c)&&Math.max(a,h)<=Math.min(o,d)}function XI(e){const{clipX0:t,clipX1:i,clipY0:s,clipY1:n}=e;return t!=null&&i!=null||s!=null&&n!=null}function eCe(e){if(!XI(e))return;const{x0:t,y0:i,x1:s,y1:n}=e,{x:a,y:r,width:o,height:l}=YI(e);let{clipX0:c,clipX1:h,clipY0:d,clipY1:u}=e;(c==null||h==null)&&(c=t,h=s),(d==null||u==null)&&(d=i,u=n);const p=Math.min(c,h),g=Math.min(d,u),f=Math.abs(h-c),y=Math.abs(u-d);return c=Math.max(a,p),d=Math.max(r,g),h=Math.min(a+o,p+f),u=Math.min(r+l,g+y),new Qxe(Math.min(c,h),Math.min(d,u),Math.abs(h-c),Math.abs(u-d))}function SV(e,t){const i=e?"initial":"update";return{node:{fromFn(n,a){const r=n.previousDatum;let{x0:o,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:p,clipY1:g}=r!=null?r:a;const{horizontalInset:f,verticalInset:y}=a,v=r!=null&&XI(r),x=XI(a);return v&&x||(!v&&x?({x0:o,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:p,clipY1:g}=a,e&&(t?p=a.clipX0:g=a.clipY0)):v&&!x?({x0:o,y0:l,x1:c,y1:h}=a,d=void 0,u=void 0,p=void 0,g=void 0):e&&(t?c=o:h=l)),{x0:o,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:p,clipY1:g,horizontalInset:f,verticalInset:y,phase:i}},toFn(n,a){const{x0:r,y0:o,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:p,horizontalInset:g,verticalInset:f}=a;return{x0:r,y0:o,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:p,horizontalInset:g,verticalInset:f}},applyFn(n,a){n.setProperties(hC(n,a))}}}}function hC(e,t){const{x:i,y:s,width:n,height:a}=YI(t),r=eCe(t),o=Jxe(t,r);return{x:i,y:s,width:n,height:a,clipBBox:r,visible:o}}var tCe={Before:"right",Center:"center",After:"left"},iCe={Before:"top",Center:"middle",After:"bottom"},sCe={Before:-1,Center:-.5,After:0},nCe={Before:0,Center:-.5,After:-1};function aCe(e,t,i,s,n,a){const{seriesRect:r,gaugeRect:o,barRect:l}=n,{padding:c,horizontal:h}=s;i.each((d,u)=>{const p=gm(e.id,t,u,a==null?void 0:a.label);let g,f;u.placement==="outside-start"?h?(g=o.x,f=r.height):(g=r.width,f=r.height-(o.y+o.height)):u.placement==="outside-end"?h?(g=r.width-(o.x+o.width),f=r.height):(g=r.width,f=o.y):u.avoidCollisions&&(g=o.width,f=o.height);let y;if(p==null)return;if(g!=null&&f!=null){const G=cm(p,u,{padding:c},()=>({width:g,height:f,meta:null}));y=G==null?void 0:G[0]}else{const _={fontSize:u.fontSize,fontStyle:u.fontStyle,fontWeight:u.fontWeight,fontFamily:u.fontFamily,lineHeight:u.lineHeight},{width:G,height:V}=qxe.measureText(p,{font:_});y={text:p,fontSize:u.fontSize,lineHeight:bp(u,u.fontSize),width:G,height:V}}if(y==null){d.visible=!1;return}const v=h?o.x:o.y+o.height,x=h?o.x+o.width:o.y,S=h?l.x:l.y+l.height,M=h?l.x+l.width:l.y,D=u.spacing*(h?1:-1);let A,w,T,k;switch(u.placement){case"outside-start":A=-1/0,w=1/0,T=v-D,k="Before";break;case"outside-end":A=-1/0,w=1/0,T=x+D,k="After";break;case"inside-start":A=v,w=M,T=v+D,k="After";break;case"inside-end":A=M,w=x,T=x-D,k="Before";break;case"inside-center":A=v,w=x,T=(v+x)/2,k="Center";break;case"bar-inside":A=S,w=M,T=(S+M)/2,k="Center";break;case"bar-inside-end":A=S,w=M,T=M-D,k="Before";break;case"bar-outside-end":A=M,w=x,T=M+D,k="After";break;case"bar-end":A=-1/0,w=1/0,T=M,k="Center";break}const N=h?T:o.x+o.width/2,O=h?o.y+o.height/2:T;let L,F;h?(L=N+sCe[k]*y.width,F=L+y.width):(L=O+nCe[k]*y.height,F=L+y.height);const B=Math.min(L,F)>=Math.min(A,w)&&Math.max(L,F)<=Math.max(A,w);if(u.avoidCollisions&&!B){d.visible=!1;return}d.visible=!0,d.text=y.text,d.fontSize=y.fontSize,d.lineHeight=y.lineHeight,d.textAlign=h?tCe[k]:"center",d.textBaseline=h?"middle":iCe[k],d.x=N,d.y=O})}var{fromToMotion:ZI,resetMotion:rCe,SeriesNodePickMode:MV,StateMachine:oCe,createDatumId:DV,CachedTextMeasurerPool:lCe,toRadians:wV,BBox:kc,Group:Sd,PointerEvents:AV,Selection:Md,Rect:cCe,Text:IV,TransformableText:hCe,Marker:dCe,LinearScale:uCe,AxisTickGenerator:pCe,NiceMode:gCe,easing:fCe,getColorStops:mCe,findRangeExtent:yCe}=R,vCe={before:180,middle:0,after:0},bCe={before:90,middle:0,after:-90},xCe=class{constructor(e,t){this.gauge=e,this.ctx=t}get defaultTickMinSpacing(){return 0}get range(){return this.gauge.range}get reverse(){return!1}get scale(){return this.gauge.scale}get label(){return this.gauge.properties.scale.label}get interval(){return this.gauge.properties.scale.interval}formatTick(e,t,i,s,n,a){var o,l;const{label:r}=this;return(l=(o=this.formatWithContext(e,t,i))!=null?o:r.format!=null?a==null?void 0:a(e):void 0)!=null?l:this.gauge.formatLabel(e)}formatWithContext(e,t,i){let s;return this.label.formatter&&(s=KI(this.ctx,this.label.formatter,{value:e,index:t,domain:i,boundSeries:void 0})),s}inRange(){return!0}},dC=class extends R.Series{constructor(e){super({moduleCtx:e,useLabelLayer:!0,pickModes:[MV.EXACT_SHAPE_MATCH,MV.NEAREST_NODE]}),this.properties=new an,this.seriesRect=kc.NaN,this.gaugeRect=kc.NaN,this.scale=new uCe,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new Sd({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Sd({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Sd({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Sd({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Sd({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Sd({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new Sd({name:"tickGroup"})),this.scaleSelection=Md.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Md.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=Md.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=Md.select(this.itemTargetLabelGroup,IV),this.labelSelection=Md.select(this.itemLabelGroup,IV),this.highlightTargetSelection=Md.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=Md.select(this.tickGroup,hCe),this.datumUnion=new pV,this.axis=new xCe(this,e),this.tickGenerator=new pCe(this.axis),this.animationState=new oCe("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=AV.None,this.tickGroup.pointerEvents=AV.None}get range(){return this.horizontal?[0,this.gaugeRect.width]:[0,this.gaugeRect.height]}get horizontal(){return this.properties.direction==="horizontal"}get hasData(){return!0}nodeFactory(){const e=new cCe;return e.crisp=!0,e}markerFactory(){return new dCe}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){return fV(e,this.properties.scale)}createLinearGradient(e,t,i){const{properties:s,horizontal:n}=this,{defaultColorRange:a}=s;return{type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:mCe(t,a,e.domain,i),rotation:n?90:0}}getShapeFillBBox(){const{properties:e,originX:t,originY:i,horizontal:s,scale:n}=this,{thickness:a}=e,r=yCe(n.range);return new kc(t,i,s?r:a,s?a:r)}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{var T,k,N,O,L,F,B,_,G,V,j,H,U,$,W,Y,K;const{text:s=t.text,value:n=(T=t.value)!=null?T:0,shape:a=(k=t.shape)!=null?k:"triangle",rotation:r=(N=t.rotation)!=null?N:0,strokeWidth:o=(O=t.strokeWidth)!=null?O:0,placement:l=(L=t.placement)!=null?L:"middle",spacing:c=(F=t.spacing)!=null?F:0,size:h=(B=t.size)!=null?B:0,fill:d=(_=t.fill)!=null?_:"black",fillOpacity:u=(G=t.fillOpacity)!=null?G:1,stroke:p=(V=t.stroke)!=null?V:"black",strokeOpacity:g=(j=t.strokeOpacity)!=null?j:1,lineDash:f=(H=t.lineDash)!=null?H:[0],lineDashOffset:y=(U=t.lineDashOffset)!=null?U:0}=i,{enabled:v=t.label.enabled,color:x=($=t.label.color)!=null?$:"black",fontStyle:S=(W=t.label.fontStyle)!=null?W:"normal",fontWeight:M=(Y=t.label.fontWeight)!=null?Y:"normal",fontSize:D=t.label.fontSize,fontFamily:A=t.label.fontFamily,spacing:w=(K=t.label.spacing)!=null?K:0}=i.label;return{text:s,value:n,shape:a,placement:l,spacing:c,size:h,rotation:r,fill:d,fillOpacity:u,stroke:p,strokeWidth:o,strokeOpacity:g,lineDash:f,lineDashOffset:y,label:{enabled:v,color:x,fontStyle:S,fontWeight:M,fontSize:D,fontFamily:A,spacing:w}}})}getTargetPoint(e){const{properties:t,originX:i,originY:s,horizontal:n,scale:a,gaugeRect:r}=this,{thickness:o}=t,{value:l,placement:c,spacing:h,size:d}=e,u=a.convert(l);let p;switch(c){case"before":p=-(h+d/2);break;case"after":p=o+h+d/2;break;default:p=o/2;break}return{x:i+r.x+(n?u:p),y:s+r.y+(n?p:u)}}getTargetLabel(e){const{size:t,placement:i,label:s}=e,{spacing:n,color:a,fontStyle:r,fontWeight:o,fontSize:l,fontFamily:c}=s,h=void 0,d=t/2+n;let u,p,g=0,f=0;return this.horizontal?(u="center",i==="after"?(p="top",f=d):(p="bottom",f=-d)):(p="middle",i==="before"?(u="right",g=-d):(u="left",g=d)),{offsetX:g,offsetY:f,fill:a,textAlign:u,textBaseline:p,fontStyle:r,fontWeight:o,fontSize:l,fontFamily:c,lineHeight:h}}labelDatum(e,t){const{placement:i,avoidCollisions:s,spacing:n,text:a,color:r,fontSize:o,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:p,overflowStrategy:g,formatter:f=y=>this.formatLabel(y.value)}=e;return{placement:i,avoidCollisions:s,spacing:n,text:a,value:t,fill:r,fontSize:o,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:p,overflowStrategy:g,formatter:f}}verticalLabelInset(){var n,a;const{properties:e}=this,{label:t}=e,i=(n=t.text)==null?void 0:n.split(`
`),s=bp(t,t.fontSize)*((a=i==null?void 0:i.length)!=null?a:1);return t.spacing+s}horizontalLabelInset(){var c,h,d,u;const{scale:e,properties:t}=this,{scale:i,label:s}=t,n=(c=s.text)==null?void 0:c.split(`
`),a=s.getFont(),r=(u=(d=i.interval.values)!=null?d:(h=e.ticks({nice:!1,interval:i.interval.step,minTickCount:0,maxTickCount:6,tickCount:5}))==null?void 0:h.ticks)!=null?u:[],l=(n!=null?n:r==null?void 0:r.map(p=>{var g;return(g=gm(this.id,this.ctx,this.labelDatum(s,p)))!=null?g:""})).reduce((p,g)=>{const{width:f}=lCe.measureText(g,{font:a});return Math.max(p,f)},0);return s.spacing+l}createNodeData(){var de,ue,ie,re;const{id:e,properties:t,horizontal:i,scale:s,seriesRect:n}=this,{value:a,segmentation:r,thickness:o,cornerRadius:l,cornerMode:c,bar:h,scale:d,label:u}=t;s.domain=[d.min,d.max],s.range=i?[0,n.width]:[n.height,0];let p,g;i?(g=1,p=Math.PI/2):d.label.placement==="before"?(g=1,p=0):(g=-1,p=0);const f=p-Math.PI/2;let y,v,x,S;i?(y=0,v=n.width,x=(n.height-o)/2,S=x+o,u.placement==="outside-start"?y+=this.horizontalLabelInset():u.placement==="outside-end"&&(v-=this.horizontalLabelInset())):(y=(n.width-o)/2,v=y+o,S=0,x=n.height,u.placement==="outside-start"?x-=this.verticalLabelInset():u.placement==="outside-end"&&(S+=this.verticalLabelInset())),this.gaugeRect=new kc(Math.min(y,v),Math.min(x,S),Math.abs(v-y),Math.abs(S-x));const M=0,D=0;s.domain=[d.min,d.max],s.range=i?[y,v]:[x,S];const{ticks:A}=this.tickGenerator.generateTicks({domain:s.domain,primaryTickCount:void 0,visibleRange:[0,1],niceMode:gCe.Off,labelX:0,parallelFlipRotation:p,regularFlipRotation:f,sideFlag:g,removeOverflowLabels:!1}).tickData,w=!1,T=this.getTargets(),k=[],N=[],O=[],L=[],[F,B]=s.range,_=Math.abs(B-F),G=i?s.convert(a):v,V=i?S:s.convert(a),j=r.enabled?r.spacing/2:0,H=i?j:0,U=i?0:j,$=Math.min((de=h.thickness)!=null?de:Math.round(h.thicknessRatio*o),o),W=-(o-$)/2,Y=i?0:W,K=i?W:0,Q=c==="item",Z=Math.ceil(_);let J=r.enabled?r.interval.getSegments(s,Z):void 0;const ae=(ue=h.fill)!=null?ue:this.createLinearGradient(s,h.fills,h.fillMode),oe=(re=(ie=d.fill)!=null?ie:h.enabled&&d.fills.length===0?d.defaultFill:void 0)!=null?re:this.createLinearGradient(s,d.fills,d.fillMode);if(J==null&&Q){const te=Math.min(...s.domain),fe=Math.max(...s.domain),me={value:a,segmentStart:te,segmentEnd:fe};if(h.enabled){const Te=Math.min(l,$/2,_/2)*(w?-1:1),Fe=i?Te:0,lt=i?0:Te;k.push({series:this,itemId:"value",datum:me,datumIndex:{type:0},type:0,x0:M+y-Fe-Y,y0:D+x-lt-K,x1:M+G+Fe+Y,y1:D+V+lt+K,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:ae,horizontalInset:H,verticalInset:U})}const Ee=Math.min(l,o/2,_/2)*(w?-1:1),He=i?Ee:0,Ue=i?0:Ee;L.push({series:this,itemId:"scale",datum:me,datumIndex:{type:0},type:0,x0:M+y-He,y0:D+x-Ue,x1:M+v+He,y1:D+S+Ue,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:oe,horizontalInset:H,verticalInset:U})}else{J!=null||(J=s.domain);const te=M+y-Y,fe=D+x-K,me=M+G+Y,Le=D+V+K;for(let Ee=0;Ee<J.length-1;Ee+=1){const He=J[Ee+0],Ue=J[Ee+1],je={value:a,segmentStart:He,segmentEnd:Ue},Te=Ee===0,Fe=Ee===J.length-2,lt=s.convert(He),wt=s.convert(Ue),Ai=Q||Te?l:0,vi=Q||Fe?l:0,Bc=i?Ai:vi,yr=vi,_c=i?vi:Ai,ET=Ai;h.enabled&&k.push({series:this,itemId:`value-${Ee}`,datum:je,datumIndex:{type:0},type:0,x0:M+(i?lt:y),y0:D+(i?x:lt),x1:M+(i?wt:v),y1:D+(i?S:wt),clipX0:te,clipY0:fe,clipX1:me,clipY1:Le,topLeftCornerRadius:Bc,topRightCornerRadius:yr,bottomRightCornerRadius:_c,bottomLeftCornerRadius:ET,fill:ae,horizontalInset:H,verticalInset:U}),L.push({series:this,itemId:`scale-${Ee}`,datum:je,datumIndex:{type:0},type:0,x0:M+(i?lt:y),y0:D+(i?x:lt),x1:M+(i?wt:v),y1:D+(i?S:wt),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:Bc,topRightCornerRadius:yr,bottomRightCornerRadius:_c,bottomLeftCornerRadius:ET,fill:oe,horizontalInset:H,verticalInset:U})}}u.enabled&&O.push(this.labelDatum(u,a));const le=i?vCe:bCe;for(let te=0;te<T.length;te+=1){const fe=T[te],{value:me,text:Le,shape:Ee,size:He,fill:Ue,fillOpacity:je,stroke:Te,strokeWidth:Fe,strokeOpacity:lt,lineDash:wt,lineDashOffset:Ai}=fe,vi=this.getTargetPoint(fe),Bc=wV(fe.rotation+le[fe.placement]);N.push({series:this,itemId:`target-${te}`,midPoint:vi,datum:{value:me},datumIndex:{type:1,index:te},type:1,value:me,text:Le,x:vi.x,y:vi.y,shape:Ee,size:He,rotation:Bc,fill:Ue,fillOpacity:je,stroke:Te,strokeOpacity:lt,strokeWidth:Fe,lineDash:wt,lineDashOffset:Ai,label:this.getTargetLabel(fe)})}return{itemId:e,nodeData:k,tickData:A,targetData:N,labelData:O,scaleData:L}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){var f,y,v,x,S,M,D,A,w,T;const{datumSelection:t,labelSelection:i,targetSelection:s,targetLabelSelection:n,scaleSelection:a,highlightTargetSelection:r,tickSelection:o}=this;this.seriesRect=e!=null?e:kc.NaN;const l=this.checkResize(e);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=(y=(f=this.contextNodeData)==null?void 0:f.nodeData)!=null?y:[],h=(x=(v=this.contextNodeData)==null?void 0:v.labelData)!=null?x:[],d=(M=(S=this.contextNodeData)==null?void 0:S.targetData)!=null?M:[],u=(A=(D=this.contextNodeData)==null?void 0:D.scaleData)!=null?A:[],p=(T=(w=this.contextNodeData)==null?void 0:w.tickData)!=null?T:[],g=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:u,scaleSelection:a}),this.updateScaleNodes({scaleSelection:a}),this.targetSelection=this.updateTargetSelection({targetData:d,targetSelection:s}),this.updateTargetNodes({targetSelection:s,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:d,targetLabelSelection:n}),this.updateTargetLabelNodes({targetLabelSelection:n}),this.datumSelection=this.updateDatumSelection({nodeData:c,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:h,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:g!=null?[g]:[],targetSelection:r}),this.updateTargetNodes({targetSelection:r,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:p,tickSelection:o}),this.updateTickNodes({tickSelection:o}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>DV(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i,properties:s}=this,{bar:n}=s,{fillOpacity:a,stroke:r,strokeOpacity:o,lineDash:l,lineDashOffset:c}=n,h=this.getStrokeWidth(n.strokeWidth),d=i.animationManager.isSkipped(),u=this.getShapeFillBBox();t.each((p,g)=>{const{topLeftCornerRadius:f,topRightCornerRadius:y,bottomRightCornerRadius:v,bottomLeftCornerRadius:x,fill:S}=g;p.fill=S,p.fillBBox=u,p.fillOpacity=a,p.stroke=r,p.strokeOpacity=o,p.strokeWidth=h,p.lineDash=l,p.lineDashOffset=c,p.topLeftCornerRadius=f,p.topRightCornerRadius=y,p.bottomRightCornerRadius=v,p.bottomLeftCornerRadius=x,p.pointerEvents=this.properties.bar.enabled?R.PointerEvents.All:R.PointerEvents.None,(d||p.previousDatum==null)&&p.setProperties(hC(p,g))}),this.datumUnion.update(t,this.itemGroup,R.Rect,(p,g,f)=>{var y,v,x,S,M,D,A,w,T;p.pointerEvents=R.PointerEvents.None,(y=p.clipBBox)!=null||(p.clipBBox=new kc(NaN,NaN,NaN,NaN)),p.x=g.x,p.y=g.y,p.clipBBox.x=(x=(v=g.clipBBox)==null?void 0:v.x)!=null?x:g.x,p.clipBBox.y=(M=(S=g.clipBBox)==null?void 0:S.y)!=null?M:g.y,this.horizontal?(p.height=p.clipBBox.height=f.height,p.width=f===g?f.width:f.x+f.width,p.clipBBox.width=p.width-(f.width-((A=(D=f.clipBBox)==null?void 0:D.width)!=null?A:f.width)),p.topLeftCornerRadius=g.topLeftCornerRadius,p.bottomLeftCornerRadius=g.bottomLeftCornerRadius,p.topRightCornerRadius=f.topRightCornerRadius,p.bottomRightCornerRadius=f.bottomRightCornerRadius):(p.width=p.clipBBox.width=f.width,p.height=f===g?f.height:f.x+f.height,p.clipBBox.height=p.height-(f.height-((T=(w=f.clipBBox)==null?void 0:w.height)!=null?T:f.height)),p.topLeftCornerRadius=g.topLeftCornerRadius,p.topRightCornerRadius=g.topRightCornerRadius,p.bottomLeftCornerRadius=f.bottomLeftCornerRadius,p.bottomRightCornerRadius=f.bottomRightCornerRadius)})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>DV(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,{scale:i}=this.properties,{fillOpacity:s,stroke:n,strokeOpacity:a,strokeWidth:r,lineDash:o,lineDashOffset:l}=i,c=this.getShapeFillBBox();t.each((h,d)=>{const{topLeftCornerRadius:u,topRightCornerRadius:p,bottomRightCornerRadius:g,bottomLeftCornerRadius:f,fill:y}=d;h.fill=y,h.fillBBox=c,h.fillOpacity=s,h.stroke=n,h.strokeOpacity=a,h.strokeWidth=r,h.lineDash=o,h.lineDashOffset=l,h.topLeftCornerRadius=u,h.topRightCornerRadius=p,h.bottomRightCornerRadius=g,h.bottomLeftCornerRadius=f,h.setProperties(hC(h,d))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetNodes(e){const{targetSelection:t,isHighlight:i}=e,s=i?this.properties.highlightStyle.item:void 0;t.each((n,a)=>{var x,S,M,D,A,w,T;const{x:r,y:o,shape:l,size:c,rotation:h,fill:d,fillOpacity:u,stroke:p,strokeOpacity:g,strokeWidth:f,lineDash:y,lineDashOffset:v}=a;n.size=c,n.shape=l==="line"?mV:l,n.fill=(x=s==null?void 0:s.fill)!=null?x:d,n.fillOpacity=(S=s==null?void 0:s.fillOpacity)!=null?S:u,n.stroke=(M=s==null?void 0:s.stroke)!=null?M:p,n.strokeOpacity=(D=s==null?void 0:s.strokeOpacity)!=null?D:g,n.strokeWidth=(A=s==null?void 0:s.strokeWidth)!=null?A:f,n.lineDash=(w=s==null?void 0:s.lineDash)!=null?w:y,n.lineDashOffset=(T=s==null?void 0:s.lineDashOffset)!=null?T:v,n.translationX=r,n.translationY=o,n.rotation=h})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,s)=>{const{x:n,y:a,text:r}=s,{offsetX:o,offsetY:l,fill:c,fontStyle:h,fontWeight:d,fontSize:u,fontFamily:p,textAlign:g,textBaseline:f}=s.label;i.visible=!0,i.x=n+o,i.y=a+l,i.text=r,i.fill=c,i.fontStyle=h,i.fontWeight=d,i.fontSize=u,i.fontFamily=p,i.textAlign=g,i.textBaseline=f})}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.tickId)}updateTickNodes(e){var v;const{gaugeRect:t,properties:i}=this,s=i.defaultScale,{enabled:n,color:a,fontFamily:r=s.label.fontFamily,fontSize:o=s.label.fontSize,fontStyle:l,fontWeight:c=s.label.fontWeight,spacing:h}=i.scale.label;let{placement:d}=i.scale.label;const u=wV((v=i.scale.label.rotation)!=null?v:0);let p,g,f,y;this.horizontal?(d!=null||(d="after"),p="center",g=d==="before"?"bottom":"top",y=this.originY+t.y+(d==="before"?-h:t.height+h)):(d!=null||(d="before"),p=d==="before"?"end":"start",g="middle",f=this.originX+t.x+(d==="before"?-h:t.width+h)),e.tickSelection.each((x,S)=>{if(!n){x.visible=!1;return}const M=f!=null?f:S.translationY,D=y!=null?y:S.translationY;x.visible=!0,x.text=S.tickLabel,x.fill=a,x.fontFamily=r,x.fontSize=o,x.fontStyle=l,x.fontWeight=c,x.textBaseline=g,x.textAlign=p,x.x=M,x.y=D,x.rotationCenterX=M,x.rotationCenterY=D,x.rotation=u})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>"primary")}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((s,n)=>{s.fill=n.fill,s.fontStyle=n.fontStyle,s.fontWeight=n.fontWeight,s.fontFamily=n.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){var g;const{labelSelection:t,horizontal:i,scale:s,seriesRect:n,gaugeRect:a}=this,{x:r,y:o,width:l,height:c}=a,h=(g=e==null?void 0:e.label)!=null?g:this.properties.value;let d;if(i){const f=s.convert(h);d=new kc(r,o,f-r,c)}else{const f=s.convert(h);d=new kc(r,f,l,c-f)}const u={seriesRect:n,gaugeRect:a,barRect:d},{margin:p}=this.properties;aCe(this,this.ctx,t,{padding:p,horizontal:i},u,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),rCe([this.datumSelection],hC),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){var n;const{animationManager:t}=this.ctx;let i=0,s=0;if(this.labelSelection.each((a,r)=>{var o,l,c;a.opacity=1,i=(c=(l=(o=a.previousDatum)==null?void 0:o.value)!=null?l:e.from)!=null?c:r.value,s=r.value}),!this.labelsHaveExplicitText())if(i===s)this.formatLabelText({label:s});else{const a=`${this.id}_labels`;t.animate({id:a,groupId:"label",from:{label:i},to:{label:s},phase:(n=e.phase)!=null?n:"update",ease:fCe.easeOut,onUpdate:r=>this.formatLabelText(r)})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=SV(!0,this.horizontal);ZI(this.id,"node",e,[this.datumSelection],t,(i,s)=>s.itemId),ZI(this.id,"label",e,[this.labelSelection],gV,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=SV(!1,this.horizontal);ZI(this.id,"node",e,[this.datumSelection],t,(i,s)=>s.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[0,1]}getSeriesRange(e,t){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:s}=i;let n,a;if(e.type===0?(n=i.value,a=i.label.text):{value:n,text:a}=i.targets[e.index],n!=null)return this.formatTooltipWithContext(s,{data:[{label:a,fallbackLabel:"Value",value:this.formatLabel(n)}]},{seriesId:t,title:void 0,datum:void 0,value:n})}pickNodeClosestDatum(e){return yV(this,e)}pickFocus(e){return vV(this,e)}getCaptionText(){return this.formatLabel(this.properties.value)}getCategoryValue(e){}datumIndexForCategoryValue(e){}};dC.className="LinearGaugeSeries",dC.type="linear-gauge";var CCe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"linear-gauge",moduleFactory:e=>new dC(e),tooltipDefaults:{range:10},themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{thickness:50,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},R.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./2",R.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},label:{spacing:11}},bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},defaultScale:{label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},label:{enabled:!1,placement:"inside-start",fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[2]},minimumFontSize:12,spacing:18,color:{$ref:"backgroundColor"}},margin:4}}},SCe={type:"series",name:"linear-gauge",chartType:"gauge",enterprise:!0,options:R.linearGaugeSeriesOptionsDef,create:e=>new dC(e)},ym={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer",buttons:{anchorPointX:"middle",anchorPointY:"middle"}},legend:{enabled:!1},gradientLegend:{enabled:!1}},MCe=1e-9;function TV(e,t,i,s){const[n,a]=e,[r,o]=t,l=r-n,c=o-a,h=l*l+c*c;let d,u;if(Math.abs(h)<MCe)d=n,u=a;else{let f=((i-n)*l+(s-a)*c)/h;f=Math.max(0,Math.min(1,f)),d=n+f*(r-n),u=a+f*(o-a)}const p=i-d,g=s-u;return p*p+g*g}function kV(e,t,i){let s=1/0,n=e[e.length-1];for(const a of e)s=Math.min(s,TV(n,a,t,i)),n=a;return Math.sqrt(s)}function qI(e){let[t,i]=e[0],s=0;for(let n=1;n<e.length;n+=1){const[a,r]=e[n],o=Math.hypot(a-t,r-i);s+=o,t=a,i=r}return s}function uC(e){if(e.length===0)return;const t=qI(e)/2;let[i,s]=e[0],n=0;for(let a=1;a<e.length;a+=1){const[r,o]=e[a],l=Math.hypot(r-i,o-s),c=n+l;if(c>t){const h=(t-n)/l,d=[i+(r-i)*h,s+(o-s)*h],u=Math.atan2(o-s,r-i);return{point:d,angle:u}}n=c,i=r,s=o}}var{LonLatBBox:DCe}=R;function vm(e,t,i,s,n){return e==null?e=new DCe(t,i,s,n):(e.lon0=Math.min(e.lon0,t),e.lat0=Math.min(e.lat0,i),e.lon1=Math.max(e.lon1,s),e.lat1=Math.max(e.lat1,n)),e}function Dd(e,t){return e.forEach(i=>{const[s,n]=i;t=vm(t,s,n,s,n)}),t}function wCe(e){if(e.length===0)return;let t=0,i=0,s=0,[n,a]=e[e.length-1];for(const[r,o]of e){const l=n*o-r*a;s+=l,t+=(n+r)*l,i+=(a+o)*l,n=r,a=o}return s*=3,[t/s,i/s]}function pC(e,t,i){let s=!1,n=1/0;for(const a of e){let r=a[a.length-1],[o,l]=r;for(const c of a){const[h,d]=c;d>i!=l>i&&t<(o-h)*(i-d)/(l-d)+h&&(s=!s),n=Math.min(n,TV(r,c,t,i)),r=c,o=h,l=d}}return(s?-1:1)*Math.sqrt(n)}var{Path:ACe,ExtendedPath2D:ICe,BBox:TCe,SceneChangeDetection:kCe,SceneObjectChangeDetection:LCe,objectsEqual:PCe}=R,Ap=class extends ACe{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new ICe}computeBBox(){var e;return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),(e=this.bbox)==null?void 0:e.clone()}updatePath(){const{projectedGeometry:e}=this;this.strokePath.clear(),this.path.clear(),this.bbox=e!=null?this.drawGeometry(e,void 0):void 0}drawPath(e){super.drawPath(e),this.renderStroke(e,this.strokePath.getPath2D())}containsPoint(e,t){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(e,t)?!1:this.geometryDistance(i,e,t)<=0}distanceSquared(e,t){const{projectedGeometry:i}=this;if(i==null)return 1/0;const s=this.geometryDistance(i,e,t);return s>0?s*s:0}geometryDistance(e,t,i){const{renderMode:s,strokeWidth:n}=this,a=(s&1)!==0,r=(s&2)!==0,o=Math.max(n/2,1)+1;switch(e.type){case"GeometryCollection":return e.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,t,i)),1/0);case"MultiPolygon":return a?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(pC(c,t,i),0)),1/0):1/0;case"Polygon":return a?Math.max(pC(e.coordinates,t,i),0):1/0;case"MultiLineString":return r?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(kV(c,t,i)-o,0)),1/0):1/0;case"LineString":return r?Math.max(kV(e.coordinates,t,i)-o,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}drawGeometry(e,t){const{renderMode:i,path:s,strokePath:n}=this,a=(i&1)!==0,r=(i&2)!==0;switch(e.type){case"GeometryCollection":e.geometries.forEach(o=>{t=this.drawGeometry(o,t)});break;case"MultiPolygon":a&&e.coordinates.forEach(o=>{t=this.drawPolygon(s,o,t)});break;case"Polygon":a&&(t=this.drawPolygon(s,e.coordinates,t));break;case"LineString":r&&(t=this.drawLineString(n,e.coordinates,t,!1));break;case"MultiLineString":r&&e.coordinates.forEach(o=>{t=this.drawLineString(n,o,t,!1)});break;case"Point":case"MultiPoint":break}return t}drawPolygon(e,t,i){if(t.length<1)return i;i=this.drawLineString(e,t[0],i,!0);for(let s=1;s<t.length;s+=1){const n=t[s];this.drawLineString(e,n,void 0,!0)}return i}drawLineString(e,t,i,s){if(t.length<2)return i;const n=s?t.length-1:t.length;for(let a=0;a<n;a+=1){const[r,o]=t[a];if(a===0?e.moveTo(r,o):e.lineTo(r,o),i==null)i=new TCe(r,o,0,0);else{const{x:l,y:c}=i,h=l+i.width,d=c+i.height;i.x=Math.min(l,r),i.y=Math.min(c,o),i.width=Math.max(h,r)-i.x,i.height=Math.max(d,o)-i.y}}return s&&e.closePath(),i}};C([LCe({equals:PCe})],Ap.prototype,"projectedGeometry",2),C([kCe()],Ap.prototype,"renderMode",2);function Ip(e,t){if(e.bbox!=null){const[i,s,n,a]=e.bbox;return t=vm(t,i,s,n,a),t}switch(e.type){case"GeometryCollection":e.geometries.forEach(i=>{t=Ip(i,t)});break;case"MultiPolygon":e.coordinates.forEach(i=>{i.length>0&&(t=Dd(i[0],t))});break;case"Polygon":e.coordinates.length>0&&(t=Dd(e.coordinates[0],t));break;case"MultiLineString":e.coordinates.forEach(i=>{t=Dd(i,t)});break;case"LineString":t=Dd(e.coordinates,t);break;case"MultiPoint":e.coordinates.forEach(i=>{const[s,n]=i;t=vm(t,s,n,s,n)});break;case"Point":{const[i,s]=e.coordinates;t=vm(t,i,s,i,s);break}}return t}function gC(e){switch(e.type){case"GeometryCollection":{let t,i;return e.geometries.forEach(s=>{const n=gC(s);if(n==null)return;const a=Dd(n[0],void 0);if(a==null)return;const r=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(t==null||r>t)&&(t=r,i=n)}),i}case"MultiPolygon":{let t,i;return e.coordinates.forEach(s=>{const n=Dd(s[0],void 0);if(n==null)return;const a=Math.abs(n.lat1-n.lat0)*Math.abs(n.lon1-n.lon0);(t==null||a>t)&&(t=a,i=s)}),i}case"Polygon":return e.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function fC(e){switch(e.type){case"GeometryCollection":{let t,i;return e.geometries.forEach(s=>{const n=fC(s);if(n==null)return;const a=qI(n);a!=null&&(t==null||a>t)&&(t=a,i=n)}),i}case"MultiLineString":{let t=0,i;return e.coordinates.forEach(s=>{const n=qI(s);n>t&&(t=n,i=s)}),i}case"LineString":return e.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function QI(e,t){if(e==null)return!1;switch(e.type){case"GeometryCollection":return e.geometries.some(i=>QI(i,t));case"MultiPolygon":case"Polygon":return(t&1)!==0;case"MultiLineString":case"LineString":return(t&2)!==0;case"MultiPoint":case"Point":return(t&4)!==0}}function Lc(e,t){switch(e.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:e.geometries.map(i=>Lc(i,t))};case"Polygon":return{type:"Polygon",coordinates:JI(e.coordinates,t)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:ECe(e.coordinates,t)};case"MultiLineString":return{type:"MultiLineString",coordinates:JI(e.coordinates,t)};case"LineString":return{type:"LineString",coordinates:eT(e.coordinates,t)};case"MultiPoint":return{type:"MultiPoint",coordinates:eT(e.coordinates,t)};case"Point":return{type:"Point",coordinates:t.convert(e.coordinates)}}}function ECe(e,t){return e.map(i=>JI(i,t))}function JI(e,t){return e.map(i=>eT(i,t))}function eT(e,t){return e.map(i=>t.convert(i))}function RCe(){return{fromFn:(i,s,n)=>n==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,s,n)=>n==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function LV(e,t){var s;const i=(s=e.contextNodeData)==null?void 0:s.nodeData[t.datumIndex];if(i!==void 0){for(const n of e.datumSelection.nodes())if(n.datum===i)return n}}var uIe=class extends R.SeriesProperties{},bm=class extends R.DataModelSeries{addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",e=>{this.onLegendItemClick(e)}),this.ctx.chartEventManager.addListener("legend-item-double-click",e=>{this.onLegendItemDoubleClick(e)}))}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}},{Property:fi,SeriesProperties:NCe,SeriesTooltip:OCe,Label:FCe}=R,si=class extends NCe{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new FCe,this.tooltip=new OCe}};C([fi],si.prototype,"topology",2),C([fi],si.prototype,"title",2),C([fi],si.prototype,"legendItemName",2),C([fi],si.prototype,"idKey",2),C([fi],si.prototype,"topologyIdKey",2),C([fi],si.prototype,"idName",2),C([fi],si.prototype,"labelKey",2),C([fi],si.prototype,"labelName",2),C([fi],si.prototype,"sizeKey",2),C([fi],si.prototype,"sizeName",2),C([fi],si.prototype,"colorKey",2),C([fi],si.prototype,"colorName",2),C([fi],si.prototype,"sizeDomain",2),C([fi],si.prototype,"colorRange",2),C([fi],si.prototype,"maxStrokeWidth",2),C([fi],si.prototype,"stroke",2),C([fi],si.prototype,"strokeOpacity",2),C([fi],si.prototype,"strokeWidth",2),C([fi],si.prototype,"lineDash",2),C([fi],si.prototype,"lineDashOffset",2),C([fi],si.prototype,"itemStyler",2),C([fi],si.prototype,"label",2),C([fi],si.prototype,"tooltip",2);var{getMissCount:BCe,createDatumId:PV,SeriesNodePickMode:EV,valueProperty:xm,CachedTextMeasurerPool:_Ce,ColorScale:GCe,LinearScale:zCe,Selection:tT,Text:VCe,Transformable:jCe}=R,mC=class extends bm{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[EV.EXACT_SHAPE_MATCH,EV.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new si,this._chartTopology=void 0,this.colorScale=new GCe,this.sizeScale=new zCe,this.datumSelection=tT.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=tT.select(this.labelGroup,VCe),this.highlightDatumSelection=tT.select(this.highlightNode,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){var e;return(e=this.contextNodeData)==null?void 0:e.nodeData}get topology(){var e;return(e=this.properties.topology)!=null?e:this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[2,e],!0):!1}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new Ap;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e}async processData(e){var S,M;if(this.data==null)return;const{data:t,topology:i,sizeScale:s,colorScale:n}=this,{topologyIdKey:a,idKey:r,sizeKey:o,colorKey:l,labelKey:c,sizeDomain:h,colorRange:d}=this.properties,u=new Map;i==null||i.features.forEach(D=>{var w;const A=(w=D.properties)==null?void 0:w[a];A==null||!QI(D.geometry,2)||u.set(A,D)});const p=this.sizeScale.type,g=this.colorScale.type,f=(S=this.scale)==null?void 0:S.type,{dataModel:y,processedData:v}=await this.requestDataModel(e,t,{props:[xm(r,f,{id:"idValue",includeProperty:!1}),xm(r,f,{id:"featureValue",includeProperty:!1,processor:()=>D=>u.get(D)}),...c!=null?[xm(c,"band",{id:"labelValue"})]:[],...o!=null?[xm(o,p,{id:"sizeValue"})]:[],...l!=null?[xm(l,g,{id:"colorValue"})]:[]]}),x=y.resolveColumnById(this,"featureValue",v);if(this.topologyBounds=x.reduce((D,A)=>{const w=A==null?void 0:A.geometry;return w==null?D:Ip(w,D)},void 0),o!=null){const D=y.resolveProcessedDataIndexById(this,"sizeValue"),A=(M=v.domain.values[D])!=null?M:[];s.domain=h!=null?h:A}if(d!=null&&this.isColorScaleValid()){const D=y.resolveProcessedDataIndexById(this,"colorValue");n.domain=v.domain.values[D],n.range=d,n.update()}i==null&&se.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,a=BCe(this,i.defs.values[s].missing);return!(n===0||n===a)}getLabelDatum(e,t,i,s){if(t==null||i==null)return;const n=fC(i);if(n==null)return;const{idKey:a,idName:r,sizeKey:o,sizeName:l,colorKey:c,colorName:h,labelKey:d,labelName:u,label:p}=this.properties,g=this.getLabelText(p,{value:t,datum:e,idKey:a,idName:r,sizeKey:o,sizeName:l,colorKey:c,colorName:h,labelKey:d,labelName:u});if(g==null)return;const f=_Ce.measureText(String(g),{font:s}),y=uC(n);if(y==null)return;const[v,x]=y.point,{width:S,height:M}=f;return{point:{x:v,y:x,size:0},label:{width:S,height:M,text:g},anchor:void 0,placement:void 0}}createNodeData(){var T,k,N;const{id:e,dataModel:t,processedData:i,sizeScale:s,properties:n,scale:a}=this,{idKey:r,sizeKey:o,colorKey:l,labelKey:c,label:h}=n;if(t==null||i==null)return;const d=t.resolveColumnById(this,"idValue",i),u=t.resolveColumnById(this,"featureValue",i),p=c!=null?t.resolveColumnById(this,"labelValue",i):void 0,g=o!=null?t.resolveColumnById(this,"sizeValue",i):void 0,f=l!=null?t.resolveColumnById(this,"colorValue",i):void 0,y=(T=n.maxStrokeWidth)!=null?T:n.strokeWidth;s.range=[Math.min(n.strokeWidth,y),y];const v=h.getFont(),x=new Map;(k=i.dataSources.get(this.id))==null||k.forEach((O,L)=>{var G,V;const F=d[L],B=(V=(G=u[L])==null?void 0:G.geometry)!=null?V:void 0,_=B!=null&&a!=null?Lc(B,a):void 0;F!=null&&_!=null&&x.set(F,_)});const S=[],M=[],D=[];((N=i.dataSources.get(this.id))!=null?N:[]).forEach((O,L)=>{const F=d[L],B=f==null?void 0:f[L],_=g==null?void 0:g[L],G=p==null?void 0:p[L],V=x.get(F);V==null&&D.push(F);const j=this.getLabelDatum(O,G,V,v);j!=null&&M.push(j),S.push({series:this,itemId:r,datum:O,datumIndex:L,idValue:F,labelValue:G,colorValue:B,sizeValue:_,projectedGeometry:V})});const w=10;if(D.length>w){const O=D.length-w;D.length=w,D.push(`(+${O} more)`)}return D.length>0&&se.warnOnce("some data items do not have matches in the provided topology",D),{itemId:e,nodeData:S,labelData:M}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){var n,a,r;const{datumSelection:e,highlightDatumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let i=(n=this.ctx.highlightManager)==null?void 0:n.getActiveHighlight();i!=null&&(i.series!==this||i.datum==null)&&(i=void 0);const s=(r=(a=this.contextNodeData)==null?void 0:a.nodeData)!=null?r:[];this.datumSelection=this.updateDatumSelection({nodeData:s,datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:i!=null?[i]:[],datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!0})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>PV(t.idValue))}getItemBaseStyle(e){var s,n,a,r,o;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return{stroke:(s=i==null?void 0:i.stroke)!=null?s:t.stroke,strokeWidth:(n=i==null?void 0:i.strokeWidth)!=null?n:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(a=i==null?void 0:i.strokeOpacity)!=null?a:t.strokeOpacity,lineDash:(r=i==null?void 0:i.lineDash)!=null?r:t.lineDash,lineDashOffset:(o=i==null?void 0:i.lineDashOffset)!=null?o:t.lineDashOffset}}getItemStyleOverrides(e,t,i,s,n,a){var p;const{id:r,properties:o,colorScale:l,sizeScale:c}=this,{colorRange:h,itemStyler:d}=o;let u;if(!a&&i!=null&&(u!=null||(u={}),u.stroke=this.isColorScaleValid()?l.convert(i):(p=h==null?void 0:h[0])!=null?p:o.stroke),s!=null&&(u!=null||(u={}),u.strokeWidth=c.convert(s,{clamp:!0})),d!=null){const g=this.cachedDatumCallback(PV(e,a?"highlight":"node"),()=>this.callWithContext(d,b(b({seriesId:r,datum:t,highlighted:a},n),u)));u!=null||(u={}),Object.assign(u,g)}return u}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getItemBaseStyle(i);t.each((n,a)=>{var u,p,g,f,y;const{datum:r,datumIndex:o,colorValue:l,sizeValue:c,projectedGeometry:h}=a;if(h==null){n.visible=!1,n.projectedGeometry=void 0;return}const d=this.getItemStyleOverrides(String(o),r,l,c,s,i);n.visible=!0,n.projectedGeometry=h,n.stroke=(u=d==null?void 0:d.stroke)!=null?u:s.stroke,n.strokeWidth=(p=d==null?void 0:d.strokeWidth)!=null?p:s.strokeWidth,n.strokeOpacity=(g=d==null?void 0:d.strokeOpacity)!=null?g:s.strokeOpacity,n.lineDash=(f=d==null?void 0:d.lineDash)!=null?f:s.lineDash,n.lineDashOffset=(y=d==null?void 0:d.lineDashOffset)!=null?y:s.lineDashOffset})}updatePlacedLabelData(e){this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=R.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:s,fontWeight:n,fontSize:a,fontFamily:r}=this.properties.label;t.each((o,{x:l,y:c,width:h,height:d,text:u})=>{o.visible=!0,o.x=l+h/2,o.y=c+d/2,o.text=u,o.fill=i,o.fontStyle=s,o.fontWeight=n,o.fontSize=a,o.fontFamily=r,o.textAlign="center",o.textBaseline="middle"})}resetAnimation(){}getLabelData(){var e,t;return this.isLabelEnabled()?(t=(e=this.contextNodeData)==null?void 0:e.labelData)!=null?t:[]:[]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.datumSelection.each((n,a)=>{const r=n.distanceSquared(e,t);r<i&&(i=r,s=a)}),s!=null?{datum:s,distance:Math.sqrt(i)}:void 0}datumMidPoint(e){var r;const{_previousDatumMidPoint:t}=this;if((t==null?void 0:t.datum)===e)return t.point;const i=e.projectedGeometry,s=i!=null?fC(i):void 0,n=s!=null?(r=uC(s))==null?void 0:r.point:void 0,a=n!=null?{x:n[0],y:n[1]}:void 0;return this._previousDatumMidPoint={datum:e,point:a},a}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:s}=this,{strokeWidth:n,strokeOpacity:a,lineDash:r}=s;let{stroke:o}=s;if(e!=null&&this.isColorScaleValid()){const c=t.resolveColumnById(this,"colorValue",i)[e];o=this.colorScale.convert(c)}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,lineDash:[0],lineDashOffset:0,enabled:!1},line:{stroke:o,strokeWidth:n,strokeOpacity:a,lineDash:r}}}getLegendData(e){var p,g;const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:s,visible:n}=this,{title:a,legendItemName:r,idKey:o,idName:l,colorKey:c,colorName:h,colorRange:d,showInLegend:u}=this.properties;if(e==="gradient"&&c!=null&&d!=null){const f=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:n,seriesId:s,colorName:h,colorRange:d,colorDomain:f}]}else return e==="category"?[{legendType:"category",id:s,itemId:s,seriesId:s,enabled:n,label:{text:(g=(p=r!=null?r:a)!=null?p:l)!=null?g:o},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!u}]:[]}getTooltipContent(e){var A;const{id:t,dataModel:i,processedData:s,properties:n}=this,{idKey:a,idName:r,colorKey:o,colorName:l,sizeKey:c,sizeName:h,labelKey:d,labelName:u,title:p,legendItemName:g,tooltip:f}=n;if(!i||!s)return;const y=(A=s.dataSources.get(this.id))==null?void 0:A[e],v=i.resolveColumnById(this,"idValue",s),x=[],S=c!=null?i.resolveColumnById(this,"sizeValue",s)[e]:void 0,M=o!=null?i.resolveColumnById(this,"colorValue",s)[e]:void 0;if(c!=null&&x.push({label:h,fallbackLabel:c,value:String(S)}),o!=null&&x.push({label:l,fallbackLabel:o,value:String(M)}),d!=null&&d!==a){const w=i.resolveColumnById(this,"labelValue",s)[e];x.push({label:u,fallbackLabel:d,value:w})}const D=this.getItemBaseStyle(!1);return Object.assign(D,this.getItemStyleOverrides(String(e),e,M,S,D,!1)),this.formatTooltipWithContext(f,{heading:v[e],title:p!=null?p:g,symbol:this.legendItemSymbol(e),data:x},b({seriesId:t,datum:y,title:p,idKey:a,idName:r,colorKey:o,colorName:l,sizeKey:c,sizeName:h,labelKey:d,labelName:u},D))}computeFocusBounds(e){const t=LV(this,e);return t?jCe.toCanvas(this.contentGroup,t.getBBox()):void 0}};mC.className="MapLineSeries",mC.type="map-line";var{commonSeriesOptionsDefs:HCe,mapLineSeriesThemeableOptionsDef:WCe,without:UCe}=R,RV=E(b(b({},WCe),UCe(HCe,["highlightStyle"])),{type:ee(Oe("map-line")),idKey:ee(z),sizeKey:z,colorKey:z,labelKey:z,idName:z,sizeName:z,colorName:z,labelName:z,topology:Kd,topologyIdKey:z,legendItemName:z,title:z});RV.colorRange=Ce(Pt(Ie(ye),jd(1)));var KCe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",moduleFactory:e=>new mC(e),tooltipDefaults:{range:"exact"},themeTemplate:E(b({},ym),{series:{stroke:R.SAFE_STROKE_FILL_OPERATION,colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},R.SAFE_RANGE2_OPERATION]},strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},tooltip:{range:"exact"}})},$Ce={type:"series",name:"map-line",chartType:"topology",enterprise:!0,options:RV,create:e=>new mC(e)},{Property:wd,SeriesProperties:YCe,SeriesTooltip:XCe}=R,Pc=class extends YCe{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new XCe}};C([wd],Pc.prototype,"topology",2),C([wd],Pc.prototype,"stroke",2),C([wd],Pc.prototype,"strokeOpacity",2),C([wd],Pc.prototype,"strokeWidth",2),C([wd],Pc.prototype,"lineDash",2),C([wd],Pc.prototype,"lineDashOffset",2),C([wd],Pc.prototype,"tooltip",2);var{createDatumId:ZCe,SeriesNodePickMode:qCe,Group:QCe,Selection:JCe,PointerEvents:eSe}=R,yC=class extends bm{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[qCe.EXACT_SHAPE_MATCH]}),this.properties=new Pc,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new QCe({name:"itemGroup"})),this.datumSelection=JCe.select(this.itemGroup,()=>this.nodeFactory())}getNodeData(){var e;return(e=this.contextNodeData)==null?void 0:e.nodeData}get topology(){var e;return(e=this.properties.topology)!=null?e:this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0):!1}nodeFactory(){const e=new Ap;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e.pointerEvents=eSe.None,e}processData(){const{topology:e}=this;this.topologyBounds=e==null?void 0:e.features.reduce((t,i)=>{const s=i.geometry;return s==null?t:Ip(s,t)},void 0),e==null&&se.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i}=this;if(t==null)return;const s=[],n=[];return t.features.forEach((a,r)=>{const{geometry:o}=a,l=o!=null&&i!=null?Lc(o,i):void 0;l!=null&&s.push({series:this,itemId:r,datum:a,datumIndex:0,index:r,projectedGeometry:l})}),{itemId:e,nodeData:s,labelData:n}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){var i;const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:t=[]}=(i=this.contextNodeData)!=null?i:{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>ZCe(t.index))}updateDatumNodes(e){const{properties:t}=this,{datumSelection:i}=e,{stroke:s,strokeOpacity:n,lineDash:a,lineDashOffset:r}=t,o=this.getStrokeWidth(t.strokeWidth);i.each((l,c)=>{const{projectedGeometry:h}=c;if(h==null){l.visible=!1,l.projectedGeometry=void 0;return}l.visible=!0,l.projectedGeometry=h,l.stroke=s,l.strokeWidth=o,l.strokeOpacity=n,l.lineDash=a,l.lineDashOffset=r})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}computeFocusBounds(e){}};yC.className="MapLineBackgroundSeries",yC.type="map-line-background";var{mapLineBackgroundSeriesThemeableOptionsDef:tSe}=R,iSe=E(b({},tSe),{type:ee(Oe("map-line-background")),topology:Kd}),sSe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",moduleFactory:e=>new yC(e),tooltipDefaults:{range:"exact"},themeTemplate:E(b({},ym),{series:{stroke:{$path:["./1",{$palette:"stroke"},{$palette:"secondHierarchyColors"}]},strokeWidth:1,lineDash:[0],lineDashOffset:0}})},nSe={type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,options:iSe,create:e=>new yC(e)},aSe=(e,t,i)=>{let s=e,n=s;for(const a of t)if(s==null||i(s.value,a)>0)s={value:a,next:s},n=s;else{for(n=n;n.next!=null&&i(n.next.value,a)<=0;)n=n.next;n.next={value:a,next:n.next}}return s};function NV(e,t,i){const s=Dd(e[0],void 0);if(s==null)return;const n=(s.lon0+s.lon1)/2,a=(s.lat0+s.lat1)/2,r=Math.abs(s.lon1-s.lon0),o=Math.abs(s.lat1-s.lat0),l=wCe(e[0]),[c,h]=l,d=-pC(e,c,h);let u;const p=(D,A)=>{const T=Math.max(A-d,0);return D-.5*T},g=(D,A,w)=>{const{distance:T,maxDistance:k}=i(e,D,A,w),N=Math.hypot(c-D,h-A),O=Math.min(Math.max(c,D-w/2),D+w/2),L=Math.min(Math.max(h,A-w/2),A+w/2),F=Math.hypot(c-O,h-L),B=p(T,N),_=p(k,F);return{distance:T,maxDistance:k,value:B,maxValue:_,x:D,y:A,stride:w}},f=(D,A,w,T)=>{const k=g(A,w,T);k.maxDistance>=0&&D.push(k)},y=Math.min(r,o)/2;let v={value:g(n,a,y),next:null};for(;v!=null;){const D=v.value,{distance:A,value:w,maxValue:T,x:k,y:N,stride:O}=D;if(v=v.next,A>0&&(u==null||w>u.value)&&(u=D),u!=null&&T-u.value<=t)continue;const L=O/2,F=[];f(F,k-L,N-L,L),f(F,k+L,N-L,L),f(F,k-L,N+L,L),f(F,k+L,N+L,L),F.sort(OV),v=aSe(v,F,OV)}if(u==null)return;const{distance:x,x:S,y:M}=u;return{x:S,y:M,distance:x}}var OV=(e,t)=>t.maxValue-e.maxValue;function iT(e,t){const i=NV(e,t,(a,r,o,l)=>{const c=-pC(a,r,o),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:s,y:n}=i;return[s,n]}function FV(e,t){var s,n;let i;switch(e.type){case"GeometryCollection":return e.geometries.flatMap(a=>FV(a,t));case"MultiPoint":return e.coordinates;case"Point":return[e.coordinates];case"MultiPolygon":{const a=gC(e);i=a!=null?iT(a,t):void 0;break}case"Polygon":{const a=e.coordinates;i=a!=null?iT(a,t):void 0;break}case"MultiLineString":{const a=fC(e);i=a!=null?(s=uC(a))==null?void 0:s.point:void 0;break}case"LineString":{const a=e.coordinates;i=(n=uC(a))==null?void 0:n.point;break}}return i!=null?[i]:[]}var{BBox:rSe}=R;function BV(e){if(!e)return;const{range:t}=e,i=t[0][0],s=t[0][1],n=t[1][0]-i,a=t[1][1]-s,r=new rSe(i,s,n,a);return{series:r,axis:r}}var{FillGradientDefaults:oSe,FillPatternDefaults:lSe,FillImageDefaults:cSe,Property:rt,SeriesProperties:hSe,SeriesTooltip:dSe,Label:uSe}=R,_V=class extends uSe{constructor(){super(...arguments),this.placement="bottom"}};C([rt],_V.prototype,"placement",2);var ot=class extends hSe{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillGradientDefaults=new oSe,this.fillPatternDefaults=new lSe,this.fillImageDefaults=new cSe,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new _V,this.tooltip=new dSe}};C([rt],ot.prototype,"topology",2),C([rt],ot.prototype,"title",2),C([rt],ot.prototype,"legendItemName",2),C([rt],ot.prototype,"idKey",2),C([rt],ot.prototype,"topologyIdKey",2),C([rt],ot.prototype,"idName",2),C([rt],ot.prototype,"latitudeKey",2),C([rt],ot.prototype,"latitudeName",2),C([rt],ot.prototype,"longitudeKey",2),C([rt],ot.prototype,"longitudeName",2),C([rt],ot.prototype,"labelKey",2),C([rt],ot.prototype,"labelName",2),C([rt],ot.prototype,"sizeKey",2),C([rt],ot.prototype,"sizeName",2),C([rt],ot.prototype,"colorKey",2),C([rt],ot.prototype,"colorName",2),C([rt],ot.prototype,"colorRange",2),C([rt],ot.prototype,"shape",2),C([rt],ot.prototype,"size",2),C([rt],ot.prototype,"maxSize",2),C([rt],ot.prototype,"sizeDomain",2),C([rt],ot.prototype,"fill",2),C([rt],ot.prototype,"fillGradientDefaults",2),C([rt],ot.prototype,"fillPatternDefaults",2),C([rt],ot.prototype,"fillImageDefaults",2),C([rt],ot.prototype,"fillOpacity",2),C([rt],ot.prototype,"stroke",2),C([rt],ot.prototype,"strokeWidth",2),C([rt],ot.prototype,"strokeOpacity",2),C([rt],ot.prototype,"lineDash",2),C([rt],ot.prototype,"lineDashOffset",2),C([rt],ot.prototype,"itemStyler",2),C([rt],ot.prototype,"label",2),C([rt],ot.prototype,"tooltip",2);var{CachedTextMeasurerPool:pSe,fromToMotion:gSe,StateMachine:fSe,getMissCount:mSe,createDatumId:GV,SeriesNodePickMode:zV,valueProperty:Ad,computeMarkerFocusBounds:ySe,ColorScale:vSe,LinearScale:bSe,Group:xSe,Selection:sT,Text:CSe,Marker:nT,applyShapeStyle:SSe,getShapeStyle:VV}=R,vC=class extends bm{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[zV.EXACT_SHAPE_MATCH,zV.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new ot,this._chartTopology=void 0,this.colorScale=new vSe,this.sizeScale=new bSe,this.markerGroup=this.contentGroup.appendChild(new xSe({name:"markerGroup"})),this.labelSelection=sT.select(this.labelGroup,CSe,!1),this.markerSelection=sT.select(this.markerGroup,nT,!1),this.highlightMarkerSelection=sT.select(this.highlightNode,nT),this.animationState=new fSe("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){var e;return(e=this.contextNodeData)==null?void 0:e.nodeData}get topology(){var e;return(e=this.properties.topology)!=null?e:this._chartTopology}get hasData(){const e=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||e)}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[3,e],this.highlightGroup.zIndex=[4,e],!0):!1}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}async processData(e){var T,k,N;if(this.data==null)return;const{data:t,topology:i,sizeScale:s,colorScale:n}=this,{topologyIdKey:a,idKey:r,latitudeKey:o,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:d,sizeDomain:u,colorRange:p}=this.properties,g=new Map;i==null||i.features.forEach(O=>{var F;const L=(F=O.properties)==null?void 0:F[a];L!=null&&g.set(L,O)});const f=this.sizeScale.type,y=this.colorScale.type,v=(T=this.scale)==null?void 0:T.type,x=o!=null&&l!=null,{dataModel:S,processedData:M}=await this.requestDataModel(e,t,{props:[...r!=null?[Ad(r,v,{id:"idValue",includeProperty:!1}),Ad(r,v,{id:"featureValue",includeProperty:!1,processor:()=>O=>g.get(O)})]:[],...x?[Ad(o,v,{id:"latValue"}),Ad(l,v,{id:"lonValue"})]:[],...d?[Ad(d,"band",{id:"labelValue"})]:[],...c?[Ad(c,f,{id:"sizeValue"})]:[],...h?[Ad(h,y,{id:"colorValue"})]:[]]}),D=r!=null?S.resolveColumnById(this,"featureValue",M):void 0,A=x?S.resolveColumnById(this,"latValue",M):void 0,w=x?S.resolveColumnById(this,"lonValue",M):void 0;if(this.topologyBounds=(k=M.dataSources.get(this.id))==null?void 0:k.reduce((O,L,F)=>{const B=D==null?void 0:D[F],_=B==null?void 0:B.geometry;if(_!=null&&(O=Ip(_,O)),A!=null&&w!=null){const G=w[F],V=A[F];O=vm(O,G,V,G,V)}return O},void 0),c!=null){const O=S.resolveProcessedDataIndexById(this,"sizeValue"),L=(N=M.domain.values[O])!=null?N:[];s.domain=u!=null?u:L}if(p!=null&&this.isColorScaleValid()){const O=S.resolveProcessedDataIndexById(this,"colorValue");n.domain=M.domain.values[O],n.range=p,n.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,a=mSe(this,i.defs.values[s].missing);return!(n===0||n===a)}getLabelDatum(e,t,i,s,n,a){if(t==null)return;const{idKey:r,idName:o,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,sizeKey:u,sizeName:p,colorKey:g,colorName:f,labelKey:y,labelName:v,label:x,shape:S}=this.properties,{placement:M}=x,D=this.getLabelText(x,{value:t,datum:e,idKey:r,idName:o,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,sizeKey:u,sizeName:p,colorKey:g,colorName:f,labelKey:y,labelName:v});if(D==null)return;const{width:A,height:w}=pSe.measureText(String(D),{font:a}),T=nT.anchor(S);return{point:{x:i,y:s,size:n},label:{width:A,height:w,text:D},anchor:T,placement:M}}createNodeData(){var F,B,_;const{id:e,dataModel:t,processedData:i,sizeScale:s,properties:n,scale:a}=this,{idKey:r,latitudeKey:o,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:d,label:u}=n;if(t==null||i==null||a==null)return;const p=o!=null&&l!=null,g=r!=null?t.resolveColumnById(this,"idValue",i):void 0,f=r!=null?t.resolveColumnById(this,"featureValue",i):void 0,y=p?t.resolveColumnById(this,"latValue",i):void 0,v=p?t.resolveColumnById(this,"lonValue",i):void 0,x=d!=null?t.resolveColumnById(this,"labelValue",i):void 0,S=c!=null?t.resolveColumnById(this,"sizeValue",i):void 0,M=h!=null?t.resolveColumnById(this,"colorValue",i):void 0,D=(F=n.maxSize)!=null?F:n.size;s.range=[Math.min(n.size,D),D];const A=u.getFont();let w;g!=null&&f!=null&&(w=new Map,(B=i.dataSources.get(this.id))==null||B.forEach((G,V)=>{var $,W;const j=g[V],H=(W=($=f[V])==null?void 0:$.geometry)!=null?W:void 0,U=H!=null&&a!=null?Lc(H,a):void 0;j!=null&&U!=null&&w.set(j,U)}));const T=[],k=[],N=[];((_=i.dataSources.get(this.id))!=null?_:[]).forEach((G,V)=>{const j=g==null?void 0:g[V],H=v==null?void 0:v[V],U=y==null?void 0:y[V],$=M==null?void 0:M[V],W=S==null?void 0:S[V],Y=x==null?void 0:x[V],K=W!=null?s.convert(W,{clamp:!0}):n.size,Q=j!=null?w==null?void 0:w.get(j):void 0;if(j!=null&&Lc==null&&N.push(j),H!=null&&U!=null){const[Z,J]=a.convert([H,U]),ae=this.getLabelDatum(G,Y,Z,J,K,A);ae&&k.push(ae),T.push({series:this,itemId:o,datum:G,datumIndex:V,index:-1,idValue:j,lonValue:H,latValue:U,labelValue:Y,sizeValue:W,colorValue:$,point:{x:Z,y:J,size:K},midPoint:{x:Z,y:J}})}else Q!=null&&FV(Q,1).forEach(([Z,J],ae)=>{const oe=this.getLabelDatum(G,Y,Z,J,K,A);oe&&k.push(oe),T.push({series:this,itemId:o,datum:G,datumIndex:V,index:ae,idValue:j,lonValue:H,latValue:U,labelValue:Y,sizeValue:W,colorValue:$,point:{x:Z,y:J,size:K},midPoint:{x:Z,y:J}})})});const L=10;if(N.length>L){const G=N.length-L;N.length=L,N.push(`(+${G} more)`)}return N.length>0&&se.warnOnce("some data items do not have matches in the provided topology",N),{itemId:e,nodeData:T,labelData:k}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}update({seriesRect:e}){var o,l,c;const t=this.checkResize(e),i=this.checkScaleChange(),{markerSelection:s,highlightMarkerSelection:n}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=(o=this.ctx.highlightManager)==null?void 0:o.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const r=(c=(l=this.contextNodeData)==null?void 0:l.nodeData)!=null?c:[];this.markerSelection=this.updateMarkerSelection({markerData:r,markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!1,highlightedDatum:a}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:a!=null?[a]:[],markerSelection:n}),this.updateMarkerNodes({markerSelection:n,isHighlight:!0,highlightedDatum:a}),(i||t)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(e){this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=R.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:s,fontWeight:n,fontSize:a,fontFamily:r}=this.properties.label;t.each((o,{x:l,y:c,width:h,height:d,text:u})=>{o.visible=!0,o.x=l+h/2,o.y=c+d/2,o.text=u,o.fill=i,o.fontStyle=s,o.fontWeight=n,o.fontSize=a,o.fontFamily=r,o.textAlign="center",o.textBaseline="middle"})}updateMarkerSelection(e){const{markerData:t,markerSelection:i}=e;return i.update(t,void 0,s=>GV([s.index,s.idValue,s.lonValue,s.latValue]))}getMarkerItemBaseStyle(e){var s,n,a,r,o,l,c;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return VV({shape:t.shape,size:t.size,fill:(s=i==null?void 0:i.fill)!=null?s:t.fill,fillOpacity:(n=i==null?void 0:i.fillOpacity)!=null?n:t.fillOpacity,stroke:(a=i==null?void 0:i.stroke)!=null?a:t.stroke,strokeWidth:(r=i==null?void 0:i.strokeWidth)!=null?r:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(o=i==null?void 0:i.strokeOpacity)!=null?o:t.strokeOpacity,lineDash:(l=i==null?void 0:i.lineDash)!=null?l:t.lineDash,lineDashOffset:(c=i==null?void 0:i.lineDashOffset)!=null?c:t.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getMarkerItemStyleOverrides(e,t,i,s,n,a){var p;const{id:r,properties:o,colorScale:l,sizeScale:c}=this,{colorRange:h,itemStyler:d}=o;let u;if(u!=null||(u={}),!a&&i!=null&&(u.fill=this.isColorScaleValid()?l.convert(i):(p=h==null?void 0:h[0])!=null?p:o.fill),s!=null&&(u.size=c.convert(s,{clamp:!0})),d!=null){const g=this.cachedDatumCallback(GV(e,a?"highlight":"node"),()=>this.callWithContext(d,b(b({seriesId:r,datum:t,highlighted:a},n),u)));u!=null||(u={}),Object.assign(u,g)}return u}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i,highlightedDatum:s}=e,n=this.getMarkerItemBaseStyle(i),a=BV(this.scale);t.each((r,o)=>{var g,f;const{datumIndex:l,datum:c,point:h,colorValue:d,sizeValue:u}=o,p=this.getMarkerItemStyleOverrides(String(l),c,d,u,n,i);r.shape=(g=p==null?void 0:p.shape)!=null?g:n.shape,r.size=(f=p==null?void 0:p.size)!=null?f:n.size,SSe(r,n,p,a),r.x=h.x,r.y=h.y,r.scalingCenterX=h.x,r.scalingCenterY=h.y,r.zIndex=!i&&s!=null&&c===s.datum?1:0})}isProcessedDataAnimatable(){return!0}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:e}=this.ctx,t=RCe();gSe(this.id,"markers",e,[this.markerSelection,this.highlightMarkerSelection],t)}getLabelData(){var e,t;return this.isLabelEnabled()?(t=(e=this.contextNodeData)==null?void 0:e.labelData)!=null?t:[]:[]}pickNodeClosestDatum(e){var a;const{x:t,y:i}=e;let s=1/0,n;return(a=this.contextNodeData)==null||a.nodeData.forEach(r=>{const{x:o,y:l,size:c}=r.point,h=Math.max(Math.abs(o-t)-c,0),d=Math.max(Math.abs(l-i)-c,0),u=h*h+d*d;u<s&&(s=u,n=r)}),n!=null?{datum:n,distance:Math.sqrt(s)}:void 0}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:s}=this,{shape:n,fillOpacity:a,stroke:r,strokeWidth:o,strokeOpacity:l,lineDash:c,lineDashOffset:h}=s;let{fill:d}=s;if(e!=null&&this.isColorScaleValid()){const p=t.resolveColumnById(this,"colorValue",i)[e];d=this.colorScale.convert(p)}return{marker:VV({shape:n,fill:d,fillOpacity:a,stroke:r,strokeWidth:o,strokeOpacity:l,lineDash:c,lineDashOffset:h},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}}getLegendData(e){var p,g,f;const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:s,visible:n}=this,{title:a,legendItemName:r,idName:o,idKey:l,colorKey:c,colorName:h,colorRange:d,showInLegend:u}=this.properties;if(e==="gradient"&&c!=null&&d!=null){const y=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:n,seriesId:s,colorName:h,colorRange:d,colorDomain:y}]}else return e==="category"?[{legendType:"category",id:s,itemId:s,seriesId:s,enabled:n,label:{text:(f=(g=(p=r!=null?r:a)!=null?p:o)!=null?g:l)!=null?f:s},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!u}]:[]}getTooltipContent(e){var N;const{id:t,dataModel:i,processedData:s,properties:n}=this,{idKey:a,idName:r,latitudeKey:o,latitudeName:l,longitudeKey:c,longitudeName:h,colorKey:d,colorName:u,sizeKey:p,sizeName:g,labelKey:f,labelName:y,title:v,legendItemName:x,tooltip:S}=n;if(!i||!s)return;const M=(N=s.dataSources.get(this.id))==null?void 0:N[e],D=p!=null?i.resolveColumnById(this,"sizeValue",s)[e]:void 0,A=d!=null?i.resolveColumnById(this,"colorValue",s)[e]:void 0,w=[];if(D!=null&&w.push({label:g,fallbackLabel:p,value:String(D)}),A!=null&&w.push({label:u,fallbackLabel:d,value:String(A)}),f!=null&&f!==a){const O=i.resolveColumnById(this,"labelValue",s)[e];w.push({label:y,fallbackLabel:f,value:O})}let T;if(a!=null)T=i.resolveColumnById(this,"idValue",s)[e];else if(o!=null&&c!=null){const O=i.resolveColumnById(this,"latValue",s)[e],L=i.resolveColumnById(this,"lonValue",s)[e];T=`${Math.abs(O).toFixed(4)}\xB0 ${O>=0?"N":"S"}, ${Math.abs(L).toFixed(4)}\xB0 ${L>=0?"W":"E"}`}const k=this.getMarkerItemBaseStyle(!1);return Object.assign(k,this.getMarkerItemStyleOverrides(String(e),e,A,D,k,!1)),this.formatTooltipWithContext(S,{heading:T,title:v!=null?v:x,symbol:this.legendItemSymbol(e),data:w},b({seriesId:t,datum:M,title:v,idKey:a,idName:r,latitudeKey:o,latitudeName:l,longitudeKey:c,longitudeName:h,colorKey:d,colorName:u,sizeKey:p,sizeName:g,labelKey:f,labelName:y},k))}getFormattedMarkerStyle(e){const{datumIndex:t,colorValue:i,sizeValue:s}=e,n=this.getMarkerItemBaseStyle(!1);return Object.assign(n,this.getMarkerItemStyleOverrides(String(t),t,i,s,n,!1)),{size:n.size}}computeFocusBounds(e){return ySe(this,e)}};vC.className="MapMarkerSeries",vC.type="map-marker";var{commonSeriesOptionsDefs:MSe,mapMarkerSeriesThemeableOptionsDef:DSe,without:wSe}=R,ASe=E(b(b({},DSe),wSe(MSe,["highlightStyle"])),{type:ee(Oe("map-marker")),idKey:z,latitudeKey:z,longitudeKey:z,sizeKey:z,colorKey:z,labelKey:z,idName:z,latitudeName:z,longitudeName:z,sizeName:z,colorName:z,labelName:z,topology:Kd,topologyIdKey:z,legendItemName:z,title:z}),ISe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",moduleFactory:e=>new vC(e),tooltipDefaults:{range:"exact"},themeTemplate:E(b({},ym),{series:{shape:"circle",maxSize:30,fill:{$palette:"fill"},stroke:{$palette:"stroke"},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},R.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,fillOpacity:.5,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},tooltip:{range:"exact"}})},TSe={type:"series",name:"map-marker",chartType:"topology",enterprise:!0,options:ASe,create:e=>new vC(e),validate(e,t,i){const s=js(e,t,i),{cleared:n,invalid:a}=s;if((n==null?void 0:n.idKey)==null&&((n==null?void 0:n.latitudeKey)==null||(n==null?void 0:n.longitudeKey)==null)){const r=l=>i?`${i}.${l}`:l,o=`Either \`${r("idKey")}\` or both \`${r("latitudeKey")}\` and \`${r("longitudeKey")}\` are required.`;a.push(new eh("required",o,null,i))}return s}};function kSe(e,{aspectRatio:t,precision:i}){const s=NV(e,i,(l,c,h,d)=>{const u=PSe(l,c,h,t),p=u+2*d*t,g=u*Math.SQRT2,f=p*Math.SQRT2;return{distance:g,maxDistance:f}});if(s==null)return;const{x:n,y:a,distance:r}=s,o=r/Math.SQRT2;return{x:n,y:a,maxWidth:o}}function LSe(e,t,i,s,n){const[a,r]=e,[o,l]=t,c=1/n,h=o-a,d=l-r,[u,p]=r<=l?e:t,[g,f]=a<=o?e:t,[y,v]=r<=l?t:e,[x,S]=a<=o?t:e;let M=1/0;if(h!==0){const N=d/h;for(let O=0;O<=1;O+=1){const L=O===0?c:-c,F=(N*a-r-L*i+s)/(N-L);if(F>=g&&F<=x){const B=Math.abs(i-F)*2;M=Math.min(M,B)}}}else for(let N=0;N<=1;N+=1){const L=(N===0?c:-c)*(a-i)+s;if(L>=p&&L<=v){const B=Math.abs(s-L)*2*n;M=Math.min(M,B)}}const D=n,A=Math.abs((u-i)/(p-s)),w=Math.abs((y-i)/(v-s));if(v<s&&w<D){const O=Math.abs(s-v)*2*n;M=Math.min(M,O)}else if(p>s&&A<D){const O=Math.abs(s-p)*2*n;M=Math.min(M,O)}const T=Math.abs((f-s)/(g-i)),k=Math.abs((S-s)/(x-i));if(x<i&&k<c){const N=Math.abs(i-x)*2;M=Math.min(M,N)}else if(g>i&&T<c){const N=Math.abs(i-g)*2;M=Math.min(M,N)}return M}function PSe(e,t,i,s){let n=!1,a=1/0;for(const r of e){let o=r[r.length-1],[l,c]=o;for(const h of r){const[d,u]=h;u>i!=c>i&&t<(l-d)*(i-u)/(c-u)+d&&(n=!n);const p=LSe(o,h,t,i,s);a=Math.min(a,p),o=h,l=d,c=u}}return(n?1:-1)*a}function bC(e,t,i){i>=t&&(e.maxX=Math.min(e.maxX,i-t)),i<=t&&(e.minX=Math.max(e.minX,i-t))}function ESe(e,t,i,s,n,a){const r=n-a/2,o=n+a/2,[l,c]=t,[h,d]=i,u=h-l,p=d-c,[g,f]=l<=h?t:i,[y,v]=l<=h?i:t;if(u!==0){const x=p/u;for(let S=0;S<=1;S+=1){const D=((S===0?r:o)-c)/x+l;D>=g&&D<=y&&bC(e,s,D)}}else Math.max(r,Math.min(c,d))<=Math.min(o,Math.max(c,d))&&bC(e,s,l);return y<s&&v>=r&&v<=o?bC(e,s,y):g>s&&f>=r&&f<=o&&bC(e,s,g),e}function RSe(e,t,i,s){const n={minX:-1/0,maxX:1/0};for(const o of e){let l=o[o.length-1];for(const c of o)ESe(n,l,c,t,i,s),l=c}const{minX:a,maxX:r}=n;return Number.isFinite(a)&&Number.isFinite(r)?{x:t+(a+r)/2,width:r-a}:{x:t,width:0}}var{Property:Yt,SeriesProperties:NSe,SeriesTooltip:OSe,FillGradientDefaults:FSe,FillPatternDefaults:BSe,FillImageDefaults:_Se}=R,Vt=class extends NSe{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillGradientDefaults=new FSe,this.fillPatternDefaults=new BSe,this.fillImageDefaults=new _Se,this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new dm,this.tooltip=new OSe}};C([Yt],Vt.prototype,"topology",2),C([Yt],Vt.prototype,"title",2),C([Yt],Vt.prototype,"legendItemName",2),C([Yt],Vt.prototype,"idKey",2),C([Yt],Vt.prototype,"idName",2),C([Yt],Vt.prototype,"topologyIdKey",2),C([Yt],Vt.prototype,"labelKey",2),C([Yt],Vt.prototype,"labelName",2),C([Yt],Vt.prototype,"colorKey",2),C([Yt],Vt.prototype,"colorName",2),C([Yt],Vt.prototype,"colorRange",2),C([Yt],Vt.prototype,"fill",2),C([Yt],Vt.prototype,"fillGradientDefaults",2),C([Yt],Vt.prototype,"fillPatternDefaults",2),C([Yt],Vt.prototype,"fillImageDefaults",2),C([Yt],Vt.prototype,"fillOpacity",2),C([Yt],Vt.prototype,"stroke",2),C([Yt],Vt.prototype,"strokeOpacity",2),C([Yt],Vt.prototype,"strokeWidth",2),C([Yt],Vt.prototype,"lineDash",2),C([Yt],Vt.prototype,"lineDashOffset",2),C([Yt],Vt.prototype,"padding",2),C([Yt],Vt.prototype,"itemStyler",2),C([Yt],Vt.prototype,"label",2),C([Yt],Vt.prototype,"tooltip",2);var{getMissCount:GSe,createDatumId:jV,SeriesNodePickMode:HV,valueProperty:xC,CachedTextMeasurerPool:zSe,TextUtils:WV,ColorScale:VSe,Group:UV,Selection:aT,Text:jSe,PointerEvents:HSe,applyShapeStyle:WSe,getShapeStyle:rT}=R,KV=R.MercatorScale.fixedScale(),CC=class extends bm{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[HV.EXACT_SHAPE_MATCH,HV.NEAREST_NODE]}),this.properties=new Vt,this._chartTopology=void 0,this.colorScale=new VSe,this.itemGroup=this.contentGroup.appendChild(new UV({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new UV({name:"itemLabelGroup"})),this.datumSelection=aT.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=aT.select(this.itemLabelGroup,jSe),this.highlightDatumSelection=aT.select(this.highlightNode,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=HSe.None}getNodeData(){var e;return(e=this.contextNodeData)==null?void 0:e.nodeData}get topology(){var e;return(e=this.properties.topology)!=null?e:this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[2,e],!0):!1}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new Ap;return e.renderMode=1,e.lineJoin="round",e}async processData(e){var f;if(this.data==null)return;const{data:t,topology:i,colorScale:s}=this,{topologyIdKey:n,idKey:a,colorKey:r,labelKey:o,colorRange:l}=this.properties,c=new Map;i==null||i.features.forEach(y=>{var x;const v=(x=y.properties)==null?void 0:x[n];v==null||!QI(y.geometry,1)||c.set(v,y)});const h=this.colorScale.type,d=(f=this.scale)==null?void 0:f.type,{dataModel:u,processedData:p}=await this.requestDataModel(e,t,{props:[xC(a,d,{id:"idValue",includeProperty:!1}),xC(a,d,{id:"featureValue",includeProperty:!1,processor:()=>y=>c.get(y)}),...o?[xC(o,"band",{id:"labelValue"})]:[],...r?[xC(r,h,{id:"colorValue"})]:[]]}),g=u.resolveColumnById(this,"featureValue",p);if(this.topologyBounds=g.reduce((y,v)=>{const x=v==null?void 0:v.geometry;return x==null?y:Ip(x,y)},void 0),l!=null&&this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue");s.domain=p.domain.values[y],s.range=l,s.update()}i==null&&se.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,a=GSe(this,i.defs.values[s].missing);return!(n===0||n===a)}getLabelLayout(e,t,i,s,n){if(t==null||s==null)return;const{idKey:a,idName:r,colorKey:o,colorName:l,labelKey:c,labelName:h,padding:d,label:u}=this.properties,p=this.getLabelText(u,{value:t,datum:e,idKey:a,idName:r,colorKey:o,colorName:l,labelKey:c,labelName:h});if(p==null)return;const g=zSe.measureText(String(p),{font:i}),f=p.split(`
`).length,y=(g.width+2*d)/(f*WV.getLineHeight(u.fontSize)+2*d);if((n==null?void 0:n.geometry)===s&&(n==null?void 0:n.labelText)===p&&(n==null?void 0:n.aspectRatio)===y)return n;const v=Lc(s,KV),x=gC(v);if(x==null)return;const S=kSe(x,{aspectRatio:y,precision:.001});if(S==null)return;const{x:M,y:D,maxWidth:A}=S;return{geometry:s,labelText:p,aspectRatio:y,x:M,y:D,maxWidth:A,fixedPolygon:x}}getLabelDatum(e,t){const{scale:i}=this;if(i==null)return;const{padding:s,label:n}=this.properties,{labelText:a,aspectRatio:r,x:o,y:l,maxWidth:c,fixedPolygon:h}=e,d={width:Math.ceil(c*t),height:Math.ceil(c*t/r),meta:o},u=cm(a,n,{padding:s},(M,D)=>{if(!D)return d;const A=RSe(h,o,l,M/t);return{width:A.width*t,height:M,meta:A.x}});if(u==null)return;const[{text:p,fontSize:g,lineHeight:f,width:y},v]=u;if(p===WV.EllipsisChar)return;const x=y<d.width?o:v,S=this.scale.convert(KV.invert([x,l]));return{x:S[0],y:S[1],text:p,fontSize:g,lineHeight:f}}createNodeData(){var A;const{id:e,dataModel:t,processedData:i,properties:s,scale:n,previousLabelLayouts:a}=this,{idKey:r,colorKey:o,labelKey:l,label:c}=s;if(t==null||i==null)return;const h=n!=null?(n.range[1][0]-n.range[0][0])/n.bounds.width:NaN,d=t.resolveColumnById(this,"idValue",i),u=t.resolveColumnById(this,"featureValue",i),p=l!=null?t.resolveColumnById(this,"labelValue",i):void 0,g=o!=null?t.resolveColumnById(this,"colorValue",i):void 0,f=c.getFont(),y=new Map;this.previousLabelLayouts=y;const v=[],x=[],S=[];((A=i.dataSources.get(this.id))!=null?A:[]).forEach((w,T)=>{var G,V;const k=d[T],N=g==null?void 0:g[T],O=p==null?void 0:p[T],L=(V=(G=u[T])==null?void 0:G.geometry)!=null?V:void 0;L==null&&S.push(k);const F=this.getLabelLayout(w,O,f,L,a==null?void 0:a.get(k));F!=null&&y.set(k,F);const B=F!=null&&n!=null?this.getLabelDatum(F,h):void 0;B!=null&&x.push(B);const _=L!=null&&n!=null?Lc(L,n):void 0;v.push({series:this,itemId:r,datum:w,datumIndex:T,idValue:k,colorValue:N,labelValue:O,projectedGeometry:_})});const D=10;if(S.length>D){const w=S.length-D;S.length=D,S.push(`(+${w} more)`)}return S.length>0&&se.warnOnce("some data items do not have matches in the provided topology",S),{itemId:e,nodeData:v,labelData:x}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){var r,o,l,c,h;const{datumSelection:e,labelSelection:t,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let s=(r=this.ctx.highlightManager)==null?void 0:r.getActiveHighlight();s!=null&&(s.series!==this||s.datum==null)&&(s=void 0);const n=(l=(o=this.contextNodeData)==null?void 0:o.nodeData)!=null?l:[],a=(h=(c=this.contextNodeData)==null?void 0:c.labelData)!=null?h:[];this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:a,labelSelection:t}),this.updateLabelNodes({labelSelection:t}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:s!=null?[s]:[],datumSelection:i}),this.updateDatumNodes({datumSelection:i,isHighlight:!0})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>jV(t.idValue))}getItemBaseStyle(e){var s,n,a,r,o,l,c;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return rT({fill:(s=i==null?void 0:i.fill)!=null?s:t.fill,fillOpacity:(n=i==null?void 0:i.fillOpacity)!=null?n:t.fillOpacity,stroke:(a=i==null?void 0:i.stroke)!=null?a:t.stroke,strokeWidth:(r=i==null?void 0:i.strokeWidth)!=null?r:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(o=i==null?void 0:i.strokeOpacity)!=null?o:t.strokeOpacity,lineDash:(l=i==null?void 0:i.lineDash)!=null?l:t.lineDash,lineDashOffset:(c=i==null?void 0:i.lineDashOffset)!=null?c:t.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getItemStyleOverrides(e,t,i,s,n){var d;const{id:a,properties:r,colorScale:o}=this,{colorRange:l,itemStyler:c}=r;let h;if(!n&&i!=null&&(h!=null||(h={}),h.fill=this.isColorScaleValid()?o.convert(i):(d=l==null?void 0:l[0])!=null?d:r.fill),c!=null){const u=this.cachedDatumCallback(jV(e,n?"highlight":"node"),()=>this.callWithContext(c,b(b({seriesId:a,datum:t,highlighted:n},s),h)));h!=null||(h={}),Object.assign(h,u)}return rT(h,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getItemBaseStyle(i),n=BV(this.scale);t.each((a,r)=>{const{datum:o,datumIndex:l,colorValue:c,projectedGeometry:h}=r;if(h==null){a.visible=!1,a.projectedGeometry=void 0;return}const d=this.getItemStyleOverrides(String(l),o,c,s,i);a.visible=!0,a.projectedGeometry=h,WSe(a,s,d,n)})}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:s,fontWeight:n,fontFamily:a}=this.properties.label;t.each((r,{x:o,y:l,text:c,fontSize:h,lineHeight:d})=>{r.visible=!0,r.x=o,r.y=l,r.text=c,r.fill=i,r.fontStyle=s,r.fontWeight=n,r.fontSize=h,r.lineHeight=d,r.fontFamily=a,r.textAlign="center",r.textBaseline="middle"})}resetAnimation(){}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.datumSelection.each((n,a)=>{const r=n.distanceSquared(e,t);r<i&&(i=r,s=a)}),s!=null?{datum:s,distance:Math.sqrt(i)}:void 0}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if((t==null?void 0:t.datum)===e)return t.point;const i=e.projectedGeometry,s=i!=null?gC(i):void 0,n=s!=null?iT(s,2):void 0,a=n!=null?{x:n[0],y:n[1]}:void 0;return this._previousDatumMidPoint={datum:e,point:a},a}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:s}=this,{fillOpacity:n,stroke:a,strokeWidth:r,strokeOpacity:o,lineDash:l,lineDashOffset:c}=s;let{fill:h}=s;if(e!=null&&this.isColorScaleValid()){const u=t.resolveColumnById(this,"colorValue",i)[e];h=this.colorScale.convert(u)}return{marker:rT({fill:h,fillOpacity:n,stroke:a,strokeWidth:r,strokeOpacity:o,lineDash:l,lineDashOffset:c},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}}getLegendData(e){var p,g;const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:s,visible:n}=this,{title:a,legendItemName:r,idKey:o,idName:l,colorKey:c,colorName:h,colorRange:d,showInLegend:u}=this.properties;if(e==="gradient"&&c!=null&&d!=null){const f=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:n,seriesId:s,colorName:h,colorRange:d,colorDomain:f}]}else return e==="category"?[{legendType:"category",id:s,itemId:s,seriesId:s,enabled:n,label:{text:(g=(p=r!=null?r:a)!=null?p:l)!=null?g:o},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!u}]:[]}getTooltipContent(e){var S;const{id:t,dataModel:i,processedData:s,properties:n}=this,{idKey:a,idName:r,colorKey:o,colorName:l,labelKey:c,labelName:h,legendItemName:d,title:u,tooltip:p}=n;if(!i||!s)return;const g=(S=s.dataSources.get(this.id))==null?void 0:S[e],f=i.resolveColumnById(this,"idValue",s)[e],y=o!=null?i.resolveColumnById(this,"colorValue",s)[e]:void 0,v=[];if(y!=null&&v.push({label:l,fallbackLabel:o,value:String(y)}),c!=null&&c!==a){const M=i.resolveColumnById(this,"labelValue",s)[e];v.push({label:h,fallbackLabel:c,value:M})}const x=this.getItemBaseStyle(!1);return Object.assign(x,this.getItemStyleOverrides(String(e),e,y,x,!1)),this.formatTooltipWithContext(p,{heading:f,title:u!=null?u:d,symbol:this.legendItemSymbol(e),data:v},b({seriesId:t,datum:g,title:u,idKey:a,idName:r,colorKey:o,colorName:l,labelKey:c,labelName:h},x))}computeFocusBounds(e){return LV(this,e)}};CC.className="MapShapeSeries",CC.type="map-shape";var{commonSeriesOptionsDefs:USe,mapShapeSeriesThemeableOptionsDef:KSe,without:$Se}=R,YSe=E(b(b({},KSe),$Se(USe,["highlightStyle"])),{type:ee(Oe("map-shape")),idKey:ee(z),colorKey:z,labelKey:z,idName:z,colorName:z,labelName:z,topology:Kd,topologyIdKey:z,legendItemName:z,title:z}),XSe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",moduleFactory:e=>new CC(e),tooltipDefaults:{range:"exact"},themeTemplate:E(b({},ym),{series:{fill:{$palette:"fill"},stroke:{$ref:"backgroundColor"},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},R.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:{$ref:"backgroundColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:"bold",overflowStrategy:"hide"}},tooltip:{range:"exact"}})},ZSe={type:"series",name:"map-shape",chartType:"topology",enterprise:!0,options:YSe,create:e=>new CC(e)},{FillGradientDefaults:qSe,FillPatternDefaults:QSe,FillImageDefaults:JSe,Property:Va,SeriesProperties:e0e,SeriesTooltip:t0e}=R,da=class extends e0e{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillGradientDefaults=new qSe,this.fillPatternDefaults=new QSe,this.fillImageDefaults=new JSe,this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new t0e}};C([Va],da.prototype,"topology",2),C([Va],da.prototype,"fill",2),C([Va],da.prototype,"fillGradientDefaults",2),C([Va],da.prototype,"fillPatternDefaults",2),C([Va],da.prototype,"fillImageDefaults",2),C([Va],da.prototype,"fillOpacity",2),C([Va],da.prototype,"stroke",2),C([Va],da.prototype,"strokeOpacity",2),C([Va],da.prototype,"strokeWidth",2),C([Va],da.prototype,"lineDash",2),C([Va],da.prototype,"lineDashOffset",2),C([Va],da.prototype,"tooltip",2);var{createDatumId:i0e,SeriesNodePickMode:s0e,Selection:n0e,Group:a0e,PointerEvents:r0e,getShapeStyle:o0e}=R,SC=class extends bm{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[s0e.EXACT_SHAPE_MATCH]}),this.properties=new da,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new a0e({name:"itemGroup"})),this.datumSelection=n0e.select(this.itemGroup,()=>this.nodeFactory())}get topology(){var e;return(e=this.properties.topology)!=null?e:this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0):!1}nodeFactory(){const e=new Ap;return e.renderMode=1,e.lineJoin="round",e.pointerEvents=r0e.None,e}processData(){const{topology:e}=this;this.topologyBounds=e==null?void 0:e.features.reduce((t,i)=>{const s=i.geometry;return s==null?t:Ip(s,t)},void 0),e==null&&se.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i}=this;if(t==null)return;const s=[],n=[];return t.features.forEach((a,r)=>{const{geometry:o}=a,l=o!=null&&i!=null?Lc(o,i):void 0;l!=null&&s.push({series:this,itemId:r,datum:a,datumIndex:0,index:r,projectedGeometry:l})}),{itemId:e,nodeData:s,labelData:n}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){var i;const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:t=[]}=(i=this.contextNodeData)!=null?i:{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>i0e(t.index))}updateDatumNodes(e){const{properties:t}=this,{datumSelection:i}=e,{fill:s,fillOpacity:n,stroke:a,strokeOpacity:r,lineDash:o,lineDashOffset:l}=t,c=this.getStrokeWidth(t.strokeWidth);i.each((h,d)=>{const{projectedGeometry:u}=d;if(u==null){h.visible=!1,h.projectedGeometry=void 0;return}h.visible=!0,h.projectedGeometry=u;const p=o0e({fill:s,fillOpacity:n,stroke:a,strokeWidth:c,strokeOpacity:r,lineDash:o,lineDashOffset:l},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults);h.setProperties(p)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}pickFocus(){}computeFocusBounds(e){}};SC.className="MapShapeBackgroundSeries",SC.type="map-shape-background";var{commonSeriesOptionsDefs:l0e,mapShapeBackgroundSeriesThemeableOptionsDef:c0e}=R,h0e=E(b(b({},c0e),l0e),{type:ee(Oe("map-shape-background")),topology:Kd}),d0e={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",moduleFactory:e=>new SC(e),tooltipDefaults:{range:"exact"},themeTemplate:E(b({},ym),{series:{fill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$ref:"backgroundColor"},strokeWidth:1,fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:[{$mix:[{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"black",.15]},{$mix:[{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"white",.15]}],rotation:0,reverse:!1},fillPatternDefaults:E(b({},R.FILL_PATTERN_DEFAULTS),{fill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]}}),fillImageDefaults:R.FILL_IMAGE_DEFAULTS}})},u0e={type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,options:h0e,create:e=>new SC(e)},{ChartAxisDirection:dl,PolarAxis:p0e,diff:g0e,fixNumericExtent:f0e,groupAccumulativeValueProperty:$V,keyProperty:m0e,normaliseGroupTo:y0e,resetLabelFn:v0e,seriesLabelFadeInAnimation:b0e,seriesLabelFadeOutAnimation:x0e,valueProperty:C0e,animationValidation:S0e,createDatumId:YV,SeriesNodePickMode:XV,normalizeAngle360:ZV,CategoryScale:M0e,motion:qV,applyShapeStyle:D0e,isGradientFill:w0e,getShapeStyle:oT}=R,A0e=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey}},QV=class extends R.PolarSeries{constructor(e,{animationResetFns:t}){super({moduleCtx:e,categoryKey:"angleValue",useLabelLayer:!0,canHaveAxes:!0,pickModes:[XV.NEAREST_NODE,XV.EXACT_SHAPE_MATCH],animationResetFns:E(b({},t),{label:v0e})}),this.NodeEvent=A0e,this.groupScale=new M0e,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===dl.Angle)return t.getDomain(this,"angleValue","key",i);{const s=t.getDomain(this,"radiusValue-end","value",i),n=Number.isFinite(s[1]-s[0])?[s[0]>0?0:s[0],s[1]<0?0:s[1]]:[];return f0e(n)}}async processData(e){var d,u;const{angleKey:t,radiusKey:i,normalizedTo:s}=this.properties,n=!this.ctx.animationManager.isSkipped(),a=this.getStackId(),r=`${a}-trailing`,o=[];ni(s)&&o.push(y0e([a,r],Math.abs(s))),n&&this.processedData&&o.push(g0e(this.id,this.processedData)),n&&o.push(S0e());const l=this.visible?{}:{forceValue:0},c=(d=this.axes[dl.Radius])==null?void 0:d.scale.type,h=(u=this.axes[dl.Angle])==null?void 0:u.scale.type;await this.requestDataModel(e,this.data,{props:[m0e(t,h,{id:"angleValue"}),C0e(i,c,b({id:"radiusValue-raw",invalidValue:null},l)),...$V(i,"normal","current",b({id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:a,separateNegative:!0},l),c),...$V(i,"trailing","current",b({id:"radiusValue-start",invalidValue:null,groupId:r,separateNegative:!0},l),c),...o],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,s=this.circleCache;return e!==s.r||t!==s.cx||i!==s.cy?(this.circleCache={r:e,cx:t,cy:i},!0):!1}isRadiusAxisReversed(){var e;return(e=this.axes[dl.Radius])==null?void 0:e.isReversed()}maybeRefreshNodeData(){var i;if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=(i=this.createNodeData())!=null?i:{};this.nodeData=t,this.nodeDataRefresh=!1}getAxisInnerRadius(){const e=this.axes[dl.Radius];return e instanceof p0e?this.radius*e.innerRadiusRatio:0}createNodeData(){var G,V,j;const{processedData:e,dataModel:t,groupScale:i}=this;if(!t||!e||e.type!=="grouped")return;const s=this.axes[dl.Angle],n=this.axes[dl.Radius],a=s==null?void 0:s.scale,r=n==null?void 0:n.scale;if(!a||!r)return;const o=t.resolveKeysById(this,"angleValue",e),l=t.resolveColumnById(this,"radiusValue-start",e),c=t.resolveColumnById(this,"radiusValue-end",e),h=t.resolveColumnById(this,"radiusValue-raw",e),d=t.resolveProcessedDataIndexById(this,"radiusValue-range");let u=0,p=0;s instanceof ac&&(u=s.groupPaddingInner,p=s.paddingInner);const f=((G=a.bandwidth)!=null?G:0)*(1-p),{index:y,visibleGroupCount:v}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:v}).map((H,U)=>String(U)),i.range=[-f/2,f/2],i.paddingInner=v>1?u:0;const x=this.isRadiusAxisReversed(),S=x?this.radius:this.getAxisInnerRadius(),M=x?this.getAxisInnerRadius():this.radius,D=M+S,{angleKey:A,radiusKey:w,angleName:T,radiusName:k,label:N}=this.properties,O=(H,U,$,W)=>{const Y=this.getLabelText(N,{value:U,datum:H,angleKey:A,radiusKey:w,angleName:T,radiusName:k});if(Y)return{x:$,y:W,text:Y,textAlign:"center",textBaseline:"middle"}},L=[],F={itemId:w,nodeData:L,labelData:L};if(!this.visible)return F;const{dataSources:B}=e,_=(V=B.get(this.id))!=null?V:[];for(const{datumIndex:H,group:U}of t.forEachGroupDatum(this,e)){const $=_[H],W=o[H];if(W==null)return;const Y=h[H],K=Y>=0&&!Object.is(Y,-0),Q=l[H],Z=c[H],J=(j=U.aggregation[d][K?1:0])!=null?j:0,ae=K===x;if(Q===void 0||Z===void 0)return;let oe,le;if(_.length===1)oe=-.5*Math.PI,le=1.5*Math.PI;else{const Ue=a.convert(W);oe=ZV(Ue+i.convert(String(y))),le=ZV(oe+i.bandwidth)}const de=oe+i.bandwidth/2,ue=D-r.convert(Q),ie=D-r.convert(Z),re=(ue+ie)/2,te=D-r.convert(0),fe=D-r.convert(J),me=Math.cos(de)*re,Le=Math.sin(de)*re,Ee=this.properties.label.enabled?O($,Y,me,Le):void 0,He=this.getColumnWidth(oe,le);L.push({series:this,datum:$,datumIndex:H,point:{x:me,y:Le,size:0},midPoint:{x:me,y:Le},label:Ee,angleValue:W,radiusValue:Y,negative:ae,innerRadius:ue,outerRadius:ie,stackInnerRadius:te,stackOuterRadius:fe,startAngle:oe,endAngle:le,midAngle:de,axisInnerRadius:S,axisOuterRadius:M,columnWidth:He,index:H})}return{itemId:w,nodeData:L,labelData:L}}getColumnWidth(e,t){return NaN}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(e){var s,n,a,r,o,l,c;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return oT({fill:(s=i==null?void 0:i.fill)!=null?s:t.fill,fillOpacity:(n=i==null?void 0:i.fillOpacity)!=null?n:t.fillOpacity,stroke:(a=i==null?void 0:i.stroke)!=null?a:t.stroke,strokeWidth:(r=i==null?void 0:i.strokeWidth)!=null?r:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(o=i==null?void 0:i.strokeOpacity)!=null?o:t.strokeOpacity,lineDash:(l=i==null?void 0:i.lineDash)!=null?l:t.lineDash,lineDashOffset:(c=i==null?void 0:i.lineDashOffset)!=null?c:t.lineDashOffset,cornerRadius:t.cornerRadius},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getItemStyleOverrides(e,t,i,s){const{id:n,properties:a}=this,{angleKey:r,radiusKey:o,itemStyler:l,fillGradientDefaults:c,fillPatternDefaults:h,fillImageDefaults:d}=a;if(l==null)return;const u=this.cachedDatumCallback(YV(e,s?"highlight":"node"),()=>this.callWithContext(l,b({seriesId:n,datum:t,highlighted:s,angleKey:r,radiusKey:o},i)));return oT(u,c,h,d)}updateSectorSelection(e,t){var l;let i=[];if(t){const c=(l=this.ctx.highlightManager)==null?void 0:l.getActiveHighlight();c!=null&&c.datum&&c.series===this&&i.push(c)}else i=this.nodeData;const s=this.isRadiusAxisReversed(),n=s?this.radius:this.getAxisInnerRadius(),a=s?this.getAxisInnerRadius():this.radius,r=this.getShapeFillBBox(),o=this.getItemBaseStyle(t);e.update(i,void 0,c=>this.getDatumId(c)).each((c,h)=>{var x,S,M,D;const{datum:d,datumIndex:u,midPoint:p}=h,g=this.getItemStyleOverrides(String(u),d,o,t),f=(x=g==null?void 0:g.fill)!=null?x:o.fill,v=w0e(f)&&f.bounds==="item"?{centerX:(S=p==null?void 0:p.x)!=null?S:0,centerY:(M=p==null?void 0:p.y)!=null?M:0}:{centerX:0,centerY:0,innerRadius:n,outerRadius:a};this.updateItemPath(c,h,t),D0e(c,o,g,r,v),c.cornerRadius=(D=g==null?void 0:g.cornerRadius)!=null?D:o.cornerRadius,c.lineJoin="round"})}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1})}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getColumnTransitionFunctions();qV.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),b0e(this,"labels",this.ctx.animationManager,e)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getColumnTransitionFunctions();qV.fromToMotion(this.id,"datums",t,[e],i),x0e(this,"labels",t,this.labelSelection)}getTooltipContent(e){var v;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{angleKey:r,angleName:o,radiusKey:l,radiusName:c,tooltip:h}=a,d=n[dl.Angle],u=n[dl.Radius];if(!i||!s||!d||!u)return;const p=(v=s.dataSources.get(this.id))==null?void 0:v[e],g=i.resolveKeysById(this,"angleValue",s)[e],f=i.resolveColumnById(this,"radiusValue-raw",s)[e];if(g==null)return;const y=this.getItemBaseStyle(!1);return Object.assign(y,this.getItemStyleOverrides(String(e),e,y,!1)),this.formatTooltipWithContext(h,{heading:d.formatDatum(g),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:u.formatDatum(f)}]},b({seriesId:t,datum:p,title:o,angleKey:r,angleName:o,radiusKey:l,radiusName:c},y))}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r,fillGradientDefaults:o,fillPatternDefaults:l,fillImageDefaults:c}=this.properties,h=oT({fill:e!=null?e:"rgba(0, 0, 0, 0)",stroke:t!=null?t:"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r},o,l,c);return R.isGradientFill(h.fill)&&(h.fill=E(b({},h.fill),{gradient:"linear",rotation:0,reverse:!1})),{marker:h}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{radiusKey:s,radiusName:n,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:i,label:{text:n!=null?n:s},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(e){return YV(e.angleValue)}computeLabelsBBox(){return null}},{SeriesProperties:I0e,FillGradientDefaults:T0e,FillPatternDefaults:k0e,FillImageDefaults:L0e,SeriesTooltip:P0e,Property:Oi,Label:E0e}=R,mi=class extends I0e{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new T0e,this.fillPatternDefaults=new k0e,this.fillImageDefaults=new L0e,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new E0e,this.tooltip=new P0e}};C([Oi],mi.prototype,"angleKey",2),C([Oi],mi.prototype,"angleName",2),C([Oi],mi.prototype,"radiusKey",2),C([Oi],mi.prototype,"radiusName",2),C([Oi],mi.prototype,"fill",2),C([Oi],mi.prototype,"fillGradientDefaults",2),C([Oi],mi.prototype,"fillPatternDefaults",2),C([Oi],mi.prototype,"fillImageDefaults",2),C([Oi],mi.prototype,"fillOpacity",2),C([Oi],mi.prototype,"stroke",2),C([Oi],mi.prototype,"strokeWidth",2),C([Oi],mi.prototype,"strokeOpacity",2),C([Oi],mi.prototype,"lineDash",2),C([Oi],mi.prototype,"lineDashOffset",2),C([Oi],mi.prototype,"cornerRadius",2),C([Oi],mi.prototype,"itemStyler",2),C([Oi],mi.prototype,"rotation",2),C([Oi],mi.prototype,"stackGroup",2),C([Oi],mi.prototype,"normalizedTo",2),C([Oi],mi.prototype,"label",2),C([Oi],mi.prototype,"tooltip",2);var{motion:R0e}=R;function JV(){const e={startAngle:new Map,endAngle:new Map},t=["startAngle","endAngle"],i=(r,o,l)=>{t.forEach(c=>{var g,f;const h=e[c];let d=(l==="removed"||l==="updated"?r:o)[c],u=(l==="removed"?r:o)[c];isNaN(u)&&(u=(f=(g=r.previousDatum)==null?void 0:g[c])!=null?f:NaN);const p=d-u;Math.abs(p)>Math.PI&&(d-=Math.sign(p)*2*Math.PI),h.set(o,{from:d,to:u})})},s=(r,o)=>({startAngle:e.startAngle.get(r)[o],endAngle:e.endAngle.get(r)[o]});return{calculate:i,from:r=>s(r,"from"),to:r=>s(r,"to")}}function e4(e,t,i){if(i==="updated"){if(e.previousDatum==null||isNaN(e.previousDatum.startAngle)||isNaN(e.previousDatum.endAngle))return"added";if(isNaN(t.startAngle)||isNaN(t.endAngle))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function N0e(e){const t=JV();return{toFn:(n,a,r)=>{const{startAngle:o,endAngle:l}=t.to(a);let c,h,d,u,p;return r==="removed"?(c=n.innerRadius,h=n.innerRadius,d=n.columnWidth,u=n.axisInnerRadius,p=n.axisOuterRadius):(c=isNaN(a.innerRadius)?e:a.innerRadius,h=isNaN(a.outerRadius)?e:a.outerRadius,d=isNaN(a.columnWidth)?n.columnWidth:a.columnWidth,u=a.axisInnerRadius,p=a.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:p,startAngle:o,endAngle:l}},fromFn:(n,a,r)=>{r=e4(n,a,r),t.calculate(n,a,r);const{startAngle:o,endAngle:l}=t.from(a);let c,h,d,u,p;r==="removed"||r==="updated"?(c=n.innerRadius,h=n.outerRadius,d=n.columnWidth,u=n.axisInnerRadius,p=n.axisOuterRadius):(c=e,h=e,d=a.columnWidth,u=a.axisInnerRadius,p=a.axisOuterRadius);const g=R0e.NODE_UPDATE_STATE_TO_PHASE_MAPPING[r];return{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:p,startAngle:o,endAngle:l,phase:g}}}}function O0e(e,{innerRadius:t,outerRadius:i,columnWidth:s,axisInnerRadius:n,axisOuterRadius:a,startAngle:r,endAngle:o}){return{innerRadius:t,outerRadius:i,columnWidth:s,axisInnerRadius:n,axisOuterRadius:a,startAngle:r,endAngle:o}}var{SectorBox:MC,motion:F0e}=R;function lT(e){const{negative:t,innerRadius:i,outerRadius:s,stackInnerRadius:n,stackOuterRadius:a}=e;return{innerRadius:t?a:n,outerRadius:t?n:a,clipInnerRadius:t?s:i,clipOuterRadius:t?i:s}}function B0e(e){const t=JV();return{toFn:(n,a,r)=>{const{startAngle:o,endAngle:l}=t.to(a);let c,h,d;if(r==="removed")c=e,h=e,d=new MC(o,l,c,h);else{let u,p;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:p}=lT(a)),isNaN(c)&&(c=e),isNaN(h)&&(h=e),isNaN(u)&&(u=e),isNaN(p)&&(p=e),d=new MC(o,l,u,p)}return{innerRadius:c,outerRadius:h,startAngle:o,endAngle:l,clipSector:d}},fromFn:(n,a,r)=>{r=e4(n,a,r),t.calculate(n,a,r);const{startAngle:o,endAngle:l}=t.from(a);let c,h,d;r==="removed"||r==="updated"?(c=n.innerRadius,h=n.outerRadius,d=n.clipSector):(c=e,h=e),d!=null||(d=new MC(o,l,c,h));const u=F0e.NODE_UPDATE_STATE_TO_PHASE_MAPPING[r];return{innerRadius:c,outerRadius:h,startAngle:o,endAngle:l,clipSector:d,phase:u}}}}function _0e(e,t){const{startAngle:i,endAngle:s}=t,{innerRadius:n,outerRadius:a,clipInnerRadius:r,clipOuterRadius:o}=lT(t),l=new MC(i,s,r,o);return{innerRadius:n,outerRadius:a,startAngle:i,endAngle:s,clipSector:l}}var{Sector:G0e,SectorBox:z0e,PolarZIndexMap:cT}=R,DC=class extends QV{constructor(e){super(e,{animationResetFns:{item:_0e}}),this.properties=new mi}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[0,cT.FOREGROUND,e],this.highlightGroup.zIndex=[0,cT.HIGHLIGHT,e],this.labelGroup.zIndex=[0,cT.LABEL,e],!0):!1}getStackId(){var t,i;return`nightingale-stack-${(i=(t=this.seriesGrouping)==null?void 0:t.groupIndex)!=null?i:this.id}-yValues`}nodeFactory(){return new G0e}updateItemPath(e,t,i){const{negative:s}=t;if(e.centerX=0,e.centerY=0,e.startOuterCornerRadius=s?0:this.properties.cornerRadius,e.endOuterCornerRadius=s?0:this.properties.cornerRadius,e.startInnerCornerRadius=s?this.properties.cornerRadius:0,e.endInnerCornerRadius=s?this.properties.cornerRadius:0,i){const{startAngle:n,endAngle:a}=t,{innerRadius:r,outerRadius:o,clipInnerRadius:l,clipOuterRadius:c}=lT(t);e.innerRadius=r,e.outerRadius=o,e.startAngle=n,e.endAngle=a,e.clipSector=new z0e(n,a,l,c)}}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return B0e(e)}};DC.className="NightingaleSeries",DC.type="nightingale";var{commonSeriesOptionsDefs:V0e,nightingaleSeriesThemeableOptionsDef:j0e}=R,H0e=E(b(b({},j0e),V0e),{type:ee(Oe("nightingale")),angleKey:ee(z),radiusKey:ee(z),angleName:z,radiusName:z,grouped:q,stacked:q,stackGroup:z,normalizedTo:ne}),{ThemeConstants:{POLAR_AXIS_TYPE:t4,POLAR_AXIS_SHAPE:W0e}}=R,i4={$path:["./shape",W0e.CIRCLE,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]},U0e={series:{fill:{$palette:"fill"},stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"backgroundColor"},{$palette:"stroke"}]},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,strokeWidth:1,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},axes:{[t4.ANGLE_CATEGORY]:{shape:i4,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[t4.RADIUS_NUMBER]:{shape:i4}}},{ThemeConstants:{POLAR_AXIS_TYPE:s4}}=R,K0e={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",moduleFactory:e=>new DC(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:s4.ANGLE_CATEGORY},{type:s4.RADIUS_NUMBER}],themeTemplate:U0e,stackable:!0,groupable:!0,stackedByDefault:!0},$0e={type:"series",name:"nightingale",chartType:"polar",enterprise:!0,options:H0e,create:e=>new DC(e)},{SeriesProperties:Y0e,FillGradientDefaults:X0e,FillPatternDefaults:Z0e,FillImageDefaults:q0e,SeriesTooltip:Q0e,Property:yi,Label:n4,DropShadow:J0e}=R,eMe=class extends n4{},hT=class extends n4{constructor(){super(...arguments),this.spacing=0}};C([yi],hT.prototype,"spacing",2),C([yi],hT.prototype,"placement",2);var Di=class extends Y0e{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new X0e,this.fillPatternDefaults=new Z0e,this.fillImageDefaults=new q0e,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new J0e().set({enabled:!1}),this.label=new eMe,this.stageLabel=new hT,this.tooltip=new Q0e}};C([yi],Di.prototype,"stageKey",2),C([yi],Di.prototype,"valueKey",2),C([yi],Di.prototype,"fills",2),C([yi],Di.prototype,"fillGradientDefaults",2),C([yi],Di.prototype,"fillPatternDefaults",2),C([yi],Di.prototype,"fillImageDefaults",2),C([yi],Di.prototype,"fillOpacity",2),C([yi],Di.prototype,"strokes",2),C([yi],Di.prototype,"strokeWidth",2),C([yi],Di.prototype,"strokeOpacity",2),C([yi],Di.prototype,"lineDash",2),C([yi],Di.prototype,"lineDashOffset",2),C([yi],Di.prototype,"direction",2),C([yi],Di.prototype,"reverse",2),C([yi],Di.prototype,"spacing",2),C([yi],Di.prototype,"aspectRatio",2),C([yi],Di.prototype,"itemStyler",2),C([yi],Di.prototype,"shadow",2),C([yi],Di.prototype,"label",2),C([yi],Di.prototype,"stageLabel",2),C([yi],Di.prototype,"tooltip",2);function a4(e,{x:t,y:i,top:s,right:n,bottom:a,left:r}){e.x0=t-s/2,e.x1=t+s/2,e.x2=t+a/2,e.x3=t-a/2,e.y0=i-r/2,e.y1=i-n/2,e.y2=i+n/2,e.y3=i+r/2}function tMe(e){return{fromFn:(n,a)=>{const{x:r,y:o}=a;let{top:l,right:c,bottom:h,left:d}=a;return e==="vertical"?(l=0,h=0):(d=0,c=0),{x:r,y:o,top:l,right:c,bottom:h,left:d}},toFn:(n,a)=>{const{x:r,y:o,top:l,right:c,bottom:h,left:d}=a;return{x:r,y:o,top:l,right:c,bottom:h,left:d}},applyFn:a4}}var{StateMachine:iMe,valueProperty:r4,SeriesNodePickMode:o4,CachedTextMeasurerPool:sMe,TextUtils:nMe,createDatumId:aMe,BBox:dT,Group:uT,Selection:wC,Text:l4,PointerEvents:c4,applyShapeStyle:rMe,fromToMotion:oMe,seriesLabelFadeInAnimation:lMe,getShapeStyle:pT}=R,AC=class extends R.DataModelSeries{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[o4.EXACT_SHAPE_MATCH,o4.NEAREST_NODE]}),this.properties=new Di,this.itemGroup=this.contentGroup.appendChild(new uT({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new uT({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new uT({name:"stageLabelGroup"})),this.datumSelection=wC.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=wC.select(this.itemLabelGroup,l4),this.stageLabelSelection=wC.select(this.stageLabelGroup,l4),this.highlightDatumSelection=wC.select(this.highlightNode,()=>this.nodeFactory()),this.animationState=new iMe("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{clear:"empty",reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.itemLabelGroup.pointerEvents=c4.None,this.stageLabelGroup.pointerEvents=c4.None}addChartEventListeners(){var e;this.destroyFns.push((e=this.ctx.chartEventManager)==null?void 0:e.addListener("legend-item-click",t=>this.onLegendItemClick(t)))}nodeFactory(){return new ro}getNodeData(){var e;return(e=this.contextNodeData)==null?void 0:e.nodeData}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}async processData(e){if(this.data==null)return;const{id:t,visible:i,ctx:{legendManager:s}}=this,{stageKey:n,valueKey:a}=this.properties,r="band",o="number",l=(h,d,u)=>i&&s.getItemEnabled({seriesId:t,itemId:u}),c=this.visible?{}:{forceValue:0};await this.requestDataModel(e,this.data,{props:[r4(n,r,{id:"xValue"}),r4(a,o,E(b({id:"yValue"},c),{validation:l,invalidValue:0}))]})}createNodeData(){var U,$,W,Y,K;const{id:e,dataModel:t,processedData:i,properties:s,visible:n,ctx:{legendManager:a}}=this,{stageKey:r,valueKey:o,direction:l,reverse:c=l==="horizontal",spacing:h,aspectRatio:d,label:u,stageLabel:p}=s;if(t==null||i==null)return;const g=l==="horizontal",f=t.resolveColumnById(this,"xValue",i),y=t.resolveColumnById(this,"yValue",i),v=sMe.getMeasurer({font:p.getFont()});let x,S;g?(x="center",S=p.placement==="before"?"bottom":"top"):(x=p.placement==="after"?"left":"right",S="middle");const M=p.enabled?[]:void 0;let D=0,A=0,w=0;const T=(U=i.dataSources.get(this.id))!=null?U:[];T.forEach((Q,Z)=>{const J=f[Z],ae=y[Z],oe=n&&a.getItemEnabled({seriesId:e,itemId:Z});if(w+=ae,M==null)return;const le=this.getLabelText(this.properties.stageLabel,{datum:Q,value:J,stageKey:r,valueKey:o}),{width:de}=v.measureText(le),ue=le.split(`
`).length*nMe.getLineHeight(u.fontSize);D=Math.max(D,de),A=Math.max(A,ue),M.push({x:NaN,y:NaN,text:le,textAlign:x,textBaseline:S,visible:oe})});const k=(W=($=this._nodeDataDependencies)==null?void 0:$.seriesRectWidth)!=null?W:0,N=(K=(Y=this._nodeDataDependencies)==null?void 0:Y.seriesRectHeight)!=null?K:0,O=h*(i.input.count-1);let L;if(g){const Q=A+p.spacing;L=new dT(0,p.placement==="before"?Q:0,k,N-Q)}else{const Q=D+p.spacing;L=new dT(p.placement==="after"?0:Q,0,k-Q,N)}if(d!=null&&d!==0){const Q=l==="horizontal"?1/d:d,Z=Math.min(L.width,L.height*Q),J=Z/Q;L=new dT(L.x+(L.width-Z)/2,L.y+(L.height-J)/2,Z,J)}let F,B;g?B=p.placement==="before"?L.y-p.spacing:L.y+L.height+p.spacing:F=p.placement==="after"?L.x+L.width+p.spacing:L.x-p.spacing;const _=L.width-(g?O:0),G=L.height-(g?0:O);if(_<0||G<0)return;const V=[],j=[];let H=0;return T.forEach((Q,Z)=>{const J=f[Z],ae=y[Z],oe=n&&a.getItemEnabled({seriesId:e,itemId:Z}),le=H+ae,de=(H+le)/(2*w),ue=(le-H)/w,ie=g?_*de+h*Z:_*.5,re=g?G*.5:G*de+h*Z,te=L.x+ie,fe=L.y+re;if(M!=null){const Te=M[Z];Te.x=F!=null?F:te,Te.y=B!=null?B:fe}let me,Le,Ee,He;if(g){const Te=_*ue;me=Te,Ee=Te;const Fe=(ie+Te/2)*(G/L.width),lt=(ie-Te/2)*(G/L.width);Le=c?L.height-Fe:Fe,He=c?L.height-lt:lt}else{const Te=G*ue;Le=Te,He=Te;const Fe=(re-Te/2)*(_/L.height),lt=(re+Te/2)*(_/L.height);me=c?L.width-Fe:Fe,Ee=c?L.width-lt:lt}const Ue=this.getLabelText(u,{datum:Q,value:ae,stageKey:r,valueKey:o}),je={x:te,y:fe,text:Ue,textAlign:"center",textBaseline:"middle",visible:oe};j.push(je),V.push({series:this,itemId:o,datum:Q,datumIndex:Z,index:Z,xValue:J,yValue:ae,x:te,y:fe,top:me,right:Le,bottom:Ee,left:He,label:je,enabled:oe,midPoint:{x:te,y:fe}}),H=le}),{itemId:e,nodeData:V,labelData:j,stageLabelData:M,bounds:L}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:e}){var c,h,d,u,p,g,f;this.checkResize(e);const{datumSelection:t,labelSelection:i,stageLabelSelection:s,highlightDatumSelection:n}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=(c=this.ctx.highlightManager)==null?void 0:c.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const r=(d=(h=this.contextNodeData)==null?void 0:h.nodeData)!=null?d:[],o=(p=(u=this.contextNodeData)==null?void 0:u.labelData)!=null?p:[],l=(f=(g=this.contextNodeData)==null?void 0:g.stageLabelData)!=null?f:[];this.datumSelection=this.updateDatumSelection({nodeData:r,datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:o,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:l,stageLabelSelection:s}),this.updateLabelNodes({labelSelection:s,labelProperties:this.properties.stageLabel}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:a!=null?[a]:[],datumSelection:n}),this.updateDatumNodes({datumSelection:n,isHighlight:!0}),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData)}getItemBaseStyle(e){var s,n,a,r,o;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return pT({fill:i==null?void 0:i.fill,fillOpacity:(s=i==null?void 0:i.fillOpacity)!=null?s:t.fillOpacity,stroke:i==null?void 0:i.stroke,strokeWidth:(n=i==null?void 0:i.strokeWidth)!=null?n:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(a=i==null?void 0:i.strokeOpacity)!=null?a:t.strokeOpacity,lineDash:(r=i==null?void 0:i.lineDash)!=null?r:t.lineDash,lineDashOffset:(o=i==null?void 0:i.lineDashOffset)!=null?o:t.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getItemStyleOverrides(e,t,i,s,n){var f,y;const{id:a,properties:r}=this,{fills:o,strokes:l,stageKey:c,valueKey:h,itemStyler:d}=r,u=(f=s.fill)!=null?f:o[i%o.length],p=(y=s.stroke)!=null?y:l[i%l.length],g={};if(n||(g.fill=u,g.stroke=p),d!=null){const v=this.cachedDatumCallback(aMe(e,n?"highlight":"node"),()=>this.callWithContext(d,b({seriesId:a,datum:t,stageKey:c,valueKey:h,highlighted:n,fill:u,stroke:p},s)));Object.assign(g,v)}return pT(g,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateDatumNodes(e){var l;const{datumSelection:t,isHighlight:i}=e,{properties:s}=this,{shadow:n}=s,a=this.getItemBaseStyle(i),r=(l=this.contextNodeData)==null?void 0:l.bounds,o=r?{series:r,axis:r}:void 0;t.each((c,h)=>{const{datumIndex:d,datum:u}=h,p=this.getItemStyleOverrides(String(d),u,d,a,i);rMe(c,a,p,o),a4(c,h),c.fillShadow=n})}updateLabelSelection(e){return e.labelSelection.update(this.properties.label.enabled?e.labelData:[])}updateStageLabelSelection(e){return e.stageLabelSelection.update(e.stageLabelData)}updateLabelNodes(e){const{labelSelection:t,labelProperties:i}=e,{color:s,fontSize:n,fontStyle:a,fontWeight:r,fontFamily:o}=i;t.each((l,{visible:c,x:h,y:d,text:u,textAlign:p,textBaseline:g})=>{l.visible=c,l.x=h,l.y=d,l.text=u,l.fill=s,l.fontStyle=a,l.fontWeight=r,l.fontSize=n,l.fontFamily=o,l.textAlign=p,l.textBaseline=g})}computeFocusBounds(e){var i;const t=(i=this.getNodeData())==null?void 0:i[e.datumIndex];if(t!==void 0){for(const s of this.datumSelection)if(s.datum===t)return s.node}}getTooltipContent(e){var p,g;const{id:t,dataModel:i,processedData:s,properties:n}=this,{stageKey:a,valueKey:r,tooltip:o}=n;if(!i||!s)return;const l=(p=s.dataSources.get(this.id))==null?void 0:p[e],c=i.resolveColumnById(this,"xValue",s)[e],h=i.resolveColumnById(this,"yValue",s)[e];if(c==null)return;const d=this.getLabelText(this.properties.stageLabel,{datum:(g=s.dataSources.get(this.id))==null?void 0:g[e],value:h,stageKey:a,valueKey:r}),u=this.getItemBaseStyle(!1);return Object.assign(u,this.getItemStyleOverrides(String(e),e,e,u,!1)),this.formatTooltipWithContext(o,{symbol:this.legendItemSymbol(e),data:[{label:String(c),value:d}]},b({seriesId:t,datum:l,title:void 0,stageKey:a,valueKey:r},u))}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.datumSelection.each((n,a)=>{const r=n.distanceSquared(e,t);r<i&&(i=r,s=a)}),s!=null?{datum:s,distance:Math.sqrt(i)}:void 0}legendItemSymbol(e){var h,d;const{fills:t,strokes:i,strokeWidth:s,fillOpacity:n,strokeOpacity:a,lineDash:r,lineDashOffset:o}=this.properties,l=(h=t[e%t.length])!=null?h:"black",c=(d=i[e%i.length])!=null?d:"black";return{marker:pT({fill:l,fillOpacity:n,stroke:c,strokeWidth:s,strokeOpacity:a,lineDash:r,lineDashOffset:o},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}}getLegendData(e){var h;const{processedData:t,dataModel:i,id:s,ctx:{legendManager:n},visible:a}=this;if(!i||!t||e!=="category")return[];const{showInLegend:r}=this.properties,o=[],l=i.resolveColumnById(this,"xValue",t);return((h=t.dataSources.get(this.id))!=null?h:[]).forEach((d,u)=>{const p=l[u];o.push({legendType:"category",id:s,itemId:u,seriesId:s,enabled:a&&n.getItemEnabled({seriesId:s,itemId:u}),label:{text:p},symbol:this.legendItemSymbol(u),hideInLegend:!r})}),o}animateReset(){this.ctx.animationManager.skipCurrentBatch(),this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(){const{datumSelection:e,labelSelection:t,properties:i}=this,s=tMe(i.direction);oMe(this.id,"nodes",this.ctx.animationManager,[e],s),lMe(this,"labels",this.ctx.animationManager,t)}};AC.className="PyramidSeries",AC.type="pyramid";var{commonSeriesOptionsDefs:cMe,pyramidSeriesThemeableOptionsDef:hMe}=R,dMe=E(b(b({},hMe),cMe),{type:ee(Oe("pyramid")),stageKey:ee(z),valueKey:ee(z)}),{ThemeSymbols:{DEFAULT_SHADOW_COLOUR:uMe}}=R,pMe={series:{direction:"vertical",strokeWidth:0,spacing:2,fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},stageLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:12},shadow:{enabled:!1,color:uMe,xOffset:3,yOffset:3,blur:5}}},gMe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"pyramid",moduleFactory:e=>new AC(e),solo:!0,tooltipDefaults:{range:"exact"},themeTemplate:pMe},fMe={type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,options:dMe,create:e=>new AC(e)},{ThemeConstants:{POLAR_AXIS_TYPE:mMe}}=R,h4={series:{stroke:{$palette:"stroke"},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},marker:{enabled:!0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[mMe.ANGLE_CATEGORY]:{label:{spacing:10}}}},yMe=R.mergeDefaults({series:{stroke:R.SAFE_STROKE_FILL_OPERATION,strokeWidth:2}},h4),vMe=R.mergeDefaults({series:{fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,fillOpacity:.8,strokeWidth:2,marker:{enabled:!1,fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS}}},h4),{Label:bMe,SeriesMarker:xMe,SeriesProperties:CMe,SeriesTooltip:SMe,Property:Vn}=R,rn=class extends CMe{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new xMe,this.label=new bMe,this.tooltip=new SMe,this.connectMissingData=!1}};C([Vn],rn.prototype,"angleKey",2),C([Vn],rn.prototype,"radiusKey",2),C([Vn],rn.prototype,"angleName",2),C([Vn],rn.prototype,"radiusName",2),C([Vn],rn.prototype,"stroke",2),C([Vn],rn.prototype,"strokeWidth",2),C([Vn],rn.prototype,"strokeOpacity",2),C([Vn],rn.prototype,"lineDash",2),C([Vn],rn.prototype,"lineDashOffset",2),C([Vn],rn.prototype,"rotation",2),C([Vn],rn.prototype,"marker",2),C([Vn],rn.prototype,"label",2),C([Vn],rn.prototype,"tooltip",2),C([Vn],rn.prototype,"connectMissingData",2);var{ChartAxisDirection:pr,PolarAxis:MMe,SeriesNodePickMode:d4,valueProperty:u4,fixNumericExtent:DMe,seriesLabelFadeInAnimation:wMe,markerFadeInAnimation:AMe,resetMarkerFn:IMe,animationValidation:TMe,computeMarkerFocusBounds:kMe,extent:LMe,BBox:PMe,Group:EMe,Path:RMe,PointerEvents:NMe,Selection:p4,Text:OMe,Marker:FMe,mergeDefaults:BMe,getShapeStyle:_Me}=R,GMe=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey}},gT=class extends R.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"angleValue",useLabelLayer:!0,pickModes:[d4.NEAREST_NODE,d4.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:IMe},clipFocusBox:!1}),this.properties=new rn,this.NodeEvent=GMe,this.lineGroup=this.contentGroup.appendChild(new EMe({name:"radar-line"})),this.lineSelection=p4.select(this.lineGroup,RMe),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0},this.lineGroup.zIndex=0,this.itemGroup.zIndex=1}nodeFactory(){return new FMe}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===pr.Angle)return t.getDomain(this,"angleValue","value",i);{const s=t.getDomain(this,"radiusValue","value",i),n=LMe(s.length===0?s:[0].concat(s));return DMe(n)}}async processData(e){var r,o;const{angleKey:t,radiusKey:i}=this.properties,s=[];this.ctx.animationManager.isSkipped()||s.push(TMe());const n=(r=this.axes[pr.Radius])==null?void 0:r.scale.type,a=(o=this.axes[pr.Angle])==null?void 0:o.scale.type;await this.requestDataModel(e,this.data,{props:[u4(t,a,{id:"angleValue"}),u4(i,n,{id:"radiusValue",invalidValue:void 0}),...s]}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,s=this.circleCache;return e===s.r&&t===s.cx&&i===s.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}getAxisInnerRadius(){const e=this.axes[pr.Radius];return e instanceof MMe?this.radius*e.innerRadiusRatio:0}maybeRefreshNodeData(){var i;if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=(i=this.createNodeData())!=null?i:{};this.nodeData=t,this.nodeDataRefresh=!1}createNodeData(){var f,y,v;const{processedData:e,dataModel:t}=this;if(!e||!t)return;const{angleKey:i,radiusKey:s,angleName:n,radiusName:a,marker:r,label:o}=this.properties,l=(f=this.axes[pr.Angle])==null?void 0:f.scale,c=(y=this.axes[pr.Radius])==null?void 0:y.scale;if(!l||!c)return;const h=t.resolveColumnById(this,"angleValue",e),d=t.resolveColumnById(this,"radiusValue",e),u=this.getAxisInnerRadius(),g=((v=e.dataSources.get(this.id))!=null?v:[]).map((x,S)=>{const M=h[S],D=d[S],A=l.convert(M),w=this.radius+u-c.convert(D),T=Math.cos(A),k=Math.sin(A),N=T*w,O=k*w;let L;if(o.enabled){const F=this.getLabelText(o,{value:D,datum:x,angleKey:i,radiusKey:s,angleName:n,radiusName:a});if(F){let B="right";mt(T,0)?B="center":T>0&&(B="left");let _="bottom";mt(k,0)?_="middle":k>0&&(_="top"),L={x:N+T*r.size,y:O+k*r.size,text:F,textAlign:B,textBaseline:_}}}return{series:this,datum:x,datumIndex:S,index:S,point:{x:N,y:O,size:r.size},midPoint:{x:N,y:O},label:L,angleValue:M,radiusValue:D,missing:!Xe(A)||!Xe(w)}});return{itemId:s,nodeData:g,labelData:g}}update({seriesRect:e}){var n,a;const t=this.checkResize(e),i=!this.ctx.animationManager.isSkipped(),{series:s}=(a=(n=this.ctx.highlightManager)==null?void 0:n.getActiveHighlight())!=null?a:{};this.highlightGroup.visible=(i||this.visible)&&s===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const e=this.visible?[!0]:[];this.lineSelection.update(e)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=p4.select(this.itemGroup,()=>this.nodeFactory(),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(e){var t;return(t=e==null?void 0:e.fill)!=null?t:this.properties.marker.fill}getDatumStylerProperties(e){const{id:t,properties:i}=this,{angleKey:s,radiusKey:n}=i;return{seriesId:t,datum:e,angleKey:s,radiusKey:n}}updateMarkers(e,t){var d;const{visible:i}=this,{marker:s,stroke:n,strokeWidth:a,strokeOpacity:r,highlightStyle:o}=this.properties;let l=[];if(i&&s.shape&&s.enabled)if(t){const u=(d=this.ctx.highlightManager)==null?void 0:d.getActiveHighlight();u!=null&&u.datum&&(l=[u])}else l=this.nodeData;const c=BMe(t&&o.item,s.getStyle(),{stroke:n,strokeWidth:a,strokeOpacity:r}),h=this.getShapeFillBBox();e.update(l).each((u,p)=>{this.updateMarkerStyle(s,u,p.datum,p.point,this.getDatumStylerProperties(p),t,c,h)})}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1})}getTooltipContent(e){var x;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{angleKey:r,angleName:o,radiusKey:l,radiusName:c,tooltip:h,marker:d}=a,u=n[pr.Angle],p=n[pr.Radius];if(!i||!s||!u||!p)return;const g=(x=s.dataSources.get(this.id))==null?void 0:x[e],f=i.resolveColumnById(this,"angleValue",s)[e],y=i.resolveColumnById(this,"radiusValue",s)[e];if(f==null)return;const v=this.getMarkerStyle(d,g,this.getDatumStylerProperties(g),!1);return this.formatTooltipWithContext(h,{heading:u.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:p.formatDatum(y)}]},b({seriesId:t,datum:g,title:o,angleKey:r,radiusKey:l,angleName:o,radiusName:c},v))}legendItemSymbol(){var r,o,l,c,h;const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:s,marker:n}=this.properties;return{marker:_Me({shape:n.shape,enabled:n.enabled||t<=0,fill:(l=(o=(r=this.getMarkerFill())!=null?r:n.stroke)!=null?o:e)!=null?l:"rgba(0, 0, 0, 0)",stroke:(h=(c=n.stroke)!=null?c:e)!=null?h:"rgba(0, 0, 0, 0)",fillOpacity:n.fillOpacity,strokeOpacity:n.strokeOpacity,strokeWidth:n.strokeWidth,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset},n.fillGradientDefaults,n.fillPatternDefaults,n.fillImageDefaults),line:{stroke:e,strokeOpacity:i,strokeWidth:t,lineDash:s}}}getLegendData(e){if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{radiusKey:n,radiusName:a,showInLegend:r}=this.properties;return[{legendType:"category",id:t,itemId:n,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:a!=null?a:n},symbol:this.legendItemSymbol(),hideInLegend:!r}]}pickNodeClosestDatum(e){var h,d;const{nodeData:t,centerX:i,centerY:s}=this,{x:n,y:a}=e,r=this.radius;if(Math.sqrt((n-i)**2+(a-s)**2)>r+this.properties.marker.size)return;let l=1/0,c;for(const u of t){const{point:{x:p=NaN,y:g=NaN}={}}=u;if(isNaN(p)||isNaN(g))continue;const f=Math.sqrt((e.x-p-i)**2+(e.y-g-s)**2);f<l&&(l=f,c=u)}if(c){const u=Math.max(l-((d=(h=c.point)==null?void 0:h.size)!=null?d:0),0);return{datum:c,distance:u}}}computeLabelsBBox(){const{label:e}=this.properties;this.maybeRefreshNodeData();const t=[],i=new OMe;return this.nodeData.forEach(s=>{if(!e.enabled||!s.label)return;i.text=s.label.text,i.x=s.label.x,i.y=s.label.y,i.setFont(e),i.setAlign(s.label);const n=i.getBBox();t.push(n)}),t.length===0?null:PMe.merge(t)}getLineNode(){var e;return(e=this.lineSelection)==null?void 0:e.at(0)}beforePathAnimation(){const e=this.getLineNode();e&&(e.fill=void 0,e.lineJoin="round",e.lineCap="round",e.pointerEvents=NMe.None,e.stroke=this.properties.stroke,e.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),e.strokeOpacity=this.properties.strokeOpacity,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset)}getLinePoints(){const{nodeData:e,resetInvalidToZero:t}=this,{connectMissingData:i}=this.properties;if(e.length===0)return[];const s=this.axes[pr.Radius],n=this.axes[pr.Angle],a=n==null?void 0:n.isReversed(),o=(s==null?void 0:s.isReversed())&&!a?[...e].reverse():e,l=[];let c=!1,h;return o.forEach((d,u)=>{let{x:p,y:g}=d.point;const f=isNaN(p)||isNaN(g);f||h!=null||(h=d),f&&!i&&(p=0,g=0);const y=u===0||!t&&!i&&(f||c);l.push({x:p,y:g,moveTo:y}),c=f}),h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(e,t,i){const{path:s}=e;s.clear(!0);const n=this.getAxisInnerRadius(),a=this.axes[pr.Radius],o=(a==null?void 0:a.isReversed())?this.radius+n-(a==null?void 0:a.scale.convert(0)):n;t.forEach(l=>{const{x:c,y:h,arc:d,radius:u=0,startAngle:p=0,endAngle:g=0,moveTo:f}=l,y=Math.atan2(h,c),v=o*Math.cos(y),x=o*Math.sin(y),S=i,M=v*(1-S)+c*S,D=x*(1-S)+h*S;d?s.arc(c,h,u,p,g):f?s.moveTo(M,D):s.lineTo(M,D)}),e.checkPathDirty()}animatePaths(e){const t=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,t,e)}animateEmptyUpdateReady(){const{itemSelection:e,labelSelection:t}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:s=>this.animatePaths(s),onStop:()=>this.animatePaths(1)}),AMe(this,i,"added",e),wMe(this,"labels",i,t)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e),this.resetPaths()}animateReadyResize(e){super.animateReadyResize(e),this.resetPaths()}resetPaths(){const e=this.getLineNode();if(e){const{path:t}=e,i=this.getLinePoints();e.fill=void 0,e.stroke=this.properties.stroke,e.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),e.strokeOpacity=this.properties.strokeOpacity,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset,t.clear(!0);for(const{x:s,y:n,moveTo:a}of i)a?t.moveTo(s,n):t.lineTo(s,n);e.checkPathDirty()}}getFormattedMarkerStyle(e){const{angleKey:t,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,e.datum,{angleKey:t,radiusKey:i},!0)}computeFocusBounds(e){return kMe(this,e)}};gT.className="RadarSeries";var{FillGradientDefaults:zMe,FillPatternDefaults:VMe,FillImageDefaults:jMe,Property:Cm}=R,Tp=class extends rn{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new zMe,this.fillPatternDefaults=new VMe,this.fillImageDefaults=new jMe,this.fillOpacity=1}};C([Cm],Tp.prototype,"fill",2),C([Cm],Tp.prototype,"fillGradientDefaults",2),C([Cm],Tp.prototype,"fillPatternDefaults",2),C([Cm],Tp.prototype,"fillImageDefaults",2),C([Cm],Tp.prototype,"fillOpacity",2);var{Group:HMe,Path:WMe,PointerEvents:UMe,Selection:KMe,ChartAxisDirection:g4,applyShapeStyle:f4,getShapeFill:$Me,getShapeStyle:YMe}=R,IC=class extends gT{constructor(e){super(e),this.properties=new Tp,this.areaGroup=this.contentGroup.appendChild(new HMe({name:"radar-area"})),this.areaSelection=KMe.select(this.areaGroup,WMe),this.resetInvalidToZero=!0,this.areaGroup.zIndex=-1}updatePathSelections(){const e=this.visible?[!0]:[];this.areaSelection.update(e),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(e){var t,i;return(i=(t=e==null?void 0:e.fill)!=null?t:this.properties.marker.fill)!=null?i:this.properties.fill}beforePathAnimation(){super.beforePathAnimation();const e=this.getAreaNode(),{fillOpacity:t,fill:i}=this.properties,s=YMe({fill:i,fillOpacity:t},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults);f4(e,s,void 0,this.getShapeFillBBox()),e.pointerEvents=UMe.None,e.stroke=void 0}animatePaths(e){super.animatePaths(e),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),e)}getAreaPoints(){var r,o;const e=this.getLinePoints(),t=l=>{const c=this.axes[l];return c instanceof R.PolarAxis?c:void 0},i=t(g4.Radius),s=t(g4.Angle);if(!(i==null?void 0:i.isReversed()))return e;const a=(o=(r=s==null?void 0:s.getAxisLinePoints())==null?void 0:r.points)!=null?o:[];return e.concat(...a)}resetPaths(){super.resetPaths();const e=this.getAreaNode();if(e){const{path:t}=e,i=this.getAreaPoints(),s=$Me(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults),n=this.getShapeFillBBox();f4(e,{fill:s,stroke:void 0,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset},void 0,n),e.lineJoin=e.lineCap="round",t.clear(!0),i.forEach(({x:a,y:r,moveTo:o,arc:l,radius:c=0,startAngle:h=0,endAngle:d=0})=>{l?t.arc(a,r,c,h,d):o?t.moveTo(a,r):t.lineTo(a,r)}),t.closePath(),e.checkPathDirty()}}};IC.className="RadarAreaSeries",IC.type="radar-area";var{commonSeriesOptionsDefs:XMe,radarAreaSeriesThemeableOptionsDef:ZMe}=R,qMe=E(b(b({},ZMe),XMe),{type:ee(Oe("radar-area")),angleKey:ee(z),radiusKey:ee(z),angleName:z,radiusName:z}),{ThemeConstants:{POLAR_AXIS_TYPE:m4}}=R,QMe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",moduleFactory:e=>new IC(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:m4.ANGLE_CATEGORY},{type:m4.RADIUS_NUMBER}],themeTemplate:vMe},JMe={type:"series",name:"radar-area",chartType:"polar",enterprise:!0,options:qMe,create:e=>new IC(e)},TC=class extends gT{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};TC.className="RadarLineSeries",TC.type="radar-line";var{commonSeriesOptionsDefs:eDe,radarLineSeriesThemeableOptionsDef:tDe}=R,iDe=E(b(b({},tDe),eDe),{type:ee(Oe("radar-line")),angleKey:ee(z),radiusKey:ee(z),angleName:z,radiusName:z}),{POLAR_AXIS_TYPE:y4}=R.ThemeConstants,sDe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",moduleFactory:e=>new TC(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:y4.ANGLE_CATEGORY},{type:y4.RADIUS_NUMBER}],themeTemplate:yMe},nDe={type:"series",name:"radar-line",chartType:"polar",enterprise:!0,options:iDe,create:e=>new TC(e)},{SeriesProperties:aDe,FillGradientDefaults:rDe,FillPatternDefaults:oDe,FillImageDefaults:lDe,SeriesTooltip:cDe,Property:Fi,Label:hDe}=R,wi=class extends aDe{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new rDe,this.fillPatternDefaults=new oDe,this.fillImageDefaults=new lDe,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new hDe,this.tooltip=new cDe}};C([Fi],wi.prototype,"angleKey",2),C([Fi],wi.prototype,"radiusKey",2),C([Fi],wi.prototype,"angleName",2),C([Fi],wi.prototype,"radiusName",2),C([Fi],wi.prototype,"fill",2),C([Fi],wi.prototype,"fillGradientDefaults",2),C([Fi],wi.prototype,"fillPatternDefaults",2),C([Fi],wi.prototype,"fillImageDefaults",2),C([Fi],wi.prototype,"fillOpacity",2),C([Fi],wi.prototype,"stroke",2),C([Fi],wi.prototype,"strokeWidth",2),C([Fi],wi.prototype,"strokeOpacity",2),C([Fi],wi.prototype,"lineDash",2),C([Fi],wi.prototype,"lineDashOffset",2),C([Fi],wi.prototype,"cornerRadius",2),C([Fi],wi.prototype,"itemStyler",2),C([Fi],wi.prototype,"rotation",2),C([Fi],wi.prototype,"stackGroup",2),C([Fi],wi.prototype,"normalizedTo",2),C([Fi],wi.prototype,"label",2),C([Fi],wi.prototype,"tooltip",2);var{SectorBox:v4,motion:dDe}=R;function uDe(e,t,i){if(i==="updated"){if(e.previousDatum==null||isNaN(e.previousDatum.innerRadius)||isNaN(e.previousDatum.outerRadius))return"added";if(isNaN(t.innerRadius)||isNaN(t.outerRadius))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function b4(e){return{toFn:(s,n,a)=>{let r,o,l,c,h;return a==="removed"?(r=e,o=e,l=n.innerRadius,c=n.outerRadius,h=new v4(r,o,l,c)):(r=n.startAngle,o=n.endAngle,l=isNaN(n.innerRadius)?s.innerRadius:n.innerRadius,c=isNaN(n.outerRadius)?s.outerRadius:n.outerRadius,h=n.clipSector),{startAngle:r,endAngle:o,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(s,n,a)=>{a=uDe(s,n,a);let r,o,l,c,h;a==="removed"||a==="updated"?(r=s.startAngle,o=s.endAngle,l=s.innerRadius,c=s.outerRadius,h=s.clipSector):(r=e,o=e,l=n.innerRadius,c=n.outerRadius),h!=null||(h=new v4(r,o,l,c));const d=dDe.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:r,endAngle:o,innerRadius:l,outerRadius:c,clipSector:h,phase:d}}}}function pDe(e,t){return{centerX:0,centerY:0,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle,clipSector:t.clipSector}}var{ChartAxisDirection:oo,PolarAxis:gDe,diff:fDe,groupAccumulativeValueProperty:x4,keyProperty:mDe,normaliseGroupTo:yDe,valueProperty:vDe,fixNumericExtent:bDe,resetLabelFn:xDe,seriesLabelFadeInAnimation:CDe,seriesLabelFadeOutAnimation:SDe,animationValidation:MDe,angleBetween:DDe,createDatumId:C4,CategoryScale:wDe,Sector:ADe,SectorBox:IDe,motion:S4,isGradientFill:TDe,applyShapeStyle:kDe,getShapeStyle:fT}=R,LDe=class extends R.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey}},kC=class extends R.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"radiusValue",useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:pDe,label:xDe}}),this.properties=new wi,this.NodeEvent=LDe,this.groupScale=new wDe,this.circleCache={r:0,cx:0,cy:0}}get defaultShapeStyle(){var t;const e=(t=this.axes[oo.Angle])==null?void 0:t.scale;return E(b({},this.properties.fillGradientDefaults.toJson()),{rotation:R.toDegrees(e.range[0])+90})}nodeFactory(){return new ADe}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===oo.Angle){const s=t.getDomain(this,"angleValue-end","value",i),n=[s[0]>0?0:s[0],s[1]<0?0:s[1]];return bDe(n)}else return t.getDomain(this,"radiusValue","key",i)}async processData(e){var d,u;const{angleKey:t,radiusKey:i,normalizedTo:s}=this.properties,n=!this.ctx.animationManager.isSkipped(),a=this.getStackId(),r=`${a}-trailing`,o=[];ni(s)&&o.push(yDe([a,r],Math.abs(s))),n&&(this.processedData&&o.push(fDe(this.id,this.processedData)),o.push(MDe()));const l=this.visible?{}:{forceValue:0},c=(d=this.axes[oo.Radius])==null?void 0:d.scale.type,h=(u=this.axes[oo.Angle])==null?void 0:u.scale.type;await this.requestDataModel(e,this.data,{props:[mDe(i,c,{id:"radiusValue"}),vDe(t,h,b({id:"angleValue-raw",invalidValue:null},l)),...x4(t,"normal","current",b({id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:a,separateNegative:!0},l),h),...x4(t,"trailing","current",b({id:"angleValue-start",invalidValue:null,groupId:r,separateNegative:!0},l),h),...o],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,s=this.circleCache;return e===s.r&&t===s.cx&&i===s.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}maybeRefreshNodeData(){var i;if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=(i=this.createNodeData())!=null?i:{};this.nodeData=t,this.nodeDataRefresh=!1}getAxisInnerRadius(){const e=this.axes[oo.Radius];return e instanceof gDe?this.radius*e.innerRadiusRatio:0}createNodeData(){var _,G;const{processedData:e,dataModel:t}=this;if(!t||!e||e.type!=="grouped")return;const i=this.axes[oo.Angle],s=this.axes[oo.Radius],n=i==null?void 0:i.scale,a=s==null?void 0:s.scale;if(!n||!a)return;const r=t.resolveKeysById(this,"radiusValue",e),o=t.resolveColumnById(this,"angleValue-start",e),l=t.resolveColumnById(this,"angleValue-end",e),c=t.resolveColumnById(this,"angleValue-raw",e),h=t.resolveProcessedDataIndexById(this,"angleValue-range");let d=0;s instanceof rc&&(d=s.groupPaddingInner);const{groupScale:u}=this,{index:p,visibleGroupCount:g}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:g}).map((V,j)=>String(j)),u.range=[0,Math.abs((_=a.bandwidth)!=null?_:0)],u.paddingInner=g>1?d:0;const f=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,y=i.isReversed(),v=s.isReversed(),x=v?this.radius:this.getAxisInnerRadius(),M=(v?this.getAxisInnerRadius():this.radius)+x,{angleKey:D,radiusKey:A,angleName:w,radiusName:T,label:k}=this.properties,N=(V,j,H,U)=>{const $=this.getLabelText(k,{value:j,datum:V,angleKey:D,radiusKey:A,angleName:w,radiusName:T});if($)return{x:H,y:U,text:$,textAlign:"center",textBaseline:"middle"}},O=[],L={itemId:A,nodeData:O,labelData:O};if(!this.visible)return L;const{dataSources:F}=e,B=(G=F.get(this.id))!=null?G:[];for(const{datumIndex:V,group:j}of t.forEachGroupDatum(this,e)){const H=B[V],U=r[V];if(U==null)return;const $=c[V],W=o[V],Y=l[V],K=$>=0&&!Object.is($,-0),Q=j.aggregation[h][K?1:0],Z=K===y;let J=n.convert(W,{clamp:!0}),ae=n.convert(Y,{clamp:!0}),oe=n.convert(0,{clamp:!0}),le=n.convert(Q,{clamp:!0});Z&&([oe,le]=[le,oe],[J,ae]=[ae,J]);const ue=M-a.convert(U)+u.convert(String(p)),ie=ue+f,re=(ue+ie)/2,te=J+DDe(J,ae)/2,fe=Math.cos(te)*re,me=Math.sin(te)*re,Le=this.properties.label.enabled?N(H,$,fe,me):void 0,Ee=new IDe(J,ae,ue,ie);O.push({series:this,datum:H,datumIndex:V,point:{x:fe,y:me,size:0},midPoint:{x:fe,y:me},label:Le,angleValue:$,radiusValue:U,innerRadius:ue,outerRadius:ie,startAngle:oe,endAngle:le,clipSector:Ee,reversed:Z,index:V})}return L}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(e){var s,n,a,r,o,l,c;const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return fT({fill:(s=i==null?void 0:i.fill)!=null?s:t.fill,fillOpacity:(n=i==null?void 0:i.fillOpacity)!=null?n:t.fillOpacity,stroke:(a=i==null?void 0:i.stroke)!=null?a:t.stroke,strokeWidth:(r=i==null?void 0:i.strokeWidth)!=null?r:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(o=i==null?void 0:i.strokeOpacity)!=null?o:t.strokeOpacity,lineDash:(l=i==null?void 0:i.lineDash)!=null?l:t.lineDash,lineDashOffset:(c=i==null?void 0:i.lineDashOffset)!=null?c:t.lineDashOffset,cornerRadius:t.cornerRadius},this.defaultShapeStyle,t.fillPatternDefaults,t.fillImageDefaults)}getItemStyleOverrides(e,t,i,s){const{id:n,properties:a}=this,{angleKey:r,radiusKey:o,itemStyler:l}=a;let c;return l!=null&&(c=this.cachedDatumCallback(C4(e,s?"highlight":"node"),()=>this.callWithContext(l,b({seriesId:n,datum:t,highlighted:s,angleKey:r,radiusKey:o},i)))),fT(c,this.defaultShapeStyle,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateSectorSelection(e,t){var a;let i=[];if(t){const r=(a=this.ctx.highlightManager)==null?void 0:a.getActiveHighlight();r!=null&&r.datum&&r.series===this&&i.push(r)}else i=this.nodeData;const s=this.getItemBaseStyle(t),n=this.getShapeFillBBox();e.update(i,void 0,r=>this.getDatumId(r)).each((r,o)=>{var g,f;const{datum:l,datumIndex:c}=o,h=this.getItemStyleOverrides(String(c),l,s,t),d=(g=h==null?void 0:h.cornerRadius)!=null?g:s.cornerRadius,u=(f=h==null?void 0:h.fill)!=null?f:s.fill,p=R.isGradientFill(u)&&u.bounds!=="item"?{centerX:0,centerY:0}:void 0;kDe(r,s,h,n,p),r.lineJoin="round",r.inset=r.stroke!=null?r.strokeWidth/2:0,r.startInnerCornerRadius=l.reversed?d:0,r.startOuterCornerRadius=l.reversed?d:0,r.endInnerCornerRadius=l.reversed?0:d,r.endOuterCornerRadius=l.reversed?0:d,t&&(r.startAngle=o.startAngle,r.endAngle=o.endAngle,r.clipSector=o.clipSector,r.innerRadius=o.innerRadius,r.outerRadius=o.outerRadius)})}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1})}getBarTransitionFunctions(){var n;const e=(n=this.axes[oo.Angle])==null?void 0:n.scale;let t=0;if(!e)return b4(t);const i=Math.min(e.domain[0],e.domain[1]),s=Math.max(e.domain[0],e.domain[1]);return i<=0&&s>=0&&(t=e.convert(0)),b4(t)}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getBarTransitionFunctions();S4.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),CDe(this,"labels",this.ctx.animationManager,e)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getBarTransitionFunctions();S4.fromToMotion(this.id,"datums",t,[e],i),SDe(this,"labels",t,this.labelSelection)}getTooltipContent(e){var v;const{id:t,dataModel:i,processedData:s,axes:n,properties:a}=this,{angleKey:r,angleName:o,radiusKey:l,radiusName:c,tooltip:h}=a,d=n[oo.Angle],u=n[oo.Radius];if(!i||!s||!d||!u)return;const p=(v=s.dataSources.get(this.id))==null?void 0:v[e],g=i.resolveKeysById(this,"radiusValue",s)[e],f=i.resolveColumnById(this,"angleValue-raw",s)[e];if(g==null)return;const y=this.getItemBaseStyle(!1);return Object.assign(y,this.getItemStyleOverrides(String(e),e,y,!1)),this.formatTooltipWithContext(h,{heading:u.formatDatum(g),symbol:this.legendItemSymbol(),data:[{label:o,fallbackLabel:r,value:d.formatDatum(f)}]},b({seriesId:t,datum:p,title:o,angleKey:r,angleName:o,radiusKey:l,radiusName:c},y))}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r,fillPatternDefaults:o,fillImageDefaults:l}=this.properties,c=fT({fill:e!=null?e:"rgba(0, 0, 0, 0)",stroke:t!=null?t:"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:a,lineDashOffset:r},this.defaultShapeStyle,o,l);return TDe(c.fill)&&(c.fill=E(b({},c.fill),{gradient:"linear",rotation:0,reverse:!1})),{marker:c}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{angleKey:s,angleName:n,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:i,label:{text:n!=null?n:s},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(e){return C4(e.radiusValue)}computeLabelsBBox(){return null}getStackId(){var t,i;return`radialBar-stack-${(i=(t=this.seriesGrouping)==null?void 0:t.groupIndex)!=null?i:this.id}-xValues`}};kC.className="RadialBarSeries",kC.type="radial-bar";var{commonSeriesOptionsDefs:PDe,radialBarSeriesThemeableOptionsDef:EDe}=R,RDe=E(b(b({},EDe),PDe),{type:ee(Oe("radial-bar")),angleKey:ee(z),radiusKey:ee(z),angleName:z,radiusName:z,grouped:q,stacked:q,stackGroup:z,normalizedTo:ne}),{ThemeConstants:{POLAR_AXIS_TYPE:NDe}}=R,ODe={series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"conic",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}}},axes:{[NDe.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},{POLAR_AXIS_TYPE:M4}=R.ThemeConstants,FDe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",moduleFactory:e=>new kC(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:M4.ANGLE_NUMBER},{type:M4.RADIUS_CATEGORY}],themeTemplate:ODe,stackable:!0,groupable:!0},BDe={type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,options:RDe,create:e=>new kC(e)},{Property:D4}=R,mT=class extends mi{};C([D4],mT.prototype,"columnWidthRatio",2),C([D4],mT.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:_De,PolarAxis:GDe,RadialColumnShape:zDe,getRadialColumnWidth:VDe}=R,LC=class extends QV{constructor(e){super(e,{animationResetFns:{item:O0e}}),this.properties=new mT}getStackId(){var t,i;return`radarColumn-stack-${(i=(t=this.seriesGrouping)==null?void 0:t.groupIndex)!=null?i:this.id}-yValues`}nodeFactory(){return new zDe}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return N0e(e)}isRadiusAxisCircle(){const e=this.axes[_De.Radius];return e instanceof GDe?e.shape==="circle":!1}updateItemPath(e,t,i){e.isBeveled=this.isRadiusAxisCircle(),e.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e.startAngle=t.startAngle,e.endAngle=t.endAngle,e.columnWidth=t.columnWidth,e.axisInnerRadius=t.axisInnerRadius,e.axisOuterRadius=t.axisOuterRadius)}getColumnWidth(e,t){const{columnWidthRatio:i=.5,maxColumnWidthRatio:s=.5}=this.properties;return VDe(e,t,this.radius,i,s)}};LC.className="RadialColumnSeries",LC.type="radial-column";var{commonSeriesOptionsDefs:jDe,radialColumnSeriesThemeableOptionsDef:HDe}=R,WDe=E(b(b({},HDe),jDe),{type:ee(Oe("radial-column")),angleKey:ee(z),radiusKey:ee(z),angleName:z,radiusName:z,grouped:q,stacked:q,stackGroup:z,normalizedTo:ne}),{ThemeConstants:{POLAR_AXIS_TYPE:w4,POLAR_AXIS_SHAPE:UDe}}=R,A4={$path:["./shape",UDe.CIRCLE,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]},KDe={series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},axes:{[w4.ANGLE_CATEGORY]:{shape:A4,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[w4.RADIUS_NUMBER]:{shape:A4,innerRadiusRatio:.5}}},{POLAR_AXIS_TYPE:I4}=R.ThemeConstants,$De={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",moduleFactory:e=>new LC(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:I4.ANGLE_CATEGORY},{type:I4.RADIUS_NUMBER}],themeTemplate:KDe,stackable:!0,groupable:!0},YDe={type:"series",name:"radial-column",chartType:"polar",enterprise:!0,options:WDe,create:e=>new LC(e)},{SvgPath:XDe,Rotatable:ZDe,Translatable:qDe,Scalable:QDe}=R,yT=class extends ZDe(QDe(qDe(XDe))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};yT.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";var{BaseProperties:Sm,SeriesTooltip:JDe,SeriesProperties:ewe,PropertiesArray:vT,AxisLabel:twe,Property:Se,Label:iwe}=R,T4=class extends iwe{};C([Se],T4.prototype,"spacing",2);var Bs=class extends Sm{constructor(){super(...arguments),this.label=new T4}};C([Se],Bs.prototype,"text",2),C([Se],Bs.prototype,"value",2),C([Se],Bs.prototype,"shape",2),C([Se],Bs.prototype,"placement",2),C([Se],Bs.prototype,"spacing",2),C([Se],Bs.prototype,"size",2),C([Se],Bs.prototype,"rotation",2),C([Se],Bs.prototype,"fill",2),C([Se],Bs.prototype,"fillOpacity",2),C([Se],Bs.prototype,"stroke",2),C([Se],Bs.prototype,"strokeWidth",2),C([Se],Bs.prototype,"strokeOpacity",2),C([Se],Bs.prototype,"lineDash",2),C([Se],Bs.prototype,"lineDashOffset",2),C([Se],Bs.prototype,"label",2);var gr=class extends Sm{constructor(){super(...arguments),this.enabled=!0,this.fills=new vT(R.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};C([Se],gr.prototype,"enabled",2),C([Se],gr.prototype,"fills",2),C([Se],gr.prototype,"fillMode",2),C([Se],gr.prototype,"fill",2),C([Se],gr.prototype,"fillOpacity",2),C([Se],gr.prototype,"stroke",2),C([Se],gr.prototype,"strokeWidth",2),C([Se],gr.prototype,"strokeOpacity",2),C([Se],gr.prototype,"lineDash",2),C([Se],gr.prototype,"lineDashOffset",2);var Mm=class extends Sm{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};C([Se],Mm.prototype,"values",2),C([Se],Mm.prototype,"step",2),C([Se],Mm.prototype,"minSpacing",2),C([Se],Mm.prototype,"maxSpacing",2);var swe=class extends twe{},Cn=class extends Sm{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new vT(R.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Mm,this.label=new swe}};C([Se],Cn.prototype,"min",2),C([Se],Cn.prototype,"max",2),C([Se],Cn.prototype,"fills",2),C([Se],Cn.prototype,"fillMode",2),C([Se],Cn.prototype,"fill",2),C([Se],Cn.prototype,"fillOpacity",2),C([Se],Cn.prototype,"stroke",2),C([Se],Cn.prototype,"strokeWidth",2),C([Se],Cn.prototype,"strokeOpacity",2),C([Se],Cn.prototype,"lineDash",2),C([Se],Cn.prototype,"lineDashOffset",2),C([Se],Cn.prototype,"defaultFill",2),C([Se],Cn.prototype,"interval",2),C([Se],Cn.prototype,"label",2);var fr=class extends Sm{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};C([Se],fr.prototype,"enabled",2),C([Se],fr.prototype,"radiusRatio",2),C([Se],fr.prototype,"spacing",2),C([Se],fr.prototype,"fill",2),C([Se],fr.prototype,"fillOpacity",2),C([Se],fr.prototype,"stroke",2),C([Se],fr.prototype,"strokeWidth",2),C([Se],fr.prototype,"strokeOpacity",2),C([Se],fr.prototype,"lineDash",2),C([Se],fr.prototype,"lineDashOffset",2);var k4=class extends no{};C([Se],k4.prototype,"text",2);var L4=class extends dm{};C([Se],L4.prototype,"text",2);var Bi=class extends ewe{constructor(){super(...arguments),this.startAngle=0,this.endAngle=0,this.segmentation=new fm,this.defaultColorRange=[],this.targets=new vT(Bs),this.defaultTarget=new Bs,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new Cn,this.bar=new gr,this.needle=new fr,this.label=new k4,this.secondaryLabel=new L4,this.tooltip=new JDe}};C([Se],Bi.prototype,"value",2),C([Se],Bi.prototype,"startAngle",2),C([Se],Bi.prototype,"endAngle",2),C([Se],Bi.prototype,"segmentation",2),C([Se],Bi.prototype,"defaultColorRange",2),C([Se],Bi.prototype,"targets",2),C([Se],Bi.prototype,"defaultTarget",2),C([Se],Bi.prototype,"outerRadiusRatio",2),C([Se],Bi.prototype,"innerRadiusRatio",2),C([Se],Bi.prototype,"outerRadius",2),C([Se],Bi.prototype,"innerRadius",2),C([Se],Bi.prototype,"cornerRadius",2),C([Se],Bi.prototype,"cornerMode",2),C([Se],Bi.prototype,"spacing",2),C([Se],Bi.prototype,"scale",2),C([Se],Bi.prototype,"bar",2),C([Se],Bi.prototype,"needle",2),C([Se],Bi.prototype,"label",2),C([Se],Bi.prototype,"secondaryLabel",2),C([Se],Bi.prototype,"tooltip",2);var{SectorBox:bT}=R;function nwe(e){const{startAngle:t,endAngle:i,clipStartAngle:s,clipEndAngle:n,innerRadius:a,outerRadius:r}=e;if(!(s==null||n==null))return new bT(Math.max(s,t),Math.min(n,i),a,r)}function P4(e,t,i){return Math.max(e,i.startAngle)<=Math.min(t,i.endAngle)}function xT(e){return e.clipStartAngle!=null&&e.clipEndAngle!=null}function CT(e,t){const{clipStartAngle:i,clipEndAngle:s,innerRadius:n,outerRadius:a}=e;return new bT(i,t?i:s,n,a)}function E4(e,t){const i=e?"initial":"update";return{node:{fromFn(a,r){const o=a.previousDatum;let{startAngle:l,endAngle:c}=o!=null?o:r;const h=o!=null&&xT(o)?CT(o,e):void 0,d=xT(r)?CT(r,e):void 0;let u;return h!=null&&d!=null?u=h:h==null&&d!=null?(u=d,l=r.startAngle,c=r.endAngle):h!=null&&d==null?(u=void 0,l=r.startAngle,c=r.endAngle):e&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(a,r){const{startAngle:o,endAngle:l}=r;let c;return xT(r)&&(c=CT(r,!1)),{startAngle:o,endAngle:l,clipSector:c}},applyFn(a,r){const{startAngle:o,endAngle:l}=r;let{clipSector:c}=r;c!=null&&(c=new bT(Math.max(o,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const h=c==null||P4(o,l,c);a.startAngle=o,a.endAngle=l,a.clipSector=c,a.visible=h}},needle:{fromFn(a){var o;let{angle:r}=(o=a.previousDatum)!=null?o:a.datum;return e&&(r=t),{rotation:r,phase:i}},toFn(a,r){const{angle:o}=r;return{rotation:o}}}}}function ST(e,t){const{startAngle:i,endAngle:s}=t,n=nwe(t),a=n==null||P4(i,s,n);return{startAngle:i,endAngle:s,clipSector:n,visible:a}}function R4(e,t){const{angle:i}=t;return{rotation:i}}var awe={top:0,middle:.5,bottom:1};function rwe(e,t,i,s,n,a){var D,A;const{padding:r,textAlign:o,verticalAlign:l}=s;let c,h;if(i.each((w,T)=>{T.label==="primary"?c=T:T.label==="secondary"&&(h=T)}),c==null)return;const d=gm(e.id,t,c,a==null?void 0:a.label);if(d==null)return;const u=h!=null?gm(e.id,t,h,a==null?void 0:a.secondaryLabel):void 0,p={padding:r},g=o==="center"?2:1,f=l==="middle"?2:1,y=w=>({width:Math.sqrt(Math.max(n**2-(w/f)**2,0))*g,height:Math.min(w,f*n),meta:null});let v,x,S;if(h!=null&&u!=null){const w=ez(d,c,u,h,p,y);v=w==null?void 0:w.label,x=w==null?void 0:w.secondaryLabel,S=(D=w==null?void 0:w.height)!=null?D:0}else{const w=cm(d,c,p,y);v=w==null?void 0:w[0],x=void 0,S=(A=w==null?void 0:w[0].height)!=null?A:0}const M=S*awe[l];i.each((w,T)=>{let k;if(T.label==="primary"?k=v:T.label==="secondary"&&(k=x),k==null){w.visible=!1;return}w.visible=!0,w.text=k.text,w.fontSize=k.fontSize,w.lineHeight=k.lineHeight,w.textAlign=o,w.textBaseline="middle";const N=T.label==="primary"?k.height/2:S-k.height/2;w.y=T.centerY+N-M,w.x=T.centerX})}var{fromToMotion:Dm,resetMotion:N4,CachedTextMeasurerPool:owe,SeriesNodePickMode:O4,StateMachine:lwe,createDatumId:MT,normalizeAngle360:F4,normalizeAngle360Inclusive:DT,isBetweenAngles:PC,sectorBox:cwe,toDegrees:hwe,toRadians:EC,BBox:dwe,Group:Ec,PointerEvents:RC,Selection:Rc,Sector:uwe,SectorBox:pwe,Text:B4,Marker:gwe,getColorStops:fwe}=R,mwe={inside:90,middle:0,outside:-90},ywe=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],vwe=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],NC=class extends R.Series{constructor(e){super({moduleCtx:e,useLabelLayer:!0,pickModes:[O4.EXACT_SHAPE_MATCH,O4.NEAREST_NODE]}),this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.properties=new Bi,this.scale=new W2,this.scaleGroup=this.contentGroup.appendChild(new Ec({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Ec({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new Ec({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Ec({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Ec({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Ec({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Ec({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new Ec({name:"tickGroup"})),this.scaleSelection=Rc.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Rc.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=Rc.select(this.itemNeedleGroup,yT),this.targetSelection=Rc.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=Rc.select(this.itemTargetLabelGroup,B4),this.labelSelection=Rc.select(this.itemLabelGroup,B4),this.highlightTargetSelection=Rc.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=Rc.select(this.tickGroup,R.TransformableText),this.datumUnion=new pV,this.animationState=new lwe("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=RC.None,this.tickGroup.pointerEvents=RC.None,this.itemNeedleGroup.pointerEvents=RC.None,this.itemLabelGroup.pointerEvents=RC.None}get hasData(){return this.properties.value!=null}nodeFactory(){return new uwe}markerFactory(){const e=new gwe;return e.size=1,e}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){const{min:t,max:i}=this.properties.scale;return fV(e,{min:t,max:i})}layoutScale(){var Q,Z,J;const{scale:e,properties:t}=this,{seriesRectWidth:i,seriesRectHeight:s}=this.nodeDataDependencies,{scale:n,outerRadius:a}=this.properties,{min:r,max:o,label:l,interval:c}=n,h=EC(t.startAngle-90),d=EC(t.endAngle-90),p=DT(d-h)>Math.PI,g=p||PC(1.5*Math.PI,h,d),f=p||PC(0*Math.PI,h,d),y=p||PC(.5*Math.PI,h,d),v=p||PC(1*Math.PI,h,d);let x;v&&!f?x="right":!v&&f?x="left":x="center";let S;g&&!y?S="bottom":!g&&y?S="top":S="middle";const M=cwe({startAngle:h,endAngle:d,innerRadius:0,outerRadius:.5}),D=-(M.x+M.width/2)*2,A=-(M.y+M.height/2)*2,w=Math.min(i/M.width,s/M.height);e.domain=[r,o],e.range=[h,d],e.arcLength=w/2;const{maxSpacing:T,minSpacing:k}=c,{arcLength:N}=e,O=T?Math.floor(N/T):1,L=k?Math.floor(N/k):1/0,F=Math.floor(4/Math.PI*Math.abs(e.range[0]-e.range[1])),B=Math.max(O,Math.min(L,F)),_=(J=(Z=c.values)!=null?Z:(Q=e.ticks({nice:!1,interval:c.step,minTickCount:O,maxTickCount:L,tickCount:B}))==null?void 0:Q.ticks)!=null?J:[],G=_.reduce((ae,oe)=>Math.max(ae,typeof oe=="number"?Ud(oe):0),0),V=e.tickFormatter({domain:e.domain,ticks:_,fractionDigits:G,specifier:typeof l.format=="string"?l.format:void 0}),j=l.getFont(),H=_.map((ae,oe)=>{let le;l.formatter&&(le=KI(this.ctx,l.formatter,{value:ae,index:oe,domain:e.domain,boundSeries:void 0})),le===void 0&&(le=V(ae));const{width:de,height:ue}=owe.measureText(le,{font:j});return{index:oe,value:ae,text:le,width:de,height:ue}}),U=H.reduce((ae,oe)=>Math.max(ae,oe.width),0),$=H.reduce((ae,oe)=>Math.max(ae,oe.height),0),W=l.enabled?Math.max(U,$)+l.spacing:0,Y=Math.max(.5*w-W,0),K=a!=null?a:Y;return this.centerX=i/2+D*K,this.centerY=s/2+A*K,this.radius=K,this.textAlign=x,this.verticalAlign=S,H}createConicGradient(e,t){const{scale:i}=this,{domain:s,range:n}=i,[a,r]=n,{defaultColorRange:o}=this.properties,l=F4((a+r)/2+Math.PI),c=DT(r-a);return{type:"gradient",gradient:"conic",colorSpace:"oklch",colorStops:fwe(e,o,s,t).map(({color:d,stop:u})=>(u=Math.min(Math.max(u,0),1),u=(a+c*u-l)/(2*Math.PI),u=(u%1+1)%1,{stop:u,color:d})),rotation:hwe(l)+90}}getShapeFillBBox(){const{centerX:e,centerY:t,radius:i}=this;return new dwe(e-i,t-i,2*i,2*i)}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{var T,k,N,O,L,F,B,_,G,V,j,H,U,$,W,Y,K;const{text:s=t.text,value:n=(T=t.value)!=null?T:0,shape:a=(k=t.shape)!=null?k:"triangle",rotation:r=(N=t.rotation)!=null?N:0,strokeWidth:o=(O=t.strokeWidth)!=null?O:0,placement:l=(L=t.placement)!=null?L:"middle",spacing:c=(F=t.spacing)!=null?F:0,size:h=(B=t.size)!=null?B:0,fill:d=(_=t.fill)!=null?_:"black",fillOpacity:u=(G=t.fillOpacity)!=null?G:1,stroke:p=(V=t.stroke)!=null?V:"black",strokeOpacity:g=(j=t.strokeOpacity)!=null?j:1,lineDash:f=(H=t.lineDash)!=null?H:[0],lineDashOffset:y=(U=t.lineDashOffset)!=null?U:0}=i,{enabled:v=t.label.enabled,color:x=($=t.label.color)!=null?$:"black",fontStyle:S=(W=t.label.fontStyle)!=null?W:"normal",fontWeight:M=(Y=t.label.fontWeight)!=null?Y:"normal",fontSize:D=t.label.fontSize,fontFamily:A=t.label.fontFamily,spacing:w=(K=t.label.spacing)!=null?K:0}=i.label;return{text:s,value:n,shape:a,placement:l,spacing:c,size:h,rotation:r,fill:d,fillOpacity:u,stroke:p,strokeWidth:o,strokeOpacity:g,lineDash:f,lineDashOffset:y,label:{enabled:v,color:x,fontStyle:S,fontWeight:M,fontSize:D,fontFamily:A,spacing:w}}})}getTargetRadius(e){const{radius:t,properties:i}=this,{innerRadiusRatio:s,outerRadiusRatio:n}=i,{placement:a,spacing:r,size:o}=e,l=t*n,c=t*s;switch(a){case"inside":return Math.max(c-r-o/2,0);case"outside":return l+r+o/2;default:return(c+l)/2}}getTargetLabel(e){const{scale:t}=this,{value:i,size:s,placement:n,label:a}=e,{spacing:r,color:o,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d}=a,u=void 0,p=t.convert(i),g=F4(p)/(Math.PI/2)|0,f=s/2+r;let y,v,x,S;switch(n){case"outside":({textAlign:y,textBaseline:v}=ywe[g]),x=f*Math.cos(p),S=f*Math.sin(p);break;case"inside":({textAlign:y,textBaseline:v}=vwe[g]),x=-f*Math.cos(p),S=-f*Math.sin(p);break;default:y="center",v="bottom",x=0,S=-f;break}return{offsetX:x,offsetY:S,fill:o,textAlign:y,textBaseline:v,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,lineHeight:u}}createNodeData(){var V,j,H;const e=this.layoutScale(),{id:t,scale:i,properties:s,radius:n,centerX:a,centerY:r}=this,{value:o,innerRadiusRatio:l,outerRadiusRatio:c,segmentation:h,cornerRadius:d,cornerMode:u,needle:p,bar:g,scale:f,label:y,secondaryLabel:v}=s,{outerRadius:x=n*c,innerRadius:S=n*l}=s,M=this.getTargets(),D=[],A=[],w=[],T=[],k=[],N=u==="item",O=i.convert(i.domain[0]),L=i.convert(o),F=Math.ceil(DT(L-O)*n);let B=h.enabled?h.interval.getSegments(i,F):void 0;const _=g.enabled?(V=g.fill)!=null?V:this.createConicGradient(g.fills,g.fillMode):"rgba(0,0,0,0)",G=(H=(j=f.fill)!=null?j:g.enabled&&f.fills.length===0?f.defaultFill:void 0)!=null?H:this.createConicGradient(f.fills,f.fillMode);if(B==null&&N){const U=Math.min(...i.domain),$=Math.max(...i.domain),W={value:o,segmentStart:U,segmentEnd:$},K=Math.min(d,(x-S)/2)/((S+x)/2);D.push({series:this,itemId:"value",datum:W,datumIndex:{type:0},type:0,centerX:a,centerY:r,outerRadius:x,innerRadius:S,startAngle:O-K,endAngle:L+K,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,fill:_}),k.push({series:this,itemId:"scale",datum:W,datumIndex:{type:0},type:0,centerX:a,centerY:r,outerRadius:x,innerRadius:S,startAngle:i.range[0]-K,endAngle:i.range[1]+K,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,fill:G})}else{B!=null||(B=i.domain);for(let U=0;U<B.length-1;U++){const $=B[U],W=B[U+1],Y={value:o,segmentStart:$,segmentEnd:W},K=U===0,Q=U===B.length-2,Z=i.convert($),J=i.convert(W);D.push({series:this,itemId:`value-${U}`,datum:Y,datumIndex:{type:0},type:0,centerX:a,centerY:r,outerRadius:x,innerRadius:S,startAngle:Z,endAngle:J,clipStartAngle:O,clipEndAngle:L,startCornerRadius:N||K?d:0,endCornerRadius:N||Q?d:0,fill:_}),k.push({series:this,itemId:`scale-${U}`,datum:Y,datumIndex:{type:0},type:0,centerX:a,centerY:r,outerRadius:x,innerRadius:S,startAngle:Z,endAngle:J,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:N||K?d:0,endCornerRadius:N||Q?d:0,fill:G})}}if(!p.enabled&&y.enabled){const{text:U,color:$,fontSize:W,minimumFontSize:Y,fontStyle:K,fontWeight:Q,fontFamily:Z,lineHeight:J,formatter:ae=oe=>this.formatLabel(oe.value)}=y;T.push({label:"primary",centerX:a,centerY:r,text:U,value:o,fill:$,fontSize:W,minimumFontSize:Y,fontStyle:K,fontWeight:Q,fontFamily:Z,lineHeight:J,formatter:ae})}if(!p.enabled&&v.enabled){const{text:U,color:$,fontSize:W,minimumFontSize:Y,fontStyle:K,fontWeight:Q,fontFamily:Z,lineHeight:J,formatter:ae}=v;T.push({label:"secondary",centerX:a,centerY:r,text:U,value:o,fill:$,fontSize:W,minimumFontSize:Y,fontStyle:K,fontWeight:Q,fontFamily:Z,lineHeight:J,formatter:ae})}if(p.enabled){let U=p.radiusRatio!=null?n*p.radiusRatio:S;U=Math.max(U-p.spacing,0);const $=i.convert(o);w.push({centerX:a,centerY:r,radius:U,angle:$,series:this})}for(let U=0;U<M.length;U+=1){const $=M[U],{value:W,text:Y,size:K,shape:Q,fill:Z,fillOpacity:J,stroke:ae,strokeWidth:oe,strokeOpacity:le,lineDash:de,lineDashOffset:ue}=$;if(W<Math.min(...i.domain)||W>Math.max(...i.domain))continue;const ie=this.getTargetRadius($),re=i.convert(W),te=EC($.rotation+mwe[$.placement]);A.push({series:this,itemId:`target-${U}`,midPoint:{x:ie*Math.cos(re)+a,y:ie*Math.sin(re)+r},datum:{value:W},datumIndex:{type:1,index:U},type:1,value:W,text:Y,centerX:a,centerY:r,shape:Q,radius:ie,angle:re,rotation:te,size:K,fill:Z,fillOpacity:J,stroke:ae,strokeOpacity:le,strokeWidth:oe,lineDash:de,lineDashOffset:ue,label:this.getTargetLabel($)})}return{itemId:t,nodeData:D,needleData:w,targetData:A,labelData:T,scaleData:k,tickData:e}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){var v,x,S,M,D,A,w,T,k,N,O,L;const{datumSelection:t,labelSelection:i,needleSelection:s,targetSelection:n,targetLabelSelection:a,scaleSelection:r,highlightTargetSelection:o,tickSelection:l}=this,c=this.checkResize(e);this.updateSelections(c),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const h=(x=(v=this.contextNodeData)==null?void 0:v.nodeData)!=null?x:[],d=(M=(S=this.contextNodeData)==null?void 0:S.labelData)!=null?M:[],u=(A=(D=this.contextNodeData)==null?void 0:D.needleData)!=null?A:[],p=(T=(w=this.contextNodeData)==null?void 0:w.targetData)!=null?T:[],g=(N=(k=this.contextNodeData)==null?void 0:k.scaleData)!=null?N:[],f=(L=(O=this.contextNodeData)==null?void 0:O.tickData)!=null?L:[],y=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:g,scaleSelection:r}),this.updateScaleNodes({scaleSelection:r}),this.needleSelection=this.updateNeedleSelection({needleData:u,needleSelection:s}),this.updateNeedleNodes({needleSelection:s}),this.targetSelection=this.updateTargetSelection({targetData:p,targetSelection:n}),this.updateTargetNodes({targetSelection:n,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:p,targetLabelSelection:a}),this.updateTargetLabelNodes({targetLabelSelection:a}),this.datumSelection=this.updateDatumSelection({nodeData:h,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:d,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:y!=null?[y]:[],targetSelection:o}),this.updateTargetNodes({targetSelection:o,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:f,tickSelection:l}),this.updateTickNodes({tickSelection:l}),c&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>MT(e.nodeData.length,t.itemId))}updateDatumNodes(e){var f;const{datumSelection:t}=e,{ctx:i,properties:s}=this,{bar:n,segmentation:a}=s,r=(f=a.spacing)!=null?f:0,{fillOpacity:o,stroke:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=n,u=this.getStrokeWidth(n.strokeWidth),p=i.animationManager.isSkipped(),g=this.getShapeFillBBox();t.each((y,v)=>{const{centerX:x,centerY:S,innerRadius:M,outerRadius:D,startCornerRadius:A,endCornerRadius:w,fill:T}=v;y.centerX=x,y.centerY=S,y.innerRadius=M,y.outerRadius=D,y.pointerEvents=this.properties.bar.enabled?R.PointerEvents.All:R.PointerEvents.None,y.fill=T,y.fillBBox=g,y.fillOpacity=o,y.stroke=l,y.strokeOpacity=c,y.strokeWidth=u,y.lineDash=h,y.lineDashOffset=d,y.startOuterCornerRadius=A,y.startInnerCornerRadius=A,y.endOuterCornerRadius=w,y.endInnerCornerRadius=w,y.radialEdgeInset=(r+y.strokeWidth)/2,y.concentricEdgeInset=y.strokeWidth/2,(p||y.previousDatum==null)&&y.setProperties(ST(y,v))}),this.datumUnion.update(t,this.itemGroup,R.Sector,(y,v,x)=>{var S,M,D;(S=y.clipSector)!=null||(y.clipSector=new pwe(NaN,NaN,NaN,NaN)),y.centerX=v.centerX,y.centerY=v.centerY,y.outerRadius=y.clipSector.outerRadius=v.outerRadius,y.innerRadius=y.clipSector.innerRadius=v.innerRadius,y.startAngle=y.clipSector.startAngle=v.startAngle,y.startInnerCornerRadius=v.startInnerCornerRadius,y.startOuterCornerRadius=v.startOuterCornerRadius,y.endAngle=x.endAngle,y.clipSector.endAngle=(D=(M=x.clipSector)==null?void 0:M.endAngle)!=null?D:x.endAngle,y.endInnerCornerRadius=x.endInnerCornerRadius,y.endOuterCornerRadius=x.endOuterCornerRadius,y.pointerEvents=R.PointerEvents.None})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>MT(e.scaleData.length,t.itemId))}updateScaleNodes(e){var u;const{scaleSelection:t}=e,{scale:i,segmentation:s}=this.properties,n=(u=s.spacing)!=null?u:0,{fillOpacity:a,stroke:r,strokeOpacity:o,strokeWidth:l,lineDash:c,lineDashOffset:h}=i,d=this.getShapeFillBBox();t.each((p,g)=>{const{centerX:f,centerY:y,innerRadius:v,outerRadius:x,startCornerRadius:S,endCornerRadius:M,fill:D}=g;p.centerX=f,p.centerY=y,p.innerRadius=v,p.outerRadius=x,p.fill=D,p.fillBBox=d,p.fillOpacity=a,p.stroke=r,p.strokeOpacity=o,p.strokeWidth=l,p.lineDash=c,p.lineDashOffset=h,p.startOuterCornerRadius=S,p.startInnerCornerRadius=S,p.endOuterCornerRadius=M,p.endInnerCornerRadius=M,p.radialEdgeInset=(n+p.strokeWidth)/2,p.concentricEdgeInset=p.strokeWidth/2,p.setProperties(ST(p,g))})}updateNeedleSelection(e){return e.needleSelection.update(e.needleData,void 0,()=>MT([]))}updateNeedleNodes(e){const{needleSelection:t}=e,{fill:i,fillOpacity:s,stroke:n,strokeOpacity:a,strokeWidth:r,lineDash:o,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();t.each((h,d)=>{const{centerX:u,centerY:p,radius:g}=d,f=g*2;h.d=yT.defaultPathData,h.fill=i,h.fillOpacity=s,h.stroke=n,h.strokeOpacity=a,h.strokeWidth=r/f,h.lineDash=o.map(y=>y/f),h.lineDashOffset=l/f,h.translationX=u,h.translationY=p,h.scalingX=f,h.scalingY=f,c&&h.setProperties(R4(h,d))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetNodes(e){const{targetSelection:t,isHighlight:i}=e,s=i?this.properties.highlightStyle.item:void 0;t.each((n,a)=>{var M,D,A,w,T,k,N;const{centerX:r,centerY:o,angle:l,radius:c,shape:h,size:d,rotation:u,fill:p,fillOpacity:g,stroke:f,strokeOpacity:y,strokeWidth:v,lineDash:x,lineDashOffset:S}=a;n.shape=h==="line"?mV:h,n.size=d,n.fill=(M=s==null?void 0:s.fill)!=null?M:p,n.fillOpacity=(D=s==null?void 0:s.fillOpacity)!=null?D:g,n.stroke=(A=s==null?void 0:s.stroke)!=null?A:f,n.strokeOpacity=(w=s==null?void 0:s.strokeOpacity)!=null?w:y,n.strokeWidth=(T=s==null?void 0:s.strokeWidth)!=null?T:v,n.lineDash=(k=s==null?void 0:s.lineDash)!=null?k:x,n.lineDashOffset=(N=s==null?void 0:s.lineDashOffset)!=null?N:S,n.translationX=r+c*Math.cos(l),n.translationY=o+c*Math.sin(l),n.rotation=l+u})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,s)=>{const{centerX:n,centerY:a,radius:r,angle:o,text:l}=s,{offsetX:c,offsetY:h,fill:d,fontStyle:u,fontWeight:p,fontSize:g,fontFamily:f,textAlign:y,textBaseline:v}=s.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=n+r*Math.cos(o)+c,i.y=a+r*Math.sin(o)+h,i.text=l,i.fill=d,i.fontStyle=u,i.fontWeight=p,i.fontSize=g,i.fontFamily=f,i.textAlign=y,i.textBaseline=v})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>t.label)}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((s,n)=>{s.fill=n.fill,s.fontStyle=n.fontStyle,s.fontWeight=n.fontWeight,s.fontFamily=n.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.index)}updateTickNodes(e){var g;const{scale:t,radius:i,centerX:s,centerY:n,properties:a}=this,{enabled:r,color:o,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,spacing:u}=a.scale.label,p=EC((g=a.scale.label.rotation)!=null?g:0);e.tickSelection.each((f,y)=>{if(!r){f.visible=!1;return}f.visible=!0,f.text=y.text,f.fill=o,f.fontFamily=l,f.fontSize=c,f.fontStyle=h,f.fontWeight=d,f.textAlign="center",f.textBaseline="middle";const v=t.convert(y.value),{width:x,height:S}=y,M=Math.abs(i*Math.cos(v)),D=Math.abs(i*Math.sin(v)),A=Math.min(Math.max(Math.abs(i/Math.tan(v)),M-x/2),M+x/2),w=Math.min(Math.max(Math.abs(i*Math.tan(v)),D-S/2),D+S/2),T=Math.hypot(A,w),k=s+(T+u)*Math.cos(v),N=n+(T+u)*Math.sin(v);f.x=k,f.y=N,f.rotationCenterX=k,f.rotationCenterY=N,f.rotation=p})}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,radius:i,textAlign:s,verticalAlign:n}=this,{spacing:a,innerRadiusRatio:r}=this.properties;rwe(this,this.ctx,t,{padding:a,textAlign:s,verticalAlign:n},i*r,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),N4([this.datumSelection],ST),N4([this.needleSelection],R4),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){var r;const{animationManager:t}=this.ctx;let i,s,n,a;if(this.labelSelection.each((o,l)=>{var c,h,d,u,p,g;o.opacity=1,l.label==="primary"?(i=(d=(h=(c=o.previousDatum)==null?void 0:c.value)!=null?h:e.from)!=null?d:l.value,s=l.value):l.label==="secondary"&&(n=(g=(p=(u=o.previousDatum)==null?void 0:u.value)!=null?p:e.from)!=null?g:l.value,a=l.value)}),!this.labelsHaveExplicitText())if(s==null||a==null)this.formatLabelText();else if(i===s&&n===a)this.formatLabelText({label:s,secondaryLabel:a});else{const o=`${this.id}_labels`;t.animate({id:o,groupId:"label",from:{label:i,secondaryLabel:n},to:{label:s,secondaryLabel:a},phase:(r=e.phase)!=null?r:"update",onUpdate:l=>this.formatLabelText(l)})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=E4(!0,this.scale.range[0]);Dm(this.id,"node",e,[this.datumSelection],t,(s,n)=>n.itemId),Dm(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),Dm(this.id,"label",e,[this.labelSelection],gV,(s,n)=>n.label),this.animateLabelText({from:this.properties.scale.min,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=E4(!1,this.scale.range[0]);Dm(this.id,"node",e,[this.datumSelection],t,(s,n)=>n.itemId),Dm(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:s}=i;let n,a;if(e.type===0?(n=i.value,a=i.label.text):{value:n,text:a}=i.targets[e.index],n!=null)return this.formatTooltipWithContext(s,{data:[{label:a,fallbackLabel:"Value",value:this.formatLabel(n)}]},{seriesId:t,title:void 0,datum:void 0,value:n})}pickNodeClosestDatum(e){return yV(this,e)}pickFocus(e){return vV(this,e)}getCaptionText(){const{value:e}=this.properties,t=[];return t.push(this.formatLabel(e)),this.labelSelection.each((i,s)=>{const n=gm(this.id,this.ctx,s);n!=null&&t.push(n)}),t.join(". ")}getCategoryValue(e){}datumIndexForCategoryValue(e){}};NC.className="RadialGaugeSeries",NC.type="radial-gauge";var{FONT_SIZE_RATIO:bwe}=R,xwe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"radial-gauge",moduleFactory:e=>new NC(e),tooltipDefaults:{range:10},themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{outerRadiusRatio:1,innerRadiusRatio:.8,startAngle:270,endAngle:450,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},R.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./2",R.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:12}},bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},needle:{enabled:!1,fill:{$ref:"foregroundColor"},spacing:10},label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:56,minimumFontSize:18/56,fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}},secondaryLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[bwe.LARGE]},minimumFontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"}}}}},Cwe={type:"series",name:"radial-gauge",chartType:"gauge",enterprise:!0,options:R.radialGaugeSeriesOptionsDef,create:e=>new NC(e)};function _4(e){e.nodes.sort((t,i)=>Math.round((t.datum.y-i.datum.y)*100)/100||-(t.datum.size-i.datum.size))}function Swe({nodes:e,size:t},{seriesRectHeight:i,nodeSpacing:s,sizeScale:n}){const a=i*t*n;let r=(i-(a+s*(e.length-1)))/2;e.forEach(({datum:o})=>{const l=i*o.size*n;o.y=r,o.height=l,r+=l+s})}function Mwe(e,t){const{nodes:i}=e,{seriesRectHeight:s,nodeSpacing:n}=t;_4(e);let a=0,r=0;for(const{datum:c}of i){const h=Math.max(r-c.y,0);c.y+=h,a+=h,r=c.y+c.height+n}if(r-n<s)return a>0;let l=s;for(let c=i.length-1;c>=0;c-=1){const{datum:h}=i[c],d=h.y+h.height,u=Math.min(l-d,0);h.y+=u,a+=u,l=h.y-n}return!0}function wT(e,t,i,s,n,a,r,o){const l=(i-e)/(s-t),c=(r-n)/(o-a),h=((a-t)*(l*c)+e*c-n*l)/(c-l);return e<i?h>e&&h<Math.min(i,r):h<e&&h>Math.max(i,r)}function G4(e,t){let i=!1;const s=e.nodes.filter(a=>t(a).length===1);let n=!0;for(let a=0;n&&a<s.length;a+=1){n=!1;for(let r=0;r<s.length-1;r+=1){const{datum:o}=s[r],l=t(s[r])[0].node.datum,{datum:c}=s[r+1],h=t(s[r+1])[0].node.datum;if(!(wT(o.x,o.y,l.x,l.y,c.x,c.y,h.x,h.y)||wT(o.x,o.y+o.height/2,l.x,l.y+l.height/2,c.x,c.y+c.height/2,h.x,h.y+h.height/2)||wT(o.x,o.y+o.height,l.x,l.y+l.height,c.x,c.y+c.height,h.x,h.y+h.height)))continue;const u=s[r];s[r]=s[r+1],s[r+1]=u;const p=o.y;o.y=c.y+c.height-o.height,c.y=p,i=!0,n=!0}}return i}function Dwe(e){let t=!1;return _4(e),t=G4(e,i=>i.linksBefore)||t,t=G4(e,i=>i.linksAfter)||t,t}function wwe(e){if(e.length===0)return;let t=0,i=0;for(const{node:{datum:s}}of e)t+=s.y*s.size,i+=s.size;return t/i}function z4(e,t,i,s){return e.nodes.forEach(({datum:n,linksBefore:a,linksAfter:r})=>{const o=s===1?a:r,l=s===1?r:a,c=wwe(o);if(c!=null){const h=l.length!==0?i:1;n.y=n.y+(c-n.y)*h}}),Mwe(e,t)}function V4(e,t,i){let s=!1;for(const n of e)s=z4(n,t,i,1)||s;return s}function Awe(e,t,i){let s=!1;for(let n=e.length-1;n>=0;n-=1)s=z4(e[n],t,i,-1)||s;return s}function j4(e){let t=!1;for(let i=e.length-1;i>=0;i-=1)t=Dwe(e[i])||t;return t}function Iwe(e,t){e.forEach(s=>{Swe(s,t)});let i=!1;for(let s=0;s<6;s+=1){const n=V4(e,t,1);i=Awe(e,t,.5);const a=j4(e);if(!n&&!i&&!a)break}i&&(V4(e,t,1),j4(e))}var{BBox:Twe,Path:kwe,SceneChangeDetection:kp,splitBezier:Lwe}=R;function OC(e,t,i,s,n,a,r,o,l,c){let h,d;if(n!==i&&l!==r){const A=-(s-t)/(n-i),w=-(o-a)/(l-r);h=(r-i+A*t-w*a)/(A-w),d=A*(h-t)+i}else if(n===i&&l!==r)h=t,d=-(o-a)/(l-r)*(h-o)+l;else if(n!==i&&l===r)h=o,d=-(s-t)/(n-i)*(h-t)+i;else throw new Error("Offsetting flat bezier curve");const u=Math.hypot(i-d,t-h),p=(u+c)/u,g=Math.hypot(l-d,o-h),f=(g+c)/g,y=h+(s-h)*p,v=d+(n-d)*p,x=h+(a-h)*f,S=d+(r-d)*f,M=h+(o-h)*f,D=d+(l-d)*f;e.cubicCurveTo(y,v,x,S,M,D)}var Id=class extends kwe{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){const e=Math.min(this.x1,this.x2),t=Math.max(this.x1,this.x2)-e,i=Math.min(this.y1,this.y2),s=Math.max(this.y1,this.y2)-i+this.height;return new Twe(e,i,t,s)}updatePath(){const{path:e,inset:t}=this;e.clear();const i=this.x1+t,s=this.x2-t,n=this.y1+t,a=this.y2+t,r=this.height-2*t;if(r<0||i>s)return;const o=i,l=n+r/2,c=(i+s)/2,h=n+r/2,d=(i+s)/2,u=a+r/2,p=s,g=a+r/2;if(e.moveTo(o,l-r/2),Math.abs(this.y2-this.y1)<1||this.x2-this.x1<this.height*Math.SQRT2)e.cubicCurveTo(c,h-r/2,d,u-r/2,p,g-r/2),e.lineTo(p,g+r/2),e.cubicCurveTo(d,u+r/2,c,h+r/2,o,l+r/2);else{const[f,y]=Lwe(o,l,c,h,d,u,p,g,.5),v=(a>n?1:-1)*r/2;OC(e,f[0].x,f[0].y,f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y,v),OC(e,y[0].x,y[0].y,y[1].x,y[1].y,y[2].x,y[2].y,y[3].x,y[3].y,-v),e.lineTo(p,g+r/2),OC(e,y[3].x,y[3].y,y[2].x,y[2].y,y[1].x,y[1].y,y[0].x,y[0].y,v),OC(e,f[3].x,f[3].y,f[2].x,f[2].y,f[1].x,f[1].y,f[0].x,f[0].y,-v)}e.closePath()}};C([kp()],Id.prototype,"x1",2),C([kp()],Id.prototype,"x2",2),C([kp()],Id.prototype,"y1",2),C([kp()],Id.prototype,"y2",2),C([kp()],Id.prototype,"height",2),C([kp()],Id.prototype,"inset",2);var{BaseProperties:H4,FillGradientDefaults:Pwe,FillPatternDefaults:Ewe,FillImageDefaults:Rwe,SeriesTooltip:Nwe,SeriesProperties:Owe,Property:Ye,Label:Fwe}=R,W4=class extends Fwe{constructor(){super(...arguments),this.spacing=1}};C([Ye],W4.prototype,"spacing",2);var ul=class extends H4{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};C([Ye],ul.prototype,"fill",2),C([Ye],ul.prototype,"fillOpacity",2),C([Ye],ul.prototype,"stroke",2),C([Ye],ul.prototype,"strokeOpacity",2),C([Ye],ul.prototype,"strokeWidth",2),C([Ye],ul.prototype,"lineDash",2),C([Ye],ul.prototype,"lineDashOffset",2),C([Ye],ul.prototype,"itemStyler",2);var ja=class extends H4{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};C([Ye],ja.prototype,"spacing",2),C([Ye],ja.prototype,"width",2),C([Ye],ja.prototype,"alignment",2),C([Ye],ja.prototype,"fill",2),C([Ye],ja.prototype,"fillOpacity",2),C([Ye],ja.prototype,"stroke",2),C([Ye],ja.prototype,"strokeOpacity",2),C([Ye],ja.prototype,"strokeWidth",2),C([Ye],ja.prototype,"lineDash",2),C([Ye],ja.prototype,"lineDashOffset",2),C([Ye],ja.prototype,"itemStyler",2);var _i=class extends Owe{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fillGradientDefaults=new Pwe,this.fillPatternDefaults=new Ewe,this.fillImageDefaults=new Rwe,this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=[],this.strokes=[],this.label=new W4,this.link=new ul,this.node=new ja,this.tooltip=new Nwe}};C([Ye],_i.prototype,"nodes",2),C([Ye],_i.prototype,"fromKey",2),C([Ye],_i.prototype,"toKey",2),C([Ye],_i.prototype,"idKey",2),C([Ye],_i.prototype,"idName",2),C([Ye],_i.prototype,"labelKey",2),C([Ye],_i.prototype,"labelName",2),C([Ye],_i.prototype,"sizeKey",2),C([Ye],_i.prototype,"sizeName",2),C([Ye],_i.prototype,"fillGradientDefaults",2),C([Ye],_i.prototype,"fillPatternDefaults",2),C([Ye],_i.prototype,"fillImageDefaults",2),C([Ye],_i.prototype,"defaultColorRange",2),C([Ye],_i.prototype,"defaultPatternFills",2),C([Ye],_i.prototype,"fills",2),C([Ye],_i.prototype,"strokes",2),C([Ye],_i.prototype,"label",2),C([Ye],_i.prototype,"link",2),C([Ye],_i.prototype,"node",2),C([Ye],_i.prototype,"tooltip",2);var{Transformable:Bwe,applyShapeStyle:U4,SeriesNodePickMode:K4,CachedTextMeasurerPool:_we,TextWrapper:$4,TextUtils:Y4,createDatumId:FC,getShapeStyle:BC,Rect:X4,BBox:Z4}=R,_C=class extends Wz{constructor(e){super({moduleCtx:e,pickModes:[K4.NEAREST_NODE,K4.EXACT_SHAPE_MATCH]}),this.properties=new _i}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Id}nodeFactory(){return new X4}createNodeData(){const{id:e,_nodeDataDependencies:{seriesRectWidth:t,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:s,toKey:n,sizeKey:a,label:{spacing:r},node:{spacing:o,width:l,alignment:c}}=this.properties,{nodeGraph:h,links:d,maxPathLength:u}=this.getNodeGraph(w=>E(b({},w),{x:NaN,y:NaN,width:l,height:NaN}),w=>E(b({},w),{x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),p=h,g=this.isLabelEnabled()?(t-l)*(1-u/(u+1)):0,f=(t-l-2*g)/(u-1),y=[];for(let w=0;w<u;w+=1){const T=g+w*f;y.push({index:w,size:0,nodes:[],x:T})}p.forEach(w=>{const{datum:T,linksBefore:k,linksAfter:N,maxPathLengthBefore:O,maxPathLengthAfter:L}=w,F=Math.max(k.reduce((G,{link:V})=>G+V.size,0),N.reduce((G,{link:V})=>G+V.size,0));if(k.length===0&&N.length===0||F===0){w.columnIndex=-1;return}let B;switch(c){case"left":B=y[O];break;case"right":B=y[u-1-L];break;case"center":{if(k.length!==0)B=y[O];else if(N.length!==0){const G=N.reduce((V,j)=>Math.min(V,j.node.maxPathLengthBefore),u)-1;B=y[G]}else B=y[0];break}case"justify":{B=N.length===0?y[u-1]:y[O];break}}T.x=B.x,T.size=F;const _=this.getLabelText(this.properties.label,{datum:T.datum,value:T.label,fromKey:s,toKey:n,sizeKey:a,size:F});T.label=String(_),B.nodes.push(w),B.size+=F,w.columnIndex=B.index}),p.forEach(w=>{let T=1/0,k=0;w.linksAfter.forEach(N=>{const O=N.node,{columnIndex:L}=O;L<T?(T=L,k=O.datum.size):L===T&&(k=Math.max(k,O.datum.size))}),w.closestColumnIndex=T,w.maxSizeOfClosestNodesAfter=k});const v=y.reduce((w,{size:T,nodes:k})=>{const N=(1-(k.length-1)*(o/i))/T;return Math.min(w,N)},1/0);for(let w=y.length-1;w>=0;w-=1)y[w].nodes.sort((k,N)=>k.closestColumnIndex-N.closestColumnIndex||k.maxSizeOfClosestNodesAfter-N.maxSizeOfClosestNodesAfter||k.datum.size-N.datum.size);Iwe(y,{seriesRectHeight:i,nodeSpacing:o,sizeScale:v});let x=!1;if(p.forEach(({datum:w,linksBefore:T,linksAfter:k})=>{x||(x=w.height<0);const N=w.y+w.height,O=B=>B.sort((_,G)=>{const V=_.node.datum,j=G.node.datum,H=V.y+V.height,U=j.y+j.height,$=Math.atan2(V.y-w.y,Math.abs(V.x-w.x))-Math.atan2(j.y-w.y,Math.abs(j.x-w.x)),W=Math.atan2(H-N,Math.abs(V.x-w.x))-Math.atan2(U-N,Math.abs(j.x-w.x));return $+W});let L=w.y;O(T).forEach(({link:B})=>{B.y2=L,L+=B.size*i*v});let F=w.y;O(k).forEach(({link:B})=>{B.y1=F,F+=B.size*i*v})}),x){se.warnOnce("There was insufficient space to display the Sankey Series. Reduce the node spacing, or provide a larger container.");return}const S=[],M=[],{fontSize:D}=this.properties.label,A=this.properties.label.getFont();return y.forEach((w,T)=>{const k=T===0,N=T===y.length-1;let O=-1/0;w.nodes.sort((L,F)=>L.datum.y-F.datum.y),w.nodes.forEach(({datum:L})=>{if(L.midPoint={x:L.x+L.width/2,y:L.y+L.height/2},S.push(L),L.label==null)return;const F=k?L.x-r:L.x+L.width+r,B=L.y+L.height/2;let _;if(!k&&!N){const H=B-Y4.getLineHeight(D),U=B+Y4.getLineHeight(D);let $=t;p.forEach(({datum:Y})=>{Y.x>L.x&&Math.max(Y.y,H)<=Math.min(Y.y+Y.height,U)&&($=Math.min($,Y.x-r))});const W=$-L.x-2*r;_=$4.wrapText(L.label,{maxWidth:W,maxHeight:L.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(_==null||_===""){const H=k||N?r:r*2;_=$4.wrapText(L.label,{maxWidth:f-H,maxHeight:L.height,font:this.properties.label,textWrap:"never"})}if(_==="")return;const{height:G}=_we.measureText(_,{font:A,textAlign:"left",textBaseline:"middle"}),V=B-G/2,j=B+G/2;V>=O&&(M.push({x:F,y:B,leading:k,text:_}),O=j)})}),d.forEach(w=>{const{fromNode:T,toNode:k,size:N}=w;w.height=i*N*v,w.x1=T.x+l,w.x2=k.x,w.midPoint={x:(w.x1+w.x2)/2,y:(w.y1+w.y2)/2+w.height/2},S.push(w)}),{itemId:e,nodeData:S,labelData:M}}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:s,fontWeight:n,fontSize:a,fontFamily:r}=this.properties.label;t.each((o,{x:l,y:c,leading:h,text:d})=>{o.visible=!0,o.x=l,o.y=c,o.text=d,o.fill=i,o.fontStyle=s,o.fontWeight=n,o.fontSize=a,o.fontFamily=r,o.textAlign=h?"right":"left",o.textBaseline="middle"})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>FC([t.type,t.id]))}getBaseNodeStyle(e){var c,h,d,u,p,g,f;const{properties:t}=this,{fill:i,fillOpacity:s,stroke:n,strokeOpacity:a,lineDash:r,lineDashOffset:o}=t.node,l=e?t.highlightStyle.item:void 0;return BC({fill:(c=l==null?void 0:l.fill)!=null?c:i,fillOpacity:(h=l==null?void 0:l.fillOpacity)!=null?h:s,stroke:(d=l==null?void 0:l.stroke)!=null?d:n,strokeOpacity:(u=l==null?void 0:l.strokeOpacity)!=null?u:a,strokeWidth:(p=l==null?void 0:l.strokeWidth)!=null?p:this.getStrokeWidth(t.node.strokeWidth),lineDash:(g=l==null?void 0:l.lineDash)!=null?g:r,lineDashOffset:(f=l==null?void 0:l.lineDashOffset)!=null?f:o},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getNodeStyleOverrides(e,t,i,s,n,a,r){var S,M;const{id:o,properties:l}=this,{fills:c,strokes:h,defaultColorRange:d,defaultPatternFills:u}=l,{itemStyler:p}=l.node,g=(S=a.fill)!=null?S:c[i%c.length],f=(M=a.stroke)!=null?M:h[i%h.length],y=d[i%d.length].map(D=>({color:D})),v=u[i%u.length];let x;if(r||(x!=null||(x={}),x.fill=g,x.stroke=f),p!=null){const D=this.cachedDatumCallback(FC(e,"node",r?"highlight":"node"),()=>{const{fillOpacity:A=1,strokeOpacity:w=1,strokeWidth:T=0,lineDash:k=[],lineDashOffset:N=0}=a;return this.callWithContext(p,{seriesId:o,datum:t,highlighted:r,label:n,size:s,fill:g,fillOpacity:A,stroke:f,strokeOpacity:w,strokeWidth:T,lineDash:k,lineDashOffset:N})});x!=null||(x={}),Object.assign(x,D)}return BC(x,E(b({},this.properties.fillGradientDefaults.toJson()),{colorStops:y}),E(b({},this.properties.fillPatternDefaults.toJson()),{fill:v,stroke:v}),this.properties.fillImageDefaults)}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getBaseNodeStyle(i),n=this.getShapeFillBBox();t.each((a,r)=>{const{datumIndex:o,size:l,label:c}=r,h=this.getNodeStyleOverrides(String(o.index),r.datum,o.index,l,c,s,i);a.x=r.x,a.y=r.y,a.width=Math.max(r.width,0),a.height=Math.max(r.height,0),U4(a,s,h,n)})}getShapeFillBBox(){var s,n,a,r;const e=(n=(s=this._nodeDataDependencies)==null?void 0:s.seriesRectWidth)!=null?n:0,t=(r=(a=this._nodeDataDependencies)==null?void 0:a.seriesRectHeight)!=null?r:0,i=new Z4(0,0,e,t);return{series:i,axis:i}}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>FC([t.type,t.index,t.fromNode.id,t.toNode.id]))}getBaseLinkStyle(e){var c,h,d,u,p,g,f;const{properties:t}=this,{fill:i,fillOpacity:s,stroke:n,strokeOpacity:a,lineDash:r,lineDashOffset:o}=t.link,l=e?t.highlightStyle.item:void 0;return BC({fill:(c=l==null?void 0:l.fill)!=null?c:i,fillOpacity:(h=l==null?void 0:l.fillOpacity)!=null?h:s,stroke:(d=l==null?void 0:l.stroke)!=null?d:n,strokeOpacity:(u=l==null?void 0:l.strokeOpacity)!=null?u:a,strokeWidth:(p=l==null?void 0:l.strokeWidth)!=null?p:this.getStrokeWidth(t.link.strokeWidth),lineDash:(g=l==null?void 0:l.lineDash)!=null?g:r,lineDashOffset:(f=l==null?void 0:l.lineDashOffset)!=null?f:o},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getLinkStyleOverrides(e,t,i,s,n){var v,x;const{id:a,properties:r}=this,{fills:o,strokes:l,defaultColorRange:c,defaultPatternFills:h}=r,{itemStyler:d}=r.link,u=(v=s.fill)!=null?v:o[i%o.length],p=(x=s.stroke)!=null?x:l[i%l.length],g=c[i%c.length].map(S=>({color:S})),f=h[i%h.length];let y;if(n||(y!=null||(y={}),y.fill=u,y.stroke=p),d!=null){const S=this.cachedDatumCallback(FC(e,"link",n?"highlight":"node"),()=>{const{fillOpacity:M=1,strokeOpacity:D=1,strokeWidth:A=0,lineDash:w=[],lineDashOffset:T=0}=s;return this.callWithContext(d,{seriesId:a,datum:t,highlighted:n,fill:u,fillOpacity:M,stroke:p,strokeOpacity:D,strokeWidth:A,lineDash:w,lineDashOffset:T})});y!=null||(y={}),Object.assign(y,S)}return BC(y,E(b({},this.properties.fillGradientDefaults.toJson()),{colorStops:g}),E(b({},this.properties.fillPatternDefaults.toJson()),{fill:f,stroke:f}),this.properties.fillImageDefaults)}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getBaseLinkStyle(i),n=this.getShapeFillBBox();t.each((a,r)=>{const{datumIndex:o}=r,l=r.fromNode.datumIndex,c=this.getLinkStyleOverrides(String(o.index),r.datum,l.index,s,i);a.x1=r.x1,a.y1=r.y1,a.x2=r.x2,a.y2=r.y2,a.height=r.height,U4(a,s,c,n),a.inset=a.strokeWidth/2})}getTooltipContent(e){var y,v,x;const{id:t,linksProcessedData:i,nodesProcessedData:s,properties:n}=this,{fromKey:a,toKey:r,sizeKey:o,sizeName:l,tooltip:c}=n,h=(y=this.contextNodeData)==null?void 0:y.nodeData.find(S=>S.datumIndex.type===e.type&&S.datumIndex.index===e.index);if(h==null)return;const d=h.type===0?h.fromNode.index:h.index,u=h.type===0?`${h.fromNode.label} - ${h.toNode.label}`:h.label,p=e.type===0?(v=i==null?void 0:i.dataSources.get(this.id))==null?void 0:v[e.index]:(x=s==null?void 0:s.dataSources.get(this.id))==null?void 0:x[e.index],g=h.size;let f;if(h.type===0){const S=h.fromNode.datumIndex,M=this.getBaseLinkStyle(!1);Object.assign(M,this.getLinkStyleOverrides(String(e.index),p,S.index,M,!1)),f=M}else{const S=h.label,M=this.getBaseNodeStyle(!1);Object.assign(M,this.getNodeStyleOverrides(String(e.index),p,e.index,g,S,M,!1)),f=M}return this.formatTooltipWithContext(c,{title:u,symbol:this.legendItemSymbol(h.type,d,f),data:o!=null?[{label:l,fallbackLabel:o,value:String(g)}]:[]},b({seriesId:t,datum:p,title:u,fromKey:a,toKey:r,sizeKey:o,sizeName:l,size:g},f))}computeFocusBounds(e){if(e instanceof X4){const{x:t,y:i,width:s,height:n}=e,a=new Z4(t,i,s,n);return Bwe.toCanvas(this.contentGroup,a)}return e}};_C.className="SankeySeries",_C.type="sankey";var{commonSeriesOptionsDefs:Gwe,sankeySeriesThemeableOptionsDef:zwe}=R,Lp=E(b(b({},zwe),Gwe),{type:ee(Oe("sankey")),fromKey:ee(z),toKey:ee(z),sizeKey:z,sizeName:z});Lp.fillGradientDefaults=Ce(gy),Lp.fillPatternDefaults=Ce(fy),Lp.fillImageDefaults=Ce(my),Lp.defaultColorRange=Ce(Ie(Ie(ye))),Lp.defaultPatternFills=Ce(Ie(ye));var Vwe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"sankey",moduleFactory:e=>new _C(e),tooltipDefaults:{range:"exact"},themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,defaultColorRange:{$palette:"gradients"},defaultPatternFills:R.SAFE_FILLS_OPERATION,highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:10},node:{spacing:20,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0}},legend:{enabled:!1,toggleSeries:!1}}},jwe={type:"series",name:"sankey",chartType:"flow-proportion",enterprise:!0,options:Lp,create:e=>new _C(e)},{HierarchySeriesProperties:Hwe,HighlightStyle:Wwe,SeriesTooltip:Uwe,Property:Gi}=R,Nc=class extends Wwe{constructor(){super(...arguments),this.label=new no,this.secondaryLabel=new no}};C([Gi],Nc.prototype,"fill",2),C([Gi],Nc.prototype,"fillOpacity",2),C([Gi],Nc.prototype,"stroke",2),C([Gi],Nc.prototype,"strokeWidth",2),C([Gi],Nc.prototype,"strokeOpacity",2),C([Gi],Nc.prototype,"label",2),C([Gi],Nc.prototype,"secondaryLabel",2);var Sn=class extends Hwe{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new Nc,this.label=new no,this.secondaryLabel=new dm,this.tooltip=new Uwe}};C([Gi],Sn.prototype,"sizeName",2),C([Gi],Sn.prototype,"labelKey",2),C([Gi],Sn.prototype,"secondaryLabelKey",2),C([Gi],Sn.prototype,"fillOpacity",2),C([Gi],Sn.prototype,"strokeWidth",2),C([Gi],Sn.prototype,"strokeOpacity",2),C([Gi],Sn.prototype,"cornerRadius",2),C([Gi],Sn.prototype,"sectorSpacing",2),C([Gi],Sn.prototype,"padding",2),C([Gi],Sn.prototype,"itemStyler",2),C([Gi],Sn.prototype,"highlightStyle",2),C([Gi],Sn.prototype,"label",2),C([Gi],Sn.prototype,"secondaryLabel",2),C([Gi],Sn.prototype,"tooltip",2);var{fromToMotion:Kwe,normalizeAngle360:$we,createDatumId:Ywe,Sector:AT,Group:GC,ScalableGroup:Xwe,Selection:IT,TransformableText:TT,BBox:q4,applyShapeStyle:Zwe,getShapeStyle:kT}=R,qwe=class extends R.HierarchyNode{constructor(){super(...arguments),this.label=void 0,this.secondaryLabel=void 0,this.contentHeight=0,this.bbox=void 0,this.startAngle=0,this.endAngle=0}};function Q4(e,t=0,i=2*Math.PI/e.sumSize){for(const s of e.children){const n=t+s.sumSize*i;s.startAngle=t,s.endAngle=n,Q4(s,t,i),t=n}}var zC=class extends R.HierarchySeries{constructor(){super(...arguments),this.NodeClass=qwe,this.properties=new Sn,this.scalingGroup=this.contentGroup.appendChild(new Xwe),this.sectorGroup=this.scalingGroup.appendChild(new GC),this.sectorLabelGroup=this.scalingGroup.appendChild(new GC),this.highlightSectorGroup=this.scalingGroup.appendChild(new GC),this.datumSelection=IT.select(this.sectorGroup,AT),this.labelSelection=IT.select(this.sectorLabelGroup,GC),this.highlightSelection=IT.select(this.highlightSectorGroup,AT)}processData(){super.processData(),Q4(this.rootNode)}updateSelections(){var a;const e=(a=this.ctx.highlightManager)==null?void 0:a.getActiveHighlight();if(this.highlightSelection.update(e!=null?[e]:[],void 0,r=>this.getDatumId(r)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const s=Array.from(this.rootNode),n=r=>{r.append([new TT({tag:0}),new TT({tag:1})])};this.datumSelection.update(s,void 0,r=>this.getDatumId(r)),this.labelSelection.update(s,n,r=>this.getDatumId(r))}getItemBaseStyle(e){var s,n,a;const{properties:t}=this,i=e?t.highlightStyle:void 0;return kT({fill:i==null?void 0:i.fill,fillOpacity:(s=i==null?void 0:i.fillOpacity)!=null?s:t.fillOpacity,stroke:i==null?void 0:i.stroke,strokeWidth:(n=i==null?void 0:i.strokeWidth)!=null?n:this.getStrokeWidth(t.strokeWidth),strokeOpacity:(a=i==null?void 0:i.strokeOpacity)!=null?a:t.strokeOpacity},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getItemStyleOverrides(e,t,i,s,n,a){var y,v;const{id:r,properties:o,colorScale:l}=this,{fills:c,strokes:h,itemStyler:d}=o,u=e[0],p=(y=n.fill)!=null?y:c[u%c.length],g=(v=n.stroke)!=null?v:h[u%h.length],f={};if(a||(f.fill=s!=null?l.convert(s):p,f.stroke=g),d!=null){const x=this.cachedDatumCallback(Ywe(e.join(":"),a?"highlight":"node"),()=>this.callWithContext(d,b({seriesId:r,datum:t,depth:i,highlighted:a,fill:p,stroke:g},n)));Object.assign(f,x)}return kT(f,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateNodes(){var k,N,O;const{chart:e,data:t,maxDepth:i}=this;if(e==null||t==null)return;const{width:s,height:n}=e.seriesRect,{sectorSpacing:a=0,padding:r=0,cornerRadius:o,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:p,sizeName:g}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=n/2;const f=a*.5,y=Math.min(s,n)/2,v=y/(i+1),x=-Math.PI/2,S={series:new q4(-y,-y,2*y,2*y),axis:new q4(-y,-y,2*y,2*y)};(k=this.rootNode)==null||k.walk(L=>{const{startAngle:F,endAngle:B}=L;if(L.depth!=null){const _=(F+B)/2+x,G=(L.depth+.5)*v;L.midPoint.x=Math.cos(_)*G,L.midPoint.y=Math.sin(_)*G}}),(N=this.rootNode)==null||N.walk(L=>{const{datum:F,depth:B,startAngle:_,endAngle:G,parent:V,sumSize:j}=L;L.label=void 0,L.secondaryLabel=void 0,L.contentHeight=0;let H;if(F!=null&&B!=null&&d!=null){const Te=F[d];H=this.getLabelText(this.properties.label,{depth:B,datum:F,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:p,sizeName:g,value:Te})}H===""&&(H=void 0);let U;if(F!=null&&B!=null&&u!=null){const Te=F[u];U=this.getLabelText(this.properties.secondaryLabel,{depth:B,datum:F,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:p,sizeName:g,value:Te})}if(U===""&&(U=void 0),B==null)return;const $=B*v+f,W=(B+1)*v-f,Y=$>f?f/$:f,K=W>f?f/W:f,Q=_+Y,J=G+Y-Q,ae=_+K,le=G+K-ae,de=Te=>{if(B===0&&(V==null?void 0:V.sumSize)===j)return{width:2*Math.sqrt(W**2-(Te*.5)**2),height:Te,meta:0};const lt=Te,wt=2*Math.sqrt(W**2-($+lt)**2),Ai=J<Math.PI?2*$*Math.tan(J*.5):1/0,vi=Math.min(wt,Ai),Bc=Math.PI/4;let yr,_c;return B===0?(yr=Te,_c=Math.sqrt(W**2-(yr/2)**2)-Te/(2*Math.tan(le*.5))):$we(J)<Bc?(yr=2*$*Math.tan(J*.5),_c=Math.sqrt(W**2-(yr/2)**2)-$):(_c=0,yr=0),vi>=_c?{width:vi,height:lt,meta:1}:{width:_c,height:yr,meta:2}},ue=LI(H,this.properties.label,U,this.properties.secondaryLabel,{padding:r},de);if(ue==null)return;const{width:ie,height:re,meta:te,label:fe,secondaryLabel:me}=ue,Le=x+(_+G)/2,Ee=Math.sin(Le)>=0,He=Math.cos(Le)>=0,Ue=(Ee?3:12)&(He?6:9);let je;switch(te){case 0:je=0;break;case 1:{const Fe=W-(v-re)*.58,lt=Math.sqrt((W-r)**2-(ie/2)**2);je=Math.min(Fe,lt);break}case 2:if(B===0){const Te=re/(2*Math.tan(J*.5))+ie*.5,Fe=Math.sqrt(W**2-(re*.5)**2)-ie*.5;je=(Te+Fe)*.5}else je=($+W)*.5;break}if(fe!=null){const{fontStyle:Te="normal",fontFamily:Fe,fontWeight:lt="normal",color:wt="black"}=this.properties.label;L.label=E(b({},fe),{fontStyle:Te,fontFamily:Fe,fontWeight:lt,color:wt,labelPlacement:te,circleQuarter:Ue,radius:je,theta:Le})}if(me!=null){const{fontStyle:Te="normal",fontFamily:Fe,fontWeight:lt="normal",color:wt="black"}=this.properties.secondaryLabel;L.secondaryLabel=E(b({},me),{fontStyle:Te,fontFamily:Fe,fontWeight:lt,color:wt,labelPlacement:te,circleQuarter:Ue,radius:je,theta:Le})}L.contentHeight=ue.height});const M=(L,F,B,_)=>{var Z,J;const{datum:G,datumIndex:V,depth:j,colorValue:H,startAngle:U,endAngle:$}=L;if(j==null){F.visible=!1;return}F.visible=!0;const W=this.getItemStyleOverrides(V,G,j,H,B,_),Y=(Z=W.fill)!=null?Z:B.fill,K=(J=W.strokeWidth)!=null?J:B.strokeWidth,Q=R.isGradientFill(Y)&&Y.bounds!=="item"?S:void 0;Zwe(F,B,W,Q),F.centerX=0,F.centerY=0,F.innerRadius=j*v,F.outerRadius=(j+1)*v,F.startAngle=U+x,F.endAngle=$+x,F.inset=f+K*.5,F.cornerRadius=o},D=this.getItemBaseStyle(!1);this.datumSelection.each((L,F)=>{M(F,L,D,!1)});const A=this.getItemBaseStyle(!0);this.highlightSelection.each((L,F)=>{M(F,L,A,!0)});const w=(L,F,B,_)=>{const{depth:G,contentHeight:V}=L,j=B===0,H=j?L.label:L.secondaryLabel;if(G==null||H==null){F.visible=!1;return}const{labelPlacement:U,circleQuarter:$,radius:W,theta:Y}=H;let K;switch(_&&(K=(j?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color),F.text=H.text,F.fontSize=H.fontSize,F.lineHeight=H.lineHeight,F.fontStyle=H.fontStyle,F.fontFamily=H.fontFamily,F.fontWeight=H.fontWeight,F.fill=K!=null?K:H.color,U){case 0:F.textAlign="center",F.textBaseline="top",F.translationX=0,F.translationY=(j?0:V-H.height)-V*.5,F.rotation=0;break;case 1:{const Q=($&3)!==0,Z=j===!Q?W:W-(V-H.height);F.textAlign="center",F.textBaseline=Q?"bottom":"top",F.translationX=Math.cos(Y)*Z,F.translationY=Math.sin(Y)*Z,F.rotation=Q?Y-Math.PI*.5:Y+Math.PI*.5;break}case 2:{const Q=($&6)!==0,Z=j===!Q?(V-H.height)*.5:(H.height-V)*.5;F.textAlign="center",F.textBaseline="middle",F.translationX=Math.cos(Y)*W+Math.cos(Y+Math.PI/2)*Z,F.translationY=Math.sin(Y)*W+Math.sin(Y+Math.PI/2)*Z,F.rotation=Q?Y:Y+Math.PI;break}}F.visible=!0},T=(O=this.ctx.highlightManager)==null?void 0:O.getActiveHighlight();this.labelSelection.selectByClass(TT).forEach(L=>{const F=L.closestDatum();w(F,L,L.tag,F===T)})}getTooltipContent(e){const{id:t,properties:i}=this,{labelKey:s,secondaryLabelKey:n,childrenKey:a,sizeKey:r,sizeName:o,colorKey:l,colorName:c,tooltip:h}=i,d=e.reduce((M,D)=>M==null?void 0:M.children[D],this.rootNode);if(d==null)return;const{datum:u,depth:p}=d;if(u==null||p==null)return;const g=[],f=r!=null?u[r]:void 0;f!=null&&g.push({label:o,fallbackLabel:r,value:f});const y=l!=null?u[l]:void 0;y!=null&&g.push({label:c,fallbackLabel:l,value:y});const v=this.getItemBaseStyle(!1);Object.assign(v,this.getItemStyleOverrides(e,u,p,y,v,!1));const x=v.fill,S=kT({shape:"square",fill:x,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0},i.fillGradientDefaults,i.fillPatternDefaults,i.fillImageDefaults);return R.isGradientFill(S.fill)&&(S.fill=E(b({},S.fill),{gradient:"linear",rotation:0,reverse:!1})),this.formatTooltipWithContext(h,{title:s!=null?u[s]:void 0,symbol:{marker:S},data:g},b({seriesId:t,datum:u,title:void 0,depth:p,labelKey:s,secondaryLabelKey:n,childrenKey:a,sizeKey:r,sizeName:o,colorKey:l,colorName:c},v))}createNodeData(){}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.datumSelection.selectByClass(AT))}animateEmptyUpdateReady(){Kwe(this.id,"nodes",this.ctx.animationManager,[this.scalingGroup],{toFn(){return{scalingX:1,scalingY:1}},fromFn(){return{scalingX:0,scalingY:0}}})}computeFocusBounds(e){return e}};zC.className="SunburstSeries",zC.type="sunburst";var{commonSeriesOptionsDefs:Qwe,sunburstSeriesThemeableOptionsDef:Jwe,without:eAe}=R,tAe=E(b(b({},Jwe),eAe(Qwe,["highlightStyle"])),{type:ee(Oe("sunburst")),labelKey:z,secondaryLabelKey:z,childrenKey:z,sizeKey:z,colorKey:z,sizeName:z,colorName:z}),{FONT_SIZE_RATIO:J4}=R,iAe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",moduleFactory:e=>new zC(e),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},colorRange:{$palette:"divergingColors"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,label:{fontFamily:{$ref:"fontFamily"},fontSize:{$rem:[J4.LARGE]},minimumFontSize:{$round:[{$mul:[{$ref:"fontSize"},9/12]}]},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontFamily:{$ref:"fontFamily"},fontSize:{$rem:[J4.SMALLEST]},minimumFontSize:{$round:[{$mul:[{$ref:"fontSize"},7/12]}]},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:{$ref:"backgroundColor"}},secondaryLabel:{color:{$ref:"backgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}}},sAe={type:"series",name:"sunburst",chartType:"hierarchy",enterprise:!0,options:tAe,create:e=>new zC(e)},{BaseProperties:VC,HierarchySeriesProperties:nAe,HighlightStyle:aAe,SeriesTooltip:rAe,Property:ze,Label:oAe}=R,ej=class extends oAe{constructor(){super(...arguments),this.spacing=0}};C([ze],ej.prototype,"spacing",2);var Ha=class extends VC{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new ej}};C([ze],Ha.prototype,"fill",2),C([ze],Ha.prototype,"fillOpacity",2),C([ze],Ha.prototype,"stroke",2),C([ze],Ha.prototype,"strokeWidth",2),C([ze],Ha.prototype,"strokeOpacity",2),C([ze],Ha.prototype,"cornerRadius",2),C([ze],Ha.prototype,"textAlign",2),C([ze],Ha.prototype,"gap",2),C([ze],Ha.prototype,"padding",2),C([ze],Ha.prototype,"interactive",2),C([ze],Ha.prototype,"label",2);var ua=class extends VC{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new no,this.secondaryLabel=new dm}};C([ze],ua.prototype,"fill",2),C([ze],ua.prototype,"fillOpacity",2),C([ze],ua.prototype,"stroke",2),C([ze],ua.prototype,"strokeWidth",2),C([ze],ua.prototype,"strokeOpacity",2),C([ze],ua.prototype,"cornerRadius",2),C([ze],ua.prototype,"textAlign",2),C([ze],ua.prototype,"verticalAlign",2),C([ze],ua.prototype,"gap",2),C([ze],ua.prototype,"padding",2),C([ze],ua.prototype,"label",2),C([ze],ua.prototype,"secondaryLabel",2);var Td=class extends VC{constructor(){super(...arguments),this.label=new no}};C([ze],Td.prototype,"fill",2),C([ze],Td.prototype,"fillOpacity",2),C([ze],Td.prototype,"stroke",2),C([ze],Td.prototype,"strokeWidth",2),C([ze],Td.prototype,"strokeOpacity",2),C([ze],Td.prototype,"label",2);var Oc=class extends VC{constructor(){super(...arguments),this.label=new no,this.secondaryLabel=new dm}};C([ze],Oc.prototype,"fill",2),C([ze],Oc.prototype,"fillOpacity",2),C([ze],Oc.prototype,"stroke",2),C([ze],Oc.prototype,"strokeWidth",2),C([ze],Oc.prototype,"strokeOpacity",2),C([ze],Oc.prototype,"label",2),C([ze],Oc.prototype,"secondaryLabel",2);var LT=class extends aAe{constructor(){super(...arguments),this.group=new Td,this.tile=new Oc}};C([ze],LT.prototype,"group",2),C([ze],LT.prototype,"tile",2);var mr=class extends nAe{constructor(){super(...arguments),this.highlightStyle=new LT,this.tooltip=new rAe,this.group=new Ha,this.tile=new ua,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};C([ze],mr.prototype,"sizeName",2),C([ze],mr.prototype,"labelKey",2),C([ze],mr.prototype,"secondaryLabelKey",2),C([ze],mr.prototype,"itemStyler",2),C([ze],mr.prototype,"highlightStyle",2),C([ze],mr.prototype,"tooltip",2),C([ze],mr.prototype,"group",2),C([ze],mr.prototype,"tile",2),C([ze],mr.prototype,"undocumentedGroupFills",2),C([ze],mr.prototype,"undocumentedGroupStrokes",2);var{TextUtils:lAe,TextWrapper:cAe,createDatumId:tj,Rect:ij,Group:sj,BBox:Pp,Selection:PT,Text:jC,Transformable:hAe,applyShapeStyle:dAe,getShapeStyle:wm}=R,uAe=class extends R.HierarchyNode{constructor(){super(...arguments),this.labelValue=void 0,this.secondaryLabelValue=void 0,this.label=void 0,this.secondaryLabel=void 0,this.bbox=void 0,this.padding=void 0}},nj=new jC;function pAe(e,t){const{fontStyle:i,fontWeight:s,fontSize:n,fontFamily:a}=t;nj.setProperties({text:e,fontStyle:i,fontWeight:s,fontSize:n,fontFamily:a,textAlign:"left",textBaseline:"top"});const{width:r,height:o}=nj.getBBox();return{width:r,height:o}}function Fc(e){return e.children.length>0?e.sumSize-e.sizeValue:e.sizeValue}var aj={left:0,center:.5,right:1},gAe={top:0,middle:.5,bottom:1},pIe=class extends R.Group{distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}},HC=class extends R.HierarchySeries{constructor(){super(...arguments),this.NodeClass=uAe,this.properties=new mr,this.rectGroup=this.contentGroup.appendChild(new sj),this.datumSelection=PT.select(this.rectGroup,ij),this.labelSelection=PT.select(this.labelGroup,sj),this.highlightSelection=PT.select(this.rectGroup,ij)}groupTitleHeight(e,t){const{labelValue:i}=e,{label:s}=this.properties.group,n=3;if(i!=null){if(s.fontSize>t.width/n||s.fontSize>t.height/n)return;{const{height:a}=pAe(i,s);return Math.max(a,s.fontSize)}}}getNodePadding(e,t){if(e.parent==null)return{top:0,right:0,bottom:0,left:0};if(e.children.length===0){const{padding:r}=this.properties.tile;return{top:r,right:r,bottom:r,left:r}}const{label:{spacing:i},padding:s}=this.properties.group,n=this.groupTitleHeight(e,t),a=n!=null?n+i:0;return{top:s+a,right:s,bottom:s,left:s}}sortChildren({children:e}){const t=Array.from(e,(s,n)=>n).filter(s=>Fc(e[s])>0).sort((s,n)=>Fc(e[n])-Fc(e[s]));return{sortedChildrenIndices:t,childAt:s=>{const n=t[s];return e[n]}}}squarify(e,t){const{datum:i,children:s}=e;if(t.width<=0||t.height<=0){e.bbox=void 0,e.padding=void 0,e.midPoint.x=NaN,e.midPoint.y=NaN;return}const n=i!=null?this.getNodePadding(e,t):{top:0,right:0,bottom:0,left:0};e.parent==null?(e.bbox=void 0,e.padding=void 0,e.midPoint.x=NaN,e.midPoint.y=NaN):(e.bbox=t,e.padding=n,e.midPoint.x=t.x+t.width/2,e.midPoint.y=t.y);const{sortedChildrenIndices:a,childAt:r}=this.sortChildren(e),o=a.every(D=>s[D].children.length===0),l=1,c=t.width-n.left-n.right,h=t.height-n.top-n.bottom;if(c<=0||h<=0)return;const d=a.length;let u=0,p=0,g=1/0,f=a.reduce((D,A)=>D+Fc(s[A]),0);const y=new Pp(t.x+n.left,t.y+n.top,c,h),v=y.clone();let x=0;for(;x<d;){const D=Fc(r(x)),A=Fc(r(p)),w=v.width<v.height;u+=D;const T=w?v.height:v.width,k=w?v.width:v.height,N=k*A/u;let O=T*u/f;const L=Math.max(N,O)/Math.min(N,O),F=Math.abs(l-L);if(F<g){g=F,x++;continue}u-=D,O=T*u/f;let B=w?v.x:v.y;for(let _=p;_<x;_++){const G=r(_),V=Fc(G),j=w?B:v.x,H=w?v.y:B,U=k*V/u,$=w?U:O,W=w?O:U,Y=new Pp(j,H,$,W);this.applyGap(y,Y,o),this.squarify(G,Y),f-=V,B+=U}w?(v.y+=O,v.height-=O):(v.x+=O,v.width-=O),p=x,u=0,g=1/0}const S=v.width<v.height;let M=S?v.x:v.y;for(let D=p;D<d;D++){const A=r(D),w=S?M:v.x,T=S?v.y:M,k=Fc(A)/f,N=v.width*(S?k:1),O=v.height*(S?1:k),L=new Pp(w,T,N,O);this.applyGap(y,L,o),this.squarify(A,L),M+=S?N:O}}applyGap(e,t,i){const s=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,n=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=n(e),r=n(t);["top","right","bottom","left"].forEach(l=>{mt(a[l],r[l])||t.shrink(s,l)})}createNodeData(){}getGroupBaseStyle(e){var n,a,r,o,l;const{properties:t}=this,{group:i}=t,s=e?t.highlightStyle.group:void 0;return wm({fill:(n=s==null?void 0:s.fill)!=null?n:i.fill,fillOpacity:(a=s==null?void 0:s.fillOpacity)!=null?a:i.fillOpacity,stroke:(r=s==null?void 0:s.stroke)!=null?r:i.stroke,strokeWidth:(o=s==null?void 0:s.strokeWidth)!=null?o:i.strokeWidth,strokeOpacity:(l=s==null?void 0:s.strokeOpacity)!=null?l:i.strokeOpacity},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getGroupStyleOverrides(e,t,i,s,n){var p,g;const{id:a,properties:r}=this,{undocumentedGroupFills:o,undocumentedGroupStrokes:l,itemStyler:c}=r,h=(p=s.fill)!=null?p:o[Math.min(i!=null?i:0,o.length)],d=(g=s.stroke)!=null?g:l[Math.min(i!=null?i:0,l.length)],u={};if(n||(u.fill=h,u.stroke=d),c!=null){const f=this.cachedDatumCallback(tj(e.join(":"),n?"highlight":"node"),()=>this.callWithContext(c,b({seriesId:a,datum:t,depth:i,highlighted:n,fill:h,stroke:d},s)));Object.assign(u,f)}return wm(u,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getTileBaseStyle(e){var n,a,r,o,l;const{properties:t}=this,{tile:i}=t,s=e?t.highlightStyle.tile:void 0;return wm({fill:(n=s==null?void 0:s.fill)!=null?n:i.fill,fillOpacity:(a=s==null?void 0:s.fillOpacity)!=null?a:i.fillOpacity,stroke:(r=s==null?void 0:s.stroke)!=null?r:i.stroke,strokeWidth:(o=s==null?void 0:s.strokeWidth)!=null?o:i.strokeWidth,strokeOpacity:(l=s==null?void 0:s.strokeOpacity)!=null?l:i.strokeOpacity},t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults)}getTileStyleOverrides(e,t,i,s,n,a){var y,v;const{id:r,properties:o,colorScale:l}=this,{fills:c,strokes:h,itemStyler:d}=o,u=e[0],p=(y=n.fill)!=null?y:c[u%c.length],g=(v=n.stroke)!=null?v:h[u%h.length],f={};if(a||(f.fill=s!=null?l.convert(s):p,f.stroke=g),d!=null){const x=this.cachedDatumCallback(tj(e.join(":"),a?"highlight":"node"),()=>this.callWithContext(d,b({seriesId:r,datum:t,depth:i,highlighted:a,fill:p,stroke:g},n)));Object.assign(f,x)}return wm(f,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateSelections(){var n,a;let e=(n=this.ctx.highlightManager)==null?void 0:n.getActiveHighlight();if(e!=null&&!this.properties.group.interactive&&e.children.length!==0&&(e=void 0),this.highlightSelection.update(e!=null?[e]:[],void 0,r=>this.getDatumId(r)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=(a=this.chart)!=null?a:{};if(!t)return;const i=Array.from(this.rootNode),s=r=>{r.append([new jC({tag:0}),new jC({tag:1})])};this.datumSelection.update(i,void 0,r=>this.getDatumId(r)),this.labelSelection.update(i,s,r=>this.getDatumId(r))}updateNodes(){var w,T,k,N;const{rootNode:e,data:t}=this,{childrenKey:i,colorKey:s,colorName:n,labelKey:a,secondaryLabelKey:r,sizeKey:o,sizeName:l,highlightStyle:c,tile:h,group:d}=this.properties,{seriesRect:u}=(w=this.chart)!=null?w:{};if(!u||!t)return;(T=this.rootNode)==null||T.walk(O=>{const{datum:L,depth:F,children:B}=O,_=B.length===0,G=_?h.label:d.label;let V;if(L!=null&&F!=null&&a!=null){const H=L[a];V=this.getLabelText(G,{depth:F,datum:L,childrenKey:i,colorKey:s,colorName:n,labelKey:a,secondaryLabelKey:r,sizeKey:o,sizeName:l,value:H})}V===""&&(V=void 0);let j;if(_&&L!=null&&F!=null&&r!=null){const H=L[r];j=this.getLabelText(h.secondaryLabel,{depth:F,datum:L,childrenKey:i,colorKey:s,colorName:n,labelKey:a,secondaryLabelKey:r,sizeKey:o,sizeName:l,value:H})}j===""&&(j=void 0),O.labelValue=V,O.secondaryLabelValue=j});const{width:p,height:g}=u;this.squarify(e,new Pp(0,0,p,g)),(k=this.rootNode)==null||k.walk(O=>{var G,V,j;const{bbox:L,children:F,labelValue:B,secondaryLabelValue:_}=O;if(O.label=void 0,O.secondaryLabel=void 0,L!=null)if(F.length===0){const H={width:L.width,height:L.height,meta:null},U=LI(B,this.properties.tile.label,_,this.properties.tile.secondaryLabel,{padding:h.padding},()=>H);if(U==null)return;const{height:$,label:W,secondaryLabel:Y}=U,{textAlign:K,verticalAlign:Q,padding:Z}=h,J=(G=aj[K])!=null?G:.5,ae=L.x+Z+(L.width-2*Z)*J,oe=(V=gAe[Q])!=null?V:.5,le=L.y+Z+$*.5+(L.height-2*Z-$)*oe;if(W!=null){const{fontStyle:de="normal",fontFamily:ue,fontWeight:ie="normal",color:re="black"}=this.properties.tile.label;O.label={text:W.text,fontSize:W.fontSize,lineHeight:W.lineHeight,fontStyle:de,fontFamily:ue,fontWeight:ie,color:re,textAlign:K,verticalAlign:"middle",x:ae,y:le-($-W.height)*.5}}if(Y!=null){const{fontStyle:de="normal",fontFamily:ue,fontWeight:ie="normal",color:re="black"}=this.properties.tile.secondaryLabel;O.secondaryLabel={text:Y.text,fontSize:Y.fontSize,lineHeight:Y.fontSize,fontStyle:de,fontFamily:ue,fontWeight:ie,color:re,textAlign:K,verticalAlign:"middle",x:ae,y:le+($-Y.height)*.5}}}else{if(B==null)return;{const{padding:H,textAlign:U}=d,$=this.groupTitleHeight(O,L);if($==null)return;const W=L.width-2*H,Y=cAe.wrapText(B,{maxWidth:L.width-2*H,font:d.label,textWrap:"never"}),K=(j=aj[U])!=null?j:.5,{fontStyle:Q="normal",fontFamily:Z,fontWeight:J="normal",color:ae="black"}=this.properties.group.label;O.label={text:Y,fontSize:d.label.fontSize,lineHeight:lAe.getLineHeight(d.label.fontSize),fontStyle:Q,fontFamily:Z,fontWeight:J,color:ae,textAlign:U,verticalAlign:"middle",x:L.x+H+W*K,y:L.y+H+$*.5}}}});const f={series:new Pp(0,0,p,g),axis:new Pp(0,0,p,g)},y=(O,L,F,B,_)=>{var J;const{bbox:G}=O;if(G==null){L.visible=!1;return}const{datum:V,depth:j=-1,datumIndex:H,colorValue:U}=O,$=O.children.length===0,W=$?B:F,Y=$?this.getTileStyleOverrides(H,V,j,U,W,_):this.getGroupStyleOverrides(H,V,j,W,_);L.crisp=!0,dAe(L,W,Y,f),L.cornerRadius=$?h.cornerRadius:d.cornerRadius,L.zIndex=[0,j,_?1:0];const K=(J=O.parent)==null?void 0:J.children.every(ae=>ae.children.length===0),Q=O.parent!=null?O.parent.bbox:void 0,Z=O.parent!=null?O.parent.padding:void 0;K===!0&&Q!=null&&Z!=null?(L.clipBBox=G,L.x=Q.x+Z.left,L.y=Q.y+Z.top,L.width=Q.width-(Z.left+Z.right),L.height=Q.height-(Z.top+Z.bottom)):(L.clipBBox=void 0,L.x=G.x,L.y=G.y,L.width=G.width,L.height=G.height),L.visible=!0},v=this.getGroupBaseStyle(!1),x=this.getTileBaseStyle(!1);this.datumSelection.each((O,L)=>y(L,O,v,x,!1));const S=this.getGroupBaseStyle(!0),M=this.getTileBaseStyle(!0);this.highlightSelection.each((O,L)=>{y(L,O,S,M,!0)});const D=(O,L,F,B)=>{const _=O.children.length===0,G=F===0?O.label:O.secondaryLabel;if(G==null){L.visible=!1;return}let V;if(B){const{tile:j,group:H}=c;V=j.secondaryLabel.color,_?F===0&&(V=j.label.color):V=H.label.color}L.text=G.text,L.fontSize=G.fontSize,L.lineHeight=G.lineHeight,L.fontStyle=G.fontStyle,L.fontFamily=G.fontFamily,L.fontWeight=G.fontWeight,L.fill=V!=null?V:G.color,L.textAlign=G.textAlign,L.textBaseline=G.verticalAlign,L.x=G.x,L.y=G.y,L.visible=!0,L.zIndex=1},A=(N=this.ctx.highlightManager)==null?void 0:N.getActiveHighlight();this.labelSelection.selectByClass(jC).forEach(O=>{const L=O.closestDatum();D(L,O,O.tag,L===A)})}pickNodesExactShape(e){const t=super.pickNodesExactShape(e);return t.sort((i,s)=>s.datumIndex.length-i.datumIndex.length),t}pickNodeClosestDatum(e){const t=this.pickNodesExactShape(e);return t.length!==0?{datum:t[0],distance:0}:this.pickNodeNearestDistantObject(e,this.datumSelection.nodes())}getTooltipContent(e){const{id:t,properties:i}=this,{labelKey:s,secondaryLabelKey:n,childrenKey:a,sizeKey:r,sizeName:o,colorKey:l,colorName:c,tooltip:h}=i,d=e.reduce((w,T)=>w==null?void 0:w.children[T],this.rootNode);if(d==null)return;const{datum:u,depth:p,children:g}=d;if(u==null||p==null)return;const f=g.length===0,y=[],v=r!=null?u[r]:void 0;v!=null&&y.push({label:o,fallbackLabel:r,value:v});const x=l!=null?u[l]:void 0;x!=null&&y.push({label:c,fallbackLabel:l,value:x});let S;f?(S=this.getTileBaseStyle(!1),Object.assign(S,this.getTileStyleOverrides(e,u,p,x,S,!1))):(S=this.getGroupBaseStyle(!1),Object.assign(S,this.getGroupStyleOverrides(e,u,p,S,!1)));const M=S.fill,D=wm({shape:"square",fill:M,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults);R.isGradientFill(D.fill)&&(D.fill=E(b({},D.fill),{gradient:"linear",rotation:0,reverse:!1}));const A=f?{marker:D}:void 0;return this.formatTooltipWithContext(h,{title:s!=null?u[s]:void 0,symbol:A,data:y},b({seriesId:t,datum:u,title:void 0,depth:p,labelKey:s,secondaryLabelKey:n,childrenKey:a,sizeKey:r,sizeName:o,colorKey:l,colorName:c},S))}computeFocusBounds(e){return hAe.toCanvas(this.contentGroup,e.getBBox())}};HC.className="TreemapSeries",HC.type="treemap";var{commonSeriesOptionsDefs:fAe,treemapSeriesThemeableOptionsDef:mAe,without:yAe}=R,Ep=E(b(b({},mAe),yAe(fAe,["highlightStyle"])),{type:ee(Oe("treemap")),labelKey:z,secondaryLabelKey:z,childrenKey:z,sizeKey:z,colorKey:z,sizeName:z,colorName:z});Ep.fillGradientDefaults=Ce(gy),Ep.fillPatternDefaults=Ce(fy),Ep.fillImageDefaults=Ce(my),Ep.undocumentedGroupFills=Ce(Ie(ye)),Ep.undocumentedGroupStrokes=Ce(Ie(ye));var{FONT_SIZE_RATIO:rj}=R,vAe={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",moduleFactory:e=>new HC(e),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},colorRange:{$palette:"divergingColors"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:R.FILL_PATTERN_DEFAULTS,fillImageDefaults:R.FILL_IMAGE_DEFAULTS,undocumentedGroupFills:{$palette:"hierarchyColors"},undocumentedGroupStrokes:{$palette:"secondHierarchyColors"},group:{label:{enabled:!0,color:{$ref:"textColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:{$ref:"backgroundColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.5]},minimumFontSize:{$rem:[rj.SMALLER]},fontFamily:{$ref:"fontFamily"},wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:{$ref:"backgroundColor"},fontStyle:void 0,fontWeight:void 0,fontSize:{$ref:"fontSize"},minimumFontSize:{$rem:[rj.SMALLER]},fontFamily:{$ref:"fontFamily"},wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:{$ref:"textColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:{$ref:"backgroundColor"}},secondaryLabel:{color:{$ref:"backgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}}},bAe={type:"series",name:"treemap",chartType:"hierarchy",enterprise:!0,options:Ep,create:e=>new HC(e)},gIe=R.ModuleRegistry,xAe=[Vge,FG,qG,wxe,Kxe,rz,lz,Az,Oz,zz],CAe=[jge,Hge,Wge,Uge,$0e,JMe,nDe,BDe,YDe],SAe=[qge,Fbe,jwe],MAe=[tfe,SCe,Cwe],DAe=[afe,sAe,bAe],wAe=[cfe,fMe],AAe=[gfe,$Ce,nSe,TSe,ZSe,u0e],IAe=[...xAe,...CAe,...SAe,...MAe,...DAe,...wAe,...AAe,dbe,ube,pbe],oj={xMin:Ns,xMax:xn,yMin:_n,yMax:Gn,span:ra},TAe=1e3,kAe=5;function lj(e,t){return Array.from({length:e},(i,s)=>{const n=s*ra,a=t[n+Ns],r=t[n+xn];return(a+r)/2|0})}function LAe(e,t,i){if(e.length<TAe)return;const[s,n]=rm(i);let a=am(e,kAe),{indexData:r,valueData:o}=om(e,t,t,s,n,a),l=lj(a,r);const c=[{maxRange:a,indexData:r,indices:l,indexes:oj}];for(;a>64;)({indexData:r,valueData:o,maxRange:a}=lm(r,o,a)),l=lj(a,r),c.push({maxRange:a,indexData:r,indices:l,indexes:oj});return c.reverse(),c}var{ChartAxisDirection:PAe,ContinuousScale:EAe,DiscreteTimeScale:RAe}=R,NAe=class extends R.BarSeries{aggregateData(e,t){if((t==null?void 0:t.type)!=="ungrouped")return;const i=this.axes[PAe.X];if(i==null||!(EAe.is(i.scale)||RAe.is(i.scale)))return;const s=e.resolveKeysById(this,"xValue",t),n=e.resolveColumnById(this,"yValue-raw",t),{index:a}=e.resolveProcessedDataDefById(this,"xValue"),r=t.domain.keys[a];return LAe(s,n,r)}},{BarSeriesModule:OAe}=R,FAe=E(b({},OAe),{type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"bar",moduleFactory:e=>new NAe(e)}),BAe=1e3,cj=10;function hj(e,t,i,s,n,a){const r=e[a];if(r==null)return!1;const o=kx(r,t,i),l=Lx(o,n);return a===s[l+Ns]||a===s[l+xn]||a===s[l+_n]||a===s[l+Gn]}function _Ae(e,t,i){if(e.length<BAe)return;const[s,n]=rm(i);let a=am(e,cj);const{indexData:r,valueData:o}=om(e,t,t,s,n,a);let l=[];for(let h=0;h<e.length;h+=1)hj(e,s,n,r,a,h)&&l.push(h);const c=[{maxRange:a,indices:l}];for(;l.length>cj&&a>64;)({maxRange:a}=lm(r,o,a,{inPlace:!0})),l=l.filter(hj.bind(null,e,s,n,r,a)),c.push({maxRange:a,indices:l});return c.reverse(),c}var{ChartAxisDirection:GAe,ContinuousScale:zAe,DiscreteTimeScale:VAe}=R,jAe=class extends R.LineSeries{aggregateData(e,t){const i=this.axes[GAe.X];if(i==null||!(zAe.is(i.scale)||VAe.is(i.scale)))return;const s=e.resolveColumnById(this,"xValue",t),n=e.resolveColumnById(this,"yValueRaw",t),a=e.getDomain(this,"xValue","value",t);return _Ae(s,n,a)}},{LineSeriesModule:HAe}=R,WAe=E(b({},HAe),{type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"line",moduleFactory:e=>new jAe(e)}),UAe=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-dialog{display:flex;flex-direction:column;font-size:var(--ag-charts-chrome-font-size-large)}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:calc(var(--ag-charts-spacing) * 2)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-chrome-subtle-text-color);margin-bottom:-1px;padding:var(--input-padding) calc(var(--input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:var(--ag-charts-accent-color);color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-spacing) * -2)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-spacing) * 4);margin:0 calc(var(--ag-charts-spacing) * 4);padding:calc(var(--ag-charts-spacing) * 4) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:16px 18px;flex-wrap:wrap}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-dialog__input-group-label{color:var(--ag-charts-chrome-subtle-text-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-button-focus-background-color);border-color:var(--ag-charts-input-focus-border-color);color:var(--ag-charts-input-focus-text-color);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-dialog__color-picker-button--multi-color,.ag-charts-dialog__color-picker-button--multi-color:hover{background:linear-gradient(135deg,red 0%,#ff0 calc(100% * 1 / 6),#0f0 calc(100% * 2 / 6),#0ff 50%,#00f calc(100% * 4 / 6),#f0f calc(100% * 5 / 6),red 100%)}.ag-charts-color-picker{width:190px;padding:8px;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>');--multi-color: linear-gradient( 135deg, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:calc(var(--ag-charts-border-radius) * 1.5);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-row{display:flex;gap:8px;align-items:center;margin-bottom:4px;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button{width:36px;margin-left:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);border:0;background:var(--multi-color);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button--hidden{display:none}.ag-charts-color-picker__multi-color-button--active{box-shadow:inset 0 0 0 1px #0003;outline-offset:1px;outline:2px solid #2196f3}.ag-charts-color-picker__hue-input{flex:1 0 0}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:var(--ag-charts-border-radius);overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-accent-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:calc(var(--ag-charts-border-radius) / 2);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-label--multi-color{background:var(--multi-color)}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__line-stroke-width-menu,.ag-charts-annotations__line-style-type-menu,.ag-charts-annotations__text-size-menu{border-top-left-radius:0;border-top-right-radius:0;.ag-charts-menu__row:first-child{border-radius:0}}.ag-charts-annotations__text-size-menu{--item-padding: 4px 8px;min-width:34px;text-align:center}.ag-charts-annotations__line-stroke-width-menu{--item-padding: 6px;column-gap:6px}.ag-charts-annotations__line-style-type-menu{--item-padding: 6px;column-gap:0}.ag-charts-annotations__stroke-width-button:before{background:var(--ag-charts-foreground-color);content:"";margin-right:var(--toolbar-button-padding);height:min(var(--stroke-width),20px);width:12px}.ag-charts-annotations__stroke-width-button[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-annotations__color-picker-button{--emblem: var(--color)}.ag-charts-annotations__color-picker-button--multi-color{--emblem: linear-gradient( to right, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-annotations__color-picker-button:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--emblem)}.ag-charts-annotations__color-picker-button[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-annotations__toolbar-menu{min-width:200px}.ag-charts-annotations__axis-button--hidden{display:none}.ag-charts-annotations__axis-button{background-color:var(--ag-charts-crosshair-label-background-color);border-radius:calc(var(--ag-charts-border-radius) / 2);border:none;box-sizing:border-box;color:var(--ag-charts-crosshair-label-text-color);cursor:pointer;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);left:0;line-height:16px;overflow:hidden;padding:0;position:absolute;top:0;user-select:none;white-space:nowrap;z-index:var(--ag-charts-layer-annotations)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-background-color)}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--textarea-line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-context-menu{font-family:var(--ag-charts-chrome-font-family);font-size:calc(var(--ag-charts-chrome-font-size) * (13 / 12));font-weight:var(--ag-charts-chrome-font-weight);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-context-menu__cover{position:fixed;left:0;top:0}.ag-charts-context-menu__menu{background:var(--ag-charts-chrome-background-color);border-radius:var(--ag-charts-border-radius);border:var(--ag-charts-border);box-shadow:var(--ag-charts-shadow);color:var(--ag-charts-chrome-text-color);display:table;flex-direction:column;padding:.5em 0;transition:transform .1s ease;white-space:nowrap}.ag-charts-context-menu__menu:focus{outline:none}.ag-charts-context-menu__item{align-items:center;background:none;border:none;box-sizing:border-box;color:inherit;display:table-row;font:inherit;justify-content:space-between;text-align:left;width:100%;-webkit-appearance:none;-moz-appearance:none}.ag-charts-context-menu__icon>img{width:var(--ag-charts-icon-size);height:var(--ag-charts-icon-size)}.ag-charts-context-menu__icon,.ag-charts-context-menu__label,.ag-charts-context-menu__rightarrowhead{display:table-cell;vertical-align:middle}.ag-charts-context-menu__cellpadding{padding:.5em 1em}.ag-charts-context-menu__icon{padding-right:0}.ag-charts-context-menu__item[data-focus-override=true],.ag-charts-context-menu__item:focus,.ag-charts-context-menu__item:active{background:var(--ag-charts-focus-color)}.ag-charts-context-menu__item[data-focus-visible-override=true]:focus,.ag-charts-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-context-menu__item[data-focus-visible-override=false]{outline:inherit;box-shadow:inherit;z-index:inherit}.ag-charts-context-menu__item[aria-disabled=true]{border:none;color:color-mix(in srgb,var(--ag-charts-input-text-color) 50%,transparent);text-align:left}.ag-charts-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-charts-context-menu__divider{display:table-row}.ag-charts-context-menu__divider>div{padding:5px 0}.ag-charts-context-menu__divider>div:after{content:"";display:block;border-top:1px solid #babfc7}.ag-charts-context-menu__divider.ag-charts-dark-context-menu{background:#2196f31a}.ag-charts-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font-family:var(--ag-charts-font-family);font-size:var(--ag-charts-font-size);font-weight:var(--ag-charts-font-weight);overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-charts-crosshair-label-content{padding:0 8px;border-radius:calc(var(--ag-charts-border-radius) / 2);line-height:calc(var(--ag-charts-font-size) + 8px);background-color:var(--ag-charts-crosshair-label-background-color);color:var(--ag-charts-crosshair-label-text-color)}.ag-charts-crosshair-label--hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{--placeholder-text-color: var(--ag-charts-input-placeholder-text-color);display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;outline:none;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--placeholder-text-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}.ag-charts-chart-toolbar__menu{min-width:200px}.ag-charts-range-buttons .ag-charts-toolbar__button{padding:var(--toolbar-button-padding) calc(var(--toolbar-button-padding) * 1.5)}.ag-charts-zoom-buttons{align-items:center;display:flex;height:44px;justify-content:center;overflow:hidden;padding-bottom:10px;pointer-events:none;width:100%;.ag-charts-toolbar{--toolbar-size: 24px;--toolbar-button-padding: 1px;display:flex;font-size:var(--ag-charts-chrome-font-size);height:var(--toolbar-size);justify-content:center;opacity:1;pointer-events:auto;transition:opacity .2s ease-in-out,transform .4s ease-in-out;.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__label{padding-left:var(--ag-charts-spacing);padding-right:var(--ag-charts-spacing)}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{padding-left:0}.ag-charts-toolbar__button--gap{margin-left:var(--toolbar-gap)}&.ag-charts-zoom-buttons__toolbar--hidden{opacity:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out}}}.ag-charts-shared-toolbar{gap:var(--toolbar-gap);.ag-charts-toolbar__button{border-radius:var(--ag-charts-border-radius);margin:0}}
`;R.ModuleRegistry.registerMany(IAe);function dj(){R.moduleRegistry.register(uce,yce,Hce,Pue,_ue,FAe,fpe,qfe,Lme,Obe,Dxe,Uxe,tye,Hue,$ue,Jue,epe,upe,CCe,WAe,KCe,sSe,ISe,XSe,d0e,Lpe,Xpe,Nge,qme,K0e,Cce,QMe,sDe,FDe,$De,Gce,xwe,jce,Mve,Wye,Bpe,gMe,Vwe,Gpe,iAe,Jpe,vAe,tbe,Dge),R.enterpriseModule.isEnterprise=!0,R.enterpriseModule.styles=UAe,R.enterpriseModule.licenseManager=e=>{var t,i;return new $u((i=(t=e.container)==null?void 0:t.ownerDocument)!=null?i:typeof document=="undefined"?void 0:document)},R.enterpriseModule.injectWatermark=Oge}dj();var fIe={setLicenseKey(e){$u.setLicenseKey(e)}};function KAe(){dj(),JD()}var $Ae={VERSION:au,_Scene:Sw,_Theme:Dw,_Util:ww,create:rr.create.bind(rr),createSparkline:rr.__createSparkline.bind(rr),setup:KAe,setGridContext:$u.setGridContext.bind($u),setLicenseKey:$u.setLicenseKey.bind($u),isEnterprise:!0},uj=jt(3696),YAe=Object.defineProperty,pj=Object.getOwnPropertySymbols,XAe=Object.prototype.hasOwnProperty,ZAe=Object.prototype.propertyIsEnumerable,gj=(e,t,i)=>t in e?YAe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,qAe=(e,t)=>{for(var i in t||(t={}))XAe.call(t,i)&&gj(e,i,t[i]);if(pj)for(var i of pj(t))ZAe.call(t,i)&&gj(e,i,t[i]);return e};m.ModuleRegistry.registerModules([oQ,YL.with($Ae)]);function fj(e){const{licenseKey:t}=e;return t&&UT.setLicenseKey(t),fl().createElement(uj.default,qAe({},e))}fj.propTypes=uj.propTypes}}]);

//# sourceMappingURL=async-enterprise.js.map